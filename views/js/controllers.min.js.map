{"version":3,"sources":["routes.js","../portableElementRegistry/factory/factory.js","../qtiCreator/helper/qtiElements.js","../portableElementRegistry/factory/ciRegistry.js","../portableElementRegistry/ciRegistry.js","../portableElementRegistry/factory/icRegistry.js","../portableElementRegistry/icRegistry.js","../qtiItem/core/qtiClasses.js","../qtiItem/helper/util.js","../qtiItem/helper/rendererConfig.js","../qtiItem/core/Element.js","../qtiItem/core/Loader.js","../qtiCreator/model/helper/event.js","../qtiCreator/model/helper/invalidator.js","../qtiCreator/model/mixin/editable.js","../qtiCreator/model/qtiClasses.js","../qtiCreator/model/helper/container.js","../qtiCreator/model/mixin/editableContainer.js","../qtiItem/core/IdentifiedElement.js","../qtiItem/mixin/Mixin.js","../qtiItem/core/Container.js","../qtiItem/mixin/Container.js","../qtiItem/mixin/ContainerItemBody.js","../qtiItem/core/Item.js","../qtiItem/core/Stylesheet.js","../qtiCreator/model/Stylesheet.js","../qtiItem/core/ResponseProcessing.js","../qtiCreator/model/ResponseProcessing.js","../qtiItem/core/variables/VariableDeclaration.js","../qtiItem/core/variables/OutcomeDeclaration.js","../qtiCreator/model/variables/OutcomeDeclaration.js","../qtiItem/core/feedbacks/ModalFeedback.js","../qtiCreator/model/feedbacks/ModalFeedback.js","../qtiCreator/model/Item.js","../qtiCreator/helper/itemLoader.js","../qtiItem/helper/interactionHelper.js","../qtiRunner/core/Renderer.js","../../taoItems/assets/manager.js","../../taoItems/assets/strategies.js","../portableElementRegistry/assetManager/portableAssetStrategy.js","../qtiCommonRenderer/renderers/config.js","../qtiCreator/renderers/config.js","../qtiCreator/renderers/Renderer.js","../qtiCreator/helper/creatorRenderer.js","../qtiCommonRenderer/renderers/Renderer.js","../qtiCommonRenderer/helpers/container.js","../qtiCreator/helper/commonRenderer.js","../qtiItem/helper/simpleParser.js","../qtiItem/helper/xincludeLoader.js","../qtiCreator/helper/xincludeRenderer.js","../qtiCreator/tpl/toolbars/insertInteractionButton!tpl","../qtiCreator/tpl/toolbars/insertInteractionGroup!tpl","../qtiCreator/tpl/toolbars/tooltip!tpl","../qtiCreator/editor/interactionsToolbar.js","../qtiCreator/helper/panel.js","../qtiCreator/editor/interactionsPanel.js","../qtiCreator/tpl/toolbars/cssToggler!tpl","../qtiCreator/editor/styleEditor/styleEditor.js","../qtiCreator/tpl/notifications/genericFeedbackPopup!tpl","../qtiCreator/editor/styleEditor/styleSheetToggler.js","json!taoQtiItem/qtiCreator/editor/resources/font-stacks.json","../qtiCreator/editor/styleEditor/fontSelector.js","../qtiCreator/helper/popup.js","../../lib/farbtastic/farbtastic.js","../qtiCreator/editor/styleEditor/colorSelector.js","../qtiCreator/editor/styleEditor/fontSizeChanger.js","../qtiCreator/editor/styleEditor/itemResizer.js","../qtiCreator/editor/propertiesPanel.js","../qtiCreator/itemCreator.js","../qtiCreator/editor/areaBroker.js","../qtiCreator/plugins/button!tpl","../qtiCreator/plugins/menu/save.js","json!taoItems/preview/resources/device-list.json","../../taoItems/preview/tpl/preview!tpl","../../taoItemsCss/preview!css","../../taoItems/preview/preview.js","../qtiCreator/plugins/menu/preview.js","../qtiCreator/plugins/menu/print.js","../qtiCreator/plugins/content/title.js","../qtiCreator/plugins/content/changeTracker.js","../qtiCreator/widgets/helpers/validators.js","../../lib/polyfill/placeholders.js","../qtiCreator/widgets/helpers/formElement.js","../qtiXmlRenderer/renderers/config.js","../qtiXmlRenderer/renderers/Renderer.js","../qtiItem/helper/response.js","../qtiItem/helper/maxScore.js","../qtiCreator/helper/xmlRenderer.js","../qtiCreator/tpl/outcomeEditor/panel!tpl","../qtiCreator/tpl/outcomeEditor/listing!tpl","../qtiCreator/plugins/panel/outcomeEditor.js","../qtiCreator/plugins/loader.js","creator/index.js","../qtiCreator/editor/blockAdder/tpl/addColumnRow!tpl","../qtiCreator/editor/gridEditor/config.js","../qtiCreator/editor/gridEditor/helper.js","../qtiCreator/editor/gridEditor/resizable.js","../qtiCreator/widgets/helpers/textWrapper.js","../qtiCreator/editor/gridEditor/content.js","../qtiCreator/editor/elementSelector/tpl/popup!tpl","../qtiCreator/editor/elementSelector/tpl/content!tpl","../qtiCreator/editor/elementSelector/selector.js","../qtiCreator/widgets/Widget.js","../qtiCreator/editor/widgetToolbar.js","../qtiCreator/widgets/static/Widget.js","../qtiCreator/widgets/states/factory.js","../qtiCreator/widgets/states/Sleep.js","../qtiCreator/widgets/static/states/Sleep.js","../qtiCreator/widgets/helpers/content.js","../qtiCreator/widgets/states/Active.js","../qtiCreator/widgets/static/states/Active.js","../qtiCreator/widgets/states/Inactive.js","../qtiCreator/tpl/notifications/deletingInfoBox!tpl","../qtiCreator/widgets/helpers/deletingState.js","../qtiCreator/helper/gridUnits.js","../qtiCreator/widgets/states/Deleting.js","../qtiCreator/widgets/static/states/states.js","../qtiCreator/widgets/static/text/states/Sleep.js","../qtiCreator/editor/ckEditor/groupToggler.js","../qtiCreator/helper/ckConfigurator.js","../qtiCreator/editor/ckEditor/htmlEditor.js","../qtiCreator/tpl/forms/static/text!tpl","../qtiCreator/widgets/static/text/states/Active.js","../qtiCreator/widgets/static/text/states/states.js","../qtiCreator/tpl/toolbars/textBlock!tpl","../qtiCreator/widgets/static/text/Widget.js","../qtiCreator/editor/blockAdder/blockAdder.js","../qtiCreator/editor/ckEditor/ckProtector.js","../qtiCreator/editor/colorPicker/tpl/popup!tpl","../qtiCreator/editor/colorPicker/colorPicker.js","../qtiCreator/model/Container.js","../qtiCreator/tpl/toolbars/htmlEditorTrigger!tpl","../qtiCreator/editor/containerEditor.js","../qtiCreator/editor/customInteractionRegistry.js","../qtiCreator/editor/gridEditor/arrow.js","../qtiCreator/editor/targetFinder.js","../qtiCreator/editor/gridEditor/droppable.js","../qtiCreator/editor/gridEditor/draggable.js","../qtiCreator/editor/infoControlRegistry.js","../qtiCreator/editor/jquery.gridEditor.js","../qtiCreator/editor/MathEditor.js","../lib/mathquill/mathquill.js","../qtiCreator/editor/mathInput/tpl/mathInput!tpl","../lib/mathquill/mathquill!css","../qtiCreator/editor/mathInput/mathInput.js","../qtiCreator/tpl/toolbars/choiceSelector!tpl","../qtiCreator/editor/response/choiceSelector.js","../qtiCreator/editor/simpleContentEditableElement.js","../qtiCreator/helper/devTools.js","../qtiCreator/helper/dummyElement.js","../qtiCreator/helper/windowPopup.js","../qtiItem/core/choices/Choice.js","../qtiItem/core/choices/Hotspot.js","../qtiItem/core/choices/AssociableHotspot.js","../qtiCreator/model/choices/AssociableHotspot.js","../qtiItem/core/choices/Gap.js","../qtiCreator/model/choices/Gap.js","../qtiItem/core/Object.js","../qtiItem/core/choices/GapImg.js","../qtiCreator/model/choices/GapImg.js","../qtiItem/core/choices/ContainerChoice.js","../qtiItem/core/choices/GapText.js","../qtiCreator/model/choices/GapText.js","../qtiItem/core/choices/HotspotChoice.js","../qtiCreator/model/choices/HotspotChoice.js","../qtiItem/mixin/ContainerInline.js","../qtiItem/core/choices/Hottext.js","../qtiCreator/model/choices/Hottext.js","../qtiItem/core/choices/TextVariableChoice.js","../qtiItem/core/choices/InlineChoice.js","../qtiCreator/model/choices/InlineChoice.js","../qtiItem/core/choices/SimpleAssociableChoice.js","../qtiCreator/model/choices/SimpleAssociableChoice.js","../qtiItem/core/choices/SimpleChoice.js","../qtiCreator/model/choices/SimpleChoice.js","../qtiCreator/model/helper/portableElement.js","../qtiCreator/model/helper/response.js","../qtiItem/core/Img.js","../qtiCreator/model/Img.js","../qtiItem/mixin/NamespacedElement.js","../qtiItem/core/Include.js","../qtiCreator/model/Include.js","../qtiItem/core/variables/ResponseDeclaration.js","../qtiItem/core/response/SimpleFeedbackRule.js","../qtiCreator/model/variables/ResponseDeclaration.js","../qtiCreator/model/mixin/editableInteraction.js","../qtiItem/core/interactions/Interaction.js","../qtiItem/core/interactions/Prompt.js","../qtiItem/core/interactions/BlockInteraction.js","../qtiItem/core/interactions/AssociateInteraction.js","../qtiCreator/model/interactions/AssociateInteraction.js","../qtiItem/core/interactions/ChoiceInteraction.js","../qtiCreator/model/interactions/ChoiceInteraction.js","../qtiItem/core/interactions/InlineInteraction.js","../qtiItem/core/interactions/EndAttemptInteraction.js","../qtiCreator/model/interactions/EndAttemptInteraction.js","../qtiItem/core/interactions/ExtendedTextInteraction.js","../qtiCreator/model/interactions/ExtendedTextInteraction.js","../qtiItem/core/interactions/ContainerInteraction.js","../qtiItem/core/interactions/GapMatchInteraction.js","../qtiCreator/model/interactions/GapMatchInteraction.js","../qtiItem/core/interactions/ObjectInteraction.js","../qtiItem/core/interactions/GraphicInteraction.js","../qtiItem/core/interactions/GraphicAssociateInteraction.js","../qtiCreator/model/interactions/GraphicAssociateInteraction.js","../qtiItem/core/interactions/GraphicGapMatchInteraction.js","../qtiCreator/model/interactions/GraphicGapMatchInteraction.js","../qtiItem/core/interactions/GraphicOrderInteraction.js","../qtiCreator/model/interactions/GraphicOrderInteraction.js","../qtiItem/core/interactions/HotspotInteraction.js","../qtiCreator/model/interactions/HotspotInteraction.js","../qtiItem/core/interactions/HottextInteraction.js","../qtiCreator/model/interactions/HottextInteraction.js","../qtiItem/core/interactions/InlineChoiceInteraction.js","../qtiCreator/model/interactions/InlineChoiceInteraction.js","../qtiItem/core/interactions/MatchInteraction.js","../qtiCreator/model/interactions/MatchInteraction.js","../qtiItem/core/interactions/MediaInteraction.js","../qtiCreator/model/interactions/MediaInteraction.js","../qtiItem/core/interactions/OrderInteraction.js","../qtiCreator/model/interactions/OrderInteraction.js","../qtiItem/mixin/CustomElement.js","../qtiItem/core/interactions/CustomInteraction.js","../qtiCreator/model/interactions/PortableCustomInteraction.js","../qtiItem/core/interactions/SelectPointInteraction.js","../qtiCreator/model/interactions/SelectPointInteraction.js","../qtiItem/core/interactions/SliderInteraction.js","../qtiCreator/model/interactions/SliderInteraction.js","../qtiItem/core/interactions/TextEntryInteraction.js","../qtiCreator/model/interactions/TextEntryInteraction.js","../qtiItem/core/interactions/UploadInteraction.js","../qtiCreator/model/interactions/UploadInteraction.js","../qtiItem/core/Math.js","../qtiCreator/model/Math.js","../qtiCreator/model/Object.js","../qtiCreator/model/pciCreatorContext.js","../qtiItem/core/PortableInfoControl.js","../qtiCreator/model/PortableInfoControl.js","../qtiItem/core/RubricBlock.js","../qtiCreator/model/RubricBlock.js","../qtiItem/mixin/ContainerTable.js","../qtiItem/core/Table.js","../qtiCreator/model/Table.js","../qtiCreator/plugins/content/blockAdder.js","../qtiCreator/plugins/navigation/back.js","../qtiCommonRenderer/tpl/choices/gap!tpl","../qtiCommonRenderer/renderers/choices/Gap.js","../qtiCreator/widgets/choices/Widget.js","../qtiCreator/widgets/states/Answer.js","../qtiCreator/widgets/states/Choice.js","../qtiCreator/widgets/states/Correct.js","../qtiCreator/widgets/states/Map.js","../qtiCreator/widgets/states/NoRp.js","../qtiCreator/widgets/states/Question.js","../qtiCreator/tpl/notifications/invalidInfoBox!tpl","../qtiCreator/widgets/states/Invalid.js","../qtiCreator/widgets/states/states.js","../qtiCreator/widgets/choices/states/Sleep.js","../qtiCreator/widgets/choices/states/Active.js","../qtiCreator/tpl/toolbars/simpleChoice.content!tpl","../qtiCreator/widgets/choices/helpers/formElement.js","../qtiCreator/widgets/choices/states/Question.js","../qtiCreator/widgets/choices/states/Answer.js","../qtiCreator/widgets/choices/states/states.js","../qtiCreator/widgets/choices/states/Choice.js","../qtiCreator/tpl/forms/choices/gap!tpl","../qtiCreator/widgets/helpers/identifier.js","../qtiCreator/widgets/choices/gap/states/Choice.js","../qtiCreator/tpl/toolbars/gap!tpl","../qtiCreator/widgets/choices/gap/states/Question.js","../qtiCreator/widgets/choices/gap/states/states.js","../qtiCreator/widgets/choices/gap/Widget.js","../qtiCreator/renderers/choices/Gap.js","../qtiCommonRenderer/tpl/choices/choice!tpl","../qtiCommonRenderer/renderers/choices/GapText.js","../qtiCreator/tpl/forms/choices/simpleAssociableChoice!tpl","../qtiCreator/widgets/choices/simpleAssociableChoice/states/Choice.js","../qtiCreator/widgets/choices/gapText/states/Choice.js","../qtiCreator/widgets/choices/gapText/states/states.js","../qtiCreator/widgets/choices/gapText/Widget.js","../qtiCreator/renderers/choices/GapText.js","../qtiCommonRenderer/tpl/choices/hottext!tpl","../qtiCommonRenderer/renderers/choices/Hottext.js","../qtiCreator/tpl/forms/choices/choice!tpl","../qtiCreator/widgets/choices/simpleChoice/states/Choice.js","../qtiCreator/widgets/choices/hottext/states/Choice.js","../qtiCreator/tpl/toolbars/hottext!tpl","../qtiCreator/widgets/choices/hottext/states/Question.js","../qtiCreator/widgets/choices/hottext/states/states.js","../qtiCreator/widgets/choices/hottext/Widget.js","../qtiCreator/renderers/choices/Hottext.js","../qtiCreator/renderers/choices/InlineChoice.js","../qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction.js","../qtiCreator/widgets/choices/simpleAssociableChoice/states/Question.js","../qtiCreator/widgets/choices/simpleAssociableChoice/states/states.js","../qtiCreator/widgets/choices/simpleAssociableChoice/Widget.js","../qtiCreator/renderers/choices/SimpleAssociableChoice.AssociateInteraction.js","../qtiCommonRenderer/tpl/choices/simpleAssociableChoice.matchInteraction!tpl","../qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction.js","../qtiCreator/renderers/choices/SimpleAssociableChoice.MatchInteraction.js","../qtiCommonRenderer/tpl/choices/simpleChoice.choiceInteraction!tpl","../qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction.js","../qtiCreator/widgets/choices/simpleChoice/states/states.js","../qtiCreator/widgets/choices/simpleChoice/Widget.js","../qtiCreator/renderers/choices/SimpleChoice.ChoiceInteraction.js","../qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction.js","../qtiCreator/renderers/choices/SimpleChoice.OrderInteraction.js","../qtiCreator/tpl/container!tpl","../qtiCreator/renderers/Container.js","../qtiCommonRenderer/tpl/img!tpl","../qtiCommonRenderer/renderers/Img.js","../qtiCreator/widgets/static/img/states/Sleep.js","../qtiCreator/tpl/forms/static/img!tpl","../qtiCreator/widgets/static/helpers/inline.js","../qtiCreator/widgets/static/img/states/Active.js","../qtiCreator/widgets/static/img/states/states.js","../qtiCreator/widgets/static/helpers/widget.js","../qtiCreator/tpl/toolbars/media!tpl","../qtiCreator/widgets/static/img/Widget.js","../qtiCreator/renderers/Img.js","../qtiCommonRenderer/tpl/include!tpl","../qtiCommonRenderer/renderers/Include.js","../qtiCreator/tpl/forms/static/include!tpl","../qtiCreator/widgets/static/include/states/Active.js","../qtiCreator/widgets/static/include/states/states.js","../qtiCreator/widgets/static/include/Widget.js","../qtiCreator/tpl/include!tpl","../qtiCreator/renderers/Include.js","../qtiCommonRenderer/tpl/interactions/associateInteraction!tpl","../qtiCommonRenderer/tpl/interactions/associateInteraction.pair!tpl","../qtiCommonRenderer/tpl/instruction!tpl","../qtiCommonRenderer/helpers/instructions/Instruction.js","../qtiCommonRenderer/tpl/notification!tpl","../qtiCommonRenderer/helpers/instructions/instructionManager.js","../qtiCommonRenderer/helpers/PciPrettyPrint.js","../qtiCommonRenderer/helpers/PciResponse.js","../qtiCommonRenderer/helpers/sizeAdapter.js","../qtiCommonRenderer/renderers/interactions/AssociateInteraction.js","../qtiCreator/tpl/toolbars/grip!tpl","../qtiCreator/widgets/helpers/movable.js","../qtiCreator/tpl/toolbars/interaction!tpl","../qtiCreator/tpl/toolbars/okButton!tpl","../qtiCreator/widgets/interactions/Widget.js","../qtiCreator/widgets/interactions/states/Sleep.js","../qtiCreator/widgets/interactions/states/Active.js","../qtiCreator/tpl/toolbars/addChoice!tpl","../qtiCreator/widgets/interactions/states/Question.js","../qtiCreator/widgets/interactions/states/Choice.js","../qtiCreator/tpl/forms/response/responseForm!tpl","../qtiCreator/tpl/modalFeedback/rule!tpl","../qtiCreator/tpl/modalFeedback/panel!tpl","../qtiCreator/widgets/interactions/helpers/formElement.js","../qtiCreator/widgets/helpers/modalFeedbackConditions.js","../qtiCreator/widgets/helpers/modalFeedbackRule.js","../qtiCreator/widgets/interactions/helpers/answerState.js","../qtiCreator/widgets/interactions/states/Answer.js","../qtiCreator/widgets/interactions/states/Correct.js","../qtiCreator/widgets/interactions/states/Map.js","../qtiCreator/widgets/interactions/states/NoRp.js","../qtiCreator/widgets/states/Custom.js","../qtiCreator/tpl/notifications/widgetOverlay!tpl","../qtiCreator/widgets/interactions/states/Custom.js","../qtiCreator/widgets/interactions/states/states.js","../qtiCreator/widgets/interactions/blockInteraction/states/Question.js","../qtiCreator/widgets/interactions/blockInteraction/states/states.js","../qtiCreator/tpl/forms/interactions/associate!tpl","../qtiCreator/widgets/interactions/associateInteraction/states/Question.js","../qtiCreator/widgets/interactions/associateInteraction/states/Choice.js","../qtiCreator/widgets/interactions/associateInteraction/ResponseWidget.js","../qtiCreator/widgets/interactions/associateInteraction/states/Correct.js","../qtiCreator/tpl/toolbars/associableChoice.answer!tpl","../qtiCreator/widgets/interactions/associateInteraction/states/Map.js","../qtiCreator/widgets/interactions/associateInteraction/states/states.js","../qtiCreator/widgets/interactions/associateInteraction/Widget.js","../qtiCreator/renderers/interactions/AssociateInteraction.js","../qtiCommonRenderer/tpl/interactions/choiceInteraction!tpl","../qtiCommonRenderer/renderers/interactions/ChoiceInteraction.js","../qtiCreator/tpl/forms/interactions/choice!tpl","../qtiCreator/widgets/interactions/choiceInteraction/states/Question.js","../qtiCreator/widgets/interactions/choiceInteraction/states/Choice.js","../qtiCreator/tpl/toolbars/simpleChoice.score!tpl","../qtiCreator/tpl/toolbars/simpleChoice.label!tpl","../qtiCreator/widgets/interactions/choiceInteraction/ResponseWidget.js","../qtiCreator/widgets/interactions/choiceInteraction/states/Correct.js","../qtiCreator/widgets/interactions/choiceInteraction/states/Map.js","../qtiCreator/widgets/interactions/choiceInteraction/states/states.js","../qtiCreator/widgets/interactions/choiceInteraction/Widget.js","../qtiCreator/renderers/interactions/ChoiceInteraction.js","../qtiCommonRenderer/tpl/interactions/endAttemptInteraction!tpl","../qtiCommonRenderer/renderers/interactions/EndAttemptInteraction.js","../qtiCreator/widgets/interactions/inlineInteraction/Widget.js","../qtiCreator/widgets/interactions/inlineInteraction/states/Sleep.js","../qtiCreator/widgets/interactions/inlineInteraction/states/Active.js","../qtiCreator/widgets/interactions/inlineInteraction/states/states.js","../qtiCreator/tpl/forms/interactions/endAttempt!tpl","../qtiCreator/widgets/interactions/endAttemptInteraction/states/Question.js","../qtiCreator/widgets/interactions/endAttemptInteraction/states/states.js","../qtiCreator/tpl/inlineInteraction/endAttemptInteraction!tpl","../qtiCreator/widgets/interactions/endAttemptInteraction/Widget.js","../qtiCreator/tpl/inlineInteraction/endAttemptInteraction.placeholder!tpl","../qtiCreator/renderers/interactions/EndAttemptInteraction.js","../qtiCommonRenderer/tpl/interactions/extendedTextInteraction!tpl","../qtiCommonRenderer/helpers/ckConfigurator.js","../qtiCommonRenderer/helpers/patternMask.js","../qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction.js","../qtiCreator/tpl/forms/interactions/extendedText!tpl","../qtiCreator/widgets/interactions/extendedTextInteraction/states/Question.js","../qtiCreator/widgets/interactions/extendedTextInteraction/states/Correct.js","../qtiCreator/widgets/interactions/extendedTextInteraction/states/Sleep.js","../qtiCreator/widgets/interactions/extendedTextInteraction/states/NoRp.js","../qtiCreator/widgets/interactions/extendedTextInteraction/states/states.js","../qtiCreator/widgets/interactions/extendedTextInteraction/Widget.js","../qtiCreator/renderers/interactions/ExtendedTextInteraction.js","../qtiCommonRenderer/tpl/interactions/gapMatchInteraction!tpl","../qtiCommonRenderer/renderers/interactions/GapMatchInteraction.js","../qtiCreator/widgets/helpers/selectionWrapper.js","../qtiCreator/tpl/forms/interactions/gapMatch!tpl","tpl!taoQtiItem/qtiCreator/tpl/toolbars/gap-create","../qtiCreator/widgets/interactions/gapMatchInteraction/states/Question.js","../qtiCreator/widgets/interactions/gapMatchInteraction/states/Correct.js","../qtiCreator/tpl/forms/response/pairScoreMappingForm!tpl","../qtiCreator/tpl/forms/response/pairScoreForm!tpl","../qtiCreator/widgets/interactions/helpers/pairScoringForm.js","../qtiCreator/widgets/interactions/gapMatchInteraction/states/Map.js","../qtiCreator/widgets/interactions/gapMatchInteraction/states/states.js","../qtiCreator/widgets/interactions/gapMatchInteraction/Widget.js","../qtiCreator/renderers/interactions/GapMatchInteraction.js","../qtiCommonRenderer/tpl/interactions/graphicAssociateInteraction!tpl","json!taoQtiItem/qtiCommonRenderer/renderers/graphic-style.json","../qtiCommonRenderer/helpers/Graphic.js","../qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction.js","../qtiCreator/widgets/interactions/graphicInteraction/Widget.js","../qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Sleep.js","../qtiCreator/tpl/graphicInteraction/sidebar!tpl","../qtiCreator/widgets/interactions/helpers/shapeSideBar.js","../qtiCreator/widgets/interactions/helpers/shapeHandlers.js","../qtiCreator/widgets/interactions/helpers/shapeResizer.js","../qtiCreator/widgets/interactions/helpers/shapeMover.js","../qtiCreator/widgets/interactions/helpers/pathBuilder.js","../qtiCreator/widgets/interactions/helpers/shapeFactory.js","../qtiCreator/widgets/interactions/helpers/shapeEditor.js","../qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor.js","../qtiCreator/widgets/interactions/helpers/resourceManager.js","../qtiCreator/widgets/interactions/helpers/imageSelector.js","../qtiCreator/tpl/forms/interactions/graphicAssociate!tpl","../qtiCreator/tpl/forms/choices/associableHotspot!tpl","../qtiCreator/widgets/interactions/helpers/bgImage.js","../qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Question.js","../qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Correct.js","../qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Map.js","../qtiCreator/widgets/interactions/graphicAssociateInteraction/states/states.js","../qtiCreator/widgets/interactions/graphicAssociateInteraction/Widget.js","../qtiCreator/renderers/interactions/GraphicAssociateInteraction.js","../qtiCommonRenderer/tpl/interactions/graphicGapMatchInteraction!tpl","../qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction.js","../qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Sleep.js","../qtiCreator/tpl/forms/interactions/graphicGapMatch!tpl","../qtiCreator/tpl/forms/choices/gapImg!tpl","../qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Question.js","../qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Correct.js","../qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Map.js","../qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/states.js","../qtiCommonRenderer/tpl/choices/gapImg!tpl","../qtiCreator/widgets/interactions/graphicGapMatchInteraction/Widget.js","../qtiCreator/renderers/interactions/GraphicGapMatchInteraction.js","../qtiCommonRenderer/tpl/interactions/graphicOrderInteraction!tpl","../qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction.js","../qtiCreator/widgets/interactions/graphicOrderInteraction/states/Sleep.js","../qtiCreator/tpl/forms/interactions/graphicOrder!tpl","../qtiCreator/tpl/forms/choices/hotspot!tpl","../qtiCreator/widgets/interactions/graphicOrderInteraction/states/Question.js","../qtiCreator/widgets/interactions/graphicOrderInteraction/states/Correct.js","../qtiCreator/widgets/interactions/graphicOrderInteraction/states/states.js","../qtiCreator/widgets/interactions/graphicOrderInteraction/Widget.js","../qtiCreator/renderers/interactions/GraphicOrderInteraction.js","../qtiCommonRenderer/tpl/interactions/hotspotInteraction!tpl","../qtiCommonRenderer/renderers/interactions/HotspotInteraction.js","../qtiCreator/widgets/interactions/hotspotInteraction/states/Sleep.js","../qtiCreator/tpl/forms/interactions/hotspot!tpl","../qtiCreator/widgets/interactions/hotspotInteraction/states/Question.js","../qtiCreator/widgets/interactions/hotspotInteraction/states/Correct.js","../qtiCreator/widgets/interactions/helpers/graphicScorePopup.js","../qtiCreator/tpl/forms/response/graphicScoreMappingForm!tpl","../qtiCreator/widgets/interactions/hotspotInteraction/states/Map.js","../qtiCreator/widgets/interactions/hotspotInteraction/states/states.js","../qtiCreator/widgets/interactions/hotspotInteraction/Widget.js","../qtiCreator/renderers/interactions/HotspotInteraction.js","../qtiCommonRenderer/tpl/interactions/hottextInteraction!tpl","../qtiCommonRenderer/renderers/interactions/HottextInteraction.js","../qtiCreator/tpl/forms/interactions/hottext!tpl","tpl!taoQtiItem/qtiCreator/tpl/toolbars/hottext-create","../qtiCreator/widgets/interactions/hottextInteraction/states/Question.js","../qtiCreator/widgets/interactions/hottextInteraction/states/Correct.js","../qtiCreator/widgets/interactions/hottextInteraction/states/Map.js","../qtiCreator/widgets/interactions/hottextInteraction/states/states.js","../qtiCreator/widgets/interactions/hottextInteraction/Widget.js","../qtiCreator/renderers/interactions/HottextInteraction.js","../qtiCommonRenderer/tpl/interactions/inlineChoiceInteraction!tpl","../qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction.js","../qtiCreator/widgets/choices/inlineChoice/states/Question.js","../qtiCreator/widgets/choices/inlineChoice/states/Choice.js","../qtiCreator/widgets/choices/inlineChoice/states/states.js","../qtiCreator/widgets/choices/inlineChoice/Widget.js","../qtiCreator/tpl/forms/interactions/inlineChoice!tpl","../qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Question.js","../qtiCreator/widgets/interactions/inlineChoiceInteraction/ResponseWidget.js","../qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Correct.js","../qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Map.js","../qtiCreator/widgets/interactions/inlineChoiceInteraction/states/NoRp.js","../qtiCreator/widgets/interactions/inlineChoiceInteraction/states/states.js","../qtiCreator/tpl/inlineInteraction/inlineChoiceInteraction!tpl","../qtiCreator/tpl/inlineInteraction/inlineChoice!tpl","../qtiCreator/widgets/interactions/inlineChoiceInteraction/Widget.js","../qtiCreator/tpl/inlineInteraction/inlineChoiceInteraction.placeholder!tpl","../qtiCreator/renderers/interactions/InlineChoiceInteraction.js","../qtiCommonRenderer/tpl/interactions/matchInteraction!tpl","../qtiCommonRenderer/renderers/interactions/MatchInteraction.js","../qtiCreator/tpl/toolbars/matchInteraction.adder!tpl","../qtiCreator/tpl/interactions/matchInteraction.row!tpl","../qtiCreator/tpl/interactions/matchInteraction.cell!tpl","../qtiCreator/widgets/interactions/matchInteraction/states/Question.js","../qtiCreator/tpl/toolbars/matchInteraction.score!tpl","../qtiCreator/widgets/interactions/matchInteraction/ResponseWidget.js","../qtiCreator/widgets/interactions/matchInteraction/states/Correct.js","../qtiCreator/widgets/interactions/matchInteraction/states/Map.js","../qtiCreator/widgets/interactions/matchInteraction/states/states.js","../qtiCreator/widgets/interactions/matchInteraction/Widget.js","../qtiCreator/renderers/interactions/MatchInteraction.js","../qtiCommonRenderer/tpl/interactions/mediaInteraction!tpl","../qtiCommonRenderer/renderers/interactions/MediaInteraction.js","../qtiCreator/tpl/forms/interactions/media!tpl","../qtiCreator/widgets/interactions/mediaInteraction/states/Question.js","../qtiCreator/widgets/interactions/mediaInteraction/states/Answer.js","../qtiCreator/widgets/interactions/mediaInteraction/states/Sleep.js","../qtiCreator/widgets/interactions/mediaInteraction/states/states.js","../qtiCreator/widgets/interactions/mediaInteraction/Widget.js","../qtiCreator/tpl/interactions/mediaInteraction!tpl","../qtiCreator/renderers/interactions/MediaInteraction.js","../qtiCommonRenderer/tpl/interactions/orderInteraction!tpl","../qtiCommonRenderer/renderers/interactions/OrderInteraction.js","../qtiCreator/widgets/interactions/orderInteraction/states/Question.js","../qtiCreator/widgets/interactions/orderInteraction/states/Correct.js","../qtiCreator/widgets/interactions/orderInteraction/states/states.js","../qtiCreator/widgets/interactions/orderInteraction/Widget.js","../qtiCreator/renderers/interactions/OrderInteraction.js","../qtiCommonRenderer/tpl/interactions/customInteraction!tpl","../qtiCommonRenderer/helpers/PortableElement.js","../../qtiCustomInteractionContext.js","../qtiCommonRenderer/renderers/interactions/PortableCustomInteraction.js","../qtiCreator/renderers/interactions/PortableCustomInteraction.js","../qtiCommonRenderer/tpl/interactions/selectPointInteraction!tpl","../qtiCommonRenderer/renderers/interactions/SelectPointInteraction.js","../qtiCreator/widgets/interactions/selectPointInteraction/states/Sleep.js","../qtiCreator/tpl/forms/interactions/selectPoint!tpl","../qtiCreator/widgets/interactions/selectPointInteraction/states/Question.js","../qtiCreator/widgets/interactions/selectPointInteraction/states/Map.js","../qtiCreator/widgets/interactions/selectPointInteraction/states/states.js","../qtiCreator/widgets/interactions/selectPointInteraction/Widget.js","../qtiCreator/renderers/interactions/SelectPointInteraction.js","../qtiCommonRenderer/tpl/interactions/sliderInteraction!tpl","../qtiCommonRenderer/renderers/interactions/SliderInteraction.js","../qtiCreator/tpl/forms/interactions/slider!tpl","../qtiCreator/widgets/interactions/sliderInteraction/states/Question.js","../qtiCreator/widgets/interactions/sliderInteraction/states/Correct.js","../qtiCreator/widgets/interactions/sliderInteraction/states/states.js","../qtiCreator/widgets/interactions/sliderInteraction/Widget.js","../qtiCreator/renderers/interactions/SliderInteraction.js","../qtiCommonRenderer/tpl/interactions/textEntryInteraction!tpl","../qtiCommonRenderer/renderers/interactions/TextEntryInteraction.js","../qtiCreator/tpl/forms/interactions/textEntry!tpl","../qtiCreator/widgets/interactions/textEntryInteraction/states/Question.js","../qtiCreator/widgets/interactions/textEntryInteraction/states/Correct.js","../qtiCreator/tpl/inlineInteraction/textEntry!tpl","../qtiCreator/widgets/interactions/textEntryInteraction/states/Map.js","../qtiCreator/widgets/interactions/textEntryInteraction/states/states.js","../qtiCreator/tpl/inlineInteraction/textEntryInteraction!tpl","../qtiCreator/widgets/interactions/textEntryInteraction/Widget.js","../qtiCreator/tpl/inlineInteraction/textEntryInteraction.placeholder!tpl","../qtiCreator/renderers/interactions/TextEntryInteraction.js","../qtiCommonRenderer/tpl/interactions/uploadInteraction!tpl","../qtiCommonRenderer/helpers/uploadMime.js","../qtiCommonRenderer/renderers/interactions/UploadInteraction.js","../qtiCreator/tpl/forms/interactions/upload!tpl","../qtiCreator/widgets/interactions/uploadInteraction/states/Question.js","../qtiCreator/widgets/interactions/uploadInteraction/states/states.js","../qtiCreator/widgets/interactions/uploadInteraction/Widget.js","../qtiCreator/tpl/interactions/uploadInteraction!tpl","../qtiCreator/renderers/interactions/UploadInteraction.js","../qtiCommonRenderer/tpl/item!tpl","../qtiCommonRenderer/helpers/itemStylesheetHandler.js","../qtiCommonRenderer/renderers/Item.js","../qtiCreator/tpl/forms/item!tpl","../qtiCreator/widgets/item/states/Active.js","../qtiCreator/widgets/item/states/states.js","../qtiCreator/widgets/item/Widget.js","../qtiCreator/tpl/item!tpl","../qtiCreator/renderers/Item.js","../qtiCommonRenderer/tpl/math!tpl","../qtiCommonRenderer/renderers/Math.js","../qtiCreator/widgets/static/math/states/Sleep.js","../qtiCreator/tpl/forms/static/math!tpl","../qtiCreator/tpl/forms/static/mathPopup!tpl","../qtiCreator/widgets/static/math/states/Active.js","../qtiCreator/widgets/static/math/states/states.js","../qtiCreator/widgets/static/math/Widget.js","../qtiCreator/renderers/Math.js","../qtiCommonRenderer/tpl/modalFeedback!tpl","../qtiItem/helper/container.js","../qtiCommonRenderer/renderers/ModalFeedback.js","../qtiCreator/widgets/static/modalFeedback/states/Sleep.js","../qtiCreator/tpl/forms/static/modalFeedback!tpl","../qtiCreator/widgets/static/modalFeedback/states/Active.js","../qtiCreator/widgets/static/modalFeedback/states/states.js","../qtiCreator/widgets/static/modalFeedback/Widget.js","../qtiCreator/tpl/modalFeedback/modal!tpl","../qtiCreator/renderers/ModalFeedback.js","../qtiCommonRenderer/tpl/object!tpl","../qtiCommonRenderer/renderers/Object.js","../qtiCreator/widgets/static/object/states/Sleep.js","../qtiCreator/tpl/forms/static/object!tpl","../qtiCreator/widgets/static/object/states/Active.js","../qtiCreator/widgets/static/object/states/states.js","../qtiCreator/widgets/static/object/Widget.js","../qtiCreator/renderers/Object.js","../qtiCommonRenderer/tpl/infoControl!tpl","../../qtiInfoControlContext.js","../qtiCommonRenderer/renderers/PortableInfoControl.js","../qtiCreator/renderers/PortableInfoControl.js","../qtiCommonRenderer/tpl/rubricBlock!tpl","../qtiCommonRenderer/renderers/RubricBlock.js","../qtiCreator/widgets/static/rubricBlock/states/Sleep.js","../qtiCreator/tpl/forms/static/rubricBlock!tpl","../qtiCreator/widgets/static/rubricBlock/states/Active.js","../qtiCreator/widgets/static/rubricBlock/states/states.js","../qtiCreator/widgets/static/rubricBlock/Widget.js","../qtiCreator/renderers/RubricBlock.js","../qtiCommonRenderer/tpl/table!tpl","../qtiCommonRenderer/renderers/Table.js","../qtiCreator/widgets/static/table/states/Sleep.js","../qtiCreator/widgets/static/table/components/tableActions!tpl","../qtiCreator/widgets/static/table/components/tableActions.js","../qtiCreator/widgets/static/table/states/Active.js","../qtiCreator/widgets/static/table/states/states.js","../qtiCreator/tpl/toolbars/table!tpl","../qtiCreator/widgets/static/table/Widget.js","../qtiCreator/tpl/table!tpl","../qtiCreator/renderers/Table.js","../qtiCreator/widgets/helpers/pciMediaManager/propertiesForm!tpl","../qtiCreator/widgets/helpers/pciMediaManager/pciMediaManager.js","../qtiCreator/widgets/interactions/customInteraction/states/Question.js","../qtiCreator/widgets/interactions/customInteraction/states/Sleep.js","../qtiCreator/widgets/interactions/customInteraction/states/states.js","../qtiCreator/widgets/interactions/customInteraction/Widget.js","../qtiCreator/widgets/interactions/gapMatchInteraction/states/Answer.js","../qtiCreator/widgets/interactions/selectPointInteraction/states/Answer.js","../qtiCreator/widgets/static/portableInfoControl/states/states.js","../qtiCreator/widgets/static/portableInfoControl/Widget.js","../qtiXmlRenderer/tpl/element!tpl","../qtiXmlRenderer/renderers/choices/AssociableHotspot.js","../qtiXmlRenderer/renderers/choices/Gap.js","../qtiXmlRenderer/tpl/choices/gapImg!tpl","../qtiXmlRenderer/renderers/choices/GapImg.js","../qtiXmlRenderer/renderers/choices/GapText.js","../qtiXmlRenderer/renderers/choices/HotspotChoice.js","../qtiXmlRenderer/renderers/choices/Hottext.js","../qtiXmlRenderer/renderers/choices/InlineChoice.js","../qtiXmlRenderer/renderers/choices/SimpleAssociableChoice.js","../qtiXmlRenderer/renderers/choices/SimpleChoice.js","../qtiXmlRenderer/tpl/container!tpl","../qtiXmlRenderer/renderers/Container.js","../qtiXmlRenderer/renderers/feedbacks/ModalFeedback.js","../qtiXmlRenderer/renderers/Img.js","../qtiXmlRenderer/tpl/include!tpl","../qtiXmlRenderer/renderers/Include.js","../qtiXmlRenderer/tpl/interactions/blockInteraction!tpl","../qtiXmlRenderer/renderers/interactions/AssociateInteraction.js","../qtiXmlRenderer/renderers/interactions/ChoiceInteraction.js","../qtiXmlRenderer/renderers/interactions/EndAttemptInteraction.js","../qtiXmlRenderer/renderers/interactions/ExtendedTextInteraction.js","../qtiXmlRenderer/renderers/interactions/GapMatchInteraction.js","../qtiXmlRenderer/renderers/interactions/GraphicAssociateInteraction.js","../qtiXmlRenderer/tpl/interactions/graphicGapMatchInteraction!tpl","../qtiXmlRenderer/renderers/interactions/GraphicGapMatchInteraction.js","../qtiXmlRenderer/renderers/interactions/GraphicOrderInteraction.js","../qtiXmlRenderer/renderers/interactions/HotspotInteraction.js","../qtiXmlRenderer/tpl/interactions/hottextInteraction!tpl","../qtiXmlRenderer/renderers/interactions/HottextInteraction.js","../qtiXmlRenderer/renderers/interactions/InlineChoiceInteraction.js","../qtiXmlRenderer/tpl/interactions/matchInteraction!tpl","../qtiXmlRenderer/renderers/interactions/MatchInteraction.js","../qtiXmlRenderer/tpl/interactions/mediaInteraction!tpl","../qtiXmlRenderer/renderers/interactions/MediaInteraction.js","../qtiXmlRenderer/renderers/interactions/OrderInteraction.js","../qtiXmlRenderer/tpl/interactions/portableCustomInteraction/main!tpl","../qtiXmlRenderer/tpl/interactions/portableCustomInteraction/properties!tpl","../qtiXmlRenderer/helper/portableElementTpl.js","../qtiXmlRenderer/renderers/interactions/PortableCustomInteraction.js","../qtiXmlRenderer/renderers/interactions/Prompt.js","../qtiXmlRenderer/renderers/interactions/SelectPointInteraction.js","../qtiXmlRenderer/renderers/interactions/SliderInteraction.js","../qtiXmlRenderer/renderers/interactions/TextEntryInteraction.js","../qtiXmlRenderer/renderers/interactions/UploadInteraction.js","../qtiXmlRenderer/tpl/item!tpl","../qtiXmlRenderer/renderers/Item.js","../qtiXmlRenderer/renderers/Math.js","../qtiXmlRenderer/tpl/object!tpl","../qtiXmlRenderer/renderers/Object.js","../qtiXmlRenderer/tpl/outcomeDeclaration!tpl","../qtiXmlRenderer/renderers/OutcomeDeclaration.js","../qtiXmlRenderer/tpl/portableInfoControl!tpl","../qtiXmlRenderer/renderers/PortableInfoControl.js","../qtiXmlRenderer/tpl/responseDeclaration!tpl","../qtiXmlRenderer/renderers/ResponseDeclaration.js","../qtiXmlRenderer/tpl/responseProcessing!tpl","../qtiXmlRenderer/tpl/responses/match_correct!tpl","../qtiXmlRenderer/tpl/responses/map_response!tpl","../qtiXmlRenderer/tpl/responses/map_response_point!tpl","../qtiXmlRenderer/renderers/ResponseProcessing.js","../qtiXmlRenderer/tpl/responses/rule!tpl","../qtiXmlRenderer/tpl/responses/rule_condition!tpl","../qtiXmlRenderer/tpl/responses/rule_correct!tpl","../qtiXmlRenderer/tpl/responses/rule_incorrect!tpl","../qtiXmlRenderer/tpl/responses/rule_choices!tpl","../qtiXmlRenderer/renderers/responses/SimpleFeedbackRule.js","../qtiXmlRenderer/renderers/RubricBlock.js","../qtiXmlRenderer/renderers/Stylesheet.js","../qtiXmlRenderer/tpl/table!tpl","../qtiXmlRenderer/renderers/Table.js","../../../../../../../../../../onLayerEnd0.js"],"names":["define","QtiPreview","actions","index","QtiCreator","_","Promise","eventifier","_requirejs","window","require","_defaultLoadingOptions","reload","enabledOnly","runtimeOnly","loadModuleConfig","manifest","resolve","reject","baseUrl","requireConfigAliases","reqConfigs","modules","runtime","isArray","config","length","forEach","pciConfig","data","defaults","paths","file","push","runtimeModules","model","reduce","arguments","acc","conf","id","isString","merge","map","path","replace","typeIdentifier","methods","_loaded","__providers","_registry","get","version","this","find","last","registerProvider","moduleName","resetProviders","loadProviders","self","providerLoadingStack","forIn","provider","each","slice","call","isFunction","load","shift","trigger","getAllVersions","all","versions","getRuntime","pci","assign","label","message","getCreator","creator","response","getBaseUrl","loadRuntimes","options","loadPromise","then","loadStack","results","configLoadingStack","_pcis","moduleConfigs","catch","err","loadCreators","requiredCreatorHooks","requiredCreators","pciModel","hook","enabled","indexOf","creators","creatorHook","getTypeIdentifier","i","findIndex","module","enable","disable","isEnabled","$","__","QtiElements","classes","itemBody","parents","contains","abstract","atomicBlock","atomicInline","simpleBlock","simpleInline","flowStatic","blockStatic","inlineStatic","flow","tableCell","caption","xhtml","col","colgroup","div","dl","dt","dd","hr","math","li","ol","ul","object","param","table","tbody","tfoot","thead","td","th","tr","a","abbr","acronym","b","big","cite","code","dfn","em","kbd","q","samp","small","span","strong","sub","sup","tt","var","blockquote","address","h1","h2","h3","h4","h5","h6","p","pre","img","attributes","br","infoControl","qti","textRun","feedbackInline","feedbackBlock","rubricBlock","blockInteraction","inlineInteraction","gap","hottext","printedVariable","prompt","templateElement","templateBlock","templateInline","choiceInteraction","associateInteraction","orderInteraction","matchInteraction","hottextInteraction","gapMatchInteraction","mediaInteraction","sliderInteraction","uploadInteraction","drawingInteraction","graphicInteraction","hotspotInteraction","graphicAssociateInteraction","graphicOrderInteraction","graphicGapMatchInteraction","selectPointInteraction","textEntryInteraction","extendedTextInteraction","inlineChoiceInteraction","endAttemptInteraction","customInteraction","_container","cache","containable","children","getAllowedContainersElements","qtiClass","$container","getAllowedContainers","jqSelector","substring","document","filter","ret","getParentClasses","aClass","intersection","union","getChildClasses","getAllowedContents","recursive","checked","contain","child","uniq","isAllowedClass","qtiContainerClass","qtiContentClass","allowedClasses","type","cacheType","isBlock","is","isInline","topClass","getAvailableAuthoringElements","description","icon","short","tags","portableElementRegistry","qtiElements","getAuthoringData","RegExp","on","ciRegistry","registry","providers","name","icRegistry","assessmentItem","responseProcessing","_simpleFeedbackRule","stylesheet","outcomeDeclaration","responseDeclaration","associableHotspot","gapImg","gapText","hotspotChoice","inlineChoice","simpleAssociableChoice","simpleChoice","modalFeedback","include","buildSerial","prefix","chars","charAt","Math","floor","random","buildId","item","usedIds","suffix","exists","TypeError","getUsedIds","buildIdentifier","useSuffix","getUsedIdentifiers","isUndefined","findInCollection","element","collectionNames","searchedSerial","found","Error","collectionName","collection","split","nameToken","elt","parent","addMarkupNamespace","markup","ns","$0","$1","$2","$3","$4","removeMarkupNamespaces","getMarkupUsedNamespaces","namespaces","original","slash","node","rendererConfigHelper","getOptionsFromArguments","args","placeholder","subclass","renderer","arg","isRenderer","isPlainObject","console","log","Class","util","rendererConfig","_instances","Element","extend","serial","relatedItem","init","metaData","match","setAttributes","initContainer","initObject","getSerial","elts","getComposingElements","attr","value","undefined","prop","key","removeData","removeAttr","removeAttributes","getAttributes","clone","attrNames","append","getBody","getObject","v","isA","getUsedClasses","composingElts","location","getRelatedItem","setRelatedItem","setRenderer","getRenderer","render","_renderer","tplData","defaultData","tag","body","resolveUrl","getData","rendering","renderTpl","replaceWith","postRender","altClassName","postRenderers","compact","getContainer","$scope","toArray","arr","isEmpty","addClass","className","clazz","_containClass","hasClass","removeClass","regex","trim","toggleClass","state","isset","issetElement","unset","unsetElement","allClassStr","test","qtiElement","getElementBySerial","composingElements","qtiClasses","loadPortableCustomElementData","portableElement","entryPoint","properties","libraries","Loader","classesLocation","setClassesLocation","getRequiredClasses","loadRequiredClasses","callback","requiredClasses","required","requiredClass","_this","QtiClass","prototype","getLoadedClasses","keys","loadItemData","Qti","loadContainer","outcomes","outcome","buildOutcome","addOutcomeDeclaration","feedbacks","feedback","buildElement","addModalFeedback","stylesheets","addStylesheet","responses","buildResponse","addResponseDeclaration","feedbackRules","fbData","buildSimpleFeedbackRule","setResponseProcessing","buildResponseProcessing","setNamespaces","setSchemaLocations","schemaLocations","setApipAccessibility","apipAccessibility","loadAndBuildElement","loadElement","loadElementData","loadElements","allElements","elementData","template","howMatch","defaultValue","correctResponse","correctResponses","size","mapping","mapEntries","areaMapping","mappingAttributes","feedbackRule","setCondition","condition","comparedValue","feedbackOutcome","feedbackThen","modalFeedbacks","feedbackElse","comparedOutcome","rp","processingType","xml","bodyObject","bodyData","elements","eltData","setElement","bdy","loadObjectData","loadInteractionData","loadChoiceData","loadMathData","loadPicData","interaction","buildInteractionChoices","loadPciData","choices","set","matchSet","choice","addChoice","gapImgs","addGapImg","val","text","_alt","setMathML","mathML","annotations","encoding","setAnnotation","pic","_ns","eventList","event","choiceCreated","deleted","off","getList","addedNamespace","events","e","initElementToWidgetListeners","join","container","getNs","getNsModel","completelyValid","invalidElements","valid","invalid","stateName","isValid","invalidator","url","_removeSelf","removed","related","removeGapImg","removeChoice","beforeRemove","removeElement","_removeElement","containerPropName","eltToBeRemoved","targetElt","targetSerial","getDefaultAttributes","_super","encodeAsXmlAttr","remove","createElements","subClass","values","qtiClassElt","newElts","newBody","setElements","$doc","afterCreate","containerHelper","augment","targetClass","methodName","Object","hasOwnProperty","_parent","apply","returnValue","getElements","getElement","elementsData","tpl","renderDirect","contentModel","flatten","concat","Mixin","Container","IdentifiedElement","Item","getInteractions","interactions","getResponseDeclaration","identifier","getOutcomeDeclaration","getOutcomes","removeOutcome","omit","elementCollection","getResponses","addNamespace","uri","getNamespaces","locations","getSchemaLocations","apip","getApipAccessibility","removeStyleSheet","stylesheetExists","href","$dummy","html","$children","clear","destroy","editable","Stylesheet","title","media","ResponseProcessing","setProcessingType","r","setTemplate","setDefaultValue","getDefaultValue","VariableDeclaration","OutcomeDeclaration","ModalFeedback","showHide","editableContainer","adaptive","timeDependent","createResponseProcessing","createStyleSheet","createOutcomeDeclaration","createModalFeedback","deleteResponseDeclaration","rule","_generateIdentifier","pos","lastIndexOf","substr","qtiNamespace","qtiSchemaLocation","http://www.imsglobal.org/xsd/imsqti_v2p2","loadItem","ajax","itemDataUrl","dataType","done","loader","itemData","newItem","loadedItem","","xsi","m","convertChoices","outputType","c","findChoices","inputType","getChoice","getChoiceByIdentifier","shuffleChoices","f","j","n","k","tmp","serialToIdentifier","choiceSerial","Handlebars","interactionHelper","themeLoader","getDocumentBaseUrl","protocol","host","pathname","_isValidRenderer","classCorrect","_renderableClasses","_renderableSubclasses","_dependencies","_defaults","Renderer","registerRendererClass","list","success","_locations","_renderers","shuffledChoices","_getClassRenderer","setOption","setOptions","opts","getOption","getCustomMessage","elementName","messageKey","messages","compile","getAssetManager","assetManager","getThemeLoader","qtiSubclass","res","decorators","isObject","before","after","setResponse","qtiInteraction","getResponse","resetResponse","getState","setState","getLoadedRenderers","register","renderersLocations","themes","base","available","theme","reqClass","deps","requiredSubClasses","unload","setShuffledChoices","identificationType","pluck","getShuffledChoices","reshuffle","returnedType","getChoices","getRenderers","getLocations","getAbsoluteUrl","relUrl","warn","absUrl","runtimeLocations","runtimeLocation","setAreaBroker","areaBroker","_areaBroker","getAreaBroker","build","defaultOptions","NewRenderer","urlUtil","strategies","parseUrl","_strategies","addStrategy","strategy","handle","setStrategies","newStrategies","setData","resolved","inputUrl","parse","result","resolveBy","clearCache","prependToUrl","slashcat","directory","encodeURIComponent","isRelative","itemCssNoCache","bust","Date","now","external","isAbsolute","toString","base64","isBase64","taomedia","getBaseUrlByIdentifier","source","relative","fullmatch","relPath","context","assetManagerFactory","assetStrategies","portableAssetStrategy","itemThemes","moduleConfig","simpleChoice.choiceInteraction","simpleChoice.orderInteraction","simpleAssociableChoice.matchInteraction","simpleAssociableChoice.associateInteraction","root_url","enableDragAndDrop","associate","associateDragAndDrop","gapMatch","gapMatchDragAndDrop","graphicGapMatch","graphicGapMatchDragAndDrop","order","orderDragAndDrop","commonRenderConfig","dom","_creatorRenderer","_configurableInteractions","_extractInteractionsConfig","interactionName","reset","$bodyEltForm","lang","itemOptionForm","interactionOptionForm","choiceOptionForm","responseOptionForm","bodyElementOptionForm","textOptionForm","modalFeedbackOptionForm","mediaManager","appendContainer","browseUrl","getFilesUrl","uploadUrl","fileUploadUrl","deleteUrl","fileDeleteUrl","downloadUrl","fileDownloadUrl","fileExistsUrl","mediaSourcesUrl","_containers","_$containerContext","_getSelector","selector","setContext","eventType","triggerResponseChangeEvent","extraData","targetBlank","preventDefault","open","_$previousContext","commonRenderer","$context","restoreContext","_getElementSelector","getQtiClassFromXmlDom","$node","toLowerCase","_qtiClassNames","$elt","specified","buildMath","$annotation","unescape","parseContainer","_defaultOptions","_parsableElements","$qtiElement","_placeholder","rubricblock","loaded","xmlStr","simpleParser","xinclude","stimulusXml","$wrapper","$sampleXMLrootNode","$stimulus","loadedClasses","xincludeLoader","xincludeWidget","newHref","xi","refresh","hb","depth0","helpers","partials","program1","stack1","helper","buffer","subGroup","hash","functionType","escapeExpression","program3","program5","program7","program9","compilerInfo","inverse","noop","fn","program","disabled","iconFont","hider","insertInteractionTpl","insertSectionTpl","tooltipTpl","tooltip","getGroupId","groupLabel","getGroupSectionId","addGroup","$sidebar","groupId","$section","create","interactionAuthoringData","add","buildSubGroups","_events","interactiontoolbarready","getGroup","isReady","whenReady","interactionClass","hide","show","subGroupId","$group","dev","_subgroups","$interaction","$subGroupPanel","$subGroupList","$cover","$element","class","addInlineInteractionTooltip","timer","$inlineInteractionsPanel","$tooltip","css","position","zIndex","top","right","setTimeout","qtip","clearTimeout","inline-interactions","getCustomInteractionTag","_getItemContainer","showPanel","$panel","$fold","openSections","closeSections","initFormVisibilityListener","$itemContainer","_staticElements","$formInteractionPanel","$formChoicePanel","$formResponsePanel","$formItemPanel","$formBodyElementPanel","$formTextBlockPanel","$formModalFeedbackPanel","$formStylePanel","$appearanceToggler","$menuLabel","$itemIcon","$styleIcon","_toggleAppearanceEditor","active","delay","enableSubGroup","toggleInlineInteractionGroup","disableSubGroup","panel","initSidebarAccordion","$sections","$allTriggers","$heading","$closer","$opener","action","heading","classFn","preserveOthers","close","forceState","_toggleSections","sections","_toggleSubGroup","interactionsToolbar","typeId","editLabelTxt","deleteTxt","downloadTxt","UrlParser","cssTpl","itemConfig","globalConfig","currentItem","_getUri","_basename","style","$styleElem","styleElem","empty","common","preparingMessageHtml","failMessageHtml","isInValidLocalTxt","customStylesheet","erase","dontAppend","key1","key2","mSelector","mProp","property","verifyInit","save","post","cssJson","JSON","stringify","stylesheetUri","fail","xhr","status","download","fileDownload","successCallback","httpMethod","fileName","link","listEntry","parser","loadStylesheet","isLocal","isInvalidLocal","isInit","pendingStylesheetsInit","initializing","_link","_href","_sep","getTime","checkCORS","when","addItemStylesheets","currentStylesheet","removeOrphanedStylesheets","getItem","resizerTarget","getJSON","_style","width","getStyle","helperMissing","styleEditor","genericFeedbackPopup","_createInfoBox","$messageBox","closeTrigger","fadeOut","cssToggler","uploader","customCssToggler","getContext","closest","stylesheetObj","input","labelBox","prev","isCustomCss","isDisabled","cssUri","resourcemgr","root","params","filters","pathParam","select","files","l","deleteStylesheet","cssLinks","initLabelEditor","downloadStylesheet","saveLabel","handleAvailability","attrTo","attrFrom","target","keyCode","sans-serif","serif","monospace","fontStacks","generic","optGroup","option","fontSelector","$target","resetButton","format","originalOption","select2","font","toUpperCase","fontFamily","formatResult","formatSelection","dataAttrHandler","reorderZindex","$trigger","$popup","$actionBar","baseOffsetTop","offset","height","maxHeight","isNull","$titleArea","$title","popup","max","_trigger","getTarget","$dragger","not","draggable","jQuery","farbtastic","_farbtastic","fb","colorObj","wheelObj","overlayObj","hMarkerObj","slMarkerObj","wheel","radius","square","linkTo","unbind","updateValue","color","bind","setColor","unpack","rgb","hsl","RGBToHSL","updateDisplay","setHSL","HSLToRGB","pack","widgetCoords","x","y","el","srcElement","reference","offsetX","offsetY","mouseX","mouseY","offsetLeft","offsetTop","offsetParent","absolutePosition","pageX","clientX","scrollLeft","pageY","clientY","scrollTop","mousedown","dragging","mousemove","mouseup","circleDrag","abs","hue","atan2","sat","min","lum","angle","left","round","sin","cos","backgroundColor","g","parseInt","m1","m2","h","s","hueToRGB","delta","rgbToHex","toHexPair","inp","rgbArr","exec","widgetObj","colorPicker","widget","widgetBox","titleElement","resetButtons","colorTriggers","colorTriggerLabels","currentProperty","setTitle","setTriggerColor","$tmpTrigger","nodeName","has","$this","$colorTrigger","$fontSizeChanger","itemSelector","$item","itemFontSize","$resetBtn","$input","resizeFont","blur","itemResizer","targetWidth","innerWidth","itemWidthPrompt","sliderBox","slider","sliderSettings","range","start","resizeItem","slideDown","slideUp","noUiSlider","styleSheetToggler","colorSelector","fontSizeChanger","itemLoader","creatorRenderer","xincludeRenderer","interactionPanel","propertiesPanel","eventHelper","loadCustomInteractions","interactionsIds","loadInfoControls","pluginFactories","plugins","pluginRun","method","execStack","plugin","pluginFactory","getName","silent","itemWidget","usedCustomInteractionIds","getItemPanelArea","getInteractionPanelArea","getPropertyPanelArea","getConfig","requireAreas","partial","cssClass","buttonTpl","itemCreator","getHost","getMenuArea","removeProp","tablets","193986c3715c81838870f908fa98d69a","4e8eafab11aad1486992d7ee2c8c16ca","5aac2932d9ad00d6d8a1604b8f9e4e8d","9805d9753ad08c7630a9ee5418aa6c6c","d4a431cedf4705d6bf2cba6d5788378b","phones","1b89338531ef0155c8d6abc2ac02c81a","scaleFactor","dpWidth","dpHeight","3f89da99d84214cde7df87ebe0699a6f","0d36971a5b98b367f54ced708c9af849","026beffcc051af995660ebdede986ace","fd2dd53e667d6d49e4fa73356fa941dd","707584c1ae17d9b5b2cbe8603c91c147","91823264de952e7f2347e07db5c4058b","cd69817a6e147e8a4677389e56fcf568","75994faa6a38e31e99b53fcd75534a33","0cab4dfccdfc880687cb608cfe4159db","c4ff41fcba24d74fc21dc3490ca1edc9","fa969a5e0dd2de53700eeee4ba4ba142","33c4f9364e295ec03531f3a3425819cf","bc47f5275f0efd56fee52d43a8082981","0732887e6e324fd10777b735520a34cf","2e38a78364f09d0da0e9e1a3a68e7fb0","bd4b78dddc7c9625a4141a1b1ddabb87","3bf1edf21cfa81006183d2b02974c84e","ab5a352e0e016b97dac986f06c394f55","4826fb7d7257aeaac992ce699df41b3c","0a691ab20add7c432200f8fa6527b488","9c23ee31be29960fbac9e9bbfc2fc7b0","92177c0508c1d73905a58e2338f2a81f","5222b8866dc4cc606725e16ffcc0a783","37c1541e2bd55cfd0f4073b0ccdf68b3","2f7f64b7dda0144907ff300e83eed465","9c24f9057744dad56043702a9703127f","0a8b2732a016a9395c3af5f12dd9c0da","5a153d7f53d82dcb0801f041574a6a43","screens","9e523ae15b61dc766f5c818726881ecf","07769cd8d0a7d09818b2f0b018042fb7","72d5478a24194f98b9378e8e0fd65737","b7a6dd5900cc72e61f0d3479c7e314ec","43193b0ff671a37d8232ab664190a125","c29e48814af5443ff5688d9e967ce917","selected","program2","program4","program6","dataValue","previewType","previewTypes","hasThemes","desktopDevices","mobileDevices","strPad","deviceList","previewTpl","themeHandler","_setupScreenSize","screenSize","innerHeight","overlay","typeDependant","$feedbackBox","$console","previewContainerMaxWidth","itemUri","orientation","desktop","mobile","standard","themeObj","$window","$body","sizeSettings","winScrollObj","_getDeviceSelectorData","devices","_setupTypeDependantElements","_setPreviewType","newType","re","_setOrientation","newOrientation","previewFrame","_scale","_computeScaleFactor","$scaleContainer","_scaleFactor","containerScaledWidth","-webkit-transform","-ms-transform","transform","-webkit-transform-origin","-ms-transform-origin","transform-origin","_positionPreview","topBarHeight","outerHeight","scaleValues","requiredSize","_setupDeviceSelectors","previewDeviceSelectors","elem","selectedIndex","parseFloat","_adaptFrameSize","minimumResultsForSearch","_setupOrientationSelectors","_setupClosers","$feedbackCloser","$hideForever","$iframe","scrollTo","keyup","cookie","expires","_getThemes","activeTheme","getActiveTheme","_getPreviewTypes","_previewLabel","_previewType","_setupViewSelector","_setupThemeSelector","iframe","getElementById","contentWindow","contentDocument","$previewContainer","_iframe","contentHeight","contents","containerHeight","_updateStandardPreviewSize","$selector","valueStr","_initConsole","$listing","logTime","getHours","getMinutes","getSeconds","msgStr","parsed","scrollX","scrollY","display","statusText","_itemUri","_state","preview","previewUrl","spreadClass","siblings","print","getTitleArea","dialog","removeChangeHandlers","leave","exit","styleChanges","asking","getSerializedItem","serialized","originalItem","hasChanged","silentSave","confirmBefore","confirmDlg","buttons","autoRender","autoDestroy","onSaveBtn","onDontsaveBtn","onCancelBtn","one","detail","stopImmediatePropagation","click","validators","_qtiIdPattern","qtiValidators","validate","ids","global","addEventListener","attachEvent","inArray","len","moveCaret","createTextRange","move","selectionStart","focus","setSelectionRange","changeType","Placeholders","Utils","safeActiveElement","activeElement","hidePlaceholder","keydownValue","maxLength","valueChanged","isPlaceholderValue","getAttribute","ATTR_CURRENT_VAL","ATTR_ACTIVE","removeAttribute","classNameRegExp","ATTR_MAXLENGTH","setAttribute","ATTR_INPUT_TYPE","showPlaceholder","placeholderClassName","handleElem","handleInputsLength","handleTextareasLength","handleInputs","handleTextareas","getElementsByTagName","inputs","textareas","disablePlaceholders","enablePlaceholders","makeFocusHandler","hideOnInput","makeBlurHandler","makeKeydownHandler","keydownVal","badKeys","makeKeyupHandler","makeClickHandler","makeSubmitHandler","form","newElement","ATTR_FORM_HANDLED","ATTR_EVENTS_BOUND","liveUpdates","styleRules","validTypes","createElement","head","documentElement","nativeSupport","createTextNode","styleSheet","cssText","nodeValue","appendChild","insertBefore","firstChild","setInterval","clearInterval","spinner","_updateResponseDeclaration","maxChoice","updateCardinality","correct","getCorrect","setCorrect","_validationCallback","validatorOptions","_createTooltip","where","content","initWidget","$form","setChangeCallbacks","validateOnInit","invalidate","_callbackCall","cb","simple","withValidation","namespace","defer","groupValidator","removeChangeCallback","initTitle","inplacer","getAttributeChangeCallback","allowEmpty","getMinMaxAttributeCallbacks","attributeNameMin","attributeNameMax","allowNull","attrMethodNames","floatVal","$max","callbacks","isActualNumber","newOptions","isNaN","incrementer","_templateNames","MATCH_CORRECT","MAP_RESPONSE","MAP_RESPONSE_POINT","NONE","isUsingTemplate","isValidTemplateName","tplName","getTemplateUriFromName","getTemplateNameFromUri","tplUri","gamp","responseHelper","pairExists","pair","setNormalMaximum","normalMaximum","scoreOutcome","interactionMaxScore","getNormalMaximum","isNumber","setMaxScore","customOutcomes","maxScore","maxScoreOutcome","hasInvalidInteraction","cardinality","baseType","getMatchMaxOrderedChoices","choiceCollection","matchMax","Infinity","sortBy","reverse","valueOf","choiceInteractionBased","minChoice","scoreMaps","requiredChoiceCount","totalAnswerableResponse","sortedMapEntries","missingMapsCount","mapDefault","maxChoices","minChoices","first","times","score","upperBound","orderInteractionBased","associateInteractionBased","requiredAssoc","usedChoices","choicesIdentifiers","allPossibleMapEntries","infiniteScoringPair","maxAssoc","possiblePairs","checkInfinitePair","countBy","count","forEachRight","mapEntry","choiceId","_usedChoices","cloneDeep","used","gapMatchInteractionBased","skippableWrongResponse","usedGaps","group1","group2","pairs","matchSet1","matchSet2","getGaps","choice1","choice2","gapId","selectPointInteractionBased","mappedValue","sliderInteractionBased","textEntryInteractionBased","isPossibleResponse","patternMask","XmlRenderer","_xmlRenderer","listing","readonly","interpretation","titleDelete","titleEdit","normalMinimum","formElement","xmlRenderer","panelTpl","listingTpl","getRpUsedVariables","rpXml","variables","renderListing","$outcomeEditorPanel","rpVariables","outcomesData","$responsePanel","$outcomeContainer","$labelContainer","$identifierLabel","$identifierInput","newOutcome","pluginLoader","changeTracker","outcomeEditor","menu","loggerFactory","loadingBar","itemCreatorFactory","areaBrokerFactory","loadAreaBroker","menuLeft","menuRight","propertyPanel","itemPanel","itemPropertyPanel","itemStylePanel","modalContainer","logger","reportError","stop","error","contextPlugins","exclude","getPlugins","throttle","resize","getColUnits","cssClasses","colMatch","pop","setUnitsFromClass","$el","units","_syncHandleHeight","$row","_createResizables","marginWidth","$col","$nextCol","next","nextMin","unitWidth","activeHeight","$activeZone","$handle","_syncOutlineHeight","containment","outerWidth","activeWidth","axis","cursor","$overlay","border-right-width","drag","nextUnits","_setColUnits","_deleteResizables","newUnits","oldUnits","$parentRow","totalUnits","preserveGlobalEvents","syncHandleHeight","getSelection","selection","createRange","containElement","commonAncestorContainer","nodeType","selectedChildNodes","cloneContents","childNodes","wrapSelection","wrap","sel","rangeCount","getRangeAt","cloneRange","startOffset","endOffset","surroundContents","removeAllRanges","addRange","unwrapSelection","$editable","textWrapper","wrappedText","unwrap","resizable","contentHelper","getContent","inner","destroyGridWidgets","serializeElements","getChangeCallback","$pseudoContainer","getChangeCallbackForBlockStatic","wrapInner","existingElements","$qtiElementWidget","inClone","arrow","leftCover","groups","popupTpl","contentTpl","$anchor","positions","_computePosition","_renderContent","_activatePanel","_activateElement","_done","_cancel","getPopup","reposition","activatePanel","groupName","activateElement","cancel","group","_anchor","w","_popup","_filterInteractions","block","filtered","unshift","_pushState","currentState","registeredStates","stateStack","_popState","$original","buildContainer","offEvents","getRequiredOptions","opt","initCreator","ready","changeState","getCurrentState","superStateName","exitedStates","enteredStates","trace","superState","difference","eachRight","_superStateName","registerState","State","registerStates","states","afterStateInit","evtName","beforeStateInit","afterStateExit","beforeStateExit","rebuild","postRenderOpts","qtiElementEventName","live","eventNames","$document","eventName","eventNameToken","what","why","defaultConfig","toolbar","responseButton","answerEditors","questionEditors","contentButton","msg","undo","closer","fadeIn","structure","bar","items","isTextButton","button","handleConfig","extendDefaultConfig","buildToolbar","tlbWrapper","tlb","box","ic","attach","buttonConfig","barConfig","defaultBarConfig","Widget","StaticWidget","createToolbar","$wrap","data-serial","createOkButton","data-edit","margin","stopPropagation","_isValidStateDefinition","_create","superStates","$parentWidget","initFn","exitFn","Clone","createBundle","arg0","arg1","arg2","stateBundle","newStates","excluded","throwMissingRequiredImplementationError","functionName","stateFactory","SleepState","_widget","gridContentHelper","$placeholder","$widget","changeInnerWidgetState","outerWidget","innerWidget","Active","equal","deletingInfoTpl","_destroy","_bindEvents","ctrlKey","metaKey","_confirmDeletion","fadeDelay","createInfoBox","widgets","margin-left","distributeUnits","cols","_cols","minimized","decimals","avg","refactoredTotalUnits","refactoredUnits","decimal","middleUnitValue","lastUnitValue","middle","redistributeUnits","totalRefactoredUnits","negative","positive","rounded","distribute","redistribute","deletingHelper","gridUnits","gridHelper","DeletingState","updateBody","$elementToRemove","getElementToRemove","hideWidget","showMessage","showWidget","$tbody","$tds","$subCol","$colMulti","_isCol","_redistributeUnits","attrClass","usedUnits","$otherCols","deleteElement","messageBox","factory","uniqueId","ckConfigurator","mathJax","qtiImage","qtiMedia","qtiInclude","underline","editor","toolbarType","CKEditor","groupToggler","getTrigger","$editableContainer","$toolbar","_buildEditor","ckConfig","dtdMode","autoParagraph","enterMode","ENTER_P","floatSpaceDockedOffsetY","taoQtiItem","insert","tempWidget","$newContent","_htmlEncode","createdWidget","createdElement","allAttributes","_activateInnerWidget","floatSpace","debug","initialHide","centerElement","floatSpaceApi","nose","oldParent","newParent","gpeToggler","changeMode","oldYMode","newYMode","$nose","domElem","dfd","Deferred","counter","check","promise","instanceReady","debounce","_detectWidgetDeletion","change","_rebuildWidgets","restoreState","shieldInnerContent","_shieldInnerContent","_focus","configLoaded","getTooltypeFromContainer","highlight","afterPaste","inline","_find","dataAttribute","_findWidgetContainer","undoCmd","getCommand","resetUndo","undoManager","addShield","$shield","containerWidget","listenToWidgetCreation","targetWidget","encodedStr","parentNode","moveToElementEditablePosition","selectRanges","passthroughInnerContent","hideTriggerOnBlur","disableAutoInline","hasEditor","buildEditor","editorOptions","destroyEditor","focusManager","escape","htmlEditor","formTpl","TextActive","initForm","toolbarTpl","TextWidget","data-qti-class","data-html-editable","$tlb","adderTpl","elementSelector","$editorPanel","_getItemBody","_initInsertion","_wrap","$colRow","$itemEditorPanel","prepend","_insertElement","_endInsertion","_appendButton","onPciReady","$adder","data-new","$colParent","$textBlock","observeContentChanges","contextDomNode","MutationObserver","WebKitMutationObserver","MozMutationObserver","mutations","observe","subtree","characterData","getSelector","protect","selectorParam","wrapper","iWidth","iHeight","cover","getProtectedWidgetBySerial","positionCover","iOffset","innerHTML","unprotect","$colorPicker","$colorPickerInput","htmls","markupSelector","extractHtmlFromMarkup","containerEditors","$toolbarLocation","$appendTo","cleanup","createFakeWidget","markupStr","$found","_eventName","_buildArrows","insertZoneWidth","$insertRight","_removeArrows","$insertLeft","_arrowFall","$insert","interval","relY","$arrow","t","pow","dtdHandler","_qtiHtmlEditableTypes","dh","inheritedFunctions","fns","Function","getTargetsFor","$qtiContainers","$targets","getParentsOf","parentSelector","$qtiContainer","$closest","targetFinder","droppableGridEditor","createDroppableBlocks","minUnits","$colInitial","initialPosition","_getNewRow","_getNewCol","$cols","_appendPlaceholder","_resetPlaceholder","_insertBetween","_restoreTmpCol","distributedUnits","$newCol","newUnit","cumulatedUnits","_appendToNextRow","_resetColsHeight","andSelf","$prev","prevAll","$next","nextAll","$previousCol","$newRow","$selectedCol","dropped","_destroyDroppableBlocks","_pulse","animate","opacity","intervalDuration","createDroppableInlines","data-inline","detach","_showPlaceholder","parentOffset","_destroyDroppableInlines","destroyDroppables","_toBeRemoved","data-units","originalClasses","droppable","_insertableDefaultsOptions","createInsertable","$to","createDraggable","distance","appendTo","scroll","cursorAt","bottom","ui","createMovable","$parent","initial-position","initial-class","_destroyDraggables","isCreated","gridEditor","Array","elementClass","addInsertables","$elts","$grid","createMovables","setContent","MathJax","MathEditor","tex","processing","$buffer","mathMLstr","_stripMathTags","_stripComments","setTex","texStr","_processArguments","mathEditor","renderFromMathML","jaxQueue","Hub","queue","mathStr","_wrapMathTags","Push","$script","renderFromTex","texJax","_getJaxByElement","texToMathML","elementJax","displayBlock","toMathML","restart","Callback","After","variadic","numFixedArgs","__slice","varArg","iterator","generator","send","yield_","obj","cons","pray","cond","prayDirection","dir","L","R","prayWellFormed","leftward","rightward","ends","insistOnInterVer","MathQuill","MQ1","getInterface","MQ","blockId","mqBlockId","ctrlr","Node","byId","controller","APIClasses","KIND_OF_MQ","currentOptions","handlers","processor","optionProcessors","MIN","MAX","Options","registerEmbed","EMBEDS","AbstractMathQuill","P","Progenote","__controller","__options","__mathquillify","classNames","createTextarea","jQ","latex","revert","exportText","renderLatexMath","blurred","exportLatex","reflow","postOrder","EditableField","super_","delegateMouseEvents","editablesTextareaEvents","textarea","write","writeLatex","scrollHoriz","cmd","notify","klass","LatexCmds","replaces","replaceSelection","createLeftOf","insAtRightEnd","selectLeft","clearSelection","moveToDirEnd","insAtDirEnd","moveToLeftEnd","moveToRightEnd","keystroke","typedText","dropEmbedded","elementFromPoint","seek","Embed","kind","API","defAPIClass","APIClass","mq","Controller","RootBlock","RootBlockMixin","names","makeTextBlock","tagName","attrs","TextBlock","ctrlSeq","htmlTemplate","insLeftOfMeUnlessAtEnd","ancestorCmd","insLeftOf","insRightOf","DelimsMixin","jQadd","delimjQs","contentjQ","scale","bindCharBracketPair","OPP_BRACKS","end","CharCmds","Bracket","moreArgs","ownProperty","o","SuperclassBare","_superclass","definition","C","Bare","extensions","proto","constructor","mixin","def","ext","insDirOf","insertAfter","prependTo","Point","copy","pt","uniqueNodeId","dispose","jQize","cmdId","nextSibling","createDir","adopt","selectChildren","leftEnd","rightEnd","Selection","bubble","ancestor","recurse","descendant","eachChild","Fragment","foldChildren","fold","withDirAdopt","withDir","oppDir","disown","accum","disowned","Cursor","initParent","_jQ","blink","upDownCache","intervalId","withDirInsertAt","insAtLeftEnd","jumpUpDown","from","to","cached","unwrapGramp","gramp","greatgramp","uncle","cousin","siblingDeleted","startSelection","anticursor","ancestors","endSelection","lca","antiAncestor","selectionChanged","deleteSelection","seln","wrapAll","notifyees","onNotify","interfaceVersion","noConflict","origMathQuill","Parser","parseError","stream","skip","eof","or","alternative","onSuccess","onFailure","failure","newStream","nextParser","many","xs","firstFailure","secondFailure","succeed","atMost","atLeast","two","string","str","expected","letter","letters","digit","digits","whitespace","optWhitespace","any","saneKeyboardEvents","evt","which","keyVal","KEY_VALUES","modifiers","originalEvent","altKey","shiftKey","String","fromCharCode","8","9","10","13","16","17","18","20","27","32","33","34","35","36","37","38","39","40","45","46","144","checkTextareaFor","checker","checkTextarea","timeoutId","shouldBeSelected","hasSelection","selectionEnd","handleKey","keydown","onKeydown","keypress","onKeypress","onBlur","onPaste","pastedText","paste","focusout","focusBlurEvents","windowBlur","blurTimeout","ctrlDeleteDir","backspace","escapeDir","selectRight","moveLeft","moveRight","moveUp","moveDown","deleteForward","moveOutOf","moveTowards","deleteOutOf","deleteTowards","unselectInto","selectOutOf","selectTowards","moveUpDown","dirInto","dirOutOf","leftRightIntoCmdGoes","updown","moveDir","deleteDir","hadSelection","selectDir","latexMathParser","commandToBlock","MathBlock","joinBlocks","blocks","firstBlock","variable","Letter","symbol","VanillaSymbol","controlSequence","cmdKlass","command","mathGroup","mathSequence","mathBlock","optMathBlock","latexMath","optBlock","finalizeInsert","siblingCreated","renderLatexText","mathMode","rootMathCommand","RootMathCommand","createBlocks","rootMathBlock","escapedDollar","textChar","latexText","commands","ultimateRootjQ","docmousemove","textareaSpan","rootjQ","ownerDocument","unselectable","nodeId","targetParent","rootRect","getBoundingClientRect","rect","overLeft","overRight","scrollBy","substituteTextarea","setTextareaSelection","forceIERedraw","textareaSelectionTimeout","statelessClipboard","selectFn","staticMathTextareaEvents","keyboardEventsShim","ch","MathElement","MathCommand","textTemplate","replacedFragment","numBlocks","placeCursor","updownInto","getBounds","bounds","cmdBounds","leftLeftBound","blockBounds","matches","tokens","token","nesting","child_text","Symbol","BinaryOperator","spaceBehavesLikeTab","chToCmd","Digit","StaticMath","innerFields","MathField","returned","RootMathBlock","fuseChildren","normalize","textPcDom","textPc","TextPiece","replacedText","textBlock","textContents","appendText","leftBlock","leftPc","avgChWidth","approxPosition","splitRight","displ","prevDispl","cursorPosition","anticursorPosition","newTextPc","endChar","appendData","prependText","insertData","insTextAtDirEnd","newPc","splitText","deleteData","textnormal","textrm","textup","textmd","italic","italics","emph","textit","textsl","bold","textbf","sf","textsf","texttt","textsc","uppercase","lowercase","RootTextBlock","TextField","_replacedFragment","renderCommand","notin","cong","equiv","oplus","otimes","ne","neq","ast","star","loast","lowast","therefor","therefore","cuz","because","propto","asymp","approx","isin","ni","notni","niton","notcontains","doesnotcontain","subset","supset","superset","nsub","notsub","nsubset","notsubset","nsup","notsup","nsupset","notsupset","nsuperset","notsuperset","sube","subeq","subsete","subseteq","supe","supeq","supsete","supseteq","supersete","superseteq","nsube","nsubeq","notsube","notsubeq","nsubsete","nsubseteq","notsubsete","notsubseteq","nsupe","nsupeq","notsupe","notsupeq","nsupsete","nsupseteq","notsupsete","notsupseteq","nsupersete","nsuperseteq","notsupersete","notsuperseteq","N","naturals","Naturals","primes","Primes","projective","Projective","probability","Probability","Z","integers","Integers","Q","rationals","Rationals","reals","Reals","complex","Complex","complexes","Complexes","complexplane","Complexplane","ComplexPlane","H","Hamiltonian","quaternions","Quaternions","quad","emsp","qquad","diamond","bigtriangleup","ominus","uplus","bigtriangledown","sqcap","triangleleft","sqcup","triangleright","odot","circledot","bigcirc","dagger","ddagger","wr","amalg","models","prec","succ","preceq","succeq","simeq","mid","ll","gg","parallel","nparallel","bowtie","sqsubset","sqsupset","smile","sqsubseteq","sqsupseteq","doteq","frown","vdash","dashv","nless","ngtr","longleftarrow","longrightarrow","Longleftarrow","Longrightarrow","longleftrightarrow","updownarrow","Longleftrightarrow","Updownarrow","mapsto","nearrow","hookleftarrow","hookrightarrow","searrow","leftharpoonup","rightharpoonup","swarrow","leftharpoondown","rightharpoondown","nwarrow","ldots","cdots","vdots","ddots","surd","triangle","ell","flat","natural","sharp","wp","bot","clubsuit","diamondsuit","heartsuit","spadesuit","parallelogram","oint","bigcap","bigcup","bigsqcup","bigvee","bigwedge","bigodot","bigotimes","bigoplus","biguplus","lfloor","rfloor","lceil","rceil","opencurlybrace","lbrace","closecurlybrace","rbrace","lbrack","rbrack","integral","vert","perp","perpendicular","nabla","del","hbar","AA","Angstrom","angstrom","ring","circ","circle","bull","bullet","setminus","smallsetminus","neg","dots","ellip","hellip","ellipsis","hellipsis","converges","darr","dnarr","dnarrow","downarrow","dArr","dnArr","dnArrow","Downarrow","diverges","uarr","uparrow","uArr","Uparrow","rarr","rightarrow","implies","rArr","Rightarrow","gets","larr","leftarrow","impliedby","lArr","Leftarrow","harr","lrarr","leftrightarrow","iff","hArr","lrArr","Leftrightarrow","Re","Real","real","Im","imag","image","imagin","imaginary","Imaginary","part","infty","infin","infinity","alef","alefsym","aleph","alephsym","xist","xists","exist","and","land","wedge","lor","vee","O","emptyset","oslash","Oslash","nothing","varnothing","cup","cap","intersect","deg","degree","ang","measuredangle","autoSubscriptNumerals","Variable","isItalic","SupSub","autoCommands","_maxLength","cmds","dict","OperatorName","nonOperatorSymbol","autoCmds","italicize","bool","finalizeTree","autoUnItalicize","autoOps","autoOperatorNames","outer","word","isBuiltIn","BuiltInOpNames","TwoWordOpNames","AutoOpNames","limsup","liminf","projlim","injlim","mostOps","builtInTrigs","autoTrigs","moreNonstandardOps","operatorname","space","prime","backslash","NonSymbolaSymbol","alpha","beta","gamma","zeta","eta","theta","iota","kappa","mu","nu","rho","sigma","tau","chi","psi","omega","phi","phiv","varphi","epsilon","epsiv","varepsilon","piv","varpi","sigmaf","sigmav","varsigma","thetav","vartheta","thetasym","upsilon","upsi","gammad","Gammad","digamma","kappav","varkappa","rhov","varrho","pi","lambda","Upsilon","Upsi","upsih","Upsih","Gamma","Delta","Theta","Lambda","Xi","Pi","Sigma","Phi","Psi","Omega","forall","LatexFragment","frag","PlusMinus","contactWeld","pm","plusmn","plusminus","mp","mnplus","minusplus","sdot","cdot","Inequality","strict","strictness","swap","less","ctrlSeqStrict","htmlStrict","textStrict","greater","lt","gt","le","leq","ge","geq","Equality","divide","divides","sim","transformPropName","div_style","transformPropNames","WebkitTransform","MozTransform","OTransform","msTransform","calculateMarginRight","innerjQ","Style","mathrm","mathit","mathbf","mathsf","mathtt","overline","overrightarrow","overleftarrow","textcolor","cls","supSubsRequireOperand","supsub","src","dest","addBlock","respace","charsThatBreakOutOfSupSub","upInto","upOutOf","downOutOf","downInto","oppositeSupsub","lastChild","subscript","superscript","supscript","SummationNotation","sumStartsWithNEquals","simplify","supOrSub","sum","summation","prod","product","coprod","coproduct","Fraction","frac","dfrac","cfrac","fraction","LiveFraction","over","SquareRoot","sqrt","nthroot","NthRoot","vec","side","sides","oppBrack","expectedSide","restrictMismatchedBrackets","(","[","closeOpposing","brack","eq","deleteSide","outward","sib","farEnd","wasSolid","origEnd","intentionalBlur",")","]","{","}","\\{","\\}","&lang;","&rang;","\\langle ","\\rangle ","|","langle","rangle","Binomial","binom","binomial","choose","MathQuillMathField","registerInnerField","embed","htmlString","componentFactory","layoutTpl","mathField","forOwn","allToolGroups","toolGroup","createToolGroup","tools","eventNs","toolGroupId","$toolGroup","data-identifier","toolId","toolConfig","allTools","createTool","data-latex","data-fn","desc","exp","ln","lte","gte","setLatex","latexString","getLatex","_initMathQuill","MQConfig","edit","$component","$inputField","multiple","component","choiceSelectorTpl","formatOption","createOptionTitle","threshold","fullText","shortText","titleLength","isCardinality","choiceText","$selectBox","dropdownAutoWidth","setSelectedChoices","getSelectedChoices","_selectedChoices","choicesId","_init","listenStateChange","getStates","liveXmlPreview","$destination","rawXml","_printXml","_formatXml","vkbeautify","$code","Prism","highlightElement","types","maths","video","$icon","finalOptions","makeDraggable","makeResizable","makeStackable","makeWindowed","specs","windowPopup","stackingScope","getInteraction","QtiChoice","QtiHotspot","Choice","matchMin","Gap","getMediaType","mimetype","audio","QtiObject","ContainerChoice","QtiContainerChoice","fixed","Hottext","QtiTextVariableChoice","getDefaultMethods","getDefaultProperties","creatorModule","getMarkupTemplate","createResponse","renderMarkup","getNamespace","markupTpl","markupData","getDefaultMarkupTemplateData","getMarkupData","updateMarkup","escapedIdentifier","entry","mapKey","Img","alt","nsUriFragment","defaultNsName","defaultNsUri","setNamespace","NamespacedElement","Include","getFeedbackRules","responseId","responseIdentifier","cardinalities","comparison","_comparedValues","setFeedbackElse","_toString","ResponseDeclaration","SimpleFeedbackRule","templateUri","getTemplate","resetCorrect","setMappingAttribute","removeMappingAttribute","getMappingAttribute","toggleMappingForm","mappingDisabled","toggle","setMapEntry","caseSensitive","mapKeys","mapKeysReverse","removeMapEntry","canBeEmpty","getMapEntries","removeMapEntries","createFeedbackRule","outcomeIdentifier","getFeedbackRule","deleteFeedbackRule","createFeedbackElse","deleteFeedbackElse","outcomeScore","deleteResponse","_type","choiceShuffle","interactionData","renderedChoice","Prompt","Interaction","BlockInteraction","editableInteraction","shuffle","maxAssociations","minAssociations","createChoice","rank","InlineInteraction","maxStringLoop","ContainerInteraction","getNextPlaceholder","allChoices","existingChoicesLabels","placeHolderIndex","placeHolder","createGap","QtiBlockInteraction","QtiObjectInteraction","backgroundImage","GraphicInteraction","AssociableHotspot","getGapImgs","getGapImg","graphicGapInteraction","GapImg","createGapImg","SimpleAssociableChoice","0","1","ObjectInteraction","autostart","minPlays","maxPlays","loop","propNames","propName","getProperties","getMarkupNamespace","markupNs","defaultMarkupNsName","defaultMarkupNsUri","setMarkupNamespace","CustomElement","CustomInteraction","pciReadyCallbacks","triggerPciReady","onPci","offPci","triggerPci","_throwMissingImplementationError","fnName","lowerBound","step","stepLabel","placeholderText","nsName","_stripNamespace","_isEmptyMathML","$math","mathText","hasContent","parseHTML","getAnnotation","removeAnnotation","getMathML","raw","_pciModels","createPciInstance","pciTypeIdentifier","PortableInfoControl","readyStack","onReady","triggerReady","RubricBlock","view","use","Table","blockAdder","interations","section","history","itemSection","activate","back","getMenuLeftArea","ChoiceWidget","listenToInteractionStates","invalidInfoBoxTpl","Sleep","interactionShuffle","initShufflePinToggle","$shuffleToggle","_toggleVisibility","callee","initDelete","QuestionState","contentToolbarTpl","ChoiceStateQuestion","removeToolbar","interactionSerial","Answer","ChoiceStateChoice","_updateChoiceIdentifierInResponse","oldId","newId","escapedOldId","_updateChoiceIdentifier","_get","$choiceContainer","ex","_cache","_setCache","_getCache","updateChoiceIdentifier","updateResponseIdentifier","identifierHelper","GapStateChoice","gapTpl","GapStateQuestion","GapWidget","CreatorGap","SimpleAssociableChoiceStateChoice","GapTextStateChoice","ENTER_BR","GapTextWidget","GapText","CreatorGapText","SimpleChoiceStateChoice","SimpleChoice","HottextStateChoice","HottextStateQuestion","inlineStaticElements","hottextHtmlReplacement","hottextBody","HottextWidget","CreatorHottext","SimpleAssociableChoiceStateQuestion","SimpleAssociableChoiceWidget","SimpleChoiceWidget","CreatorSimpleChoice","CreatorSimpleAssociableChoice","unique","waitForMedia","dummyElement","_qtiClassToDummies","inlineHelper","checkFileExists","fileSrcAttrName","fileExists","togglePlaceholder","positionFloat","itemUtil","imageUtil","ImgStateActive","_extractLabel","$img","responsive","_initAdvanced","_initMediaSizer","_initAlign","_initUpload","longdesc","align","$src","$mediaResizer","$mediaSpan","mediasizer","applyToMedium","sizeAttr","$uploadTrigger","$alt","_openResourceMgr","mime","extension","getSize","maxW","confirmBox","modal","buildInlineContainer","float","contenteditable","textNode","buildBlockContainer","ImgWidget","CreatorImg","IncludeStateActive","$href","disableUpload","IncludeWidget","CreatorXInclude","blockHelperMissing","instructionTpl","_notificationLevels","Instruction","defaultMessage","currentMessage","level","$dom","isValidLevel","checkState","getId","update","timeout","setLevel","getLevel","setMessage","notifTpl","_instructions","validateInstructions","instruction","appendInstruction","validateCallback","removeInstructions","resetInstructions","minMaxChoiceInstructions","onError","choiceCount","minInstructionSet","appendNotification","$notif","_remove","removeNotifications","printBase","withType","_formatters","formatter","printList","printRecord","record","boolean","integer","point","directedPair","duration","intOrIdentifier","pciPrettyPrint","_qtiModelPciResponseCardinalities","single","ordered","unserialize","mappedCardinality","responseValues","serialize","prettyPrint","adaptSize","$elements","pairTpl","instructionMgr","pciResponse","sizeAdapter","interact","interactUtils","setChoice","$choice","usage","_setChoice","responseMappingMode","$resultArea","$pair","thisPairSerial","$otherRepeatedPair","$otherPair","otherPairSerial","border","unsetChoice","$filledChoice","triggerChange","$sibling","swapping","renderEmptyPairs","_iFrameDragFix","draggableSelector","iFrameDragFixOn","$activeDrop","resultSelector","fire","relatedTarget","choiceSelector","isDragAndDropEnabled","dragOptions","dropOptions","$choiceArea","$activeChoice","$bin","binSelector","_getChoice","_resetSelection","_unsetChoice","_isInsertionMode","_isModeEditing","_handleChoiceActivate","_activateChoice","_handleResultActivate","_activateResult","currentTarget","_setInstructions","inertia","autoScroll","restrict","restriction","endOnly","elementRect","onstart","onmove","moveElement","dx","dy","onend","restoreOriginalPosition","iFrameDragFixOff","styleCursor","overlap","ondragenter","ondragleave","dropzone","ondrop","_getRawResponse","tapOn","_setPairs","addedPairs","$emptyPair","$divs","sort","aIndex","bIndex","gripTpl","$itemBody","$grip","switcher","movable","okButtonTpl","_convertToTitle","InteractionWidget","$responseForm","listenToChoiceStates","$interactionContainer","answer","$link","$ok","_containsInModalFeedbackElts","searchSerial","inModalFeedback","Question","addChoiceTpl","InteractionStateQuestion","addNewChoiceButton","$newChoicePlaceholder","qtiChoiceClassName","unless","defineCorrect","program8","program10","templates","editMapping","editFeedbacks","depth1","availableConditions","programWithDepth","hideScore","addElse","_scoreTooltipContent","syncMaxChoices","getMax","$min","_syncMaxChoices","setScore","$scoreInput","tooltipContent","_resetScore","fbRule","$select","onSetScore","$comparedValue","onUnsetCorrect","initCompare","getAvailableConditions","_availableConditions","onSet","onUnset","$choiceSelectorContainer","cSelector","renderTo","selectedChoices","intialValue","$cContainer","selecter","ruleTpl","modalFeedbackConditions","_renderFeedbackRule","feedbackElseSerial","$rule","_initFeedbackEventListener","$feedbacksPanel","$feedbacks","$lastRule","$fbContainer","fbSerial","$deleteButton","newCondition","oldCondition","modalFeedbackWidget","$btn","_getModalFeedbackWidget","_widgets","$feedbacksContainer","initFeedbacksPanel","$feedbackRules","renderFeedbackRule","responseFormTpl","modalFeedbackRule","_saveCallbacks","mappingAttr","getAvailableTemplates","CUSTOM","_getAvailableRpTemplates","filteredTemplates","allTemplates","templateName","answerStateHelper","forward","newDefineCorrectActive","defineCorrectActive","corrects","initResponseForm","_toggleCorrectWidgets","$correctWidgets","rpTemplates","isCorrectDefined","InteractionStateAnswer","Correct","Map","answerState","NoRp","Custom","overlayTpl","promptToolbarTpl","BlockInteractionStateQuestion","buildPromptEditor","destroyPromptEditor","$promptTlb","AssociateInteractionStateQuestion","ResponseWidget","formatResponse","getResponseSummary","sortedIdPair","sortedIdPairKey","formatedRes","pairString","unformatResponse","formatedResponse","responseWidget","choiceIdentifier","responseToolbarTpl","AssociateInteractionStateCorrect","bindResponseChangeListener","_saveCorrect","$miniToolbar","$filled","pairIdentifier","$correct","$score","AssociateInteractionWidget","AssociateInteraction","CreatorAssociateInteraction","listStyle","program11","horizontal","_triggerInput","$choiceBox","$choiceBoxes","isBoolean","_pseudoLabel","inputSelector","$qtiChoice","charCode","eliminator","dataset","eliminable","querySelector","classList","highlightInvalidInput","$li","isEliminable","getCustomData","listStyles","eliminated","choicesCount","interactionFormElement","getListStyle","listStylePrefix","ChoiceInteractionStateQuestion","currListStyle","liststyler","oldStyle","newStyle","$checkboxIcons","scoreTpl","labelTpl","_fixInputs","$checkbox","$radio","createScoreWidgets","createCorrectWidgets","$label","$scores","$corrects","_toggleCorrectInputs","ChoiceInteractionWidget","ChoiceInteraction","CreatorChoiceInteraction","_setVal","InlineInteractionWidget","InteractionStateActive","positionWidget","itemOffset","originalOffset","restrictedIdentifiers","responseSerial","hasRestrictedIdentifier","_prepareRestrictedIdentifier","defaultIdentifier","responseIdentifiers","EndAttemptInteractionStateQuestion","$mainOption","restrictedIdentifier","interactionTpl","EndAttemptInteractionWidget","renderInteraction","previous","previousSibling","EndAttemptInteraction","CreatorEndAttemptInteraction","interactionsConfig","endAttempt","program12","expectedLength","program16","program18","maxWords","program20","program13","program14","program22","program25","program23","program27","regexChar","regexWords","parsePattern","pattern","createMaxWordPattern","createMaxCharPattern","ckEditor","patternMaskHelper","minStrings","placeholderType","_isMultiple","limiter","inputLimiter","ckOptions","extraPlugins","language","defaultLanguage","resize_enabled","secure","forceCustomDomain","_getNumStrings","num","_setPattern","_getFormat","_setUpCKEditor","listenKeyPress","_getCKEditor","setText","numericBase","maxStrings","_getTextareaValue","$textarea","$charsCounter","$wordsCounter","expectedLines","ignoreKeyCodes","triggerKeyCodes","limitHandler","getWordsCount","getCharsCount","updateCounter","_ckEditorData","patt","_destroyCkEditor","instances","_stripTags","tempNode","textContent","setReadOnly","readOnly","clearText","formats","constraints","initState","exitState","ExtendedTextInteractionStateQuestion","$inputs","maxChars","plain","preformatted","none","attrValue","previousFormat","constraint","newValue","_createResponseWidget","_destroyResponseWidget","ExtendedTextInteractionWidget","ExtendedTextInteraction","CreatorExtendedTextInteraction","_choiceUsages","getGap","gapSelector","_handleChoiceSelect","_handleFilledGapSelect","_handleGapSelect","$flowContainer","filledGapSelector","$dragged","searchQtiElement","rootNode","currentNode","containQtiElement","isElement","isQtiElement","ELEMENT_NODE","isRangeValid","isSameNode","allowQtiElements","canWrap","isCollapsed","wrapWith","htmlContentHelper","selectionWrapper","newGapTpl","GapMatchInteractionStateQuestion","syncCardinality","preventSingleChoiceDeletion","$bodyTlb","initGapCreator","interactionWidget","$newGapBtn","$newGap","createChoiceFromSelection","replaceSelectionWithGap","$newChoiceContent","$nestedWidgets","nestedElts","newChoiceElt","newChoiceBody","newChoiceWidget","$addChoiceBtn","qtiEltsRegexp","eltSerial","eltWidget","newGapElt","newGapWidget","_toggleDeleteButtonVisibility","$deleteButtons","PciResponse","invoke","leftTitle","pairLeft","rightTitle","pairRight","defaultScore","formElementHelper","tooltipster","createPopup","separator","adder","$left","$right","$options","currentLeft","currentRight","leftId","rightId","lval","rval","isDirectedPairFlipped","pairScoringForm","addPair","deleter","removePair","preparePairs","entries","formatPair","formatLeft","formatRight","updateFormBindings","without","scoreMin","scoreMax","scoringFormFactory","initMapState","displayGaps","updateForm","exitMapState","formatedChoices","GapMatchInteractionWidget","GapMatchInteraction","CreatorGapMatchInteraction","basic","stroke","stroke-width","stroke-dasharray","stroke-linejoin","fill","fill-opacity","hover","selectable","layer","imageset-rect-stroke","imageset-rect-no-stroke","imageset-img","order-text","font-family","font-weight","font-size","score-text-default","score-text","small-text","layer-pos-text","target-hover","target-success","assoc","stroke-linecap","assoc-layer","stroke-opacity","assoc-bullet","close-bg","touch-circle","raphael","scaleRaphael","gstyle","shapeMap","default","poly","coordsValidator","ellipse","qti2raphCoordsMapper","coords","paper","raph2qtiCoordsMapper","cx","cy","rx","ry","setStyle","responsivePaper","resizePaper","givenWidth","diff","maxWidth","containerWidth","factor","$editor","imgWidth","imgHeight","changeSize","resizer","imgId","setViewBox","shaper","shapeCoords","qtiCoords","raphaelCoords","toFront","flashing","updateElementState","touchEffect","touchstart","createTouchCircle","getBBox","createTarget","baseSize","half","tBBox","targetSize","coord","mapper","bbox","tCircle","createText","fontSize","scaledFontSize","updateTitle","createShapeText","shape","shapeClick","createBorderedImage","padding","halfPad","rw","rh","ix","iy","iw","ih","shadow","glow","offsetx","offsety","animation","animateWith","removeChild","highlightError","restoredState","getPoint","clickPoint","pw","cw","ph","graphic","background","_vsets","_renderChoice","_paperUnSelect","assocs","_shapesUnSelectable","_getActiveElement","_createPath","_isMatchable","_shapesSelectable","getById","destElement","onRemove","showCloser","closerBg","removeSet","hideCloser","toBack","unclick","vset","sx","sy","srcBullet","destBullet","midPath","getPointAtLength","getTotalLength","matching","matchable","responseValue","el1","el2","toRemove","createPaper","_createPlaceholder","$imageBox","$upload","createChoices","_currentChoices","initSleepState","exitSleepState","showTarget","sidebarTmpl","$imageEditor","$sideBar","$forms","deactivate","Raphael","halfWidth","halfHeight","midTop","midRight","midBot","midLeft","parsePathString","segment","topLeft","topRight","botRight","botLeft","handlerCoords","hshape","commonGraphicHelper","shapeResizer","startPoint","resized","boxDest","pointIndex","mover","shapeMover","graphicHelper","_path","closed","points","getPath","pointSize","closeCb","onClose","shapeHandlers","pathBuilder","isResponsive","drawing","startDrawingPath","startPositionTarget","startWithMouse","created","builder","unmousedown","unmousemove","unmouseup","smoothResize","handling","resizing","moving","quitHandling","enterHandling","startResize","handler","layerTxt","stopPoint","pick","keyResize","startMove","mousePoint","moved","keyResizer","undrag","removeShape","GraphicHelper","shapeSideBar","shapeFactory","shapeEditor","editors","editShape","shapeOptions","shapeChanging","shapeChange","shapeRemoved","currents","createShape","factories","editCreatedShape","shapeCreated","unmouseover","unmouseout","resourceManager","$width","$height","$type","setupImage","$bgImage","setupMediaSizer","$mediaSizer","showResponsiveToggle","showSync","widgetReady","imageSelector","choiceFormTpl","bgImage","initQuestionState","enterChoiceForm","$choiceForm","$top","leaveChoiceForm","choiceForm","_editor","newChoice","exitQuestionState","GraphicAssociateInteractionStateQuestion","initCorrectState","exitCorrectState","showChoicesId","removePaths","getPairValues","GraphicWidget","GraphicAssociateInteraction","GraphicAssociateInteractionWidget","CreatorGraphicAssociateInteraction","triggerMouseEvent","activeDrop","flipDirectedPair","gapFillers","gapFiller","$gapImages","usages","_selectShape","trackResponse","$clone","shapeOffset","activeOffset","currentCount","$gapList","$active","boxOffset","z-index","gapFillerImage","rElement","raphaelid","handleShapeSelect","_renderGapList","toggleActiveGapState","_setInactiveGapState","_setActiveGapState","gapFillersSelector","newSize","responseChoice","responseGap","gapImgFormTpl","mediaTlbTpl","applyMediasizerValues","setUpGapImg","gapImgObj","$addOption","$gapImgBox","$deleteBtn","enterGapImgForm","initMediasizer","$gapImgElem","complete","gapImgSelectorOptions","GraphicGapMatchInteractionStateQuestion","createGapImgs","scaleGapList","removeGapFillers","gapSrcs","formated","objetLabel","objectLabel","gapImgTpl","GraphicGapMatchInteraction","GraphicGapMatchInteractionWidget","CreatorGraphicGapMatchInteraction","$orderList","_renderOrderList","_unselectShape","$orderers","$orderer","_createTexts","_showText","number","_hideText","texts","transf","renderOrderList","GraphicOrderInteractionStateQuestion","scaleOrderList","GraphicOrderInteraction","GraphicOrderInteractionWidget","CreatorGraphicOrderInteraction","HotspotInteractionStateQuestion","wfactor","$shape","noCorrect","grahicScorePopup","mappingFormTpl","initResponseMapping","scoreTexts","correctDefined","scoreText","HotspotInteraction","HotspotInteractionWidget","CreatorHotspotInteraction","pseudoLabel","$inupt","newHottextBtnTpl","HottextInteractionStateQuestion","initHottextCreator","$newHottextBtn","$newHottext","createNewHottext","$hottextContent","$inlineStaticWidgets","newHottextElt","newHottextBody","allowedInlineStaticElts","newHottextWidget","createScoreForm","meta","toggleCorrectState","$hottext","HottextInteractionWidget","HottextInteraction","CreatorHottextInteraction","dropdownCssClass","InlineChoiceStateChoice","InlineChoiceWidget","InlineChoiceInteractionStateQuestion","$addChoice","renderChoice","buildChoice","CommonRenderer","$responseWidget","selectedChoice","inlineChoiceInteractionTpl","inlineChoiceTpl","InlineChoiceInteractionWidget","$choiceOptionForm","shuffleChoice","InlineChoiceInteraction","CreatorInlineChoiceInteraction","inWarning","_onCheckboxSelected","_filterResponse","_inferValue","currentResponse","_countChoices","_maxMatchReached","association","overflow","_getChoiceDefinitionByIdentifier","_countAssociations","rawResponse","_getRawChoices","rawChoices","matchset","onMaxChoicesReached","report","onMatchMaxReached","originalBackgroundColor","originalColor","responseCount","inferValue","otherMatchSetCount","AssociateInteractionQuestionState","rowTpl","cellTpl","MatchInteractionStateQuestion","$matchArea","_postRender","pairId","MatchInteractionWidget","MatchInteraction","CreatorMatchInteraction","mediaplayer","canBePlayed","current","mediaElement","initMediaPlayer","canPause","canSeek","volume","autoStart","pause","destroyInteraction","MediaInteractionStateQuestion","$heightContainer","isAudio","reRender","switchToAudio","switchToVideo","boundInteraction","attrName","openResourceMgr","features","controlPlaying","MediaInteraction","MediaInteractionWidget","program15","program17","program19","program21","_isDropzoneVisible","$dropzoneElement","_insertDropzone","insertPosition","draggedMiddle","_getMiddleOf","previousMiddle","currentMiddle","_adjustDropzonePosition","draggedBox","$prevResult","$nextResult","prevMiddle","nextMiddle","elementBox","$iconAdd","$iconRemove","$iconBefore","$iconAfter","$dragContainer","_activeControls","_resetControls","_setSelection","_addChoiceToSelection","$results","_toggleResultSelection","_removeChoice","_moveResultBefore","_moveResultAfter","hasBeenDroppedInResultArea","dropzoneIndex","_freezeSize","$orderArea","instructionMax","initialOrder","$choices","ChoiceInteractionQuestionState","OrderInteractionStateQuestion","_formatResponse","_unformatResponse","OrderInteractionWidget","OrderInteraction","CreatorOrderInteraction","fixMarkupMediaSources","imgSrcPattern","_pciHooks","pciHook","notifyReady","pciInstance","notifyDone","onready","ondone","instance","PortableElement","qtiCustomInteractionContext","pciReadyCallback","info","pciDoneCallback","_getPci","_taoCustomInteraction","_isPciModel","requireEntries","lib","pciAssetManager","templateVariables","boundTo","getInstance","initialize","serializedState","setSerializedState","getSerializedState","CreatorCustomInteraction","pciCreator","getWidget","getRawResponse","addPoint","pointChange","isTouch","enableSelection","untouchstart","SelectPointInteractionStateQuestion","_targets","setCurrentResponses","createEditor","listenResponseAttrChange","areaId","area","getAreaIndex","createResponseArea","setUpScoringArea","qtiPoint","scoreElt","setElt","$separator","targetId","shapeType","SelectPointInteraction","SelectPointInteractionWidget","CreatorSelectPointInteraction","_slideTo","sliderCurrentValue","sliderValue","$sliderLabels","$sliderCurrentValue","$sliderValue","steps","sliderSize","middleStep","leftOffset","middleValue","startValue","SliderInteractionStateQuestion","sliderLength","$sliderElt","currentStep","SliderInteractionWidget","SliderInteraction","CreatorSliderInteraction","locale","createTooltip","forceCreation","hidden","updateConstraintTooltip","TextEntryInteractionStateQuestion","optionTpl","_getRelatedTextKey","TextEntryInteractionStateMap","initMapEntries","initFormCallbacks","hideCorrectInput","$text","oldText","$tr","correctValue","appendOption","$newOption","preventNullMapEntries","$del","TextEntryInteractionWidget","TextEntryInteraction","CreatorTextEntryInteraction","accept","uploadMime","getMimeTypes","equivalent","setExpectedTypes","selectedType","getExpectedTypes","includeEquivalents","mimes","equivalents","mimeData","uploadHelper","_initialInstructions","_readyInstructions","validateFileType","expectedTypes","filetype","getMimeType","getMessageWrongType","userSelectedType","messageWrongType","expectedTypeLabels","_handleSelectedFiles","reader","filename","FileReader","onload","base64Data","commaPosition","base64Raw","$previewArea","progressbar","previewer","imgNaturalWidth","isOversized","modalWidth","$originalImg","$largeDisplay","itemWidth","winWidth","fullHeight","naturalWidth","$modalBody","modalOverlayClass","onloadstart","onprogress","percentProgress","ceil","total","readAsDataURL","_resetGui","changeListener","resetGui","UploadInteractionStateQuestion","preselected","formatNoMatches","UploadInteractionWidget","isPreviewable","UploadInteraction","informLoaded","leading","$head","itemStylesheetHandler","ItemStateActive","devTools","hasUnsupportedInteraction","ItemWidget","saveItemUrl","initTextWidgets","initGridEditor","rejectError","contentType","initUiComponents","$saveBtn","initTextWidget","$originalContainer","subContainers","isTextBlock","$subElement","$subWidget","$clonedContainer","$originalTextBlock","textBlockId","$subContainer","subContainerElements","subContainerBody","serializedItemBody","containerData","containerElements","_detachElements","elementSerial","$pre","CreatorItem","_normalizeItemBody","$child","processSectionDelay","Queue","mathml","mathjax","popupMode","windowPopupFactory","mathInputFactory","popupFormTpl","dynamicComponent","_attachMathmlWarning","$mathField","$tooltipContent","MathActive","popups","fields","$mathml","$popupsContainer","editMode","$latex","_toggleMode","latexWysiwyg","createLatexWysiwygPopup","createLargeEditorPopup","center","initFormChangeListener","targetPopup","windowTitle","minWidth","minHeight","$popupContent","mathInput","currentLatex","_disableForm","_enableForm","popupOptions","smallField","$popupField","mode","panels","MathWidget","isEditable","CreatorMath","feedbackStyle","_checkContainerType","_getBodyDom","_setBodyDomClass","newClass","oldClass","_setDomClass","$bodyDom","setEncodedDataToDom","dataName","oldValue","_getEncodedDataString","_prefix","setEncodedData","getEncodedData","removeEncodedData","hasEncodedData","coreContainerHelper","modalFeedbackRenderer","$modal","requiredHeight","startClosed","feedbackStyles","_prepareFeedbackStyles","styles","indices","selectors","sidebar","cke","ckeBase","ckeNose","ckeToolbar","raise","baseIndex","$elem","_ckeIsReady","poll","ModalFeedbackStateActive","ModalFeedbackWidget","modalTpl","previewOptions","_config","renderingThrottle","fileFilters","ObjectStateActive","refreshRendering","qtiObject","ObjectWidget","CreatorObject","_picHooks","picHook","picInstance","qtiInfoControlContext","_getPic","_taoInfoControl","picAssetManager","CreatorPortableInfoControl","picCreator","rubric","RubricBlockStateActive","RubricBlockWidget","CreatorRubricBlock","summary","deleteTitle","makePlaceable","triggerEvent","delete","insertRow","insertCol","tableActionsApi","hideDelete","showDelete","tableActionsComponent","$delete","$insertRow","$insertCol","tableModelFactory","tableActionsFactory","addClassOnCurrentRow","$currentCol","currentCellPos","getCurrentCellPos","tableModel","getRowCells","addClassOnCurrentCol","getColCells","clearCellClasses","updateTable","getRowCount","rowActions","getColCount","colActions","hideTableActions","displayTableActions","$tableContainer","$currentCell","selectedCells","hAlignWith","vAlignWith","currentCell","cellIndex","rowIndex","tabletools","CKEDITOR","getSelectedCells","deleteColRow","insertRowAfter","insertColAfter","TableStateActive","$itemPanel","$tablePropTrigger","execCommand","TableWidget","CreatorTable","replayTimeout","mediaProps","defaultAudioHeight","defaultVideoHeight","switchMode","setUpUploader","configChangeCallback","mediaPropsDefaults","getForm","getChangeCallbacks","CustomInteractionStateQuestion","initColorPickers","$colorTriggers","$itemEditorWidgetBar","destroyColorPickers","CustomInteractionWidget","initAnswerState","exitAnswerState","InfoControlWidget","renderedObject","xhtmlEntities","xhtmlEncode","encodeOutcomeInfo","relatedResponse","portableElementProperties","depth2","propertiesTpl","renderPortableElementProperties","registerHelper","isAreaMapping","isRecord","fieldIdentifier","hasMapEntries","responseRules","custom","templateDriven","correctTpl","mapTpl","mapPointTpl","_renderRpTpl","rpTpl","_renderInteractionRp","_renderFeedbackRules","responseRule","mapResponsePoint","noData","tplCondition","tplCorrect","tplIncorrect","tplChoices","_values","ruleXml","else","newData","d"],"mappings":"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","file":"routes.js","sourcesContent":["/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n *\r\n */\r\n\r\n//@see http://forge.taotesting.com/projects/tao/wiki/Front_js\r\ndefine('taoQtiItem/controller/routes',[],function(){\r\n    'use strict';\r\n\r\n    return {\r\n        'QtiPreview' : {\r\n            'actions' : {\r\n                'index' : 'taoItems/controller/preview/itemRunner'\r\n            }\r\n        },\r\n        'QtiCreator' : {\r\n            'actions' : {\r\n                'index' : 'controller/creator/index'\r\n            }\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/portableElementRegistry/factory/factory',['lodash', 'core/promise', 'core/eventifier'], function (_, Promise, eventifier){\r\n    'use strict';\r\n\r\n    var _requirejs = window.require;\r\n    var _defaultLoadingOptions = {\r\n        reload: false,\r\n        enabledOnly : false,\r\n        runtimeOnly : []\r\n    };\r\n\r\n    var loadModuleConfig = function loadModuleConfig(manifest){\r\n        return new Promise(function(resolve, reject){\r\n            var requireConfigAliases = {};\r\n            var baseUrl;\r\n            var reqConfigs = [];\r\n            var modules = {};\r\n\r\n            if(!manifest || !manifest.runtime){\r\n                return reject('invalid manifest');\r\n            }\r\n\r\n            baseUrl = manifest.baseUrl;\r\n\r\n            if(_.isArray(manifest.runtime.config) && manifest.runtime.config.length){\r\n                _.forEach(manifest.runtime.config, function(pciConfig){\r\n                    if(pciConfig.data){\r\n                        modules = _.defaults(modules, pciConfig.data.paths || {});\r\n                    }else if(pciConfig.file){\r\n                        reqConfigs.push('json!' + baseUrl + '/' + pciConfig.file);\r\n                    }\r\n                });\r\n            }\r\n\r\n            require(reqConfigs, function(){\r\n\r\n                var runtimeModules = {};\r\n\r\n                if(manifest.model === 'IMSPCI'){\r\n\r\n                    modules = _.reduce(arguments, function(acc, conf){\r\n                        return _.defaults(acc, conf.paths || {});\r\n                    }, modules);\r\n\r\n                    _.forEach(manifest.runtime.modules || {}, function(paths, id){\r\n                        if(paths && (_.isString(paths) || (_.isArray(paths) && paths.length))){\r\n                            runtimeModules[id] = paths;\r\n                        }\r\n                    });\r\n\r\n                    modules = _.merge(modules, runtimeModules);\r\n\r\n                    _.forEach(modules, function(paths, id){\r\n                        paths = _.isArray(paths) ? paths : [paths];\r\n                        requireConfigAliases[id] = _.map(paths, function(path){\r\n                            return baseUrl+'/'+path.replace(/\\.js$/, '');\r\n                        });\r\n                    });\r\n                }else{\r\n                    requireConfigAliases[manifest.typeIdentifier] = baseUrl;\r\n                }\r\n\r\n                resolve(requireConfigAliases);\r\n\r\n            }, reject);\r\n\r\n\r\n        });\r\n    };\r\n\r\n    return function portableElementRegistry(methods){\r\n\r\n        var _loaded = false;\r\n        var __providers = {};\r\n\r\n        return eventifier(_.defaults(methods || {}, {\r\n            _registry : {},\r\n            get : function get(typeIdentifier, version){\r\n\r\n                if(this._registry[typeIdentifier]){\r\n                    //check version\r\n                    if(version){\r\n                        return _.find(this._registry[typeIdentifier], version);\r\n                    }else{\r\n                        //latest\r\n                        return _.last(this._registry[typeIdentifier]);\r\n                    }\r\n                }\r\n            },\r\n            registerProvider : function registerProvider(moduleName){\r\n                __providers[moduleName] = null;\r\n                return this;\r\n            },\r\n            resetProviders : function resetProviders(){\r\n                __providers = {};\r\n                return this;\r\n            },\r\n            loadProviders : function loadProviders(){\r\n                var self = this;\r\n                return new Promise(function(resolve, reject) {\r\n                    var providerLoadingStack = [];\r\n                    _.forIn(__providers, function(provider, id){\r\n                        if(provider === null){\r\n                            providerLoadingStack.push(id);\r\n                        }\r\n                    });\r\n                    _requirejs(providerLoadingStack, function(){\r\n                        _.each([].slice.call(arguments), function(provider){\r\n                            if(provider && _.isFunction(provider.load)){\r\n                                __providers[providerLoadingStack.shift()] = provider;\r\n                            }\r\n                        });\r\n                        resolve();\r\n                        self.trigger('providersloaded');\r\n                    }, reject);\r\n                });\r\n            },\r\n            getAllVersions : function getAllVersions(){\r\n                var all = {};\r\n                _.forIn(this._registry, function (versions, id){\r\n                    all[id] = _.map(versions, 'version');\r\n                });\r\n                return all;\r\n            },\r\n            getRuntime : function getRuntime(typeIdentifier, version){\r\n                var pci = this.get(typeIdentifier, version);\r\n                if(pci){\r\n                    return _.assign(pci.runtime, {\r\n                        id : pci.typeIdentifier,\r\n                        label : pci.label,\r\n                        baseUrl : pci.baseUrl,\r\n                        model : pci.model\r\n                    });\r\n                }else{\r\n                    this.trigger('error', {\r\n                        message : 'no portable element runtime found',\r\n                        typeIdentifier : typeIdentifier,\r\n                        version : version\r\n                    });\r\n                }\r\n            },\r\n            getCreator : function getCreator(typeIdentifier, version){\r\n                var pci = this.get(typeIdentifier, version);\r\n                if(pci && pci.creator){\r\n                    return _.assign(pci.creator, {\r\n                        id : pci.typeIdentifier,\r\n                        label : pci.label,\r\n                        baseUrl : pci.baseUrl,\r\n                        response : pci.response\r\n                    });\r\n                }else{\r\n                    this.trigger('error', {\r\n                        message : 'no portable element runtime found',\r\n                        typeIdentifier : typeIdentifier,\r\n                        version : version\r\n                    });\r\n                }\r\n            },\r\n            getBaseUrl : function getBaseUrl(typeIdentifier, version){\r\n                var runtime = this.get(typeIdentifier, version);\r\n                if(runtime){\r\n                    return runtime.baseUrl;\r\n                }\r\n                return '';\r\n            },\r\n            loadRuntimes : function loadRuntimes(options){\r\n                var self = this;\r\n                var loadPromise;\r\n\r\n                options = _.defaults(options||{}, _defaultLoadingOptions);\r\n\r\n                if(_loaded && !options.reload){\r\n                    loadPromise = Promise.resolve();\r\n                } else {\r\n                    loadPromise = self.loadProviders().then(function(){\r\n\r\n                        var loadStack = [];\r\n\r\n                        _.forEach(__providers, function (provider){\r\n                            if(provider){//check that the provider is loaded\r\n                                loadStack.push(provider.load());\r\n                            }\r\n                        });\r\n\r\n                        //performs the loadings in parallel\r\n                        return new Promise(function(resolve, reject){\r\n                            Promise.all(loadStack).then(function (results){\r\n\r\n                                var configLoadingStack = [];\r\n\r\n                                //update registry\r\n                                self._registry = _.reduce(results, function (acc, _pcis){\r\n                                    return _.merge(acc, _pcis);\r\n                                }, {});\r\n\r\n                                //pre-configuring the baseUrl of the portable element's source\r\n                                _.forIn(self._registry, function (versions, typeIdentifier){\r\n                                    //currently use latest runtime only\r\n                                    configLoadingStack.push(loadModuleConfig(self.get(typeIdentifier)));\r\n                                });\r\n\r\n                                return Promise.all(configLoadingStack).then(function(moduleConfigs){\r\n                                    var requireConfigAliases = _.reduce(moduleConfigs, function(acc, paths){\r\n                                        return _.merge(acc, paths);\r\n                                    }, {});\r\n\r\n                                    //save the required libs name => path to global require alias\r\n                                    //TODO in future planned user story : change this to a local require context to solve conflicts in third party module naming\r\n                                    _requirejs.config({paths : requireConfigAliases});\r\n\r\n                                    _loaded = true;\r\n\r\n                                    resolve();\r\n                                }).catch(function(err){\r\n                                    reject('error loading module config ' + err);\r\n                                });\r\n                            });\r\n                        });\r\n\r\n                    });\r\n                }\r\n\r\n                loadPromise\r\n                    .then(function() {\r\n                        self.trigger('runtimesloaded');\r\n                    })\r\n                    .catch(function(err) {\r\n                        self.trigger('error', err);\r\n                    });\r\n\r\n                return loadPromise;\r\n            },\r\n            loadCreators : function loadCreators(options){\r\n                var loadPromise;\r\n                var self = this;\r\n\r\n                options = _.defaults(options||{}, _defaultLoadingOptions);\r\n\r\n                loadPromise = self.loadRuntimes(options).then(function(){\r\n                    var requiredCreatorHooks = [];\r\n                    var requiredCreators = _.isArray(options.runtimeOnly) ? options.runtimeOnly : [];\r\n\r\n                    _.forIn(self._registry, function (versions, typeIdentifier){\r\n                        var pciModel = self.get(typeIdentifier);//currently use the latest version only\r\n                        if(pciModel.creator && pciModel.creator.hook && (pciModel.enabled || requiredCreators.indexOf(typeIdentifier) !== -1)){\r\n                            requiredCreatorHooks.push(pciModel.creator.hook.replace(/\\.js$/, ''));\r\n                        }\r\n                    });\r\n\r\n                    if(requiredCreatorHooks.length){\r\n                        return new Promise(function(resolve, reject){\r\n                            //@todo support caching?\r\n                            _requirejs(requiredCreatorHooks, function (){\r\n                                var creators = {};\r\n                                _.each(arguments, function (creatorHook){\r\n                                    var id = creatorHook.getTypeIdentifier();\r\n                                    var pciModel = self.get(id);\r\n                                    var i = _.findIndex(self._registry[id], {version : pciModel.version});\r\n                                    if(i < 0){\r\n                                        self.trigger('error', 'no creator found for id/version ' + id + '/' + pciModel.version);\r\n                                    }else{\r\n                                        self._registry[id][i].creator.module = creatorHook;\r\n                                        creators[id] = creatorHook;\r\n                                    }\r\n                                });\r\n                                resolve(creators);\r\n                            }, reject);\r\n                        });\r\n                    }else{\r\n                        return Promise.resolve({});\r\n                    }\r\n\r\n                });\r\n\r\n                loadPromise\r\n                    .then(function(creators) {\r\n                        self.trigger('creatorsloaded', creators);\r\n                        return creators;\r\n                    })\r\n                    .catch(function(err) {\r\n                        self.trigger('error', err);\r\n                    });\r\n\r\n                return loadPromise;\r\n            },\r\n            enable: function enable(typeIdentifier, version){\r\n                var pci = this.get(typeIdentifier, version);\r\n                if(pci){\r\n                    pci.enabled = true;\r\n                }\r\n            },\r\n            disable: function disable(typeIdentifier, version){\r\n                var pci = this.get(typeIdentifier, version);\r\n                if(pci){\r\n                    pci.enabled = false;\r\n                }\r\n            },\r\n            isEnabled: function isEnabled(typeIdentifier, version){\r\n                var pci = this.get(typeIdentifier, version);\r\n                return (pci && pci.enabled === true);\r\n            }\r\n        }));\r\n    };\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n/**\r\n * @author Sam <sams@taotesting.com>\r\n * @requires jquery\r\n * @requires lodash\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/qtiElements',['jquery', 'lodash', 'i18n'], function($, _, __){\r\n    \"use strict\";\r\n\r\n    var QtiElements = {};\r\n\r\n    QtiElements.classes = {\r\n        //abstract classes:\r\n        'itemBody' : {'parents' : ['bodyElement'], 'contains' : ['block'], 'abstract' : true},\r\n        'atomicBlock' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['inline'], 'abstract' : true},\r\n        'atomicInline' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic'], 'contains' : ['inline'], 'abstract' : true},\r\n        'simpleBlock' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['block'], 'abstract' : true},\r\n        'simpleInline' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic'], 'contains' : ['inline'], 'abstract' : true},\r\n        'flowStatic' : {'parents' : ['flow'], 'abstract' : true},\r\n        'blockStatic' : {'parents' : ['block'], 'abstract' : true},\r\n        'inlineStatic' : {'parents' : ['inline'], 'abstract' : true},\r\n        'flow' : {'parents' : ['objectFlow'], 'abstract' : true},\r\n        'tableCell' : {'parents' : ['bodyElement'], 'contains' : ['flow'], 'abstract' : true},\r\n        //html-derived qti elements:\r\n        'caption' : {'parents' : ['bodyElement'], 'contains' : ['inline'], 'xhtml' : true},\r\n        'col' : {'parents' : ['bodyElement'], 'xhtml' : true},\r\n        'colgroup' : {'parents' : ['bodyElement'], 'contains' : ['col'], 'xhtml' : true},\r\n        'div' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['flow'], 'xhtml' : true},\r\n        'dl' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['dlElement'], 'xhtml' : true},\r\n        'dt' : {'parents' : ['dlElement'], 'contains' : ['inline'], 'xhtml' : true},\r\n        'dd' : {'parents' : ['dlElement'], 'contains' : ['flow'], 'xhtml' : true},\r\n        'hr' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'xhtml' : true},\r\n        'math' : {'parents' : ['blockStatic', 'flowStatic', 'inlineStatic'], 'xhtml' : true},\r\n        'li' : {'parents' : ['bodyElement'], 'contains' : ['flow'], 'xhtml' : true},\r\n        'ol' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['li'], 'xhtml' : true},\r\n        'ul' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['li'], 'xhtml' : true},\r\n        'object' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic'], 'contains' : ['objectFlow'], 'xhtml' : true},\r\n        'param' : {'parents' : ['objectFlow'], 'xhtml' : true},\r\n        'table' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'contains' : ['caption', 'col', 'colgroup', 'thead', 'tfoot', 'tbody'], 'xhtml' : true},\r\n        'tbody' : {'parents' : ['bodyElement'], 'contains' : ['tr'], 'xhtml' : true},\r\n        'tfoot' : {'parents' : ['bodyElement'], 'contains' : ['tr'], 'xhtml' : true},\r\n        'thead' : {'parents' : ['bodyElement'], 'contains' : ['tr'], 'xhtml' : true},\r\n        'td' : {'parents' : ['tableCell'], 'xhtml' : true},\r\n        'th' : {'parents' : ['tableCell'], 'xhtml' : true},\r\n        'tr' : {'parents' : ['bodyElement'], 'contains' : ['tableCell'], 'xhtml' : true},\r\n        'a' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'abbr' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'acronym' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'b' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'big' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'cite' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'code' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'dfn' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'em' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'i' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'kbd' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'q' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'samp' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'small' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'span' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'strong' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'sub' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'sup' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'tt' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'var' : {'parents' : ['simpleInline'], 'xhtml' : true},\r\n        'blockquote' : {'parents' : ['simpleBlock'], 'xhtml' : true},\r\n        'address' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'h1' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'h2' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'h3' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'h4' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'h5' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'h6' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'p' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'pre' : {'parents' : ['atomicBlock'], 'xhtml' : true},\r\n        'img' : {'parents' : ['atomicInline'], 'xhtml' : true, attributes : ['src', 'alt', 'longdesc', 'height', 'width']},\r\n        'br' : {'parents' : ['atomicInline'], 'xhtml' : true},\r\n        //qti elements:\r\n        'infoControl' : {'parents' : ['blockStatic', 'bodyElement', 'flowStatic'], 'qti' : true},\r\n        'textRun' : {'parents' : ['inlineStatic', 'flowstatic'], 'qti' : true},\r\n        'feedbackInline' : {'parents' : ['simpleInline', 'feedbackElement'], 'qti' : true},\r\n        'feedbackBlock' : {'parents' : ['simpleBlock'], 'qti' : true},\r\n        'rubricBlock' : {'parents' : ['simpleBlock'], 'qti' : true}, //strange qti 2.1 exception, marked as simpleBlock instead of\r\n        'blockInteraction' : {'parents' : ['block', 'flow', 'interaction'], 'qti' : true},\r\n        'inlineInteraction' : {'parents' : ['inline', 'flow', 'interaction'], 'qti' : true},\r\n        'gap' : {'parents' : ['inlineStatic'], 'qti' : true},\r\n        'hottext' : {'parents' : ['flowstatic', 'inlineStatic'], 'contains' : ['inlineStatic'], 'qti' : true},\r\n        'printedVariable' : {'parents' : ['bodyElement', 'flowStatic', 'inlineStatic', 'textOrVariable'], 'qti' : true},\r\n        'prompt' : {'parents' : ['bodyElement'], 'contains' : ['inlineStatic'], 'qti' : true},\r\n        'templateElement' : {'parents' : ['bodyElement'], 'qti' : true},\r\n        'templateBlock' : {'parents' : ['blockStatic', 'flowStatic', 'templateElement'], 'contains' : ['blockStatic'], 'qti' : true},\r\n        'templateInline' : {'parents' : ['inlineStatic', 'flowStatic', 'templateElement'], 'contains' : ['inlineStatic'], 'qti' : true},\r\n        'choiceInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'associateInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'orderInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'matchInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'hottextInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'gapMatchInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'mediaInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'sliderInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'uploadInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'drawingInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'graphicInteraction' : {'parents' : ['blockInteraction'], 'qti' : true},\r\n        'hotspotInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\r\n        'graphicAssociateInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\r\n        'graphicOrderInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\r\n        'graphicGapMatchInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\r\n        'selectPointInteraction' : {'parents' : ['graphicInteraction'], 'qti' : true},\r\n        'textEntryInteraction' : {'parents' : ['stringInteraction', 'inlineInteraction'], 'qti' : true},\r\n        'extendedTextInteraction' : {'parents' : ['stringInteraction', 'blockInteraction'], 'qti' : true},\r\n        'inlineChoiceInteraction' : {'parents' : ['inlineInteraction'], 'qti' : true},\r\n        'endAttemptInteraction' : {'parents' : ['inlineInteraction'], 'qti' : true},\r\n        'customInteraction' : {'parents' : ['block', 'flow', 'interaction'], 'qti' : true},\r\n        '_container' : {'parents' : ['block'], 'qti' : true}//a pseudo class introduced in TAO\r\n    };\r\n\r\n    QtiElements.cache = {containable : {}, children : {}, parents : {}};\r\n\r\n    QtiElements.getAllowedContainersElements = function(qtiClass, $container){\r\n        var classes = QtiElements.getAllowedContainers(qtiClass);\r\n        var jqSelector = '';\r\n        for(var i in classes){\r\n            if(!classes[i].qti){\r\n                //html element:\r\n                jqSelector += classes[i] + ', ';\r\n            }\r\n        }\r\n\r\n        if(jqSelector){\r\n            jqSelector = jqSelector.substring(0, jqSelector.length - 2);\r\n        }\r\n\r\n        return $(jqSelector, $container ? $container : $(document)).filter(':not([data-qti-type])');\r\n    };\r\n\r\n    QtiElements.getAllowedContainers = function(qtiClass){\r\n        var ret;\r\n        if(QtiElements.cache.containable[qtiClass]){\r\n            ret = QtiElements.cache.containable[qtiClass];\r\n        }else{\r\n            ret = [];\r\n            var parents = QtiElements.getParentClasses(qtiClass, true);\r\n            for(var aClass in QtiElements.classes){\r\n                var model = QtiElements.classes[aClass];\r\n                if(model.contains){\r\n                    var intersect = _.intersection(model.contains, parents);\r\n                    if(intersect.length){\r\n                        if(!model.abstract){\r\n                            ret.push(aClass);\r\n                        }\r\n                        ret = _.union(ret, QtiElements.getChildClasses(aClass, true));\r\n                    }\r\n                }\r\n            }\r\n            QtiElements.cache.containable[qtiClass] = ret;\r\n        }\r\n\r\n        return ret;\r\n    };\r\n\r\n    QtiElements.getAllowedContents = function(qtiClass, recursive, checked){\r\n\r\n        var ret = [];\r\n        checked = checked || {};\r\n\r\n        var model = QtiElements.classes[qtiClass];\r\n        if(model && model.contains){\r\n            for(var i in model.contains){\r\n                var contain = model.contains[i];\r\n                if(!checked[contain]){\r\n                    checked[contain] = true;\r\n\r\n                    //qtiClass can contain everything defined as its contents\r\n                    ret.push(contain);\r\n\r\n                    //qtiClass can also contain subclass of its contents\r\n                    var children = QtiElements.getChildClasses(contain, true);\r\n                    for(var i in children){\r\n                        var child = children[i];\r\n                        if(!checked[child]){\r\n                            checked[child] = true;\r\n\r\n                            ret.push(child);\r\n\r\n                            //adding children allowed contents depends on the option \"recursive\"\r\n                            if(recursive){\r\n                                ret = _.union(ret, QtiElements.getAllowedContents(child, true, checked));\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    //adding allowed contents of qtiClass' allowed contents depends on the option \"recursive\"\r\n                    if(recursive){\r\n                        ret = _.union(ret, QtiElements.getAllowedContents(contain, true, checked));\r\n                    }\r\n\r\n                }\r\n            }\r\n        }\r\n\r\n        //qtiClass can contain all allowed contents of its parents:\r\n        var parents = QtiElements.getParentClasses(qtiClass, true);\r\n        for(var i in parents){\r\n            ret = _.union(ret, QtiElements.getAllowedContents(parents[i], recursive, checked));\r\n        }\r\n\r\n        return _.uniq(ret, false);\r\n    };\r\n\r\n    QtiElements.isAllowedClass = function(qtiContainerClass, qtiContentClass){\r\n        var allowedClasses = QtiElements.getAllowedContents(qtiContainerClass);\r\n        return (_.indexOf(allowedClasses, qtiContentClass) >= 0);\r\n    };\r\n\r\n    QtiElements.getParentClasses = function(qtiClass, recursive){\r\n        var ret;\r\n        if(recursive && QtiElements.cache.parents[qtiClass]){\r\n            ret = QtiElements.cache.parents[qtiClass];\r\n        }else{\r\n            ret = [];\r\n            if(QtiElements.classes[qtiClass]){\r\n                ret = QtiElements.classes[qtiClass].parents;\r\n                if(recursive){\r\n                    for(var i in ret){\r\n                        ret = _.union(ret, QtiElements.getParentClasses(ret[i], recursive));\r\n                    }\r\n                    ret = _.uniq(ret, false);\r\n                }\r\n            }\r\n            QtiElements.cache.parents[qtiClass] = ret;\r\n        }\r\n\r\n        return ret;\r\n    };\r\n\r\n    QtiElements.getChildClasses = function(qtiClass, recursive, type){\r\n        var ret;\r\n        var cacheType = type ? type : 'all';\r\n        if(recursive && QtiElements.cache.children[qtiClass] && QtiElements.cache.children[qtiClass][cacheType]){\r\n            ret = QtiElements.cache.children[qtiClass][cacheType];\r\n        }else{\r\n            ret = [];\r\n            for(var aClass in QtiElements.classes){\r\n                var model = QtiElements.classes[aClass];\r\n                if(_.indexOf(model.parents, qtiClass) >= 0){\r\n                    if(type){\r\n                        if(model[type]){\r\n                            ret.push(aClass);\r\n                        }\r\n                    }else{\r\n                        ret.push(aClass);\r\n                    }\r\n                    if(recursive){\r\n                        ret = _.union(ret, QtiElements.getChildClasses(aClass, recursive, type));\r\n                    }\r\n                }\r\n            }\r\n            if(!QtiElements.cache.children[qtiClass]){\r\n                QtiElements.cache.children[qtiClass] = {};\r\n            }\r\n            QtiElements.cache.children[qtiClass][cacheType] = ret;\r\n        }\r\n\r\n        return ret;\r\n    };\r\n\r\n    QtiElements.isBlock = function(qtiClass){\r\n        return QtiElements.is(qtiClass, 'block');\r\n    };\r\n\r\n    QtiElements.isInline = function(qtiClass){\r\n        return QtiElements.is(qtiClass, 'inline');\r\n    };\r\n\r\n    QtiElements.is = function(qtiClass, topClass){\r\n        if(qtiClass === topClass){\r\n            return true;\r\n        }else{\r\n            var parents = QtiElements.getParentClasses(qtiClass, true);\r\n            return (_.indexOf(parents, topClass) >= 0);\r\n        }\r\n    };\r\n\r\n    QtiElements.getAvailableAuthoringElements = function(){\r\n\r\n        return {\r\n            choiceInteraction : {\r\n                label : __('Choice Interaction'),\r\n                description : __('Select a single (radio buttons) or multiple (check boxes) responses among a set of choices.'),\r\n                icon : 'icon-choice',\r\n                short : __('Choice'),\r\n                qtiClass : 'choiceInteraction',\r\n                tags:['Common Interactions', 'mcq']\r\n            },\r\n            orderInteraction : {\r\n                label : __('Order Interaction'),\r\n                icon : 'icon-order',\r\n                description : __('Arrange a list of choices in the correct order.'),\r\n                short : __('Order'),\r\n                qtiClass : 'orderInteraction',\r\n                tags:['Common Interactions', 'ordering']\r\n            },\r\n            associateInteraction : {\r\n                label : __('Associate Interaction'),\r\n                icon : 'icon-associate',\r\n                description : __('Create pair(s) from a series of choices.'),\r\n                short : __('Associate'),\r\n                qtiClass : 'associateInteraction',\r\n                tags:['Common Interactions', 'association']\r\n            },\r\n            matchInteraction : {\r\n                label : __('Match Interaction'),\r\n                icon : 'icon-match',\r\n                description : __('Create association(s) between two sets of choices displayed in a table (row and column).'),\r\n                short : __('Match'),\r\n                qtiClass : 'matchInteraction',\r\n                tags:['Common Interactions', 'association']\r\n            },\r\n            hottextInteraction : {\r\n                label : __('Hottext Interaction'),\r\n                icon : 'icon-hottext',\r\n                description : __('Select one or more text parts (hottext) within a text.'),\r\n                short : __('Hottext'),\r\n                qtiClass : 'hottextInteraction',\r\n                tags:['Common Interactions', 'text']\r\n            },\r\n            gapMatchInteraction : {\r\n                label : __('Gap Match Interaction'),\r\n                icon : 'icon-gap-match',\r\n                description : __(' Fill in the gaps in a text from a set of choices.'),\r\n                short : __('Gap Match'),\r\n                qtiClass : 'gapMatchInteraction',\r\n                tags:['Common Interactions', 'text', 'association']\r\n            },\r\n            sliderInteraction : {\r\n                label : __('Slider Interaction'),\r\n                icon : 'icon-slider',\r\n                description :__('Select a value within a numerical range.'),\r\n                short : __('Slider'),\r\n                qtiClass : 'sliderInteraction',\r\n                tags:['Common Interactions', 'special']\r\n            },\r\n            extendedTextInteraction : {\r\n                label : __('Extended Text Interaction'),\r\n                icon : 'icon-extended-text',\r\n                description : __('Collect open-ended information in one or more text area(s) (strings or numeric values).'),\r\n                short : __('Extended Text'),\r\n                qtiClass : 'extendedTextInteraction',\r\n                tags:['Common Interactions', 'text']\r\n            },\r\n            uploadInteraction : {\r\n                label : __('File Upload Interaction'),\r\n                icon : 'icon-upload',\r\n                description : __('Upload a file (e.g. document, picture...) as a response.'),\r\n                short : __('File Upload'),\r\n                qtiClass : 'uploadInteraction',\r\n                tags:['Common Interactions', 'special']\r\n            },\r\n            mediaInteraction : {\r\n                label : __('Media Interaction'),\r\n                icon : 'icon-media',\r\n                description : __('Control the playing parameters (auto-start, loop) of a video or audio file and report the number of time it has been played.'),\r\n                short : __('Media'),\r\n                qtiClass : 'mediaInteraction',\r\n                tags:['Common Interactions', 'media']\r\n            },\r\n            _container : {\r\n                label : __('Text Block'),\r\n                icon : 'icon-font',\r\n                description : __('Block contains the content (stimulus) of the item such as text or image. It is also required for Inline Interactions.'),\r\n                short : __('Block'),\r\n                qtiClass : '_container',\r\n                tags:['Inline Interactions', 'text']\r\n            },\r\n            inlineChoiceInteraction : {\r\n                label : __('Inline Choice Interaction'),\r\n                icon : 'icon-inline-choice',\r\n                description : __('Select a choice from a drop-down list.'),\r\n                short : __('Inline Choice'),\r\n                qtiClass : 'inlineChoiceInteraction',\r\n                tags:['Inline Interactions', 'inline-interactions', 'mcq']\r\n            },\r\n            textEntryInteraction : {\r\n                label : __('Text Entry Interaction'),\r\n                icon : 'icon-text-entry',\r\n                description : __('Collect open-ended information in a short text input (strings or numeric values).'),\r\n                short : __('Text Entry'),\r\n                qtiClass : 'textEntryInteraction',\r\n                tags:['Inline Interactions', 'inline-interactions', 'text']\r\n            },\r\n            endAttemptInteraction : {\r\n                label : __('End Attempt Interaction'),\r\n                icon : 'icon-end-attempt',\r\n                description : __('Trigger the end of the item attempt.'),\r\n                short : __('End Attempt'),\r\n                qtiClass : 'endAttemptInteraction',\r\n                tags:['Inline Interactions', 'inline-interactions', 'button', 'submit']\r\n            },\r\n            hotspotInteraction : {\r\n                label : __('Hotspot Interaction'),\r\n                icon : 'icon-hotspot',\r\n                description : __('Select one or more areas (hotspots) displayed on an picture.'),\r\n                short : __('Hotspot'),\r\n                qtiClass : 'hotspotInteraction',\r\n                tags:['Graphic Interactions', 'mcq']\r\n            },\r\n            graphicOrderInteraction : {\r\n                label : __('Graphic Order Interaction'),\r\n                icon : 'icon-graphic-order',\r\n                description : __('Order the areas (hotspots) displayed on a picture.'),\r\n                short : __('Order'),\r\n                qtiClass : 'graphicOrderInteraction',\r\n                tags:['Graphic Interactions', 'ordering']\r\n            },\r\n            graphicAssociateInteraction : {\r\n                label : __('Graphic Associate Interaction'),\r\n                icon : 'icon-graphic-associate',\r\n                description : __('Create association(s) between areas (hotspots) displayed on a picture.'),\r\n                short : __('Associate'),\r\n                qtiClass : 'graphicAssociateInteraction',\r\n                tags:['Graphic Interactions', 'association']\r\n            },\r\n            graphicGapMatchInteraction : {\r\n                label : __('Graphic Gap Match Interaction'),\r\n                icon : 'icon-graphic-gap',\r\n                description : __('Fill in the gaps on a picture with a set of image choices.'),\r\n                short : __('Gap Match'),\r\n                qtiClass : 'graphicGapMatchInteraction',\r\n                tags:['Graphic Interactions', 'association']\r\n            },\r\n            selectPointInteraction : {\r\n                label : __('Select Point Interaction'),\r\n                icon : 'icon-select-point',\r\n                description : __('Position one or more points on a picture (response areas are not displayed).'),\r\n                short : __('Select Point'),\r\n                qtiClass : 'selectPointInteraction',\r\n                tags:['Graphic Interactions']\r\n            }\r\n        };\r\n    };\r\n\r\n    return QtiElements;\r\n\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/portableElementRegistry/factory/ciRegistry',[\r\n    'lodash',\r\n    'taoQtiItem/portableElementRegistry/factory/factory',\r\n    'taoQtiItem/qtiCreator/helper/qtiElements'\r\n], function (_, portableElementRegistry, qtiElements){\r\n    'use strict';\r\n\r\n    /**\r\n     * Create a ney interaction registry instance\r\n     * interaction registry need to register newly loaded creator hooks in the list of available qti authoring elements\r\n     *\r\n     * @returns {Object} registry instance\r\n     */\r\n    return function customInteractionRegistry(){\r\n\r\n        return portableElementRegistry({\r\n            getAuthoringData : function getAuthoringData(typeIdentifier, options){\r\n                var pciModel;\r\n                options = _.defaults(options || {}, {version : 0, enabledOnly : false});\r\n                pciModel = this.get(typeIdentifier, options.version);\r\n                if(pciModel && pciModel.creator && pciModel.creator.hook && pciModel.creator.icon && (pciModel.enabled || !options.enabledOnly)){\r\n                    return {\r\n                        label : pciModel.label, //currently no translation available\r\n                        icon : pciModel.creator.icon.replace(new RegExp('^' + typeIdentifier + '\\/'), pciModel.baseUrl),\r\n                        short : pciModel.short,\r\n                        description : pciModel.description,\r\n                        qtiClass : 'customInteraction.' + pciModel.typeIdentifier, //custom interaction is block type\r\n                        tags : _.union(['Custom Interactions'], pciModel.tags)\r\n                    };\r\n                }\r\n            }\r\n        }).on('creatorsloaded', function(creators){\r\n            _.each(creators, function(creator){\r\n                qtiElements.classes['customInteraction.' + creator.getTypeIdentifier()] = {parents : ['customInteraction'], qti : true};\r\n            });\r\n        });\r\n    };\r\n\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/portableElementRegistry/ciRegistry',['lodash', 'taoQtiItem/portableElementRegistry/factory/ciRegistry', 'module'], function (_, ciRegistry, module){\r\n    'use strict';\r\n\r\n    //create a preregistered singleton of ciRegistry\r\n    var registry = ciRegistry();\r\n    var providers = [];\r\n    var config = module.config();\r\n\r\n    if(config && config.providers){\r\n        providers = config.providers;\r\n    }\r\n\r\n    _.each(providers, function(provider){\r\n        if(provider.name && provider.module){\r\n            registry.registerProvider(provider.module);\r\n        }\r\n    });\r\n\r\n    return registry;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/portableElementRegistry/factory/icRegistry',[\r\n    'lodash',\r\n    'taoQtiItem/portableElementRegistry/factory/factory'\r\n], function (_, portableElementRegistry){\r\n    'use strict';\r\n\r\n    /**\r\n     * Info control registry has currently no additonal fonctionalities than the basic portable element registry\r\n     *\r\n     * @returns {Object} registry instance\r\n     */\r\n    return function infoControlRegistry(){\r\n        return portableElementRegistry();\r\n    }\r\n\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/portableElementRegistry/icRegistry',['lodash', 'taoQtiItem/portableElementRegistry/factory/icRegistry', 'module'], function (_, icRegistry, module){\r\n    'use strict';\r\n\r\n    //create a preregistered singleton of icRegistry\r\n    var registry = icRegistry();\r\n    var providers = [];\r\n    var config = module.config();\r\n\r\n    if(config && config.providers){\r\n        providers = config.providers;\r\n    }\r\n\r\n    _.each(providers, function(provider){\r\n        if(provider.name && provider.module){\r\n            registry.registerProvider(provider.module);\r\n        }\r\n    });\r\n\r\n    return registry;\r\n});\n","define('taoQtiItem/qtiItem/core/qtiClasses',[], function(){\r\n    return {\r\n        '_container' : 'taoQtiItem/qtiItem/core/Container',\r\n        'assessmentItem' : 'taoQtiItem/qtiItem/core/Item',\r\n        'responseProcessing' : 'taoQtiItem/qtiItem/core/ResponseProcessing',\r\n        '_simpleFeedbackRule' : 'taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',\r\n        'stylesheet' : 'taoQtiItem/qtiItem/core/Stylesheet',\r\n        'math' : 'taoQtiItem/qtiItem/core/Math',\r\n        'img' : 'taoQtiItem/qtiItem/core/Img',\r\n        'object' : 'taoQtiItem/qtiItem/core/Object',\r\n        'outcomeDeclaration' : 'taoQtiItem/qtiItem/core/variables/OutcomeDeclaration',\r\n        'responseDeclaration' : 'taoQtiItem/qtiItem/core/variables/ResponseDeclaration',\r\n        'rubricBlock' : 'taoQtiItem/qtiItem/core/RubricBlock',\r\n        'associableHotspot' : 'taoQtiItem/qtiItem/core/choices/AssociableHotspot',\r\n        'gap' : 'taoQtiItem/qtiItem/core/choices/Gap',\r\n        'gapImg' : 'taoQtiItem/qtiItem/core/choices/GapImg',\r\n        'gapText' : 'taoQtiItem/qtiItem/core/choices/GapText',\r\n        'hotspotChoice' : 'taoQtiItem/qtiItem/core/choices/HotspotChoice',\r\n        'hottext' : 'taoQtiItem/qtiItem/core/choices/Hottext',\r\n        'inlineChoice' : 'taoQtiItem/qtiItem/core/choices/InlineChoice',\r\n        'simpleAssociableChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',\r\n        'simpleChoice' : 'taoQtiItem/qtiItem/core/choices/SimpleChoice',\r\n        'associateInteraction' : 'taoQtiItem/qtiItem/core/interactions/AssociateInteraction',\r\n        'choiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',\r\n        'endAttemptInteraction' : 'taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',\r\n        'extendedTextInteraction' : 'taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction',\r\n        'gapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',\r\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',\r\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',\r\n        'graphicOrderInteraction' : 'taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',\r\n        'hotspotInteraction' : 'taoQtiItem/qtiItem/core/interactions/HotspotInteraction',\r\n        'hottextInteraction' : 'taoQtiItem/qtiItem/core/interactions/HottextInteraction',\r\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',\r\n        'matchInteraction' : 'taoQtiItem/qtiItem/core/interactions/MatchInteraction',\r\n        'mediaInteraction' : 'taoQtiItem/qtiItem/core/interactions/MediaInteraction',\r\n        'orderInteraction' : 'taoQtiItem/qtiItem/core/interactions/OrderInteraction',\r\n        'prompt' : 'taoQtiItem/qtiItem/core/interactions/Prompt',\r\n        'selectPointInteraction' : 'taoQtiItem/qtiItem/core/interactions/SelectPointInteraction',\r\n        'sliderInteraction' : 'taoQtiItem/qtiItem/core/interactions/SliderInteraction',\r\n        'textEntryInteraction' : 'taoQtiItem/qtiItem/core/interactions/TextEntryInteraction',\r\n        'uploadInteraction' : 'taoQtiItem/qtiItem/core/interactions/UploadInteraction',\r\n        'feedbackBlock' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackBlock',\r\n        'feedbackInline' : 'taoQtiItem/qtiItem/core/feedbacks/FeedbackInline',\r\n        'modalFeedback' : 'taoQtiItem/qtiItem/core/feedbacks/ModalFeedback',\r\n        'customInteraction' : 'taoQtiItem/qtiItem/core/interactions/CustomInteraction',\r\n        'infoControl' : 'taoQtiItem/qtiItem/core/PortableInfoControl',\r\n        'include' : 'taoQtiItem/qtiItem/core/Include',\r\n        'table' : 'taoQtiItem/qtiItem/core/Table'\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\n\r\n/**\r\n * Common basic util functions\r\n */\r\ndefine('taoQtiItem/qtiItem/helper/util',['lodash'], function(_){\r\n    'use strict';\r\n\r\n    var util = {\r\n\r\n        buildSerial : function buildSerial(prefix){\r\n            var id = prefix || '';\r\n            var chars = \"abcdefghijklmnopqrstuvwxyz0123456789\";\r\n            for(var i = 0; i < 22; i++){\r\n                id += chars.charAt(Math.floor(Math.random() * chars.length));\r\n            }\r\n            return id;\r\n        },\r\n\r\n        /**\r\n         * Generates an id for a Qti element (the generation is different from identifier)\r\n         * @param {Object} item - the element related item\r\n         * @param {String} prefix - identifier prefix\r\n         * @returns {String} the identifier\r\n         * @throws {TypeError} if there is no item\r\n         */\r\n        buildId : function buildId(item, prefix){\r\n            var id;\r\n            var usedIds;\r\n            var i = 1;\r\n            var suffix = '';\r\n            var exists = false;\r\n\r\n            if(!item){\r\n                throw new TypeError('A item is required to generate a unique identifier');\r\n            }\r\n\r\n            usedIds   = item.getUsedIds();\r\n\r\n            do{\r\n                exists = false;\r\n                id = prefix + suffix;\r\n                if(_.contains(usedIds, id)){\r\n                    exists = true;\r\n                    suffix = '_' + i;\r\n                    i++;\r\n                }\r\n            } while(exists);\r\n\r\n            return id;\r\n        },\r\n\r\n        /**\r\n         * Generates an identifier for a Qti element\r\n         * @param {Object} item - the element related item\r\n         * @param {String} prefix - identifier prefix\r\n         * @param {Boolean} [useSuffix = true] - add a \"_ + index\" to the identifier\r\n         * @returns {String} the identifier\r\n         * @throws {TypeError} if there is no item\r\n         */\r\n        buildIdentifier : function buildIdentifier(item, prefix, useSuffix){\r\n\r\n            var id;\r\n            var usedIds;\r\n            var suffix = '';\r\n            var i = 1;\r\n            var exists = false;\r\n\r\n            if(!item){\r\n                throw new TypeError('A item is required to generate a unique identifier');\r\n            }\r\n\r\n            if(!prefix){\r\n                throw new TypeError('Prefix is required to build an identifier');\r\n            }\r\n\r\n            usedIds   = item.getUsedIdentifiers();\r\n            useSuffix = _.isUndefined(useSuffix) ? true : useSuffix;\r\n\r\n            if(prefix){\r\n                prefix = prefix.replace(/_[0-9]+$/ig, '_') //detect incremental id of type choice_12, response_3, etc.\r\n                               .replace(/[^a-zA-Z0-9_]/ig, '_')\r\n                               .replace(/(_)+/ig, '_');\r\n                if(useSuffix){\r\n                    suffix = '_' + i;\r\n                }\r\n            }\r\n\r\n            do{\r\n                exists = false;\r\n                id = prefix + suffix;\r\n                if(usedIds[id]){\r\n                    exists = true;\r\n                    suffix = '_' + i;\r\n                    i++;\r\n                }\r\n            } while(exists);\r\n\r\n            return id;\r\n        },\r\n\r\n        findInCollection : function findInCollection(element, collectionNames, searchedSerial){\r\n\r\n            var found = null;\r\n\r\n            if(_.isString(collectionNames)){\r\n                collectionNames = [collectionNames];\r\n            }\r\n\r\n            if(_.isArray(collectionNames)){\r\n\r\n                _.each(collectionNames, function(collectionName){\r\n\r\n                    //get collection to search in (resolving case like interaction.choices.0\r\n                    var collection = element;\r\n                    _.each(collectionName.split('.'), function(nameToken){\r\n                        collection = collection[nameToken];\r\n                    });\r\n                    var elt = collection[searchedSerial];\r\n\r\n                    if(elt){\r\n                        found = {'parent' : element, 'element' : elt};\r\n                        return false;//break the each loop\r\n                    }\r\n\r\n                    //search inside each elements:\r\n                    _.each(collection, function(elt){\r\n\r\n                        if(_.isFunction(elt.find)){\r\n                            found = elt.find(searchedSerial);\r\n                            if(found){\r\n                                return false;//break the each loop\r\n                            }\r\n                        }\r\n\r\n                    });\r\n\r\n                    if(found){\r\n                        return false;//break the each loop\r\n                    }\r\n\r\n                });\r\n\r\n            }else{\r\n\r\n                throw new Error('invalid argument : collectionNames must be an array or a string');\r\n            }\r\n\r\n            return found;\r\n        },\r\n        addMarkupNamespace : function addMarkupNamespace(markup, ns){\r\n            if(ns) {\r\n                markup = markup.replace(/<(\\/)?([a-z:]+)(\\s?)([^><]*)>/g, function($0, $1, $2, $3, $4){\r\n                    if($2.indexOf(':')>0){\r\n                        return $0;\r\n                    }\r\n                    $1 = $1 || '';\r\n                    $3 = $3 || '';\r\n                    return '<'+ $1 + ns + ':'+$2+$3+$4+'>';\r\n                });\r\n                return markup;\r\n            }\r\n            return markup;\r\n\r\n        },\r\n        removeMarkupNamespaces : function removeMarkupNamespace(markup){\r\n            return markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, '<$1$3>');\r\n        },\r\n        getMarkupUsedNamespaces : function getMarkupUsedNamespaces(markup){\r\n            var namespaces = [];\r\n            markup.replace(/<(\\/)?(\\w*):([^>]*)>/g, function(original, slash, ns, node){\r\n                namespaces.push(ns);\r\n                return '<'+slash+node+'>';\r\n            });\r\n            return _.uniq(namespaces);\r\n        }\r\n    };\r\n\r\n    return util;\r\n});\r\n\n","define('taoQtiItem/qtiItem/helper/rendererConfig',['lodash', 'jquery'], function(_, $){\r\n\r\n    var rendererConfigHelper = {};\r\n\r\n    rendererConfigHelper.getOptionsFromArguments = function(args){\r\n\r\n        var options = {\r\n            data : {},\r\n            placeholder : null,\r\n            subclass : '',\r\n            renderer : null\r\n        };\r\n        \r\n        _.each(args, function(arg){\r\n            if(arg){\r\n                if(arg.isRenderer){\r\n                    options.renderer = arg;\r\n                }else if(arg instanceof $ && arg.length){\r\n                    options.placeholder = arg;\r\n                }else if(_.isString(arg)){\r\n                    options.subclass = arg;\r\n                }else if(_.isPlainObject(arg)){\r\n                    options.data = arg;\r\n                }else{\r\n                    console.log('invalid arg', arg, args);\r\n                }\r\n            }\r\n        });\r\n        \r\n        return options;\r\n    };\r\n    \r\n    return rendererConfigHelper;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/Element',[\r\n    'jquery',\r\n    'lodash',\r\n    'class',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function($, _, Class, util, rendererConfig){\r\n    'use strict';\r\n\r\n    var _instances = {};\r\n\r\n    var Element = Class.extend({\r\n        qtiClass : '',\r\n        serial : '',\r\n        relatedItem : null,\r\n        init : function(serial, attributes){\r\n\r\n            //init own attributes\r\n            this.attributes = {};\r\n\r\n            //system properties, for item creator internal use only\r\n            this.metaData = {};\r\n\r\n            //init call in the format init(attributes)\r\n            if(typeof (serial) === 'object'){\r\n                attributes = serial;\r\n                serial = '';\r\n            }\r\n\r\n            if(!serial){\r\n                serial = util.buildSerial(this.qtiClass + '_');\r\n            }\r\n\r\n            if(serial && (typeof serial !== 'string' || !serial.match(/^[a-z_0-9]*$/i))){\r\n                throw 'invalid QTI serial : (' + (typeof serial) + ') ' + serial;\r\n            }\r\n\r\n            if(!_instances[serial]){\r\n                _instances[serial] = this;\r\n                this.serial = serial;\r\n                this.setAttributes(attributes || {});\r\n            }else{\r\n                throw 'a QTI Element with the same serial already exists ' + serial;\r\n            }\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                this.initContainer(arguments[2] || '');\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                this.initObject();\r\n            }\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === this.qtiClass);\r\n        },\r\n        placeholder : function(){\r\n            return '{{' + this.serial + '}}';\r\n        },\r\n        getSerial : function(){\r\n            return this.serial;\r\n        },\r\n        getUsedIdentifiers : function(){\r\n            var usedIds = {};\r\n            var elts = this.getComposingElements();\r\n            for(var i in elts){\r\n                var elt = elts[i];\r\n                var id = elt.attr('identifier');\r\n                if(id){\r\n                    //warning: simplistic implementation, allow only one unique identifier in the item no matter the element class/type\r\n                    usedIds[id] = elt;\r\n                }\r\n            }\r\n            return usedIds;\r\n        },\r\n\r\n        /**\r\n         * Get the ids in use. (id is different from identifier)\r\n         * @returns {Array} of the ids in use\r\n         */\r\n        getUsedIds : function getUsedIds(){\r\n            var usedIds = [];\r\n            _.forEach(this.getComposingElements(), function(elt){\r\n                var id = elt.attr('id');\r\n                if(id && !_.contains(usedIds, id)){\r\n                    usedIds.push(id);\r\n                }\r\n            });\r\n            return usedIds;\r\n        },\r\n\r\n        attr : function(name, value){\r\n            if(name){\r\n                if(value !== undefined){\r\n                    this.attributes[name] = value;\r\n                }else{\r\n                    if(typeof (name) === 'object'){\r\n                        for(var prop in name){\r\n                            this.attr(prop, name[prop]);\r\n                        }\r\n                    }else if(typeof (name) === 'string'){\r\n                        if(this.attributes[name] === undefined){\r\n                            return undefined;\r\n                        }else{\r\n                            return this.attributes[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        data : function(name, value){\r\n            if(name){\r\n                if(value !== undefined){\r\n                    this.metaData[name] = value;\r\n                    $(document).trigger('metaChange.qti-widget', {element : this, key : name, value : value});\r\n                }else{\r\n                    if(typeof (name) === 'object'){\r\n                        for(var prop in name){\r\n                            this.data(prop, name[prop]);\r\n                        }\r\n                    }else if(typeof (name) === 'string'){\r\n                        if(this.metaData[name] === undefined){\r\n                            return undefined;\r\n                        }else{\r\n                            return this.metaData[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        removeData : function(name){\r\n            delete this.metaData[name];\r\n            return this;\r\n        },\r\n        removeAttr : function(name){\r\n            return this.removeAttributes(name);\r\n        },\r\n        setAttributes : function(attributes){\r\n            this.attributes = attributes;\r\n            return this;\r\n        },\r\n        getAttributes : function(){\r\n            return _.clone(this.attributes);\r\n        },\r\n        removeAttributes : function(attrNames){\r\n            if(typeof (attrNames) === 'string'){\r\n                attrNames = [attrNames];\r\n            }\r\n            for(var i in attrNames){\r\n                delete this.attributes[attrNames[i]];\r\n            }\r\n            return this;\r\n        },\r\n        getComposingElements : function(){\r\n            var elts = {};\r\n            function append(element){\r\n                elts[element.getSerial()] = element;//pass individual object by ref, instead of the whole list(object)\r\n                elts = _.extend(elts, element.getComposingElements());\r\n            }\r\n            if(typeof this.initContainer === 'function'){\r\n                append(this.getBody());\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                append(this.getObject());\r\n            }\r\n            _.each(this.metaData, function(v){\r\n                if(Element.isA(v, '_container')){\r\n                    append(v);\r\n                }else if(_.isArray(v)){\r\n                    _.each(v, function(v){\r\n                        if(Element.isA(v, '_container')){\r\n                            append(v);\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n            return elts;\r\n        },\r\n        getUsedClasses : function(){\r\n\r\n            var ret = [this.qtiClass],\r\n                composingElts = this.getComposingElements();\r\n\r\n            _.each(composingElts, function(elt){\r\n                ret.push(elt.qtiClass);\r\n            });\r\n\r\n            return _.uniq(ret);\r\n        },\r\n        find : function(serial){\r\n\r\n            var found = null;\r\n\r\n            if(typeof this.initObject === 'function'){\r\n                var object = this.getObject();\r\n                if(object.serial === serial){\r\n                    found = {'parent' : this, 'element' : object, 'location' : 'object'};\r\n                }\r\n            }\r\n\r\n            if(!found && typeof this.initContainer === 'function'){\r\n                found = this.getBody().find(serial, this);\r\n            }\r\n\r\n            return found;\r\n        },\r\n        parent : function(){\r\n            var item = this.getRelatedItem();\r\n            if(item){\r\n                var found = item.find(this.getSerial());\r\n                if(found){\r\n                    return found.parent;\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        setRelatedItem : function(item, recursive){\r\n\r\n            recursive = (typeof recursive === 'undefined') ? true : recursive;\r\n\r\n            if(Element.isA(item, 'assessmentItem')){\r\n                this.relatedItem = item;\r\n                var composingElts = this.getComposingElements();\r\n                for(var i in composingElts){\r\n                    composingElts[i].setRelatedItem(item, false);\r\n                }\r\n            }\r\n\r\n        },\r\n        getRelatedItem : function(){\r\n            var ret = null;\r\n            if(Element.isA(this.relatedItem, 'assessmentItem')){\r\n                ret = this.relatedItem;\r\n            }\r\n            return ret;\r\n        },\r\n        setRenderer : function(renderer){\r\n            if(renderer && renderer.isRenderer){\r\n                this.renderer = renderer;\r\n                var elts = this.getComposingElements();\r\n                for(var serial in elts){\r\n                    elts[serial].setRenderer(renderer);\r\n                }\r\n            }else{\r\n                throw 'invalid qti rendering engine';\r\n            }\r\n        },\r\n        getRenderer : function(){\r\n            return this.renderer;\r\n        },\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments);\r\n            var _renderer = args.renderer || this.getRenderer();\r\n\r\n            var tplData = {},\r\n                defaultData = {\r\n                    'tag' : this.qtiClass,\r\n                    'serial' : this.serial,\r\n                    'attributes' : this.getAttributes()\r\n                };\r\n\r\n            if(!_renderer){\r\n                throw 'render: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\r\n            }\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                //allow body to have a different renderer if it has its own renderer set\r\n                defaultData.body = this.getBody().render(args.renderer);\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                defaultData.object = {\r\n                    attributes : this.object.getAttributes()\r\n                };\r\n                defaultData.object.attributes.data = _renderer.resolveUrl(this.object.attr('data'));\r\n            }\r\n\r\n            tplData = _.merge(defaultData, args.data || {});\r\n            tplData = _renderer.getData(this, tplData, args.subclass);\r\n            var rendering = _renderer.renderTpl(this, tplData, args.subclass);\r\n            if(args.placeholder){\r\n                args.placeholder.replaceWith(rendering);\r\n            }\r\n\r\n            return rendering;\r\n        },\r\n        postRender : function(data, altClassName, renderer){\r\n\r\n            var postRenderers = [];\r\n            var _renderer = renderer || this.getRenderer();\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                //allow body to have a different renderer if it has its own renderer set\r\n                postRenderers = this.getBody().postRender(data, '', renderer);\r\n            }\r\n\r\n            if(_renderer){\r\n                postRenderers.push(_renderer.postRender(this, data, altClassName));\r\n            }else{\r\n                throw 'postRender: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\r\n            }\r\n\r\n            return _.compact(postRenderers);\r\n        },\r\n        getContainer : function($scope, subclass){\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                return renderer.getContainer(this, $scope, subclass);\r\n            }else{\r\n                throw 'getContainer: no renderer found for the element ' + this.qtiClass + ':' + this.serial;\r\n            }\r\n        },\r\n        toArray : function(){\r\n            var arr = {\r\n                serial : this.serial,\r\n                type : this.qtiClass,\r\n                attributes : this.getAttributes()\r\n            };\r\n\r\n            if(typeof this.initContainer === 'function'){\r\n                arr.body = this.getBody().toArray();\r\n            }\r\n            if(typeof this.initObject === 'function'){\r\n                arr.object = this.object.toArray();\r\n            }\r\n\r\n            return arr;\r\n        },\r\n        isEmpty : function(){\r\n            //tells whether the element should be considered empty or not, from the rendering point of view\r\n            return false;\r\n        },\r\n        addClass : function(className){\r\n            var clazz = this.attr('class') || '';\r\n            if(!_containClass(clazz, className)){\r\n                this.attr('class', clazz + (clazz.length ? ' ' : '') + className);\r\n            }\r\n        },\r\n        hasClass : function(className){\r\n            return _containClass(this.attr('class'), className);\r\n        },\r\n        removeClass : function(className){\r\n\r\n            var clazz = this.attr('class') || '';\r\n            if(clazz){\r\n\r\n                var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)');\r\n                clazz = clazz.replace(regex, ' ').trim();\r\n\r\n                if(clazz){\r\n                    this.attr('class', clazz);\r\n                }else{\r\n                    this.removeAttr('class');\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * Add or remove class. Setting the optional state will force addition/removal.\r\n         * State is here to keep the jQuery syntax\r\n         *\r\n         * @param {String} className\r\n         * @param {Boolean} [state]\r\n         */\r\n        toggleClass : function(className, state) {\r\n\r\n            if(typeof state === 'boolean') {\r\n                return state ? this.addClass(className) : this.removeClass(className);\r\n            }\r\n\r\n            if(this.hasClass(className)) {\r\n                return this.removeClass(className);\r\n            }\r\n            return this.addClass(className);\r\n        },\r\n        isset : function(){\r\n            return Element.issetElement(this.serial);\r\n        },\r\n        unset : function(){\r\n            return Element.unsetElement(this.serial);\r\n        }\r\n    });\r\n\r\n    var _containClass = function(allClassStr, className){\r\n        var regex = new RegExp('(?:^|\\\\s)' + className + '(?:\\\\s|$)', '');\r\n        return allClassStr && regex.test(allClassStr);\r\n    };\r\n\r\n    //helpers\r\n    Element.isA = function(qtiElement, qtiClass){\r\n        return (qtiElement instanceof Element && qtiElement.is(qtiClass));\r\n    };\r\n\r\n    Element.getElementBySerial = function(serial){\r\n        return _instances[serial];\r\n    };\r\n\r\n    Element.issetElement = function(serial){\r\n        return !!_instances[serial];\r\n    };\r\n\r\n    /**\r\n     * Unset a registered element from it's serial\r\n     * @param {String} serial - the element serial\r\n     * @returns {Boolean} true if unset\r\n     */\r\n    Element.unsetElement = function(serial){\r\n\r\n        var element = Element.getElementBySerial(serial);\r\n\r\n        if(element){\r\n\r\n            var composingElements = element.getComposingElements();\r\n            _.each(composingElements, function(elt){\r\n                delete _instances[elt.serial];\r\n            });\r\n            delete _instances[element.serial];\r\n\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    return Element;\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n//@todo : move this to the ../helper directory\r\ndefine('taoQtiItem/qtiItem/core/Loader',['lodash', 'class', 'taoQtiItem/qtiItem/core/qtiClasses', 'taoQtiItem/qtiItem/core/Element'], function(_, Class, qtiClasses, Element){\r\n\r\n    var Loader = Class.extend({\r\n        init : function(item, classesLocation){\r\n\r\n            this.qti = {}; //loaded qti classes are store here\r\n            this.classesLocation = {};\r\n\r\n            this.item = item || null;//starts either from scratch or with an existing item object\r\n            this.setClassesLocation(classesLocation || qtiClasses);//load default location for qti classes model\r\n        },\r\n        setClassesLocation : function(qtiClasses){\r\n            _.extend(this.classesLocation, qtiClasses);\r\n            return this;\r\n        },\r\n        getRequiredClasses : function(data){\r\n            var ret = [];\r\n            for(var i in data){\r\n                if(i === 'qtiClass' && data[i] !== '_container' && i !== 'relatedItem'){//although a _container is a concrete class in TAO, it is not defined in QTI standard\r\n                    ret.push(data[i]);\r\n                }else if(typeof(data[i]) === 'object' && i !== 'responseRules'){    //responseRules should'nt be part of the parsing\r\n                    ret = _.union(ret, this.getRequiredClasses(data[i]));\r\n                }\r\n            }\r\n            return ret;\r\n        },\r\n        loadRequiredClasses : function(data, callback, reload){\r\n\r\n            var requiredClasses = this.getRequiredClasses(data, reload), required = [];\r\n\r\n            for(var i in requiredClasses){\r\n                var requiredClass = requiredClasses[i];\r\n                if(this.classesLocation[requiredClass]){\r\n                    required.push(this.classesLocation[requiredClass]);\r\n                }else{\r\n                    throw new Error('missing qti class location declaration : ' + requiredClass);\r\n                }\r\n            }\r\n\r\n            var _this = this;\r\n            require(required, function(){\r\n                _.each(arguments, function(QtiClass){\r\n                    _this.qti[QtiClass.prototype.qtiClass] = QtiClass;\r\n                });\r\n                callback.call(_this, _this.qti);\r\n            });\r\n        },\r\n        getLoadedClasses : function(){\r\n            return _.keys(this.qti);\r\n        },\r\n        loadItemData : function(data, callback){\r\n\r\n            var _this = this;\r\n            _this.loadRequiredClasses(data, function(Qti){\r\n                var i;\r\n                if(typeof(data) === 'object' && data.qtiClass === 'assessmentItem'){\r\n\r\n                    //unload an item from it's serial (in case of a reload)\r\n                    if(data.serial){\r\n                        Element.unsetElement(data.serial);\r\n                    }\r\n\r\n                    _this.item = new Qti.assessmentItem(data.serial, data.attributes || {});\r\n                    _this.loadContainer(_this.item.getBody(), data.body);\r\n\r\n                    for(i in data.outcomes){\r\n                        var outcome = _this.buildOutcome(data.outcomes[i]);\r\n                        if(outcome){\r\n                            _this.item.addOutcomeDeclaration(outcome);\r\n                        }\r\n                    }\r\n                    for(i in data.feedbacks){\r\n                        var feedback = _this.buildElement(data.feedbacks[i]);\r\n                        if(feedback){\r\n                            _this.item.addModalFeedback(feedback);\r\n                        }\r\n                    }\r\n                    for(i in data.stylesheets){\r\n                        var stylesheet = _this.buildElement(data.stylesheets[i]);\r\n                        if(stylesheet){\r\n                            _this.item.addStylesheet(stylesheet);\r\n                        }\r\n                    }\r\n\r\n                    //important : build responses after all modal feedbacks and outcomes has been loaded, because the simple feedback rules need to reference them\r\n                    for(i in data.responses){\r\n                        var response = _this.buildResponse(data.responses[i]);\r\n                        if(response){\r\n                            _this.item.addResponseDeclaration(response);\r\n\r\n                            var feedbackRules = data.responses[i].feedbackRules;\r\n                            if(feedbackRules){\r\n                                _.forIn(feedbackRules, function(fbData, serial){\r\n                                    response.feedbackRules[serial] = _this.buildSimpleFeedbackRule(fbData, response);\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(data.responseProcessing){\r\n                        _this.item.setResponseProcessing(_this.buildResponseProcessing(data.responseProcessing));\r\n                    }\r\n                    _this.item.setNamespaces(data.namespaces);\r\n                    _this.item.setSchemaLocations(data.schemaLocations);\r\n                    _this.item.setApipAccessibility(data.apipAccessibility);\r\n                }\r\n\r\n                if(typeof(callback) === 'function'){\r\n                    callback.call(_this, _this.item);\r\n                }\r\n            });\r\n        },\r\n        loadAndBuildElement : function(data, callback){\r\n\r\n            var _this = this;\r\n\r\n            _this.loadRequiredClasses(data, function(Qti){\r\n\r\n                var element = _this.buildElement(data);\r\n\r\n                if(typeof(callback) === 'function'){\r\n                    callback.call(_this, element);\r\n                }\r\n            });\r\n        },\r\n        loadElement : function(element, data, callback){\r\n\r\n            var _this = this;\r\n            this.loadRequiredClasses(data, function(){\r\n                _this.loadElementData(element, data);\r\n                if(typeof(callback) === 'function'){\r\n                    callback.call(_this, element);\r\n                }\r\n            });\r\n        },\r\n        /**\r\n         * Load ALL given elements into existing loaded item\r\n         *\r\n         * @todo to be renamed to loadItemElements\r\n         * @param {object} data\r\n         * @param {function} callback\r\n         * @returns {undefined}\r\n         */\r\n        loadElements : function(data, callback){\r\n\r\n            var _this = this;\r\n\r\n            if(_this.item){\r\n\r\n                this.loadRequiredClasses(data, function(){\r\n\r\n                    var allElements = _this.item.getComposingElements();\r\n\r\n                    for(var i in data){\r\n                        var elementData = data[i];\r\n                        if(elementData && elementData.qtiClass && elementData.serial){\r\n                            //find and update element\r\n                            if(allElements[elementData.serial]){\r\n                                _this.loadElementData(allElements[elementData.serial], elementData);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if(typeof(callback) === 'function'){\r\n                        callback.call(_this, _this.item);\r\n                    }\r\n                });\r\n            }else{\r\n                throw 'QtiLoader : cannot load elements in empty item';\r\n            }\r\n\r\n        },\r\n        buildResponse : function(data){\r\n\r\n            var response = this.buildElement(data);\r\n\r\n            response.template = data.howMatch || null;\r\n            response.defaultValue = data.defaultValue || null;\r\n            response.correctResponse = data.correctResponses || null;\r\n\r\n            if(_.size(data.mapping)){\r\n                response.mapEntries = data.mapping;\r\n            }else if(_.size(data.areaMapping)){\r\n                response.mapEntries = data.areaMapping;\r\n            }else{\r\n                response.mapEntries = {};\r\n            }\r\n\r\n            response.mappingAttributes = data.mappingAttributes || {};\r\n\r\n            return response;\r\n        },\r\n        buildSimpleFeedbackRule : function(data, response){\r\n\r\n            var feedbackRule = this.buildElement(data);\r\n\r\n            feedbackRule.setCondition(response, data.condition, data.comparedValue || null);\r\n\r\n//            feedbackRule.comparedOutcome = this.item.responses[data.comparedOutcome] || null;\r\n            feedbackRule.feedbackOutcome = this.item.outcomes[data.feedbackOutcome] || null;\r\n            feedbackRule.feedbackThen = this.item.modalFeedbacks[data.feedbackThen] || null;\r\n            feedbackRule.feedbackElse = this.item.modalFeedbacks[data.feedbackElse] || null;\r\n\r\n            //associate the compared outcome to the feedbacks if applicable\r\n            var response = feedbackRule.comparedOutcome;\r\n            if(feedbackRule.feedbackThen){\r\n                feedbackRule.feedbackThen.data('relatedResponse', response);\r\n            }\r\n            if(feedbackRule.feedbackElse){\r\n                feedbackRule.feedbackElse.data('relatedResponse', response);\r\n            }\r\n\r\n            return feedbackRule;\r\n        },\r\n        buildOutcome : function(data){\r\n            var outcome = this.buildElement(data);\r\n            outcome.defaultValue = data.defaultValue || null;\r\n            return outcome;\r\n        },\r\n        buildResponseProcessing : function(data){\r\n            var rp = this.buildElement(data);\r\n            if(data && data.processingType){\r\n                if(data.processingType === 'custom'){\r\n                    rp.xml = data.data;\r\n                    rp.processingType = 'custom';\r\n                }else{\r\n                    rp.processingType = 'templateDriven';\r\n                }\r\n            }\r\n            return rp;\r\n        },\r\n        loadContainer : function(bodyObject, bodyData){\r\n            if(!Element.isA(bodyObject, '_container')){\r\n                throw 'bodyObject must be a QTI Container';\r\n            }\r\n\r\n            if(bodyData && typeof bodyData.body === 'string' && (typeof bodyData.elements === 'array' || typeof bodyData.elements === 'object')){\r\n                for(var serial in bodyData.elements){\r\n                    var eltData = bodyData.elements[serial];\r\n                    //check if class is loaded:\r\n                    var element = this.buildElement(eltData);\r\n                    if(element){\r\n                        bodyObject.setElement(element, bodyData.body);\r\n                    }\r\n                }\r\n                bodyObject.body(bodyData.body);\r\n            }else{\r\n                throw 'wrong bodydata format';\r\n            }\r\n        },\r\n        buildElement : function(elementData){\r\n            var elt = null;\r\n            if(elementData && elementData.qtiClass && elementData.serial){\r\n                var className = elementData.qtiClass;\r\n                if(this.qti[className]){\r\n                    elt = new this.qti[className](elementData.serial);\r\n                    this.loadElementData(elt, elementData);\r\n                }else{\r\n                    throw 'the qti element class does not exist: ' + className;\r\n                }\r\n            }else{\r\n                throw 'wrong elementData format';\r\n            }\r\n            return elt;\r\n        },\r\n        loadElementData : function(element, data){\r\n\r\n            //merge attributes when loading element data\r\n            var attributes = _.defaults(data.attributes || {}, element.attributes || {});\r\n            element.setAttributes(attributes);\r\n\r\n            if(element.body && data.body){\r\n                if(element.bdy){\r\n                    this.loadContainer(element.getBody(), data.body);\r\n                }\r\n            }\r\n\r\n            if(element.object && data.object){\r\n                if(element.object){\r\n                    this.loadObjectData(element.object, data.object);\r\n                }\r\n            }\r\n\r\n            if(Element.isA(element, 'interaction')){\r\n                this.loadInteractionData(element, data);\r\n            }else if(Element.isA(element, 'choice')){\r\n                this.loadChoiceData(element, data);\r\n            }else if(Element.isA(element, 'math')){\r\n                this.loadMathData(element, data);\r\n            }else if(Element.isA(element, 'infoControl')){\r\n                this.loadPicData(element, data);\r\n            }\r\n\r\n            return element;\r\n        },\r\n        loadInteractionData : function(interaction, data){\r\n            if(Element.isA(interaction, 'blockInteraction')){\r\n                if(data.prompt){\r\n                    this.loadContainer(interaction.prompt.getBody(), data.prompt);\r\n                }\r\n            }\r\n\r\n            this.buildInteractionChoices(interaction, data);\r\n\r\n            if(Element.isA(interaction, 'customInteraction')){\r\n                this.loadPciData(interaction, data);\r\n            }\r\n        },\r\n        buildInteractionChoices : function(interaction, data){\r\n\r\n            //note: Qti.ContainerInteraction (Qti.GapMatchInteraction and Qti.HottextInteraction) has already been parsed by builtElement(interacionData);\r\n            if(data.choices){\r\n                if(Element.isA(interaction, 'matchInteraction')){\r\n                    for(var set = 0; set < 2; set++){\r\n                        if(!data.choices[set]){\r\n                            throw 'missing match set #' + set;\r\n                        }\r\n                        var matchSet = data.choices[set];\r\n                        for(var serial in matchSet){\r\n                            var choice = this.buildElement(matchSet[serial]);\r\n                            if(choice){\r\n                                interaction.addChoice(choice, set);\r\n                            }\r\n                        }\r\n                    }\r\n                }else{\r\n                    for(var serial in data.choices){\r\n                        var choice = this.buildElement(data.choices[serial]);\r\n                        if(choice){\r\n                            interaction.addChoice(choice);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if(Element.isA(interaction, 'graphicGapMatchInteraction')){\r\n                    if(data.gapImgs){\r\n                        for(var serial in data.gapImgs){\r\n                            var gapImg = this.buildElement(data.gapImgs[serial]);\r\n                            if(gapImg){\r\n                                interaction.addGapImg(gapImg);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n        },\r\n        loadChoiceData : function(choice, data){\r\n            if(Element.isA(choice, 'textVariableChoice')){\r\n                choice.val(data.text);\r\n            }else if(Element.isA(choice, 'gapImg')){\r\n                //has already been taken care of in buildElement()\r\n            }else if(Element.isA(choice, 'gapText')){\r\n                // this ensure compatibility of Qti 2.1 items\r\n                if (! choice.body()) {\r\n                    choice.body(data.text);\r\n                }\r\n            }else if(Element.isA(choice, 'containerChoice')){\r\n                //has already been taken care of in buildElement()\r\n            }\r\n        },\r\n        loadObjectData : function(object, data){\r\n            object.setAttributes(data.attributes);\r\n            //@todo: manage object like a container\r\n            if(data._alt){\r\n                if(data._alt.qtiClass === 'object'){\r\n                    object._alt = Loader.buildElement(data._alt);\r\n                }else{\r\n                    object._alt = data._alt;\r\n                }\r\n            }\r\n        },\r\n        loadMathData : function(math, data){\r\n            math.ns = data.ns || {};\r\n            math.setMathML(data.mathML || '');\r\n            _.forIn(data.annotations || {}, function(value, encoding){\r\n                math.setAnnotation(encoding, value);\r\n            });\r\n        },\r\n        loadPciData : function(pci, data){\r\n            loadPortableCustomElementData(pci, data);\r\n        },\r\n        loadPicData : function(pic, data){\r\n            loadPortableCustomElementData(pic, data);\r\n        }\r\n    });\r\n\r\n    function loadPortableCustomElementData(portableElement, data){\r\n        portableElement.typeIdentifier = data.typeIdentifier;\r\n        portableElement.markup = data.markup;\r\n        portableElement.entryPoint = data.entryPoint;\r\n        portableElement.properties = data.properties;\r\n        portableElement.libraries = data.libraries;\r\n    }\r\n\r\n    return Loader;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/helper/event',['jquery', 'lodash'], function($, _){\r\n    \"use strict\";\r\n    var _ns = '.qti-creator';\r\n    var _ns_model = '.qti-creator';\r\n    var eventList = [\r\n        'containerBodyChange',\r\n        'containerElementAdded',\r\n        'elementCreated.qti-widget',\r\n        'attributeChange.qti-widget',\r\n        'choiceCreated.qti-widget',\r\n        'correctResponseChange.qti-widget',\r\n        'mapEntryChange.qti-widget',\r\n        'mapEntryRemove.qti-widget',\r\n        'deleted.qti-widget',\r\n        'choiceTextChange.qti-widget',\r\n        'responseTemplateChange.qti-widget',\r\n        'mappingAttributeChange.qti-widget',\r\n        'feedbackRuleConditionChange.qti-widget',\r\n        'feedbackRuleCreated.qti-widget',\r\n        'feedbackRuleRemoved.qti-widget',\r\n        'feedbackRuleElseCreated.qti-widget',\r\n        'feedbackRuleElseRemoved.qti-widget'\r\n    ];\r\n\r\n    var event = {\r\n        choiceCreated : function(choice, interaction){\r\n            $(document).trigger('choiceCreated.qti-widget', {choice : choice, interaction : interaction});\r\n        },\r\n        deleted : function(element, parent){\r\n\r\n            if(element.isset()){\r\n                element.unset();\r\n            }\r\n\r\n            $(document).off('.' + element.getSerial());\r\n            $(document).trigger('deleted.qti-widget', {element : element, parent : parent});\r\n        },\r\n        getList : function(addedNamespace){\r\n            var events = _.clone(eventList);\r\n            if(addedNamespace){\r\n                return _.map(events, function(e){\r\n                    return e + '.' + addedNamespace;\r\n                });\r\n            }else{\r\n                return events;\r\n            }\r\n        },\r\n        initElementToWidgetListeners : function(){\r\n\r\n            var ns = '.widget-container';\r\n\r\n            //forward all event to the widget $container\r\n            $(document).off(ns).on(event.getList(ns).join(' '), function(e, data){\r\n                var element = data.element || data.container || null;\r\n                if(data && element && element.data('widget')){\r\n                    element.data('widget').$container.trigger(e.type + _ns + _ns_model, data);\r\n                }\r\n            });\r\n\r\n        },\r\n        getNs : function(){\r\n            return _ns;\r\n        },\r\n        getNsModel : function(){\r\n            return _ns_model;\r\n        }\r\n    };\r\n\r\n    return event;\r\n});\n","define('taoQtiItem/qtiCreator/model/helper/invalidator',['lodash'], function(_){\r\n    \"use strict\";\r\n    var invalidator = {\r\n        completelyValid : function(element){\r\n            \r\n            var item = element.getRelatedItem();\r\n            var serial, invalidElements;\r\n            if(item){\r\n                serial = element.getSerial();\r\n                invalidElements = item.data('invalid') || {};\r\n            \r\n                delete invalidElements[serial];\r\n                item.data('invalid', invalidElements);\r\n            }\r\n        },\r\n        valid : function(element, key){\r\n\r\n            var item = element.getRelatedItem();\r\n            var serial = element.getSerial();\r\n            var invalidElements;\r\n\r\n            if(item){\r\n                invalidElements = item.data('invalid') || {};\r\n\r\n                if(key){\r\n\r\n                    if(invalidElements[serial] && invalidElements[serial][key]){\r\n                        delete invalidElements[serial][key];\r\n                        if(!_.size(invalidElements[serial])){\r\n                            delete invalidElements[serial];\r\n                        }\r\n\r\n                        item.data('invalid', invalidElements);\r\n                    }\r\n\r\n                }else{\r\n                    throw new Error('missing required argument \"key\"');\r\n                }\r\n            }\r\n        },\r\n        invalid : function(element, key, message, stateName){\r\n\r\n            var item = element.getRelatedItem();\r\n            var serial = element.getSerial();\r\n            var invalidElements;\r\n\r\n            if(item){\r\n                invalidElements = item.data('invalid') || {};\r\n\r\n                if(key){\r\n\r\n                    if(!invalidElements[serial]){\r\n                        invalidElements[serial] = {};\r\n                    }\r\n\r\n                    invalidElements[serial][key] = {\r\n                        message : message || '',\r\n                        stateName : stateName || 'active'\r\n                    };\r\n                    item.data('invalid', invalidElements);\r\n\r\n                }else{\r\n                    throw new Error('missing required arguments \"key\"');\r\n                }\r\n            }\r\n        },\r\n        isValid : function(element){\r\n\r\n            var item = element.getRelatedItem();\r\n            var serial = element.getSerial();\r\n            var invalidElements;\r\n\r\n            if(item){\r\n                invalidElements = item.data('invalid') || {};\r\n                return !invalidElements[serial];\r\n            }\r\n            return true;\r\n        }\r\n    };\r\n\r\n    return invalidator;\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/mixin/editable',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/model/helper/event',\r\n    'taoQtiItem/qtiCreator/model/helper/invalidator',\r\n    'util/url'\r\n], function(_, $, Element, event, invalidator, url){\r\n    \"use strict\";\r\n\r\n    var _removeSelf = function(element){\r\n\r\n        var removed = false,\r\n            related = element.getRelatedItem();\r\n\r\n        if(related){\r\n\r\n            var found = related.find(element.getSerial());\r\n\r\n            if(found){\r\n\r\n                var parent = found.parent;\r\n                if(Element.isA(parent, 'interaction')){\r\n\r\n                    if(element.qtiClass === 'gapImg'){\r\n                        parent.removeGapImg(element);\r\n                    }else if(Element.isA(element, 'choice')){\r\n                        parent.removeChoice(element);\r\n                    }\r\n                    removed = true;\r\n\r\n                }else if(found.location === 'body' && _.isFunction(parent.initContainer)){\r\n\r\n                    if(_.isFunction(element.beforeRemove)){\r\n                        element.beforeRemove();\r\n                    }\r\n\r\n                    parent.getBody().removeElement(element);\r\n                    removed = true;\r\n\r\n                }else if(Element.isA(parent, '_container')){\r\n\r\n                    if(_.isFunction(element.beforeRemove)){\r\n                        element.beforeRemove();\r\n                    }\r\n\r\n                    parent.removeElement(element);\r\n                    removed = true;\r\n                }\r\n\r\n                if(removed){\r\n                    //mark it instantly as removed in case its is being used somewhere else\r\n                    element.data('removed', true);\r\n                    invalidator.completelyValid(element);\r\n                    event.deleted(element, parent);\r\n                }\r\n            }\r\n        }else{\r\n            throw 'no related item found';\r\n        }\r\n\r\n        return removed;\r\n    };\r\n\r\n    var _removeElement = function(element, containerPropName, eltToBeRemoved){\r\n\r\n        if(element[containerPropName]){\r\n\r\n            var targetSerial = '',\r\n                targetElt;\r\n\r\n            if(typeof (eltToBeRemoved) === 'string'){\r\n                targetSerial = eltToBeRemoved;\r\n                targetElt = Element.getElementBySerial(targetSerial);\r\n            }else if(eltToBeRemoved instanceof Element){\r\n                targetSerial = eltToBeRemoved.getSerial();\r\n                targetElt = eltToBeRemoved;\r\n            }\r\n\r\n            if(targetSerial){\r\n                invalidator.completelyValid(targetElt);\r\n                delete element[containerPropName][targetSerial];\r\n                Element.unsetElement(targetSerial);\r\n            }\r\n        }\r\n\r\n        return element;\r\n    };\r\n\r\n    var methods = {\r\n        init : function(serial, attributes){\r\n\r\n            //init call in the format init(attributes)\r\n            if(typeof (serial) === 'object'){\r\n                attributes = serial;\r\n                serial = '';\r\n            }\r\n\r\n            var attr = {};\r\n\r\n            if(_.isFunction(this.getDefaultAttributes)){\r\n                _.extend(attr, this.getDefaultAttributes());\r\n            }\r\n            _.extend(attr, attributes);\r\n\r\n            this._super(serial, attr);\r\n        },\r\n        attr : function(key, value){\r\n            var ret = this._super(key, value);\r\n            if(key !== undefined && value !== undefined){\r\n                $(document).trigger('attributeChange.qti-widget', {'element' : this, 'key' : key, 'value' : value});\r\n            }\r\n            return url.encodeAsXmlAttr(ret);\r\n        },\r\n        removeAttr : function(key){\r\n            var ret = this._super(key);\r\n            $(document).trigger('attributeChange.qti-widget', {'element' : this, 'key' : key, 'value' : null});\r\n            return ret;\r\n        },\r\n        remove : function(){\r\n            if(arguments.length === 0){\r\n                return _removeSelf(this);\r\n            }else if(arguments.length === 2){\r\n                return _removeElement(this, arguments[0], arguments[1]);\r\n            }else{\r\n                throw 'invalid number of argument given';\r\n            }\r\n        }\r\n    };\r\n\r\n    return methods;\r\n});\n","/**\r\n * Define the location of all qti classes used in the QTI Creator\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/qtiClasses',['lodash', 'taoQtiItem/qtiItem/core/qtiClasses'], function(_, qtiClasses){\r\n    \"use strict\";\r\n    //clone the qtiClasses instead of modifying it by direct extend:\r\n    return _.defaults({\r\n        'assessmentItem' : 'taoQtiItem/qtiCreator/model/Item',\r\n        '_container' : 'taoQtiItem/qtiCreator/model/Container',\r\n        'img' : 'taoQtiItem/qtiCreator/model/Img',\r\n        'math' : 'taoQtiItem/qtiCreator/model/Math',\r\n        'object' : 'taoQtiItem/qtiCreator/model/Object',\r\n        'table' : 'taoQtiItem/qtiCreator/model/Table',\r\n        'rubricBlock' : 'taoQtiItem/qtiCreator/model/RubricBlock',\r\n        'modalFeedback' : 'taoQtiItem/qtiCreator/model/feedbacks/ModalFeedback',\r\n        'choiceInteraction' : 'taoQtiItem/qtiCreator/model/interactions/ChoiceInteraction',\r\n        'orderInteraction' : 'taoQtiItem/qtiCreator/model/interactions/OrderInteraction',\r\n        'associateInteraction' : 'taoQtiItem/qtiCreator/model/interactions/AssociateInteraction',\r\n        'matchInteraction' : 'taoQtiItem/qtiCreator/model/interactions/MatchInteraction',\r\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiCreator/model/interactions/InlineChoiceInteraction',\r\n        'simpleChoice' : 'taoQtiItem/qtiCreator/model/choices/SimpleChoice',\r\n        'simpleAssociableChoice' : 'taoQtiItem/qtiCreator/model/choices/SimpleAssociableChoice',\r\n        'inlineChoice' : 'taoQtiItem/qtiCreator/model/choices/InlineChoice',\r\n        'mediaInteraction' : 'taoQtiItem/qtiCreator/model/interactions/MediaInteraction',\r\n        'uploadInteraction' : 'taoQtiItem/qtiCreator/model/interactions/UploadInteraction',\r\n        'textEntryInteraction' : 'taoQtiItem/qtiCreator/model/interactions/TextEntryInteraction',\r\n        'sliderInteraction' : 'taoQtiItem/qtiCreator/model/interactions/SliderInteraction',\r\n        'extendedTextInteraction' : 'taoQtiItem/qtiCreator/model/interactions/ExtendedTextInteraction',\r\n        'hotspotInteraction' : 'taoQtiItem/qtiCreator/model/interactions/HotspotInteraction',\r\n        'selectPointInteraction' : 'taoQtiItem/qtiCreator/model/interactions/SelectPointInteraction',\r\n        'graphicInteraction' : 'taoQtiItem/qtiCreator/model/interactions/GraphicOrderInteraction',\r\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiCreator/model/interactions/GraphicAssociateInteraction',\r\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiCreator/model/interactions/GraphicGapMatchInteraction',\r\n        'graphicOrderInteraction' : 'taoQtiItem/qtiCreator/model/interactions/GraphicOrderInteraction',\r\n        'hotspotChoice' : 'taoQtiItem/qtiCreator/model/choices/HotspotChoice',\r\n        'gapImg' : 'taoQtiItem/qtiCreator/model/choices/GapImg',\r\n        'associableHotspot' : 'taoQtiItem/qtiCreator/model/choices/AssociableHotspot',\r\n        'gapMatchInteraction' : 'taoQtiItem/qtiCreator/model/interactions/GapMatchInteraction',\r\n        'hottextInteraction' : 'taoQtiItem/qtiCreator/model/interactions/HottextInteraction',\r\n        'hottext' : 'taoQtiItem/qtiCreator/model/choices/Hottext',\r\n        'gapText' : 'taoQtiItem/qtiCreator/model/choices/GapText',\r\n        'gap' : 'taoQtiItem/qtiCreator/model/choices/Gap',\r\n        'responseDeclaration' : 'taoQtiItem/qtiCreator/model/variables/ResponseDeclaration',\r\n        'responseProcessing' : 'taoQtiItem/qtiCreator/model/ResponseProcessing',\r\n        'customInteraction' : 'taoQtiItem/qtiCreator/model/interactions/PortableCustomInteraction',\r\n        'endAttemptInteraction' : 'taoQtiItem/qtiCreator/model/interactions/EndAttemptInteraction',\r\n        'infoControl' : 'taoQtiItem/qtiCreator/model/PortableInfoControl',\r\n        'include' : 'taoQtiItem/qtiCreator/model/Include'\r\n    }, qtiClasses);\r\n\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/helper/container',['jquery', 'lodash', 'taoQtiItem/qtiCreator/model/qtiClasses'], function($, _, qtiClasses){\r\n    \"use strict\";\r\n    var methods = {\r\n        createElements : function(container, body, callback){\r\n\r\n            var regex = /{{([a-z_]+)\\.?([a-z_]*):new}}/ig;\r\n\r\n            //first pass to get required qti classes, but do not replace\r\n            var required = {};\r\n            body.replace(regex,\r\n                function(original, qtiClass, subClass){\r\n                    if(qtiClasses[qtiClass]){\r\n                        required[qtiClass] = qtiClasses[qtiClass];\r\n                    }else{\r\n                        throw 'missing required class : ' + qtiClass;\r\n                    }\r\n                });\r\n                \r\n            //second pass after requiring classes:\r\n            require(_.values(required), function(){\r\n\r\n                //register and name all loaded classes:\r\n                var Qti = _.reduce([].slice.call(arguments), function (acc, qtiClassElt) {\r\n                    acc[qtiClassElt.prototype.qtiClass] = qtiClassElt;\r\n\r\n                    return acc;\r\n                }, {});\r\n                \r\n                //create new elements\r\n                var newElts = {};\r\n                var newBody = body.replace(regex,\r\n                    function(original, qtiClass, subClass){\r\n                        if(Qti[qtiClass]){\r\n                            //create new element\r\n                            var elt = new Qti[qtiClass]();\r\n                            if(container.getRenderer()){\r\n                                elt.setRenderer(container.getRenderer());\r\n                            }\r\n                            newElts[elt.getSerial()] = elt;\r\n\r\n                            //manage sub-classed qtiClass\r\n                            if(subClass){\r\n                                //@todo generalize it from customInteraction\r\n                                elt.typeIdentifier = subClass;\r\n                            }\r\n\r\n                            return elt.placeholder();\r\n                        }else{\r\n                            return original;\r\n                        }\r\n                    });\r\n\r\n                //insert them:\r\n                container.setElements(newElts, newBody);\r\n                \r\n                //operations after insertions:\r\n                var $doc = $(document);\r\n                _.each(newElts, function(elt){\r\n                    if(_.isFunction(elt.buildIdentifier)){\r\n                        elt.buildIdentifier();\r\n                    }\r\n                    if(_.isFunction(elt.afterCreate)){\r\n                        elt.afterCreate();\r\n                    }\r\n                    $doc.trigger('elementCreated.qti-widget', {parent : container.parent(), element : elt});\r\n                });\r\n\r\n                if(typeof(callback) === 'function'){\r\n                    callback.call(container, newElts);\r\n                }\r\n            });\r\n\r\n        }\r\n    };\r\n\r\n    return methods;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/mixin/editableContainer',['taoQtiItem/qtiCreator/model/helper/container'], function(containerHelper){\r\n    \"use strict\";\r\n    var methods = {\r\n        createElements : function(body, callback){\r\n            \r\n            var _this = this;\r\n            containerHelper.createElements(_this.getBody(), body, function(newElts){\r\n                callback.call(_this, newElts);\r\n            });\r\n\r\n        }\r\n    };\r\n\r\n    return methods;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\n\r\n/**\r\n * IdentifiedElement model\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiItem/core/IdentifiedElement',[\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/helper/util'\r\n], function(Element, util){\r\n    'use strict';\r\n\r\n    /**\r\n     * IdentifiedElement model\r\n     */\r\n    var IdentifiedElement = Element.extend({\r\n\r\n        /**\r\n         * Generates and assign an identifier\r\n         * @param {String} prefix - identifier prefix\r\n         * @param {Boolean} [useSuffix = true] - add a \"_ + index\" to the identifier\r\n         * @returns {Object} for chaining\r\n         */\r\n        buildIdentifier : function buildIdentifier(prefix, useSuffix){\r\n            var item = this.getRelatedItem();\r\n            var id = util.buildIdentifier(item, prefix || this.qtiClass, useSuffix);\r\n            if(id){\r\n                this.attr('identifier', id);\r\n            }\r\n            return this;\r\n        },\r\n\r\n        /**\r\n         * Get/set and identifier. It will be generated if it doesn't exists.\r\n         * @param {String} [value] - set the value or get it if not set.\r\n         * @returns {String} the identifier\r\n         */\r\n        id : function id(value){\r\n            if(!value && !this.attr('identifier')){\r\n                this.buildIdentifier(this.qtiClass, true);\r\n            }\r\n            return this.attr('identifier', value);\r\n        }\r\n    });\r\n\r\n    /**\r\n     * @exports taoQtiItem/qtiItem/core/IdentifiableElement\r\n     */\r\n    return IdentifiedElement;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiItem/mixin/Mixin',[],function(){\r\n    \r\n    //@todo : need refactoring of qti item mixin with lodash.mixin()\r\n    return {\r\n        augment : function(targetClass, methods, options){\r\n            if(typeof(targetClass) === 'function' && typeof(methods) === 'object'){\r\n                for(var methodName in methods){\r\n                    if(!Object.hasOwnProperty(targetClass.prototype, methodName)){\r\n                        targetClass.prototype[methodName] = methods[methodName];\r\n                    }else{\r\n                        if(options && options.append){\r\n                            var _parent = targetClass.prototype[methodName];\r\n                            targetClass.prototype[methodName] = function(){\r\n                                methods[methodName].apply(this, arguments);\r\n                                return _parent.apply(this, arguments);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiItem/core/Container',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function($, _, Element, rendererConfig){\r\n    'use strict';\r\n\r\n    var Container = Element.extend({\r\n        qtiClass : '_container',\r\n        init : function(body){\r\n            this._super();//generate serial, attributes array always empty\r\n            if(body && typeof body !== 'string'){\r\n                throw 'the body of a container must be a string';\r\n            }\r\n            this.bdy = body || '';\r\n            this.elements = {};\r\n        },\r\n        body : function(body){\r\n            if(typeof body === 'undefined'){\r\n                return this.bdy;\r\n            }else{\r\n                if(typeof body === 'string'){\r\n                    this.bdy = body;\r\n                    $(document).trigger('containerBodyChange', {\r\n                        body : body,\r\n                        container : this\r\n                    });\r\n                }else{\r\n                    throw 'body must be a string';\r\n                }\r\n            }\r\n        },\r\n        setElements : function(elements, body){\r\n            var returnValue = false;\r\n\r\n            for(var i in elements){\r\n                var elt = elements[i];\r\n                if(elt instanceof Element){\r\n\r\n                    body = body || this.bdy;\r\n                    if(body.indexOf(elt.placeholder()) === -1){\r\n                        body += elt.placeholder();//append the element if no placeholder found\r\n                    }\r\n\r\n                    elt.setRelatedItem(this.getRelatedItem() || null);\r\n                    this.elements[elt.getSerial()] = elt;\r\n                    $(document).trigger('containerElementAdded', {\r\n                        element : elt,\r\n                        container : this\r\n                    });\r\n\r\n                    returnValue = true;\r\n                }else{\r\n                    returnValue = false;\r\n                    throw 'expected a qti element';\r\n                }\r\n            }\r\n\r\n            this.body(body);\r\n\r\n            return returnValue;\r\n        },\r\n        setElement : function(element, body){\r\n            return this.setElements([element], body);\r\n        },\r\n        removeElement : function(element){\r\n            var serial = '';\r\n            if(typeof(element) === 'string'){\r\n                serial = element;\r\n            }else if(element instanceof Element){\r\n                serial = element.getSerial();\r\n            }\r\n            delete this.elements[serial];\r\n            this.body(this.body().replace('{{' + serial + '}}', ''));\r\n            return this;\r\n        },\r\n        getElements : function(qtiClass){\r\n            var elts = {};\r\n            if(typeof(qtiClass) === 'string'){\r\n                for(var serial in this.elements){\r\n                    if(Element.isA(this.elements[serial], qtiClass)){\r\n                        elts[serial] = this.elements[serial];\r\n                    }\r\n                }\r\n            }else{\r\n                elts = _.clone(this.elements);\r\n            }\r\n            return elts;\r\n        },\r\n        getElement : function(serial){\r\n            return this.elements[serial] ? this.elements[serial] : null;\r\n        },\r\n        getComposingElements : function(){\r\n            var elements = this.getElements();\r\n            var elts = {};\r\n            for(var serial in elements){\r\n                elts[serial] = elements[serial];//pass individual object by ref, instead of the whole list(object)\r\n                elts = _.extend(elts, elements[serial].getComposingElements());\r\n            }\r\n            return elts;\r\n        },\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                elementsData = [],\r\n                tpl = this.body();\r\n\r\n            for(var serial in this.elements){\r\n                var elt = this.elements[serial];\r\n                if(typeof elt.render === 'function'){\r\n                    if(elt.qtiClass === '_container'){\r\n                        //@todo : container rendering merging, to be tested\r\n                        tpl = tpl.replace(elt.placeholder(), elt.render(renderer));\r\n                    }else{\r\n                        tpl = tpl.replace(elt.placeholder(), '{{{' + serial + '}}}');\r\n                        elementsData[serial] = elt.render(renderer);\r\n                    }\r\n                }else{\r\n                    throw 'render() is not defined for the qti element: ' + serial;\r\n                }\r\n            }\r\n\r\n            if(renderer.isRenderer){\r\n                return this._super({\r\n                    body : renderer.renderDirect(tpl, elementsData),\r\n                    contentModel : this.contentModel || 'flow'\r\n                }, renderer, args.placeholder);\r\n            }else{\r\n                throw 'invalid qti renderer for qti container';\r\n            }\r\n        },\r\n        postRender : function(data, altClassName, renderer){\r\n            renderer = renderer || this.getRenderer();\r\n\r\n            var res = _(this.elements)\r\n                .filter( function(elt){\r\n                    return typeof elt.postRender === 'function';\r\n                })\r\n                .map(function(elt){\r\n                    return elt.postRender(data, '', renderer);\r\n                })\r\n                .flatten(true)\r\n                .value()\r\n                .concat(this._super(data, altClassName, renderer));\r\n            return res;\r\n        },\r\n        toArray : function(){\r\n            var arr = {\r\n                serial : this.serial,\r\n                body : this.bdy,\r\n                elements : {}\r\n            };\r\n\r\n            for(var serial in this.elements){\r\n                arr.elements[serial] = this.elements[serial].toArray();\r\n            }\r\n\r\n            return arr;\r\n        },\r\n        find : function(serial, parent){\r\n\r\n            var found = null;\r\n\r\n            if(this.elements[serial]){\r\n\r\n                found = {parent : parent || this, element : this.elements[serial], location : 'body'};\r\n\r\n            }else{\r\n\r\n                _.each(this.elements, function(elt){\r\n\r\n                    found = elt.find(serial);\r\n                    if(found){\r\n                        return false;//break loop\r\n                    }\r\n                });\r\n            }\r\n\r\n            return found;\r\n        },\r\n        isEmpty : function(){\r\n            return !this.bdy;\r\n        }\r\n    });\r\n\r\n    return Container;\r\n});\r\n\n","define('taoQtiItem/qtiItem/mixin/Container',['taoQtiItem/qtiItem/mixin/Mixin', 'taoQtiItem/qtiItem/core/Container'], function(Mixin, Container){\r\n\r\n    var methods = {\r\n        initContainer : function(body){\r\n            this.bdy = new Container(body || '');\r\n            this.bdy.setRelatedItem(this.getRelatedItem() || null);\r\n            this.bdy.contentModel = 'blockStatic';\r\n        },\r\n        getBody : function(){\r\n            return this.bdy;\r\n        },\r\n        body : function(body){\r\n            var ret = this.bdy.body(body);\r\n            return (body) ? this : ret;//for method chaining on get\r\n        },\r\n        setElement : function(element, body){\r\n            this.bdy.setElement(element, body);\r\n            return this;\r\n        },\r\n        removeElement : function(element){\r\n            return this.bdy.removeElement(element);\r\n        },\r\n        getElements : function(qtiClass){\r\n            return this.bdy.getElements(qtiClass);\r\n        },\r\n        getElement : function(serial){\r\n            return this.bdy.getElement(serial);\r\n        }\r\n    };\r\n\r\n    return {\r\n        augment : function(targetClass){\r\n            Mixin.augment(targetClass, methods);\r\n        },\r\n        methods : methods\r\n    };\r\n});\n","define('taoQtiItem/qtiItem/mixin/ContainerItemBody',['taoQtiItem/qtiItem/mixin/Mixin', 'taoQtiItem/qtiItem/mixin/Container', 'lodash'], function(Mixin, Container, _){\r\n    \r\n    var methods = {};\r\n    _.extend(methods, Container.methods);\r\n    _.extend(methods, {\r\n        initContainer:function(body){\r\n            Container.methods.initContainer.call(this, body);\r\n            this.bdy.contentModel = 'itemBody';\r\n        }\r\n    });\r\n\r\n    return {\r\n        augment : function(targetClass){\r\n            Mixin.augment(targetClass, methods);\r\n        },\r\n        methods : methods\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * QTI Item Element model\r\n *\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiItem/core/Item',[\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/core/IdentifiedElement',\r\n    'taoQtiItem/qtiItem/mixin/ContainerItemBody',\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiItem/helper/util'\r\n], function(Element, IdentifiedElement, Container, _, $, util){\r\n    'use strict';\r\n\r\n    var Item = IdentifiedElement.extend({\r\n        qtiClass : 'assessmentItem',\r\n        init : function init(serial, attributes){\r\n            this._super(serial, attributes);\r\n            this.relatedItem = this;\r\n            this.stylesheets = {};\r\n            this.responses = {};\r\n            this.outcomes = {};\r\n            this.modalFeedbacks = {};\r\n            this.namespaces = {};\r\n            this.schemaLocations = {};\r\n            this.responseProcessing = null;\r\n            this.apipAccessibility = null;\r\n        },\r\n        getInteractions : function getInteractions(){\r\n            var interactions = [];\r\n            var elts = this.getComposingElements();\r\n            for(var serial in elts){\r\n                if(Element.isA(elts[serial], 'interaction')){\r\n                    interactions.push(elts[serial]);\r\n                }\r\n            }\r\n            return interactions;\r\n        },\r\n        addResponseDeclaration : function addResponseDeclaration(response){\r\n            if(Element.isA(response, 'responseDeclaration')){\r\n                response.setRelatedItem(this);\r\n                this.responses[response.getSerial()] = response;\r\n            }else{\r\n                throw 'is not a qti response declaration';\r\n            }\r\n            return this;\r\n        },\r\n        getResponseDeclaration : function getResponseDeclaration(identifier){\r\n            for(var i in this.responses){\r\n                if(this.responses[i].attr('identifier') === identifier){\r\n                    return this.responses[i];\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        addOutcomeDeclaration : function addOutcomeDeclaration(outcome){\r\n            if(Element.isA(outcome, 'outcomeDeclaration')){\r\n                outcome.setRelatedItem(this);\r\n                this.outcomes[outcome.getSerial()] = outcome;\r\n            }else{\r\n                throw 'is not a qti outcome declaration';\r\n            }\r\n            return this;\r\n        },\r\n        getOutcomeDeclaration : function getOutcomeDeclaration(identifier){\r\n            var found;\r\n            _.forEach(this.outcomes, function (outcome) {\r\n                if (outcome.id() === identifier) {\r\n                    found = outcome;\r\n                    return false;\r\n                }\r\n            });\r\n            return found;\r\n        },\r\n        getOutcomes : function getOutcomes(){\r\n            return _.clone(this.outcomes);\r\n        },\r\n        removeOutcome : function removeOutcome(identifier){\r\n            var outcome = this.getOutcomeDeclaration(identifier);\r\n            if(outcome){\r\n                this.outcomes = _.omit(this.outcomes, outcome.getSerial());\r\n            }\r\n        },\r\n        addModalFeedback : function addModalFeedback(feedback){\r\n            if(Element.isA(feedback, 'modalFeedback')){\r\n                feedback.setRelatedItem(this);\r\n                this.modalFeedbacks[feedback.getSerial()] = feedback;\r\n            }else{\r\n                throw 'is not a qti modal feedback';\r\n            }\r\n            return this;\r\n        },\r\n        getComposingElements : function getComposingElements(){\r\n            var elts = this._super(), _this = this;\r\n            _.forEach(['responses', 'outcomes', 'modalFeedbacks', 'stylesheets'], function(elementCollection){\r\n                for(var i in _this[elementCollection]){\r\n                    var elt = _this[elementCollection][i];\r\n                    elts[i] = elt;\r\n                    elts = _.extend(elts, elt.getComposingElements());\r\n                }\r\n            });\r\n            if(this.responseProcessing instanceof Element){\r\n                elts[this.responseProcessing.getSerial()] = this.responseProcessing;\r\n            }\r\n            return elts;\r\n        },\r\n        find : function find(serial){\r\n\r\n            var found = this._super(serial);\r\n\r\n            if(!found){\r\n                found = util.findInCollection(this, ['responses', 'outcomes', 'modalFeedbacks', 'stylesheets'], serial);\r\n            }\r\n\r\n            return found;\r\n        },\r\n        getResponses : function getResponses(){\r\n            return _.clone(this.responses);\r\n        },\r\n        getRelatedItem : function getRelatedItem(){\r\n            return this;\r\n        },\r\n        addNamespace : function addNamespace(name, uri){\r\n            this.namespaces[name] = uri;\r\n        },\r\n        setNamespaces : function setNamespaces(namespaces){\r\n            this.namespaces = namespaces;\r\n        },\r\n        getNamespaces : function getNamespaces(){\r\n            return _.clone(this.namespaces);\r\n        },\r\n        setSchemaLocations : function setSchemaLocations(locations){\r\n            this.schemaLocations = locations;\r\n        },\r\n        getSchemaLocations : function getSchemaLocations(){\r\n            return _.clone(this.schemaLocations);\r\n        },\r\n        setApipAccessibility : function setApipAccessibility(apip){\r\n            this.apipAccessibility = apip || null;\r\n        },\r\n        getApipAccessibility : function getApipAccessibility(){\r\n            return this.apipAccessibility;\r\n        },\r\n        addStylesheet : function addStylesheet(stylesheet){\r\n            if(Element.isA(stylesheet, 'stylesheet')){\r\n                stylesheet.setRelatedItem(this);\r\n                this.stylesheets[stylesheet.getSerial()] = stylesheet;\r\n            }else{\r\n                throw 'is not a qti stylesheet declaration';\r\n            }\r\n            return this;\r\n        },\r\n        removeStyleSheet : function removeStyleSheet(stylesheet){\r\n            delete this.stylesheets[stylesheet.getSerial()];\r\n            return this;\r\n        },\r\n        stylesheetExists : function stylesheetExists(href){\r\n            var exists = false;\r\n            _.forEach(this.stylesheets, function(stylesheet){\r\n                if(stylesheet.attr('href') === href){\r\n                    exists = true;\r\n                    return false;//break each loop\r\n                }\r\n            });\r\n            return exists;\r\n        },\r\n        setResponseProcessing : function setResponseProcessing(rp){\r\n            if(Element.isA(rp, 'responseProcessing')){\r\n                rp.setRelatedItem(this);\r\n                this.responseProcessing = rp;\r\n            }else{\r\n                throw 'is not a response processing';\r\n            }\r\n            return this;\r\n        },\r\n        toArray : function toArray(){\r\n            var arr = this._super();\r\n            var toArray = function(elt){\r\n                return elt.toArray();\r\n            };\r\n            arr.namespaces = this.namespaces;\r\n\t\t\tarr.schemaLocations = this.schemaLocations;\r\n            arr.outcomes = _.map(this.outcomes, toArray);\r\n            arr.responses = _.map(this.responses, toArray);\r\n            arr.stylesheets = _.map(this.stylesheets, toArray);\r\n            arr.modalFeedbacks = _.map(this.modalFeedbacks, toArray);\r\n            arr.responseProcessing = this.responseProcessing.toArray();\r\n            return arr;\r\n        },\r\n        isEmpty : function isEmpty(){\r\n\r\n            var body = this.body().trim();\r\n\r\n            if(body){\r\n\r\n                //hack to fix #2652\r\n                var $dummy = $('<div>').html(body),\r\n                    $children = $dummy.children();\r\n\r\n                if($children.length === 1 && $children.hasClass('empty')){\r\n                    return true;\r\n                }else{\r\n                    return false;\r\n                }\r\n            }else{\r\n                return true;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Clean up an item rendering.\r\n         * Ask the renderer to run destroy if exists.\r\n         */\r\n        clear : function clear(){\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                if(_.isFunction(renderer.destroy)){\r\n                    renderer.destroy(this);\r\n                }\r\n            }\r\n        },\r\n    });\r\n\r\n    Container.augment(Item);\r\n\r\n    return Item;\r\n});\r\n\n","define('taoQtiItem/qtiItem/core/Stylesheet',['taoQtiItem/qtiItem/core/Element', 'lodash', 'taoQtiItem/qtiItem/helper/rendererConfig'], function(Element, _, rendererConfig){\r\n\r\n    var Stylesheet = Element.extend({\r\n        qtiClass : 'stylesheet',\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {};\r\n\r\n            defaultData.attributes = {href : renderer.resolveUrl(this.attr('href'))};\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        }\r\n    });\r\n\r\n    return Stylesheet;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/Stylesheet',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/Stylesheet'\r\n], function(_, editable, Stylesheet){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                href : 'css/tao-user-styles.css',\r\n                title : '',\r\n                type:'text/css',\r\n                media:'all'\r\n            };\r\n        }\r\n    });\r\n\r\n    return Stylesheet.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/core/ResponseProcessing',['taoQtiItem/qtiItem/core/Element', 'lodash'], function(Element, _){\r\n    \r\n    var ResponseProcessing = Element.extend({\r\n        qtiClass : 'responseProcessing',\r\n        processingType : '',\r\n        xml : '',\r\n        toArray : function(){\r\n            var arr = this._super();\r\n            arr.processingType = this.processingType;\r\n            arr.xml = this.xml;\r\n            return arr;\r\n        }\r\n    });\r\n    \r\n    return ResponseProcessing;\r\n});\n","define('taoQtiItem/qtiCreator/model/ResponseProcessing',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/ResponseProcessing'\r\n], function(_, editable, ResponseProcessing){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {};\r\n        },\r\n        setProcessingType : function(processingType){\r\n        \r\n            if(this.processingType !== processingType){\r\n                \r\n                if(this.processingType === 'custom'){\r\n\r\n                    //change all response template to default : \"correct\"\r\n                    _.each(this.getRelatedItem().getResponses(), function(r){\r\n                         r.setTemplate('MATCH_CORRECT');\r\n                    });\r\n                }\r\n                \r\n                this.processingType = processingType;\r\n            }\r\n\r\n        }\r\n    });\r\n\r\n    return ResponseProcessing.extend(methods);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/variables/VariableDeclaration',['taoQtiItem/qtiItem/core/IdentifiedElement'], function(IdentifiedElement){\r\n    'use strict';\r\n    /**\r\n     * It is the top abstract class for all variable classes\r\n     * (so not renderable and qtiClass undefined)\r\n     */\r\n    var VariableDeclaration = IdentifiedElement.extend({\r\n        init : function init(serial, attributes){\r\n            this._super(serial, attributes);\r\n            this.defaultValue = null;\r\n        },\r\n        is : function is(qtiClass){\r\n            return (qtiClass === 'variableDeclaration') || this._super(qtiClass);\r\n        },\r\n        toArray : function toArray(){\r\n            var arr = this._super();\r\n            arr.defaultValue = this.defaultValue;\r\n            return arr;\r\n        },\r\n        setDefaultValue : function setDefaultValue(value){\r\n            this.defaultValue = value;\r\n        },\r\n        getDefaultValue : function getDefaultValue(){\r\n            return this.defaultValue;\r\n        },\r\n    });\r\n\r\n    return VariableDeclaration;\r\n});\n","define('taoQtiItem/qtiItem/core/variables/OutcomeDeclaration',['taoQtiItem/qtiItem/core/variables/VariableDeclaration'], function(VariableDeclaration){\r\n    return  VariableDeclaration.extend({\r\n        qtiClass : 'outcomeDeclaration'\r\n    });\r\n});\n","define('taoQtiItem/qtiCreator/model/variables/OutcomeDeclaration',['lodash', 'taoQtiItem/qtiCreator/model/mixin/editable', 'taoQtiItem/qtiItem/core/variables/OutcomeDeclaration'], function(_, editable, OutcomeDeclaration){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    return OutcomeDeclaration.extend(methods);\r\n});\r\n\n","define('taoQtiItem/qtiItem/core/feedbacks/ModalFeedback',['taoQtiItem/qtiItem/core/IdentifiedElement', 'taoQtiItem/qtiItem/mixin/Container'], function(IdentifiedElement, Container){\r\n    \r\n    var ModalFeedback = IdentifiedElement.extend({\r\n        'qtiClass' : 'modalFeedback',\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'feedback') || this._super(qtiClass);\r\n        }\r\n    });\r\n    \r\n    Container.augment(ModalFeedback);\r\n    \r\n    return ModalFeedback;\r\n});\n","define('taoQtiItem/qtiCreator/model/feedbacks/ModalFeedback',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/feedbacks/ModalFeedback'\r\n], function(_,editable,ModalFeedback){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                title : 'modal feedback title',\r\n                showHide : 'show'\r\n            };\r\n        }\r\n    });\r\n    \r\n    return ModalFeedback.extend(methods);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/Item',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableContainer',\r\n    'taoQtiItem/qtiItem/core/Item',\r\n    'taoQtiItem/qtiCreator/model/Stylesheet',\r\n    'taoQtiItem/qtiCreator/model/ResponseProcessing',\r\n    'taoQtiItem/qtiCreator/model/variables/OutcomeDeclaration',\r\n    'taoQtiItem/qtiCreator/model/feedbacks/ModalFeedback'\r\n], function(_, editable, editableContainer, Item, Stylesheet, ResponseProcessing, OutcomeDeclaration, ModalFeedback){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableContainer);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                identifier : 'myItem_1',\r\n                title : 'Item title',\r\n                adaptive : false,\r\n                timeDependent : false\r\n            };\r\n        },\r\n        createResponseProcessing : function(){\r\n            var rp = new ResponseProcessing();\r\n            rp.processingType = 'templateDriven';\r\n            this.setResponseProcessing(rp);\r\n            return rp;\r\n        },\r\n        createStyleSheet : function(href){\r\n            if(href && _.isString(href)){\r\n                var stylesheet = new Stylesheet({href : href});\r\n                stylesheet.setRenderer(this.getRenderer());\r\n                this.addStylesheet(stylesheet);\r\n                return stylesheet;\r\n            }else{\r\n                throw 'missing or invalid type for the required arg \"href\"';\r\n                return null;\r\n            }\r\n        },\r\n        createOutcomeDeclaration : function(attributes){\r\n\r\n            var identifier = attributes.identifier || '';\r\n            delete attributes.identifier;\r\n            var outcome = new OutcomeDeclaration(attributes);\r\n\r\n            this.addOutcomeDeclaration(outcome);\r\n            outcome.buildIdentifier(identifier);\r\n\r\n            return outcome;\r\n        },\r\n        getOutcomeDeclaration : function getOutcomeDeclaration(identifier){\r\n            var found;\r\n            _.forEach(this.outcomes, function (outcome) {\r\n                if (outcome.id() === identifier) {\r\n                    found = outcome;\r\n                    return false;\r\n                }\r\n            });\r\n            return found;\r\n        },\r\n        removeOutcome : function removeOutcome(identifier){\r\n            var outcome = this.getOutcomeDeclaration(identifier);\r\n            if(outcome){\r\n                this.outcomes = _.omit(this.outcomes, outcome.getSerial());\r\n            }\r\n        },\r\n        createModalFeedback : function(attributes, response){\r\n\r\n            var identifier = attributes.identifier || '';\r\n            delete attributes.identifier;\r\n            var modalFeedback = new ModalFeedback(attributes);\r\n\r\n            this.addModalFeedback(modalFeedback);\r\n            modalFeedback.buildIdentifier(identifier);\r\n            modalFeedback.body('Some feedback text.');\r\n            if(response && response.qtiClass === 'responseDeclaration'){\r\n                modalFeedback.data('relatedResponse', response);\r\n            }\r\n        \r\n            return modalFeedback;\r\n        },\r\n        deleteResponseDeclaration : function(response){\r\n            var self = this;\r\n            var serial;\r\n            if(_.isString(response)){\r\n                serial = response;\r\n            }else if(response && response.qtiClass === 'responseDeclaration'){\r\n                serial = response.getSerial();\r\n            }\r\n            if(this.responses[serial]){\r\n                //remove feedback rules:\r\n                _.each(this.responses[serial].feedbackRules, function(rule){\r\n                    var feedbacks = [];\r\n                    if(rule.feedbackThen && rule.feedbackThen.is('modalFeedback')){\r\n                        feedbacks.push(rule.feedbackThen.serial);  \r\n                    }\r\n                    if(rule.feedbackElse && rule.feedbackElse.is('modalFeedback')){\r\n                        feedbacks.push(rule.feedbackElse.serial);\r\n                    }\r\n                    self.modalFeedbacks = _.omit(self.modalFeedbacks, feedbacks);\r\n                    \r\n                    if(rule.feedbackOutcome && rule.feedbackOutcome.is('outcomeDeclaration')){\r\n                        self.outcomes = _.omit(self.outcomes, rule.feedbackOutcome.serial);\r\n                    }\r\n                });\r\n                this.responses = _.omit(this.responses, serial);\r\n            }\r\n            return this;\r\n        }\r\n    });\r\n    return Item.extend(methods);\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/itemLoader',[\r\n    'jquery',\r\n    'taoQtiItem/qtiItem/core/Loader',\r\n    'taoQtiItem/qtiCreator/model/Item',\r\n    'taoQtiItem/qtiCreator/model/qtiClasses'\r\n], function($, Loader, Item, qtiClasses){\r\n    \"use strict\";\r\n    var _generateIdentifier = function _generateIdentifier(uri){\r\n        var pos = uri.lastIndexOf('#');\r\n        return uri.substr(pos + 1);\r\n    };\r\n\r\n    var qtiNamespace = 'http://www.imsglobal.org/xsd/imsqti_v2p2';\r\n\r\n    var qtiSchemaLocation = {\r\n        'http://www.imsglobal.org/xsd/imsqti_v2p2' : 'http://www.imsglobal.org/xsd/qti/qtiv2p2/imsqti_v2p2.xsd'\r\n    };\r\n\r\n    var creatorLoader = {\r\n        loadItem : function loadItem(config, callback){\r\n\r\n            if(config.uri){\r\n                $.ajax({\r\n                    url : config.itemDataUrl,\r\n                    dataType : 'json',\r\n                    data : {\r\n                        uri : config.uri\r\n                    }\r\n                }).done(function(data){\r\n                    var loader, itemData, newItem;\r\n\r\n                    if(data.itemData && data.itemData.qtiClass === 'assessmentItem'){\r\n\r\n                        loader = new Loader().setClassesLocation(qtiClasses);\r\n                        itemData = data.itemData;\r\n\r\n                        loader.loadItemData(itemData, function(loadedItem){\r\n                            var namespaces;\r\n\r\n                            //hack to fix #2652\r\n                            if(loadedItem.isEmpty()){\r\n                                loadedItem.body('');\r\n                            }\r\n\r\n                            // convert item to current QTI version\r\n                            namespaces = loadedItem.getNamespaces();\r\n                            namespaces[''] = qtiNamespace;\r\n                            loadedItem.setNamespaces(namespaces);\r\n                            loadedItem.setSchemaLocations(qtiSchemaLocation);\r\n\r\n                            callback(loadedItem, this.getLoadedClasses());\r\n                        });\r\n                    }else{\r\n\r\n                        newItem = new Item().id(_generateIdentifier(config.uri)).attr('title', config.label);\r\n\r\n                        newItem.createResponseProcessing();\r\n\r\n                        //set default namespaces\r\n                        newItem.setNamespaces({\r\n                            '' : qtiNamespace,\r\n                            'xsi' : 'http://www.w3.org/2001/XMLSchema-instance',\r\n                            'm' :'http://www.w3.org/1998/Math/MathML'\r\n                        });//note : always add math element : since it has become difficult to know when a math element has been added to the item\r\n\r\n                        //set default schema location\r\n                        newItem.setSchemaLocations(qtiSchemaLocation);\r\n\r\n                        //tag the item as a new one\r\n                        newItem.data('new', true);\r\n\r\n                        callback(newItem);\r\n                    }\r\n\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    return creatorLoader;\r\n});\r\n\n","/**\r\n * Common helper functions\r\n */\r\ndefine('taoQtiItem/qtiItem/helper/interactionHelper',['lodash', 'taoQtiItem/qtiItem/core/Element'], function(_, Element){\r\n    return {\r\n        convertChoices : function(choices, outputType){\r\n\r\n            var ret = [], _this = this;\r\n\r\n            _.each(choices, function(c){\r\n                if(Element.isA(c, 'choice')){\r\n                    switch(outputType){\r\n                        case 'serial':\r\n                            ret.push(c.getSerial());\r\n                            break;\r\n                        case 'identifier':\r\n                            ret.push(c.id());\r\n                            break;\r\n                        default:\r\n                            ret.push(c);\r\n                    }\r\n\r\n                }else if(_.isArray(c)){\r\n                    ret.push(_this.convertChoices(c, outputType));\r\n                }\r\n            });\r\n\r\n            return ret;\r\n        },\r\n        findChoices : function(interaction, choices, inputType){\r\n\r\n            var ret = [], _this = this;\r\n\r\n            _.each(choices, function(c){\r\n                var choice;\r\n                if(_.isString(c)){\r\n                    if(inputType === 'serial'){\r\n                        choice = interaction.getChoice(c);\r\n                        if(choice){\r\n                            ret.push(choice);\r\n                        }\r\n                    }else if(inputType === 'identifier'){\r\n                        choice = interaction.getChoiceByIdentifier(c);\r\n                        if(choice){\r\n                            ret.push(choice);\r\n                        }\r\n                    }else{\r\n                        ret.push(c);\r\n                    }\r\n                }else if(_.isArray(c)){\r\n                    ret.push(_this.findChoices(interaction, c, inputType));\r\n                }else{\r\n                    ret.push(c);\r\n                }\r\n            });\r\n\r\n            return ret;\r\n        },\r\n        shuffleChoices : function(choices){\r\n            var r = [], //returned array\r\n                f = {}, //fixed choices array\r\n                j = 0;\r\n\r\n            for(var i in choices){\r\n                if(Element.isA(choices[i], 'choice')){\r\n                    var choice = choices[i];\r\n                    if(choice.attr('fixed')){\r\n                        f[j] = choice;\r\n                    }\r\n                    r.push(choice);\r\n                    j++;\r\n                }else{\r\n                    throw 'invalid element in array: is not a qti choice';\r\n                }\r\n            }\r\n\r\n            for(var n = 0; n < r.length - 1; n++){\r\n                if(f[n]){\r\n                    continue;\r\n                }\r\n                var k = -1;\r\n                do{\r\n                    k = n + Math.floor(Math.random() * (r.length - n));\r\n                }while(f[k]);\r\n                var tmp = r[k];\r\n                r[k] = r[n];\r\n                r[n] = tmp;\r\n            }\r\n\r\n            return r;\r\n        },\r\n        serialToIdentifier : function(interaction, choiceSerial){\r\n            var choice = interaction.getChoice(choiceSerial);\r\n            if(choice){\r\n                return choice.id();\r\n            }else{\r\n                return '';\r\n            }\r\n        }\r\n    }\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * A factory to create a QTI renderer.\r\n *\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiRunner/core/Renderer',[\r\n    'lodash',\r\n    'jquery',\r\n    'handlebars',\r\n    'core/promise',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/helper/interactionHelper',\r\n    'ui/themeLoader'\r\n], function(_, $, Handlebars, Promise, Element, interactionHelper, themeLoader){\r\n    'use strict';\r\n\r\n    var _isValidRenderer = function(renderer){\r\n\r\n        var valid = true;\r\n\r\n        if(typeof (renderer) !== 'object'){\r\n            return false;\r\n        }\r\n\r\n        var classCorrect = false;\r\n        if(renderer.qtiClass){\r\n            if(_.indexOf(_renderableClasses, renderer.qtiClass) >= 0){\r\n                classCorrect = true;\r\n            }else{\r\n                var pos = renderer.qtiClass.indexOf('.');\r\n                if(pos > 0){\r\n                    var qtiClass = renderer.qtiClass.slice(0, pos);\r\n                    var subClass = renderer.qtiClass.slice(pos + 1);\r\n                    if(_renderableSubclasses[qtiClass] && _.indexOf(_renderableSubclasses[qtiClass], subClass) >= 0){\r\n                        classCorrect = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if(!classCorrect){\r\n            valid = false;\r\n            throw new Error('invalid qti class name in renderer declaration : ' + renderer.qtiClass);\r\n        }\r\n\r\n        if(!renderer.template){\r\n            valid = false;\r\n            throw new Error('missing template in renderer declaration : ' + renderer.qtiClass);\r\n        }\r\n\r\n        return valid;\r\n    };\r\n\r\n    var _renderableClasses = [\r\n        '_container',\r\n        'assessmentItem',\r\n        'stylesheet',\r\n        'responseDeclaration',\r\n        'outcomeDeclaration',\r\n        'responseProcessing',\r\n        '_simpleFeedbackRule',\r\n        'img',\r\n        'math',\r\n        'object',\r\n        'table',\r\n        'modalFeedback',\r\n        'rubricBlock',\r\n        'associateInteraction',\r\n        'choiceInteraction',\r\n        'extendedTextInteraction',\r\n        'gapMatchInteraction',\r\n        'graphicAssociateInteraction',\r\n        'graphicGapMatchInteraction',\r\n        'graphicOrderInteraction',\r\n        'hotspotInteraction',\r\n        'hottextInteraction',\r\n        'inlineChoiceInteraction',\r\n        'matchInteraction',\r\n        'mediaInteraction',\r\n        'orderInteraction',\r\n        'selectPointInteraction',\r\n        'sliderInteraction',\r\n        'textEntryInteraction',\r\n        'uploadInteraction',\r\n        'endAttemptInteraction',\r\n        'customInteraction',\r\n        'prompt',\r\n        'associableHotspot',\r\n        'gap',\r\n        'gapImg',\r\n        'gapText',\r\n        'hotspotChoice',\r\n        'hottext',\r\n        'inlineChoice',\r\n        'simpleAssociableChoice',\r\n        'simpleChoice',\r\n        'infoControl',\r\n        'include'\r\n    ];\r\n\r\n    /**\r\n     * The list of qti element dependencies. It is used internally to load dependent qti classes\r\n     */\r\n    var _dependencies = {\r\n        assessmentItem : ['stylesheet', '_container', 'prompt', 'modalFeedback'],\r\n        rubricBlock : ['_container'],\r\n        associateInteraction : ['simpleAssociableChoice'],\r\n        choiceInteraction : ['simpleChoice'],\r\n        gapMatchInteraction : ['gap', 'gapText'],\r\n        graphicAssociateInteraction : ['associableHotspot'],\r\n        graphicGapMatchInteraction : ['associableHotspot', 'gapImg'],\r\n        graphicOrderInteraction : ['hotspotChoice'],\r\n        hotspotInteraction : ['hotspotChoice'],\r\n        hottextInteraction : ['hottext'],\r\n        inlineChoiceInteraction : ['inlineChoice'],\r\n        matchInteraction : ['simpleAssociableChoice'],\r\n        orderInteraction : ['simpleChoice']\r\n    };\r\n\r\n    /**\r\n     * The list of supported qti subclasses.\r\n     */\r\n    var _renderableSubclasses = {\r\n        'simpleAssociableChoice' : ['associateInteraction', 'matchInteraction'],\r\n        'simpleChoice' : ['choiceInteraction', 'orderInteraction']\r\n    };\r\n\r\n    /**\r\n     * List of the default properties for the item\r\n     */\r\n    var _defaults = {\r\n        shuffleChoices : true\r\n    };\r\n\r\n    /**\r\n     * Get the location of the document, useful to define a baseUrl for the required context\r\n     * @returns {String}\r\n     */\r\n    function getDocumentBaseUrl(){\r\n        return window.location.protocol + '//' + window.location.host + window.location.pathname.replace(/([^\\/]*)$/, '');\r\n    }\r\n\r\n    /**\r\n     * The built Renderer class\r\n     * @constructor\r\n     * @param {Object} [options] - the renderer options\r\n     * @param {AssetManager} [options.assetManager] - The renderer needs an AssetManager to resolve URLs (see {@link taoItems/assets/manager})\r\n     * @param {Boolean} [options.shuffleChoices = true] - Does the renderer take care of the shuffling\r\n     * @param {Object} [options.decorators] - to set up rendering decorator\r\n     * @param {preRenderDecorator} [options.decorators.before] - to set up a pre decorator\r\n     * @param {postRenderDecorator} [options.decorators.after] - to set up a post decorator\r\n     */\r\n    var Renderer = function(options){\r\n\r\n        /**\r\n         * Store the registered renderer location\r\n         */\r\n        var _locations = {};\r\n\r\n        /**\r\n         * Store loaded renderers\r\n         */\r\n        var _renderers = {};\r\n\r\n        options = _.defaults(options || {}, _defaults);\r\n\r\n        this.isRenderer = true;\r\n\r\n        this.name = '';\r\n\r\n        //store shuffled choice here\r\n        this.shuffledChoices = [];\r\n\r\n        /**\r\n         * Get the actual renderer of the give qti class or subclass:\r\n         * e.g. simplceChoice, simpleChoice.choiceInteraction, simpleChoice.orderInteraction\r\n         */\r\n        var _getClassRenderer = function(qtiClass){\r\n            var ret = null;\r\n            if(_renderers[qtiClass]){\r\n                ret = _renderers[qtiClass];\r\n            }else{\r\n                var pos = qtiClass.indexOf('.');\r\n                if(pos > 0){\r\n                    qtiClass = qtiClass.slice(0, pos);\r\n                    if(_renderers[qtiClass]){\r\n                        ret = _renderers[qtiClass];\r\n                    }\r\n                }\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        /**\r\n         * Registers a QTI renderer class\r\n         * @param {String} qtiClass\r\n         * @param {Array} list\r\n         * @returns {Boolean} `true` if the class has been successfully registered\r\n         */\r\n        function registerRendererClass(qtiClass, list) {\r\n            var success = false;\r\n            if (_locations[qtiClass] === false) {\r\n                //mark this class as not renderable\r\n                _renderers[qtiClass] = false;\r\n                success = true;\r\n            } else if (_locations[qtiClass]) {\r\n                list.push(_locations[qtiClass]);\r\n                success = true;\r\n            }\r\n            return success;\r\n        }\r\n\r\n        /**\r\n         * Set the renderer options\r\n         * @param {String} key - the name of the option\r\n         * @param {*} value - the option vallue\r\n         * @returns {Renderer} for chaining\r\n         */\r\n        this.setOption = function(key, value){\r\n            if(typeof (key) === 'string'){\r\n                options[key] = value;\r\n            }\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Set the renderer options\r\n         * @param {Object} opts - the options\r\n         * @returns {Renderer} for chaining\r\n         */\r\n        this.setOptions = function(opts){\r\n            options = _.extend(options, opts);\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Get the renderer option\r\n         * @param {String} key - the name of the option\r\n         * @returns {*|null} the option vallue\r\n         */\r\n        this.getOption = function(key){\r\n            if(typeof (key) === 'string' && options[key]){\r\n                return options[key];\r\n            }\r\n            return null;\r\n        };\r\n\r\n        this.getCustomMessage = function getCustomMessage(elementName, messageKey){\r\n            var messages = this.getOption('messages');\r\n            if(messages &&\r\n                elementName &&\r\n                messages[elementName] &&\r\n                _.isString(messages[elementName][messageKey])){\r\n                //currently not translatable but potentially could be if the need raises\r\n                return Handlebars.compile(messages[elementName][messageKey]);\r\n            }else{\r\n                return null;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Get the bound assetManager\r\n         * @returns {AssetManager} the assetManager\r\n         */\r\n        this.getAssetManager = function getAssetManager(){\r\n            return options.assetManager;\r\n        };\r\n\r\n        /**\r\n         * Get the bound theme loader\r\n         * @returns {Object} the themeLoader\r\n         */\r\n        this.getThemeLoader = function getThemeLoader(){\r\n            return this.themeLoader;\r\n        };\r\n\r\n\r\n        /**\r\n         * Renders the template\r\n         * @param {Object} element - the QTI model element\r\n         * @param {Object} data - the data to give to the template\r\n         * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\r\n         * @returns {String} the template results\r\n         * @throws {Error} if the renderer is not set or has no template bound\r\n         */\r\n        this.renderTpl = function(element, data, qtiSubclass){\r\n\r\n            var res;\r\n            var ret        = '';\r\n            var tplFound   = false;\r\n            var qtiClass   = qtiSubclass || element.qtiClass;\r\n            var renderer   = _getClassRenderer(qtiClass);\r\n            var decorators = this.getOption('decorators');\r\n\r\n            if(!renderer || !_.isFunction(renderer.template)){\r\n                throw new Error('no renderer template loaded under the class name : ' + qtiClass);\r\n            }\r\n\r\n            //pre rendering decoration\r\n            if(_.isObject(decorators) && _.isFunction(decorators.before)){\r\n\r\n                /**\r\n                 * @callback preRenderDecoractor\r\n                 * @param {Object} element - the QTI model element\r\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\r\n                 * @returns {String} the decorator result\r\n                 */\r\n                res = decorators.before(element, qtiSubclass);\r\n                if(_.isString(res)){\r\n                    ret += res;\r\n                }\r\n            }\r\n\r\n            //render the template\r\n            ret += renderer.template(data);\r\n\r\n\r\n            //post rendering decoration\r\n            if(_.isObject(decorators) && _.isFunction(decorators.after)){\r\n\r\n                /**\r\n                 * @callback postRenderDecoractor\r\n                 * @param {Object} element - the QTI model element\r\n                 * @param {String} [qtiSubclass] - to get the render of the element subclass (when element's qtiClass is abstract)\r\n                 * @returns {String} the decorator result\r\n                 */\r\n                res = decorators.after(element, qtiSubclass);\r\n                if(_.isString(res)){\r\n                    ret += res;\r\n                }\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.getData = function(element, data, qtiSubclass){\r\n\r\n            var ret = data,\r\n                qtiClass = qtiSubclass || element.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.getData) === 'function'){\r\n                    ret = renderer.getData.call(this, element, data);\r\n                }\r\n            }\r\n\r\n            return ret;\r\n        };\r\n\r\n        this.renderDirect = function(tpl, data){\r\n            return Handlebars.compile(tpl)(data);\r\n        };\r\n\r\n        this.getContainer = function(qtiElement, $scope, qtiSubclass){\r\n\r\n            var ret = null,\r\n                qtiClass = qtiSubclass || qtiElement.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                ret = renderer.getContainer(qtiElement, $scope);\r\n            }else{\r\n                throw 'no renderer found for the class : ' + qtiElement.qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.postRender = function(qtiElement, data, qtiSubclass){\r\n\r\n            var qtiClass = qtiSubclass || qtiElement.qtiClass;\r\n            var renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer && typeof (renderer.render) === 'function') {\r\n                return renderer.render.call(this, qtiElement, data);\r\n            }\r\n        };\r\n\r\n        this.setResponse = function(qtiInteraction, response, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.setResponse) === 'function'){\r\n                    ret = renderer.setResponse.call(this, qtiInteraction, response);\r\n                    var $container = renderer.getContainer.call(this, qtiInteraction);\r\n                    if($container instanceof $ && $container.length){\r\n                        $container.trigger('responseSet', [qtiInteraction, response]);\r\n                    }\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.getResponse = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.getResponse) === 'function'){\r\n                    ret = renderer.getResponse.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.resetResponse = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(typeof (renderer.resetResponse) === 'function'){\r\n                    ret = renderer.resetResponse.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        /**\r\n         * Retrieve the state of the interaction.\r\n         * If the renderer has no state management, it falls back to the response management.\r\n         *\r\n         * @param {Object} qtiInteraction - the interaction\r\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\r\n         * @returns {Object} the interaction's state\r\n         *\r\n         * @throws {Error} if no renderer is registered\r\n         */\r\n        this.getState = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false;\r\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\r\n            var renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(_.isFunction(renderer.getState)){\r\n                    ret = renderer.getState.call(this, qtiInteraction);\r\n                } else {\r\n                    ret = renderer.getResponse.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        /**\r\n         * Retrieve the state of the interaction.\r\n         * If the renderer has no state management, it falls back to the response management.\r\n         *\r\n         * @param {Object} qtiInteraction - the interaction\r\n         * @param {Object} state - the interaction's state\r\n         * @param {String} [qtiSubClass] - (not sure of the type and how it is used - Sam ? )\r\n         *\r\n         * @throws {Error} if no renderer is found\r\n         */\r\n        this.setState =  function(qtiInteraction, state, qtiSubclass){\r\n\r\n            var qtiClass = qtiSubclass || qtiInteraction.qtiClass;\r\n            var renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(_.isFunction(renderer.setState)){\r\n                    renderer.setState.call(this, qtiInteraction, state);\r\n                } else {\r\n                    renderer.resetResponse.call(this, qtiInteraction);\r\n                    renderer.setResponse.call(this, qtiInteraction, state);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Calls the renderer destroy.\r\n         * Ask the renderer to run destroy if exists.\r\n         *\r\n         * @throws {Error} if no renderer is found\r\n         */\r\n        this.destroy = function(qtiInteraction, qtiSubclass){\r\n\r\n            var ret = false,\r\n                qtiClass = qtiSubclass || qtiInteraction.qtiClass,\r\n                renderer = _getClassRenderer(qtiClass);\r\n\r\n            if(renderer){\r\n                if(_.isFunction(renderer.destroy)){\r\n                    ret = renderer.destroy.call(this, qtiInteraction);\r\n                }\r\n            }else{\r\n                throw 'no renderer registered under the name : ' + qtiClass;\r\n            }\r\n            return ret;\r\n        };\r\n\r\n        this.getLoadedRenderers = function(){\r\n            return _renderers;\r\n        };\r\n\r\n        this.register = function(renderersLocations){\r\n            _.extend(_locations, renderersLocations);\r\n        };\r\n\r\n        this.load = function(callback, requiredClasses){\r\n           var self = this;\r\n            var required = [];\r\n\r\n            if(options.themes){\r\n\r\n                //resolve themes paths\r\n                options.themes.base = this.resolveUrl(options.themes.base);\r\n                _.forEach(options.themes.available, function(theme, index){\r\n                    options.themes.available[index].path = self.resolveUrl(theme.path);\r\n                });\r\n                this.themeLoader = themeLoader(options.themes).load();\r\n            }\r\n\r\n            if(requiredClasses){\r\n                if(_.isArray(requiredClasses)){\r\n\r\n                    //exclude abstract classes\r\n                    requiredClasses = _.intersection(requiredClasses, _renderableClasses);\r\n\r\n                    //add dependencies\r\n                    _.each(requiredClasses, function(reqClass){\r\n                        var deps = _dependencies[reqClass];\r\n                        if(deps){\r\n                            requiredClasses = _.union(requiredClasses, deps);\r\n                        }\r\n                    });\r\n\r\n                    _.forEach(requiredClasses, function(qtiClass){\r\n\r\n                        if(_renderableSubclasses[qtiClass]){\r\n                            var requiredSubClasses = _.intersection(requiredClasses, _renderableSubclasses[qtiClass]);\r\n                            _.each(requiredSubClasses, function(subclass){\r\n                                if (!registerRendererClass(qtiClass + '.' + subclass, required) && !registerRendererClass(qtiClass, required)) {\r\n                                    throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass + ', subclass: ' + subclass);\r\n                                }\r\n                            });\r\n                        } else {\r\n                            if (!registerRendererClass(qtiClass, required)) {\r\n                                throw new Error(self.name + ' : missing qti class location declaration: ' + qtiClass);\r\n                            }\r\n                        }\r\n                    });\r\n                } else {\r\n                    throw new Error('invalid argument type: expected array for arg \"requireClasses\"');\r\n                }\r\n\r\n            }else{\r\n                required = _.values(_locations);\r\n            }\r\n\r\n            var _this = this;\r\n            require(required, function(){\r\n\r\n                _.each(arguments, function(clazz){\r\n                    if(_isValidRenderer(clazz)){\r\n                        _renderers[clazz.qtiClass] = clazz;\r\n                    }\r\n                });\r\n\r\n                if(typeof (callback) === 'function'){\r\n                    callback.call(_this, _renderers);\r\n                }\r\n            });\r\n\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Unload the renderer\r\n         */\r\n        this.unload = function unload(){\r\n            if(this.themeLoader){\r\n                themeLoader(options.themes).unload();\r\n            }\r\n            return this;\r\n        };\r\n\r\n        /**\r\n         * Define the shuffling manually\r\n         *\r\n         * @param {Object} interaction - the interaction\r\n         * @param {Array} choices - the shuffled choices\r\n         * @param {String} identificationType -\r\n         */\r\n        this.setShuffledChoices = function(interaction, choices, identificationType){\r\n            if(Element.isA(interaction, 'interaction')){\r\n                this.shuffledChoices[interaction.getSerial()] = _.pluck(interactionHelper.findChoices(interaction, choices, identificationType), 'serial');\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Get the choices shuffled for this interaction.\r\n         *\r\n         * @param {Object} interaction - the interaction\r\n         * @param {Boolean} reshuffle - by default choices are shuffled only once and store, but if true you can force shuffling again\r\n         * @param {String} returnedType - the choice type\r\n         * @returns {Array} the choices\r\n         */\r\n        this.getShuffledChoices = function(interaction, reshuffle, returnedType){\r\n            var choices = [];\r\n            var shuffled = [];\r\n            var serial, i;\r\n\r\n            if(Element.isA(interaction, 'interaction')){\r\n                serial = interaction.getSerial();\r\n\r\n                //1st time, we shuffle (or asked to force shuffling)\r\n                if(!this.shuffledChoices[serial] || reshuffle){\r\n                    if(Element.isA(interaction, 'matchInteraction')){\r\n                        this.shuffledChoices[serial] = [];\r\n                        for(i = 0; i < 2; i++){\r\n                            choices[i] = interactionHelper.shuffleChoices(interaction.getChoices(i));\r\n                            this.shuffledChoices[serial][i] = _.pluck(choices[i], 'serial');\r\n                        }\r\n                    } else {\r\n                        choices = interactionHelper.shuffleChoices(interaction.getChoices());\r\n                        this.shuffledChoices[serial] = _.pluck(choices, 'serial');\r\n                    }\r\n\r\n                //otherwise get the choices from the serials\r\n                } else {\r\n                    if(Element.isA(interaction, 'matchInteraction')){\r\n                        _.forEach(choices, function(choice, index){\r\n                            if(index < 2){\r\n                                _.forEach(this.shuffledChoices[serial][i], function(choiceSerial){\r\n                                    choice.push(interaction.getChoice(choiceSerial));\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        _.forEach(this.shuffledChoices[serial], function(choiceSerial){\r\n                            choices.push(interaction.getChoice(choiceSerial));\r\n                        });\r\n                    }\r\n                }\r\n\r\n                //do some type convertion\r\n                if(returnedType === 'serial' || returnedType === 'identifier'){\r\n                    return interactionHelper.convertChoices(choices, returnedType);\r\n                }\r\n\r\n                //pass value only, not ref\r\n                return _.clone(choices);\r\n            }\r\n\r\n            return [];\r\n        };\r\n\r\n        this.getRenderers = function(){\r\n            return _renderers;\r\n        };\r\n\r\n        this.getLocations = function(){\r\n            return _locations;\r\n        };\r\n\r\n        /**\r\n         * Resolve URLs using the defined assetManager's strategies\r\n         * @param {String} url - the URL to resolve\r\n         * @returns {String} the resolved URL\r\n         */\r\n        this.resolveUrl = function resolveUrl(url){\r\n            if(!options.assetManager){\r\n                return url;\r\n            }\r\n            if(typeof url === 'string' && url.length > 0){\r\n                return options.assetManager.resolve(url);\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @deprecated in favor of resolveUrl\r\n         */\r\n        this.getAbsoluteUrl = function(relUrl){\r\n\r\n            //let until method is removed\r\n            console.warn('DEPRECATED used getAbsoluteUrl with ', arguments);\r\n\r\n            //allow relative url output only if explicitely said so\r\n            if(this.getOption('userRelativeUrl')){\r\n                return relUrl.replace(/^\\.?\\//, '');\r\n            }\r\n\r\n            if(/^http(s)?:\\/\\//i.test(relUrl) || /^data:[^\\/]+\\/[^;]+(;charset=[\\w]+)?;base64,/.test(relUrl)){\r\n                //already absolute or base64 encoded\r\n                return relUrl;\r\n            }else{\r\n\r\n                var absUrl = '';\r\n                var runtimeLocations = this.getOption('runtimeLocations');\r\n\r\n                if(runtimeLocations && _.size(runtimeLocations)){\r\n                    _.forIn(runtimeLocations, function(runtimeLocation, typeIdentifier){\r\n                        if(relUrl.indexOf(typeIdentifier) === 0){\r\n                            absUrl = relUrl.replace(typeIdentifier, runtimeLocation);\r\n                            return false;//break\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if(absUrl){\r\n                    return absUrl;\r\n                }else{\r\n                    var baseUrl = this.getOption('baseUrl') || getDocumentBaseUrl();\r\n                    return baseUrl + relUrl;\r\n                }\r\n\r\n            }\r\n        };\r\n\r\n        this.setAreaBroker = function setAreaBroker(areaBroker) {\r\n            this._areaBroker = areaBroker;\r\n        };\r\n\r\n        this.getAreaBroker = function getAreaBroker() {\r\n            if (this._areaBroker) {\r\n                return this._areaBroker;\r\n            }\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Expose the renderer's factory\r\n     * @exports taoQtiItem/qtiRunner/core/Renderer\r\n     */\r\n    return {\r\n\r\n        /**\r\n         * Creates a new Renderer by extending the Renderer's prototype\r\n         * @param {Object} renderersLocations -\r\n         * @param {String} [name] - the new renderer name\r\n         * @param {Object} [defaultOptions] - the renderer options\r\n         */\r\n        build : function(renderersLocations, name, defaultOptions){\r\n            var NewRenderer = function(){\r\n                var options = _.isPlainObject(arguments[0]) ? arguments[0] : {};\r\n\r\n                Renderer.apply(this);\r\n\r\n                this.register(renderersLocations);\r\n                this.name = name || '';\r\n                this.setOptions(_.defaults(options, defaultOptions || {}));\r\n            };\r\n            NewRenderer.prototype = Renderer.prototype;\r\n            return NewRenderer;\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * The asset manager proposes you to resolve your asset URLs for you!\r\n * You need to add the resolution strategies, it will then evaluate each strategy until the right one is found\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoItems/assets/manager',[\r\n    'lodash',\r\n    'util/url'\r\n], function(_, urlUtil){\r\n    'use strict';\r\n\r\n    /**\r\n     * @typedef AssetStrategy Defines a way to resolve an asset path\r\n     * @property {String} name - the strategy name\r\n     * @property {assetStrategyHandle} handle - how to resolve the strategy.\r\n     */\r\n\r\n    /**\r\n     * @callback assetStrategyHandle\r\n     * @param {String|Object} url - the URL to resolved. If parseUrl, it's an object that contains host, port, search, queryString, etc.\r\n     * @param {Object} data - the context data\r\n     * @returns {String?} falsy if not resolved otherwise the resolved URL\r\n     */\r\n\r\n\r\n    /**\r\n     * The assetManagerFactory create a new assetManager with the given resolution stratgies and a data context.\r\n     *\r\n     * @example\r\n     *   //define AssetStrategies with a name and a handle method\r\n     *   var strategies = [{\r\n     *       name : 'external',\r\n     *       handle : function(url, data){\r\n     *           if(/^http/.test(url)){\r\n     *               return path;\r\n     *           }\r\n     *       }\r\n     *   }, {\r\n     *       name : 'relative',\r\n     *       handle : function(url, data){\r\n     *           if(/^((\\.\\/)|(\\w\\/))/){\r\n     *               return data.baseUrl + '/' + url ;\r\n     *           }\r\n     *       }\r\n     *   }]);\r\n     *\r\n     *   var assetManager = assetManagerFactory(strategies, { baseUrl : 'http://t.oa/public/assets/' });\r\n     *   assetManager.resolve('http://foo/bar.png'); //will resolved using external\r\n     *   assetManager.resolve('bar.png'); //will resolved using relative strategy\r\n     *\r\n     * @param {AssetStrategy[]} strategies - the strategies\r\n     * @param {Object} data - the context data\r\n     * @param {Object} [options] - the manager options\r\n     * @param {Boolean} [options.parseUrl = true] - If the URL to give to the stragies should be parsed or given as it is.\r\n     * @param {Boolean} [options.cache] - resolve the same URL only once and store the result in memory.\r\n     *\r\n     * @exports taoItems/assets/manager\r\n     * @namespace assetManagerFactory\r\n     */\r\n    var assetManagerFactory = function assetManagerFactory(strategies, data, options) {\r\n\r\n        var cache  = {};\r\n\r\n        strategies = _.isArray(strategies) ? strategies : [strategies];\r\n        data       = data || {};\r\n        options    = _.defaults(options || {}, {\r\n            parseUrl : true\r\n        });\r\n\r\n        /**\r\n         * A brand new asset manager is created by the factory\r\n         */\r\n        var assetManager = {\r\n\r\n            /**\r\n             * The stack of strategies that would be used to resolve the asset path\r\n             * @type {AssetStrategy[]}\r\n             */\r\n            _strategies : [],\r\n\r\n            /**\r\n             * Add an asset resolution strategy.\r\n             * The strategies will be evaluated in the order they've been added.\r\n             * @param {AssetStrategy} strategy - the strategy to add\r\n             * @throws {TypeError} if the strategy isn't defined correctly\r\n             */\r\n            addStrategy : function addStrategy (strategy){\r\n\r\n                if(!_.isPlainObject(strategy) || !_.isFunction(strategy.handle) || !_.isString(strategy.name)){\r\n                    throw new TypeError('An asset resolution strategy is an object with a handle method and a name');\r\n                }\r\n\r\n                this._strategies.push(strategy);\r\n            },\r\n\r\n            /**\r\n             * Change the strategies\r\n             * @param {AssetStrategy[]} strategies - the strategies\r\n             * @throws {TypeError} if the strategy isn't defined correctly\r\n             */\r\n            setStrategies : function setStrategies(newStrategies){\r\n                var self = this;\r\n\r\n                this._strategies = [];\r\n\r\n                //assign the strategies to the assetManager\r\n                _.forEach(newStrategies, function(strategy){\r\n\r\n                    //if it's an object we add it directly\r\n                    if(_.isPlainObject(strategy)){\r\n                        assetManager.addStrategy(strategy);\r\n\r\n                    //if it's a function, we create the strategy with a generated name\r\n                    } else if(_.isFunction(strategy)){\r\n                        self.addStrategy({\r\n                            name   : 'strategy_' + (self._strategies.length + 1),\r\n                            handle : strategy\r\n                        });\r\n                    }\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Set context data\r\n             * @param {String|Object} [key] - the key of the data to set or the data values if it's an object\r\n             * @param {*} [value] - the value to set if a key is given\r\n             */\r\n            setData : function setData(key, value){\r\n                if(_.isString(key) && typeof value !== 'undefined'){\r\n                    data[key] = value;\r\n                } else if(_.isPlainObject(key)){\r\n                    data = key;\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Get context data\r\n             * @param {String} [key] - if we want the value of a particuar key\r\n             * @returns {Object|*} all the data or the proprety value if key is given\r\n             */\r\n            getData : function getData(key){\r\n                if(_.isString(key)){\r\n                    return data[key];\r\n                }\r\n                return data;\r\n            },\r\n\r\n            /**\r\n             * Resolve the given URL against the strategies\r\n             * @param {String} url - the URL to resolve\r\n             * @returns {String?} the resolved URL or nothing\r\n             */\r\n            resolve : function resolve(url){\r\n                var resolved;\r\n                var inputUrl;\r\n\r\n                //if caching try to load the value from the cache\r\n                if(options.cache && cache.hasOwnProperty(url)){\r\n                    return cache[url];\r\n                }\r\n\r\n                //parse the url ?\r\n                inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\r\n\r\n                //call strategies handlers, in their order until once returns somethin\r\n                _.forEach(this._strategies, function(strategy){\r\n                    var result = strategy.handle(inputUrl, data);\r\n                    if(result){\r\n                        resolved = result;\r\n                        return false;\r\n                    }\r\n                });\r\n\r\n                resolved = resolved || '';\r\n\r\n                if(options.cache){\r\n                    cache[url] = resolved;\r\n                }\r\n\r\n                return resolved;\r\n            },\r\n\r\n            /**\r\n             * Resolve the given URL against the strategy identified by the given name\r\n             * @param {String} name - the strategy name\r\n             * @param {String} url - the URL to resolve\r\n             * @returns {String?} the resolved URL or nothing\r\n             */\r\n            resolveBy : function resolveBy(name, url){\r\n                var inputUrl;\r\n                var resolved = '';\r\n                var strategy = _.find(this._strategies, {name : name});\r\n                if(strategy){\r\n                    //parse the url ?\r\n                    inputUrl = options.parseUrl ? urlUtil.parse(url) : url;\r\n                    resolved = strategy.handle(inputUrl, data);\r\n                }\r\n                return resolved;\r\n            },\r\n\r\n            /**\r\n             * When the cache is used, it could be useful to clear the cache\r\n             */\r\n            clearCache : function clearCache(){\r\n                if(options.cache){\r\n                    cache = {};\r\n                }\r\n            }\r\n        };\r\n\r\n        assetManager.setStrategies(strategies);\r\n\r\n        return assetManager;\r\n    };\r\n\r\n    return assetManagerFactory;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * Provides common strategies to resolved assets\r\n * that may be used by any type of items.\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoItems/assets/strategies',[\r\n    'util/url'\r\n], function(urlUtil){\r\n    'use strict';\r\n\r\n    /**\r\n     * Prepend a base to an URL\r\n     * @param {Object} url - a parsed URL\r\n     * @param {String} base - the base to prepend\r\n     * @param {Boolean} [slashcat = false] - remove dots, double slashes, etc.\r\n     * @returns {String} the URL\r\n     */\r\n    var prependToUrl = function prependToUrl(url, base, slashcat){\r\n\r\n        //is slashcat we manage slash concact\r\n        if(slashcat === true){\r\n            return base.replace(/\\/$/, '') + '/' + url.directory.replace(/^\\.\\//, '').replace(/^\\//, '')\r\n                + encodeURIComponent(url.file.replace(/^\\.\\//, '').replace(/^\\//, ''));\r\n        }\r\n\r\n        return base + url.directory.replace(/^\\.?\\//, '') + encodeURIComponent(url.file.replace(/^\\.?\\//, ''));\r\n    };\r\n\r\n    /**\r\n     * Unrelated strategies accessible by there name.\r\n     * Remember to not use the whole object, but each one in an array since the order matters.\r\n     *\r\n     * @exports taoItems/assets/strategies\r\n     */\r\n    var strategies = {\r\n\r\n        //the baseUrl concats the baseUrl in data if the url is relative\r\n        baseUrl : {\r\n            name : 'baseUrl',\r\n            handle : function handleBaseUrl(url, data){\r\n                if(typeof data.baseUrl === 'string' && (urlUtil.isRelative(url)) ){\r\n                    return prependToUrl(url, data.baseUrl, data.slashcat);\r\n                }\r\n            }\r\n        },\r\n\r\n        //bust the cache for item CSS\r\n        itemCssNoCache : {\r\n            name : 'itemCssNoCache',\r\n            handle : function handleItemCss(url, data){\r\n                if(typeof data.baseUrl === 'string' && (urlUtil.isRelative(url)) && /\\.css$/.test(url.file)) {\r\n                    return urlUtil.build(prependToUrl(url, data.baseUrl, data.slashcat), { bust : Date.now() });\r\n                }\r\n            }\r\n        },\r\n\r\n        //absolute URL are just left intact\r\n        external : {\r\n            name : 'external',\r\n            handle : function handleExternal(url){\r\n                if(urlUtil.isAbsolute(url)){\r\n                    return url.toString();\r\n                }\r\n            }\r\n        },\r\n\r\n        //the base64 encoded resources are also left intact\r\n        base64 : {\r\n            name : 'base64',\r\n            handle : function handleB64(url){\r\n                if(urlUtil.isBase64(url)){\r\n                    return url.toString();\r\n                }\r\n            }\r\n        },\r\n\r\n        //special tao media protocol\r\n        taomedia : {\r\n            name : 'taomedia',\r\n            handle : function handleTaoMedia(url, data){\r\n                //either a baseUrl is given or if empty, taomedia resources are managed as relative resources\r\n                var baseUrl = data.baseUrl || './';\r\n                if( (typeof url === 'object' && url.protocol === 'taomedia') ||\r\n                    (/^taomedia:\\/\\//.test(url.toString())) ){\r\n                    return baseUrl + url.toString();\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return strategies;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\ndefine('taoQtiItem/portableElementRegistry/assetManager/portableAssetStrategy',[\r\n    'taoQtiItem/portableElementRegistry/ciRegistry',\r\n    'taoQtiItem/portableElementRegistry/icRegistry'\r\n], function (ciRegistry, icRegistry) {\r\n    'use strict';\r\n\r\n    function getBaseUrlByIdentifier(typeIdentifier) {\r\n        if (ciRegistry.get(typeIdentifier)) {\r\n            return ciRegistry.getBaseUrl(typeIdentifier);\r\n        }\r\n        if (icRegistry.get(typeIdentifier)) {\r\n            return icRegistry.getBaseUrl(typeIdentifier);\r\n        }\r\n        return typeIdentifier;\r\n    }\r\n\r\n    //strategy to resolve portable info control and portable interactions paths.\r\n    //It should never be reached in the stack the usual way and should be called only using resolveBy.\r\n    return {\r\n        name: 'portableElementLocation',\r\n        handle: function handlePortableElementLocation(url) {\r\n\r\n            if (url.file === url.path) {\r\n                return getBaseUrlByIdentifier(url.file);\r\n            } else if (url.source === url.relative) {\r\n                return url.relative.replace(/^(\\.\\/)?([a-z_0-9]+)\\/(.*)/i, function (fullmatch, $1, typeIdentifier, relPath) {\r\n                    var runtimeLocation = getBaseUrlByIdentifier(typeIdentifier);\r\n                    if (runtimeLocation) {\r\n                        return runtimeLocation + '/' + relPath;\r\n                    }\r\n                    return fullmatch;\r\n                });\r\n            }\r\n        }\r\n    };\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/config',[\r\n    'lodash',\r\n    'context',\r\n    'ui/themes',\r\n    'taoItems/assets/manager',\r\n    'taoItems/assets/strategies',\r\n    'module',\r\n    'taoQtiItem/portableElementRegistry/assetManager/portableAssetStrategy'\r\n], function(_, context, themes, assetManagerFactory, assetStrategies, module, portableAssetStrategy){\r\n    'use strict';\r\n\r\n    var itemThemes = themes.get('items');\r\n    var moduleConfig = module.config();\r\n\r\n    //Create asset manager stack\r\n    var assetManager = assetManagerFactory([\r\n        {\r\n            name : 'theme',\r\n            handle : function handleTheme(url){\r\n                if(itemThemes && url.path && (url.path === itemThemes.base || _.contains(_.pluck(itemThemes.available, 'path'), url.path))){\r\n                    return context.root_url + url.toString();\r\n                }\r\n            }\r\n        },\r\n        assetStrategies.taomedia,\r\n        assetStrategies.external,\r\n        assetStrategies.base64,\r\n        assetStrategies.itemCssNoCache,\r\n        assetStrategies.baseUrl,\r\n        portableAssetStrategy\r\n    ], {baseUrl : ''});//baseUrl is not predefined in the config, but should be set upon renderer instantiating\r\n\r\n    //renderers locations\r\n    var locations = {\r\n        'assessmentItem' : 'taoQtiItem/qtiCommonRenderer/renderers/Item',\r\n        '_container' : 'taoQtiItem/qtiCommonRenderer/renderers/Container',\r\n        '_simpleFeedbackRule' : false,\r\n        'stylesheet' : 'taoQtiItem/qtiCommonRenderer/renderers/Stylesheet',\r\n        'outcomeDeclaration' : false,\r\n        'responseDeclaration' : false,\r\n        'responseProcessing' : false,\r\n        'img' : 'taoQtiItem/qtiCommonRenderer/renderers/Img',\r\n        'math' : 'taoQtiItem/qtiCommonRenderer/renderers/Math',\r\n        'object' : 'taoQtiItem/qtiCommonRenderer/renderers/Object',\r\n        'table' : 'taoQtiItem/qtiCommonRenderer/renderers/Table',\r\n        'rubricBlock' : 'taoQtiItem/qtiCommonRenderer/renderers/RubricBlock',\r\n        'modalFeedback' : 'taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback',\r\n        'prompt' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/Prompt',\r\n        'choiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction',\r\n        'extendedTextInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction',\r\n        'orderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction',\r\n        'associateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction',\r\n        'matchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction',\r\n        'textEntryInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/TextEntryInteraction',\r\n        'sliderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction',\r\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction',\r\n        'simpleChoice.choiceInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction',\r\n        'simpleChoice.orderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction',\r\n        'hottext' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/Hottext',\r\n        'gap' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/Gap',\r\n        'gapText' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/GapText',\r\n        'simpleAssociableChoice.matchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction',\r\n        'simpleAssociableChoice.associateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction',\r\n        'inlineChoice' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/InlineChoice',\r\n        'hottextInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction',\r\n        'hotspotInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction',\r\n        'hotspotChoice' : false,\r\n        'gapMatchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction',\r\n        'selectPointInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction',\r\n        'graphicOrderInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction',\r\n        'mediaInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction',\r\n        'uploadInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/UploadInteraction',\r\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction',\r\n        'gapImg' : 'taoQtiItem/qtiCommonRenderer/renderers/choices/GapImg',\r\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction',\r\n        'associableHotspot' : false,\r\n        'customInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/PortableCustomInteraction',\r\n        'infoControl' : 'taoQtiItem/qtiCommonRenderer/renderers/PortableInfoControl',\r\n        'include' : 'taoQtiItem/qtiCommonRenderer/renderers/Include',\r\n        'endAttemptInteraction' : 'taoQtiItem/qtiCommonRenderer/renderers/interactions/EndAttemptInteraction'\r\n    };\r\n\r\n    return {\r\n        name:'commonRenderer',\r\n        locations: locations,\r\n        options:   {\r\n            assetManager: assetManager,\r\n            themes : itemThemes,\r\n            enableDragAndDrop: {\r\n                associate: !!moduleConfig.associateDragAndDrop,\r\n                gapMatch: !!moduleConfig.gapMatchDragAndDrop,\r\n                graphicGapMatch: !!moduleConfig.graphicGapMatchDragAndDrop,\r\n                order: !!moduleConfig.orderDragAndDrop\r\n            },\r\n            messages : moduleConfig.messages\r\n        }\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/config',[\r\n    'lodash',\r\n    'context',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/config',\r\n    'taoItems/assets/manager',\r\n    'taoItems/assets/strategies'\r\n], function(_,  context, commonRenderConfig, assetManagerFactory, assetStrategies){\r\n    'use strict';\r\n\r\n    //asset manager using base url\r\n    var assetManager = assetManagerFactory([\r\n        assetStrategies.taomedia,\r\n        assetStrategies.external,\r\n        assetStrategies.base64,\r\n        assetStrategies.baseUrl\r\n    ], {baseUrl : ''});\r\n\r\n    var locations = _.defaults({\r\n        '_container' : 'taoQtiItem/qtiCreator/renderers/Container',\r\n        'assessmentItem' : 'taoQtiItem/qtiCreator/renderers/Item',\r\n        'rubricBlock' : 'taoQtiItem/qtiCreator/renderers/RubricBlock',\r\n        'img' : 'taoQtiItem/qtiCreator/renderers/Img',\r\n        'math' : 'taoQtiItem/qtiCreator/renderers/Math',\r\n        'object' : 'taoQtiItem/qtiCreator/renderers/Object',\r\n        'table' : 'taoQtiItem/qtiCreator/renderers/Table',\r\n        'modalFeedback' : 'taoQtiItem/qtiCreator/renderers/ModalFeedback',\r\n        'choiceInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/ChoiceInteraction',\r\n        'orderInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/OrderInteraction',\r\n        'matchInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/MatchInteraction',\r\n        'associateInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/AssociateInteraction',\r\n        'inlineChoiceInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/InlineChoiceInteraction',\r\n        'textEntryInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/TextEntryInteraction',\r\n        'hotspotInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/HotspotInteraction',\r\n        'selectPointInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/SelectPointInteraction',\r\n        'graphicOrderInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/GraphicOrderInteraction',\r\n        'graphicAssociateInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/GraphicAssociateInteraction',\r\n        'graphicGapMatchInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/GraphicGapMatchInteraction',\r\n        'mediaInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/MediaInteraction',\r\n        'uploadInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/UploadInteraction',\r\n        'sliderInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/SliderInteraction',\r\n        'extendedTextInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/ExtendedTextInteraction',\r\n        'simpleChoice.choiceInteraction' : 'taoQtiItem/qtiCreator/renderers/choices/SimpleChoice.ChoiceInteraction',\r\n        'simpleChoice.orderInteraction' : 'taoQtiItem/qtiCreator/renderers/choices/SimpleChoice.OrderInteraction',\r\n        'simpleAssociableChoice.associateInteraction' : 'taoQtiItem/qtiCreator/renderers/choices/SimpleAssociableChoice.AssociateInteraction',\r\n        'simpleAssociableChoice.matchInteraction' : 'taoQtiItem/qtiCreator/renderers/choices/SimpleAssociableChoice.MatchInteraction',\r\n        'gapMatchInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/GapMatchInteraction',\r\n        'hottextInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/HottextInteraction',\r\n        'customInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/PortableCustomInteraction',\r\n        'endAttemptInteraction' : 'taoQtiItem/qtiCreator/renderers/interactions/EndAttemptInteraction',\r\n        'infoControl' : 'taoQtiItem/qtiCreator/renderers/PortableInfoControl',\r\n        'include' : 'taoQtiItem/qtiCreator/renderers/Include',\r\n        'gap' : 'taoQtiItem/qtiCreator/renderers/choices/Gap',\r\n        'gapText' : 'taoQtiItem/qtiCreator/renderers/choices/GapText',\r\n        'hottext' : 'taoQtiItem/qtiCreator/renderers/choices/Hottext'\r\n    }, commonRenderConfig.locations);\r\n\r\n    return {\r\n        name : 'creatorRenderer',\r\n        locations : locations,\r\n        options : {\r\n            assetManager : assetManager\r\n        }\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\n/**\r\n * Define the Qti Item Creator Renderer\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/Renderer',[\r\n    'taoQtiItem/qtiRunner/core/Renderer',\r\n    'taoQtiItem/qtiCreator/renderers/config'\r\n], function(Renderer, config){\r\n    'use strict';\r\n\r\n    return Renderer.build(config.locations, config.name, config.options);\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/creatorRenderer',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/renderers/Renderer',\r\n    'taoItems/assets/manager',\r\n    'taoItems/assets/strategies',\r\n    'util/dom'\r\n], function($, _, Renderer, assetManagerFactory, assetStrategies, dom){\r\n    \"use strict\";\r\n\r\n    //configure and instanciate once only:\r\n    var _creatorRenderer = null;\r\n\r\n    //list of configurable interactions\r\n    //some interactions allow additional non-standard but sometimes useful configuration\r\n    var _configurableInteractions = ['endAttempt'];\r\n\r\n    /**\r\n     * Extract interaction-specific configuration from the main one\r\n     *\r\n     * @param {object} config - the configuration object of the creatorRenderer\r\n     * @returns {module.exports.properties|Function.properties|config.properties}\r\n     */\r\n    var _extractInteractionsConfig = function _extractInteractionsConfig(config){\r\n        var ret = {};\r\n        if(config && config.properties){\r\n            _.each(_configurableInteractions, function(interactionName){\r\n                if(config.properties[interactionName]){\r\n                    ret[interactionName] = config.properties[interactionName];\r\n                }\r\n            });\r\n        }\r\n        return ret;\r\n    };\r\n\r\n    /**\r\n     * Get a preconfigured renderer singleton\r\n     *\r\n     * @param {Boolean} reset\r\n     * @param {Object} config\r\n     * @param {Object} areaBroker - the QtiCreator area broker\r\n     * @returns {Object} - a configured instance of creatorRenderer\r\n     */\r\n    var get = function(reset, config, areaBroker){\r\n        var $bodyEltForm;\r\n\r\n        if(!_creatorRenderer || reset){\r\n\r\n            $bodyEltForm = _creatorRenderer ? _creatorRenderer.getOption('bodyElementOptionForm') : null;\r\n            if(reset ||\r\n                !$bodyEltForm ||\r\n                !$bodyEltForm.length ||\r\n                !dom.contains($bodyEltForm)){\r\n\r\n                _creatorRenderer = new Renderer({\r\n                    //assetManager : assetManager,\r\n                    lang : '',\r\n                    uri : '',\r\n                    shuffleChoices : false,\r\n                    itemOptionForm : $('#item-editor-item-property-bar .panel'),\r\n                    interactionOptionForm : $('#item-editor-interaction-property-bar .panel'),\r\n                    choiceOptionForm : $('#item-editor-choice-property-bar .panel'),\r\n                    responseOptionForm : $('#item-editor-response-property-bar .panel'),\r\n                    bodyElementOptionForm : $('#item-editor-body-element-property-bar .panel'),\r\n                    textOptionForm : $('#item-editor-text-property-bar .panel'),\r\n                    modalFeedbackOptionForm : $('#item-editor-modal-feedback-property-bar .panel'),\r\n                    mediaManager : {\r\n                        appendContainer : '#mediaManager',\r\n                        browseUrl : config.properties.getFilesUrl,\r\n                        uploadUrl : config.properties.fileUploadUrl,\r\n                        deleteUrl : config.properties.fileDeleteUrl,\r\n                        downloadUrl : config.properties.fileDownloadUrl,\r\n                        fileExistsUrl : config.properties.fileExistsUrl,\r\n                        mediaSourcesUrl : config.properties.mediaSourcesUrl\r\n                    },\r\n                    interactions : _extractInteractionsConfig(config)\r\n                });\r\n\r\n                //update the resolver baseUrl\r\n                _creatorRenderer.getAssetManager().setData({baseUrl : config.properties.baseUrl || '' });\r\n\r\n                _creatorRenderer.setAreaBroker(areaBroker);\r\n            }\r\n        }\r\n\r\n        return _creatorRenderer;\r\n    };\r\n\r\n\r\n    return {\r\n        get : get,\r\n\r\n        setOption : function(name, value){\r\n            return get().setOption(name, value);\r\n        },\r\n        setOptions : function(options){\r\n            return get().setOptions(options);\r\n        },\r\n        load : function(qtiClasses, done){\r\n            return get().load(function(){\r\n                if(_.isFunction(done)){\r\n                    done.apply(this, arguments);\r\n                }\r\n            }, qtiClasses);\r\n        }\r\n    };\r\n\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\n/**\r\n * Define the Qti Item Common Renderer\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Renderer',[\r\n    'taoQtiItem/qtiRunner/core/Renderer',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/config'\r\n], function(Renderer, config){\r\n    'use strict';\r\n\r\n    return Renderer.build(config.locations, config.name, config.options);\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/container',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiItem/core/Element'\r\n], function(_, $, Element){\r\n    'use strict';\r\n\r\n    //containers are cached, so do not forget to remove them.\r\n    var _containers = {};\r\n    var _$containerContext = $();\r\n\r\n    /**\r\n     * Build the selector for your element (from the element serial)\r\n     * @private\r\n     * @param {QtiElement} element\r\n     * @returns {String} the selector\r\n     */\r\n    var _getSelector = function(element){\r\n\r\n        var serial = element.getSerial(),\r\n            selector = '[data-serial=' + serial + ']';\r\n\r\n        if(Element.isA(element, 'choice')){\r\n            selector = '.qti-choice' + selector;\r\n        }else if(Element.isA(element, 'interaction')){\r\n            selector = '.qti-interaction' + selector;\r\n        }\r\n\r\n        return selector;\r\n    };\r\n\r\n    /**\r\n     * Helps you to retrieve the DOM element (as a jquery element)\r\n     * @exports taoQtiItem/qtiCommonRenderer/helpers/containerHelper\r\n     */\r\n    var containerHelper =  {\r\n\r\n        /**\r\n         * Set a global scope to look for element container\r\n         * @param {jQueryElement} [$scope] - if you want to retrieve the element in a particular scope or context\r\n         */\r\n        setContext : function($scope){\r\n            _$containerContext = $scope;\r\n        },\r\n\r\n        /**\r\n         * Get the container of the given element\r\n         * @param {QtiElement} element - the QTI Element to find the container for\r\n         * @param {jQueryElement} [$scope] - if you want to retrieve the element in a particular scope or context\r\n         * @returns {jQueryElement} the container\r\n         */\r\n        get : function(element, $scope){\r\n\r\n            var serial = element.getSerial();\r\n            if($scope instanceof $ && $scope.length){\r\n\r\n                //find in the given context\r\n                return $scope.find(_getSelector(element));\r\n\r\n            }else if(_$containerContext instanceof $ && _$containerContext.length){\r\n\r\n                //find in the globally set context\r\n                return _$containerContext.find(_getSelector(element));\r\n\r\n            }else if(!_containers[serial] || !_containers[serial].length){\r\n\r\n                //find in the global context\r\n                _containers[serial] = $(_getSelector(element));\r\n            }\r\n\r\n            return _containers[serial];\r\n        },\r\n\r\n        /**\r\n         * getContainer use a cache to store elements. This methods helps you to purge it.\r\n         * @param {Element} element - find the container of this element\r\n         */\r\n        reset : function(element){\r\n            if(element instanceof Element && _containers[element.getSerial()]){\r\n                _containers = _.omit(_containers, element.getSerial());\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Clear the containers cache\r\n         */\r\n        clear : function clear(){\r\n            _containers = {};\r\n            _$containerContext = $();\r\n        },\r\n\r\n        /**\r\n         * Trigger an event on the element's container\r\n         * @param {String} eventType - the name of the event\r\n         * @param {QtiElement} element - find the container of this element\r\n         * @param {Array} [data] - data to give to the event\r\n         */\r\n        trigger : function(eventType, element, data){\r\n            if(eventType){\r\n                if(data && !_.isArray(data)){\r\n                    data = [data];\r\n                }\r\n                this.get(element).trigger(eventType, data);\r\n\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Alias to trigger a responseChange Event from an interaction\r\n         * @param {QtiElement} interaction - the interaction that had a response changed\r\n         * @param {Object} [extraData] - additionnal data to give to the event\r\n         */\r\n        triggerResponseChangeEvent : function(interaction, extraData){\r\n            this.trigger('responseChange', interaction, [{\r\n                    interaction : interaction,\r\n                    response : interaction.getResponse()\r\n                },\r\n                extraData\r\n            ]);\r\n        },\r\n\r\n        /**\r\n         * Make all links to opens in another tab/window\r\n         * @param {jQueryElement} $container\r\n         */\r\n        targetBlank : function($container){\r\n\r\n            $container.on('click', 'a', function(e) {\r\n                e.preventDefault();\r\n                var href = $(this).attr('href');\r\n                if(href && href.match(/^http/i)){\r\n                    window.open(href, '_blank');\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    return containerHelper;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/commonRenderer',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Renderer',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(_, Renderer, containerHelper){\r\n    \"use strict\";\r\n\r\n    //store the current execution context of the common renderer (preview)\r\n    var _$previousContext = null;\r\n\r\n    //configure and instanciate once only:\r\n    var _renderer;\r\n\r\n    var commonRenderer = {\r\n        render : function(item, $container){\r\n\r\n            commonRenderer.setContext($container);\r\n\r\n            return _renderer.load(function(){\r\n\r\n                $container.append(item.render(this));\r\n                item.postRender({}, '', this);\r\n\r\n            }, item.getUsedClasses());\r\n        },\r\n        get : function(reset, config){\r\n            if(!_renderer || reset){\r\n\r\n                //create new instance of common renderer\r\n                _renderer = new Renderer({\r\n                    shuffleChoices : true\r\n                });\r\n\r\n                if(config){\r\n                    //update the resolver baseUrl\r\n                    _renderer.getAssetManager().setData({baseUrl : config.properties.baseUrl || '' });\r\n                }\r\n            }\r\n            return _renderer;\r\n        },\r\n        getOption : function(name){\r\n            return _renderer.getOption(name);\r\n        },\r\n        setOption : function(name, value){\r\n            return _renderer.setOption(name, value);\r\n        },\r\n        setOptions : function(options){\r\n            return _renderer.setOptions(options);\r\n        },\r\n        setContext : function($context){\r\n            _$previousContext = $context;\r\n            return containerHelper.setContext($context);\r\n        },\r\n        restoreContext : function(){\r\n            containerHelper.setContext(_$previousContext);\r\n             _$previousContext = null;\r\n        },\r\n        load : function(qtiClasses, done){\r\n            return _renderer.load(function(){\r\n                if(_.isFunction(done)){\r\n                    done.apply(this, arguments);\r\n                }\r\n            }, qtiClasses);\r\n        }\r\n    };\r\n\r\n    return commonRenderer;\r\n\r\n});\r\n\n","define('taoQtiItem/qtiItem/helper/simpleParser',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/qtiItem/core/Loader'\r\n], function(_, $, util, Loader){\r\n    \"use strict\";\r\n\r\n    var _parsableElements = ['img', 'object'];\r\n    var _qtiClassNames = {\r\n        rubricblock : 'rubricBlock'\r\n    };\r\n\r\n    var _defaultOptions = {\r\n        ns : {\r\n            math : '',\r\n            include : 'xi'\r\n        },\r\n        loaded : null,\r\n        model : null\r\n    };\r\n\r\n    function _getElementSelector(qtiClass, ns){\r\n        return ns ? ns + \"\\\\:\" + qtiClass + ','+qtiClass : qtiClass;\r\n    }\r\n\r\n    function getQtiClassFromXmlDom($node){\r\n\r\n        var qtiClass = $node.prop('tagName').toLowerCase();\r\n\r\n        //remove ns :\r\n        qtiClass = qtiClass.replace(/.*:/, '');\r\n\r\n        return _qtiClassNames[qtiClass] ? _qtiClassNames[qtiClass] : qtiClass;\r\n    }\r\n\r\n    function buildElement($elt){\r\n\r\n        var qtiClass = getQtiClassFromXmlDom($elt);\r\n\r\n        var elt = {\r\n            qtiClass : qtiClass,\r\n            serial : util.buildSerial(qtiClass + '_'),\r\n            attributes : {}\r\n        };\r\n\r\n        $.each($elt[0].attributes, function(){\r\n            if(this.specified){\r\n                elt.attributes[this.name] = this.value;\r\n            }\r\n        });\r\n\r\n        return elt;\r\n    }\r\n\r\n    function buildMath($elt, options){\r\n\r\n        var elt = buildElement($elt);\r\n\r\n        //set annotations:\r\n        elt.annotations = {};\r\n        $elt.find(_getElementSelector('annotation', options.ns.math)).each(function(){\r\n            var $annotation = $(this);\r\n            var encoding = $annotation.attr('encoding');\r\n            if(encoding){\r\n                elt.annotations[encoding] = _.unescape($annotation.html());\r\n            }\r\n            $annotation.remove();\r\n        });\r\n\r\n        //set math xml\r\n        elt.mathML = $elt.html();\r\n\r\n        //set ns:\r\n        elt.ns = {\r\n            name : 'm',\r\n            uri : 'http://www.w3.org/1998/Math/MathML'//@todo : remove hardcoding there\r\n        };\r\n\r\n        return elt;\r\n    }\r\n\r\n    function parseContainer($container, opts){\r\n\r\n        var options = _.merge(_.clone(_defaultOptions), opts || {});\r\n\r\n        var ret = {\r\n            serial : util.buildSerial('_container_'),\r\n            body : '',\r\n            elements : {}\r\n        };\r\n\r\n        _.each(_parsableElements, function(qtiClass){\r\n\r\n            $container.find(qtiClass).each(function(){\r\n\r\n                var $qtiElement = $(this);\r\n                var element = buildElement($qtiElement, opts);\r\n\r\n                ret.elements[element.serial] = element;\r\n                $qtiElement.replaceWith(_placeholder(element));\r\n\r\n            });\r\n\r\n        });\r\n\r\n        $container.find(_getElementSelector('math', options.ns.math)).each(function(){\r\n\r\n            var $qtiElement = $(this);\r\n            var element = buildMath($qtiElement, opts);\r\n\r\n            ret.elements[element.serial] = element;\r\n            $qtiElement.replaceWith(_placeholder(element));\r\n\r\n        });\r\n\r\n        $container.find(_getElementSelector('include', options.ns.include)).each(function(){\r\n\r\n            var $qtiElement = $(this);\r\n            var element = buildElement($qtiElement, opts);\r\n\r\n            ret.elements[element.serial] = element;\r\n            $qtiElement.replaceWith(_placeholder(element));\r\n\r\n        });\r\n\r\n        ret.body = $container.html();\r\n\r\n        return ret;\r\n    }\r\n\r\n    function _placeholder(element){\r\n        return '{{' + element.serial + '}}';\r\n    }\r\n\r\n    var parser = {\r\n        parse : function(xmlStr, options){\r\n\r\n            var $container = $(xmlStr);\r\n\r\n            var element = buildElement($container, options);\r\n\r\n            var data = parseContainer($container, options);\r\n\r\n            if(data.body !== undefined){\r\n                element.body = data;\r\n            }\r\n\r\n            if(_.isFunction(options.loaded) && options.model){\r\n                var loader = new Loader().setClassesLocation(options.model);\r\n                loader.loadAndBuildElement(element, options.loaded);\r\n            }\r\n\r\n            return element;\r\n        }\r\n    };\r\n\r\n    return parser;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiItem/helper/xincludeLoader',[\r\n    'jquery',\r\n    'lodash', \r\n    'taoQtiItem/qtiItem/helper/simpleParser',\r\n    'taoQtiItem/qtiItem/core/Loader'\r\n], function($, _, simpleParser, Loader){\r\n\r\n    function load(xinclude, baseUrl, callback){\r\n\r\n        var href = xinclude.attr('href');\r\n        if(href && baseUrl){\r\n\r\n            //require xml :\r\n            require(['text!' + baseUrl + href], function(stimulusXml){\r\n\r\n                var $wrapper = $('<div>').html(stimulusXml);\r\n                var $sampleXMLrootNode = $wrapper.children();\r\n                var $stimulus = $('<include>').append($sampleXMLrootNode);\r\n                var mathNs = 'm';//for 'http://www.w3.org/1998/Math/MathML'\r\n                var data = simpleParser.parse($stimulus, {\r\n                    ns : {\r\n                        math : mathNs\r\n                    }\r\n                });\r\n\r\n                (new Loader()).loadElement(xinclude, data, function(){\r\n                    if(_.isFunction(callback)){\r\n                        var loadedClasses = this.getLoadedClasses();\r\n                        loadedClasses.push('_container');//the _container class is always required\r\n                        callback(xinclude, data, loadedClasses);\r\n                    }\r\n                });\r\n\r\n            }, function(err){\r\n                //in case the file does not exist\r\n                callback(xinclude, false, []);\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    return {\r\n        load : load\r\n    };\r\n\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/xincludeRenderer',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/helper/commonRenderer',\r\n    'taoQtiItem/qtiItem/helper/xincludeLoader'\r\n], function(_, commonRenderer, xincludeLoader){\r\n    'use strict';\r\n\r\n    return {\r\n        /**\r\n         * Render (or re-render) the xinclude widget based on the current href and givenBaseUrl\r\n         *\r\n         * @param {Object} xincludeWidget\r\n         * @param {String} baseUrl\r\n         * @returns {undefined}\r\n         */\r\n        render : function render(xincludeWidget, baseUrl, newHref){\r\n\r\n            var xinclude = xincludeWidget.element;\r\n            if(newHref){\r\n                xinclude.attr('href', newHref);\r\n            }\r\n\r\n            xincludeLoader.load(xinclude, baseUrl, function(xi, data, loadedClasses){\r\n                if(data){\r\n                    //loading success :\r\n                    commonRenderer.get().load(function(){\r\n\r\n                        //set commonRenderer to the composing elements only (because xinclude is \"read-only\")\r\n                        _.each(xinclude.getComposingElements(), function(elt){\r\n                            elt.setRenderer(commonRenderer.get());\r\n                        });\r\n\r\n                        //reload the wiget to rfresh the rendering with the new href\r\n                        xincludeWidget.refresh();\r\n\r\n                    }, loadedClasses);\r\n                }else{\r\n                    //loading failure :\r\n                    xinclude.removeAttr('href');\r\n                }\r\n            });\r\n        }\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/insertInteractionButton', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    data-sub-group=\\\"\";\n  if (helper = helpers.subGroup) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.subGroup); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"\\r\\n    class=\\\"disabled\\\"\\r\\n    title=\\\"element available in the final release\\\"\\r\\n\";\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    title=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n\";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    <span class=\\\"icon \";\n  if (helper = helpers.icon) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.icon); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span>\\r\\n    \";\n  return buffer;\n  }\n\nfunction program9(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    <img class=\\\"icon\\\" src=\\\"\";\n  if (helper = helpers.icon) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.icon); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<li\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.subGroup), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    data-qti-class=\\\"\";\n  if (helper = helpers.qtiClass) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.qtiClass); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.disabled), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n>\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.iconFont), {hash:{},inverse:self.program(9, program9, data),fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \\r\\n    <div class=\\\"truncate\\\">\";\n  if (helper = helpers['short']) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0['short']); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</div>\\r\\n</li>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/insertInteractionGroup', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<section class=\\\"tool-group\\\" id=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <h2>\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h2>\\r\\n    <div class=\\\"panel clearfix\\\">\\r\\n        <ul class=\\\"tool-list plain\\\"></ul>\\r\\n    </div>\\r\\n</section>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/tooltip', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\\r\\n        \";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/interactionsToolbar',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'ui/hider',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/insertInteractionButton',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/insertInteractionGroup',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/tooltip',\r\n    'ui/tooltip'\r\n], function($, _, __, hider, insertInteractionTpl, insertSectionTpl, tooltipTpl, tooltip){\r\n    'use strict';\r\n\r\n    /**\r\n     * String to identify a custom interaction from the authoring data\r\n     * \r\n     * @type String\r\n     */\r\n    var _customInteractionTag = 'Custom Interactions';\r\n\r\n    /**\r\n     * Interaction types that require a sub group in the toolbar\r\n     * \r\n     * @type Object\r\n     */\r\n    var _subgroups = {\r\n        'inline-interactions' : 'Inline Interactions'\r\n    };\r\n\r\n    var _events = {\r\n        interactiontoolbarready : 'interactiontoolbarready.qti-widget'\r\n    };\r\n\r\n    function getGroupId(groupLabel){\r\n        return groupLabel.replace(/\\W+/g, '-').toLowerCase();\r\n    }\r\n\r\n    function getGroupSectionId(groupLabel){\r\n        return 'sidebar-left-section-' + getGroupId(groupLabel);\r\n    }\r\n\r\n    function addGroup($sidebar, groupLabel){\r\n\r\n        var groupId = getGroupSectionId(groupLabel);\r\n\r\n        var $section = $(insertSectionTpl({\r\n            id : groupId,\r\n            label : groupLabel\r\n        }));\r\n\r\n        $sidebar.append($section);\r\n\r\n        return $section;\r\n    }\r\n    \r\n    function create($sidebar, interactions){\r\n\r\n        _.each(interactions, function(interactionAuthoringData){\r\n            add($sidebar, interactionAuthoringData);\r\n        });\r\n\r\n        buildSubGroups($sidebar);\r\n\r\n        //set it ad \"ready\":\r\n        $sidebar.data('interaction-toolbar-ready', true);\r\n        $sidebar.trigger(_events.interactiontoolbarready);//interactiontoolbarready.qti-widget\r\n    }\r\n\r\n    function getGroup($sidebar, groupLabel){\r\n\r\n        var groupId = getGroupSectionId(groupLabel);\r\n        return $sidebar.find('#' + groupId);\r\n    }\r\n\r\n    function isReady($sidebar){\r\n        return !!$sidebar.data('interaction-toolbar-ready');\r\n    }\r\n\r\n    function whenReady($sidebar){\r\n        return new Promise(function(resolve){\r\n            if(isReady($sidebar)){\r\n                resolve();\r\n            }else{\r\n                $sidebar.on(_events.interactiontoolbarready, function(){\r\n                    resolve();\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n    function remove($sidebar, interactionClass){\r\n        $sidebar.find('li[data-qti-class=\"' + interactionClass + '\"]').remove();\r\n    }\r\n\r\n    function disable($sidebar, interactionClass){\r\n        hider.hide($sidebar.find('li[data-qti-class=\"' + interactionClass + '\"]'));\r\n    }\r\n\r\n    function enable($sidebar, interactionClass){\r\n        hider.show($sidebar.find('li[data-qti-class=\"' + interactionClass + '\"]'));\r\n    }\r\n    \r\n    function exists($sidebar, interactionClass){\r\n        return !!$sidebar.find('li[data-qti-class=\"' + interactionClass + '\"]').length;\r\n    }\r\n    \r\n    function add($sidebar, interactionAuthoringData){\r\n\r\n        if(exists($sidebar, interactionAuthoringData.qtiClass)){\r\n            throw 'the interaction is already in the sidebar';\r\n        }\r\n        \r\n        var groupLabel = interactionAuthoringData.tags[0] || '',\r\n            subGroupId = interactionAuthoringData.tags[1],\r\n            $group = getGroup($sidebar, groupLabel),\r\n            tplData = {\r\n                qtiClass : interactionAuthoringData.qtiClass,\r\n                disabled : !!interactionAuthoringData.disabled,\r\n                title : interactionAuthoringData.description,\r\n                iconFont : /^icon-/.test(interactionAuthoringData.icon),\r\n                icon : interactionAuthoringData.icon,\r\n                short : interactionAuthoringData.short,\r\n                dev : false\r\n            };\r\n\r\n        if(subGroupId && _subgroups[subGroupId]){\r\n            tplData.subGroup = subGroupId;\r\n        }\r\n\r\n        if(!$group.length){\r\n            //the group does not exist yet : create a <section> for the group\r\n            $group = addGroup($sidebar, groupLabel);\r\n        }\r\n\r\n        if(subGroupId && _subgroups[subGroupId]){\r\n            tplData.subGroup = subGroupId;\r\n        }\r\n\r\n        if(!$group.length){\r\n            //the group does not exist yet : create a <section> for the group\r\n            $group = addGroup($sidebar, groupLabel);\r\n        }\r\n        \r\n        var $interaction = $(insertInteractionTpl(tplData));\r\n        $group.find('.tool-list').append($interaction);\r\n        \r\n        return $interaction;\r\n    }\r\n\r\n    function buildSubGroups($sidebar){\r\n\r\n        $sidebar.find('[data-sub-group]').each(function(){\r\n\r\n            var $element = $(this),\r\n                $section = $element.parents('section'),\r\n                subGroup = $element.data('sub-group'),\r\n                $subGroupPanel,\r\n                $subGroupList,\r\n                $cover;\r\n\r\n            if(!subGroup){\r\n                return;\r\n            }\r\n\r\n            $subGroupPanel = $section.find('.sub-group.' + subGroup);\r\n            $subGroupList = $subGroupPanel.find('.tool-list');\r\n            if(!$subGroupPanel.length){\r\n                $subGroupPanel = $('<div>', {'class' : 'panel clearfix sub-group ' + subGroup});\r\n                $subGroupList = $('<ul>', {'class' : 'tool-list plain clearfix'});\r\n                $subGroupPanel.append($subGroupList);\r\n                $section.append($subGroupPanel);\r\n                $cover = $('<div>', {'class' : 'sub-group-cover blocking'});\r\n                $subGroupPanel.append($cover);\r\n                $subGroupPanel.data('cover', $cover);\r\n            }\r\n            $subGroupList.append($element);\r\n        });\r\n\r\n        addInlineInteractionTooltip();\r\n    }\r\n\r\n    /**\r\n     * add tooltip to explain special requirement and behaviours for inline interactions\r\n     * may need to generalize it in the future\r\n     */\r\n    function addInlineInteractionTooltip(){\r\n\r\n        var timer,\r\n            $inlineInteractionsPanel = $('#sidebar-left-section-inline-interactions .inline-interactions'),\r\n            $tooltip = $(tooltipTpl({\r\n                message : __('Inline interactions need to be inserted into a text block.')\r\n            }));\r\n\r\n        $inlineInteractionsPanel.append($tooltip);\r\n        tooltip($inlineInteractionsPanel);\r\n\r\n        $tooltip.css({\r\n            position : 'absolute',\r\n            zIndex : 11,\r\n            top : 0,\r\n            right : 10\r\n        });\r\n\r\n        $inlineInteractionsPanel.on('mouseenter', '.sub-group-cover', function(){\r\n\r\n            timer = setTimeout(function(){\r\n                $tooltip.find('[data-tooltip]').qtip('show');\r\n            }, 300);\r\n\r\n        }).on('mouseleave', '.sub-group-cover', function(){\r\n            $tooltip.find('[data-tooltip]').qtip('hide');\r\n            clearTimeout(timer);\r\n        });\r\n    }\r\n\r\n    return {\r\n        create : create,\r\n        add : add,\r\n        exists : exists,\r\n        addGroup : addGroup,\r\n        getGroupId : getGroupId,\r\n        getGroupSectionId : getGroupSectionId,\r\n        getGroup : getGroup,\r\n        isReady : isReady,\r\n        whenReady : whenReady,\r\n        remove : remove,\r\n        disable : disable,\r\n        enable : enable,\r\n        getCustomInteractionTag : function(){\r\n            return _customInteractionTag;\r\n        }\r\n    };\r\n\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/panel',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element'\r\n], function($, _, Element){\r\n    \"use strict\";\r\n\r\n    var _getItemContainer = function(){\r\n        return $('#item-editor-panel');\r\n    };\r\n\r\n    var showPanel = function($panel, $fold){\r\n\r\n        $panel.show();\r\n        openSections($panel.children('section'));\r\n\r\n        if($fold && $fold.length){\r\n            closeSections($fold.children('section'));\r\n        }\r\n    };\r\n\r\n    var initFormVisibilityListener = function(){\r\n\r\n        //first of all, clear all listener\r\n        $(document).off('.panel');\r\n\r\n        var $itemContainer = _getItemContainer();\r\n\r\n        var _staticElements = {\r\n            img : 'Image',\r\n            object : 'Media',\r\n            rubricBlock : 'Rubric Block',\r\n            math : 'Math',\r\n            include : 'Shared Stimulus',\r\n            infoControl : 'Student Tool',\r\n        };\r\n\r\n        // all sections on the right sidebar are invisible by default\r\n        var $formInteractionPanel = $('#item-editor-interaction-property-bar'),\r\n            $formChoicePanel = $('#item-editor-choice-property-bar'),\r\n            $formResponsePanel = $('#item-editor-response-property-bar'),\r\n            $formItemPanel = $('#item-editor-item-property-bar'),\r\n            $formBodyElementPanel = $('#item-editor-body-element-property-bar'),\r\n            $formTextBlockPanel = $('#item-editor-text-property-bar'),\r\n            $formModalFeedbackPanel = $('#item-editor-modal-feedback-property-bar'),\r\n            $formStylePanel = $('#item-style-editor-bar'),\r\n            $appearanceToggler = $('#appearance-trigger'),\r\n            $menuLabel = $appearanceToggler.find('.menu-label'),\r\n            $itemIcon = $appearanceToggler.find('.icon-item'),\r\n            $styleIcon = $appearanceToggler.find('.icon-style');\r\n\r\n        var _toggleAppearanceEditor = function(active){\r\n\r\n            if(active){\r\n\r\n                $appearanceToggler.addClass('active');\r\n                $formStylePanel.show();\r\n                $formItemPanel.hide();\r\n\r\n                //current widget sleep:\r\n                $itemContainer.trigger('styleedit');\r\n\r\n                /* At the time of writing this the following sections are available:\r\n                 *\r\n                 * #sidebar-left-section-text\r\n                 * #sidebar-left-section-block-interactions\r\n                 * #sidebar-left-section-inline-interactions\r\n                 * #sidebar-left-section-graphic-interactions\r\n                 * #sidebar-left-section-media\r\n                 * #sidebar-right-css-manager\r\n                 * #sidebar-right-style-editor\r\n                 * #sidebar-right-item-properties\r\n                 * #sidebar-right-body-element-properties\r\n                 * #sidebar-right-text-block-properties\r\n                 * #sidebar-right-interaction-properties\r\n                 * #sidebar-right-choice-properties\r\n                 * #sidebar-right-response-properties\r\n                 */\r\n                showPanel($formStylePanel);\r\n                $menuLabel.text($menuLabel.data('item'));\r\n                $itemIcon.show();\r\n                $styleIcon.hide();\r\n            }else{\r\n                $appearanceToggler.removeClass('active');\r\n                $formStylePanel.hide();\r\n                showPanel($formItemPanel);\r\n                $menuLabel.text($menuLabel.data('style'));\r\n                $itemIcon.hide();\r\n                $styleIcon.show();\r\n            }\r\n        };\r\n\r\n        $appearanceToggler.on('click', function(){\r\n\r\n            if($appearanceToggler.hasClass('active')){\r\n                _toggleAppearanceEditor(false);\r\n            }else{\r\n                _toggleAppearanceEditor(true);\r\n            }\r\n        });\r\n\r\n        //@todo : fix this timeout event\r\n        _.delay(function(){\r\n            showPanel($formItemPanel);\r\n        }, 200);\r\n\r\n        $(document).on('afterStateInit.qti-widget.panel', function(e, element, state){\r\n\r\n            switch(state.name){\r\n                case 'active':\r\n\r\n                    _toggleAppearanceEditor(false);\r\n                    if(!Element.isA(element, 'assessmentItem')){\r\n                        $formItemPanel.hide();\r\n                    }\r\n\r\n                    var label = _staticElements[element.qtiClass];\r\n                    if(label){\r\n                        $formBodyElementPanel.find('h2').html(label + ' Properties');\r\n                        showPanel($formBodyElementPanel);\r\n                    }else if(element.qtiClass === '_container'){\r\n                        showPanel($formTextBlockPanel);\r\n                    }\r\n\r\n                    if(element.qtiClass === 'modalFeedback'){\r\n                        showPanel($formModalFeedbackPanel);\r\n                        $formResponsePanel.hide();\r\n                    }\r\n                    break;\r\n\r\n                case 'question':\r\n\r\n                    showPanel($formInteractionPanel);\r\n                    break;\r\n\r\n                case 'answer':\r\n\r\n                    showPanel($formResponsePanel);\r\n                    break;\r\n\r\n                case 'choice':\r\n                    showPanel($formChoicePanel, $formInteractionPanel);\r\n                    break;\r\n\r\n                case 'sleep':\r\n\r\n                    if(_staticElements[element.qtiClass]){\r\n                        $formBodyElementPanel.hide();\r\n                    }else if(element.qtiClass === '_container'){\r\n                        $formTextBlockPanel.hide();\r\n                    }\r\n\r\n                    if(!Element.isA(element, 'choice')){\r\n                        if(!$itemContainer.find('.widget-box.edit-active').length){\r\n                            showPanel($formItemPanel);\r\n                        }\r\n                    }\r\n                    break;\r\n            }\r\n\r\n        }).on('afterStateExit.qti-widget.panel', function(e, element, state){\r\n\r\n            switch(state.name){\r\n                case 'active':\r\n                    if(element.qtiClass === 'modalFeedback'){\r\n                        showPanel($formResponsePanel);\r\n                        $formModalFeedbackPanel.hide();\r\n                    }\r\n                    break;\r\n                case 'question':\r\n                    if(element.is('interaction')){\r\n                        $formChoicePanel.hide();\r\n                        $formInteractionPanel.hide();\r\n                    }\r\n                    break;\r\n                case 'choice':\r\n                    $formChoicePanel.hide();\r\n                    showPanel($formInteractionPanel);\r\n                    break;\r\n                case 'answer':\r\n                    $formResponsePanel.hide();\r\n                    break;\r\n            }\r\n\r\n        }).on('elementCreated.qti-widget.panel', function(e, data){\r\n\r\n            if(data.element.qtiClass === '_container'){\r\n                enableSubGroup('inline-interactions');\r\n            }\r\n\r\n        }).on('deleted.qti-widget.panel', function(e, data){\r\n\r\n            if(data.element.qtiClass === '_container'){\r\n                toggleInlineInteractionGroup();\r\n            }\r\n\r\n        });\r\n    };\r\n\r\n    var toggleInlineInteractionGroup = function(){\r\n\r\n        var $itemContainer = _getItemContainer();\r\n        if($itemContainer.find('.widget-textBlock').length){\r\n            enableSubGroup('inline-interactions');\r\n        }else{\r\n            disableSubGroup('inline-interactions');\r\n        }\r\n    };\r\n\r\n    // selectors and classes\r\n    var heading = 'h2',\r\n        section = 'section',\r\n        panel = 'hr, .panel',\r\n        closed = 'closed',\r\n        ns = 'accordion';\r\n\r\n    var initSidebarAccordion = function($sidebar){\r\n\r\n        var $sections = $sidebar.find(section),\r\n            $allPanels = $sidebar.children(panel).hide(),\r\n            $allTriggers = $sidebar.find(heading);\r\n\r\n        if($allTriggers.length === 0){\r\n            return true;\r\n        }\r\n\r\n        // setup events\r\n        $allTriggers.each(function(){\r\n            var $heading = $(this),\r\n                $section = $heading.parents(section),\r\n                $panel = $section.children(panel),\r\n                $closer = $('<span>', {'class' : 'icon-up'}),\r\n                $opener = $('<span>', {'class' : 'icon-down'}),\r\n                action = $panel.is(':visible') ? 'open' : 'close';\r\n\r\n            $heading.append($closer).append($opener).addClass(closed);\r\n\r\n            // this allows multiple calls, required when blocks are added dynamically\r\n            if($heading.hasClass('_accordion')) {\r\n                return;\r\n            }\r\n            else {\r\n                $heading.addClass('_accordion');\r\n            }\r\n\r\n            // toggle heading class arrow (actually switch arrow)\r\n            $panel.on('panelclose.' + ns + ' panelopen.' + ns, function(e, args){\r\n                var fn = e.type === 'panelclose' ? 'add' : 'remove';\r\n                args.heading[fn + 'Class'](closed);\r\n            });\r\n\r\n            $panel.trigger('panel' + action + '.' + ns, {heading : $heading});\r\n\r\n        });\r\n\r\n        $sections.each(function(){\r\n\r\n            // assign click action to headings\r\n            $(this).find(heading).on('click', function(e, args){\r\n\r\n                var $heading = $(this),\r\n                    $panel = $heading.parents(section).children(panel),\r\n                    preserveOthers = !!(args && args.preserveOthers),\r\n                    actions = {\r\n                        close : 'hide',\r\n                        open : 'fadeIn'\r\n                    },\r\n                action,\r\n                    forceState = (args && args.forceState ? args.forceState : false),\r\n                    classFn;\r\n\r\n                if(forceState){\r\n                    classFn = forceState === 'open' ? 'addClass' : 'removeClass';\r\n                    $heading[classFn](closed);\r\n                }\r\n\r\n                action = $heading.hasClass(closed) ? 'open' : 'close';\r\n\r\n                // whether or not to close other sections in the same sidebar\r\n                // @todo (optional): remove 'false' in the condition below\r\n                // to change the style to accordion, i.e. to allow for only one open section\r\n                if(false && !preserveOthers){\r\n                    $allPanels.not($panel).each(function(){\r\n                        var $panel = $(this),\r\n                            $heading = $panel.parent().find(heading),\r\n                            _action = 'close';\r\n\r\n                        $panel.trigger('panel' + _action + '.' + ns, {heading : $heading})[actions[_action]]();\r\n                    });\r\n                }\r\n\r\n                $panel.trigger('panel' + action + '.' + ns, {heading : $heading})[actions[action]]();\r\n            });\r\n\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Toggle section display\r\n     *\r\n     * @param sections\r\n     */\r\n    var _toggleSections = function(sections, preserveOthers, state){\r\n        sections.each(function(){\r\n            $(this).find(heading).trigger('click', {preserveOthers : preserveOthers, forceState : state});\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Close specific sections\r\n     *\r\n     * @param sections\r\n     */\r\n    var closeSections = function(sections, preserveOthers){\r\n        _toggleSections(sections, !!preserveOthers, 'close');\r\n    };\r\n\r\n    /**\r\n     * Open specific sections\r\n     *\r\n     * @param sections\r\n     */\r\n    var openSections = function(sections, preserveOthers){\r\n        _toggleSections(sections, !!preserveOthers, 'open');\r\n    };\r\n\r\n    /**\r\n     * toggle availability of sub group\r\n     * @param subGroup\r\n     */\r\n    var _toggleSubGroup = function(subGroup, state){\r\n        subGroup = $('.' + subGroup);\r\n        if(subGroup.length){\r\n            var fn = state === 'disable' ? 'addClass' : 'removeClass';\r\n            subGroup.data('cover')[fn]('blocking');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * enable sub group\r\n     * @param subGroup\r\n     */\r\n    var enableSubGroup = function(subGroup){\r\n        _toggleSubGroup(subGroup, 'enable');\r\n    };\r\n\r\n    /**\r\n     * disable sub group\r\n     * @param subGroup\r\n     */\r\n    var disableSubGroup = function(subGroup){\r\n        _toggleSubGroup(subGroup, 'disable');\r\n    };\r\n\r\n    return {\r\n        initFormVisibilityListener : initFormVisibilityListener,\r\n        showPanel : showPanel,\r\n        toggleInlineInteractionGroup : toggleInlineInteractionGroup,\r\n        initSidebarAccordion : initSidebarAccordion,\r\n        openSections : openSections,\r\n        closeSections : closeSections,\r\n        enableSubGroup : enableSubGroup,\r\n        disableSubGroup : disableSubGroup\r\n    };\r\n\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n/**\r\n * This module let's you set up the interaction panel\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/interactionsPanel',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/editor/interactionsToolbar',\r\n    'taoQtiItem/qtiCreator/helper/panel',\r\n    'taoQtiItem/qtiCreator/helper/qtiElements',\r\n    'taoQtiItem/portableElementRegistry/ciRegistry'\r\n], function(_, interactionsToolbar, panel, qtiElements, ciRegistry){\r\n    'use strict';\r\n\r\n    /**\r\n     * Set up the interaction selection panel\r\n     * @param {jQueryElement} $container - the panel container\r\n     */\r\n    return function setUpInteractionPanel($container){\r\n\r\n        var interactions = qtiElements.getAvailableAuthoringElements();\r\n\r\n        _.forIn(ciRegistry.getAllVersions(), function(versions, typeId){\r\n            var data = ciRegistry.getAuthoringData(typeId, {enabledOnly : true});\r\n            if(data && data.tags && data.tags[0] === interactionsToolbar.getCustomInteractionTag()){\r\n                interactions[data.qtiClass] = data;\r\n            }\r\n        });\r\n\r\n        //create toolbar:\r\n        interactionsToolbar.create($container, interactions);\r\n\r\n        //init accordions:\r\n        panel.initSidebarAccordion($container);\r\n        panel.closeSections($container.find('section'));\r\n        panel.openSections($container.find('#sidebar-left-section-common-interactions'), false);\r\n\r\n        //init special subgroup\r\n        panel.toggleInlineInteractionGroup();\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/cssToggler', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n<li data-css-res=\\\"\";\n  if (helper = helpers.path) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.path); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"icon-preview style-sheet-toggler\\\" title=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span>\\r\\n    <span class=\\\"file-label truncate\\\" title=\\\"\";\n  if (helper = helpers.editLabelTxt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.editLabelTxt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\r\\n    <input type=\\\"text\\\" class=\\\"style-sheet-label-editor\\\" value=\\\"\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"icon-bin\\\" title=\\\"\";\n  if (helper = helpers.deleteTxt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.deleteTxt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-role=\\\"css-delete\\\"></span>\\r\\n    <span class=\\\"icon-download\\\" title=\\\"\";\n  if (helper = helpers.downloadTxt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.downloadTxt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-role=\\\"css-download\\\"></span>\\r\\n</li>\\r\\n\";\n  return buffer;\n  }\n\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.stylesheets), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n/**\r\n *\r\n * @author dieter <dieter@taotesting.com>\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/editor/styleEditor/styleEditor',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'urlParser',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/cssToggler',\r\n    'jquery.fileDownload'\r\n], function ($, _, __, UrlParser, Promise, cssTpl) {\r\n    'use strict';\r\n\r\n    var itemConfig;\r\n\r\n    /**\r\n     * qtiItemCreator config provided from QtiCreator\r\n     * used for generation of the ajax uri\r\n     */\r\n    var globalConfig;\r\n\r\n    /**\r\n     * generate Ajax URI\r\n     * @param action\r\n     * @returns {*}\r\n     */\r\n    var _getUri = function(action) {\r\n        return globalConfig[action + 'CssUrl'];\r\n    };\r\n\r\n    /**\r\n     * Extract the file name from a path\r\n     * @param path\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    var _basename = function(path) {\r\n        return path.substring(path.lastIndexOf('/') + 1);\r\n    };\r\n\r\n    // stylesheet as object\r\n    var style = {},\r\n        // DOM element to hold the style\r\n        $styleElem = (function () {\r\n            var styleElem = $('#item-editor-user-styles');\r\n            if(!styleElem.length) {\r\n                styleElem = $('<style>', { id : 'item-editor-user-styles' } );\r\n                $('head').append(styleElem);\r\n            }\r\n            else {\r\n                styleElem.empty();\r\n            }\r\n            return styleElem;\r\n        }()),\r\n        currentItem,\r\n        common = {\r\n            title: __('Disable this stylesheet temporarily'),\r\n            deleteTxt: __('Remove this stylesheet'),\r\n            editLabelTxt: __('Edit stylesheet label'),\r\n            downloadTxt: __('Download this stylesheet'),\r\n            preparingMessageHtml: __('Preparing CSS, please wait…'),\r\n            failMessageHtml: __('There was a problem downloading your CSS, please try again.'),\r\n            isInValidLocalTxt: __('This stylesheet has not been found on the server. you may want to delete this reference')\r\n        },\r\n        customStylesheet = '';\r\n\r\n    /**\r\n     * Delete all custom styles\r\n     */\r\n    var erase = function() {\r\n        style = {};\r\n        $styleElem.text('');\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * Create CSS and add it to DOM\r\n     *\r\n     * @param dontAppend whether or not to append the stylesheet to the DOM. This is used by the iframe preview\r\n     */\r\n    var create = function(dontAppend) {\r\n\r\n        var key1, // first level key, could be selector or media query\r\n            key2, // second level key, could be css property or selector\r\n            mSelector, // selector inside a media query\r\n            mProp, // property inside a media query\r\n            css = '';\r\n\r\n        if(_.isEmpty(style)){\r\n            return erase();\r\n        }\r\n\r\n        // rebuild CSS\r\n        for (key1 in style) {\r\n            if (!style.hasOwnProperty(key1)) {\r\n                continue;\r\n            }\r\n\r\n            css += key1 + '{';\r\n            for (key2 in style[key1]) {\r\n                if (!style[key1].hasOwnProperty(key2)) {\r\n                    continue;\r\n                }\r\n                // in the case of a surrounding media query\r\n                if (_.isPlainObject(style[key1][key2])) {\r\n                    for (mSelector in style[key1][key2]) {\r\n                        css += key2 + '{';\r\n                        for (mProp in style[key1][key2]) {\r\n                            css += mProp + ':' + style[key1][key2][mSelector] + ';';\r\n                        }\r\n                        css += '}';\r\n                    }\r\n                }\r\n                // regular selectors\r\n                else {\r\n                    css += key2 + ':' + style[key1][key2] + ';';\r\n                }\r\n            }\r\n            css += '}\\n';\r\n        }\r\n\r\n        if(!dontAppend) {\r\n            $styleElem.text(css);\r\n        }\r\n        return css;\r\n\r\n    };\r\n\r\n    /**\r\n        * Apply rule to CSS\r\n        *\r\n        * @param {{string}} selector\r\n        * @param {{string}} property\r\n        * @param {{string}} value\r\n        */\r\n    var apply = function (selector, property, value) {\r\n        style[selector] = style[selector] || {};\r\n\r\n        // delete this rule\r\n        if (!value) {\r\n            delete(style[selector][property]);\r\n            if(_.size(style[selector]) === 0) {\r\n                delete(style[selector]);\r\n            }\r\n        }\r\n        // add this rule\r\n        else {\r\n            style[selector][property] = value;\r\n        }\r\n\r\n        // apply rule\r\n        create();\r\n\r\n        /**\r\n            * Fires a change notification on the item style\r\n            * @event taoQtiItem/qtiCreator/editor/styleEditor/styleEditor#stylechange.qti-creator\r\n            * @property {Object} [detail] An object providing some additional detail on the event\r\n            * @property {Boolean} [detail.initializing] Tells if the stylechange occurs at init time\r\n            */\r\n        $(document).trigger('stylechange.qti-creator');\r\n    };\r\n\r\n    /**\r\n     * Has the class been initialized\r\n     *\r\n     * @returns {boolean}\r\n     */\r\n    var verifyInit = function verifyInit() {\r\n        if(!itemConfig) {\r\n            throw new Error('Missing itemConfig, did you call styleEditor.init()?');\r\n        }\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Save the resulting CSS to a file\r\n     *TODO saving mechanism should be indenpendant, ie. moved into the itemCreator, in order to configure endpoint, etc.\r\n     * @returns {Promise}\r\n     */\r\n    var save = function save () {\r\n        return new Promise(function (resolve, reject){\r\n            verifyInit();\r\n            $.post(_getUri('save'), _.extend({}, itemConfig,{\r\n                cssJson: JSON.stringify(style),\r\n                stylesheetUri: customStylesheet.attr('href')\r\n            }))\r\n            .done(resolve)\r\n            .fail(function(xhr, status, err){\r\n                reject(err);\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n        * Download CSS as file\r\n        */\r\n    var download = function(uri) {\r\n        verifyInit();\r\n        $.fileDownload(_getUri('download'), {\r\n            preparingMessageHtml: common.preparingMessageHtml,\r\n            failMessageHtml: common.failMessageHtml,\r\n            successCallback: function () { },\r\n            httpMethod: 'POST',\r\n            data: _.extend({}, itemConfig, { stylesheetUri: uri })\r\n        });\r\n    };\r\n\r\n    /**\r\n        * Add a single stylesheet, the custom stylesheet will be loaded as object\r\n        *\r\n        * @param stylesheet\r\n        * @returns {*} promise\r\n        */\r\n    var addStylesheet = function(stylesheet) {\r\n\r\n        var fileName,\r\n            link,\r\n            stylesheets = [],\r\n            listEntry,\r\n            parser,\r\n            loadStylesheet = function(link, stylesheet, isLocal, isValid) {\r\n\r\n                // in the given scenario we cannot test whether a remote stylesheet really exists\r\n                // this would require to pipe all remote css via php curl\r\n                var isInvalidLocal = isLocal && !isValid,\r\n                    tplData = {\r\n                        path: stylesheet.attr('href'),\r\n                        label: (stylesheet.attr('title') || fileName),\r\n                        title: common.title,\r\n                        deleteTxt: common.deleteTxt,\r\n                        downloadTxt: common.downloadTxt,\r\n                        editLabelTxt: isInvalidLocal ? common.isInValidLocalTxt : common.editLabelTxt\r\n                    };\r\n\r\n                stylesheets.push(tplData);\r\n\r\n                // create list entry\r\n                listEntry = $(cssTpl({ stylesheets: stylesheets }));\r\n\r\n                listEntry.data('stylesheetObj', stylesheet);\r\n\r\n                // initialize download button\r\n                $('#style-sheet-toggler').append(listEntry);\r\n\r\n                if(isInvalidLocal) {\r\n                    listEntry.addClass('not-available');\r\n                    listEntry.find('[data-role=\"css-download\"], .style-sheet-toggler').css('visibility', 'hidden');\r\n                    return;\r\n                }\r\n\r\n                $styleElem.before(link);\r\n\r\n                // time difference between loading the css file and applying the styles\r\n                setTimeout(function() {\r\n                    var isInit = false;\r\n\r\n                    $(document).trigger('customcssloaded.styleeditor', [style]);\r\n                    $(window).trigger('resize');\r\n                    if (currentItem.pendingStylesheetsInit) {\r\n                        isInit = true;\r\n                        currentItem.pendingStylesheetsInit --;\r\n                    }\r\n\r\n                    /**\r\n                     * Fires a change notification on the item style\r\n                     * @event taoQtiItem/qtiCreator/editor/styleEditor/styleEditor#stylechange.qti-creator\r\n                     * @property {Object} [detail] An object providing some additional detail on the event\r\n                     * @property {Boolean} [detail.initializing] Tells if the stylechange occurs at init time\r\n                     */\r\n                    $(document).trigger('stylechange.qti-creator', [{initializing: isInit}]);\r\n                }, isLocal ? 500 : 3500);\r\n\r\n            };\r\n\r\n        // argument is uri\r\n        if(_.isString(stylesheet)) {\r\n            stylesheet = currentItem.createStyleSheet(stylesheet);\r\n        }\r\n\r\n\r\n        fileName = _basename(stylesheet.attr('href'));\r\n        // link with cache buster\r\n        link = (function() {\r\n            var _link = $(stylesheet.render()),\r\n                _href = _link.attr('href'),\r\n                _sep  = _href.indexOf('?') > -1 ? '&' : '?';\r\n            _link.attr('href', _href + _sep + (new Date().getTime()).toString());\r\n            return _link;\r\n        }());\r\n\r\n        // cache css before applying allows for a pretty good guess\r\n        // when the stylesheet is loaded and the buttons in the style editor\r\n        // can be changed\r\n        parser = new UrlParser(link.attr('href'));\r\n        if (parser.checkCORS()) {\r\n            $.when($.ajax(link.attr('href'))).then(function() {\r\n                loadStylesheet(link, stylesheet, true, true);\r\n            },\r\n            // add file to list even on failure to be able to remove it from the item\r\n            function() {\r\n                loadStylesheet(link, stylesheet, true, false);\r\n            });\r\n        }\r\n        // otherwise load it with a big timeout and hope for the best\r\n        // unfortunately this dirty way is the only possibility in cross domain environments\r\n        else {\r\n            loadStylesheet(link, stylesheet, false);\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * Add style sheets to toggler\r\n     * @param item\r\n     */\r\n    var addItemStylesheets = function() {\r\n        var key;\r\n        var currentStylesheet;\r\n        currentItem.pendingStylesheetsInit = _.size(currentItem.stylesheets);\r\n\r\n        for(key in currentItem.stylesheets) {\r\n            if(!currentItem.stylesheets.hasOwnProperty(key)) {\r\n                continue;\r\n            }\r\n\r\n            currentStylesheet = currentItem.stylesheets[key];\r\n\r\n            if('tao-user-styles.css' === _basename(currentStylesheet.attr('href'))) {\r\n                customStylesheet = currentStylesheet;\r\n                continue;\r\n            }\r\n\r\n            // add those that are loaded synchronously\r\n            addStylesheet(currentItem.stylesheets[key]);\r\n        }\r\n\r\n        // if no custom css had been found, add empty stylesheet anyway\r\n        if(!customStylesheet) {\r\n            customStylesheet = currentItem.createStyleSheet('style/custom/tao-user-styles.css');\r\n        }\r\n    };\r\n\r\n    /**\r\n      * Remove orphaned stylesheets. These would be present if previously another item has been edited\r\n      */\r\n    var removeOrphanedStylesheets = function() {\r\n        $('link[data-serial]').remove();\r\n    };\r\n\r\n    /**\r\n     * retrieve the current item\r\n     *\r\n     * @returns {*}\r\n     */\r\n    var getItem = function() {\r\n        return currentItem;\r\n    };\r\n\r\n\r\n    /**\r\n     * Initialize class\r\n     * @param config\r\n     */\r\n    var init = function(item, config) {\r\n        var resizerTarget;\r\n        var href;\r\n\r\n        globalConfig = config;\r\n        // promise\r\n        currentItem = item;\r\n\r\n        //prepare config object (don't pass all of them, otherwise, $.param will break)\r\n        itemConfig = {\r\n            uri : config.uri,\r\n            lang : config.lang,\r\n            baseUrl : config.baseUrl\r\n        };\r\n\r\n        removeOrphanedStylesheets();\r\n\r\n        // this creates at the same time customStylesheet in case it doesn't exist yet\r\n        addItemStylesheets();\r\n\r\n        resizerTarget = $('#item-editor-item-resizer').data('target');\r\n        href = customStylesheet.attr('href');\r\n\r\n        currentItem.data('responsive', true);\r\n\r\n        $.when(\r\n            $.getJSON (\r\n                _getUri('load'),\r\n                _.extend({}, itemConfig, { stylesheetUri: href })\r\n            )\r\n        ).then(function(_style) {\r\n            // copy style to global style\r\n            style = _style;\r\n\r\n            // apply rules\r\n            create();\r\n\r\n            // reset meta in case the width is set in the custom stylesheet\r\n            if(style.length){\r\n                currentItem.data('responsive', !!(style[resizerTarget] && style[resizerTarget].width));\r\n            }\r\n\r\n            // inform editors about custom sheet\r\n            $(document).trigger('customcssloaded.styleeditor', [style]);\r\n        });\r\n    };\r\n\r\n    var getStyle = function() {\r\n        return style;\r\n    };\r\n\r\n    return {\r\n        apply: apply,\r\n        save: save,\r\n        download: download,\r\n        erase: erase,\r\n        init: init,\r\n        create: create,\r\n        getItem: getItem,\r\n        getStyle: getStyle,\r\n        addStylesheet: addStylesheet\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/notifications/genericFeedbackPopup', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div class=\\\"feedback-\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \" popup\\\">\\r\\n    <span class=\\\"icon-\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span>\\r\\n    \";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove Message\", options) : helperMissing.call(depth0, \"__\", \"Remove Message\", options)))\n    + \"\\\" class=\\\"icon-close close-trigger\\\"></span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/styleEditor/styleSheetToggler',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor',\r\n    'i18n',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/Stylesheet',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/notifications/genericFeedbackPopup',\r\n    'ui/resourcemgr'\r\n], function ($, styleEditor, __, _, Stylesheet, genericFeedbackPopup) {\r\n    'use strict';\r\n\r\n    var $doc = $(document);\r\n\r\n    var styleSheetToggler = (function () {\r\n\r\n        var init = function (itemConfig) {\r\n\r\n            var cssToggler = $('#style-sheet-toggler'),\r\n                uploader = $('#stylesheet-uploader'),\r\n                customCssToggler = $('[data-custom-css]'),\r\n                getContext = function (trigger) {\r\n                    trigger = $(trigger);\r\n                    var li = trigger.closest('li'),\r\n                        stylesheetObj = li.data('stylesheetObj') || new Stylesheet({href : li.data('css-res')}),\r\n                        input = li.find('.style-sheet-label-editor'),\r\n                        labelBox = input.prev('.file-label'),\r\n                        label = input.val();\r\n\r\n                    return {\r\n                        li: li,\r\n                        input: input,\r\n                        label: label,\r\n                        labelBox: labelBox,\r\n                        isCustomCss: !!li.data('custom-css'),\r\n                        isDisabled: li.find('.icon-preview').hasClass('disabled'),\r\n                        stylesheetObj: stylesheetObj,\r\n                        cssUri: stylesheetObj.attr('href')\r\n                    };\r\n                };\r\n\r\n\r\n\r\n            /**\r\n             * Upload custom stylesheets\r\n             */\r\n            uploader.on('click', function () {\r\n\r\n                uploader.resourcemgr({\r\n                    appendContainer: '#mediaManager',\r\n                    path: '/',\r\n                    root: 'local',\r\n                    browseUrl: itemConfig.getFilesUrl,\r\n                    uploadUrl: itemConfig.fileUploadUrl,\r\n                    deleteUrl: itemConfig.fileDeleteUrl,\r\n                    downloadUrl: itemConfig.fileDownloadUrl,\r\n                    fileExistsUrl : itemConfig.fileExistsUrl,\r\n                    params: {\r\n                        uri: itemConfig.uri,\r\n                        lang: itemConfig.lang,\r\n                        filters: 'text/css'\r\n                    },\r\n                    pathParam: 'path',\r\n                    select: function (e, files) {\r\n                        var i, l = files.length;\r\n                        for (i = 0; i < l; i++) {\r\n                            styleEditor.addStylesheet(files[i].file);\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n\r\n\r\n            /**\r\n             * Confirm to save the item\r\n             */\r\n            var deleteStylesheet = function(trigger) {\r\n                var context = getContext(trigger),\r\n                    attr = context.isDisabled ? 'disabled-href' : 'href',\r\n                    cssLinks = $('head link');\r\n\r\n\r\n                styleEditor.getItem().removeStyleSheet(context.stylesheetObj);\r\n\r\n                cssLinks.filter('[' + attr + '*=\"' + context.cssUri + '\"]').remove();\r\n                context.li.remove();\r\n\r\n                $('.feedback-info').hide();\r\n                _createInfoBox({\r\n                    message: __('Style Sheet <b>%s</b> removed<br> Click <i>Add Style Sheet</i> to re-apply.').replace('%s', context.label),\r\n                    type: 'info'\r\n                });\r\n\r\n                $doc.trigger('customcssloaded.styleeditor', [styleEditor.getStyle()]);\r\n            };\r\n\r\n\r\n            /**\r\n             * Modify stylesheet title (enable)\r\n             */\r\n            var initLabelEditor = function (trigger) {\r\n                var context = getContext(trigger);\r\n                context.labelBox.hide();\r\n                context.input.show();\r\n            };\r\n\r\n            /**\r\n             * Download current stylesheet\r\n             *\r\n             * @param trigger\r\n             */\r\n            var downloadStylesheet = function(trigger) {\r\n                styleEditor.download(getContext(trigger).cssUri);\r\n            };\r\n\r\n            /**\r\n             * Modify stylesheet title (save modification)\r\n             */\r\n            var saveLabel = function (trigger) {\r\n                var context = getContext(trigger),\r\n                    title = $.trim(context.input.val());\r\n\r\n                if (!title) {\r\n                    context.stylesheetObj.attr('title', '');\r\n                    return false;\r\n                }\r\n\r\n                context.stylesheetObj.attr('title', title);\r\n                context.input.hide();\r\n                context.labelBox.html(title).show();\r\n            };\r\n\r\n            /**\r\n             * Dis/enable style sheets\r\n             */\r\n            var handleAvailability = function (trigger) {\r\n                var context = getContext(trigger),\r\n                    link,\r\n                    attrTo = 'disabled-href',\r\n                    attrFrom = 'href';\r\n\r\n                // custom styles are handled in a style element, not in a link\r\n                if (context.isCustomCss) {\r\n                    if (context.isDisabled) {\r\n                        styleEditor.create();\r\n                        customCssToggler.removeClass('not-available');\r\n                    }\r\n                    else {\r\n                        styleEditor.erase();\r\n                        customCssToggler.addClass('not-available');\r\n                    }\r\n                }\r\n                // all other styles are handled via their link element\r\n                else {\r\n                    if (context.isDisabled) {\r\n                        attrTo = 'href';\r\n                        attrFrom = 'disabled-href';\r\n                    }\r\n\r\n                    link = $('link[' + attrFrom + '$=\"' + context.cssUri + '\"]');\r\n                    link.attr(attrTo, link.attr(attrFrom)).removeAttr(attrFrom);\r\n                }\r\n\r\n                // add some visual feed back to the triggers\r\n                $(trigger).toggleClass('disabled');\r\n            };\r\n\r\n            /**\r\n             * Distribute click events\r\n             */\r\n            cssToggler.on('click', function (e) {\r\n                var target = e.target,\r\n                    className = target.className;\r\n\r\n                // distribute click actions\r\n                if (className.indexOf('icon-bin') > -1) {\r\n                    deleteStylesheet(e.target);\r\n                }\r\n                else if (className.indexOf('file-label') > -1) {\r\n                    initLabelEditor(e.target);\r\n                }\r\n                else if (className.indexOf('icon-preview') > -1) {\r\n                    handleAvailability(e.target);\r\n                }\r\n                else if(className.indexOf('icon-download') > -1) {\r\n                    downloadStylesheet(e.target);\r\n                }\r\n            });\r\n\r\n\r\n            /**\r\n             * Handle renaming on enter\r\n             */\r\n            cssToggler.on('keydown', 'input', function (e) {\r\n                if (e.keyCode === 13) {\r\n                    $(e.target).trigger('blur');\r\n                }\r\n            });\r\n\r\n            /**\r\n             * Handle renaming on blur\r\n             */\r\n            cssToggler.on('blur', 'input', function (e) {\r\n                saveLabel(e.target);\r\n            });\r\n\r\n\r\n        };\r\n\r\n\r\n        var _createInfoBox = function(data){\r\n            var $messageBox = $(genericFeedbackPopup(data)),\r\n                closeTrigger = $messageBox.find('.close-trigger');\r\n\r\n            $('body').append($messageBox);\r\n\r\n            closeTrigger.on('click', function(){\r\n                $messageBox.fadeOut(function(){\r\n                    $(this).remove();\r\n                });\r\n            });\r\n\r\n            setTimeout(function() {\r\n                closeTrigger.trigger('click');\r\n            }, 4523);\r\n\r\n            return $messageBox;\r\n        };\r\n\r\n        return {\r\n            init: init\r\n        };\r\n\r\n    })();\r\n\r\n    return styleSheetToggler;\r\n});\r\n\r\n\n","\ndefine(\"json!taoQtiItem/qtiCreator/editor/resources/font-stacks.json\", function(){ return {\"sans-serif\":[\"Arial, \\\"Helvetica Neue\\\", Helvetica, sans-serif\",\"\\\"Avant Garde\\\", Avantgarde, \\\"Century Gothic\\\", CenturyGothic, \\\"AppleGothic\\\", sans-serif\",\"Calibri, Candara, Segoe, \\\"Segoe UI\\\", Optima, Arial, sans-serif\",\"Candara, Calibri, Segoe, \\\"Segoe UI\\\", Optima, Arial, sans-serif\",\"\\\"Century Gothic\\\", CenturyGothic, AppleGothic, sans-serif\",\"Corbel, \\\"Lucida Grande\\\", \\\"Lucida Sans Unicode\\\", \\\"Lucida Sans\\\", \\\"DejaVu Sans\\\", \\\"Bitstream Vera Sans\\\", \\\"Liberation Sans\\\", Verdana, \\\"Verdana Ref\\\", sans-serif\",\"\\\"Franklin Gothic Medium\\\", \\\"Franklin Gothic\\\", \\\"ITC Franklin Gothic\\\", Arial, sans-serif\",\"Frutiger, \\\"Frutiger Linotype\\\", Univers, Calibri, \\\"Gill Sans\\\", \\\"Gill Sans MT\\\", \\\"Myriad Pro\\\", Myriad, \\\"DejaVu Sans Condensed\\\", \\\"Liberation Sans\\\", \\\"Nimbus Sans L\\\", Tahoma, Geneva, \\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif\",\"Futura, \\\"Century Gothic\\\", AppleGothic, \\\"Trebuchet MS\\\", sans-serif\",\"Geneva, Verdana, \\\"Lucida Sans\\\", \\\"Lucida Grande\\\", \\\"Lucida Sans Unicode\\\", sans-serif\",\"\\\"Gill Sans\\\", \\\"Gill Sans MT\\\", Calibri, sans-serif\",\"\\\"Helvetica Neue\\\", Helvetica, Arial, sans-serif\",\"Impact, Haettenschweiler, \\\"Franklin Gothic Bold\\\", Charcoal, \\\"Helvetica Inserat\\\", \\\"Bitstream Vera Sans Bold\\\", \\\"Arial Black\\\", sans-serif\",\"\\\"Lucida Grande\\\", \\\"Lucida Sans Unicode\\\", \\\"Lucida Sans\\\", Geneva, Verdana, sans-serif\",\"Optima, Segoe, \\\"Segoe UI\\\", Candara, Calibri, Arial, sans-serif\",\"\\\"Segoe UI\\\", Candara, \\\"Bitstream Vera Sans\\\", \\\"DejaVu Sans\\\", \\\"Bitstream Vera Sans\\\", \\\"Trebuchet MS\\\", Verdana, \\\"Verdana Ref\\\", sans-serif\",\"Tahoma, Verdana, Segoe, sans-serif\",\"\\\"Trebuchet MS\\\", \\\"Lucida Grande\\\", \\\"Lucida Sans Unicode\\\", \\\"Lucida Sans\\\", Tahoma, sans-serif\",\"Verdana, Geneva, Tahoma, sans-serif\"],\"serif\":[\"Baskerville, \\\"Baskerville Old Face\\\", \\\"Hoefler Text\\\", Garamond, \\\"Times New Roman\\\", serif\",\"\\\"Big Caslon\\\", \\\"Book Antiqua\\\", \\\"Palatino Linotype\\\", Georgia, serif\",\"\\\"Bodoni MT\\\", Didot, \\\"Didot LT STD\\\", \\\"Hoefler Text\\\", Garamond, \\\"Times New Roman\\\", serif\",\"\\\"Book Antiqua\\\", Palatino, \\\"Palatino Linotype\\\", \\\"Palatino LT STD\\\", Georgia, serif\",\"\\\"Calisto MT\\\", \\\"Bookman Old Style\\\", Bookman, \\\"Goudy Old Style\\\", Garamond, \\\"Hoefler Text\\\", \\\"Bitstream Charter\\\", Georgia, serif\",\"Cambria, \\\"Hoefler Text\\\", Utopia, \\\"Liberation Serif\\\", \\\"Nimbus Roman No9 L Regular\\\", Times, \\\"Times New Roman\\\", serif\",\"Constantia, \\\"Lucida Bright\\\", Lucidabright, \\\"Lucida Serif\\\", Lucida, \\\"DejaVu Serif\\\", \\\"Bitstream Vera Serif\\\", \\\"Liberation Serif\\\", Georgia, serif\",\"Didot, \\\"Didot LT STD\\\", \\\"Hoefler Text\\\", Garamond, \\\"Times New Roman\\\", serif\",\"Garamond, Baskerville, \\\"Baskerville Old Face\\\", \\\"Hoefler Text\\\", \\\"Times New Roman\\\", serif\",\"Georgia, Palatino,\\\" Palatino Linotype\\\", Times, \\\"Times New Roman\\\", serif\",\"\\\"Goudy Old Style\\\", Garamond, \\\"Big Caslon\\\", \\\"Times New Roman\\\", serif\",\"\\\"Hoefler Text\\\", \\\"Baskerville old face\\\", Garamond, \\\"Times New Roman\\\", serif\",\"\\\"Lucida Bright\\\", Georgia, serif\",\"\\\"Palatino Linotype\\\", Palatino, Palladio, \\\"URW Palladio L\\\", \\\"Book Antiqua\\\", Baskerville, \\\"Bookman Old Style\\\", \\\"Bitstream Charter\\\", \\\"Nimbus Roman No9 L\\\", Garamond, \\\"Apple Garamond\\\", \\\"ITC Garamond Narrow\\\", \\\"New Century Schoolbook\\\", \\\"Century Schoolbook\\\", \\\"Century Schoolbook L\\\", Georgia, serif\",\"Perpetua, Baskerville, \\\"Big Caslon\\\", \\\"Palatino Linotype\\\", Palatino, \\\"URW Palladio L\\\", \\\"Nimbus Roman No9 L\\\", serif\",\"Rockwell, \\\"Courier Bold\\\", Courier, Georgia, Times, \\\"Times New Roman\\\", serif\",\"\\\"Times New Roman\\\", TimesNewRoman, Times, Baskerville, Georgia, serif\"],\"monospace\":[\"\\\"Andale Mono\\\", AndaleMono, monospace\",\"Consolas, \\\"Andale Mono WT\\\", \\\"Andale Mono\\\", \\\"Lucida Console\\\", \\\"Lucida Sans Typewriter\\\", \\\"DejaVu Sans Mono\\\", \\\"Bitstream Vera Sans Mono\\\", \\\"Liberation Mono\\\", \\\"Nimbus Mono L\\\", Monaco, \\\"Courier New\\\", Courier, monospace\",\"\\\"Courier New\\\", Courier, \\\"Lucida Sans Typewriter\\\", \\\"Lucida Typewriter\\\", monospace\",\"\\\"Lucida Console\\\", \\\"Lucida Sans Typewriter\\\", Monaco, \\\"Bitstream Vera Sans Mono\\\", monospace\",\"Monaco, Consolas, \\\"Lucida Console\\\", monospace\",\"\\\"Rockwell Extra Bold\\\", \\\"Rockwell Bold\\\", monospace\"]};});\n\n","define('taoQtiItem/qtiCreator/editor/styleEditor/fontSelector',[\r\n    'jquery',\r\n    'json!taoQtiItem/qtiCreator/editor/resources/font-stacks.json',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor',\r\n    'i18n',\r\n    'select2'\r\n], function ($, fontStacks, styleEditor, __) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Populate a select box with a list of fonts to select from.\r\n     * On change apply the selected font to the specified target.\r\n     *\r\n     * @example\r\n     * The expected mark-up must be like this:\r\n     * <select\r\n     *   data-target=\"selector-of-targeted-element\"\r\n     *   data-not-selected=\"Select a font\r\n     *   data-selected=\"Reset to default\">\r\n     * <option value=\"\"></option>\r\n     *\r\n     * The function is called like this:\r\n     * fontSelector('the-select-box-selector');\r\n     *\r\n     * @param selector\r\n     */\r\n    var fontSelector = function () {\r\n        var fontSelector = $('select#item-editor-font-selector'),\r\n            target = fontSelector.data('target'),\r\n            $target = $(target),\r\n            normalize = function (font) {\r\n                return font.replace(/\"/g, \"'\").replace(/, /g, \",\");\r\n            },\r\n            clean = function (font) {\r\n                return font.substring(0, font.indexOf(',')).replace(/'/g, '');\r\n            },\r\n            resetButton =  fontSelector.parent().find('[data-role=\"font-selector-reset\"]'),\r\n            generic,\r\n            optGroup,\r\n            option,\r\n            i = 0,\r\n            l,\r\n            toLabel = function (font) {\r\n                font = font.replace(/-/g, ' ');\r\n                return (font + '').replace(/^([a-z\\u00E0-\\u00FC])|\\s+([a-z\\u00E0-\\u00FC])/g, function ($1) {\r\n                    return $1.toUpperCase();\r\n                });\r\n            },\r\n            format = function (state) {\r\n                var originalOption = state.element;\r\n                if (!state.id) {\r\n                    return state.text;\r\n                }\r\n                return '<span style=\"font-size: 12px;' + $(originalOption).attr('style') + '\">' + state.text + '</span>';\r\n            },\r\n            reset = function() {\r\n                styleEditor.apply(target, 'font-family');\r\n                fontSelector.select2('val', $target.css('font-family'));\r\n            };\r\n\r\n\r\n        fontSelector.append('<option value=\"\">' + __('Default')  + '</option>');\r\n\r\n        for (generic in fontStacks) {\r\n            if (fontStacks.hasOwnProperty(generic)) {\r\n                optGroup = $('<optgroup>', { label: toLabel(generic) });\r\n                l = fontStacks[generic].length;\r\n                for (i = 0; i < l; i++) {\r\n                    // normalize quotes\r\n                    fontStacks[generic][i] = normalize(fontStacks[generic][i]);\r\n                    option = $('<option>', {\r\n                        value: fontStacks[generic][i],\r\n                        text: clean(fontStacks[generic][i])\r\n                    })\r\n                        .css({\r\n                            fontFamily: fontStacks[generic][i]\r\n                        });\r\n                    optGroup.append(option);\r\n                }\r\n                fontSelector.append(optGroup);\r\n            }\r\n        }\r\n\r\n\r\n\r\n        resetButton.on('click', reset);\r\n\r\n        fontSelector.select2({\r\n            formatResult: format,\r\n            formatSelection: format,\r\n            width: 'resolve'\r\n        });\r\n\r\n        $(document).on('customcssloaded.styleeditor', function(e, style) {\r\n            //@todo : to be fixed ! currently disabled because keep triggering error \"style is undefined\"\r\n            return;\r\n            //if(style[target] && style[target]['font-family']) {\r\n                //fontSelector.select2('val', style[target]['font-family']);\r\n            //}\r\n        });\r\n\r\n        fontSelector.on('change', function () {\r\n            styleEditor.apply(target, 'font-family', $(this).val());\r\n        });\r\n    };\r\n\r\n    return fontSelector;\r\n});\r\n\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/popup',[\r\n    'jquery',\r\n    'lodash',\r\n    'core/dataattrhandler'\r\n], function(\r\n    $,\r\n    _,\r\n    dataAttrHandler\r\n    ){\r\n\r\n    'use strict';\r\n\r\n\r\n    var init = function($trigger, options) {\r\n\r\n        var defaults = {\r\n            top: null,     // || pixels relative to the top border of the sidebar\r\n            right: 2,      // pixels relative to the left border of the sidebar\r\n            title: null    // || string title\r\n        };\r\n\r\n        options = _.assign(defaults, (options || {}));\r\n\r\n        // open the popup\r\n        var open = function($trigger, $popup) {\r\n\r\n            // The following sidebar related variables apply only in the case where the popup\r\n            // is attached to a sidebar. In the the case of farbtastic for example\r\n            // the popup is attached to the body.\r\n            var $container = $popup.parents('.sidebar-popup-parent');\r\n\r\n\r\n            // this makes sure the popup height never exceeds the height of the content part of the page\r\n            var $actionBar = $('.item-editor-action-bar');\r\n            var baseOffsetTop = $actionBar.offset().top - $actionBar.height();\r\n            var maxHeight = $(window).height() - baseOffsetTop;\r\n\r\n            var top = _.isNull(options.top) ? $trigger.offset().top - baseOffsetTop - ($popup.height() / 2) : options.top;\r\n            var $titleArea = $popup.find('.sidebar-popup-title');\r\n            var $title = $titleArea.find('h3');\r\n            if($titleArea.length) {\r\n                maxHeight -= $titleArea.height();\r\n            }\r\n\r\n            $trigger.trigger('beforeopen.popup', { popup: $popup, trigger: $trigger });\r\n            $popup.show();\r\n\r\n            $popup.css({\r\n                top: Math.max(baseOffsetTop, top),\r\n                right: $container.hasClass('item-editor-sidebar-wrapper') ? $container.width() + options.right : options.right\r\n            });\r\n\r\n            if(options.title) {\r\n                $title.text(options.title);\r\n            }\r\n\r\n            $popup.find('.sidebar-popup-content').css({ maxHeight: maxHeight });\r\n\r\n            $trigger.trigger('open.popup', { popup: $popup, trigger: $trigger });\r\n        };\r\n\r\n        // close the popup\r\n        var close = function($trigger, $popup) {\r\n            $trigger.trigger('beforeclose.popup', { popup: $popup, trigger: $trigger });\r\n            $popup.hide();\r\n            $trigger.trigger('close.popup', { popup: $popup, trigger: $trigger });\r\n        };\r\n\r\n\r\n        // find popup, assign basic actions, add it to trigger props\r\n        $trigger.each(function() {\r\n            var _trigger = $(this),\r\n                $popup = options.popup || (function() {\r\n                    return dataAttrHandler.getTarget('popup', _trigger);\r\n                }());\r\n\r\n            var $closer = $popup.find('.closer'),\r\n                $dragger = $popup.find('.sidebar-popup-title').not($closer);\r\n\r\n            if(!$popup || !$popup.length) {\r\n                throw new Error('No popup found');\r\n            }\r\n\r\n            // close popup by clicking on x button\r\n            if($closer.length) {\r\n                $closer.on('click', function() {\r\n                    close(_trigger, $popup);\r\n                });\r\n            }\r\n\r\n            // drag popup\r\n            if($dragger.length){\r\n                $popup.draggable({\r\n                    handle : $dragger\r\n                });\r\n            }\r\n\r\n            // assign popup to trigger to avoid future DOM operations\r\n            _trigger.prop('popup', $popup);\r\n        });\r\n\r\n        // toggle popup\r\n        $trigger.on('click', function(e) {\r\n            var _trigger = $(e.target),\r\n                $popup   = _trigger.prop('popup');\r\n\r\n            // in case the trigger is an <a>\r\n            e.preventDefault();\r\n\r\n            // toggle popup\r\n            if($popup.is(':visible')) {\r\n                close(_trigger, $popup);\r\n            }\r\n            else {\r\n                open(_trigger, $popup);\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n    function reorderZindex() {\r\n\r\n    }\r\n\r\n\r\n\r\n    return {\r\n        init: init,\r\n        reorderZindex: reorderZindex\r\n    };\r\n\r\n});\r\n\r\n\r\n\n","/**\r\n * Farbtastic Color Picker 1.2\r\n * © 2008 Steven Wittens\r\n *\r\n * This program is free software; you can redistribute it and/or modify\r\n * it under the terms of the GNU General Public License as published by\r\n * the Free Software Foundation; either version 2 of the License, or\r\n * (at your option) any later version.\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA\r\n */\r\n\r\n/**\r\n * NOTE: THIS IS A MOD OF COLOR PICKER 1.2 - DO NOT UPGRADE!\r\n * 2014-03-06  dieter@taotesting.com\r\n */\r\ndefine('lib/farbtastic/farbtastic',['jquery'], function(jQuery){\r\n    var $ = jQuery;\r\n\r\njQuery.fn.farbtastic = function(callback) {\r\n    $.farbtastic(this, callback);\r\n    return this;\r\n};\r\n\r\njQuery.farbtastic = function(container, callback) {\r\n    if (!container.length) return;\r\n    var container = $(container).get(0);\r\n    return container.farbtastic || (container.farbtastic = new jQuery._farbtastic(container, callback));\r\n}\r\n\r\njQuery._farbtastic = function(container, callback) {\r\n    // Store farbtastic object\r\n    var fb = this;\r\n\r\n    // Insert markup\r\n    var e = $('<div>', {\r\n        'class': 'farbtastic'\r\n    }),\r\n        colorObj = $('<div>', {\r\n            'class': 'color'\r\n        }),\r\n        wheelObj = $('<div>', {\r\n            'class': 'wheel'\r\n        }),\r\n        overlayObj = $('<div>', {\r\n            'class': 'overlay'\r\n        }),\r\n        hMarkerObj = $('<div>', {\r\n            'class': 'h-marker marker'\r\n        }),\r\n        slMarkerObj = $('<div>', {\r\n            'class': 'sl-marker marker'\r\n        });\r\n\r\n    container = $(container);\r\n\r\n    $(e).append(colorObj);\r\n    $(e).append(wheelObj);\r\n    $(e).append(overlayObj);\r\n    $(e).append(hMarkerObj);\r\n    $(e).append(slMarkerObj);\r\n\r\n    container.append(e);\r\n\r\n\r\n    fb.wheel = wheelObj.get(0);\r\n    // Dimensions\r\n    fb.radius = 70;\r\n    fb.square = overlayObj.width();\r\n    fb.width = e.width();\r\n\r\n\r\n    /**\r\n     * Link to the given element(s) or callback.\r\n     */\r\n    fb.linkTo = function(callback) {\r\n        // Unbind previous nodes\r\n        if (typeof fb.callback == 'object') {\r\n            $(fb.callback).unbind('keyup', fb.updateValue);\r\n        }\r\n\r\n        // Reset color\r\n        fb.color = null;\r\n\r\n        // Bind callback or elements\r\n        if (typeof callback == 'function') {\r\n            fb.callback = callback;\r\n        } else if (typeof callback == 'object' || typeof callback == 'string') {\r\n            fb.callback = $(callback);\r\n            fb.callback.bind('keyup', fb.updateValue);\r\n            if (fb.callback.get(0).value) {\r\n                fb.setColor(fb.callback.get(0).value);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n\r\n    fb.updateValue = function(event) {\r\n        if (this.value && this.value != fb.color) {\r\n            fb.setColor(this.value);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Change color with HTML syntax #123456\r\n     */\r\n    fb.setColor = function(color) {\r\n        var unpack = fb.unpack(color);\r\n        if (fb.color != color && unpack) {\r\n            fb.color = color;\r\n            fb.rgb = unpack;\r\n            fb.hsl = fb.RGBToHSL(fb.rgb);\r\n            fb.updateDisplay();\r\n        }\r\n        return this;\r\n    };\r\n\r\n\r\n    /**\r\n     * Change color with HSL triplet [0..1, 0..1, 0..1]\r\n     */\r\n    fb.setHSL = function(hsl) {\r\n        fb.hsl = hsl;\r\n        fb.rgb = fb.HSLToRGB(hsl);\r\n        fb.color = fb.pack(fb.rgb);\r\n        fb.updateDisplay();\r\n        return this;\r\n    }\r\n\r\n    /////////////////////////////////////////////////////\r\n\r\n    /**\r\n     * Retrieve the coordinates of the given event relative to the center\r\n     * of the widget.\r\n     */\r\n    fb.widgetCoords = function(event) {\r\n        var x, y;\r\n        var el = event.target || event.srcElement;\r\n        var reference = fb.wheel;\r\n\r\n        if (typeof event.offsetX != 'undefined') {\r\n            // Use offset coordinates and find common offsetParent\r\n            var pos = {\r\n                x: event.offsetX,\r\n                y: event.offsetY\r\n            };\r\n\r\n            // Send the coordinates upwards through the offsetParent chain.\r\n            var e = el;\r\n            while (e) {\r\n                e.mouseX = pos.x;\r\n                e.mouseY = pos.y;\r\n                pos.x += e.offsetLeft;\r\n                pos.y += e.offsetTop;\r\n                e = e.offsetParent;\r\n            }\r\n\r\n            // Look for the coordinates starting from the wheel widget.\r\n            var e = reference;\r\n            var offset = {\r\n                x: 0,\r\n                y: 0\r\n            }\r\n            while (e) {\r\n                if (typeof e.mouseX != 'undefined') {\r\n                    x = e.mouseX - offset.x;\r\n                    y = e.mouseY - offset.y;\r\n                    break;\r\n                }\r\n                offset.x += e.offsetLeft;\r\n                offset.y += e.offsetTop;\r\n                e = e.offsetParent;\r\n            }\r\n\r\n            // Reset stored coordinates\r\n            e = el;\r\n            while (e) {\r\n                e.mouseX = undefined;\r\n                e.mouseY = undefined;\r\n                e = e.offsetParent;\r\n            }\r\n        } else {\r\n            // Use absolute coordinates\r\n            var pos = fb.absolutePosition(reference);\r\n            x = (event.pageX || 0 * (event.clientX + $('html').get(0).scrollLeft)) - pos.x;\r\n            y = (event.pageY || 0 * (event.clientY + $('html').get(0).scrollTop)) - pos.y;\r\n        }\r\n        // Subtract distance to middle\r\n        return {\r\n            x: x - fb.width / 2,\r\n            y: y - fb.width / 2\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Mousedown handler\r\n     */\r\n    fb.mousedown = function(event) {\r\n        // Capture mouse\r\n        if (!document.dragging) {\r\n            $(document).bind('mousemove', fb.mousemove).bind('mouseup', fb.mouseup);\r\n            document.dragging = true;\r\n        }\r\n\r\n        // Check which area is being dragged\r\n        var pos = fb.widgetCoords(event);\r\n        fb.circleDrag = Math.max(Math.abs(pos.x), Math.abs(pos.y)) * 2 > fb.square;\r\n\r\n        // Process\r\n        fb.mousemove(event);\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Mousemove handler\r\n     */\r\n    fb.mousemove = function(event) {\r\n        // Get coordinates relative to color picker center\r\n        var pos = fb.widgetCoords(event);\r\n\r\n        // Set new HSL parameters\r\n        if (fb.circleDrag) {\r\n            var hue = Math.atan2(pos.x, -pos.y) / 6.28;\r\n            if (hue < 0) hue += 1;\r\n            fb.setHSL([hue, fb.hsl[1], fb.hsl[2]]);\r\n        } else {\r\n            var sat = Math.max(0, Math.min(1, -(pos.x / fb.square) + .5));\r\n            var lum = Math.max(0, Math.min(1, -(pos.y / fb.square) + .5));\r\n            fb.setHSL([fb.hsl[0], sat, lum]);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Mouseup handler\r\n     */\r\n    fb.mouseup = function() {\r\n        // Uncapture mouse\r\n        $(document).unbind('mousemove', fb.mousemove);\r\n        $(document).unbind('mouseup', fb.mouseup);\r\n        document.dragging = false;\r\n    }\r\n\r\n    /**\r\n     * Update the markers and styles\r\n     */\r\n    fb.updateDisplay = function() {\r\n        // Markers\r\n        var angle = fb.hsl[0] * 6.28;\r\n        $('.h-marker', e).css({\r\n            left: Math.round(Math.sin(angle) * fb.radius + fb.width / 2) + 'px',\r\n            top: Math.round(-Math.cos(angle) * fb.radius + fb.width / 2) + 'px'\r\n        });\r\n\r\n        $('.sl-marker', e).css({\r\n            left: Math.round(fb.square * (.5 - fb.hsl[1]) + fb.width / 2) + 'px',\r\n            top: Math.round(fb.square * (.5 - fb.hsl[2]) + fb.width / 2) + 'px'\r\n        });\r\n\r\n        // Saturation/Luminance gradient\r\n        $('.color', e).css('backgroundColor', fb.pack(fb.HSLToRGB([fb.hsl[0], 1, 0.5])));\r\n\r\n        // Linked elements or callback\r\n        if (typeof fb.callback == 'object') {\r\n            // Set background/foreground color\r\n            $(fb.callback).css({\r\n                backgroundColor: fb.color,\r\n                color: fb.hsl[2] > 0.5 ? '#000' : '#fff'\r\n            });\r\n\r\n            // Change linked value\r\n            $(fb.callback).each(function() {\r\n                if (this.value && this.value != fb.color) {\r\n                    this.value = fb.color;\r\n                }\r\n            });\r\n        } else if (typeof fb.callback == 'function') {\r\n            fb.callback.call(fb, fb.color);\r\n        }\r\n        // mod by dieter\r\n        container.trigger('colorchange.farbtastic', [fb.color]);\r\n    }\r\n\r\n    /**\r\n     * Get absolute position of element\r\n     */\r\n    fb.absolutePosition = function(el) {\r\n        var r = {\r\n            x: el.offsetLeft,\r\n            y: el.offsetTop\r\n        };\r\n        // Resolve relative to offsetParent\r\n        if (el.offsetParent) {\r\n            var tmp = fb.absolutePosition(el.offsetParent);\r\n            r.x += tmp.x;\r\n            r.y += tmp.y;\r\n        }\r\n        return r;\r\n    };\r\n\r\n    /* Various color utility functions */\r\n    fb.pack = function(rgb) {\r\n        var r = Math.round(rgb[0] * 255);\r\n        var g = Math.round(rgb[1] * 255);\r\n        var b = Math.round(rgb[2] * 255);\r\n        return '#' + (r < 16 ? '0' : '') + r.toString(16) +\r\n            (g < 16 ? '0' : '') + g.toString(16) +\r\n            (b < 16 ? '0' : '') + b.toString(16);\r\n    }\r\n\r\n    fb.unpack = function(color) {\r\n        if (color.length == 7) {\r\n            return [parseInt('0x' + color.substring(1, 3)) / 255,\r\n                parseInt('0x' + color.substring(3, 5)) / 255,\r\n                parseInt('0x' + color.substring(5, 7)) / 255];\r\n        } else if (color.length == 4) {\r\n            return [parseInt('0x' + color.substring(1, 2)) / 15,\r\n                parseInt('0x' + color.substring(2, 3)) / 15,\r\n                parseInt('0x' + color.substring(3, 4)) / 15];\r\n        }\r\n    }\r\n\r\n    fb.HSLToRGB = function(hsl) {\r\n        var m1, m2, r, g, b;\r\n        var h = hsl[0],\r\n            s = hsl[1],\r\n            l = hsl[2];\r\n        m2 = (l <= 0.5) ? l * (s + 1) : l + s - l * s;\r\n        m1 = l * 2 - m2;\r\n        return [this.hueToRGB(m1, m2, h + 0.33333),\r\n            this.hueToRGB(m1, m2, h),\r\n            this.hueToRGB(m1, m2, h - 0.33333)];\r\n    };\r\n\r\n    fb.hueToRGB = function(m1, m2, h) {\r\n        h = (h < 0) ? h + 1 : ((h > 1) ? h - 1 : h);\r\n        if (h * 6 < 1) return m1 + (m2 - m1) * h * 6;\r\n        if (h * 2 < 1) return m2;\r\n        if (h * 3 < 2) return m1 + (m2 - m1) * (0.66666 - h) * 6;\r\n        return m1;\r\n    };\r\n\r\n    fb.RGBToHSL = function(rgb) {\r\n        var min, max, delta, h, s, l;\r\n        var r = rgb[0],\r\n            g = rgb[1],\r\n            b = rgb[2];\r\n        min = Math.min(r, Math.min(g, b));\r\n        max = Math.max(r, Math.max(g, b));\r\n        delta = max - min;\r\n        l = (min + max) / 2;\r\n        s = 0;\r\n        if (l > 0 && l < 1) {\r\n            s = delta / (l < 0.5 ? (2 * l) : (2 - 2 * l));\r\n        }\r\n        h = 0;\r\n        if (delta > 0) {\r\n            if (max == r && max != g) h += (g - b) / delta;\r\n            if (max == g && max != b) h += (2 + (b - r) / delta);\r\n            if (max == b && max != r) h += (4 + (r - g) / delta);\r\n            h /= 6;\r\n        }\r\n        return [h, s, l];\r\n    }\r\n\r\n    // Install mousedown handler (the others are set on the document on-demand)\r\n    $('*', e).mousedown(fb.mousedown);\r\n\r\n    // Init color\r\n    fb.setColor('#123456');\r\n\r\n    // Set linked elements/callback\r\n    if (callback) {\r\n        fb.linkTo(callback);\r\n    }\r\n}\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/styleEditor/colorSelector',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor',\r\n    'taoQtiItem/qtiCreator/helper/popup',\r\n    'lib/farbtastic/farbtastic'\r\n], function ($, _, __, styleEditor, popup) {\r\n    'use strict';\r\n\r\n    // based on http://stackoverflow.com/a/14238466\r\n    // this conversion is required to communicate with farbtastic\r\n    function rgbToHex(color) {\r\n\r\n        function toHexPair(inp) {\r\n            return ('0' + parseInt(inp, 10).toString(16)).slice(-2);\r\n        }\r\n\r\n        // undefined can happen when no color is defined for a particular element\r\n        // isString on top of that should cover all sorts of weird input\r\n        if(!_.isString(color)) {\r\n            return color;\r\n        }\r\n\r\n        var rgbArr = /rgb\\s*\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)/i.exec(color);\r\n\r\n        // color is not rgb\r\n        if(!_.isArray(rgbArr) || rgbArr.length !== 4) {\r\n            return color;\r\n        }\r\n\r\n        return '#' + toHexPair(rgbArr[1]) + toHexPair(rgbArr[2]) + toHexPair(rgbArr[3]);\r\n    }\r\n\r\n    var colorSelector = function () {\r\n        var colorPicker = $('.item-editor-color-picker'),\r\n            widget = colorPicker.find('.color-picker'),\r\n            widgetBox = colorPicker.find('.color-picker-container'),\r\n            titleElement =  colorPicker.find('#color-picker-title'),\r\n            input = colorPicker.find('#color-picker-input'),\r\n            resetButtons = colorPicker.find('.reset-button'),\r\n            colorTriggers = colorPicker.find('.color-trigger'),\r\n            colorTriggerLabels = colorPicker.find('label'),\r\n            currentProperty = 'color',\r\n            widgetObj,\r\n            $doc = $(document);\r\n\r\n\r\n\r\n        /**\r\n         * Widget title\r\n         *\r\n         * @param property\r\n         * @param trigger\r\n         */\r\n        var setTitle = function (property, trigger) {\r\n            titleElement.text(trigger.parent().find('label').text());\r\n        };\r\n\r\n        /**\r\n         * Trigger button background\r\n         */\r\n        var setTriggerColor = function() {\r\n            colorTriggers.each(function () {\r\n                var $trigger = $(this),\r\n                    target   = $trigger.data('target'),\r\n                    $target  = $(target),\r\n                    style    = styleEditor.getStyle() || {},\r\n                    value;\r\n                // elements have a color from usage of style editor\r\n                if(style[target] && style[target][$trigger.data('value')]) {\r\n                    value = style[target][$trigger.data('value')];\r\n                    $trigger.css('background-color', value);\r\n                    $trigger.attr('title', rgbToHex(value));\r\n                }\r\n                // elements have a default color from tao css\r\n                else if($target.css($trigger.data('value'))) {\r\n                    value = $target.css($trigger.data('value'));\r\n                    $trigger.css('background-color', value);\r\n                    $trigger.attr('title', rgbToHex(value));\r\n                }\r\n                // elements have no color at all\r\n                else {\r\n                    $trigger.css('background-color', '');\r\n                    $trigger.attr('title', __('No value set'));\r\n                }\r\n\r\n            });\r\n        };\r\n\r\n        widgetObj = $.farbtastic(widget).linkTo(input);\r\n\r\n        // event received from modified farbtastic\r\n        widget.on('colorchange.farbtastic', function (e, color) {\r\n            styleEditor.apply(widget.prop('target'), currentProperty, color);\r\n            setTriggerColor();\r\n        });\r\n\r\n\r\n        // open color picker\r\n        setTriggerColor();\r\n        colorTriggers.add(colorTriggerLabels).on('click', function () {\r\n            var $tmpTrigger = $(this),\r\n                $trigger = (this.nodeName.toLowerCase() === 'label' ? $tmpTrigger.parent().find('.color-trigger') : $tmpTrigger),\r\n                value = $trigger.css('background-color');\r\n\r\n            widget.prop('target', $trigger.data('target'));\r\n            widgetBox.hide();\r\n            currentProperty = $trigger.data('value');\r\n            setTitle(currentProperty, $trigger);\r\n            widgetObj.setColor(rgbToHex($trigger.css('background-color')));\r\n            widgetBox.show();\r\n        });\r\n\r\n        // close color picker, when clicking somewhere outside or on the x\r\n        $doc.on('mouseup', function(e) {\r\n            if($(e.target).hasClass('closer')) {\r\n                widgetBox.hide();\r\n                return false;\r\n            }\r\n\r\n            if (!widgetBox.is(e.target) && widgetBox.has(e.target).length === 0) {\r\n                widgetBox.hide();\r\n                return false;\r\n            }\r\n        });\r\n\r\n        // close color picker on escape\r\n        $doc.on('keyup', function(e){\r\n            if (e.keyCode === 27) {\r\n                widgetBox.hide();\r\n                return false;\r\n            }\r\n        });\r\n\r\n\r\n        // reset to default\r\n        resetButtons.on('click', function () {\r\n            var $this = $(this),\r\n                $colorTrigger = $this.parent().find('.color-trigger'),\r\n                target = $colorTrigger.data('target'),\r\n                value = $colorTrigger.data('value');\r\n            styleEditor.apply(target, value);\r\n            setTriggerColor();\r\n        });\r\n\r\n\r\n        $doc.on('customcssloaded.styleeditor', setTriggerColor);\r\n    };\r\n\r\n    return colorSelector;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n/**\r\n *\r\n * @author dieter <dieter@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/styleEditor/fontSizeChanger',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor'\r\n], function ($, _, styleEditor) {\r\n    'use strict';\r\n\r\n\r\n    /**\r\n     * Changes the font size in the Style Editor\r\n     */\r\n    var fontSizeChanger = function () {\r\n        var $fontSizeChanger = $('#item-editor-font-size-changer'),\r\n            itemSelector = $fontSizeChanger.data('target'),\r\n            $item = $(itemSelector),\r\n            itemFontSize = parseInt($item.css('font-size'), 10),\r\n            $resetBtn =  $fontSizeChanger.parents('.reset-group').find('[data-role=\"font-size-reset\"]'),\r\n            $input = $('#item-editor-font-size-text');\r\n\r\n        /**\r\n         * Writes new font size to virtual style sheet\r\n         */\r\n        var resizeFont = function() {\r\n            styleEditor.apply(itemSelector + ' *', 'font-size', itemFontSize.toString() + 'px');\r\n        };\r\n\r\n        /**\r\n         * Handle input field\r\n         */\r\n        $fontSizeChanger.find('a').on('click', function(e) {\r\n            e.preventDefault();\r\n            if($(this).data('action') === 'reduce') {\r\n                if(itemFontSize <= 10) {\r\n                    return;\r\n                }\r\n                itemFontSize--;\r\n            }\r\n            else {\r\n                itemFontSize++;\r\n            }\r\n            resizeFont();\r\n            $input.val(itemFontSize);\r\n            $(this).parent().blur();\r\n        });\r\n\r\n        /**\r\n         * Disallows invalid characters\r\n         */\r\n        $input.on('keydown', function(e) {\r\n            var c = e.keyCode;\r\n            return (_.contains([8, 37, 39, 46], c) ||\r\n                (c >= 48 && c <= 57) ||\r\n                (c >= 96 && c <= 105));\r\n        });\r\n\r\n        /**\r\n         * Apply font size on blur\r\n         */\r\n        $input.on('blur', function() {\r\n            itemFontSize = parseInt(this.value, 10);\r\n            resizeFont();\r\n        });\r\n\r\n        /**\r\n         * Apply font size on enter\r\n         */\r\n        $input.on('keydown', function(e) {\r\n            var c = e.keyCode;\r\n            if(c === 13) {\r\n                $input.trigger('blur');\r\n            }\r\n        });\r\n\r\n        /**\r\n         * Remove font size from virtual style sheet\r\n         */\r\n        $resetBtn.on('click', function () {\r\n            $input.val('');\r\n            styleEditor.apply(itemSelector + ' *', 'font-size');\r\n        });\r\n\r\n        /**\r\n         * style loaded from style sheet\r\n         */\r\n        $(document).on('customcssloaded.styleeditor', function(e, style) {\r\n            if(style[itemSelector] && style[itemSelector]['font-size']) {\r\n                $input.val(parseInt(style[itemSelector]['font-size'], 10));\r\n                $input.trigger('blur');\r\n            }\r\n            else {\r\n                $input.val(parseInt($item.css('font-size'), 10));\r\n            }\r\n        });\r\n    };\r\n\r\n    return fontSizeChanger;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/styleEditor/itemResizer',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor',\r\n    'nouislider',\r\n    'jqueryui'\r\n\r\n], function ($, _, styleEditor) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Adapt the image editor to the target screen the students will be using\r\n     * @param {Object} item - the current item\r\n     */\r\n    var itemResizer = function (item) {\r\n\r\n        var itemResizer = $('#item-editor-item-resizer'),\r\n            target = itemResizer.data('target'),\r\n            $target = $(target),\r\n            targetWidth = $target.innerWidth(),\r\n            itemWidthPrompt = itemResizer.find('[name=\"item-width-prompt\"]'),\r\n            sliderBox = itemResizer.find('.slider-box'),\r\n            slider = itemResizer.find('#item-editor-item-resizer-slider'),\r\n            input = $('#item-editor-item-resizer-text'),\r\n            resetButton =  itemResizer.find('[data-role=\"item-width-reset\"]'),\r\n            sliderSettings = {\r\n                range : {\r\n                    min: Math.min(768, targetWidth),\r\n                    max: Math.max(1200, targetWidth)\r\n                },\r\n                start: targetWidth\r\n            };\r\n\r\n        var reset = function() {\r\n            itemResizer.find('[value=\"no-slider\"]').trigger('click');\r\n        };\r\n\r\n        /**\r\n         * Resize item\r\n         *\r\n         * @param val int|string\r\n         */\r\n        var resizeItem = function(val) {\r\n            if (val) {\r\n                // to make sure the value can come as int or string\r\n                val = parseInt(val).toString() + 'px';\r\n                styleEditor.apply(target, 'width', val);\r\n                styleEditor.apply(target, 'max-width', 'none');\r\n            } else {\r\n                styleEditor.apply(target, 'width');\r\n                styleEditor.apply(target, 'max-width');\r\n            }\r\n\r\n            item.data('widget').$container.trigger('resize.itemResizer');\r\n        };\r\n\r\n        /**\r\n         * Initialize radio buttons\r\n         */\r\n        itemWidthPrompt.on('click', function() {\r\n            // user intends to resize the item\r\n            if(this.value === 'slider') {\r\n                input.val($target.width());\r\n                slider.val($target.width()).trigger('slide');\r\n                sliderBox.slideDown();\r\n\r\n                item.data('responsive', false);\r\n\r\n                resizeItem($target.width());\r\n            }\r\n            // user wants to use default\r\n            else {\r\n                input.val('');\r\n                slider.val(sliderSettings.start);\r\n                sliderBox.slideUp();\r\n\r\n                item.data('responsive', true);\r\n\r\n                resizeItem();\r\n            }\r\n        });\r\n\r\n\r\n        slider.noUiSlider(sliderSettings);\r\n        slider.on('slide', function() {\r\n            var value = Math.round(slider.val());\r\n            input.val(value);\r\n            resizeItem(value);\r\n        });\r\n\r\n        input.on('keydown', function(e) {\r\n            var c = e.keyCode;\r\n            return (_.contains([8, 37, 39, 46], c)\r\n                || (c >= 48 && c <= 57)\r\n                || (c >= 96 && c <= 105));\r\n        });\r\n\r\n        input.on('blur', function() {\r\n            resizeItem(this.value);\r\n        });\r\n\r\n        resetButton.on('click', reset);\r\n        $(document).on('customcssloaded.styleeditor', function(e, style) {\r\n            var width;\r\n            // make a proper width change\r\n            if(style[target] && style[target].width) {\r\n                width = parseInt(style[target].width, 10);\r\n                input.val(width);\r\n                slider.val(width);\r\n                itemResizer.find('[value=\"slider\"]').trigger('click');\r\n            }\r\n            // just fill the text field\r\n            else {\r\n                input.val($target.width());\r\n            }\r\n        });\r\n    };\r\n    return itemResizer;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/propertiesPanel',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/helper/panel',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleSheetToggler',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/fontSelector',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/colorSelector',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/fontSizeChanger',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/itemResizer',\r\n], function(_, panel, styleEditor, styleSheetToggler, fontSelector, colorSelector, fontSizeChanger, itemResizer){\r\n    'use strict';\r\n\r\n    /**\r\n     * Set up the properties panel, including the style editor\r\n     * @param {jQueryElement} $container - the panel container\r\n     */\r\n    return function setUpInteractionPanel($container, widget, config){\r\n\r\n        panel.initSidebarAccordion($container);\r\n        panel.initFormVisibilityListener();\r\n\r\n        styleEditor.init(widget.element, config);\r\n        styleSheetToggler.init(config);\r\n\r\n        fontSelector();\r\n        colorSelector();\r\n        fontSizeChanger();\r\n        itemResizer(widget.element);\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n/**\r\n * The item creator factory let's you create (guess what...)\r\n *\r\n * The item creator is \"unfinished\" because all parts aren't yet independants and the loading is anarhic,\r\n * however the item creator does a 1st job of wrapping the item creator's bootstrap.\r\n *\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/itemCreator',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'module',\r\n    'core/eventifier',\r\n    'core/promise',\r\n    'taoQtiItem/portableElementRegistry/ciRegistry',\r\n    'taoQtiItem/portableElementRegistry/icRegistry',\r\n    'taoQtiItem/qtiCreator/helper/itemLoader',\r\n    'taoQtiItem/qtiCreator/helper/creatorRenderer',\r\n    'taoQtiItem/qtiCreator/helper/commonRenderer', //for read-only element : preview + xinclude\r\n    'taoQtiItem/qtiCreator/helper/xincludeRenderer',\r\n    'taoQtiItem/qtiCreator/editor/interactionsPanel',\r\n    'taoQtiItem/qtiCreator/editor/propertiesPanel',\r\n    'taoQtiItem/qtiCreator/model/helper/event',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor'\r\n], function($, _, __, module, eventifier, Promise, ciRegistry, icRegistry, itemLoader,\r\n            creatorRenderer, commonRenderer, xincludeRenderer,\r\n            interactionPanel, propertiesPanel, eventHelper, styleEditor){\r\n    'use strict';\r\n\r\n    /**\r\n     * Load an item\r\n     * @param {String} uri - the item URI\r\n     * @param {String} label - the item label\r\n     * @param {String} itemDataUrl - the data url\r\n     *\r\n     * @returns {Promise} that resolve with the loaded item model\r\n     */\r\n    var loadItem = function loadItem(uri, label, itemDataUrl){\r\n        return new Promise(function(resolve, reject){\r\n            itemLoader.loadItem({uri : uri, label : label, itemDataUrl: itemDataUrl}, function(item){\r\n                if(!item){\r\n                    reject(new Error('Unable to load the item'));\r\n                }\r\n\r\n                //set useful data :\r\n                item.data('uri', uri);\r\n                resolve(item);\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * load custom interactions registered from the custom interaction registry\r\n     *\r\n     * @returns {Promise} that resolve with the loaded item model\r\n     */\r\n    var loadCustomInteractions = function loadCustomInteractions(interactionsIds){\r\n        return ciRegistry.loadCreators({\r\n            enabledOnly : true,\r\n            runtimeOnly : interactionsIds\r\n        });\r\n    };\r\n\r\n    /**\r\n     * load info controls registered from the info control registry\r\n     *\r\n     * @returns {Promise} that resolve with the loaded item model\r\n     */\r\n    var loadInfoControls = function loadInfoControls(){\r\n        return icRegistry.loadCreators();\r\n    };\r\n\r\n    /**\r\n     * Build a new Item Creator\r\n     * @param {Object} config - the creator's configuration\r\n     * @param {String} config.properties.uri - the URI of the item to load (properties structure is kept as legacy)\r\n     * @param {String} config.properties.label - the label of the item to load (properties structure is kept as legacy)\r\n     * @param {String} config.properties.baseUrl - the base URL used to resolve assets\r\n     * @param {String[]} [config.interactions] - the list of additional interactions to load (PCI)\r\n     * @param {String[]} [config.infoControls] - the list of info controls to load (PIC)\r\n     * @param {areaBroker} areaBroker - a mapped areaBroker\r\n     * @param {Function[]} pluginFactories - the plugin's factory, ready to be instantiated\r\n     * @returns {itemCreator} an event emitter object, with the usual lifecycle\r\n     * @throws {TypeError}\r\n     */\r\n    var itemCreatorFactory = function itemCreatorFactory(config, areaBroker, pluginFactories){\r\n\r\n        var itemCreator;\r\n        var plugins = {};\r\n\r\n        /**\r\n         * Run a method in all plugins\r\n         *\r\n         * @param {String} method - the method to run\r\n         * @returns {Promise} once that resolve when all plugins are done\r\n         */\r\n        var pluginRun =  function pluginRun(method){\r\n            var execStack = [];\r\n\r\n            _.forEach(plugins, function (plugin){\r\n                if(_.isFunction(plugin[method])){\r\n                    execStack.push(plugin[method]());\r\n                }\r\n            });\r\n\r\n            return Promise.all(execStack);\r\n        };\r\n\r\n        //validate parameters\r\n        if(!_.isPlainObject(config)){\r\n            throw new TypeError('The item creator configuration is required');\r\n        }\r\n        if(!config.properties || _.isEmpty(config.properties.uri) || _.isEmpty(config.properties.label) || _.isEmpty(config.properties.baseUrl)){\r\n            throw new TypeError('The creator configuration must contains the required properties triples: uri, label and baseUrl');\r\n        }\r\n        if(!areaBroker){\r\n            throw new TypeError('Without an areaBroker there are no chance to see something you know');\r\n        }\r\n\r\n        //factor the new itemCreator\r\n        itemCreator = eventifier({\r\n\r\n        //lifecycle\r\n\r\n            /**\r\n             * Initialize the item creator:\r\n             *  - set up the registries for portable elements\r\n             *  - load the item\r\n             *  - instantiate and initialize the plugins\r\n             *\r\n             * @returns {itemCreator} chains\r\n             * @fires itemCreator#init - once initialized\r\n             * @fires itemCreator#error - if something went wrong\r\n             */\r\n            init: function init(){\r\n                var self = this;\r\n\r\n                //instantiate the plugins first\r\n                _.forEach(pluginFactories, function(pluginFactory){\r\n                    var plugin = pluginFactory(self, areaBroker);\r\n                    plugins[plugin.getName()] = plugin;\r\n                });\r\n\r\n                // quick-fix: clear all ghost events listeners\r\n                // prevent ghosting of item states and other properties\r\n                $(document).off('.qti-widget');\r\n\r\n                /**\r\n                 * Save the item on \"save\" event\r\n                 * @event itemCreator#save\r\n                 * @param {Boolean} [silent] - true to not trigger the success feedback\r\n                 * @fires itemCreator#saved once the save is done\r\n                 * @fires itemCreator#error\r\n                 */\r\n                this.on('save', function(silent){\r\n                    var item = this.getItem();\r\n                    var itemWidget = item.data('widget');\r\n\r\n                    //do the save\r\n                    Promise.all([\r\n                        itemWidget.save(),\r\n                        styleEditor.save()\r\n                    ]).then(function(){\r\n                        if(!silent){\r\n                            self.trigger('success', __('Your item has been saved'));\r\n                        }\r\n\r\n                        self.trigger('saved');\r\n                    }).catch(function(err){\r\n                        self.trigger('error', err);\r\n                    });\r\n                });\r\n\r\n                var usedCustomInteractionIds = [];\r\n                loadItem(config.properties.uri, config.properties.label, config.properties.itemDataUrl).then(function(item){\r\n                    if(! _.isObject(item)){\r\n                        self.trigger('error', new Error('Unable to load the item ' + config.properties.label));\r\n                        return;\r\n                    }\r\n\r\n                    _.forEach(item.getComposingElements(), function(element){\r\n                        if(element.is('customInteraction')){\r\n                            usedCustomInteractionIds.push(element.typeIdentifier);\r\n                        }\r\n                    });\r\n                    \r\n                    self.item = item;\r\n                    return true;\r\n                }).then(function(){\r\n                    //load custom elements\r\n                    return Promise.all([\r\n                        loadCustomInteractions(usedCustomInteractionIds),\r\n                        loadInfoControls()\r\n                    ]);\r\n                }).then(function(){\r\n                    //initialize all the plugins\r\n                    return pluginRun('init').then(function(){\r\n\r\n                        /**\r\n                         * @event itemCreator#init the initialization is done\r\n                         * @param {Object} item - the loaded item\r\n                         */\r\n                        self.trigger('init', self.item);\r\n                    });\r\n                }).catch(function(err){\r\n                    self.trigger('error', err);\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Renders the creator\r\n             * Because of the actual structure, it also intialize some components (panels, toolbars, etc.).\r\n             *\r\n             * @returns {itemCreator} chains\r\n             * @fires itemCreator#render - once everything is in place\r\n             * @fires itemCreator#ready - once the creator's components' are ready (not yet reliable)\r\n             * @fires itemCreator#error - if something went wrong\r\n             */\r\n            render : function render(){\r\n                var self = this;\r\n                var item = this.getItem();\r\n\r\n                if(!item || !_.isFunction(item.getUsedClasses)){\r\n                    return this.trigger('error', new Error('We need an item to render.'));\r\n                }\r\n\r\n                //configure commonRenderer for the preview and initial qti element rendering\r\n                commonRenderer.setContext(areaBroker.getItemPanelArea());\r\n                commonRenderer\r\n                    .get(true, config)\r\n                    .setOption('baseUrl', config.properties.baseUrl);\r\n\r\n                interactionPanel(areaBroker.getInteractionPanelArea());\r\n\r\n                //the renderers' widgets do not handle async yet, so we rely on this event\r\n                //TODO ready should be triggered once every renderer's widget is done (ie. promisify everything)\r\n                $(document).on('ready.qti-widget', function(e, elt){\r\n                    if(elt.element.qtiClass === 'assessmentItem'){\r\n                        self.trigger('ready');\r\n                    }\r\n                });\r\n\r\n                creatorRenderer\r\n                    .get(true, config, areaBroker)\r\n                    .setOptions(config.properties)\r\n                    .load(function(){\r\n                        var widget;\r\n\r\n                        //set renderer\r\n                        item.setRenderer(this);\r\n\r\n                        //render item (body only) into the \"drop-area\"\r\n                        areaBroker.getItemPanelArea().append(item.render());\r\n\r\n                        //\"post-render it\" to initialize the widget\r\n                        Promise\r\n                         .all(item.postRender(_.clone(config.properties)))\r\n                         .then(function(){\r\n\r\n                             //set reference to item widget object\r\n                             areaBroker.getContainer().data('widget', item);\r\n\r\n                             widget = item.data('widget');\r\n                             _.each(item.getComposingElements(), function(element){\r\n                                 if(element.qtiClass === 'include'){\r\n                                     xincludeRenderer.render(element.data('widget'), config.properties.baseUrl);\r\n                                 }\r\n                             });\r\n\r\n                             propertiesPanel(areaBroker.getPropertyPanelArea(), widget, config.properties);\r\n\r\n                             //init event listeners:\r\n                             eventHelper.initElementToWidgetListeners();\r\n\r\n                             return pluginRun('render').then(function(){\r\n                                 self.trigger('render');\r\n                             });\r\n                         })\r\n                         .catch(function(err){\r\n                             self.trigger('error', err);\r\n                         });\r\n\r\n                    }, item.getUsedClasses());\r\n\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Clean up everything and destroy the item creator\r\n             *\r\n             * @returns {itemCreator} chains\r\n             */\r\n            destroy : function destroy(){\r\n                var self = this;\r\n\r\n                $(document).off('.qti-widget');\r\n\r\n                pluginRun('destroy').then(function(){\r\n                    self.trigger('destroy');\r\n                })\r\n                .catch(function(err){\r\n                    self.trigger('error', err);\r\n                });\r\n                return this;\r\n            },\r\n\r\n            //accessors\r\n\r\n            /**\r\n             * Give an access to the loaded item\r\n             * @returns {Object} the item\r\n             */\r\n            getItem : function getItem(){\r\n                return this.item;\r\n            },\r\n\r\n            /**\r\n             * Give an access to the config\r\n             * @returns {Object} the config\r\n             */\r\n            getConfig : function getConfig(){\r\n                return config;\r\n            }\r\n        });\r\n\r\n        return itemCreator;\r\n    };\r\n\r\n    return itemCreatorFactory;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technlogies SA\r\n *\r\n */\r\n\r\n/**\r\n *\r\n * Defines the item creator areas\r\n *\r\n * @example\r\n * var broker = areaBroker($container);\r\n * broker.defineAreas({\r\n *    content : $('.content', $container),\r\n *    //...\r\n * });\r\n * //then\r\n * var $content = broker.getArea('itemPanel');\r\n * var $content = broker.getItemPanelArea();\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/areaBroker',[\r\n    'lodash',\r\n    'core/areaBroker'\r\n], function (_, areaBroker) {\r\n    'use strict';\r\n\r\n    var requireAreas = [\r\n        'menu',\r\n        'menuLeft',\r\n        'menuRight',\r\n        'title',\r\n        'interactionPanel',\r\n        'itemPanel',\r\n        'propertyPanel',\r\n        'itemPropertyPanel',\r\n        'itemStylePanel',\r\n        'modalContainer'\r\n    ];\r\n\r\n    /**\r\n     * Creates an area broker with the required areas for the item creator\r\n     *\r\n     * @see core/areaBroker\r\n     *\r\n     * @param {jQueryElement|HTMLElement|String} $container - the main container\r\n     * @param {Object} mapping - keys are the area names, values are jQueryElement\r\n     * @returns {broker} the broker\r\n     * @throws {TypeError} without a valid container\r\n     */\r\n    return _.partial(areaBroker, requireAreas);\r\n\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/plugins/button', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<li class=\\\"btn-info small \";\n  if (helper = helpers.cssClass) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.cssClass); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" title=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"li-inner\\\"><span class=\\\"icon-\";\n  if (helper = helpers.icon) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.icon); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span>\";\n  if (helper = helpers.text) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.text); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\r\\n</li>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\r\n/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * This plugin adds a save button to the menu.\r\n * Could be useful, or not (Save is so 90's, we want auto-saving with undo/redo capabilities)\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/menu/save',[\r\n    'jquery',\r\n    'i18n',\r\n    'core/plugin',\r\n    'ui/hider',\r\n    'tpl!taoQtiItem/qtiCreator/plugins/button'\r\n], function($, __, pluginFactory, hider, buttonTpl){\r\n    'use strict';\r\n\r\n    /**\r\n     * Returns the configured plugin\r\n     * @returns {Function} the plugin\r\n     */\r\n    return pluginFactory({\r\n\r\n        name : 'save',\r\n\r\n        /**\r\n         * Initialize the plugin (called during itemCreator's init)\r\n         */\r\n        init : function init(){\r\n            var self = this;\r\n            var itemCreator = this.getHost();\r\n\r\n            this.$element = $(buttonTpl({\r\n                icon: 'save',\r\n                title: __('Save the item'),\r\n                text : __('Save'),\r\n                cssClass: 'save-trigger'\r\n            })).on('click', function saveHandler(e){\r\n                e.preventDefault();\r\n                self.disable();\r\n                itemCreator.trigger('save');\r\n            });\r\n\r\n            this.hide();\r\n            this.disable();\r\n\r\n            itemCreator.on('ready saved error', function(){\r\n                self.enable();\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Called during the itemCreator's render phase\r\n         */\r\n        render : function render(){\r\n\r\n            //attach the element to the menu area\r\n            var $container = this.getAreaBroker().getMenuArea();\r\n            $container.append(this.$element);\r\n            this.show();\r\n        },\r\n\r\n        /**\r\n         * Called during the itemCreator's destroy phase\r\n         */\r\n        destroy : function destroy (){\r\n            this.$element.remove();\r\n        },\r\n\r\n        /**\r\n         * Enable the button\r\n         */\r\n        enable : function enable (){\r\n            this.$element.removeProp('disabled')\r\n                         .removeClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Disable the button\r\n         */\r\n        disable : function disable (){\r\n            this.$element.prop('disabled', true)\r\n                         .addClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Show the button\r\n         */\r\n        show: function show(){\r\n            hider.show(this.$element);\r\n        },\r\n\r\n        /**\r\n         * Hide the button\r\n         */\r\n        hide: function hide(){\r\n            hider.hide(this.$element);\r\n        }\r\n    });\r\n});\r\n\n","\ndefine(\"json!taoItems/preview/resources/device-list.json\", function(){ return {\r\n    \"tablets\": {\r\n        \"193986c3715c81838870f908fa98d69a\": {\r\n            \"label\": \"Amazon Kindle Fire HDX 7\\u2033\",\r\n            \"width\": 960,\r\n            \"height\": 600\r\n        },\r\n        \"4e8eafab11aad1486992d7ee2c8c16ca\": {\r\n            \"label\": \"Apple iPad\",\r\n            \"width\": 1024,\r\n            \"height\": 768\r\n        },\r\n        \"5aac2932d9ad00d6d8a1604b8f9e4e8d\": {\r\n            \"label\": \"Google Nexus 10, Motorola Xoom, Xyboard\",\r\n            \"width\": 1280,\r\n            \"height\": 800\r\n        },\r\n        \"9805d9753ad08c7630a9ee5418aa6c6c\": {\r\n            \"label\": \"Google Nexus 7\",\r\n            \"width\": 966,\r\n            \"height\": 604\r\n        },\r\n        \"d4a431cedf4705d6bf2cba6d5788378b\": {\r\n            \"label\": \"Samsung Galaxy Tab 7.7, 8.9, 10.1\",\r\n            \"width\": 1280,\r\n            \"height\": 800\r\n        }\r\n    },\r\n    \"phones\": {\r\n        \"1b89338531ef0155c8d6abc2ac02c81a\": {\r\n            \"label\": \"Apple iPhone 3GS\",\r\n            \"width\": 320,\r\n            \"height\": 480,\r\n            \"scaleFactor\": 1,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 480\r\n        },\r\n        \"3f89da99d84214cde7df87ebe0699a6f\": {\r\n            \"label\": \"Apple iPhone 4\",\r\n            \"width\": 640,\r\n            \"height\": 960,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 1920\r\n        },\r\n        \"0d36971a5b98b367f54ced708c9af849\": {\r\n            \"label\": \"Apple iPhone 5\",\r\n            \"width\": 640,\r\n            \"height\": 1136,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 2272\r\n        },\r\n        \"026beffcc051af995660ebdede986ace\": {\r\n            \"label\": \"BlackBerry Z10\",\r\n            \"width\": 768,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 384,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"fd2dd53e667d6d49e4fa73356fa941dd\": {\r\n            \"label\": \"BlackBerry Z30\",\r\n            \"width\": 720,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"707584c1ae17d9b5b2cbe8603c91c147\": {\r\n            \"label\": \"Google Nexus 4\",\r\n            \"width\": 768,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 384,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"91823264de952e7f2347e07db5c4058b\": {\r\n            \"label\": \"Google Nexus 5\",\r\n            \"width\": 1080,\r\n            \"height\": 1920,\r\n            \"scaleFactor\": 3,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 5760\r\n        },\r\n        \"cd69817a6e147e8a4677389e56fcf568\": {\r\n            \"label\": \"Google Nexus S\",\r\n            \"width\": 480,\r\n            \"height\": 800,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 1200\r\n        },\r\n        \"75994faa6a38e31e99b53fcd75534a33\": {\r\n            \"label\": \"HTC Evo, Touch HD, Desire HD, Desire\",\r\n            \"width\": 480,\r\n            \"height\": 800,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 1200\r\n        },\r\n        \"0cab4dfccdfc880687cb608cfe4159db\": {\r\n            \"label\": \"HTC One X, EVO LTE\",\r\n            \"width\": 720,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"c4ff41fcba24d74fc21dc3490ca1edc9\": {\r\n            \"label\": \"HTC Sensation, Evo 3D\",\r\n            \"width\": 540,\r\n            \"height\": 960,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 1440\r\n        },\r\n        \"fa969a5e0dd2de53700eeee4ba4ba142\": {\r\n            \"label\": \"LG Optimus 2X, Optimus 3D, Optimus Black\",\r\n            \"width\": 480,\r\n            \"height\": 800,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 1200\r\n        },\r\n        \"33c4f9364e295ec03531f3a3425819cf\": {\r\n            \"label\": \"LG Optimus G\",\r\n            \"width\": 768,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 384,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"bc47f5275f0efd56fee52d43a8082981\": {\r\n            \"label\": \"LG Optimus LTE, Optimus 4X HD\",\r\n            \"width\": 720,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 1.7,\r\n            \"dpWidth\": 424,\r\n            \"dpHeight\": 2176\r\n        },\r\n        \"0732887e6e324fd10777b735520a34cf\": {\r\n            \"label\": \"LG Optimus One\",\r\n            \"width\": 320,\r\n            \"height\": 480,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 213,\r\n            \"dpHeight\": 720\r\n        },\r\n        \"2e38a78364f09d0da0e9e1a3a68e7fb0\": {\r\n            \"label\": \"Motorola Defy, Droid, Droid X, Milestone\",\r\n            \"width\": 480,\r\n            \"height\": 854,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 1281\r\n        },\r\n        \"bd4b78dddc7c9625a4141a1b1ddabb87\": {\r\n            \"label\": \"Motorola Droid 3, Droid 4, Droid Razr, Atrix 4G, Atrix 2\",\r\n            \"width\": 540,\r\n            \"height\": 960,\r\n            \"scaleFactor\": 1,\r\n            \"dpWidth\": 540,\r\n            \"dpHeight\": 960\r\n        },\r\n        \"3bf1edf21cfa81006183d2b02974c84e\": {\r\n            \"label\": \"Motorola Droid Razr HD\",\r\n            \"width\": 720,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 1,\r\n            \"dpWidth\": 720,\r\n            \"dpHeight\": 1280\r\n        },\r\n        \"ab5a352e0e016b97dac986f06c394f55\": {\r\n            \"label\": \"Nokia C5, C6, C7, N97, N8, X7\",\r\n            \"width\": 360,\r\n            \"height\": 640,\r\n            \"scaleFactor\": 1,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 640\r\n        },\r\n        \"4826fb7d7257aeaac992ce699df41b3c\": {\r\n            \"label\": \"Nokia Lumia 7X0, Lumia 8XX, Lumia 900, N800, N810, N900\",\r\n            \"width\": 480,\r\n            \"height\": 800,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 1200\r\n        },\r\n        \"0a691ab20add7c432200f8fa6527b488\": {\r\n            \"label\": \"Samsung Galaxy Note\",\r\n            \"width\": 800,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 400,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"9c23ee31be29960fbac9e9bbfc2fc7b0\": {\r\n            \"label\": \"Samsung Galaxy Note 3\",\r\n            \"width\": 1080,\r\n            \"height\": 1920,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 540,\r\n            \"dpHeight\": 3840\r\n        },\r\n        \"92177c0508c1d73905a58e2338f2a81f\": {\r\n            \"label\": \"Samsung Galaxy Note II\",\r\n            \"width\": 720,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"5222b8866dc4cc606725e16ffcc0a783\": {\r\n            \"label\": \"Samsung Galaxy S III, Galaxy Nexus\",\r\n            \"width\": 720,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"37c1541e2bd55cfd0f4073b0ccdf68b3\": {\r\n            \"label\": \"Samsung Galaxy S, S II, W\",\r\n            \"width\": 480,\r\n            \"height\": 800,\r\n            \"scaleFactor\": 1.5,\r\n            \"dpWidth\": 320,\r\n            \"dpHeight\": 1200\r\n        },\r\n        \"2f7f64b7dda0144907ff300e83eed465\": {\r\n            \"label\": \"Samsung Galaxy S4\",\r\n            \"width\": 1080,\r\n            \"height\": 1920,\r\n            \"scaleFactor\": 3,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 5760\r\n        },\r\n        \"9c24f9057744dad56043702a9703127f\": {\r\n            \"label\": \"Sony Xperia S, Ion\",\r\n            \"width\": 720,\r\n            \"height\": 1280,\r\n            \"scaleFactor\": 2,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 2560\r\n        },\r\n        \"0a8b2732a016a9395c3af5f12dd9c0da\": {\r\n            \"label\": \"Sony Xperia Sola, U\",\r\n            \"width\": 480,\r\n            \"height\": 854,\r\n            \"scaleFactor\": 1,\r\n            \"dpWidth\": 480,\r\n            \"dpHeight\": 854\r\n        },\r\n        \"5a153d7f53d82dcb0801f041574a6a43\": {\r\n            \"label\": \"Sony Xperia Z, Z1\",\r\n            \"width\": 1080,\r\n            \"height\": 1920,\r\n            \"scaleFactor\": 3,\r\n            \"dpWidth\": 360,\r\n            \"dpHeight\": 5760\r\n        }\r\n    },\r\n    \"screens\": {\r\n        \"9e523ae15b61dc766f5c818726881ecf\": {\r\n            \"label\": \"1920 \\u00d7 1080\",\r\n            \"width\": 1920,\r\n            \"height\": 1080,\r\n            \"dpWidth\": 1920,\r\n            \"dpHeight\": 1080,\r\n            \"scaleFactor\": 1\r\n        },\r\n        \"07769cd8d0a7d09818b2f0b018042fb7\": {\r\n            \"label\": \"1366 \\u00d7 768\",\r\n            \"width\": 1366,\r\n            \"height\": 768,\r\n            \"dpWidth\": 1366,\r\n            \"dpHeight\": 768,\r\n            \"scaleFactor\": 1\r\n        },\r\n        \"72d5478a24194f98b9378e8e0fd65737\": {\r\n            \"label\": \"1280 \\u00d7 1024\",\r\n            \"width\": 1280,\r\n            \"height\": 1024,\r\n            \"dpWidth\": 1280,\r\n            \"dpHeight\": 1024,\r\n            \"scaleFactor\": 1\r\n        },\r\n        \"b7a6dd5900cc72e61f0d3479c7e314ec\": {\r\n            \"label\": \"1280 \\u00d7 800\",\r\n            \"width\": 1280,\r\n            \"height\": 800,\r\n            \"dpWidth\": 1280,\r\n            \"dpHeight\": 800,\r\n            \"scaleFactor\": 1\r\n        },\r\n        \"43193b0ff671a37d8232ab664190a125\": {\r\n            \"label\": \"1024 \\u00d7 768\",\r\n            \"width\": 1024,\r\n            \"height\": 768,\r\n            \"dpWidth\": 1024,\r\n            \"dpHeight\": 768,\r\n            \"scaleFactor\": 1\r\n        },\r\n        \"c29e48814af5443ff5688d9e967ce917\": {\r\n            \"label\": \"800 \\u00d7 600\",\r\n            \"width\": 800,\r\n            \"height\": 600,\r\n            \"dpWidth\": 800,\r\n            \"dpHeight\": 600,\r\n            \"scaleFactor\": 1\r\n        }\r\n    }\r\n};});\n\n","\ndefine('tpl!taoItems/preview/tpl/preview', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n                        <option value=\\\"\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n                        \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n                    <select class=\\\"preview-theme-selector\\\">\\r\\n                        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.themes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                    </select>\\r\\n                    \";\n  return buffer;\n  }\n\nfunction program6(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n                        <option value=\\\"\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-value=\\\"\";\n  if (helper = helpers.dataValue) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.dataValue); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n                        \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"preview-overlay tao-scope overlay preview-\";\n  if (helper = helpers.previewType) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.previewType); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \" item-no-print\\\"\\r\\n     style=\\\"display:none\\\">\\r\\n    <div class=\\\"preview-container-outer\\\">\\r\\n        <form class=\\\"preview-utility-bar plain\\\">\\r\\n            <div class=\\\"preview-utility-bar-inner grid-row\\\">\\r\\n\\r\\n                <div class=\\\"col-4\\\">\\r\\n                    <input type=\\\"hidden\\\" value=\\\"\\\" data-value=\\\"\\\" class=\\\"standard-device-selector preview-device-selector\\\" data-target=\\\"standard\\\">\\r\\n                    <select class=\\\"preview-type-selector\\\">\\r\\n                        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.previewTypes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                    </select>\\r\\n                    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.hasThemes), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                </div>\\r\\n                <div class=\\\"col-6 standard-only device-type-and-orientation\\\"></div>\\r\\n                <div class=\\\"col-6 desktop-only device-type-and-orientation\\\">\\r\\n                    <select class=\\\"desktop-device-selector preview-device-selector\\\" data-target=\\\"desktop\\\">\\r\\n                        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.desktopDevices), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                    </select>\\r\\n                </div>\\r\\n                <div class=\\\"col-6 mobile-only device-type-and-orientation\\\">\\r\\n                    <select class=\\\"mobile-device-selector preview-device-selector\\\" data-target=\\\"mobile\\\">\\r\\n                        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.mobileDevices), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                    </select>\\r\\n                    <select tabindex=\\\"-1\\\" class=\\\"mobile-orientation-selector orientation-selector\\\"\\r\\n                            data-target=\\\"mobile\\\">\\r\\n                        <option value=\\\"landscape\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Landscape\", options) : helperMissing.call(depth0, \"__\", \"Landscape\", options)))\n    + \"</option>\\r\\n                        <option value=\\\"portrait\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Portrait\", options) : helperMissing.call(depth0, \"__\", \"Portrait\", options)))\n    + \"</option>\\r\\n                    </select>\\r\\n                </div>\\r\\n                <div class=\\\"col-2\\\">\\r\\n                    <span class=\\\"btn-info small preview-closer rgt\\\">\\r\\n                        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Close\", options) : helperMissing.call(depth0, \"__\", \"Close\", options)))\n    + \"\\r\\n                        <span class=\\\"icon-close r\\\"></span>\\r\\n                    </span>\\r\\n                </div>\\r\\n            </div>\\r\\n            <div class=\\\"preview-message-box\\\">\\r\\n                <div class=\\\"feedback-info small\\\">\\r\\n                    <span class=\\\"icon-info\\\"></span>\\r\\n                    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"This preview may be scaled to fit your screen. The final rendering may differ.\", options) : helperMissing.call(depth0, \"__\", \"This preview may be scaled to fit your screen. The final rendering may differ.\", options)))\n    + \"\\r\\n                    <a href=\\\"#\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Don’t show this again!\", options) : helperMissing.call(depth0, \"__\", \"Don’t show this again!\", options)))\n    + \"</a>\\r\\n                    <span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove this message\", options) : helperMissing.call(depth0, \"__\", \"Remove this message\", options)))\n    + \"\\\" class=\\\"icon-close close-trigger\\\"></span>\\r\\n                </div>\\r\\n            </div>\\r\\n        </form>\\r\\n        <div class=\\\"preview-canvas\\\">\\r\\n            <div class=\\\"preview-scale-container\\\">\\r\\n                <div class=\\\"\";\n  if (helper = helpers.previewType) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.previewType); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"-preview-frame preview-outer-frame \";\n  if (helper = helpers.previewType) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.previewType); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"-preview-landscape\\\">\\r\\n                    <div class=\\\"\";\n  if (helper = helpers.previewType) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.previewType); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"-preview-container preview-container\\\">\\r\\n                        <div class=\\\"preview-item-container\\\"></div>\\r\\n                    </div>\\r\\n                </div>\\r\\n            </div>\\r\\n        </div>\\r\\n    </div>\\r\\n\\r\\n\\r\\n    <div id=\\\"preview-console\\\">\\r\\n        <span class=\\\"icon-close preview-console-closer\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Close console\", options) : helperMissing.call(depth0, \"__\", \"Close console\", options)))\n    + \"\\\"></span>\\r\\n        <div class=\\\"preview-console-header grid-row clearfix\\\">\\r\\n            <ul class=\\\"col-10 plain action-bar extra-button-action-bar horizontal-action-bar\\\">\\r\\n            </ul>\\r\\n            <ul class=\\\"col-2 plain action-bar console-button-action-bar horizontal-action-bar\\\">\\r\\n                <li class=\\\"small btn-info action action-button rgt\\\" id=\\\"preview-submit-button\\\">\\r\\n                    <a class=\\\"li-inner\\\" href=\\\"#\\\">\\r\\n                        <span class=\\\"label\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Submit\", options) : helperMissing.call(depth0, \"__\", \"Submit\", options)))\n    + \"</span>\\r\\n                    </a>\\r\\n                </li>\\r\\n            </ul>\\r\\n        </div>\\r\\n        <div class=\\\"preview-console-body clear\\\">\\r\\n            <ul></ul>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\\r\\n\\r\\n\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('css!taoItemsCss/preview',[],function(){});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Techniologies SA\r\n *\r\n */\r\ndefine('taoItems/preview/preview',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'util/strPad',\r\n    'core/promise',\r\n    'json!taoItems/preview/resources/device-list.json',\r\n    'tpl!taoItems/preview/tpl/preview',\r\n    'ui/themes',\r\n    'ui/themeLoader',\r\n    'urlParser',\r\n    'ui/modal',\r\n    'select2',\r\n    'jquery.cookie',\r\n    'css!taoItemsCss/preview'\r\n], function ($, _, __, strPad, Promise, deviceList, previewTpl, themeHandler, themeLoader, UrlParser) {\r\n    'use strict';\r\n\r\n\r\n    var overlay,\r\n        container,\r\n        orientation = 'landscape',\r\n        previewType = 'standard',\r\n        previewTypes = {\r\n            desktop: __('Desktop preview'),\r\n            mobile: __('Mobile preview'),\r\n            standard: __('Actual size')\r\n        },\r\n        themeObj = themeHandler.get('items') || {},\r\n        $doc = $(document),\r\n        $window = $(window),\r\n        $body = $(document.body),\r\n        screenSize = {\r\n            width: $window.innerWidth(),\r\n            height: $window.innerHeight()\r\n        },\r\n        sizeSettings = {\r\n            width: 0,\r\n            height: 0\r\n        },\r\n        scaleFactor = 1,\r\n        typeDependant,\r\n        $feedbackBox,\r\n        $console,\r\n        previewContainerMaxWidth,\r\n        itemUri,\r\n        state,\r\n        winScrollObj = { x:0, y:0 };\r\n\r\n\r\n    /**\r\n     * Create data set for device selectors\r\n     *\r\n     * @param type\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    var _getDeviceSelectorData = function (type) {\r\n\r\n        /*\r\n         * @todo\r\n         * The device list is currently based on the devices found on the Chrome emulator.\r\n         * This is not ideal and should be changed in the future.\r\n         * I have http://en.wikipedia.org/wiki/List_of_displays_by_pixel_density in mind but we\r\n         * will need to figure what criteria to apply when generating the list.\r\n         */\r\n        var devices = type === 'mobile' ? deviceList.tablets : deviceList.screens,\r\n            options = [];\r\n\r\n        _.forEach(devices, function (value) {\r\n\r\n            options.push({\r\n                value: value.label,\r\n                label: value.label,\r\n                dataValue: [value.width, value.height].join(','),\r\n                selected: previewType === value.label\r\n            });\r\n        });\r\n\r\n\r\n        return options;\r\n    };\r\n\r\n    /**\r\n     * Collect all elements that can toggle their class name between mobile-* and desktop-*\r\n     *\r\n     * @private\r\n     */\r\n    var _setupTypeDependantElements = function () {\r\n        typeDependant = overlay.add(overlay.find('.preview-scale-container').find('[class*=\"' + previewType + '\"]'));\r\n    };\r\n\r\n\r\n    /**\r\n     * Change the class name of all type dependant elements\r\n     *\r\n     * @param {String} newType\r\n     */\r\n    var _setPreviewType = function (newType) {\r\n\r\n        if (newType === previewType) {\r\n            return;\r\n        }\r\n        var re = new RegExp(previewType, 'g');\r\n\r\n        typeDependant.each(function (i, el) {\r\n            el.className = el.className.replace(re, newType);\r\n        });\r\n\r\n        previewType = newType;\r\n    };\r\n\r\n\r\n    /**\r\n     * Set orientation\r\n     *\r\n     * @param {String} newOrientation\r\n     * @private\r\n     */\r\n    var _setOrientation = function (newOrientation) {\r\n        if (newOrientation === orientation) {\r\n            return;\r\n        }\r\n\r\n        var re = new RegExp(orientation, 'g'),\r\n            previewFrame = $('.preview-outer-frame')[0];\r\n\r\n        previewFrame.className = previewFrame.className.replace(re, newOrientation);\r\n\r\n        // reset global orientation\r\n        orientation = newOrientation;\r\n    };\r\n\r\n    /**\r\n     * Scale devices down to fit screen\r\n     * @private\r\n     */\r\n    var _scale = function () {\r\n\r\n        _computeScaleFactor();\r\n\r\n        var $scaleContainer = $('.preview-scale-container'),\r\n            _scaleFactor = previewType === 'standard' ? 1 : scaleFactor,\r\n            containerScaledWidth = $scaleContainer.width() * _scaleFactor,\r\n            left = (screenSize.width - containerScaledWidth) / 2;\r\n\r\n        $scaleContainer.css({\r\n            left: left > 0 ? left : 0,\r\n            '-webkit-transform': 'scale(' + _scaleFactor + ',' + _scaleFactor + ')',\r\n            '-ms-transform': 'scale(' + _scaleFactor + ',' + _scaleFactor + ')',\r\n            'transform': 'scale(' + _scaleFactor + ',' + _scaleFactor + ')',\r\n            '-webkit-transform-origin': '0 0',\r\n            '-ms-transform-origin': '0 0',\r\n            'transform-origin': '0 0'\r\n        });\r\n    };\r\n\r\n    /**\r\n     * position the preview depending on the height of the toolbar\r\n     *\r\n     * @private\r\n     */\r\n    var _positionPreview = function () {\r\n        var topBarHeight = $(\".preview-utility-bar\").outerHeight();\r\n\r\n        overlay[0].style.top = topBarHeight + 'px';\r\n        overlay[0].style.maxHeight = 'calc(100vh - ' + topBarHeight + 'px - ' + $console.outerHeight() + 'px )';\r\n    };\r\n\r\n\r\n    /**\r\n     * Compute scale factor based on screen size and device size\r\n     *\r\n     * @private\r\n     */\r\n    var _computeScaleFactor = function () {\r\n\r\n        var scaleValues = {\r\n            x: 1,\r\n            y: 1\r\n        };\r\n\r\n        // 150/200 = device frames plus toolbar plus console plus some margin\r\n\r\n        var requiredSize = {\r\n            width: sizeSettings.width + 150,\r\n            height: sizeSettings.height + 275\r\n        };\r\n\r\n        if (requiredSize.width > screenSize.width) {\r\n            scaleValues.x = screenSize.width / requiredSize.width;\r\n        }\r\n\r\n        if (requiredSize.height > screenSize.height) {\r\n            scaleValues.y = screenSize.height / requiredSize.height;\r\n        }\r\n\r\n        scaleFactor = Math.min(scaleValues.x, scaleValues.y);\r\n    };\r\n\r\n    /**\r\n     * Add functionality to device selectors\r\n     *\r\n     * @private\r\n     */\r\n    var _setupDeviceSelectors = function () {\r\n\r\n\r\n        var previewDeviceSelectors = overlay.find('.preview-device-selector');\r\n\r\n        previewDeviceSelectors.on('change', function () {\r\n            var elem = $(this),\r\n                option = this.nodeName.toLowerCase() === 'select' ? this.options[this.selectedIndex] : this,\r\n                type = elem.data('target'),\r\n                val = $(option).data('value').split(','),\r\n                i = val.length,\r\n                container = overlay.find('.' + type + '-preview-container');\r\n\r\n\r\n            while (i--) {\r\n                val[i] = parseFloat(val[i]);\r\n            }\r\n\r\n            if (type === 'mobile' && orientation === 'portrait') {\r\n                sizeSettings = {\r\n                    width: val[1],\r\n                    height: val[0]\r\n                };\r\n            }\r\n            else {\r\n                sizeSettings = {\r\n                    width: val[0],\r\n                    height: val[1]\r\n                };\r\n            }\r\n\r\n            if (sizeSettings.width === container.width() && sizeSettings.height === container.height()) {\r\n                return false;\r\n            }\r\n\r\n            _setPreviewType(type);\r\n            container.css(sizeSettings);\r\n            _scale();\r\n            _adaptFrameSize();\r\n        });\r\n\r\n        previewDeviceSelectors.each(function () {\r\n            if (this.nodeName.toLowerCase() === 'select') {\r\n                $(this).select2({\r\n                    minimumResultsForSearch: -1\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Setup orientation selector. There is no actual orientation switch for desktop but it could\r\n     * be added easily if required.\r\n     * @private\r\n     */\r\n    var _setupOrientationSelectors = function () {\r\n\r\n        $('select.orientation-selector').on('change',function () {\r\n\r\n            var type = $(this).data('target'),\r\n                previewFrame = $('.' + type + '-preview-frame'),\r\n                container = previewFrame.find('.' + type + '-preview-container'),\r\n                newOrientation = $(this).val();\r\n\r\n            if (newOrientation === orientation) {\r\n                return false;\r\n            }\r\n\r\n            sizeSettings = {\r\n                height: container.width(),\r\n                width: container.height()\r\n            };\r\n\r\n            container.css(sizeSettings);\r\n\r\n            _setOrientation(newOrientation);\r\n\r\n            _scale();\r\n            _adaptFrameSize();\r\n\r\n\r\n        }).select2({\r\n            minimumResultsForSearch: -1\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Close preview\r\n     *\r\n     * @returns {*|HTMLElement}\r\n     */\r\n    var _setupClosers = function () {\r\n        var $closer = overlay.find('.preview-closer'),\r\n            $feedbackCloser = $feedbackBox.find('.close-trigger'),\r\n            $hideForever = $feedbackBox.find('a');\r\n        var $iframe = $('#preview-iframe');\r\n\r\n        $closer.on('click', function () {\r\n            $doc.trigger('itemunload.preview');\r\n//            commonRenderer.setContext($('.item-editor-item'));\r\n\r\n            window.scrollTo(winScrollObj.x, winScrollObj.y);\r\n\r\n            overlay.hide();\r\n            $body.removeClass('preview-mode');\r\n\r\n            //empty the iframe\r\n            $iframe.off('load').attr('src', 'about:blank');\r\n        });\r\n\r\n        $doc.keyup(function (e) {\r\n            if (e.keyCode === 27) {\r\n                $closer.trigger('click');\r\n            }\r\n        });\r\n\r\n        $feedbackCloser.on('click', function () {\r\n            $feedbackBox.hide();\r\n            $body.addClass('no-preview-feedback');\r\n            _positionPreview();\r\n            _scale();\r\n        });\r\n\r\n        $hideForever.on('click', function (e) {\r\n            e.preventDefault();\r\n            $.cookie('hidePreviewFeedback', true, { expires: 1000, path: '/' });\r\n            $feedbackCloser.trigger('click');\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Build options for themes\r\n     *\r\n     * @todo is there a way to know the selected theme?\r\n     *\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    var _getThemes = function() {\r\n\r\n        var options = [];\r\n        var activeTheme;\r\n\r\n        //don't load themes if there is none\r\n        if(_.isPlainObject(themeObj) && !_.isEmpty(themeObj.base)){\r\n            activeTheme = themeLoader(themeObj).getActiveTheme();\r\n\r\n            _(themeObj.available).forEach(function (data) {\r\n                options.push({\r\n                    value: data.id,\r\n                    label: data.name,\r\n                    selected: data.id === activeTheme\r\n                });\r\n            });\r\n        }\r\n        return options;\r\n    };\r\n\r\n    /**\r\n     * Build options for preview types\r\n     *\r\n     * @returns {Array}\r\n     * @private\r\n     */\r\n    var _getPreviewTypes = function () {\r\n        var options = [];\r\n        _(previewTypes).forEach(function (_previewLabel, _previewType) {\r\n            options.push({\r\n                value: _previewType,\r\n                label: _previewLabel,\r\n                selected: previewType === _previewType\r\n            });\r\n        });\r\n        return options;\r\n    };\r\n\r\n    /**\r\n     * Select preview type\r\n     *\r\n     * @private\r\n     */\r\n    var _setupViewSelector = function () {\r\n\r\n        $('select.preview-type-selector').on('change',function () {\r\n            var _previewType = $(this),\r\n                value = _previewType.val();\r\n\r\n            _setPreviewType(value);\r\n\r\n            $('.' + value + '-device-selector').trigger('change');\r\n        }).select2({\r\n            minimumResultsForSearch: -1\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Select preview theme\r\n     *\r\n     * @private\r\n     */\r\n    var _setupThemeSelector = function () {\r\n        $('select.preview-theme-selector').on('change',function () {\r\n            var iframe = document.getElementById('preview-container');\r\n            var iframeDoc = iframe.contentWindow || iframe.contentDocument;\r\n            iframeDoc.$('.qti-item').trigger('themechange', [$(this).val()]);\r\n\r\n        }).select2({\r\n            minimumResultsForSearch: -1\r\n        });\r\n\r\n    };\r\n\r\n    var _adaptFrameSize = function () {\r\n\r\n        var $previewContainer = $('.preview-container'),\r\n            $iframe = (function () {\r\n                var _iframe = $previewContainer.find('iframe');\r\n                _iframe.height('');\r\n                return _iframe;\r\n            }()),\r\n            contentHeight = $iframe.contents().outerHeight(),\r\n            containerHeight = $previewContainer.innerHeight();\r\n\r\n        if (previewType !== 'standard') {\r\n            if (contentHeight < containerHeight) {\r\n                contentHeight = containerHeight;\r\n            }\r\n        }\r\n        else {\r\n            $previewContainer.height(contentHeight + 10);\r\n        }\r\n\r\n        $iframe.height(contentHeight);\r\n    };\r\n\r\n\r\n    /**\r\n     * Set the size for the standard preview\r\n     * @param height\r\n     * @private\r\n     */\r\n    var _updateStandardPreviewSize = function (height) {\r\n        var $selector = $('.standard-device-selector'),\r\n            values = ($selector.val() ? $selector.val().split(',') : '') || [$window.width().toString()],\r\n            valueStr = values.join(',');\r\n\r\n        values[1] = height || values[1] || '1200';\r\n\r\n        $selector.val(valueStr).data('value', valueStr);\r\n    };\r\n\r\n\r\n    /**\r\n     * Console\r\n     *\r\n     * @private\r\n     */\r\n    var _initConsole = function () {\r\n        var $body = $console.find('.preview-console-body'),\r\n            $listing = $body.find('ul'),\r\n            $closer = $console.find('.preview-console-closer');\r\n\r\n        $console.off('updateConsole').on('updateConsole', function (event, type, message) {\r\n            var timer = new Date(),\r\n                logTime = [\r\n                    strPad(timer.getHours(), 2, '0', 'STR_PAD_LEFT'),\r\n                    strPad(timer.getMinutes(), 2, '0', 'STR_PAD_LEFT'),\r\n                    strPad(timer.getSeconds(), 2, '0', 'STR_PAD_LEFT')\r\n                ].join(':'),\r\n                msgStr = '<span class=\"log-time\">' + strPad(logTime, 12, ' ') + '</span> ' +\r\n                    '<span class=\"log-type\">' + strPad(type, 18, ' ') + '</span> ' +\r\n                    '<span class=\"log-message\">' + strPad(message, 18, ' ') + '</span>';\r\n            $listing.append('<li><pre>' + msgStr + '</pre></li>');\r\n            if (!$body.is(':visible')) {\r\n                $body.slideDown('slow', function () {\r\n                    $closer.show();\r\n                    $listing.scrollTop(10000);\r\n                });\r\n            }\r\n            else {\r\n                $listing.scrollTop(10000);\r\n            }\r\n        });\r\n\r\n        $closer.on('click', function () {\r\n            $body.slideUp('slow', function () {\r\n                $closer.hide();\r\n            });\r\n        });\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * Display the preview\r\n     * @returns {Promise} resolve once the preview is shown\r\n     */\r\n    var show = function () {\r\n        return new Promise(function (resolve, reject){\r\n            var parsed = new UrlParser(itemUri);\r\n            parsed.params.state = JSON.stringify(state);\r\n            $.ajax({\r\n                url: itemUri,\r\n                dataType: 'html',\r\n                method : 'POST',\r\n                data : parsed.params\r\n            }).done(function (data) {\r\n\r\n                winScrollObj = { x: window.scrollX, y: window.scrollY };\r\n                window.scrollTo(0,0);\r\n\r\n                $body.addClass('preview-mode');\r\n\r\n                // $.show() does not work from the item manager\r\n                // this is either a miracle or a jquery bug\r\n                // overlay.hide().show();\r\n                overlay[0].style.display = 'block';\r\n\r\n                overlay.find('select:visible').not('.preview-theme-selector').trigger('change');\r\n                _scale();\r\n                _positionPreview();\r\n                $('.preview-item-container').html(data);\r\n                resolve();\r\n\r\n            }).fail(function(xhr){\r\n                reject(new Error(__('Unable to render the item from %s : %s %s', itemUri, xhr.status, xhr.statusText)));\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Setting up screen size according preview viewport size\r\n     * @private\r\n     */\r\n    function _setupScreenSize() {\r\n        screenSize = {\r\n            width: $('.preview-overlay').innerWidth(),\r\n            height: $('.preview-overlay').innerHeight()\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Create preview\r\n     *\r\n     * @param {String} _itemUri\r\n     * @param {Object} _state\r\n     */\r\n    var init = function (_itemUri, _state) {\r\n\r\n        if(!_itemUri || _itemUri.length === 0){\r\n            throw new TypeError('Wrong URI');\r\n        }\r\n\r\n        $('.preview-overlay').remove();\r\n        container = null;\r\n        overlay = $(previewTpl({\r\n            mobileDevices: _getDeviceSelectorData('mobile'),\r\n            desktopDevices: _getDeviceSelectorData('desktop'),\r\n            previewTypes: _getPreviewTypes(),\r\n            previewType: previewType,\r\n            themes: _getThemes(),\r\n            hasThemes: _.size(themeObj.available) > 1\r\n        }));\r\n\r\n        $body.append(overlay);\r\n\r\n        previewContainerMaxWidth = parseInt($('.preview-container').css('max-width'), 10);\r\n\r\n        $feedbackBox = overlay.find('.preview-message-box');\r\n        if ($.cookie('hidePreviewFeedback')) {\r\n            $feedbackBox.hide();\r\n            $body.addClass('no-preview-feedback');\r\n        }\r\n\r\n        $console = overlay.find('#preview-console');\r\n\r\n        _initConsole();\r\n        _updateStandardPreviewSize();\r\n        _setupTypeDependantElements();\r\n        _setupDeviceSelectors();\r\n        _setupOrientationSelectors();\r\n        _setupViewSelector();\r\n        _setupThemeSelector();\r\n        _setupClosers();\r\n        _setupScreenSize();\r\n        _computeScaleFactor();\r\n        _setPreviewType(previewType);\r\n        _setOrientation(orientation);\r\n\r\n        $window.on('resize orientationchange', function () {\r\n            _setupScreenSize();\r\n            _updateStandardPreviewSize();\r\n            _computeScaleFactor();\r\n            _scale();\r\n        });\r\n\r\n        itemUri = _itemUri;\r\n        state = _state;\r\n\r\n        return overlay;\r\n    };\r\n\r\n    return {\r\n        init: init,\r\n        show: show\r\n    };\r\n});\r\n\n","\r\n/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016-2017 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * This plugin displays add the preview button and launch it.\r\n * It also provides a mechanism that ask to save\r\n * the item before the preview (if the item has changed - should).\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/menu/preview',[\r\n    'jquery',\r\n    'i18n',\r\n    'core/plugin',\r\n    'ui/hider',\r\n    'taoItems/preview/preview',\r\n    'tpl!taoQtiItem/qtiCreator/plugins/button',\r\n    'util/url'\r\n], function($, __, pluginFactory, hider, preview, buttonTpl, urlUtil){\r\n    'use strict';\r\n\r\n    /**\r\n     * Returns the configured plugin\r\n     * @returns {Function} the plugin\r\n     */\r\n    return pluginFactory({\r\n\r\n        name : 'preview',\r\n\r\n        /**\r\n         * Initialize the plugin (called during itemCreator's init)\r\n         * @fires {itemCreator#preview}\r\n         */\r\n        init : function init(){\r\n            var self = this;\r\n            var itemCreator = this.getHost();\r\n\r\n            /**\r\n             * Preview an item\r\n             * @event itemCreator#preview\r\n             * @param {String} uri - the uri of this item to preview\r\n             */\r\n            itemCreator.on('preview', function(uri){\r\n\r\n                //TODO move away the URLs !!!\r\n                preview.init(urlUtil.build(itemCreator.getConfig().properties.previewUrl, {\r\n                    uri: uri\r\n                }));\r\n                preview.show();\r\n            });\r\n\r\n            //creates the preview button\r\n            this.$element = $(buttonTpl({\r\n                icon: 'preview',\r\n                title: __('Preview the item'),\r\n                text : __('Preview'),\r\n                cssClass: 'preview-trigger'\r\n            })).on('click', function previewHandler(e){\r\n                e.preventDefault();\r\n\r\n                self.disable();\r\n\r\n                itemCreator.trigger('preview', itemCreator.getItem().data('uri'));\r\n\r\n                self.enable();\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Initialize the plugin (called during itemCreator's render)\r\n         */\r\n        render : function render(){\r\n\r\n            //attach the element to the menu area\r\n            var $container = this.getAreaBroker().getMenuArea();\r\n            $container.append(this.$element);\r\n        },\r\n\r\n        /**\r\n         * Called during the itemCreator's destroy phase\r\n         */\r\n        destroy : function destroy (){\r\n            this.$element.remove();\r\n        },\r\n\r\n        /**\r\n         * Enable the button\r\n         */\r\n        enable : function enable (){\r\n            this.$element.removeProp('disabled')\r\n                         .removeClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Disable the button\r\n         */\r\n        disable : function disable (){\r\n            this.$element.prop('disabled', true)\r\n                         .addClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Show the button\r\n         */\r\n        show: function show(){\r\n            hider.show(this.$element);\r\n        },\r\n\r\n        /**\r\n         * Hide the button\r\n         */\r\n        hide: function hide(){\r\n            hider.hide(this.$element);\r\n        }\r\n    });\r\n});\r\n\n","\r\n/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * This plugin prints the item.\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/menu/print',[\r\n    'jquery',\r\n    'i18n',\r\n    'core/plugin',\r\n    'ui/hider',\r\n    'tpl!taoQtiItem/qtiCreator/plugins/button'\r\n], function($, __, pluginFactory, hider, buttonTpl){\r\n    'use strict';\r\n\r\n    /**\r\n     * Spread a css class to an element's parents and theirs siblings\r\n     * @param {jQueryElement} $container - the target\r\n     * @param {String} cssClass - the class to spread\r\n     */\r\n    var spreadClass = function spreadClass($container, cssClass) {\r\n        $container.parents().each(function initHideOnPrint() {\r\n            $(this).siblings().addClass(cssClass);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Returns the configured plugin\r\n     * @returns {Function} the plugin\r\n     */\r\n    return pluginFactory({\r\n\r\n        name : 'print',\r\n\r\n        /**\r\n         * Initialize the plugin (called during itemCreator's init)\r\n         */\r\n        init : function init(){\r\n            var self = this;\r\n\r\n            var itemCreator = this.getHost();\r\n\r\n            //spread the \"no item prin\" class an every element above the item panel\r\n            //FIXME this is a weird way, especially because the css class stays after the print...\r\n            spreadClass(this.getAreaBroker().getItemPanelArea(), 'item-no-print');\r\n\r\n            this.$element = $(buttonTpl({\r\n                icon: 'print',\r\n                title: __('Print the item'),\r\n                text : __('Print'),\r\n                cssClass: 'print-trigger'\r\n            })).on('click', function printHandler(e){\r\n                e.preventDefault();\r\n                window.print();\r\n            });\r\n\r\n            this.hide();\r\n            this.disable();\r\n\r\n            itemCreator.on('ready', function(){\r\n                self.enable();\r\n            });\r\n        },\r\n\r\n        render : function render(){\r\n\r\n            //attach the element to the menu area\r\n            var $container = this.getAreaBroker().getMenuArea();\r\n            $container.append(this.$element);\r\n            this.show();\r\n        },\r\n\r\n        /**\r\n         * Called during the itemCreator's destroy phase\r\n         */\r\n        destroy : function destroy (){\r\n            this.$element.remove();\r\n        },\r\n\r\n        /**\r\n         * Enable the button\r\n         */\r\n        enable : function enable (){\r\n            this.$element.removeProp('disabled')\r\n                         .removeClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Disable the button\r\n         */\r\n        disable : function disable (){\r\n            this.$element.prop('disabled', true)\r\n                         .addClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Show the button\r\n         */\r\n        show: function show(){\r\n            hider.show(this.$element);\r\n        },\r\n\r\n        /**\r\n         * Hide the button\r\n         */\r\n        hide: function hide(){\r\n            hider.hide(this.$element);\r\n        }\r\n    });\r\n});\r\n\n","\r\n/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * This plugin displays the item label (from\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/content/title',[\r\n    'jquery',\r\n    'i18n',\r\n    'core/plugin'\r\n], function($, __, pluginFactory){\r\n    'use strict';\r\n\r\n    /**\r\n     * Returns the configured plugin\r\n     * @returns {Function} the plugin\r\n     */\r\n    return pluginFactory({\r\n\r\n        name : 'title',\r\n\r\n        /**\r\n         * Hook to the host's init\r\n         */\r\n        init : function init(){\r\n            var config = this.getHost().getConfig();\r\n\r\n            if(config && config.properties && config.properties.label){\r\n                this.title = config.properties.label;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Hook to the host's render\r\n         */\r\n        render : function render(){\r\n\r\n            if(this.title){\r\n                //attach the element to the title area\r\n                this.getAreaBroker()\r\n                    .getTitleArea()\r\n                    .text(this.title);\r\n            }\r\n        }\r\n    });\r\n});\r\n\n","\r\n/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * This plugin tracks item changes and prevents you to loose them.\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/content/changeTracker',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/plugin',\r\n    'core/promise',\r\n    'ui/dialog',\r\n], function($, _, __, pluginFactory, Promise, dialog){\r\n    'use strict';\r\n\r\n    //function to remove all global handlers\r\n    var removeChangeHandlers;\r\n\r\n    /**\r\n     * The messages asking to save\r\n     */\r\n    var messages = {\r\n        preview : __('The item needs to be saved before it can be previewed'),\r\n        leave   : __('The item has unsaved changes, are you sure you want to leave ?'),\r\n        exit    : __('The item has unsaved changes, would you like to save it ?')\r\n    };\r\n\r\n    /**\r\n     * Returns the configured plugin\r\n     * @returns {Function} the plugin\r\n     */\r\n    return pluginFactory({\r\n\r\n        name : 'changeTracker',\r\n\r\n        /**\r\n         * Hook to the host's init\r\n         */\r\n        init : function init(){\r\n\r\n            var itemCreator = this.getHost();\r\n            var $container  = this.getAreaBroker().getContainer();\r\n\r\n            //does the item styles have changed\r\n            var styleChanges = false;\r\n\r\n            //are we in the middle of the confirm process ?\r\n            var asking = false;\r\n\r\n            /**\r\n             * Get a string representation of the current item, used for comparison\r\n             * @returns {String} the item\r\n             */\r\n            var getSerializedItem = function getSerializedItem() {\r\n                var serialized = '';\r\n                try {\r\n                    //create a string from the item content\r\n                    serialized = JSON.stringify(itemCreator.getItem().toArray());\r\n\r\n                    //sometimes the creator strip spaces between tags, so we do the same\r\n                    serialized = serialized.replace(/ {2,}/g, ' ');\r\n                } catch(err){\r\n                    serialized = null;\r\n                }\r\n                return serialized;\r\n            };\r\n\r\n            //keep the value of the item before changes\r\n            var originalItem = getSerializedItem();\r\n\r\n            /**\r\n             * Does the item have changed ?\r\n             * @returns {Boolean}\r\n             */\r\n            var hasChanged  = function hasChanged(){\r\n                var currentItem;\r\n                if(styleChanges){\r\n                    return true;\r\n                }\r\n                currentItem = getSerializedItem();\r\n                return originalItem !== currentItem || (_.isNull(currentItem) && _.isNull(originalItem));\r\n            };\r\n\r\n            /**\r\n             * Save the current item, quietly (without popup notifications)\r\n             * @returns {Promise} resolves once saved\r\n             */\r\n            var silentSave = function silentSave(){\r\n                return new Promise(function(resolve){\r\n                    itemCreator\r\n                        .on('saved.silent', function(){\r\n                            this.off('saved.silent');\r\n                            resolve();\r\n                        })\r\n                        .trigger('save', true);\r\n                });\r\n            };\r\n\r\n            /**\r\n             * Display a confirmation dialog,\r\n             * The \"ok\" button will save and resolve.\r\n             * The \"cancel\" button will reject.\r\n             *\r\n             * @param {String} message - the confirm message to display\r\n             * @returns {Promise} resolves once saved\r\n             */\r\n            var confirmBefore = function confirmBefore(message){\r\n                return new Promise(function(resolve, reject){\r\n                    var confirmDlg;\r\n                    if(asking){\r\n                        return reject();\r\n                    }\r\n                    if(!hasChanged()){\r\n                        return resolve();\r\n                    }\r\n                    asking = true;\r\n                    confirmDlg = dialog({\r\n                        message: message,\r\n                        buttons:  [{\r\n                            id : 'dontsave',\r\n                            type : 'regular',\r\n                            label : __('Don\\'t save'),\r\n                            close: true\r\n                        },{\r\n                            id : 'cancel',\r\n                            type : 'regular',\r\n                            label : __('Cancel'),\r\n                            close: true\r\n                        }, {\r\n                            id : 'save',\r\n                            type : 'info',\r\n                            label : __('Save'),\r\n                            close: true\r\n                        }],\r\n                        autoRender: true,\r\n                        autoDestroy: true,\r\n                        onSaveBtn : function onSaveBtn(){\r\n                            silentSave().then(resolve);\r\n                        },\r\n                        onDontsaveBtn : resolve,\r\n                        onCancelBtn : function onCancelBtn () {\r\n                            confirmDlg.hide();\r\n                        }\r\n                    })\r\n                    .on('closed.modal', function(){\r\n                        asking = false;\r\n                    });\r\n                });\r\n            };\r\n\r\n            /**\r\n             * Just unbind the different handlers\r\n             */\r\n            removeChangeHandlers = function removeHandlers(){\r\n                $(document).off('stylechange.qti-creator');\r\n                $('.content-wrap').off('.qti-creator');\r\n                $(window).off(\"beforeunload.qti-creator\");\r\n            };\r\n\r\n            //also track style changes\r\n            $(document)\r\n                .one('customcssloaded.styleeditor', function(){\r\n                    originalItem = getSerializedItem();\r\n                    styleChanges = false;\r\n                })\r\n                .on('stylechange.qti-creator', function (e, detail) {\r\n                    if(!detail || !detail.initializing){\r\n                        styleChanges = true;\r\n                    }\r\n                });\r\n\r\n            $(window)\r\n                //add a browser popup to prevent leaving the browser\r\n                .on(\"beforeunload.qti-creator\", function () {\r\n                    if(!asking && hasChanged()){\r\n                        return messages.leave;\r\n                    }\r\n                })\r\n                //since we don't know how to prevent history based events,\r\n                //we just stop the handling\r\n                .on('popstate', function(){\r\n                    removeChangeHandlers();\r\n                });\r\n\r\n            //every click outside the authoring\r\n            $('.content-wrap').on('click.qti-creator', function (e){\r\n                if(!$.contains($container.get(0), e.target) && hasChanged()){\r\n                    e.stopImmediatePropagation();\r\n                    e.preventDefault();\r\n\r\n                    confirmBefore(messages.exit)\r\n                        .then(function(){\r\n                            removeChangeHandlers();\r\n                            e.target.click();\r\n                        })\r\n                        .catch(_.noop); //do nothing but prevent uncatched error\r\n                }\r\n            });\r\n\r\n            itemCreator\r\n                .on('ready saved', function(){\r\n                    //reset the base item\r\n                    originalItem = getSerializedItem();\r\n                    styleChanges = false;\r\n                })\r\n                .before('exit', function(){\r\n                    return confirmBefore(messages.exit)\r\n                        .then(function(){\r\n                            removeChangeHandlers();\r\n                        });\r\n                })\r\n                .before('preview', function(){\r\n                    return confirmBefore(messages.preview);\r\n                });\r\n        },\r\n\r\n        /**\r\n         * Plugin destroy cycle\r\n         */\r\n        destroy : function destroy(){\r\n            if(_.isFunction(removeChangeHandlers)){\r\n                removeChangeHandlers();\r\n            }\r\n        }\r\n    });\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2016 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/validators',[\r\n    'core/validator/validators',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiItem/core/Element'\r\n], function(validators, _, __, Element) {\r\n    'use strict';\r\n\r\n    var _qtiIdPattern = /^[_a-zA-Z]{1}[a-zA-Z0-9\\-._]{0,31}$/i;\r\n\r\n    var qtiValidators = [\r\n        {\r\n            name: 'qtiIdentifier',\r\n            message: __('invalid identifier'),\r\n            validate: function validate(value, callback) {\r\n                if (typeof callback === 'function') {\r\n                    callback(_qtiIdPattern.test(value));\r\n                }\r\n            }\r\n        },\r\n        //warning: simplistic implementation, allow only one unique identifier in the item no matter the element class/type\r\n        {\r\n            name: 'availableIdentifier',\r\n            message: __('this identifier is already in use'),\r\n            validate: function validate(value, callback, options) {\r\n                if (options.serial) {\r\n                    var element = Element.getElementBySerial(options.serial);\r\n                    if (element && typeof callback === 'function') {\r\n                        var ids = element.getRelatedItem().getUsedIdentifiers();\r\n                        var available = (!ids[value] || ids[value].serial === element.serial);\r\n                        callback(available);\r\n                    }\r\n                }else{\r\n                    throw 'missing required option \"serial\"';\r\n                }\r\n            }\r\n        },\r\n        //define a validator that check unicity of the identifier for a variable declaration\r\n        {\r\n            name: 'availableVariableIdentifier',\r\n            message: __('identifier already taken'),\r\n            validate: function validate(value, callback, options) {\r\n                if (options.serial) {\r\n                    var element = Element.getElementBySerial(options.serial);\r\n                    if (element && typeof callback === 'function') {\r\n                        var ids = element.getRelatedItem().getUsedIdentifiers();\r\n                        var available = (!ids[value] || ids[value].serial === element.serial || !ids[value].is('variableDeclaration'));\r\n                        callback(available);\r\n                    }\r\n                }else{\r\n                    throw 'missing required option \"serial\"';\r\n                }\r\n            }\r\n        }\r\n    ];\r\n\r\n    _.each(qtiValidators, function(rule) {\r\n        validators.register(rule.name, rule);\r\n    });\r\n\r\n    return validators;\r\n});\r\n\r\n\n","/* \r\n * The MIT License\r\n *\r\n * Copyright (c) 2012 James Allardice\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), \r\n * to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, \r\n * and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n */\r\n\r\n// Defines the global Placeholders object along with various utility methods\r\n(function (global) {\r\n\r\n    \"use strict\";\r\n\r\n    // Cross-browser DOM event binding\r\n    function addEventListener(elem, event, fn) {\r\n        if (elem.addEventListener) {\r\n            return elem.addEventListener(event, fn, false);\r\n        }\r\n        if (elem.attachEvent) {\r\n            return elem.attachEvent(\"on\" + event, fn);\r\n        }\r\n    }\r\n\r\n    // Check whether an item is in an array (we don't use Array.prototype.indexOf so we don't clobber any existing polyfills - this is a really simple alternative)\r\n    function inArray(arr, item) {\r\n        var i, len;\r\n        for (i = 0, len = arr.length; i < len; i++) {\r\n            if (arr[i] === item) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // Move the caret to the index position specified. Assumes that the element has focus\r\n    function moveCaret(elem, index) {\r\n        var range;\r\n        if (elem.createTextRange) {\r\n            range = elem.createTextRange();\r\n            range.move(\"character\", index);\r\n            range.select();\r\n        } else if (elem.selectionStart) {\r\n            elem.focus();\r\n            elem.setSelectionRange(index, index);\r\n        }\r\n    }\r\n\r\n    // Attempt to change the type property of an input element\r\n    function changeType(elem, type) {\r\n        try {\r\n            elem.type = type;\r\n            return true;\r\n        } catch (e) {\r\n            // You can't change input type in IE8 and below\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Expose public methods\r\n    global.Placeholders = {\r\n        Utils: {\r\n            addEventListener: addEventListener,\r\n            inArray: inArray,\r\n            moveCaret: moveCaret,\r\n            changeType: changeType\r\n        }\r\n    };\r\n\r\n}(this));\r\n\r\n(function (global) {\r\n\r\n    \"use strict\";\r\n\r\n    var validTypes = [\r\n            \"text\",\r\n            \"search\",\r\n            \"url\",\r\n            \"tel\",\r\n            \"email\",\r\n            \"password\",\r\n            \"number\",\r\n            \"textarea\"\r\n        ],\r\n\r\n        // The list of keycodes that are not allowed when the polyfill is configured to hide-on-input\r\n        badKeys = [\r\n\r\n            // The following keys all cause the caret to jump to the end of the input value\r\n            27, // Escape\r\n            33, // Page up\r\n            34, // Page down\r\n            35, // End\r\n            36, // Home\r\n\r\n            // Arrow keys allow you to move the caret manually, which should be prevented when the placeholder is visible\r\n            37, // Left\r\n            38, // Up\r\n            39, // Right\r\n            40, // Down\r\n\r\n            // The following keys allow you to modify the placeholder text by removing characters, which should be prevented when the placeholder is visible\r\n            8, // Backspace\r\n            46 // Delete\r\n        ],\r\n\r\n        // Styling variables\r\n        placeholderStyleColor = \"#ccc\",\r\n        placeholderClassName = \"placeholdersjs\",\r\n        classNameRegExp = new RegExp(\"(?:^|\\\\s)\" + placeholderClassName + \"(?!\\\\S)\"),\r\n\r\n        // These will hold references to all elements that can be affected. NodeList objects are live, so we only need to get those references once\r\n        inputs, textareas,\r\n\r\n        // The various data-* attributes used by the polyfill\r\n        ATTR_CURRENT_VAL = \"data-placeholder-value\",\r\n        ATTR_ACTIVE = \"data-placeholder-active\",\r\n        ATTR_INPUT_TYPE = \"data-placeholder-type\",\r\n        ATTR_FORM_HANDLED = \"data-placeholder-submit\",\r\n        ATTR_EVENTS_BOUND = \"data-placeholder-bound\",\r\n        ATTR_OPTION_FOCUS = \"data-placeholder-focus\",\r\n        ATTR_OPTION_LIVE = \"data-placeholder-live\",\r\n        ATTR_MAXLENGTH = \"data-placeholder-maxlength\",\r\n\r\n        // Various other variables used throughout the rest of the script\r\n        test = document.createElement(\"input\"),\r\n        head = document.getElementsByTagName(\"head\")[0],\r\n        root = document.documentElement,\r\n        Placeholders = global.Placeholders,\r\n        Utils = Placeholders.Utils,\r\n        hideOnInput, liveUpdates, keydownVal, styleElem, styleRules, placeholder, timer, form, elem, len, i;\r\n\r\n    // No-op (used in place of public methods when native support is detected)\r\n    function noop() {}\r\n\r\n    // Avoid IE9 activeElement of death when an iframe is used.\r\n    // More info:\r\n    // http://bugs.jquery.com/ticket/13393\r\n    // https://github.com/jquery/jquery/commit/85fc5878b3c6af73f42d61eedf73013e7faae408\r\n    function safeActiveElement() {\r\n        try {\r\n            return document.activeElement;\r\n        } catch (err) {}\r\n    }\r\n\r\n    // Hide the placeholder value on a single element. Returns true if the placeholder was hidden and false if it was not (because it wasn't visible in the first place)\r\n    function hidePlaceholder(elem, keydownValue) {\r\n        var type,\r\n            maxLength,\r\n            valueChanged = (!!keydownValue && elem.value !== keydownValue),\r\n            isPlaceholderValue = (elem.value === elem.getAttribute(ATTR_CURRENT_VAL));\r\n\r\n        if ((valueChanged || isPlaceholderValue) && elem.getAttribute(ATTR_ACTIVE) === \"true\") {\r\n            elem.removeAttribute(ATTR_ACTIVE);\r\n            elem.value = elem.value.replace(elem.getAttribute(ATTR_CURRENT_VAL), \"\");\r\n            elem.className = elem.className.replace(classNameRegExp, \"\");\r\n\r\n            // Restore the maxlength value\r\n            maxLength = elem.getAttribute(ATTR_MAXLENGTH);\r\n            if (parseInt(maxLength, 10) >= 0) { // Old FF returns -1 if attribute not set (see GH-56)\r\n                elem.setAttribute(\"maxLength\", maxLength);\r\n                elem.removeAttribute(ATTR_MAXLENGTH);\r\n            }\r\n\r\n            // If the polyfill has changed the type of the element we need to change it back\r\n            type = elem.getAttribute(ATTR_INPUT_TYPE);\r\n            if (type) {\r\n                elem.type = type;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // Show the placeholder value on a single element. Returns true if the placeholder was shown and false if it was not (because it was already visible)\r\n    function showPlaceholder(elem) {\r\n        var type,\r\n            maxLength,\r\n            val = elem.getAttribute(ATTR_CURRENT_VAL);\r\n        if (elem.value === \"\" && val) {\r\n            elem.setAttribute(ATTR_ACTIVE, \"true\");\r\n            elem.value = val;\r\n            elem.className += \" \" + placeholderClassName;\r\n\r\n            // Store and remove the maxlength value\r\n            maxLength = elem.getAttribute(ATTR_MAXLENGTH);\r\n            if (!maxLength) {\r\n                elem.setAttribute(ATTR_MAXLENGTH, elem.maxLength);\r\n                elem.removeAttribute(\"maxLength\");\r\n            }\r\n\r\n            // If the type of element needs to change, change it (e.g. password inputs)\r\n            type = elem.getAttribute(ATTR_INPUT_TYPE);\r\n            if (type) {\r\n                elem.type = \"text\";\r\n            } else if (elem.type === \"password\") {\r\n                if (Utils.changeType(elem, \"text\")) {\r\n                    elem.setAttribute(ATTR_INPUT_TYPE, \"password\");\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    function handleElem(node, callback) {\r\n\r\n        var handleInputsLength, handleTextareasLength, handleInputs, handleTextareas, elem, len, i;\r\n\r\n        // Check if the passed in node is an input/textarea (in which case it can't have any affected descendants)\r\n        if (node && node.getAttribute(ATTR_CURRENT_VAL)) {\r\n            callback(node);\r\n        } else {\r\n\r\n            // If an element was passed in, get all affected descendants. Otherwise, get all affected elements in document\r\n            handleInputs = node ? node.getElementsByTagName(\"input\") : inputs;\r\n            handleTextareas = node ? node.getElementsByTagName(\"textarea\") : textareas;\r\n\r\n            handleInputsLength = handleInputs ? handleInputs.length : 0;\r\n            handleTextareasLength = handleTextareas ? handleTextareas.length : 0;\r\n\r\n            // Run the callback for each element\r\n            for (i = 0, len = handleInputsLength + handleTextareasLength; i < len; i++) {\r\n                elem = i < handleInputsLength ? handleInputs[i] : handleTextareas[i - handleInputsLength];\r\n                callback(elem);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Return all affected elements to their normal state (remove placeholder value if present)\r\n    function disablePlaceholders(node) {\r\n        handleElem(node, hidePlaceholder);\r\n    }\r\n\r\n    // Show the placeholder value on all appropriate elements\r\n    function enablePlaceholders(node) {\r\n        handleElem(node, showPlaceholder);\r\n    }\r\n\r\n    // Returns a function that is used as a focus event handler\r\n    function makeFocusHandler(elem) {\r\n        return function () {\r\n\r\n            // Only hide the placeholder value if the (default) hide-on-focus behaviour is enabled\r\n            if (hideOnInput && elem.value === elem.getAttribute(ATTR_CURRENT_VAL) && elem.getAttribute(ATTR_ACTIVE) === \"true\") {\r\n\r\n                // Move the caret to the start of the input (this mimics the behaviour of all browsers that do not hide the placeholder on focus)\r\n                Utils.moveCaret(elem, 0);\r\n\r\n            } else {\r\n\r\n                // Remove the placeholder\r\n                hidePlaceholder(elem);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Returns a function that is used as a blur event handler\r\n    function makeBlurHandler(elem) {\r\n        return function () {\r\n            showPlaceholder(elem);\r\n        };\r\n    }\r\n\r\n    // Functions that are used as a event handlers when the hide-on-input behaviour has been activated - very basic implementation of the \"input\" event\r\n    function makeKeydownHandler(elem) {\r\n        return function (e) {\r\n            keydownVal = elem.value;\r\n\r\n            //Prevent the use of the arrow keys (try to keep the cursor before the placeholder)\r\n            if (elem.getAttribute(ATTR_ACTIVE) === \"true\") {\r\n                if (keydownVal === elem.getAttribute(ATTR_CURRENT_VAL) && Utils.inArray(badKeys, e.keyCode)) {\r\n                    if (e.preventDefault) {\r\n                        e.preventDefault();\r\n                    }\r\n                    return false;\r\n                }\r\n            }\r\n        };\r\n    }\r\n    function makeKeyupHandler(elem) {\r\n        return function () {\r\n            hidePlaceholder(elem, keydownVal);\r\n\r\n            // If the element is now empty we need to show the placeholder\r\n            if (elem.value === \"\") {\r\n                elem.blur();\r\n                Utils.moveCaret(elem, 0);\r\n            }\r\n        };\r\n    }\r\n    function makeClickHandler(elem) {\r\n        return function () {\r\n            if (elem === safeActiveElement() && elem.value === elem.getAttribute(ATTR_CURRENT_VAL) && elem.getAttribute(ATTR_ACTIVE) === \"true\") {\r\n                Utils.moveCaret(elem, 0);\r\n            }\r\n        };\r\n    }\r\n\r\n    // Returns a function that is used as a submit event handler on form elements that have children affected by this polyfill\r\n    function makeSubmitHandler(form) {\r\n        return function () {\r\n\r\n            // Turn off placeholders on all appropriate descendant elements\r\n            disablePlaceholders(form);\r\n        };\r\n    }\r\n\r\n    // Bind event handlers to an element that we need to affect with the polyfill\r\n    function newElement(elem) {\r\n\r\n        // If the element is part of a form, make sure the placeholder string is not submitted as a value\r\n        if (elem.form) {\r\n            form = elem.form;\r\n\r\n            // If the type of the property is a string then we have a \"form\" attribute and need to get the real form\r\n            if (typeof form === \"string\") {\r\n                form = document.getElementById(form);\r\n            }\r\n\r\n            // Set a flag on the form so we know it's been handled (forms can contain multiple inputs)\r\n            if (!form.getAttribute(ATTR_FORM_HANDLED)) {\r\n                Utils.addEventListener(form, \"submit\", makeSubmitHandler(form));\r\n                form.setAttribute(ATTR_FORM_HANDLED, \"true\");\r\n            }\r\n        }\r\n\r\n        // Bind event handlers to the element so we can hide/show the placeholder as appropriate\r\n        Utils.addEventListener(elem, \"focus\", makeFocusHandler(elem));\r\n        Utils.addEventListener(elem, \"blur\", makeBlurHandler(elem));\r\n\r\n        // If the placeholder should hide on input rather than on focus we need additional event handlers\r\n        if (hideOnInput) {\r\n            Utils.addEventListener(elem, \"keydown\", makeKeydownHandler(elem));\r\n            Utils.addEventListener(elem, \"keyup\", makeKeyupHandler(elem));\r\n            Utils.addEventListener(elem, \"click\", makeClickHandler(elem));\r\n        }\r\n\r\n        // Remember that we've bound event handlers to this element\r\n        elem.setAttribute(ATTR_EVENTS_BOUND, \"true\");\r\n        elem.setAttribute(ATTR_CURRENT_VAL, placeholder);\r\n\r\n        // If the element doesn't have a value and is not focussed, set it to the placeholder string\r\n        if (hideOnInput || elem !== safeActiveElement()) {\r\n            showPlaceholder(elem);\r\n        }\r\n    }\r\n\r\n    Placeholders.nativeSupport = test.placeholder !== void 0;\r\n\r\n    if (!Placeholders.nativeSupport) {\r\n\r\n        // Get references to all the input and textarea elements currently in the DOM (live NodeList objects to we only need to do this once)\r\n        inputs = document.getElementsByTagName(\"input\");\r\n        textareas = document.getElementsByTagName(\"textarea\");\r\n\r\n        // Get any settings declared as data-* attributes on the root element (currently the only options are whether to hide the placeholder on focus or input and whether to auto-update)\r\n        hideOnInput = root.getAttribute(ATTR_OPTION_FOCUS) === \"false\";\r\n        liveUpdates = root.getAttribute(ATTR_OPTION_LIVE) !== \"false\";\r\n\r\n        // Create style element for placeholder styles (instead of directly setting style properties on elements - allows for better flexibility alongside user-defined styles)\r\n        styleElem = document.createElement(\"style\");\r\n        styleElem.type = \"text/css\";\r\n\r\n        // Create style rules as text node\r\n        styleRules = document.createTextNode(\".\" + placeholderClassName + \" { color:\" + placeholderStyleColor + \"; }\");\r\n\r\n        // Append style rules to newly created stylesheet\r\n        if (styleElem.styleSheet) {\r\n            styleElem.styleSheet.cssText = styleRules.nodeValue;\r\n        } else {\r\n            styleElem.appendChild(styleRules);\r\n        }\r\n\r\n        // Prepend new style element to the head (before any existing stylesheets, so user-defined rules take precedence)\r\n        head.insertBefore(styleElem, head.firstChild);\r\n\r\n        // Set up the placeholders\r\n        for (i = 0, len = inputs.length + textareas.length; i < len; i++) {\r\n            elem = i < inputs.length ? inputs[i] : textareas[i - inputs.length];\r\n\r\n            // Get the value of the placeholder attribute, if any. IE10 emulating IE7 fails with getAttribute, hence the use of the attributes node\r\n            placeholder = elem.attributes.placeholder;\r\n            if (placeholder) {\r\n\r\n                // IE returns an empty object instead of undefined if the attribute is not present\r\n                placeholder = placeholder.nodeValue;\r\n\r\n                // Only apply the polyfill if this element is of a type that supports placeholders, and has a placeholder attribute with a non-empty value\r\n                if (placeholder && Utils.inArray(validTypes, elem.type)) {\r\n                    newElement(elem);\r\n                }\r\n            }\r\n        }\r\n\r\n        // If enabled, the polyfill will repeatedly check for changed/added elements and apply to those as well\r\n        timer = setInterval(function () {\r\n            for (i = 0, len = inputs.length + textareas.length; i < len; i++) {\r\n                elem = i < inputs.length ? inputs[i] : textareas[i - inputs.length];\r\n\r\n                // Only apply the polyfill if this element is of a type that supports placeholders, and has a placeholder attribute with a non-empty value\r\n                placeholder = elem.attributes.placeholder;\r\n                if (placeholder) {\r\n                    placeholder = placeholder.nodeValue;\r\n                    if (placeholder && Utils.inArray(validTypes, elem.type)) {\r\n\r\n                        // If the element hasn't had event handlers bound to it then add them\r\n                        if (!elem.getAttribute(ATTR_EVENTS_BOUND)) {\r\n                            newElement(elem);\r\n                        }\r\n\r\n                        // If the placeholder value has changed or not been initialised yet we need to update the display\r\n                        if (placeholder !== elem.getAttribute(ATTR_CURRENT_VAL) || (elem.type === \"password\" && !elem.getAttribute(ATTR_INPUT_TYPE))) {\r\n\r\n                            // Attempt to change the type of password inputs (fails in IE < 9)\r\n                            if (elem.type === \"password\" && !elem.getAttribute(ATTR_INPUT_TYPE) && Utils.changeType(elem, \"text\")) {\r\n                                elem.setAttribute(ATTR_INPUT_TYPE, \"password\");\r\n                            }\r\n\r\n                            // If the placeholder value has changed and the placeholder is currently on display we need to change it\r\n                            if (elem.value === elem.getAttribute(ATTR_CURRENT_VAL)) {\r\n                                elem.value = placeholder;\r\n                            }\r\n\r\n                            // Keep a reference to the current placeholder value in case it changes via another script\r\n                            elem.setAttribute(ATTR_CURRENT_VAL, placeholder);\r\n                        }\r\n                    }\r\n                } else if (elem.getAttribute(ATTR_ACTIVE)) {\r\n                    hidePlaceholder(elem);\r\n                    elem.removeAttribute(ATTR_CURRENT_VAL);\r\n                }\r\n            }\r\n\r\n            // If live updates are not enabled cancel the timer\r\n            if (!liveUpdates) {\r\n                clearInterval(timer);\r\n            }\r\n        }, 100);\r\n    }\r\n\r\n    Utils.addEventListener(global, \"beforeunload\", function () {\r\n        Placeholders.disable();\r\n    });\r\n\r\n    // Expose public methods\r\n    Placeholders.disable = Placeholders.nativeSupport ? noop : disablePlaceholders;\r\n    Placeholders.enable = Placeholders.nativeSupport ? noop : enablePlaceholders;\r\n\r\n}(this));\r\n\ndefine(\"polyfill/placeholders\", function(){});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/formElement',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'util/dom',\r\n    'ui/incrementer',\r\n    'ui/tooltip',\r\n    'ui/selecter',\r\n    'ui/inplacer',\r\n    'ui/groupvalidator',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/validators',\r\n    'polyfill/placeholders'\r\n], function($, _, __, Element, dom, spinner, tooltip, select2){\r\n    'use strict';\r\n\r\n    var formElement = {\r\n        initWidget : function initWidget($form){\r\n            spinner($form);\r\n            tooltip($form);\r\n            select2($form);\r\n        },\r\n        /**\r\n         * register attribute change callback functions when associated form elements has been modified\r\n         *\r\n         * @param {Object} $form - the jQuery form element\r\n         * @param {Object} element - a js qti element (see qtiCreator/model)\r\n         * @param {Object} attributes - key value attributeName:callback, e.g. {identifier:function(element, value, attrName){ element.attr(attrName, value); }}\r\n         * @param {Boolean} [options.validateOnInit = false] - define if the validation should be trigger immediately after the callbacks have been set\r\n         * @param {Boolean} [options.invalidate = false] - define if the validation set the valid/invalidate state to the widget of the element\r\n         */\r\n        setChangeCallbacks : function setChangeCallbacks($form, element, attributes, options){\r\n\r\n            attributes = attributes || {};\r\n            options = _.defaults(options || {}, {\r\n                validateOnInit : false,\r\n                invalidate : false\r\n            });\r\n\r\n            var _callbackCall = function(name, value, $elt){\r\n                var cb = attributes[name];\r\n                if(_.isFunction(cb)){\r\n                    cb.call($elt[0], element, value, name);\r\n                }\r\n            };\r\n\r\n            var callback = {\r\n                simple : function(){\r\n\r\n                    var $elt = $(this),\r\n                        name = $elt.attr('name');\r\n\r\n                    if($elt.is(':checkbox')){\r\n                        _callbackCall(name, $elt.prop('checked'), $elt);\r\n                    }else{\r\n                        _callbackCall(name, $elt.val(), $elt);\r\n                    }\r\n\r\n                },\r\n                withValidation : function(e, valid, elt){\r\n\r\n                    if(e.namespace === 'group'){\r\n\r\n                        var $elt = $(elt),\r\n                            name = $elt.attr('name');\r\n\r\n                        if(valid){\r\n                            _callbackCall(name, $elt.val(), $elt);\r\n                        }\r\n                        if(options.invalidate){\r\n                            element.data('widget').isValid(name, valid);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            $form.off('.databinding');\r\n            $form.on('change.databinding keyup.databinding', ':checkbox, :radio, select, :text:not([data-validate]), :hidden:not([data-validate])', callback.simple);\r\n            $form.on('keyup.databinding input.databinding propertychange.databinding', 'textarea', callback.simple);\r\n\r\n            $form.on('validated.group.databinding', callback.withValidation);\r\n\r\n            _.defer(function(){\r\n                $form.groupValidator({\r\n                    validateOnInit : options.validateOnInit,\r\n                    events : ['change', 'blur', {type : 'keyup', length : 0}],\r\n                    callback : _validationCallback\r\n                });\r\n            });\r\n\r\n        },\r\n        removeChangeCallback : function removeChangeCallback($form){\r\n            $form.off('.databinding');\r\n            $form.find(':input[data-hasqtip]').qtip('destroy', true);\r\n        },\r\n        initTitle : function initTitle($form, element){\r\n\r\n            var $title = $form.hasClass('qti-title') ? $form : $form.find('.qti-title');\r\n\r\n            $title\r\n                .inplacer({\r\n                    target : $('#qti-title')\r\n                })\r\n                .attr('title', __('Edit modal feedback title'))\r\n                .on('change', function(){\r\n                    element.attr('title', $(this).text());\r\n                });\r\n        },\r\n        /**\r\n         * the simplest form of save callback used in setChangeCallbacks()\r\n         * @param {boolean} allowEmpty\r\n         */\r\n        getAttributeChangeCallback : function getAttributeChangeCallback(allowEmpty){\r\n\r\n            return function(element, value, name){\r\n                if(!allowEmpty && value === ''){\r\n                    element.removeAttr(name);\r\n                }else{\r\n                    element.attr(name, value);\r\n                }\r\n            };\r\n        },\r\n        /**\r\n         * Create a coupled callbacks for min and max value change, when both are using the ui/incrementer widget.\r\n         * It is used to update constraints on one when modifying the other.\r\n         * \r\n         * @param {Object} $form - the JQuery object representing the form container\r\n         * @param {String} attributeNameMin\r\n         * @param {String} attributeNameMax\r\n         * @param {Object} options\r\n         * @returns {Object}\r\n         */\r\n        getMinMaxAttributeCallbacks : function getMinMaxAttributeCallbacks($form, attributeNameMin, attributeNameMax, options){\r\n\r\n            var _defaults = {\r\n                allowNull : false,\r\n                updateCardinality : true,\r\n                attrMethodNames : {\r\n                    remove : 'removeAttr',\r\n                    set : 'attr'\r\n                },\r\n                floatVal : false,\r\n                callback : _.noop\r\n            },\r\n            $max = $form.find('input[name=' + attributeNameMax + ']'),\r\n                callbacks = {};\r\n\r\n            //prepare options object\r\n            options = _.defaults(options || {}, _defaults);\r\n\r\n            callbacks[attributeNameMin] = function(element, value, name){\r\n\r\n                var newOptions = {min : $max.data('min') || 0};\r\n                var isActualNumber;\r\n\r\n                value = options.floatVal ? parseFloat(value) : parseInt(value, 10);\r\n                isActualNumber = !isNaN(value);\r\n\r\n                if(!options.allowNull && (value === 0 || !isActualNumber)){\r\n\r\n                    //if a null attribute is not allowed, remove it !\r\n                    element[options.attrMethodNames.remove](name);\r\n\r\n                }else if(isActualNumber){\r\n\r\n                    //if the value is an actual number\r\n                    element[options.attrMethodNames.set](name, value);\r\n                    newOptions.min = Math.max(newOptions.min, value);\r\n\r\n                    var max = options.floatVal ? parseFloat($max.val()) : parseInt($max.val(), 10);\r\n\r\n                    if(max < value && !(max === 0 && $max.data('zero') === true)){\r\n                        $max.val(value);\r\n                    }\r\n                }\r\n                //set incrementer min value for maxChoices and trigger keyup event to launch validation\r\n                $max.incrementer('options', newOptions).keyup();\r\n\r\n                options.callback(element, value, name);\r\n            };\r\n\r\n            callbacks[attributeNameMax] = function(element, value, name){\r\n\r\n                value = options.floatVal ? parseFloat(value) : parseInt(value, 10) || 0;\r\n\r\n                if(element.is('interaction')){\r\n                    //update response\r\n                    _updateResponseDeclaration(element, value, options.updateCardinality);\r\n                }\r\n\r\n                if(!value && (element.is('orderInteraction') || element.is('graphicOrderInteraction'))){\r\n                    element[options.attrMethodNames.remove](name);//to be removed for order interactions\r\n                }else{\r\n                    element[options.attrMethodNames.set](name, value);//required\r\n                }\r\n\r\n                options.callback(element, value, name);\r\n            };\r\n\r\n            return callbacks;\r\n        }\r\n    };\r\n\r\n    var _updateResponseDeclaration = function _updateResponseDeclaration(interaction, maxChoice, updateCardinality){\r\n\r\n        if(Element.isA(interaction, 'interaction')){\r\n            updateCardinality = (updateCardinality === undefined) ? true : !!updateCardinality;\r\n\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            if(updateCardinality){\r\n                responseDeclaration.attr('cardinality', (maxChoice === 1) ? 'single' : 'multiple');\r\n            }\r\n\r\n            if(maxChoice){\r\n                //always update the correct response then:\r\n                var correct = [];\r\n                _.each(responseDeclaration.getCorrect(), function(c){\r\n                    if(correct.length < maxChoice){\r\n                        correct.push(c);\r\n                    }else{\r\n                        return false;\r\n                    }\r\n                });\r\n                responseDeclaration.setCorrect(correct);\r\n            }\r\n\r\n        }else{\r\n            throw new Error('the first argument must be an interaction, the current element is ' + interaction.qtiClass);\r\n        }\r\n\r\n\r\n    };\r\n\r\n    var _validationCallback = function _validationCallback(valid, results, validatorOptions){\r\n\r\n        var $input = $(this),\r\n            rule;\r\n\r\n        if(dom.contains($input)){\r\n\r\n            _createTooltip($input, validatorOptions);\r\n\r\n            if(!valid){\r\n                //invalid input!\r\n                rule = _.where(results, {type : 'failure'})[0];\r\n                if(rule && rule.data.message && !$('#mediaManager').children('.opened').length){\r\n                    $input.qtip('set', 'content.text', rule.data.message);\r\n                    //only show it when the file manager is hidden\r\n                    $input.qtip('show');\r\n                }\r\n\r\n            } else {\r\n                $input.qtip('hide');\r\n            }\r\n\r\n        }\r\n\r\n\r\n\r\n    };\r\n\r\n    var _createTooltip = function _createTooltip($input, validatorOptions){\r\n        if(!$input.data('qtip')){\r\n            $input.qtip({\r\n                show: {\r\n                    event : 'custom'\r\n                },\r\n                hide: {\r\n                    event : 'custom'\r\n                },\r\n                theme : 'error',\r\n                position: {\r\n                    container: validatorOptions.$container\r\n                },\r\n                content: {\r\n                    text: ''\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    return formElement;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2015 (original work) Open Assessment Technlogies SA;\r\n *\r\n */\r\n\r\n/**\r\n * Config of the QTI XML renderer\r\n *\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiXmlRenderer/renderers/config',[\r\n    'taoItems/assets/manager'\r\n], function(assetManagerFactory){\r\n    'use strict';\r\n\r\n    //all assets are normalized (relative)\r\n    var assetManager = assetManagerFactory([{\r\n        name : 'nomalize',\r\n        handle: function normalizeStrategy(url){\r\n            if(url){\r\n                return url.toString().replace(/^\\.?\\//, '');\r\n            }\r\n        }\r\n    }]);\r\n\r\n    /**\r\n     * The XML Renderer config\r\n     */\r\n    return {\r\n        name : 'xmlRenderer',\r\n        locations : {\r\n            '_container' : 'taoQtiItem/qtiXmlRenderer/renderers/Container',\r\n            'assessmentItem' : 'taoQtiItem/qtiXmlRenderer/renderers/Item',\r\n            'stylesheet' : 'taoQtiItem/qtiXmlRenderer/renderers/Stylesheet',\r\n            'responseDeclaration' : 'taoQtiItem/qtiXmlRenderer/renderers/ResponseDeclaration',\r\n            'outcomeDeclaration' : 'taoQtiItem/qtiXmlRenderer/renderers/OutcomeDeclaration',\r\n            'responseProcessing' : 'taoQtiItem/qtiXmlRenderer/renderers/ResponseProcessing',\r\n            '_simpleFeedbackRule' : 'taoQtiItem/qtiXmlRenderer/renderers/responses/SimpleFeedbackRule',\r\n            'math' : 'taoQtiItem/qtiXmlRenderer/renderers/Math',\r\n            'img' : 'taoQtiItem/qtiXmlRenderer/renderers/Img',\r\n            'object' : 'taoQtiItem/qtiXmlRenderer/renderers/Object',\r\n            'table' : 'taoQtiItem/qtiXmlRenderer/renderers/Table',\r\n            'modalFeedback' : 'taoQtiItem/qtiXmlRenderer/renderers/feedbacks/ModalFeedback',\r\n            'rubricBlock' : 'taoQtiItem/qtiXmlRenderer/renderers/RubricBlock',\r\n            'associateInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/AssociateInteraction',\r\n            'choiceInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/ChoiceInteraction',\r\n            'extendedTextInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/ExtendedTextInteraction',\r\n            'gapMatchInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/GapMatchInteraction',\r\n            'graphicAssociateInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/GraphicAssociateInteraction',\r\n            'graphicGapMatchInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/GraphicGapMatchInteraction',\r\n            'graphicOrderInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/GraphicOrderInteraction',\r\n            'hotspotInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/HotspotInteraction',\r\n            'hottextInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/HottextInteraction',\r\n            'inlineChoiceInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/InlineChoiceInteraction',\r\n            'matchInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/MatchInteraction',\r\n            'mediaInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/MediaInteraction',\r\n            'orderInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/OrderInteraction',\r\n            'selectPointInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/SelectPointInteraction',\r\n            'sliderInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/SliderInteraction',\r\n            'textEntryInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/TextEntryInteraction',\r\n            'uploadInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/UploadInteraction',\r\n            'prompt' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/Prompt',\r\n            'associableHotspot' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/AssociableHotspot',\r\n            'gap' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/Gap',\r\n            'gapImg' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/GapImg',\r\n            'gapText' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/GapText',\r\n            'hotspotChoice' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/HotspotChoice',\r\n            'hottext' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/Hottext',\r\n            'inlineChoice' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/InlineChoice',\r\n            'simpleAssociableChoice' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/SimpleAssociableChoice',\r\n            'simpleChoice' : 'taoQtiItem/qtiXmlRenderer/renderers/choices/SimpleChoice',\r\n            'customInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/PortableCustomInteraction',\r\n            'endAttemptInteraction' : 'taoQtiItem/qtiXmlRenderer/renderers/interactions/EndAttemptInteraction',\r\n            'infoControl' : 'taoQtiItem/qtiXmlRenderer/renderers/PortableInfoControl',\r\n            'include' : 'taoQtiItem/qtiXmlRenderer/renderers/Include'\r\n        },\r\n        options : {\r\n            assetManager : assetManager\r\n        }\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/Renderer',['taoQtiItem/qtiRunner/core/Renderer', 'taoQtiItem/qtiXmlRenderer/renderers/config'], function(Renderer, config){\r\n    'use strict';\r\n\r\n    return Renderer.build(config.locations, config.name, config.options);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/helper/response',['lodash'], function(_) {\r\n    'use strict';\r\n\r\n    var _templateNames = {\r\n        'MATCH_CORRECT': 'http://www.imsglobal.org/question/qti_v2p1/rptemplates/match_correct',\r\n        'MAP_RESPONSE': 'http://www.imsglobal.org/question/qti_v2p1/rptemplates/map_response',\r\n        'MAP_RESPONSE_POINT': 'http://www.imsglobal.org/question/qti_v2p1/rptemplates/map_response_point',\r\n        'NONE': 'no_response_processing'\r\n    };\r\n\r\n    return {\r\n        isUsingTemplate: function isUsingTemplate(response, tpl) {\r\n            if (_.isString(tpl)) {\r\n                if (tpl === response.template || _templateNames[tpl] === response.template) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        },\r\n        isValidTemplateName: function isValidTemplateName(tplName) {\r\n            return !!this.getTemplateUriFromName(tplName);\r\n        },\r\n        getTemplateUriFromName: function getTemplateUriFromName(tplName) {\r\n            if (_templateNames[tplName]) {\r\n                return _templateNames[tplName];\r\n            }\r\n            return '';\r\n        },\r\n        getTemplateNameFromUri: function getTemplateNameFromUri(tplUri) {\r\n            var tplName = '';\r\n            _.forIn(_templateNames, function (uri, name) {\r\n                if (uri === tplUri) {\r\n                    tplName = name;\r\n                    return false;\r\n                }\r\n            });\r\n            return tplName;\r\n        }\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/helper/maxScore',[\r\n    'lodash',\r\n    'lib/gamp/gamp',\r\n    'taoQtiItem/qtiItem/helper/response',\r\n    'taoQtiItem/qtiCreator/model/variables/OutcomeDeclaration'\r\n], function(_, gamp, responseHelper, OutcomeDeclaration) {\r\n    'use strict';\r\n\r\n    /**\r\n     * This variable allow to globally define if the minCHoice needs to be taken into consideration.\r\n     * Standard-wise, it must definitely be considered.\r\n     * However, the item delivery lifecycle currently does not consider the minChoice constraint during delivery.\r\n     * It is thus currently set to true. After the correct behaviour is implemented, we should remove this variables.\r\n     * @type {boolean}\r\n     * @private\r\n     */\r\n    var _ignoreMinChoice = true;\r\n\r\n    var pairExists = function pairExists(collection, pair){\r\n        if(pair.length !== 2){\r\n            return false;\r\n        }\r\n        return (collection[pair[0]+' '+pair[1]] || collection[pair[1]+' '+pair[0]]);\r\n    };\r\n\r\n    return {\r\n        /**\r\n         * Set the normal maximum to the item\r\n         * @param {Object} item - the standard qti item model object\r\n         */\r\n        setNormalMaximum : function setNormalMaximum(item) {\r\n            var normalMaximum,\r\n                scoreOutcome = item.getOutcomeDeclaration('SCORE');\r\n\r\n            //try setting the computed normal maximum only if the processing type is known, i.e. 'templateDriven'\r\n            if (scoreOutcome && item.responseProcessing && item.responseProcessing.processingType === 'templateDriven') {\r\n                normalMaximum = _.reduce(item.getInteractions(), function (acc, interaction) {\r\n                    var interactionMaxScore = interaction.getNormalMaximum();\r\n                    if(_.isNumber(interactionMaxScore)){\r\n                        return gamp.add(acc, interactionMaxScore);\r\n                    }else{\r\n                        return false;\r\n                    }\r\n                }, 0);\r\n\r\n                if(_.isNumber(normalMaximum)){\r\n                    scoreOutcome.attr('normalMaximum', normalMaximum);\r\n                }else{\r\n                    scoreOutcome.removeAttr('normalMaximum');\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Set the maximum score of the item\r\n         * @param {Object} item - the standard qti item model object\r\n         */\r\n        setMaxScore : function setMaxScore(item) {\r\n            var hasInvalidInteraction = false,\r\n                scoreOutcome = item.getOutcomeDeclaration('SCORE'),\r\n                customOutcomes,\r\n                maxScore,\r\n                maxScoreOutcome;\r\n\r\n            //try setting the computed normal maximum only if the processing type is known, i.e. 'templateDriven'\r\n            if (scoreOutcome && item.responseProcessing && item.responseProcessing.processingType === 'templateDriven') {\r\n\r\n                maxScore = _.reduce(item.getInteractions(), function (acc, interaction) {\r\n                    var interactionMaxScore = interaction.getNormalMaximum();\r\n                    if(_.isNumber(interactionMaxScore)){\r\n                        return gamp.add(acc, interactionMaxScore);\r\n                    }else{\r\n                        hasInvalidInteraction = true;\r\n                        return acc;\r\n                    }\r\n                }, 0);\r\n\r\n                customOutcomes =  _(item.getOutcomes()).filter(function(outcome){\r\n                    return (outcome.id() !== 'SCORE' && outcome.id() !== 'MAXSCORE');\r\n                });\r\n\r\n                if(customOutcomes.size()){\r\n                    maxScore = customOutcomes.reduce(function (acc, outcome) {\r\n                        return gamp.add(acc, parseFloat(outcome.attr('normalMaximum')||0));\r\n                    }, maxScore);\r\n                }\r\n\r\n                if(!hasInvalidInteraction || customOutcomes.size()){\r\n                    maxScoreOutcome = item.getOutcomeDeclaration('MAXSCORE');\r\n                    if(!maxScoreOutcome){\r\n                        //add new outcome\r\n                        maxScoreOutcome = new OutcomeDeclaration({\r\n                            cardinality : 'single',\r\n                            baseType : 'float'\r\n                        });\r\n\r\n                        //attach the outcome to the item before generating item-level unique id\r\n                        item.addOutcomeDeclaration(maxScoreOutcome);\r\n                        maxScoreOutcome.buildIdentifier('MAXSCORE', false);\r\n                    }\r\n                    maxScoreOutcome.setDefaultValue(maxScore);\r\n                }else{\r\n                    //remove MAXSCORE:\r\n                    item.removeOutcome('MAXSCORE');\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Sort an array of associable choices by its matchMax attr value\r\n         * @param {Array} choiceCollection\r\n         * @returns {Array}\r\n         */\r\n        getMatchMaxOrderedChoices : function getMatchMaxOrderedChoices(choiceCollection){\r\n            return _(choiceCollection).map(function(choice){\r\n                var matchMax = parseInt(choice.attr('matchMax'), 10);\r\n                if(_.isNaN(matchMax)){\r\n                    matchMax = 0;\r\n                }\r\n                return {\r\n                    matchMax : matchMax === 0 ? Infinity : matchMax,\r\n                    id: choice.id()\r\n                };\r\n            }).sortBy('matchMax').reverse().valueOf();\r\n        },\r\n\r\n        /**\r\n         * Compute the maximum score of a \"choice\" typed interaction\r\n         * @param {Object} interaction - a standard interaction model object\r\n         * @returns {Number}\r\n         */\r\n        choiceInteractionBased : function choiceInteractionBased(interaction, options){\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            var mapDefault = parseFloat(responseDeclaration.mappingAttributes.defaultValue||0);\r\n            var template = responseHelper.getTemplateNameFromUri(responseDeclaration.template);\r\n            var max, maxChoice, minChoice, scoreMaps, requiredChoiceCount, totalAnswerableResponse, sortedMapEntries, i, missingMapsCount;\r\n\r\n            options = _.defaults(options || {}, {maxChoices : 0, minChoices: 0});\r\n            maxChoice = parseInt(interaction.attr('maxChoices')||options.maxChoices, 10);\r\n            minChoice = _ignoreMinChoice ? 0 : parseInt(interaction.attr('minChoices')||options.minChoices, 10);\r\n            if(maxChoice && minChoice && maxChoice < minChoice){\r\n                return 0;\r\n            }\r\n\r\n            if (template === 'MATCH_CORRECT') {\r\n                if(maxChoice && _.isArray(responseDeclaration.correctResponse) && (responseDeclaration.correctResponse.length > maxChoice || responseDeclaration.correctResponse.length < minChoice)){\r\n                    //max choice does not enable selecting the correct responses\r\n                    max = 0;\r\n                }else if(!responseDeclaration.correctResponse || (_.isArray(responseDeclaration.correctResponse) && !responseDeclaration.correctResponse.length)){\r\n                    //no correct response defined -> score always zero\r\n                    max = 0;\r\n                }else{\r\n                    max = 1;\r\n                }\r\n            }else if(template === 'MAP_RESPONSE') {\r\n\r\n                //at least a map entry is required to be valid QTI\r\n                if(!responseDeclaration.mapEntries || !_.size(responseDeclaration.mapEntries)){\r\n                    return 0;\r\n                }\r\n\r\n                //prepare constraint params\r\n                requiredChoiceCount = minChoice;\r\n                totalAnswerableResponse = (maxChoice === 0) ? Infinity : maxChoice;\r\n\r\n                //sort the score map entries by the score\r\n                scoreMaps = _.values(responseDeclaration.mapEntries);\r\n                sortedMapEntries = _(scoreMaps).map(function (v) {\r\n                    return parseFloat(v);\r\n                }).sortBy().reverse().first(totalAnswerableResponse);\r\n\r\n                //if there is not enough map defined, compared to the minChoice constraint, fill in the rest of required choices with the default map\r\n                missingMapsCount = minChoice - sortedMapEntries.size();\r\n                _.times(missingMapsCount, function(){\r\n                    sortedMapEntries.push(mapDefault);\r\n                });\r\n\r\n                //if the map default is positive, the optimal strategy involves using as much mapDefault as possible\r\n                if(mapDefault && mapDefault > 0){\r\n                    if(maxChoice){\r\n                        missingMapsCount = maxChoice - sortedMapEntries.size();\r\n                    }else{\r\n                        missingMapsCount = _.size(interaction.getChoices()) - sortedMapEntries.size();\r\n                    }\r\n                    if(missingMapsCount > 0){\r\n                        _.times(missingMapsCount, function(){\r\n                            sortedMapEntries.push(mapDefault);\r\n                        });\r\n                    }\r\n                }\r\n\r\n                //calculate the maximum reachable score by choice map\r\n                max = sortedMapEntries.reduce(function (acc, v) {\r\n                    var score = v;\r\n                    if(score < 0 && requiredChoiceCount <= 0){\r\n                        //if the score is negative check if we have the choice not to pick it\r\n                        score = 0;\r\n                    }\r\n                    requiredChoiceCount--;\r\n                    return gamp.add(acc, score);\r\n                }, 0);\r\n\r\n                //compare the calculated maximum with the mapping upperbound\r\n                if (responseDeclaration.mappingAttributes.upperBound) {\r\n                    max = Math.min(max, parseFloat(responseDeclaration.mappingAttributes.upperBound||0));\r\n                }\r\n            }else if(template === 'MAP_RESPONSE_POINT'){\r\n                //map point response processing does not work on choice based interaction\r\n                max = 0;\r\n            }\r\n            return max;\r\n        },\r\n\r\n        /**\r\n         * Compute the maximum score of a \"order\" typed interaction\r\n         * @param {Object} interaction - a standard interaction model object\r\n         * @returns {Number}\r\n         */\r\n        orderInteractionBased : function orderInteractionBased(interaction){\r\n            var minChoice = _ignoreMinChoice ? 0 : parseInt(interaction.attr('minChoices')||0, 10);\r\n            var maxChoice = parseInt(interaction.attr('maxChoices')||0, 10);\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            var template = responseHelper.getTemplateNameFromUri(responseDeclaration.template);\r\n            var max;\r\n\r\n            if(maxChoice && minChoice && maxChoice < minChoice){\r\n                return 0;\r\n            }\r\n\r\n            if (template === 'MATCH_CORRECT') {\r\n                if(_.isArray(responseDeclaration.correctResponse) && (maxChoice && responseDeclaration.correctResponse.length > maxChoice) || (minChoice && responseDeclaration.correctResponse.length < minChoice)){\r\n                    //max choice does not enable selecting the correct responses\r\n                    max = 0;\r\n                }else if(!responseDeclaration.correctResponse || (_.isArray(responseDeclaration.correctResponse) && !responseDeclaration.correctResponse.length)){\r\n                    //no correct response defined -> score always zero\r\n                    max = 0;\r\n                }else{\r\n                    max = 1;\r\n                }\r\n            }else if(template === 'MAP_RESPONSE' || template === 'MAP_RESPONSE_POINT') {\r\n                //map response processing does not work on order based interaction\r\n                max = 0;\r\n            }\r\n            return max;\r\n        },\r\n\r\n        /**\r\n         * Compute the maximum score of a \"associate\" typed interaction\r\n         * @param {Object} interaction - a standard interaction model object\r\n         * @returns {Number}\r\n         */\r\n        associateInteractionBased : function associateInteractionBased(interaction, options){\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            var template = responseHelper.getTemplateNameFromUri(responseDeclaration.template);\r\n            var maxAssoc = parseInt(interaction.attr('maxAssociations')||0, 10);\r\n            var minAssoc = _ignoreMinChoice ? 0 : parseInt(interaction.attr('minAssociations')||0, 10);\r\n            var mapDefault = parseFloat(responseDeclaration.mappingAttributes.defaultValue||0);\r\n            var max, requiredAssoc, totalAnswerableResponse, usedChoices, choicesIdentifiers, sortedMapEntries, i, allPossibleMapEntries, infiniteScoringPair;\r\n\r\n            options = _.defaults(options || {}, {possiblePairs : [], checkInfinitePair: false});\r\n\r\n            if(maxAssoc && minAssoc && maxAssoc < minAssoc){\r\n                return 0;\r\n            }\r\n\r\n            if (template === 'MATCH_CORRECT') {\r\n                if(!responseDeclaration.correctResponse\r\n                    || (_.isArray(responseDeclaration.correctResponse)\r\n                    && (!responseDeclaration.correctResponse.length || maxAssoc && responseDeclaration.correctResponse.length > maxAssoc || minAssoc && responseDeclaration.correctResponse.length < minAssoc) )){\r\n                    //no correct response defined -> score always zero\r\n                    max = 0;\r\n                }else{\r\n                    max = 1;//is possible until proven otherwise\r\n\r\n                    //get the list of choices used in map entries\r\n                    choicesIdentifiers = [];\r\n                    _.forEach(responseDeclaration.correctResponse, function(pair){\r\n                        var choices;\r\n                        if(!_.isString(pair)){\r\n                            return;\r\n                        }\r\n                        choices = pair.trim().split(' ');\r\n                        if(_.isArray(choices) && choices.length === 2){\r\n                            choicesIdentifiers.push(choices[0].trim());\r\n                            choicesIdentifiers.push(choices[1].trim());\r\n                        }\r\n                    });\r\n\r\n                    //check if the choices usage are possible within the constraint defined in the interaction\r\n                    _.forEach(_.countBy(choicesIdentifiers), function(count, identifier){\r\n                        var matchMax;\r\n                        var choice = interaction.getChoiceByIdentifier(identifier);\r\n                        if(!choice){\r\n                            max = 0;\r\n                            return false;\r\n                        }\r\n                        matchMax = parseInt(choice.attr('matchMax'), 10);\r\n                        if(matchMax && matchMax < count){\r\n                            max = 0;\r\n                            return false;\r\n                        }\r\n                    });\r\n                }\r\n            }else if(template === 'MAP_RESPONSE') {\r\n\r\n                requiredAssoc = minAssoc;\r\n                totalAnswerableResponse = (maxAssoc === 0) ? Infinity : maxAssoc;\r\n                usedChoices = {};\r\n\r\n                //at least a map entry is required to be valid QTI\r\n                if(!responseDeclaration.mapEntries || !_.size(responseDeclaration.mapEntries)){\r\n                    return 0;\r\n                }\r\n\r\n                allPossibleMapEntries = _.clone(responseDeclaration.mapEntries);\r\n                if(mapDefault && mapDefault > 0){\r\n                    _.forEachRight(options.possiblePairs, function(pair){\r\n                        if(!pairExists(allPossibleMapEntries, pair)){\r\n                            allPossibleMapEntries[pair[0]+' '+pair[1]] = mapDefault;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                //get the sorted list of mapentries ordered by the score\r\n                sortedMapEntries = _(allPossibleMapEntries).map(function(score, pair){\r\n                    return {\r\n                        score : parseFloat(score),\r\n                        pair : pair\r\n                    };\r\n                }).sortBy('score').reverse().filter(function(mapEntry){\r\n                    var pair = mapEntry.pair;\r\n                    var choices, choiceId, choice, _usedChoices;\r\n\r\n                    if(!_.isString(pair)){\r\n                        return false;\r\n                    }\r\n\r\n                    //check that the pair is possible in term of matchMax\r\n                    choices = pair.trim().split(' ');\r\n                    if(_.isArray(choices) && choices.length === 2){\r\n                        //clone the global used choices array to brings the changes in that object first before storing in the actual object\r\n                        _usedChoices = _.cloneDeep(usedChoices);\r\n\r\n                        for(i = 0; i < 2; i++){\r\n                            choiceId = choices[i];\r\n\r\n                            //collect choices usage to check if the pair is possible\r\n                            if(!_usedChoices[choiceId]){\r\n                                choice = interaction.getChoiceByIdentifier(choiceId);\r\n                                if(!choice){\r\n                                    //unexisting choice, skip\r\n                                    return false;\r\n                                }\r\n                                _usedChoices[choiceId] = {\r\n                                    used : 0,\r\n                                    max: parseInt(choice.attr('matchMax'), 10)\r\n                                };\r\n                            }\r\n                            if(_usedChoices[choiceId].max && _usedChoices[choiceId].used === _usedChoices[choiceId].max){\r\n                                //skip\r\n                                return false;\r\n                            }else{\r\n                                _usedChoices[choiceId].used ++;\r\n                            }\r\n                        }\r\n\r\n                        //identify the edge case when we can get infinite association pair that create an infinite score\r\n                        infiniteScoringPair = infiniteScoringPair || (options.checkInfinitePair\r\n                            && mapEntry.score > 0\r\n                            && _usedChoices[choices[0]].max === 0\r\n                            && _usedChoices[choices[1]].max === 0);\r\n\r\n                        //update the global used choices array\r\n                        _.assign(usedChoices, _usedChoices);\r\n                        return true;\r\n                    }else{\r\n                        //is not a correct response pair\r\n                        return false;\r\n                    }\r\n                }).first(totalAnswerableResponse);\r\n\r\n                //infinite score => no normalMaximum should be generated for it\r\n                if(infiniteScoringPair){\r\n                    return false;\r\n                }\r\n\r\n                //reduce the ordered list of map entries to calculate the max score\r\n                max = sortedMapEntries.reduce(function (acc, v) {\r\n                    var score = v.score;\r\n                    if(v.score < 0 && requiredAssoc <= 0){\r\n                        //if the score is negative check if we have the choice not to pick it\r\n                        score = 0;\r\n                    }\r\n                    requiredAssoc--;\r\n                    return gamp.add(acc, score);\r\n                }, 0);\r\n\r\n                //compare the calculated maximum with the mapping upperbound\r\n                if (responseDeclaration.mappingAttributes.upperBound) {\r\n                    max = Math.min(max, parseFloat(responseDeclaration.mappingAttributes.upperBound||0));\r\n                }\r\n            }else if(template === 'MAP_RESPONSE_POINT'){\r\n                max = 0;\r\n            }\r\n            return max;\r\n        },\r\n\r\n        /**\r\n         * Compute the maximum score of a \"gap match\" typed interaction\r\n         * @param {Object} interaction - a standard interaction model object\r\n         * @returns {Number}\r\n         */\r\n        gapMatchInteractionBased : function gapMatchInteractionBased(interaction){\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            var template = responseHelper.getTemplateNameFromUri(responseDeclaration.template);\r\n            var maxAssoc = 0;\r\n            var minAssoc = 0;\r\n            var mapDefault = parseFloat(responseDeclaration.mappingAttributes.defaultValue||0);\r\n            var max, skippableWrongResponse, totalAnswerableResponse, usedChoices, usedGaps, group1, group2, allPossibleMapEntries;\r\n            var getMatchMaxOrderedChoices = function getMatchMaxOrderedChoices(choiceCollection){\r\n                return _(choiceCollection).map(function(choice){\r\n                    return {\r\n                        matchMax : choice.attr('matchMax') === 0 ? Infinity : choice.attr('matchMax') || 0,\r\n                        id: choice.id()\r\n                    };\r\n                }).sortBy('matchMax').reverse().valueOf();\r\n            };\r\n            var calculatePossiblePairs = function calculatePossiblePairs(gapMatchInteraction){\r\n                //get max number of pairs\r\n                var pairs = [];\r\n                var matchSet1 = getMatchMaxOrderedChoices(gapMatchInteraction.getChoices());\r\n                var matchSet2 = getMatchMaxOrderedChoices(gapMatchInteraction.getGaps());\r\n\r\n                _.forEach(matchSet1, function(choice1){\r\n                    _.forEach(matchSet2, function(choice2){\r\n                        pairs.push([choice1.id, choice2.id]);\r\n                    });\r\n                });\r\n\r\n                return pairs;\r\n            };\r\n\r\n            if (template === 'MATCH_CORRECT') {\r\n                if(!responseDeclaration.correctResponse || (_.isArray(responseDeclaration.correctResponse) && !responseDeclaration.correctResponse.length)){\r\n                    //no correct response defined -> score always zero\r\n                    max = 0;\r\n                }else{\r\n                    max = 1;//is possible until proven otherwise\r\n                    group1 = [];\r\n                    group2 = [];\r\n                    _.forEach(responseDeclaration.correctResponse, function(pair){\r\n                        var choices;\r\n                        if(!_.isString(pair)){\r\n                            return;\r\n                        }\r\n                        choices = pair.trim().split(' ');\r\n                        if(_.isArray(choices) && choices.length === 2){\r\n                            group1.push(choices[0].trim());\r\n                            group2.push(choices[1].trim());\r\n                        }\r\n                    });\r\n\r\n                    _.forEach(_.countBy(group1), function(count, identifier){\r\n                        var choice = interaction.getChoiceByIdentifier(identifier);\r\n                        var matchMax = parseInt(choice.attr('matchMax'), 10);\r\n                        if(matchMax && matchMax < count){\r\n                            max = 0;\r\n                            return false;\r\n                        }\r\n                    });\r\n\r\n                    _.forEach(_.countBy(group2), function(count){\r\n                        var matchMax = 1;//match max for a gap is always 1\r\n                        if(matchMax && matchMax < count){\r\n                            max = 0;\r\n                            return false;\r\n                        }\r\n                    });\r\n                }\r\n            }else if(template === 'MAP_RESPONSE') {\r\n\r\n                skippableWrongResponse = (minAssoc === 0) ? Infinity : minAssoc;\r\n                totalAnswerableResponse = (maxAssoc === 0) ? Infinity : maxAssoc;\r\n                usedChoices = {};\r\n                usedGaps = {};\r\n\r\n                //at least a map entry is required to be valid QTI\r\n                if(!responseDeclaration.mapEntries || !_.size(responseDeclaration.mapEntries)){\r\n                    return 0;\r\n                }\r\n\r\n                allPossibleMapEntries = _.clone(responseDeclaration.mapEntries);\r\n                if(mapDefault && mapDefault > 0){\r\n                    _.forEachRight(calculatePossiblePairs(interaction), function(pair){\r\n                        if(!pairExists(allPossibleMapEntries, pair)){\r\n                            allPossibleMapEntries[pair[0]+' '+pair[1]] = mapDefault;\r\n                        }\r\n                    });\r\n                }\r\n\r\n                max = _(allPossibleMapEntries).map(function(score, pair){\r\n                    return {\r\n                        score : parseFloat(score),\r\n                        pair : pair\r\n                    };\r\n                }).sortBy('score').reverse().filter(function(mapEntry){\r\n                    var pair = mapEntry.pair;\r\n                    var _usedChoices = _.cloneDeep(usedChoices);\r\n                    var choices, choiceId, gapId, choice;\r\n\r\n                    if(!_.isString(pair)){\r\n                        return false;\r\n                    }\r\n\r\n                    choices = pair.trim().split(' ');\r\n                    if(_.isArray(choices) && choices.length === 2){\r\n                        choiceId = choices[0];\r\n                        gapId = choices[1];\r\n                        if(!_usedChoices[choiceId]){\r\n                            choice = interaction.getChoiceByIdentifier(choiceId);\r\n                            if(!choice){\r\n                                //inexisting choice, skip\r\n                                return false;\r\n                            }\r\n                            _usedChoices[choiceId] = {\r\n                                used : 0,\r\n                                max: parseInt(choice.attr('matchMax'), 10)\r\n                            };\r\n                        }\r\n                        if(_usedChoices[choiceId].max && _usedChoices[choiceId].used === _usedChoices[choiceId].max){\r\n                            //skip\r\n                            return false;\r\n                        }\r\n                        _usedChoices[choiceId].used ++;\r\n\r\n                        if(!usedGaps[gapId]){\r\n                            usedGaps[gapId] = {\r\n                                used : 0,\r\n                                max: 1\r\n                            };\r\n                        }\r\n                        if(usedGaps[gapId].max && usedGaps[gapId].used === usedGaps[gapId].max){\r\n                            //skip\r\n                            return false;\r\n                        }\r\n                        usedGaps[gapId].used ++;\r\n\r\n                        //if an only if it is ok, we merge the temporary used choices array into the global one\r\n                        _.assign(usedChoices, _usedChoices);\r\n                        return true;\r\n                    }else{\r\n                        //is not a correct response pair\r\n                        return false;\r\n                    }\r\n                }).first(totalAnswerableResponse).reduce(function (acc, v) {\r\n                    var score = v.score;\r\n                    if (score >= 0) {\r\n                        return acc + score;\r\n                    } else if (skippableWrongResponse > 0) {\r\n                        skippableWrongResponse--;\r\n                        return acc;\r\n                    } else {\r\n                        return acc + score;\r\n                    }\r\n                }, 0);\r\n\r\n                //console.log(usedChoices, allPossibleMapEntries, sortedMaps);\r\n\r\n                //compare the calculated maximum with the mapping upperbound\r\n                if (responseDeclaration.mappingAttributes.upperBound) {\r\n                    max = Math.min(max, parseFloat(responseDeclaration.mappingAttributes.upperBound||0));\r\n                }\r\n            }else if(template === 'MAP_RESPONSE_POINT'){\r\n                max = false;\r\n            }\r\n            return max;\r\n        },\r\n\r\n        /**\r\n         * Compute the maximum score of a \"select point\" typed interaction\r\n         * @param {Object} interaction - a standard interaction model object\r\n         * @returns {Number}\r\n         */\r\n        selectPointInteractionBased : function selectPointInteractionBased(interaction){\r\n            var maxChoice = parseInt(interaction.attr('maxChoices'), 10);\r\n            var minChoice = _ignoreMinChoice ? 0 : parseInt(interaction.attr('minChoices'), 10);\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            var template = responseHelper.getTemplateNameFromUri(responseDeclaration.template);\r\n            var max, skippableWrongResponse, totalAnswerableResponse;\r\n\r\n            if (template === 'MATCH_CORRECT' || template === 'MAP_RESPONSE') {\r\n                //such templates are not allowed\r\n                return 0;\r\n            }else if(template === 'MAP_RESPONSE_POINT'){\r\n                //calculate the maximum reachable score by choice map\r\n                skippableWrongResponse = (minChoice === 0) ? Infinity : minChoice;\r\n                totalAnswerableResponse = (maxChoice === 0) ? Infinity : maxChoice;\r\n\r\n                max = _(responseDeclaration.mapEntries).map(function (v) {\r\n                    return parseFloat(v.mappedValue);\r\n                }).sortBy().reverse().first(totalAnswerableResponse).reduce(function (acc, v) {\r\n                    if (v >= 0) {\r\n                        return acc + v;\r\n                    } else if (skippableWrongResponse > 0) {\r\n                        skippableWrongResponse--;\r\n                        return acc;\r\n                    } else {\r\n                        return acc + v;\r\n                    }\r\n                }, 0);\r\n                max = parseFloat(max);\r\n\r\n                //compare the calculated maximum with the mapping upperbound\r\n                if (responseDeclaration.mappingAttributes.upperBound) {\r\n                    max = Math.min(max, parseFloat(responseDeclaration.mappingAttributes.upperBound||0));\r\n                }\r\n            }\r\n            return max;\r\n        },\r\n\r\n        /**\r\n         * Compute the maximum score of a \"slider\" typed interaction\r\n         * @param {Object} interaction - a standard interaction model object\r\n         * @returns {Number}\r\n         */\r\n        sliderInteractionBased : function sliderInteractionBased(interaction){\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            var template = responseHelper.getTemplateNameFromUri(responseDeclaration.template);\r\n            var max, scoreMaps;\r\n\r\n            if (template === 'MATCH_CORRECT') {\r\n                if(!responseDeclaration.correctResponse || (_.isArray(responseDeclaration.correctResponse) && !responseDeclaration.correctResponse.length)){\r\n                    //no correct response defined -> score always zero\r\n                    max = 0;\r\n                }else{\r\n                    max = 1;\r\n                }\r\n            }else if(template === 'MAP_RESPONSE') {\r\n\r\n                //at least a map entry is required to be valid QTI\r\n                if(!responseDeclaration.mapEntries || !_.size(responseDeclaration.mapEntries)){\r\n                    return 0;\r\n                }\r\n\r\n                //calculate the maximum reachable score by choice map\r\n                scoreMaps = _.values(responseDeclaration.mapEntries);\r\n                max = _(scoreMaps).map(function (v) {\r\n                    return parseFloat(v);\r\n                }).max();\r\n                max = parseFloat(max);\r\n\r\n                //compare the calculated maximum with the mapping upperbound\r\n                if (responseDeclaration.mappingAttributes.upperBound) {\r\n                    max = Math.min(max, parseFloat(responseDeclaration.mappingAttributes.upperBound||0));\r\n                }\r\n            }else if(template === 'MAP_RESPONSE_POINT'){\r\n                max = 0;\r\n            }\r\n            return max;\r\n        },\r\n\r\n        /**\r\n         * Compute the maximum score of a \"text entry\" typed interaction\r\n         * @param {Object} interaction - a standard interaction model object\r\n         * @returns {Number}\r\n         */\r\n        textEntryInteractionBased : function textEntryInteractionBased(interaction){\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            var template = responseHelper.getTemplateNameFromUri(responseDeclaration.template);\r\n            var max, scoreMaps;\r\n\r\n            /**\r\n             * Check that a response is possible or not according to the defined patternmask\r\n             * @param {String} value\r\n             * @returns {Boolean}\r\n             */\r\n            var isPossibleResponse = function isPossibleResponse(value){\r\n                var patternMask = interaction.attr('patternMask');\r\n                if(patternMask){\r\n                    return !!value.match(new RegExp(patternMask));\r\n                }else{\r\n                    //no restriction by pattern so always possible\r\n                    return true;\r\n                }\r\n            };\r\n\r\n            if (template === 'MATCH_CORRECT') {\r\n                if(!responseDeclaration.correctResponse || (_.isArray(responseDeclaration.correctResponse) && !responseDeclaration.correctResponse.length)){\r\n                    //no correct response defined -> score always zero\r\n                    max = 0;\r\n                }else{\r\n                    max = isPossibleResponse(responseDeclaration.correctResponse[0]) ? 1 : 0;\r\n                }\r\n            }else if(template === 'MAP_RESPONSE') {\r\n\r\n                //at least a map entry is required to be valid QTI\r\n                if(!responseDeclaration.mapEntries || !_.size(responseDeclaration.mapEntries)){\r\n                    return 0;\r\n                }\r\n\r\n                //calculate the maximum reachable score by choice map\r\n                scoreMaps = _.values(_.filter(responseDeclaration.mapEntries, function(score, key){\r\n                    return isPossibleResponse(key);\r\n                }));\r\n                max = _(scoreMaps).map(function (v) {\r\n                    return parseFloat(v);\r\n                }).max();\r\n                max = parseFloat(max);\r\n\r\n                //compare the calculated maximum with the mapping upperbound\r\n                if (responseDeclaration.mappingAttributes.upperBound) {\r\n                    max = Math.min(max, parseFloat(responseDeclaration.mappingAttributes.upperBound||0));\r\n                }\r\n            }else if(template === 'MAP_RESPONSE_POINT'){\r\n                max = 0;\r\n            }\r\n            return max;\r\n        }\r\n    };\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015-2017 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/xmlRenderer',[\r\n    'taoQtiItem/qtiXmlRenderer/renderers/Renderer',\r\n    'taoQtiItem/qtiItem/helper/maxScore',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n], function(XmlRenderer, maxScore, Element){\r\n    'use strict';\r\n\r\n    var _xmlRenderer = new XmlRenderer({\r\n        shuffleChoices : false\r\n    }).load();\r\n\r\n    var _render = function(element){\r\n        var xml = '';\r\n        try{\r\n            if(element instanceof Element) {\r\n                if (element.is('assessmentItem')) {\r\n                    maxScore.setNormalMaximum(element);\r\n                    maxScore.setMaxScore(element);\r\n                }\r\n                xml = element.render(_xmlRenderer);\r\n            }\r\n        }catch(e){\r\n            console.log(e);\r\n        }\r\n        return xml;\r\n    };\r\n\r\n    return {\r\n        render : _render,\r\n        get : function(){\r\n            return _xmlRenderer;\r\n        }\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/outcomeEditor/panel', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"qti-outcome-editor panel\\\">\\r\\n    <hr/>\\r\\n    <h3 class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Outcome Declarations\", options) : helperMissing.call(depth0, \"__\", \"Outcome Declarations\", options)))\n    + \"</h3>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">here you can provide scoring aspects for manual scoring/marking, e.g. CONTENT, GRAMMAR, SPELLING</span>\\r\\n    <div class=\\\"outcomes\\\">\\r\\n        \";\n  if (helper = helpers.listing) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.listing); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </div>\\r\\n    <a href=\\\"#\\\" class=\\\"adder feedbackRule-add\\\">Add an outcome</a>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/outcomeEditor/listing', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, self=this, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n<div class=\\\"outcome-container panel subpanel\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.readonly), {hash:{},inverse:self.program(4, program4, data),fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <div class=\\\"identifier-label\\\" title=\\\"\";\n  if (helper = helpers.interpretation) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.interpretation); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n        <span class=\\\"label\\\">\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\r\\n        <input class=\\\"identifier\\\"\\r\\n               name=\\\"identifier\\\"\\r\\n               value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n               type=\\\"text\\\"\\r\\n               placeholder=\\\"e.g. CONTENT\\\"\\r\\n               data-validate=\\\"$notEmpty; $qtiIdentifier; $availableVariableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n    </div>\\r\\n    <span class=\\\"trigger icon-bin\\\" title=\\\"\";\n  if (helper = helpers.titleDelete) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.titleDelete); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-role=\\\"delete\\\"></span>\\r\\n    <span class=\\\"trigger icon-edit sidebar-popup-trigger\\\" data-popup=\\\"~ .sidebar-popup\\\" title=\\\"\";\n  if (helper = helpers.titleEdit) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.titleEdit); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-role=\\\"edit\\\"></span>\\r\\n    <div class=\\\"outcome-properties-form\\\">\\r\\n        <div class=\\\"panel\\\">\\r\\n            <label for=\\\"interpretation\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Interpretation\", options) : helperMissing.call(depth0, \"__\", \"Interpretation\", options)))\n    + \"</label>\\r\\n            <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"A human interpretation of the variable's value.\", options) : helperMissing.call(depth0, \"__\", \"A human interpretation of the variable's value.\", options)))\n    + \"</div>\\r\\n            <input name=\\\"interpretation\\\" value=\\\"\";\n  if (helper = helpers.interpretation) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.interpretation); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\">\\r\\n        </div>\\r\\n        <div class=\\\"panel minimum-maximum\\\">\\r\\n            <label class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Value\", options) : helperMissing.call(depth0, \"__\", \"Value\", options)))\n    + \"</label>\\r\\n            <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Defines the maximum magnitude of numeric outcome variables, the maximum must be a positive value and the minimum may be negative.\", options) : helperMissing.call(depth0, \"__\", \"Defines the maximum magnitude of numeric outcome variables, the maximum must be a positive value and the minimum may be negative.\", options)))\n    + \"</div>\\r\\n            <input name=\\\"normalMinimum\\\" value=\\\"\";\n  if (helper = helpers.normalMinimum) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.normalMinimum); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\".1\\\" type=\\\"text\\\" />\\r\\n            <label for=\\\"normalMaximum\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"to\", options) : helperMissing.call(depth0, \"__\", \"to\", options)))\n    + \"</label>\\r\\n            <input name=\\\"normalMaximum\\\" value=\\\"\";\n  if (helper = helpers.normalMaximum) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.normalMaximum); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\".1\\\" data-min=\\\"0\\\" type=\\\"text\\\" />\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \" readonly\";\n  }\n\nfunction program4(depth0,data) {\n  \n  \n  return \" editable deletable\";\n  }\n\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.outcomes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/panel/outcomeEditor',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/plugin',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/helper/popup',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/model/variables/OutcomeDeclaration',\r\n    'taoQtiItem/qtiCreator/helper/xmlRenderer',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/outcomeEditor/panel',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/outcomeEditor/listing'\r\n], function ($, _, __, pluginFactory, Element, popup, formElement, OutcomeDeclaration, xmlRenderer, panelTpl, listingTpl) {\r\n    'use strict';\r\n\r\n    var _ns = '.outcome-editor';\r\n\r\n    /**\r\n     * Get the identifiers of the variables that are used in the response declaration\r\n     *\r\n     * @param {Object} item\r\n     * @returns {Array}\r\n     */\r\n    function getRpUsedVariables(item){\r\n\r\n        var rpXml = xmlRenderer.render(item.responseProcessing);\r\n        var variables = ['SCORE', 'MAXSCORE'];//score and max score are always used, even in template based response processing\r\n        var $rp = $(rpXml);\r\n\r\n        $rp.find('variable,setOutcomeValue').each(function(){\r\n            var id = $(this).attr('identifier');\r\n            variables.push(id);\r\n        });\r\n\r\n        return _.uniq(variables);\r\n    }\r\n\r\n    /**\r\n     * Render the lists of the item outcomes into the outcome editor panel\r\n     *\r\n     * @param {Object} item\r\n     * @param {JQuery} $outcomeEditorPanel\r\n     */\r\n    function renderListing(item, $outcomeEditorPanel){\r\n\r\n        var rpVariables = getRpUsedVariables(item);\r\n        \r\n        var outcomesData = _.map(item.outcomes, function(outcome){\r\n            var readonly = (rpVariables.indexOf(outcome.id()) >= 0);\r\n            return {\r\n                serial : outcome.serial,\r\n                identifier : outcome.id(),\r\n                interpretation : outcome.attr('interpretation'),\r\n                normalMaximum : outcome.attr('normalMaximum'),\r\n                normalMinimum : outcome.attr('normalMinimum'),\r\n                titleDelete : readonly ? __('Cannot delete a variable currently used in response processing') : __('Delete'),\r\n                titleEdit : readonly ? __('Cannot edit a variable currently used in response processing') : __('Edit'),\r\n                readonly : readonly\r\n            };\r\n        });\r\n\r\n        $outcomeEditorPanel.find('.outcomes').html(listingTpl({\r\n            outcomes : outcomesData\r\n        }));\r\n\r\n        //init form javascript\r\n        formElement.initWidget($outcomeEditorPanel);\r\n    }\r\n\r\n    return pluginFactory({\r\n        name: 'outcomeEditor',\r\n        /**\r\n         * Initialize the plugin (called during runner's init)\r\n         */\r\n        init: function init() {\r\n\r\n            var item = this.getHost().getItem();\r\n            var $container = this.getAreaBroker().getContainer();\r\n            var $responsePanel = $container.find('#sidebar-right-response-properties');\r\n            var $outcomeEditorPanel;\r\n\r\n            $container.on('initResponseForm' + _ns, function () {\r\n\r\n                //remove old one if exists\r\n                $responsePanel.find('.qti-outcome-editor').remove();\r\n\r\n                //create new one\r\n                $outcomeEditorPanel = $(panelTpl());\r\n\r\n                //bind behaviour\r\n                $outcomeEditorPanel.on('click'+_ns, '.editable [data-role=\"edit\"]', function(){\r\n\r\n                    var $outcomeContainer = $(this).closest('.outcome-container');\r\n                    var serial = $outcomeContainer.data('serial');\r\n                    var outcome = Element.getElementBySerial(serial);\r\n                    var $labelContainer = $outcomeContainer.find('.identifier-label');\r\n                    var $identifierLabel = $labelContainer.find('.label');\r\n                    var $identifierInput = $labelContainer.find('.identifier');\r\n\r\n                    $outcomeContainer.addClass('editing');\r\n\r\n                    //sync the identifier value in case it was invalid before\r\n                    $identifierInput.focus();\r\n                    $identifierInput.val('');\r\n                    $identifierInput.val(outcome.id());\r\n\r\n                    //attach form change callbacks\r\n                    formElement.setChangeCallbacks($outcomeContainer, outcome, _.assign({\r\n                        identifier : function(outcome, value){\r\n                            //update the html for real time update\r\n                            $identifierLabel.html(value);\r\n\r\n                            //save to model\r\n                            outcome.id(value);\r\n                        },\r\n                        interpretation : function(outcome, value){\r\n                            //update the title attr for real time update\r\n                            $labelContainer.attr('title', value);\r\n\r\n                            //save to model\r\n                            outcome.attr('interpretation', value);\r\n                        }\r\n                    }, formElement.getMinMaxAttributeCallbacks($outcomeContainer, 'normalMinimum', 'normalMaximum', {\r\n                        allowNull : true,\r\n                        floatVal: true,\r\n                        callback : function(outcome, value, attr){\r\n                            if(isNaN(value)){\r\n                                outcome.removeAttr(attr);\r\n                            }\r\n                        }\r\n                    })));\r\n\r\n                }).on('click'+_ns, '.editing [data-role=\"edit\"]', function(){\r\n\r\n                    var $outcomeContainer = $(this).closest('.outcome-container');\r\n                    $outcomeContainer.removeClass('editing');\r\n                    formElement.removeChangeCallback($outcomeContainer);\r\n\r\n                }).on('click'+_ns, '.deletable [data-role=\"delete\"]', function(){\r\n\r\n                    //delete the outcome\r\n                    var $outcomeContainer = $(this).closest('.outcome-container');\r\n                    $outcomeContainer.remove();\r\n                    item.remove('outcomes', $outcomeContainer.data('serial'));\r\n\r\n                }).on('click'+_ns, '.adder', function(){\r\n\r\n                    //add new outcome\r\n                    var newOutcome = new OutcomeDeclaration({\r\n                        cardinality : 'single',\r\n                        baseType : 'float',\r\n                        normalMinimum : 0.0,\r\n                        normalMaximum : 1.0\r\n                    });\r\n\r\n                    //attach the outcome to the item before generating item-level unique id\r\n                    item.addOutcomeDeclaration(newOutcome);\r\n                    newOutcome.buildIdentifier('OUTCOME');\r\n\r\n                    //refresh the list\r\n                    renderListing(item, $outcomeEditorPanel);\r\n                });\r\n\r\n                //attach to response form side panel\r\n                $responsePanel.append($outcomeEditorPanel)\r\n                renderListing(item, $outcomeEditorPanel);\r\n            });\r\n        }\r\n    });\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n\r\n/**\r\n * The plugin loader with the \"required\" plugins\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/loader',[\r\n    'core/pluginLoader',\r\n    'taoQtiItem/qtiCreator/plugins/menu/save',\r\n    'taoQtiItem/qtiCreator/plugins/menu/preview',\r\n    'taoQtiItem/qtiCreator/plugins/menu/print',\r\n    'taoQtiItem/qtiCreator/plugins/content/title',\r\n    'taoQtiItem/qtiCreator/plugins/content/changeTracker',\r\n    'taoQtiItem/qtiCreator/plugins/panel/outcomeEditor',\r\n], function(pluginLoader, save, preview, print, title, changeTracker, outcomeEditor){\r\n    'use strict';\r\n\r\n    /**\r\n     * Instantiate the plugin loader with all the required plugins configured\r\n     */\r\n    return pluginLoader({\r\n        menu       : [save, preview, print],\r\n        content    : [title, changeTracker],\r\n        panel : [outcomeEditor]\r\n    });\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * creator/index controller\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/controller/creator/index',[\r\n    'jquery',\r\n    'lodash',\r\n    'module',\r\n    'core/logger',\r\n    'core/promise',\r\n    'ui/feedback',\r\n    'layout/loading-bar',\r\n    'taoQtiItem/qtiCreator/itemCreator',\r\n    'taoQtiItem/qtiCreator/editor/areaBroker',\r\n    'taoQtiItem/qtiCreator/plugins/loader'\r\n], function($, _, module, loggerFactory, Promise, feedback, loadingBar, itemCreatorFactory, areaBrokerFactory, pluginLoader){\r\n    'use strict';\r\n\r\n    /**\r\n     * Set up the areaBroker mapping from the actual DOM\r\n     * @returns {areaBroker} already mapped\r\n     */\r\n    var loadAreaBroker = function loadAreaBroker(){\r\n        var $container = $('#item-editor-scope');\r\n        return areaBrokerFactory($container, {\r\n            'menu':              $('.menu', $container),\r\n            'menuLeft':          $('.menu-left', $container),\r\n            'menuRight':         $('.menu-right', $container),\r\n            'title':             $('#item-editor-panel > h1', $container),\r\n            'interactionPanel':  $('#item-editor-interaction-bar', $container),\r\n            'propertyPanel':     $('#item-editor-item-widget-bar', $container),\r\n            'itemPanel':         $('#item-editor-scroll-inner', $container),\r\n            'itemPropertyPanel': $('#sidebar-right-item-properties', $container),\r\n            'itemStylePanel':    $('#item-style-editor-bar', $container),\r\n            'modalContainer':    $('#modal-container', $container),\r\n        });\r\n    };\r\n\r\n    /**\r\n     * The creator's controller\r\n     */\r\n    var indexController = {\r\n\r\n        /**\r\n         * The entrypoint\r\n         */\r\n        start : function start(){\r\n\r\n            //TODO move module config away from controllers\r\n            var config = module.config();\r\n\r\n            var logger = loggerFactory('controller/creator');\r\n\r\n            /**\r\n             * Report errors\r\n             * @param {Error} err - the error to report\r\n             */\r\n            var reportError = function reportError(err){\r\n                loadingBar.stop();\r\n\r\n                logger.error(err);\r\n\r\n                if(err instanceof Error){\r\n                    feedback().error(err.message);\r\n                }\r\n            };\r\n\r\n            loadingBar.start();\r\n\r\n            //load plugins dynamically\r\n            if (config) {\r\n                if(config.plugins){\r\n                    _.forEach(config.plugins, function (plugin) {\r\n                        if(plugin && plugin.module){\r\n                            pluginLoader.add(plugin);\r\n                        }\r\n                    });\r\n                }\r\n                if(config.contextPlugins){\r\n                    _.forEach(config.contextPlugins, function (plugin) {\r\n                        if(plugin && plugin.module){\r\n                            if(plugin.exclude){\r\n                                pluginLoader.remove(plugin.module);\r\n                            } else {\r\n                                pluginLoader.add(plugin);\r\n                            }\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            //load the plugins\r\n            pluginLoader.load().then(function(){\r\n\r\n                //build a new item creator\r\n                itemCreatorFactory(config, loadAreaBroker(), pluginLoader.getPlugins())\r\n                    .on('error', reportError)\r\n                    .on('success', function(message){\r\n                        feedback().success(message);\r\n                    })\r\n                    .on('init', function(){\r\n                        this.render();\r\n                    })\r\n                    .on('ready', function(){\r\n                        loadingBar.stop();\r\n                    })\r\n                    .init();\r\n            })\r\n            .catch(reportError);\r\n        }\r\n    };\r\n\r\n    return indexController;\r\n});\r\n\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/editor/blockAdder/tpl/addColumnRow', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  \n\n\n  return \"<div class=\\\"add-block-element\\\">\\r\\n    <div class=\\\"line\\\"></div>\\r\\n    <div class=\\\"circle\\\" title=\\\"Insert block below\\\"><span>+</span></div>\\r\\n</div>\";\n  });\n});\n\n","define('taoQtiItem/qtiCreator/editor/gridEditor/config',[],function(){\r\n    \"use strict\";\r\n    return {\r\n        min : {\r\n            interaction : 2,\r\n            text : 1,\r\n            rubricBlock : 12\r\n        },\r\n        throttle : {\r\n            resize : 100\r\n        }\r\n    };\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/editor/gridEditor/helper',[],function(){\r\n    \"use strict\";\r\n    var helpers = {\r\n        getColUnits : function getColUnits($elt){\r\n\r\n            var cssClasses = $elt.attr('class');\r\n            if(!cssClasses){\r\n                throw new Error('the element has no css class');\r\n            }\r\n\r\n            var colMatch = cssClasses.match(/col-([\\d]+)/);\r\n            if(colMatch && colMatch.length){\r\n                return parseInt(colMatch.pop());\r\n            }else{\r\n                throw 'the element has no col-* class';\r\n            }\r\n        },\r\n        setUnitsFromClass : function setUnitsFromClass($el){\r\n            var units = helpers.getColUnits($el);\r\n            $el.attr('data-units', units);\r\n            return units;\r\n        }\r\n    };\r\n\r\n    return helpers;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/gridEditor/resizable',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/config',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/helper',\r\n    'taoQtiItem/qtiCreator/helper/qtiElements',\r\n    'jqueryui'\r\n], function(_, $, config, helper, qtiElements){\r\n    \"use strict\";\r\n    var _syncHandleHeight = function($row){\r\n        var h = $row.height() - parseFloat($row.children('[class^=\"col-\"], [class*=\" col-\"]').css('margin-bottom'));\r\n        $row.find('.grid-edit-resizable-zone').height(h);\r\n    };\r\n\r\n    var _createResizables = function createResizables($el){\r\n\r\n        var marginWidth = parseFloat($el.find('[class^=\"col-\"]:last, [class*=\" col-\"]:last').css('margin-left')),\r\n            activeWidth = 20;\r\n\r\n\r\n\r\n        $el.find('[class^=\"col-\"], [class*=\" col-\"]').each(function(){\r\n\r\n            var $col = $(this);\r\n\r\n            //@todo this should be more generic\r\n            //see draggable etc for more references\r\n            if($col.parent().hasClass('fixed-grid-row')) {\r\n                return true;\r\n            }\r\n\r\n            if($col.children('.grid-edit-resizable-zone').length){\r\n                //already created, next !\r\n                return true;\r\n            }\r\n\r\n            var $nextCol = $col.next(),\r\n                $row = $col.parent('.grid-row'),\r\n                offset = $col.offset(),\r\n                max = 12,\r\n                min = qtiElements.is($col.data('qti-class'), 'interaction') ? config.min.interaction : config.min.text,\r\n                nextMin = qtiElements.is($nextCol.data('qti-class'), 'interaction') ? config.min.interaction : config.min.text,\r\n                unitWidth = $row.width() / max;\r\n\r\n            var activeHeight = $row.height() - parseFloat($col.css('margin-bottom'));\r\n            var $activeZone = $('<div>', {'class' : 'grid-edit-resizable-zone grid-edit-resizable-zone-active'}).css({top : 0, right : -(marginWidth + (activeWidth - marginWidth) / 2), width : activeWidth, height : activeHeight});\r\n            var $handle = $('<span>', {'class' : 'grid-edit-resizable-handle'});\r\n            $activeZone.append($handle);\r\n            $col.append($activeZone);\r\n\r\n            var _syncOutlineHeight = function(){\r\n                var h = $row.height() - parseFloat($col.css('margin-bottom'));\r\n                $col.find('.grid-edit-resizable-outline').height(h);\r\n                $activeZone.height(h);\r\n            };\r\n\r\n            $activeZone.draggable({\r\n                containment : $nextCol.length ? [\r\n                    offset.left + min * unitWidth - marginWidth * 2 + 10,\r\n                    offset.top,\r\n                    offset.left + $col.outerWidth() + marginWidth + $nextCol.outerWidth() - nextMin * unitWidth - activeWidth / 2 - 10,\r\n                    offset.top + $col.height()\r\n                ] : [\r\n                    offset.left + min * unitWidth - marginWidth - activeWidth / 2 - 10,\r\n                    offset.top,\r\n                    $row.offset().left + $row.outerWidth() - marginWidth - activeWidth / 2 - 12,\r\n                    offset.top + $col.height()\r\n                ],\r\n                axis : 'x',\r\n                cursor : 'col-resize',\r\n                start : function(){\r\n\r\n                    $col.trigger('resizestart.gridEdit');\r\n\r\n                    var $overlay = $('<div>', {'class' : 'grid-edit-resizable-outline'});\r\n                    if($nextCol.length){\r\n                        $overlay.width(parseFloat($col.outerWidth()) + marginWidth + parseFloat($nextCol.outerWidth()));\r\n                    }else{\r\n                        $overlay.css({'width' : '100%', 'border-right-width' : 0});\r\n                    }\r\n                    //store in memory for quick access during resize:\r\n                    $(this).data('overlay', $overlay);\r\n                    $col.append($overlay);\r\n                    $handle.addClass('grid-edit-resizable-active');\r\n                    $el.find('.grid-edit-resizable-zone-active').removeClass('grid-edit-resizable-zone-active');\r\n                    _syncOutlineHeight();\r\n\r\n                },\r\n                drag : _.throttle(function(){\r\n\r\n                    var width = ($(this).offset().left + activeWidth / 2) - offset.left,\r\n                        units = helper.getColUnits($col),\r\n                        nextUnits = $nextCol.length ? helper.getColUnits($nextCol) : 0;\r\n\r\n                    if(!$nextCol.length){\r\n                        //need to resize the outline element:\r\n                        $col.find('.grid-edit-resizable-outline').width($handle.offset().left - offset.left);\r\n                    }\r\n\r\n                    if(width + marginWidth * 0 < (units - 1) * unitWidth){//need to compensate for the width of the active zone\r\n                        \r\n                        units--;\r\n                        _setColUnits($col, units);\r\n\r\n                        if($nextCol.length){\r\n                            nextUnits++;\r\n                            _setColUnits($nextCol, nextUnits);\r\n                        }\r\n\r\n                        _syncOutlineHeight();\r\n                        \r\n                        $col.trigger('resize.gridEdit');\r\n                        \r\n                    }else if(width + marginWidth + 20 > (units + 1) * unitWidth){//need to compensate for the width of the active zone\r\n                        \r\n                        units++;\r\n                        _setColUnits($col, units);\r\n\r\n                        if($nextCol.length){\r\n                            nextUnits--;\r\n                            _setColUnits($nextCol, nextUnits);\r\n                        }\r\n\r\n                        _syncOutlineHeight();\r\n                        \r\n                        $col.trigger('resize.gridEdit');\r\n                    }\r\n\r\n                }, config.throttle.resize),\r\n                stop : function(){\r\n\r\n                    $col.find('.grid-edit-resizable-outline').remove();\r\n\r\n                    _deleteResizables($el);\r\n                    _createResizables($el);\r\n\r\n                    $col.trigger('resizestop.gridEdit');\r\n                }\r\n            }).css('position', 'absolute');\r\n\r\n        });\r\n\r\n        $el.off('.gridEdit.resizable').on('dragoverstart.gridEdit.resizable', function(){\r\n\r\n            _deleteResizables($el);\r\n\r\n        }).on('dragoverstop.gridEdit.resizable', function(){\r\n\r\n            _createResizables($el);\r\n\r\n        }).on('contentChange.gridEdit.resizable', '.grid-row', function(){\r\n\r\n            _deleteResizables($el);\r\n            _createResizables($el);\r\n        });\r\n\r\n    };\r\n\r\n    var _deleteResizables = function _deleteResizables($el){\r\n        \r\n        $el.find('.grid-edit-resizable-zone').remove();\r\n    };\r\n\r\n    var _setColUnits = function _setColUnits($elt, newUnits){\r\n        \r\n        if($elt.attr('class').match(/col-([\\d]+)/)){\r\n            \r\n            var oldUnits = $elt.attr('data-units');\r\n            var $parentRow = $elt.parent('.grid-row');\r\n            var totalUnits = $parentRow.attr('data-units');\r\n            $parentRow.attr('data-units', totalUnits - oldUnits + newUnits);//update parent\r\n            $elt.attr('data-units', newUnits);//update element\r\n            $elt.removeClass('col-' + oldUnits).addClass('col-' + newUnits);\r\n            \r\n        }else{\r\n            \r\n            throw $.error('the element is not a grid column');\r\n        }\r\n    };\r\n\r\n    return {\r\n        create : function($element){\r\n            \r\n            _createResizables($element);\r\n            \r\n            $(window).off('resize.qtiEdit.resizable').on('resize.qtiEdit.resizable', function(){\r\n                \r\n                _deleteResizables($element);\r\n                _createResizables($element);\r\n            });\r\n        },\r\n        destroy : function($element, preserveGlobalEvents){\r\n            \r\n            _deleteResizables($element);\r\n            \r\n            if(!preserveGlobalEvents){\r\n                \r\n                $(window).off('resize.qtiEdit.resizable');\r\n            }\r\n        },\r\n        syncHandleHeight : function($row){\r\n        \r\n            if($row.hasClass('grid-row')){\r\n                _syncHandleHeight($row);\r\n            }else{\r\n                $row.find('.grid-row').each(function(){\r\n                    _syncHandleHeight($(this));\r\n                });\r\n            }\r\n        }\r\n\r\n    };\r\n});\n","define('taoQtiItem/qtiCreator/widgets/helpers/textWrapper',['jquery'], function($){\r\n\r\n    function getSelection(){\r\n\r\n        var selection;\r\n\r\n        if(window.getSelection){\r\n            selection = window.getSelection();\r\n        }else if(document.selection){\r\n            selection = document.selection.createRange();\r\n        }\r\n\r\n        return selection;\r\n    }\r\n\r\n    function containElement(selection, range){\r\n\r\n        if(range.commonAncestorContainer.nodeType === 1){\r\n            var selectedChildNodes = range.cloneContents().childNodes;\r\n            for (var i = 0; i < selectedChildNodes.length; i++){\r\n                if(selectedChildNodes[i].className && \r\n                   selectedChildNodes[i].className.indexOf(\"qti-choice\") > -1){\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function wrapSelection(wrap){\r\n\r\n        var sel = getSelection();\r\n        if(sel.rangeCount){\r\n            var range = sel.getRangeAt(0).cloneRange();\r\n            if(range.startOffset !== range.endOffset && //prevent empty selection\r\n                range.toString().trim() && //prevent empty selection\r\n                !containElement(sel, range)\r\n                ){\r\n                        \r\n                range.surroundContents(wrap);\r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n                return true;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function unwrapSelection($editable){\r\n\r\n        var $wrapper = $editable.find('#selection-wrapper');\r\n\r\n        $editable.trigger('beforeunwrap');\r\n\r\n        $wrapper.find('[data-role]').remove();\r\n        $wrapper.replaceWith(function(){\r\n            return $(this).html();\r\n        });\r\n\r\n        $editable.trigger('unwrapped');\r\n    }\r\n\r\n    var textWrapper = {\r\n        create : function($editable){\r\n\r\n            //reset it first:\r\n            textWrapper.destroy($editable);\r\n\r\n            //add listeners:\r\n            $editable.on('mouseup.textwrapper', function(e){\r\n\r\n                var $target = $(e.target);\r\n                if($target.hasClass('html-editable-shield') || $target.hasClass('widget-box')){\r\n                    return;\r\n                }\r\n\r\n                var $wrapper = $('<span>', {id : 'selection-wrapper', 'class' : 'inline-text-wrapper'});\r\n                if(wrapSelection($wrapper[0])){\r\n                    var wrappedText = $wrapper.text().trim();\r\n                    $editable.trigger('wrapped', [$wrapper, wrappedText]);\r\n                }\r\n\r\n            }).on('mousedown.textwrapper', function(){\r\n\r\n                unwrapSelection($editable);\r\n\r\n            });\r\n\r\n        },\r\n        destroy : function($editable){\r\n\r\n            unwrapSelection($editable);\r\n            $editable.off('.textwrapper');\r\n        },\r\n        unwrap : function($editable){\r\n            unwrapSelection($editable);\r\n        }\r\n    };\r\n\r\n    return textWrapper;\r\n});\n","define('taoQtiItem/qtiCreator/editor/gridEditor/content',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/resizable',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/textWrapper'\r\n], function($, _, resizable, textWrapper){\r\n    \"use strict\";\r\n    var contentHelper = {};\r\n\r\n    /**\r\n     * Get html string content for a qti container\r\n     * \r\n     * @param {string|domelement|jquery} element\r\n     * @returns {string}\r\n     */\r\n    contentHelper.getContent = function(element, opts){\r\n\r\n        var options = _.defaults({\r\n            inner : true\r\n        }, opts);\r\n\r\n        var $body = options.inner ? $(element).clone() : $('<div>', {'class' : 'col-fictive content-helper-wrapper'}).append($(element).clone());\r\n\r\n        contentHelper.destroyGridWidgets($body, true);//working on clone only, so destroyGridWidgetsClone\r\n\r\n        contentHelper.serializeElements($body);\r\n        \r\n        return $body.html();\r\n    };\r\n\r\n    /**\r\n     * Create a callback function for the ck edit:\r\n     * \r\n     * @param {object} container\r\n     */\r\n    contentHelper.getChangeCallback = function(container){\r\n\r\n        return _.throttle(function(data){\r\n\r\n            var $pseudoContainer = $('<div>').html(data),\r\n                newBody = contentHelper.getContent($pseudoContainer);\r\n\r\n            container.body(newBody);\r\n\r\n        }, 800);\r\n    };\r\n\r\n    /**\r\n     * Create a callback function for the ck edit (special case of blockstatic content\r\n     * \r\n     * @param {object} container\r\n     */\r\n    contentHelper.getChangeCallbackForBlockStatic = function(container){\r\n\r\n        return _.throttle(function(data){\r\n\r\n            var $pseudoContainer = $('<div>').html(data);\r\n            \r\n            $pseudoContainer.contents().each(function(){\r\n                \r\n                if(this.nodeType === 3 && this.nodeValue.trim()){\r\n                    \r\n                    //use jquery to wrap all content by a <p> \r\n                    $pseudoContainer.wrapInner('<p>');\r\n                    \r\n                    //... transform it into valid html :  <p><p>aaa</p></p> becomes <p></p><p>aaa</p><p></p>\r\n                    $pseudoContainer = $('<div>').html($pseudoContainer.html());\r\n                    \r\n                    return false;//breaks jquery each loop\r\n                }\r\n            });\r\n\r\n            textWrapper.unwrap($pseudoContainer);\r\n\r\n            container.body(contentHelper.getContent($pseudoContainer));\r\n\r\n        }, 800);\r\n    };\r\n\r\n    contentHelper.serializeElements = function($el){\r\n\r\n        var existingElements = [];\r\n\r\n        //select only the first level of \".widget-box\" found\r\n        $el.find('.widget-box:not(.widget-box *)').each(function(){\r\n\r\n            var $qtiElementWidget = $(this);\r\n\r\n            if($qtiElementWidget.data('serial')){\r\n\r\n                //an existing qti element:\r\n                var serial = $qtiElementWidget.data('serial');\r\n                $qtiElementWidget.replaceWith('{{' + serial + '}}');\r\n\r\n                //store existing element\r\n                existingElements.push(serial);\r\n\r\n            }else if($qtiElementWidget.data('new') && $qtiElementWidget.data('qti-class')){\r\n\r\n                //a newly inserted qti element\r\n                var qtiClass = $qtiElementWidget.data('qti-class');\r\n                $qtiElementWidget.replaceWith('{{' + qtiClass + ':new}}');\r\n\r\n            }else{\r\n\r\n                throw 'unknown qti-widget type';\r\n            }\r\n\r\n        });\r\n\r\n        return existingElements;\r\n    };\r\n\r\n    contentHelper.destroyGridWidgets = function($elt, inClone){\r\n\r\n        $elt.removeData('qti-grid-options');\r\n\r\n        $elt.find('.grid-row, [class*=\" col-\"], [class^=\"col-\"]')\r\n            .removeAttr('style')\r\n            .removeAttr('data-active')\r\n            .removeAttr('data-units');\r\n\r\n        $elt.children('.ui-draggable-dragging').remove();\r\n\r\n        resizable.destroy($elt, inClone);\r\n        \r\n        $elt.find('.contextual-popup').remove();\r\n    };\r\n\r\n    return contentHelper;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/editor/elementSelector/tpl/popup', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div class=\\\"contextual-popup\\\" style=\\\"top:\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.popup)),stack1 == null || stack1 === false ? stack1 : stack1.top)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"px; left:\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.popup)),stack1 == null || stack1 === false ? stack1 : stack1.left)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"px\\\">\\r\\n    <div class=\\\"arrow\\\" style=\\\"left:\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.arrow)),stack1 == null || stack1 === false ? stack1 : stack1.left)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"px\\\"></div>\\r\\n    <div class=\\\"arrow-cover\\\" style=\\\"left:\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.arrow)),stack1 == null || stack1 === false ? stack1 : stack1.leftCover)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"px\\\"></div>\\r\\n    <div class=\\\"popup-content\\\">\";\n  if (helper = helpers.content) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.content); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n    <div class=\\\"footer\\\">\\r\\n        <button class=\\\"btn btn-info small done\\\">done</button>\\r\\n        <a href=\\\"#\\\" class=\\\"btn cancel\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"cancel\", options) : helperMissing.call(depth0, \"__\", \"cancel\", options)))\n    + \"\\\">cancel</a>\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/editor/elementSelector/tpl/content', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n        <li data-group-name=\\\"\";\n  if (helper = helpers.name) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.name); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"><a href=\\\"#\\\" class=\\\"group-selector\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</a></li>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n        <div class=\\\"element-group\\\" data-group-name=\\\"\";\n  if (helper = helpers.name) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.name); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n            <ul class=\\\"element-list plain\\\">\\r\\n                \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.elements), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n            </ul>\\r\\n        </div>\\r\\n        \";\n  return buffer;\n  }\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n                <li data-qti-class=\\\"\";\n  if (helper = helpers.qtiClass) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.qtiClass); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" title=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n                    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.iconFont), {hash:{},inverse:self.program(7, program7, data),fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                    <span class=\\\"label truncate\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\r\\n                </li>\\r\\n                \";\n  return buffer;\n  }\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n                    <span class=\\\"icon \";\n  if (helper = helpers.icon) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.icon); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span>\\r\\n                    \";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n                    <img class=\\\"icon\\\" src=\\\"\";\n  if (helper = helpers.icon) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.icon); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"/>\\r\\n                    \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"elementSelector\\\">\\r\\n\\r\\n    <ul class=\\\"group-list plain\\\">\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.groups), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </ul>\\r\\n\\r\\n    <div class=\\\"element-group-container\\\">\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.groups), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </div>\\r\\n\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/editor/elementSelector/selector',[\r\n    'jquery',\r\n    'lodash',\r\n    'tpl!taoQtiItem/qtiCreator/editor/elementSelector/tpl/popup',\r\n    'tpl!taoQtiItem/qtiCreator/editor/elementSelector/tpl/content'\r\n], function($, _, popupTpl, contentTpl){\r\n\r\n    var _ns = '.element-selector';\r\n    \r\n    /**\r\n     * Create an element selector reltive to the $anchor and contained in the $container\r\n     * \r\n     * @param {JQuery} $anchor\r\n     * @param {JQuery} $container\r\n     * @param {Array} interactions - the list of authorable interactions\r\n     * @returns {Object} the new selector instance\r\n     */\r\n    function create($anchor, $container, interactions){\r\n        \r\n        //anchor must be positioned in css\r\n        var positions = _computePosition($anchor, $container);\r\n        var $element = $(popupTpl({\r\n            popup : positions.popup,\r\n            arrow : positions.arrow,\r\n            content : _renderContent(interactions)\r\n        }));\r\n\r\n        //only one \r\n        $anchor.find('.contextual-popup').remove();\r\n\r\n        //style and attach the form\r\n        $anchor.append($element);\r\n\r\n        $element.off(_ns).on('click' + _ns, '.group-list li', function(){\r\n            var $trigger = $(this);\r\n            _activatePanel($element, $trigger);\r\n        }).on('click' + _ns, '.element-list li', function(){\r\n            _activateElement($element, $(this));\r\n        }).on('click' + _ns, '.done', function(){\r\n            _done($element);\r\n        }).on('click' + _ns, '.cancel', function(){\r\n            _cancel($element);\r\n        });\r\n\r\n        return {\r\n            getPopup : function(){\r\n                return $element;\r\n            },\r\n            reposition : function(){\r\n                var pos = _computePosition($anchor, $container);\r\n                $element.css({\r\n                    top : pos.popup.top,\r\n                    left : pos.popup.left\r\n                });\r\n                $element.children('.arrow').css('left', pos.arrow.left);\r\n                $element.children('.arrow-cover').css('left', pos.arrow.leftCover);\r\n            },\r\n            activatePanel : function(groupName){\r\n                activatePanel($element, groupName);\r\n            },\r\n            activateElement : function(qtiClass){\r\n                activateElement($element, qtiClass);\r\n            },\r\n            done : function(){\r\n                _done($element);\r\n            },\r\n            cancel : function(){\r\n                _cancel($element);\r\n            },\r\n            show : function(){\r\n                $element.show();\r\n            },\r\n            destroy : function(){\r\n                $element.remove();\r\n            }\r\n        };\r\n    }\r\n    \r\n    /**\r\n     * Callback when the \"done\" button is clicked\r\n     * \r\n     * @param {JQuery} $element\r\n     */\r\n    function _done($element){\r\n        $element.hide();\r\n        $element.trigger('done' + _ns);\r\n    }\r\n    \r\n    /**\r\n     * Callback when the \"cancel\" button is clicked\r\n     * \r\n     * @param {JQuery} $element\r\n     */\r\n    function _cancel($element){\r\n        $element.hide();\r\n        $element.trigger('cancel' + _ns);\r\n    }\r\n    \r\n    /**\r\n     * Activate the panel defined by the groupName\r\n     * \r\n     * @param {JQuery} $container\r\n     * @param {String} groupName\r\n     */\r\n    function activatePanel($container, groupName){\r\n        var $trigger = $container.find('.group-list li[data-group-name=\"' + groupName + '\"]');\r\n        _activatePanel($container, $trigger);\r\n    }\r\n    \r\n    /**\r\n     * Activate a panel by its trigger button in the navigation tab\r\n     * \r\n     * @param {JQuery} $container\r\n     * @param {JQuery} $trigger\r\n     */\r\n    function _activatePanel($container, $trigger){\r\n        if(!$trigger.hasClass('active')){\r\n            $trigger.addClass('active').siblings('.active').removeClass('active');\r\n            var group = $trigger.data('group-name');\r\n            var $group = $container.find('.element-group[data-group-name=\"' + group + '\"]');\r\n            $group.show().siblings('.element-group').hide();\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Activate an element identified by its qti class\r\n     * \r\n     * @param {JQuery} $container\r\n     * @param {String} qtiClass\r\n     */\r\n    function activateElement($container, qtiClass){\r\n        var $trigger = $container.find('.element-list li[data-qti-class=\"' + qtiClass + '\"]');\r\n        _activateElement($container, $trigger);\r\n    }\r\n    \r\n    /**\r\n     * Activate an element identified by its $trigger dom element\r\n     * \r\n     * @param {JQuery} $container\r\n     * @param {JQuery} $trigger\r\n     */\r\n    function _activateElement($container, $trigger){\r\n        var qtiClass = $trigger.data('qti-class');\r\n        if(!$trigger.hasClass('active')){\r\n            $container.find('.element-list li').removeClass('active');\r\n            $trigger.addClass('active');\r\n            $container.trigger('selected' + _ns, [qtiClass, $trigger]);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Calculate the position of the popup and arrow relative to the anchor and container elements\r\n     * \r\n     * @param {JQuery} $anchor\r\n     * @param {JQuery} $container\r\n     * @returns {Object} - Object containing the positioning data\r\n     */\r\n    function _computePosition($anchor, $container){\r\n        \r\n        var popupWidth = 500;\r\n        var arrowWidth = 6;\r\n        var marginTop = 15;\r\n        var marginLeft = 15;\r\n        var _anchor = {top : $anchor.offset().top, left : $anchor.offset().left, w : $anchor.innerWidth(), h : $anchor.innerHeight()};\r\n        var _container = {top : $container.offset().top, left : $container.offset().left, w : $container.innerWidth()};\r\n        var _popup = {\r\n            top : _anchor.h + marginTop,\r\n            left : -popupWidth / 2 + _anchor.w/2,\r\n            w : popupWidth\r\n        };\r\n        \r\n        var offset = _anchor.left - _container.left;\r\n        //do we have enough space on the left ?\r\n        if(offset + marginLeft + _anchor.w/2 < _popup.w / 2){\r\n            _popup.left = -offset + marginLeft;\r\n        }else if(_container.w - (offset + _anchor.w/2 + marginLeft) < _popup.w / 2){\r\n            _popup.left = -offset + _container.w - marginLeft - _popup.w;\r\n        }\r\n\r\n        var _arrow = {\r\n            left : -_popup.left + _anchor.w / 2 - arrowWidth,\r\n            leftCover : -_popup.left + _anchor.w / 2 - arrowWidth - 6\r\n        };\r\n\r\n        return {\r\n            popup : _popup,\r\n            arrow : _arrow\r\n        };\r\n    }\r\n    \r\n    /**\r\n     * Filter and format the raw authorable interactions array into useful data for this selector\r\n     * @param {Array} interactions\r\n     * @returns {Array}\r\n     */\r\n    function _filterInteractions(interactions){\r\n        var block;\r\n        //remove all inline interactions, keep block container only\r\n        var filtered = _.filter(interactions, function(interaction){\r\n            var tags = interaction.tags;\r\n            if(interaction.qtiClass === '_container'){\r\n                block = interaction;\r\n                interaction.tags[0] = 'Text Block';\r\n                return false;\r\n            }else if(tags && tags[0] !== 'Inline Interactions'){\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        block.tags[0] = 'Text Block';\r\n        filtered.unshift(block);\r\n        return filtered;\r\n    }\r\n    \r\n    /**\r\n     * Render the content of the selector from the list of authorable interactions as data\r\n     * \r\n     * @param {Array} interactions\r\n     * @returns {String} \r\n     */\r\n    function _renderContent(interactions){\r\n\r\n        var groups = [];\r\n        _.each(_filterInteractions(interactions), function(interaction){\r\n\r\n            var groupName = interaction.tags[0];\r\n            var panel = _.find(groups, {name : groupName});\r\n            if(!panel){\r\n                panel = {\r\n                    name : groupName,\r\n                    label : groupName.replace(/\\sInteractions$/, ''),\r\n                    elements : []\r\n                };\r\n                groups.push(panel);\r\n            }\r\n\r\n            panel.elements.push({\r\n                qtiClass : interaction.qtiClass,\r\n                disabled : !!interaction.disabled,\r\n                title : interaction.description,\r\n                iconFont : /^icon-/.test(interaction.icon),\r\n                icon : interaction.icon,\r\n                label : interaction.label\r\n            });\r\n        });\r\n\r\n        return contentTpl({\r\n            groups : groups\r\n        });\r\n    }\r\n\r\n    return {\r\n        create : create,\r\n        activateElement : activateElement,\r\n        activatePanel : activatePanel\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/Widget',[\r\n    'lodash',\r\n    'jquery',\r\n    'core/promise',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/model/helper/invalidator',\r\n    'core/logger'\r\n], function(_, $, Promise, Element, invalidator, loggerFactory){\r\n    'use strict';\r\n\r\n    var _pushState = function(widget, stateName){\r\n        var currentState = new widget.registeredStates[stateName](widget);\r\n        widget.stateStack.push(currentState);\r\n        currentState.init();\r\n    };\r\n\r\n    var _popState = function(widget){\r\n        var state = widget.stateStack.pop();\r\n        if(state){\r\n            state.exit();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Create a logger\r\n     */\r\n    var logger = loggerFactory('taoQtiItem/qtiCreator/widget');\r\n\r\n    var Widget = {\r\n        /**\r\n         * Intialize qti element creator widget\r\n         *\r\n         * @param {Object} element - standard qti object\r\n         * @param {Jquery} $original - tje proginal DOM element of the qti element\r\n         * @param {JQuery} $form - the property form of the qti element\r\n         * @param {Object} options\r\n         * @fires ready.qti-widget after it is executed\r\n         * @returns {Object} The initialized widget\r\n         */\r\n        init : function(element, $original, $form, options){\r\n            var self = this;\r\n\r\n            if(element instanceof Element){\r\n\r\n                options = options || {};\r\n\r\n                this.element = element;\r\n                this.serial = element.getSerial();\r\n                this.$original = $original;\r\n                this.$form = $form;\r\n                this.stateStack = [];\r\n\r\n                this.registeredStates = {};\r\n\r\n                //build container from origin element\r\n                this.buildContainer();\r\n\r\n                //attach the widget to widget $container and element:\r\n                this.$original.data('widget', this);\r\n                this.$container.data('widget', this);\r\n\r\n                this.element.data('widget', this);\r\n\r\n                //clean old referenced event\r\n                this.offEvents();//not sure if still required after state definition\r\n\r\n                //pass the options to the initCreator for custom options usage\r\n                _.each(this.getRequiredOptions(), function(opt){\r\n                    if(!options[opt]){\r\n                        throw new Error('missing required option for image creator : ' + opt);\r\n                    }\r\n                });\r\n                this.options = options;\r\n                Promise.resolve(this.initCreator(options)).then(function(){\r\n                    //communicate the widget readiness\r\n                    if(_.isFunction(self.options.ready)){\r\n                        self.options.ready.call(self, self);\r\n                    }\r\n                    self.$container.trigger('ready.qti-widget', [self]);\r\n                });\r\n\r\n                //init state after creator init\r\n                if(this.options.state){\r\n                    this.changeState(this.options.state);\r\n                }else{\r\n                    this.changeState('sleep');\r\n                }\r\n            }else{\r\n                throw new Error('element is not a QTI Element');\r\n            }\r\n            return this;\r\n        },\r\n        getAreaBroker : function getAreaBroker() {\r\n            var element = this.element,\r\n                renderer = element.getRenderer();\r\n\r\n            if (renderer) {\r\n                return renderer.getAreaBroker();\r\n            }\r\n        },\r\n        getRequiredOptions : function(){\r\n            return [];\r\n        },\r\n        buildContainer : function(){\r\n            throw new Error('method buildContainer must be implemented');\r\n        },\r\n        build : function(element, $container, $form, options){\r\n            return this.clone().init(element, $container, $form, options);\r\n        },\r\n        clone : function(){\r\n            return _.clone(this);\r\n        },\r\n        initCreator : function(){\r\n            //prepare all common actions, event handlers and dom for every state of the widget\r\n\r\n            var $interaction = this.$container.find('.qti-interaction');\r\n            var serial       = $interaction.data('serial');\r\n\r\n            this.$container.on('resize.itemResizer', function() {\r\n                $(window).trigger('resize.qti-widget.' + serial);\r\n            });\r\n        },\r\n        getCurrentState : function(){\r\n            return _.last(this.stateStack);\r\n        },\r\n        /**\r\n         * Very important method:\r\n         * It changes the state of the widget by checking the relation between\r\n         * the target and the current states.\r\n         *\r\n         * @param {string} stateName\r\n         * @returns {object} this\r\n         */\r\n        changeState : function(stateName){\r\n\r\n            var self = this,\r\n                state,\r\n                superStateName,\r\n                currentState = this.getCurrentState(),\r\n                exitedStates,\r\n                enteredStates,\r\n                i;\r\n\r\n            logger.trace('changing state of ' + this.serial + ': ' + (currentState || {}).name + ' => ' + stateName);\r\n\r\n            if(this.registeredStates[stateName]){\r\n                state = new this.registeredStates[stateName]();\r\n            }else{\r\n                throw new Error('unknown target state : ' + stateName);\r\n            }\r\n\r\n            if(currentState){\r\n\r\n                if(currentState.name === state.name){\r\n                    return this;\r\n                }else if(_.indexOf(state.superState, currentState.name) >= 0){\r\n\r\n                    //initialize super states in reverse order:\r\n                    for(i = _.indexOf(state.superState, currentState.name) - 1; i >= 0; i--){\r\n                        superStateName = state.superState[i];\r\n                        _pushState(this, superStateName);\r\n                    }\r\n\r\n                }else if(_.indexOf(currentState.superState, state.name) >= 0){\r\n\r\n                    //just exit as much state as needed to get to it:\r\n                    for(i = 0; i <= _.indexOf(currentState.superState, state.name); i++){\r\n                        _popState(self);\r\n                    }\r\n\r\n                    return this;\r\n\r\n                }else{\r\n\r\n                    //first, exit the current state\r\n                    _popState(self);\r\n\r\n                    //then, exit super states in order:\r\n                    exitedStates = _.difference(currentState.superState, state.superState);\r\n                    _.each(exitedStates, function(){\r\n                        _popState(self);\r\n                    });\r\n\r\n                    //finally, init super states in reverse order:\r\n                    enteredStates = _.difference(state.superState, currentState.superState);\r\n                    _.eachRight(enteredStates, function(_superStateName){\r\n                        _pushState(self, _superStateName);\r\n                    });\r\n                }\r\n\r\n            }else{\r\n                _.eachRight(state.superState, function(_superStateName){\r\n                    _pushState(self, _superStateName);\r\n                });\r\n            }\r\n\r\n            _pushState(this, stateName);\r\n            return this;\r\n        },\r\n        registerState : function(name, State){\r\n            if(name && State){\r\n                this.registeredStates[name] = State;\r\n            }else{\r\n                throw new Error('missing required arguments in state registration');\r\n            }\r\n        },\r\n        registerStates : function(states){\r\n            var self = this;\r\n            _.forIn(states, function(State, name){\r\n                self.registerState(name, State);\r\n            });\r\n        },\r\n        afterStateInit : function(callback, ns){\r\n            var evtName = 'afterStateInit.qti-widget.' + this.serial + (ns ? '.' + ns : '');\r\n            $(document).on(evtName, callback);\r\n        },\r\n        beforeStateInit : function(callback, ns){\r\n            var evtName = 'beforeStateInit.qti-widget.' + this.serial + (ns ? '.' + ns : '');\r\n            $(document).on(evtName, callback);\r\n        },\r\n        afterStateExit : function(callback, ns){\r\n            var evtName = 'afterStateExit.qti-widget.' + this.serial + (ns ? '.' + ns : '');\r\n            $(document).on(evtName, callback);\r\n        },\r\n        beforeStateExit : function(callback, ns){\r\n            var evtName = 'beforeStateExit.qti-widget.' + this.serial + (ns ? '.' + ns : '');\r\n            $(document).on(evtName, callback);\r\n        },\r\n        offEvents : function(ns){\r\n            var evtName = '.qti-widget.' + this.serial + (ns ? '.' + ns : '');\r\n            $(document).off(evtName);\r\n\r\n            this.$container.off('resize.itemResizer');\r\n        },\r\n        destroy : function(){\r\n\r\n            //to call exit method and clean up listeners\r\n            this.changeState('sleep');\r\n\r\n            //remove editable widgets\r\n            this.$container.find('[data-edit]').remove();\r\n            $('[data-widget-component=' + this.serial + ']').remove();\r\n\r\n            //clean old referenced event\r\n            this.offEvents();\r\n        },\r\n        rebuild : function(options){\r\n            var element,\r\n                postRenderOpts,\r\n                $container,\r\n                renderer;\r\n\r\n            options = options || {};\r\n\r\n            element = this.element;\r\n            postRenderOpts = {};\r\n            if(_.isFunction(options.ready)){\r\n                postRenderOpts.ready = options.ready;\r\n            }\r\n\r\n            $container = null;\r\n            if(options.context && options.context.length){\r\n                //if the context option is provided, the function will fetch the widget container that in this context\r\n                //mandatory for detached of duplicated DOM element (e.g. ckEditor)\r\n                $container = options.context.find('.widget-box[data-serial=' + element.serial + ']');\r\n            }else if(this.$container.length && $.contains(document, this.$container[0])){\r\n                //if the container exist and is NOT detached\r\n                $container = this.$container;\r\n            }else{\r\n                //otherwise use less performance efficient selector\r\n                $container = $('.widget-box[data-serial=' + element.serial + ']');\r\n            }\r\n\r\n            //once required data ref has been set, destroy it:\r\n            this.destroy();\r\n\r\n            //we assume that the element still has its renderer set, check renderer:\r\n            renderer = element.getRenderer();\r\n\r\n            if(renderer && renderer.isRenderer){\r\n                if(renderer.name === 'creatorRenderer'){\r\n                    element.render($container);\r\n                    element.postRender(postRenderOpts);\r\n                    return element.data('widget');\r\n                }else{\r\n                    throw new Error('The renderer is no longer the creatorRenderer');\r\n                }\r\n            }else{\r\n                throw new Error('No renderer found to rebuild the widget');\r\n            }\r\n        },\r\n\r\n        refresh : function(){\r\n\r\n            var currentState = this.getCurrentState().name;\r\n\r\n            this.rebuild({\r\n                ready:function(widget){\r\n                    widget.changeState(currentState);\r\n                }\r\n            });\r\n        },\r\n\r\n        //assign an event listener that lives with the state\r\n        on : function(qtiElementEventName, callback, live){\r\n\r\n            var self = this,\r\n                eventNames = qtiElementEventName.replace(/\\s+/g, ' ').split(' '),\r\n                $document = $(document);\r\n\r\n            _.each(eventNames, function(eventName){\r\n\r\n                var eventNameToken = [eventName, 'qti-widget', self.serial];\r\n\r\n                if(!live){\r\n                    eventNameToken.push(self.getCurrentState().name);\r\n                }\r\n\r\n                //bind each individual event listener to the document\r\n                $document.on(eventNameToken.join('.'), function(e, data){\r\n                    callback.call(self, data);\r\n                });\r\n\r\n            });\r\n\r\n            return this;//for chaining\r\n        },\r\n        /**\r\n         * Get / Set the validation state\r\n         * @param {String} [what] - key to identify the validation\r\n         * @param {Boolean} [valid] - false to invalidate\r\n         * @param {String} [why] - message\r\n         */\r\n        isValid : function(what, valid, why){\r\n\r\n            var element = this.element;\r\n\r\n            if(typeof what === 'undefined'){\r\n                //get\r\n                return invalidator.isValid(element);\r\n            }else if(valid){\r\n                invalidator.valid(element, what);\r\n            }else{\r\n                invalidator.invalid(element, what, why, this.getCurrentState().name);\r\n            }\r\n        }\r\n    };\r\n\r\n    return Widget;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/widgetToolbar',[\r\n    'jquery',\r\n    'i18n'\r\n], function($, __){\r\n    'use strict';\r\n\r\n\r\n    var defaultConfig = [\r\n        [\r\n            {\r\n                title : 'Question',\r\n                'class' : 'question-trigger',\r\n                status : 'off', // on | disabled | off => default\r\n                fn : function(e){\r\n                    var target = arguments[1],\r\n                        toolbar = arguments[2],\r\n                        responseButton = toolbar.find('.answer-trigger a'),\r\n                        answerEditors = target.find('[data-edit=\"answer\"]'),\r\n                        questionEditors = target.find('[data-edit=\"question\"]');\r\n\r\n                    responseButton.removeClass('tlb-text-button-on').addClass('tlb-text-button-off');\r\n                    questionEditors.show();\r\n                    answerEditors.hide();\r\n                    target.data('mode', 'question');\r\n                }\r\n            },\r\n            {\r\n                title : 'Answer',\r\n                'class' : 'answer-trigger',\r\n                fn : function(e){\r\n                    var target = arguments[1],\r\n                        toolbar = arguments[2],\r\n                        contentButton = toolbar.find('.question-trigger a'),\r\n                        answerEditors = target.find('[data-edit=\"answer\"]'),\r\n                        questionEditors = target.find('[data-edit=\"question\"]');\r\n\r\n                    contentButton.removeClass('tlb-text-button-on').addClass('tlb-text-button-off');\r\n                    answerEditors.show();\r\n                    questionEditors.hide();\r\n                    target.data('mode', 'answer');\r\n                    target.find('[contenteditable]').attr('contenteditable', false);\r\n                    $(document).trigger('widgetBlur');\r\n                    //$('.cke.cke_reset_all').remove();\r\n                    //also remove ck and unbind\r\n                }\r\n            }\r\n        ],\r\n        'spacer', // |  ' '\r\n//    [\r\n//      {\r\n//        icon: 'edit',\r\n//        title: 'Edit',\r\n//        fn: function () {\r\n//          var widget = $(this).parents('.widget'),\r\n//            id = widget.attr('id') || randId();\r\n//\r\n//          widget.attr('contentEditable', true);\r\n//          widget.attr('id', id);\r\n//\r\n//          ckeditor.inline(id);\r\n//          //ckFocusManager.focus();\r\n//          console.log(widget);\r\n//        }\r\n//      }\r\n//    ],\r\n//    [\r\n//      {\r\n//        icon: 'move',\r\n//        title: 'Move',\r\n//        fn: function () {\r\n//          console.log('Move');\r\n//        }\r\n//      },\r\n//      'separator', // | '-'\r\n//      {\r\n//        icon: 'resize-grid',\r\n//        title: 'Resize',\r\n//        fn: function () {\r\n//          console.log('Resize');\r\n//        }\r\n//      }\r\n//   ],\r\n        [\r\n            {\r\n                icon : 'bin',\r\n                title : 'Delete',\r\n                fn : function(e){\r\n                    // arguments[1] is the box the toolbar belongs to\r\n                    // arguments[2] is the toolbar itself\r\n                    var target = arguments[1],\r\n                        toolbar = arguments[2],\r\n                        msg = $('<span>', {text : __('You have deleted an element.') + ' '}),\r\n                    undo = $('<a>', {text : __('Undo'), href : '#'}),\r\n                    icon = $('<span>', { 'class' : 'icon-info'}),\r\n                    closer = $('<span>', {title : 'Remove Message', 'class' : 'icon-close close-trigger'}),\r\n                    feedback = $('<div>', { 'class' : 'feedback-info'}).hide();\r\n\r\n                    closer.on('click', function(){\r\n                        feedback.fadeOut(function(){\r\n                            feedback.remove();\r\n                            target.remove();\r\n                            toolbar.remove();\r\n                        });\r\n                    });\r\n\r\n                    undo.on('click', function(e){\r\n                        e.preventDefault();\r\n                        feedback.remove();\r\n                        target.removeClass('deleted').fadeIn();\r\n                    });\r\n\r\n                    feedback.append(icon);\r\n                    feedback.append(msg);\r\n                    feedback.append(undo);\r\n                    feedback.append(closer);\r\n                    target.before(feedback);\r\n\r\n                    toolbar.hide();\r\n                    target.hide().addClass('deleted');\r\n                    feedback.fadeIn(function(){\r\n                        setTimeout(function(){\r\n                            closer.trigger('click');\r\n                        }, 6500)\r\n                    });\r\n                }\r\n            }\r\n        ]\r\n    ];\r\n\r\n\r\n\r\n    /**\r\n     * build breaks, separators etc.\r\n     * @param type\r\n     * @returns {*|HTMLElement}\r\n     */\r\n    var structure = function(type){\r\n        // makes config more similar to ckeditor\r\n        switch(type){\r\n            case '/':\r\n                type = 'break';\r\n                break;\r\n            case '-':\r\n                type = 'separator'\r\n                break;\r\n            case ' ':\r\n                type = 'spacer'\r\n                break;\r\n        }\r\n        return $('<span>', { 'class' : 'tlb-' + type});\r\n    };\r\n\r\n\r\n    var bar = function(items, target, toolbar){\r\n        var bar = $('<div>', {'class' : 'tlb-bar'}),\r\n        group,\r\n            // does first element have an icon? if not the items are buttons\r\n            isTextButton = !items[0].icon,\r\n            l = items.length,\r\n            i;\r\n\r\n\r\n        bar.append(structure('start'));\r\n\r\n        if(isTextButton){\r\n            for(i = 0; i < l; i++){\r\n                if($.type(items[i]) === 'string'){\r\n                    bar.append(structure(items[i]));\r\n                }\r\n                else{\r\n                    items[i].target = target;\r\n                    items[i].toolbar = toolbar;\r\n                    bar.append(button(items[i], isTextButton));\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            group = $('<div>', {'class' : 'tlb-group'});\r\n            bar.append(group);\r\n            for(i = 0; i < l; i++){\r\n                if($.type(items[i]) === 'string'){\r\n                    group.append(structure(items[i]));\r\n                }\r\n                else{\r\n                    items[i].target = target;\r\n                    items[i].toolbar = toolbar;\r\n                    group.append(button(items[i], isTextButton));\r\n                }\r\n            }\r\n        }\r\n\r\n        bar.append(structure('end'));\r\n        return bar;\r\n    };\r\n\r\n    /**\r\n     * build a single button\r\n     *\r\n     * @param config\r\n     * @param isTextButton bool\r\n     * @returns {*|HTMLElement}\r\n     */\r\n    var button = function(config, isTextButton){\r\n        var a,\r\n            span,\r\n            button,\r\n            icon,\r\n            text,\r\n            // re-assigning and deleting serves to\r\n            // allow any attribute in the config\r\n            status = config.status || 'off',\r\n            fn = config.fn || function(){\r\n        },\r\n            target = config.target || $(),\r\n            toolbar = config.toolbar || $();\r\n\r\n        delete(config.status);\r\n        delete(config.fn);\r\n        delete(config.target);\r\n        delete(config.toolbar);\r\n\r\n        if(!isTextButton){\r\n\r\n            // handle common misconfiguration with 'icon-' prefix\r\n            icon = 'icon-' + (config.icon.replace('icon-', ''));\r\n            delete(config.icon);\r\n\r\n            config['class'] = config['class'] ? config['class'] + ' tlb-button-' + status : 'tlb-button-' + status;\r\n\r\n            button = $('<a>', config);\r\n            span = $('<span>', {'class' : icon});\r\n            button.append(span);\r\n        }\r\n        else{\r\n            text = __(config.title);\r\n            delete(config.title);\r\n\r\n            config['class'] = config['class'] ? config['class'] + ' tlb-text-button-box' : 'tlb-text-button-box';\r\n\r\n            button = $('<span>', config);\r\n            a = $('<a>', {'class' : 'tlb-text-button-' + status});\r\n            span = $('<span>', {'class' : 'tlb-text', text : text});\r\n            button.append(a);\r\n            a.append(span);\r\n        }\r\n\r\n        button.on('click.toolbar', function(e){\r\n            // disabled buttons do nothing\r\n            if(button.hasClass('tlb-text-button-disabled') || button.hasClass('tlb-button-disabled')){\r\n                return false;\r\n            }\r\n            if(isTextButton){\r\n                button.find('a').toggleClass('tlb-text-button-off').toggleClass('tlb-text-button-on');\r\n            }\r\n            else{\r\n                button.toggleClass('tlb-button-off').toggleClass('tlb-button-on');\r\n            }\r\n            fn.apply(this, [e, target, toolbar]);\r\n        });\r\n\r\n        return button;\r\n    };\r\n\r\n\r\n    /**\r\n     * merge configurations\r\n     *\r\n     * @param config\r\n     * @param extendDefaultConfig\r\n     * @returns {*}\r\n     */\r\n    var handleConfig = function(config, extendDefaultConfig){\r\n        // config = []\r\n        if($.isArray(config) && !config.length){\r\n            config = false;\r\n        }\r\n\r\n        // config is now either a proper array or false or undefined\r\n        // 1. false or undefined - use the default\r\n        if(!config){\r\n            config = defaultConfig;\r\n        }\r\n        // 2. proper array - should the default be extended or not?\r\n        else if(extendDefaultConfig){\r\n            config = $.extend(defaultConfig, config);\r\n        }\r\n\r\n        return config;\r\n    };\r\n\r\n    /**\r\n     * Configuration and resulting toolbar structure\r\n     *\r\n     * tlb            // implicit\r\n     *   top          // implicit\r\n     *\r\n     *     ****** config starts here *****\r\n     *\r\n     *     box        // = parent element []\r\n     *       bar      // = [] | string 'break' or '/' | string 'spacer' or ' '\r\n     *         { icon, title, fn [, status, anyAttribute] } | { title, fn [, status, anyAttribute] } | string 'separator' or '-'\r\n     *       /bar     // implicit\r\n     *       bar | break\r\n     *     /box       // implicit\r\n     *\r\n     *     ****** config ends here *****\r\n     *\r\n     *   /top         // implicit\r\n     * /tlb           // implicit\r\n     *\r\n     * bar configuration:\r\n     * []                    creates for each element one of the following\r\n     *   { icon, title, fn [, status] } creates a square button with a text icon\r\n     *   { title, fn [, status] }       creates a button with text\r\n     *     icon:   can be with or without prefix e.g. 'icon-move' === 'move'\r\n     *     title:  title attribute or text when icon is not set\r\n     *     fn:     on click handler\r\n     *     status: optional 'off'|'on'|'disabled', default is 'off',\r\n     *     anyAttribute: any HTML attribute, 'class' will be appended to the default button class\r\n     *   Note: { icon, title, fn [, status] } and { icon, title [, status] } cannot be mixed within one group!\r\n     *   'separator' or '-'    creates a vertical line\r\n     *\r\n     * 'break' or '/'          creates a new line\r\n     * 'spacer' or ' '         creates a horizontal distance in the size of a square button\r\n     *\r\n     * @param config\r\n     * @param target\r\n     */\r\n    var buildToolbar = function(config, target, tlbWrapper){\r\n\r\n        // 1st level container\r\n        var tlb = $('<div>', {'class' : 'tlb'}),\r\n        // 2nd level container\r\n        top = $('<div>', {'class' : 'tlb-top'}),\r\n        // 3rd level container\r\n        box = $('<div>', {'class' : 'tlb-box'}),\r\n        i,\r\n            ic = config.length;\r\n\r\n        top.append(box);\r\n        tlb.append(top);\r\n\r\n        // box level\r\n        for(i = 0; i < ic; i++){\r\n            if($.type(config[i]) === 'string'){\r\n                box.append(structure(config[i]));\r\n            }\r\n            else{\r\n                box.append(bar(config[i], target, tlbWrapper));\r\n            }\r\n        }\r\n        tlb.data('edit', 'toolbar');\r\n        return tlb;\r\n    };\r\n\r\n\r\n\r\n    return (function(){\r\n\r\n        /**\r\n         * Add a tool bar to another element\r\n         *\r\n         * @param buttonConfig\r\n         * @param barConfig\r\n         * @returns {boolean}\r\n         */\r\n        var attach = function(buttonConfig, barConfig){\r\n\r\n            var defaultBarConfig = {\r\n                    offsetTop : -2,\r\n                    title : '',\r\n                    extendDefaultConfig : false,\r\n                    target : $()\r\n                },\r\n                toolbar,\r\n                target = $(barConfig.target),\r\n                title,\r\n                top,\r\n                tlbWrapper = target.prop('tlb') || $('<div>', {'class' : 'tlb-wrapper'});\r\n\r\n            if(!target.prop('tlb')){\r\n\r\n                buttonConfig = handleConfig(buttonConfig, barConfig.extendDefaultConfig);\r\n                barConfig = $.extend(defaultBarConfig, (barConfig || {}));\r\n\r\n\r\n                toolbar = buildToolbar(buttonConfig, target, tlbWrapper);\r\n\r\n                if(barConfig.title){\r\n                    title = $('<span>', {text : barConfig.title, 'class' : 'tlb-title', title : barConfig.title});\r\n                    tlbWrapper.append(title);\r\n                }\r\n\r\n                tlbWrapper.append(toolbar);\r\n\r\n                target.prop('tlb', tlbWrapper);\r\n\r\n                target.append(tlbWrapper);\r\n\r\n                // note: css parameters cannot be passed as an object\r\n                // since the DOM element must have its position\r\n                // before the size can be calculated\r\n                tlbWrapper.css('position', 'absolute');\r\n                tlbWrapper.css('display', 'none');\r\n                tlbWrapper.css('width', '100%');\r\n\r\n                top = defaultBarConfig.offsetTop - tlbWrapper.height();\r\n                tlbWrapper.css('top', top);\r\n            }\r\n\r\n            tlbWrapper.fadeIn();\r\n//\r\n//      $(document).on('click', function(e){\r\n//        if(!target.is(e.target)\r\n//          && !tlbWrapper.is(e.target)\r\n//          && target.has(e.target).length === 0\r\n//          && tlbWrapper.has(e.target).length === 0\r\n//          && !$(e.target).hasClass('.cke')) {\r\n//          target.find('[data-edit]').hide();\r\n//          tlbWrapper.hide();\r\n//          $(document).trigger('widgetBlur');\r\n//        }\r\n//      });\r\n\r\n            return tlbWrapper;\r\n        };\r\n\r\n        return {\r\n            attach : attach\r\n        };\r\n\r\n    }());\r\n\r\n});\r\n\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/Widget',\r\n    'taoQtiItem/qtiCreator/editor/widgetToolbar'\r\n], function($, Widget, toolbar){\r\n    \"use strict\";\r\n\r\n    var StaticWidget = Widget.clone();\r\n\r\n    StaticWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.createToolbar();\r\n    };\r\n\r\n    StaticWidget.buildContainer = function(){\r\n        var $wrap = $('<div>', {'data-serial' : this.element.serial, 'class' : 'widget-box'});\r\n        this.$original.wrap($wrap);\r\n        this.$container = this.$original.parent();\r\n    };\r\n\r\n    StaticWidget.createToolbar = function(){\r\n\r\n        return this;\r\n    };\r\n\r\n    StaticWidget.getAssetManager = function () {\r\n        if (!this.options || !this.options.assetManager) {\r\n            throw new Error('Asset Manager has not been set.');\r\n        }\r\n        return this.options.assetManager;\r\n    };\r\n\r\n    StaticWidget.createOkButton = function(){\r\n\r\n        var _this = this;\r\n\r\n        //@todo: use handlebars tpl instead?\r\n        this.$container.append($('<button>', {\r\n            'class' : 'btn-info small',\r\n            'type' : 'button',\r\n            'text' : 'OK',\r\n            'data-edit' : 'active'\r\n        }).css({\r\n            margin : '5px 10px',\r\n            display : 'none'\r\n        }).on('click.qti-widget', function(e){\r\n            e.stopPropagation();\r\n            _this.changeState('sleep');\r\n        }));\r\n    };\r\n\r\n    return StaticWidget;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/states/factory',['jquery', 'lodash'], function($, _){\r\n\r\n    var _isValidStateDefinition = function(state){\r\n\r\n        if(!_.isFunction(state)){\r\n            return false;\r\n        }\r\n\r\n        if(!state.prototype.name || !state.prototype.superState){\r\n            return false;\r\n        }\r\n\r\n        if(!_.isFunction(state.prototype.init) || !_.isFunction(state.prototype.exit)){\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n\r\n    var _create = function(name, superStates, init, exit){\r\n\r\n        var State = function(widget){\r\n            this.widget = widget;\r\n        };\r\n\r\n        State.prototype.name = name;\r\n\r\n        State.prototype.superState = superStates || [];\r\n\r\n        if(init && exit){\r\n            State.prototype.init = function(){\r\n\r\n                var $container = this.widget.$container;\r\n\r\n                if($container.data('edit') === name){\r\n                    $container.show();\r\n                }\r\n\r\n                var $editableWidgets = $container.find('[data-edit=\"' + name + '\"]').filter(function(){\r\n                    var $parentWidget = $(this).closest('.widget-box');\r\n                    if($parentWidget.length && $parentWidget[0] === $container[0]){\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                });\r\n                $editableWidgets.show();\r\n\r\n                this.widget.$container.addClass('edit-' + name);\r\n                $(document).trigger('beforeStateInit.qti-widget', [this.widget.element, this]);\r\n                init.call(this);\r\n                $(document).trigger('afterStateInit.qti-widget', [this.widget.element, this]);\r\n            };\r\n            State.init = init;//store reference for future usage\r\n\r\n            State.prototype.exit = function(){\r\n                if(this.widget.$container.data('edit') === name){\r\n                    this.widget.$container.hide();\r\n                }\r\n                this.widget.$container.find('[data-edit=\"' + name + '\"]').hide();\r\n                this.widget.$container.removeClass('edit-' + name);\r\n\r\n                $(document).trigger('beforeStateExit.qti-widget', [this.widget.element, this]);\r\n\r\n                //remove any qti element change event attached during this state lifetime\r\n                $(document).off(['.qti-widget', name, this.widget.serial].join('.'));\r\n\r\n                exit.call(this);\r\n                $(document).trigger('afterStateExit.qti-widget', [this.widget.element, this]);\r\n            };\r\n            State.exit = exit;//store reference for future usage\r\n        }\r\n\r\n        return State;\r\n    };\r\n\r\n    return {\r\n        /**\r\n         * Create qti widget state from scratch or by using an existing state as model\r\n         * When creating a state from scratch, the name, the init() and exit() callback are required.\r\n         * The optional superStates (array) is optional and is useful only when you need to define a hierarchy between the new state\r\n         * abd the ones in the superStates array.\r\n         * When the widget state is changed in this newly created state, the init()\r\n         *\r\n         * accepts the following arguments:\r\n         * (string) stateName, (array) superStates, (function) init, (function) exit\r\n         * (string) stateName, (function) init, (function) exit\r\n         * (function) State, (function) init, (function) exit\r\n         * @returns {State}\r\n         */\r\n        create : function(){\r\n\r\n            var State, name, superStates, init, exit;\r\n\r\n            if(_.isString(arguments[0])){\r\n                name = arguments[0];\r\n                if(_.isArray(arguments[1])){\r\n                    superStates = arguments[1];\r\n                    if(_.isFunction(arguments[2]) && _.isFunction(arguments[3])){\r\n                        init = arguments[2];\r\n                        exit = arguments[3];\r\n                        State = _create(name, superStates, init, exit);\r\n                    }else{\r\n                        throw new Error('the third and fourth arguments are expected to be functions: init() & exit()');\r\n                    }\r\n                }else{\r\n                    superStates = [];\r\n                    if(_.isFunction(arguments[1]) && _.isFunction(arguments[2])){\r\n                        init = arguments[1];\r\n                        exit = arguments[2];\r\n                        State = _create(name, superStates, init, exit);\r\n                    }else{\r\n                        throw new Error('the second and third arguments are expected to be functions: init() & exit()');\r\n                    }\r\n                }\r\n            }else if(_isValidStateDefinition(arguments[0])){\r\n                name = arguments[0].prototype.name;\r\n                superStates = arguments[0].prototype.superState;\r\n                if(_.isFunction(arguments[1]) && _.isFunction(arguments[2])){\r\n                    init = arguments[1];\r\n                    exit = arguments[2];\r\n                    State = _create(name, superStates, init, exit);\r\n                }else{\r\n                    throw new Error('the second and third arguments are expected to be functions: init() & exit()');\r\n                }\r\n            }else{\r\n                throw new Error('invalid first argument : expected the state name (string) or a State (function)');\r\n            }\r\n\r\n            return State;\r\n        },\r\n        extend : function(State, init, exit){\r\n\r\n            var Clone = null, initFn, exitFn;\r\n\r\n            if(_isValidStateDefinition(State)){\r\n\r\n                if(_.isFunction(init)){\r\n                    initFn = function(){\r\n                        State.init.call(this);\r\n                        init.call(this);\r\n                    };\r\n                }\r\n                if(_.isFunction(exit)){\r\n                    exitFn = function(){\r\n                        exit.call(this);\r\n                        State.exit.call(this);\r\n                    };\r\n                }\r\n\r\n                Clone = _create(State.prototype.name, State.prototype.superState, initFn, exitFn);\r\n                _.forIn(State.prototype, function(prop, name){\r\n                    if(_.isFunction(prop)){\r\n                        if((initFn && name === 'init') || (exitFn && name === 'exit')){\r\n                            return true;\r\n                        }\r\n                        Clone.prototype[name] = prop;\r\n                        Clone[name] = prop;\r\n                    }\r\n                });\r\n            }else{\r\n                throw new Error('invalid state to be cloned');\r\n            }\r\n\r\n            return Clone;\r\n        },\r\n        createBundle : function(arg0, arg1, arg2){\r\n\r\n            var stateBundle = {},\r\n                newStates = [],\r\n                excluded = [];\r\n\r\n            if(arguments.length >= 2){\r\n                stateBundle = _.clone(arguments[0]);\r\n                newStates = arguments[1];\r\n                excluded = arguments[2] || excluded;\r\n            }else{\r\n                newStates = arguments[0];\r\n            }\r\n\r\n            _.each(newStates, function(state){\r\n\r\n                if(_isValidStateDefinition(state)){\r\n                    stateBundle[state.prototype.name] = state;\r\n                }\r\n            });\r\n\r\n            _.each(excluded, function(state){\r\n                delete stateBundle[state];\r\n            });\r\n\r\n            return stateBundle;\r\n        },\r\n        throwMissingRequiredImplementationError : function(functionName){\r\n            throw new Error('Missing required implementation of the function ' + functionName + '()');\r\n        }\r\n    };\r\n});\r\n\r\n\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    'use strict';\r\n\r\n    return stateFactory.create('sleep', function(){\r\n\r\n        var widget = this.widget,\r\n            $container = this.widget.$container;\r\n\r\n        //add listener to display proper hover style\r\n        $container.on('mouseenter.sleep', function(e){\r\n            e.stopPropagation();\r\n            $container.addClass('hover');\r\n            $container.parent().trigger('mouseleave');//note : don't trigger it with namespace otherwise, choice.on(mouseleave.choice) will not be triggered\r\n        }).on('mouseleave.sleep', function(){\r\n            $container.removeClass('hover');\r\n            $container.parent().trigger('mouseenter');//note : same as mouseenter.sleep\r\n        });\r\n\r\n        if(!widget.isValid()){\r\n            widget.changeState('invalid');\r\n        }\r\n\r\n    }, function(){\r\n\r\n        this.widget.$container.removeClass('hover').off('.sleep');\r\n\r\n    });\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/states/Sleep'], function(stateFactory, SleepState){\r\n    \r\n    var StaticStateSleep = stateFactory.extend(SleepState, function(){\r\n        \r\n        var _widget = this.widget;\r\n        \r\n        _widget.$container.on('click.qti-widget.sleep', function(e){\r\n            e.stopPropagation();\r\n            _widget.changeState('active');\r\n        });\r\n        \r\n    }, function(){\r\n        \r\n        var _widget = this.widget;\r\n        \r\n        //remove hover outline box display\r\n        _widget.$container.off('.sleep');\r\n    });\r\n    \r\n    return StaticStateSleep;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/content',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/helper/creatorRenderer',\r\n    'taoQtiItem/qtiCreator/model/helper/container',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content'\r\n], function($, _, creatorRenderer, containerHelper, gridContentHelper){\r\n    'use strict';\r\n\r\n    var contentHelper = {};\r\n\r\n    /**\r\n     * Create elements from a widget box having the 'data-new=true' attribute\r\n     *  - render the elements at their placeholder in $container\r\n     *  - apply callback on each widget\r\n     * @param container - element that will contain the new ones\r\n     * @param $container - DOM container where the new elements are created\r\n     * @param data - corresponding HTML (?)\r\n     * @param callback - will be triggered for each new created element\r\n     */\r\n    contentHelper.createElements = function(container, $container, data, callback){\r\n\r\n        var $dummy = $('<div>').html(data);\r\n\r\n        containerHelper.createElements(container, gridContentHelper.getContent($dummy), function(newElts){\r\n\r\n            creatorRenderer.get().load(function(){\r\n                var serial,\r\n                    elt,\r\n                    $placeholder,\r\n                    $widget,\r\n                    widget;\r\n\r\n                for(serial in newElts){\r\n\r\n                    elt = newElts[serial];\r\n                    $placeholder = $container.find('.widget-box[data-new][data-qti-class=' + elt.qtiClass + ']');\r\n\r\n                    elt.setRenderer(this);\r\n                    elt.render($placeholder);\r\n\r\n                    //render widget\r\n                    elt.postRender();\r\n\r\n                    widget = elt.data('widget');\r\n                    $widget = widget.$original;\r\n\r\n                    //inform height modification\r\n                    $widget.trigger('contentChange.gridEdit');\r\n\r\n                    if(_.isFunction(callback)){\r\n                        callback(widget);\r\n                    }\r\n                }\r\n\r\n            }, this.getUsedClasses());\r\n        });\r\n\r\n    };\r\n\r\n    contentHelper.changeInnerWidgetState = function _changeInnerWidgetState(outerWidget, state){\r\n\r\n         var selector = [];\r\n        _.each(['img', 'math', 'object', 'include'], function(qtiClass){\r\n            selector.push('[data-html-editable] .widget-'+qtiClass);\r\n        });\r\n\r\n        outerWidget.$container.find(selector.join(',')).each(function(){\r\n            var innerWidget = $(this).data('widget');\r\n            if(innerWidget){\r\n                innerWidget.changeState(state);\r\n            }\r\n        });\r\n    };\r\n\r\n    return contentHelper;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/states/Active',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/content'\r\n], function($, stateFactory, contentHelper){\r\n\r\n    return stateFactory.create('active', function(){\r\n\r\n        var _widget = this.widget,\r\n            container = _widget.$container[0],\r\n            item = this.widget.element.getRelatedItem();\r\n\r\n        //move to sleep state by clicking anywhere outside the interaction\r\n        $('#item-editor-panel').on('mousedown.active.' + _widget.serial, function(e){\r\n            if (\r\n                container !== e.target\r\n                && !$.contains(container, e.target)\r\n                && !$.contains($('#modalFeedbacks')[0], e.target) //if click triggered inside the #modalFeedback then state must not be changed.\r\n                && ($(e.target).data('role') !== 'restore')\r\n            ){\r\n                _widget.changeState('sleep');\r\n            }\r\n        }).on('beforesave.qti-creator.active', function(){\r\n            _widget.changeState('sleep');\r\n        }).on('styleedit.active', function(){\r\n            _widget.changeState('sleep');\r\n        });\r\n\r\n        if(item && item.data('widget')){\r\n            //in item editing context:\r\n            item.data('widget').$container.on('resizestart.gridEdit.active beforedragoverstart.gridEdit.active', function(){\r\n                _widget.changeState('sleep');\r\n            });\r\n        }\r\n\r\n    }, function(){\r\n\r\n        contentHelper.changeInnerWidgetState(this.widget, 'sleep');\r\n\r\n        this.widget.$container.off('.active');\r\n        $('#item-editor-panel').off('.active.'+ this.widget.serial);\r\n\r\n        var item = this.widget.element.getRelatedItem();\r\n        if(item && item.data('widget')){\r\n            item.data('widget').$container.off('.active');\r\n        }\r\n\r\n    });\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/states/Active',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Active'\r\n], function($, stateFactory, Active){\r\n\r\n    return stateFactory.extend(Active, function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = _widget.$container;\r\n\r\n        _widget.beforeStateInit(function(e, element, state){\r\n\r\n            var serial = element.getSerial();\r\n            if((state.name === 'active' && serial !== _widget.serial) || state.name === 'choice'){\r\n\r\n                if(_widget.element.qtiClass === 'rubricBlock'){\r\n                    //exclude\r\n                    var composingElts = _widget.element.getComposingElements();\r\n                    if(!composingElts[element.serial]){\r\n                        _widget.changeState('sleep');\r\n                    }\r\n                }else{\r\n                    //call sleep whenever other widget is active\r\n                    _widget.changeState('sleep');\r\n                }\r\n\r\n            }\r\n\r\n        }, 'otherActive');\r\n\r\n        $container.on('mouseenter.active', function(e){\r\n            e.stopPropagation();\r\n            $container.parent().trigger('mouseleave.sleep');\r\n        }).on('mouseleave.active', function(e){\r\n            e.stopPropagation();\r\n            $container.parent().trigger('mouseenter.sleep');\r\n        }).on('click.active', function(e){\r\n            e.stopPropagation();\r\n        });\r\n\r\n    }, function(){\r\n\r\n        this.widget.$container.off('.active');\r\n        $('#item-editor-panel').off('.active.' + this.widget.serial);\r\n\r\n        this.widget.offEvents('otherActive');\r\n    });\r\n\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/states/Inactive',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n\r\n    return stateFactory.create('inactive', function(){\r\n\r\n    }, function(){\r\n        \r\n    });\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/notifications/deletingInfoBox', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"You have deleted an element\", options) : helperMissing.call(depth0, \"__\", \"You have deleted an element\", options)))\n    + \".\\r\\n    \";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"You have deleted\", options) : helperMissing.call(depth0, \"__\", \"You have deleted\", options)))\n    + \" \";\n  if (helper = helpers.count) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.count); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"elements\", options) : helperMissing.call(depth0, \"__\", \"elements\", options)))\n    + \".\\r\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"feedback-info popup\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"icon-info\\\"></span>\\r\\n    \";\n  stack1 = (helper = helpers.equal || (depth0 && depth0.equal),options={hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data},helper ? helper.call(depth0, (depth0 && depth0.count), 1, options) : helperMissing.call(depth0, \"equal\", (depth0 && depth0.count), 1, options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <a class=\\\"undo\\\" href=\\\"#\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"undo\", options) : helperMissing.call(depth0, \"__\", \"undo\", options)))\n    + \"</a>\\r\\n    <span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove Message\", options) : helperMissing.call(depth0, \"__\", \"Remove Message\", options)))\n    + \"\\\" class=\\\"icon-close close-trigger\\\"></span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technlogies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/deletingState',['lodash', 'jquery', 'tpl!taoQtiItem/qtiCreator/tpl/notifications/deletingInfoBox'], function(_, $, deletingInfoTpl){\r\n    'use strict';\r\n\r\n    var _timeout = 10000;\r\n\r\n    var _destroy = function _destroy($messageBox){\r\n        $('body').off('.deleting');\r\n        $messageBox.remove();\r\n    };\r\n\r\n    var undo = function undo($messageBox){\r\n        $messageBox.trigger('undo.deleting');\r\n        _destroy($messageBox);\r\n    };\r\n\r\n    var _bindEvents = function _bindEvents($messageBox){\r\n\r\n        $('body').on('mousedown.deleting keydown.deleting', function(e){\r\n\r\n            if(e.ctrlKey || e.metaKey){\r\n                //trigger undo callback if the standard keyboard shortcut ctrl+z is triggered\r\n                if(e.keyCode == 90){//z-key\r\n                    undo($messageBox);\r\n                }\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n\r\n            //confirm deleting whenever user interact with another object\r\n            if(e.target !== $messageBox[0] && !$.contains($messageBox[0], e.target)){\r\n                _confirmDeletion($messageBox, 400);\r\n            }\r\n        });\r\n        \r\n        $messageBox.find('a.undo').on('click', function(e){\r\n            e.preventDefault();\r\n            undo($messageBox);\r\n        });\r\n\r\n        $messageBox.find('.close-trigger').on('click', function(e){\r\n            e.preventDefault();\r\n            _confirmDeletion($messageBox, 0);\r\n        });\r\n\r\n        setTimeout(function(){\r\n            _confirmDeletion($messageBox, 1000);\r\n        }, _timeout);\r\n    };\r\n\r\n    var _confirmDeletion = function($messageBox, fadeDelay){\r\n        //only allow deletion if the message has not already been deleted yet\r\n        if($messageBox.length && $.contains(document, $messageBox[0])){\r\n            $messageBox.trigger('confirm.deleting');\r\n            $messageBox.fadeOut(fadeDelay, function(){\r\n                _destroy($messageBox);\r\n            });\r\n        }\r\n    };\r\n    \r\n    var deletingHelper = {\r\n        createInfoBox : function(widgets){\r\n\r\n            var $messageBox = $(deletingInfoTpl({\r\n                serial : 'widgets',\r\n                count : widgets.length\r\n            }));\r\n\r\n            $('body').append($messageBox);\r\n\r\n            $messageBox.css({\r\n                'display' : 'block',\r\n                'position' : 'fixed',\r\n                'top' : '50px',\r\n                'left' : '50%',\r\n                'margin-left' : '-200px',\r\n                'width' : '400px',\r\n                zIndex : 999999\r\n            });\r\n            \r\n            _bindEvents($messageBox);\r\n            \r\n            _.each(widgets, function(w){\r\n                w.on('beforeStateInit', function(){\r\n                    _confirmDeletion($messageBox, 400);\r\n                });\r\n            });\r\n        \r\n            return $messageBox;\r\n        }\r\n    };\r\n\r\n    return deletingHelper;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/gridUnits',['lodash'], function(_){\r\n    \"use strict\";\r\n    /**\r\n     * Argument cols format:\r\n     * [{elt:elementRef, units:6, min:4}]\r\n     *\r\n     * Return format:\r\n     * {last:6, middle:4, distributed:[{elt:elementRef, units:5}]}\r\n     *\r\n     * @param {array} cols\r\n     * @param {int} min\r\n     * @param {int} max\r\n     * @returns {object}\r\n     */\r\n    function distributeUnits(cols, min, max){\r\n\r\n        max = max || 12;\r\n        var totalUnits = 0, size = 0, _cols = {}, ret = {}, minimized = [], decimals = [];\r\n\r\n        for(var i in cols){\r\n            _cols[i] = _.clone(cols[i]);\r\n            totalUnits += cols[i].units;\r\n            size++;\r\n        }\r\n\r\n        var avg = totalUnits / size;\r\n        _cols[size + 1] = {\r\n            'elt' : 'middle',\r\n            'units' : avg,\r\n            'min' : min\r\n        };\r\n\r\n        if(totalUnits + Math.round(avg) > max){\r\n\r\n            var refactoredTotalUnits = 0;\r\n            //need to squeeze the new col between existing ones:\r\n            //refactored\r\n            for(var i in _cols){\r\n\r\n                var col = _cols[i];\r\n                var refactoredUnits = col.units * max / (max + avg);//calculate the average, basis for the new inserted element's units\r\n                decimals[i] = Math.round((refactoredUnits % 1) * 100);//get its decimals for later usage\r\n\r\n                col.refactoredUnits = Math.round(refactoredUnits);\r\n                if(col.min && col.refactoredUnits < col.min){//a col cannot be smaller than its min units\r\n                    col.refactoredUnits = col.min;\r\n                    minimized[i] = true;//marked it as not changeable\r\n                }\r\n                refactoredTotalUnits += col.refactoredUnits;\r\n\r\n            }\r\n\r\n            if(refactoredTotalUnits > max){\r\n                //try ceil new units values:\r\n                for(var i; i < size + 1; i++){\r\n                    var col = _cols[i];\r\n                    if(col.decimal > 50 && col.refactoredUnits - 1 > col.min){\r\n                        col.refactoredUnits--;\r\n                        refactoredTotalUnits--;\r\n                    }\r\n                    if(refactoredTotalUnits === max){\r\n                        break;//target achieved\r\n                    }\r\n                }\r\n            }\r\n\r\n            var middleUnitValue = _cols[size + 1].refactoredUnits;\r\n            var lastUnitValue = (refactoredTotalUnits > max) ? max : middleUnitValue;\r\n            delete _cols[size + 1];\r\n\r\n            ret = {\r\n                last : lastUnitValue, //new col takes the remaining space\r\n                middle : middleUnitValue,\r\n                cols : _cols,\r\n                refactoredTotalUnits : refactoredTotalUnits\r\n            };\r\n        }else{\r\n\r\n            //there is \"room\" for the new element to fill the whole row:\r\n            var last = max - totalUnits;\r\n            ret = {\r\n                last : last,\r\n                middle : last,\r\n                cols : {}//no need to resize cols\r\n            };\r\n        }\r\n\r\n        return ret;\r\n    }\r\n\r\n    /**\r\n     * Rebistributs the cols proportionally to fill out the \"max\" width\r\n     *\r\n     * @param {array} cols\r\n     * @param {integer} max\r\n     * @returns {object}\r\n     */\r\n    function redistributeUnits(cols, max){\r\n\r\n        max = max || 12;//default to max\r\n\r\n        var totalUnits = 0,\r\n            _cols = [],\r\n            totalRefactoredUnits = 0,\r\n            negative = [],\r\n            positive = [],\r\n            ret = [];\r\n\r\n        _.each(cols, function(col){\r\n            _cols.push(col);\r\n            totalUnits += col.units;\r\n        });\r\n\r\n        if(totalUnits > max){\r\n            throw 'the total number of units exceed the maximum of ' + max;\r\n        }\r\n\r\n        _.each(_cols, function(col){\r\n\r\n            var refactoredUnits = col.units * max / totalUnits;\r\n            var rounded = Math.round(refactoredUnits);\r\n            totalRefactoredUnits += rounded;\r\n\r\n            col.refactoredUnits = rounded;\r\n\r\n            if(rounded > refactoredUnits){\r\n                positive.push(col);\r\n            }else{\r\n                negative.push(col);\r\n            }\r\n\r\n        });\r\n\r\n        positive = _.sortBy(positive, 'refactoredUnits');\r\n        negative = _.sortBy(negative, 'refactoredUnits');\r\n\r\n        if(totalRefactoredUnits > max){\r\n            //too much !\r\n\r\n            //@todo : start with the hightest refactored\r\n            _.eachRight(positive, function(col){\r\n                col.refactoredUnits --;\r\n                totalRefactoredUnits--;\r\n                if(totalRefactoredUnits === max){\r\n                    return false;\r\n                }\r\n            });\r\n\r\n        }else if(totalRefactoredUnits < max){\r\n\r\n            //@todo : start with the lowest refactored\r\n            _.each(negative, function(col){\r\n                col.refactoredUnits ++;\r\n                totalRefactoredUnits++;\r\n                if(totalRefactoredUnits === max){\r\n                    return false;\r\n                }\r\n            });\r\n\r\n        }\r\n\r\n        _.each(negative, function(col){\r\n            ret.push(col);\r\n        });\r\n        _.each(positive, function(col){\r\n            ret.push(col);\r\n        });\r\n\r\n        return _cols;\r\n    }\r\n\r\n\r\n    return {\r\n        distribute : function(cols, min, max){\r\n            return distributeUnits(cols, min, max);\r\n        },\r\n        redistribute : function(cols, max){\r\n            return redistributeUnits(cols, max);\r\n        }\r\n\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/states/Deleting',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/deletingState',\r\n    'taoQtiItem/qtiCreator/helper/gridUnits',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/helper',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content'\r\n], function(_, $, stateFactory, deletingHelper, gridUnits, gridHelper, contentHelper){\r\n\r\n    var DeletingState = stateFactory.create('deleting', function(){\r\n\r\n        var element = this.widget.element;\r\n\r\n        //array to store new col untis\r\n        this.refactoredUnits = [];\r\n        this.updateBody = false;\r\n\r\n        //reference to the dom element(s) to be remove on delete\r\n        this.$elementToRemove = this.getElementToRemove();\r\n        \r\n        this.hideWidget();\r\n\r\n        this.showMessage(element);\r\n\r\n        element.data('deleting', true);\r\n\r\n        //trigger resizing\r\n        if(this.updateBody){\r\n            \r\n            //store reference to the item and its container:\r\n            this.item = element.getRelatedItem();\r\n            this.$item = this.item.data('widget').$container.find('.qti-itemBody');\r\n\r\n            //call for resize action\r\n            this.$item.trigger('resize.qti-widget');\r\n        }\r\n\r\n    }, function(){\r\n\r\n        this.showWidget();\r\n        this.widget.element.data('deleting', false);\r\n        $('body').off('.deleting');\r\n\r\n        if(this.updateBody){\r\n            this.$item.trigger('resize.qti-widget');\r\n        }\r\n    });\r\n\r\n    /**\r\n     * @todo move widget specific code to their respective location\r\n     * \r\n     * @returns {jQuery} container\r\n     */\r\n    DeletingState.prototype.getElementToRemove = function(){\r\n\r\n        var $container = this.widget.$container;\r\n        \r\n        //if is a choice widget:\r\n        if($container.hasClass('qti-choice')){\r\n\r\n            if($container.prop('tagName') === 'TH'){\r\n\r\n                //matchInteraction:\r\n                if($container.parent().parent().prop('tagName') === 'THEAD'){\r\n\r\n                    //hide col\r\n                    var $tbody = $container.closest('table.matrix').children('tbody');\r\n                    var $tds = $tbody.children('tr').find('td:last');\r\n                    return $container.add($tds);\r\n\r\n                }else if($container.parent().parent().prop('tagName') === 'TBODY'){\r\n\r\n                    //hide row\r\n                    return $container.parent();\r\n                }\r\n            }else{\r\n                return $container;\r\n            }\r\n\r\n        }\r\n\r\n        /**\r\n         * inline widget\r\n         */\r\n        if($container.hasClass('widget-inline')){\r\n            return $container.add(this.widget.$original);\r\n        }\r\n        \r\n        /**\r\n         * block widget\r\n         */\r\n        var $col = $container.parent();\r\n        \r\n        //check sub-column condition\r\n        var $subCol = $container.parent('.colrow');\r\n        if($subCol.length){\r\n            \r\n            this.updateBody = true;\r\n            \r\n            var $colMulti = $subCol.parent();\r\n            if($colMulti.find('.colrow').length === 1){\r\n                //this is the only sub-column remaining, hide the entire col\r\n                $col = $colMulti;\r\n            }else{\r\n                //hide the whole sub-column only :\r\n                return $subCol;\r\n            }\r\n        }\r\n        \r\n        //check if we should hide the col only or the whole row\r\n        var $row = $col.parent('.grid-row');\r\n        if($row.length){\r\n            this.updateBody = true;\r\n            if($row.children().length === 1){\r\n                //if it is the only col in the row, hide the entire row\r\n                return $row;\r\n            }else{\r\n                //else, hide the current one ...\r\n                return $col;\r\n            }\r\n        }else if($container.hasClass('grid-row')){\r\n            //rubric block:\r\n            this.updateBody = true;\r\n            return $container;\r\n        } \r\n                \r\n        //other block widgets:\r\n        if($container.hasClass('widget-block') || $container.hasClass('widget-blockInteraction')){\r\n            return $container;\r\n        }\r\n    };\r\n\r\n    DeletingState.prototype.hideWidget = function(){\r\n\r\n        var $elt = this.$elementToRemove;\r\n\r\n        if($elt.length){\r\n            $elt.hide();\r\n            if(_isCol($elt)){\r\n                //it is a column : redistribute the units of the columdn to the others\r\n                this.refactoredUnits = _redistributeUnits($elt);\r\n            }\r\n        }\r\n    };\r\n\r\n    var _isCol = function($col){\r\n        var attrClass = $col.attr('class');\r\n        return (attrClass && /col-([\\d]+)/.test(attrClass));\r\n    };\r\n\r\n    var _redistributeUnits = function($col){\r\n\r\n        var usedUnits = $col.data('units');\r\n        var $otherCols = $col.siblings();\r\n        var cols = [];\r\n\r\n        $otherCols.each(function(){\r\n\r\n            var $col = $(this),\r\n                units = $col.data('units');\r\n\r\n            cols.push({\r\n                elt : $col,\r\n                units : units\r\n            });\r\n\r\n            usedUnits += units;\r\n        });\r\n\r\n        cols = gridUnits.redistribute(cols);\r\n\r\n        _.each(cols, function(col){\r\n            col.elt.removeClass('col-' + col.units).addClass('col-' + col.refactoredUnits);\r\n            gridHelper.setUnitsFromClass(col.elt);\r\n        });\r\n\r\n        //store results in the element for future ref?\r\n        $col.data('redistributedUnits', cols);\r\n\r\n        return cols;\r\n    };\r\n\r\n    DeletingState.prototype.showWidget = function(){\r\n\r\n        var $elt = this.$elementToRemove;\r\n        if($elt.length && $.contains(document, $elt[0])){\r\n\r\n            $elt.show();\r\n\r\n            if(_isCol($elt)){\r\n                //restore the other units:\r\n                _.each(this.refactoredUnits, function(col){\r\n                    col.elt.removeClass('col-' + col.refactoredUnits).addClass('col-' + col.units);\r\n                    gridHelper.setUnitsFromClass(col.elt);\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    DeletingState.prototype.showMessage = function(){\r\n\r\n        var _this = this,\r\n            _widget = this.widget,\r\n            $messageBox = deletingHelper.createInfoBox([_widget]);\r\n\r\n        $messageBox.on('confirm.deleting', function(){\r\n\r\n            _this.deleteElement();\r\n\r\n        }).on('undo.deleting', function(){\r\n\r\n            try{\r\n                _widget.changeState('question');\r\n            }catch(e){\r\n                _widget.changeState('active');\r\n            }\r\n        });\r\n\r\n        this.messageBox = $messageBox;\r\n    };\r\n\r\n    DeletingState.prototype.deleteElement = function(){\r\n\r\n        this.refactoredUnits = [];\r\n\r\n        this.$elementToRemove.remove();//remove html from the dom\r\n        this.widget.destroy();//remove what remains of the widget (almost nothing), call this after element remove\r\n        this.widget.element.remove();//remove from model\r\n\r\n        if(this.updateBody){\r\n            //need to update item body\r\n            this.item.body(contentHelper.getContent(this.$item));\r\n        }\r\n\r\n    };\r\n\r\n    return DeletingState;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'taoQtiItem/qtiCreator/widgets/states/Inactive',\r\n    'taoQtiItem/qtiCreator/widgets/states/Deleting'\r\n], function(factory){\r\n    return factory.createBundle(arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/text/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/static/states/Sleep'], function(stateFactory, SleepState){\r\n    \r\n    var TextBlockStateSleep = stateFactory.extend(SleepState, function(){}, function(){});\r\n    \r\n    return TextBlockStateSleep;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/ckEditor/groupToggler',['lodash', 'core/eventifier'], function(_, eventifier){\r\n    'use strict';\r\n\r\n    /**\r\n     * Create an instance of group toggler to manage the toggling of a group of DOM elements\r\n     */\r\n    return function groupToggler(){\r\n\r\n        var _registry = [];\r\n\r\n        return eventifier({\r\n            /**\r\n             * Register a JQuery element among the list of elements to toggle\r\n             * @param {JQuery} $trigger\r\n             * @returns {groupToggler}\r\n             */\r\n            register : function register($trigger){\r\n\r\n                var self = this,\r\n                    id = _.uniqueId('group-toggler-');\r\n\r\n                if(!$trigger || !$trigger.length){\r\n                    this.trigger('error', 'trigger does not exist');\r\n                    return this;\r\n                }\r\n\r\n                if(!$trigger.data('group-toggler-id')){\r\n                    $trigger\r\n                        .data('group-toggler-id', id)\r\n                        .on('show.grouptoggler', function(){\r\n                            //an individual element has been shown\r\n                            self.trigger('show', id);\r\n                        });\r\n\r\n                    _registry.push({\r\n                        id : id,\r\n                        dom : $trigger\r\n                    })\r\n                }\r\n\r\n                return this;\r\n            }\r\n        }).on('show', function(id){\r\n\r\n            _.each(_registry, function(element){\r\n                if(element.id !== id){\r\n                    //a single element has been shown, informe the others\r\n                    element.dom.trigger('showanother.grouptoggler', id);\r\n                }\r\n            });\r\n        });\r\n    }\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n/**\r\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/ckConfigurator',['lodash', 'ui/ckeditor/ckConfigurator', 'mathJax'], function(_, ckConfigurator, mathJax) {\r\n    'use strict';\r\n\r\n    var _defaults = {\r\n        qtiImage : true,\r\n        qtiMedia : true,\r\n        qtiInclude : true,\r\n        underline : true,\r\n        mathJax : !!mathJax\r\n    };\r\n\r\n    /**\r\n     * Generate a configuration object for CKEDITOR\r\n     *\r\n     * @param editor instance of ckeditor\r\n     * @param toolbarType block | inline | flow | qtiBlock | qtiInline | qtiFlow | reset to get back to normal\r\n     * @param {Object} [options] - is based on the CKEDITOR config object with some additional sugar\r\n     *        Note that it's here you need to add parameters for the resource manager.\r\n     *        Some options are not covered in http://docs.ckeditor.com/#!/api/CKEDITOR.config\r\n     * @param [options.dtdOverrides] - @see dtdOverrides which pre-defines them\r\n     * @param {Object} [options.positionedPlugins] - @see ckConfig.positionedPlugins\r\n     * @param {Boolean} [options.qtiImage] - enables the qtiImage plugin\r\n     * @param {Boolean} [options.qtiInclude] - enables the qtiInclude plugin\r\n     * @param {Boolean} [options.underline] - enables the underline plugin\r\n     * @param {Boolean} [options.mathJax] - enables the mathJax plugin\r\n     *\r\n     * @see http://docs.ckeditor.com/#!/api/CKEDITOR.config\r\n     */\r\n    var getConfig = function(editor, toolbarType, options){\r\n        return ckConfigurator.getConfig(editor, toolbarType, _.defaults(options || {}, _defaults));\r\n    };\r\n\r\n    return {\r\n        getConfig : getConfig\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',[\r\n    'lodash',\r\n    'i18n',\r\n    'jquery',\r\n    'ckeditor',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/groupToggler',\r\n    'taoQtiItem/qtiCreator/helper/ckConfigurator',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/content',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/deletingState'\r\n], function(_, __, $, CKEditor, groupToggler, ckConfigurator, Element, contentHelper, deletingHelper){\r\n    \"use strict\";\r\n\r\n    var _defaults = {\r\n        placeholder : __('some text ...'),\r\n        shieldInnerContent : true,\r\n        passthroughInnerContent : false,\r\n        hideTriggerOnBlur : false\r\n    };\r\n\r\n    var gpeToggler = groupToggler();\r\n\r\n    //prevent auto inline editor creation:\r\n    CKEditor.disableAutoInline = true;\r\n\r\n    /**\r\n     * Find the ck launcher (the trigger that toggle visibility of the editor) in the editor's container\r\n     *\r\n     * @param {JQuery} $editableContainer\r\n     */\r\n    function getTrigger($editableContainer){\r\n        var $toolbar = $editableContainer.data('editor-toolbar');\r\n        if($toolbar && $toolbar.length){\r\n            return $toolbar.find('[data-role=\"cke-launcher\"]');\r\n        }else{\r\n            return $editableContainer.find('[data-role=\"cke-launcher\"]');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {JQuery} $editable - the element to be transformed into an editor\r\n     * @param {JQuery} $editableContainer - the container of the editor\r\n     * @param {Object} [options]\r\n     * @param {String} [options.placeholder] - the place holder text\r\n     * @param {Boolean} [options.shieldInnerContent] - define if the inner widget content should be protected or not\r\n     * @param {Boolean} [options.passthroughInnerContent] - define if the inner widget content should be accessible directly or not\r\n     * @param {Boolean} [options.hideTriggerOnBlur] - define if the ckeditor trigger should be hidden when the editor is blurred\r\n     */\r\n    function _buildEditor($editable, $editableContainer, options){\r\n\r\n        var $trigger;\r\n\r\n        options = _.defaults(options, _defaults);\r\n\r\n        if( !($editable instanceof $) || !$editable.length){\r\n            throw new Error('invalid jquery element for $editable');\r\n        }\r\n        if( !($editableContainer instanceof $) || !$editableContainer.length){\r\n            throw new Error('invalid jquery element for $editableContainer');\r\n        }\r\n\r\n        $trigger = getTrigger($editableContainer);\r\n        if (options.placeholder && options.placeholder !== '') {\r\n            $editable.attr('placeholder', options.placeholder);\r\n        }\r\n        var ckConfig = {\r\n            dtdMode : 'qti',\r\n            autoParagraph : false,\r\n            enterMode : options.enterMode || CKEditor.ENTER_P,\r\n            floatSpaceDockedOffsetY : 10,\r\n            taoQtiItem : {\r\n                /**\r\n                 * @param {DOM} tempWidget - this contains the DOM nodes created by a ckEditor plugin,\r\n                 *                           wrapped in a temporary widget container (= a widget container with a [data-new=\"true\"] attribute)\r\n                 */\r\n                insert : function(tempWidget){\r\n                    var $newContent = $(tempWidget).clone().contents(); // we keep the original content, without the widget wrapper, for later use\r\n\r\n                    if(options.data && options.data.container && options.data.widget){\r\n                        contentHelper.createElements(options.data.container, $editable, _htmlEncode(this.getData()), function(createdWidget){\r\n                            var createdElement = createdWidget.element,\r\n                                allAttributes = $newContent[0].attributes;\r\n\r\n                            $.each(allAttributes, function() {\r\n                                if (this.specified) {\r\n                                    createdElement.attr(this.name, this.value);\r\n                                }\r\n                            });\r\n\r\n                            if (_.isFunction(createdElement.initContainer)) {\r\n                                createdElement.body($newContent.html());\r\n                                createdElement.render(createdElement.getContainer());\r\n                                createdElement.postRender();\r\n                            }\r\n                            _activateInnerWidget(options.data.widget, createdWidget);\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            floatSpace : {\r\n                debug : true,\r\n                initialHide : true,\r\n                centerElement : function(){\r\n                    //cke initialize the config too early.. so need to provide a callback to initialize it...\r\n                    return getTrigger($editableContainer)[0];\r\n                },\r\n                on : {\r\n                    ready : function(floatSpaceApi){\r\n\r\n                        // works around tiny bug in tao floating space\r\n                        // nose must be in .cke_toolbox rather than .cke\r\n                        // otherwise z-indexing will fail\r\n                        var nose = $(this).find('.cke_nose'),\r\n                            oldParent = nose.parent(),\r\n                            newParent = $(this).find('.cke_toolbox');\r\n                        if(oldParent.is('.cke')){\r\n                            newParent.append(nose);\r\n                        }\r\n\r\n                        floatSpaceApi.hide();\r\n                        //@todo namespace this event: .editor.qti-widget or stuff...\r\n                        $trigger.on('click', function(){\r\n                            if($trigger.hasClass('active')){\r\n                                $trigger.removeClass('active');\r\n                                floatSpaceApi.hide();\r\n                            }else{\r\n                                $trigger.addClass('active').trigger('show.grouptoggler');\r\n                                floatSpaceApi.show();\r\n                            }\r\n                        });\r\n                        $trigger.on('showanother.grouptoggler', function(){\r\n                            floatSpaceApi.hide();\r\n                        });\r\n\r\n                        gpeToggler.register($trigger);\r\n                    },\r\n                    changeMode : function(oldYMode, newYMode){\r\n                        var element = this,\r\n                            $element = $(element),\r\n                            $nose = $element.find('.cke_nose');\r\n\r\n                        var xModeIsReady = function(domElem){\r\n                            var dfd = new $.Deferred(),\r\n                                counter = 0,\r\n                                check = setInterval(function(){\r\n                                    var style = domElem.getAttribute('style');\r\n                                    if(counter > 5 || style.indexOf('left') > -1 || style.indexOf('right') > -1){\r\n                                        dfd.resolve();\r\n                                        clearInterval(check);\r\n                                    }\r\n                                    counter++;\r\n                                }, 1000);\r\n                            return dfd.promise();\r\n                        };\r\n\r\n                        if(oldYMode !== newYMode){\r\n                            $nose.removeClass('float-space-' + oldYMode).addClass('float-space-' + newYMode);\r\n                        }\r\n\r\n                        $.when(xModeIsReady(element)).done(function(){\r\n                            if(!!element.style.left && !element.style.right){\r\n                                $nose.removeClass('float-space-right').addClass('float-space-left');\r\n                            }else{\r\n                                $nose.removeClass('float-space-left').addClass('float-space-right');\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            on : {\r\n                instanceReady : function(e){\r\n\r\n                    var widgets = {},\r\n                        editor = e.editor;\r\n\r\n                    //fix ck editor combo box display issue\r\n                    $('#cke_' + e.editor.name + ' .cke_combopanel').hide();\r\n\r\n                    //store it in editable elt data attr\r\n                    $editable.data('editor', editor);\r\n                    $editable.data('editor-options', options);\r\n\r\n                    //need to debounce the callback to prevent the changes made by undo to trigger the event change twice\r\n                    editor.on('change', _.debounce(function markupChanged(){\r\n                        _detectWidgetDeletion($editable, widgets, editor);\r\n                        if(_.isFunction(options.change)){\r\n                            options.change.call(editor, _htmlEncode(editor.getData()));\r\n                        }\r\n                    }, 100));\r\n\r\n                    if(options.data && options.data.container){\r\n\r\n                        //store in data-qti-container attribute the editor instance as soon as it is ready\r\n                        $editable.data('qti-container', options.data.container);\r\n\r\n                        //init editable\r\n                        widgets = _rebuildWidgets(options.data.container, $editable, {\r\n                            restoreState : true\r\n                        });\r\n                        if(options.shieldInnerContent){\r\n                            _shieldInnerContent($editable, options.data.widget);\r\n                        }\r\n                    }\r\n\r\n                    _focus(editor);\r\n\r\n                    $editable.trigger('editorready', [editor]);\r\n\r\n                    $('.qti-item').trigger('toolbarchange');\r\n\r\n                },\r\n                focus : function(){\r\n\r\n                    //show trigger\r\n                    $trigger.show();\r\n\r\n                    //callback:\r\n                    if(_.isFunction(options.focus)){\r\n                        options.focus.call(this, _htmlEncode(this.getData()));\r\n                    }\r\n\r\n                    $('.qti-item').trigger('toolbarchange');\r\n\r\n\r\n                },\r\n                blur : function(){\r\n                    return false;\r\n                },\r\n                configLoaded : function(e){\r\n                    //@todo : do we really have to wait here to initialize the config?\r\n                    var toolbarType = '';\r\n                    if(options.toolbar && _.isArray(options.toolbar)){\r\n                        ckConfig.toolbar = options.toolbar;\r\n                    }else{\r\n                        toolbarType = getTooltypeFromContainer($editableContainer);\r\n                    }\r\n\r\n                    if(typeof options.qtiMedia !== 'undefined'){\r\n                        ckConfig.qtiMedia = options.qtiMedia;\r\n                    }\r\n                    if(typeof options.qtiImage !== 'undefined'){\r\n                        ckConfig.qtiImage = options.qtiImage;\r\n                    }\r\n                    if(typeof options.qtiInclude !== 'undefined'){\r\n                        ckConfig.qtiInclude = options.qtiInclude;\r\n                    }\r\n                    if(typeof options.highlight !== 'undefined'){\r\n                        ckConfig.highlight = options.highlight;\r\n                    }\r\n\r\n                    e.editor.config = ckConfigurator.getConfig(e.editor, toolbarType, ckConfig);\r\n                },\r\n                afterPaste : function(){\r\n                    //@todo : we may add some processing on the editor after paste\r\n                }\r\n            }\r\n        };\r\n\r\n        return CKEditor.inline($editable[0], ckConfig);\r\n    }\r\n\r\n    /**\r\n     * Assess\r\n     * @param {type} $editableContainer\r\n     * @returns {String}\r\n     */\r\n    function getTooltypeFromContainer($editableContainer){\r\n\r\n        var toolbarType = 'qtiFlow';\r\n        // build parameter for toolbar\r\n        if($editableContainer.hasClass('widget-blockInteraction') || $editableContainer.hasClass('widget-textBlock') || $editableContainer.hasClass('widget-rubricBlock')){\r\n            toolbarType = 'qtiBlock';\r\n        }else if($editableContainer.hasClass('qti-prompt-container') || $editableContainer.hasClass('widget-hottext')){\r\n            toolbarType = 'qtiInline';\r\n        }\r\n        return toolbarType;\r\n    }\r\n\r\n    /**\r\n     * Find an inner element by its data attribute name\r\n     * @param {JQuery} $container\r\n     * @param {String} dataAttribute\r\n     */\r\n    function _find($container, dataAttribute){\r\n\r\n        var $collection;\r\n\r\n        if($container.data(dataAttribute)){\r\n            $collection = $container;\r\n        }else{\r\n            $collection = $container.find('[data-' + dataAttribute + '=true]');\r\n        }\r\n        return $collection;\r\n    }\r\n\r\n    /**\r\n     * Rebuild all innerwidgets located inside a container\r\n     *\r\n     * @param {Object} container\r\n     * @param {JQuery} $container\r\n     * @param {Object} options\r\n     */\r\n    function _rebuildWidgets(container, $container, options){\r\n        var widgets = {};\r\n        options = options || {};\r\n\r\n        //re-init all widgets:\r\n        _.each(_.values(container.elements), function(elt){\r\n\r\n            var widget = elt.data('widget'),\r\n                currentState = widget.getCurrentState().name;\r\n\r\n            widgets[elt.serial] = widget.rebuild({\r\n                context : $container,\r\n                ready : function(widget){\r\n                    if(options.restoreState){\r\n                        //restore current state\r\n                        widget.changeState(currentState);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n\r\n        $container.trigger('widgetCreated', [widgets, container]);\r\n\r\n        return widgets;\r\n    }\r\n\r\n    /**\r\n     * Find the widget container by its serial\r\n     *\r\n     * @param {JQuery} $container\r\n     * @param {String} serial\r\n     */\r\n    function _findWidgetContainer($container, serial){\r\n        return $container.find('.widget-box[data-serial=' + serial + ']');\r\n    }\r\n\r\n    /**\r\n     * Detect if an inner widget has been removed\r\n     *\r\n     * @param {JQuery} $container\r\n     * @param {Array} widgets\r\n     * @param {Object} editor\r\n     * @returns {undefined}\r\n     */\r\n    function _detectWidgetDeletion($container, widgets, editor){\r\n\r\n        var deleted = [];\r\n        var container = $container.data('qti-container');\r\n\r\n        _.each(widgets, function(w){\r\n\r\n            if(!w.element.data('removed')){\r\n                var $widget = _findWidgetContainer($container, w.serial);\r\n                if(!$widget.length){\r\n                    deleted.push(w);\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n        if(deleted.length){\r\n            var undoCmd = editor.getCommand( 'undo');\r\n            var $messageBox = deletingHelper.createInfoBox(deleted);\r\n\r\n            $messageBox.on('confirm.deleting', function(){\r\n\r\n                _.each(deleted, function(w){\r\n                    w.element.remove();\r\n                    w.destroy();\r\n                });\r\n\r\n                editor.resetUndo();\r\n\r\n            }).on('undo.deleting', function(){\r\n\r\n                editor.undoManager.undo();\r\n\r\n                //need to rebuild the inner widgets in case the undo restored some qti elements\r\n                _rebuildWidgets(container, $container, {\r\n                    restoreState : true\r\n                });\r\n\r\n                _shieldInnerContent($container, container.data('widget'));\r\n            });\r\n\r\n            if (undoCmd){\r\n                //catch ckeditor's undo event to trigger the same behaviour as the undo action dialog\r\n                undoCmd.on('afterUndo', function(){\r\n                    $messageBox.find('a.undo').click();\r\n                });\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {JQuery} $widget - the widget to be protected\r\n     * @returns {JQuery} The added layer (shield)\r\n     */\r\n    function addShield($widget){\r\n        var $shield = $('<button>', {\r\n            'class' : 'html-editable-shield'\r\n        });\r\n\r\n        $widget.attr('contenteditable', false);\r\n        $widget.append($shield);\r\n        return $shield;\r\n    }\r\n\r\n    /**\r\n     * Protect the inner widgets of a container\r\n     *\r\n     * @param {JQuery} $container\r\n     * @param {Object} containerWidget\r\n     * @returns {undefined}\r\n     */\r\n    function _shieldInnerContent($container, containerWidget){\r\n\r\n        $container.find('.widget-box').each(function(){\r\n            var $widget = $(this);\r\n\r\n            addShield($widget).on('click', function(e){\r\n                var innerWidget;\r\n\r\n                //click on shield:\r\n                //1. this.widget.changeState('sleep');\r\n                //2. clicked widget.changeState('active');\r\n\r\n                e.stopPropagation();\r\n\r\n                innerWidget = $widget.data('widget');\r\n                _activateInnerWidget(containerWidget, innerWidget);\r\n            });\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Activate the inner widget\r\n     *\r\n     * @param {Object} containerWidget\r\n     * @param {Object} innerWidget\r\n     * @returns {undefined}\r\n     */\r\n    function _activateInnerWidget(containerWidget, innerWidget){\r\n\r\n        if(containerWidget && containerWidget.element && containerWidget.element.qtiClass){\r\n\r\n            var listenToWidgetCreation = function(){\r\n                containerWidget.$container\r\n                  .off('widgetCreated')\r\n                  .one('widgetCreated', function(e, widgets){\r\n                    var targetWidget = widgets[innerWidget.serial];\r\n                    if(targetWidget){\r\n                        //FIXME potential race condition ? (debounce the enclosing event handler ?)\r\n                        _.delay(function(){\r\n                            if(Element.isA(targetWidget.element, 'interaction')){\r\n                                targetWidget.changeState('question');\r\n                            } else{\r\n                                targetWidget.changeState('active');\r\n                            }\r\n                        }, 100);\r\n                    }\r\n                });\r\n\r\n            };\r\n\r\n            if(Element.isA(containerWidget.element, '_container') && !containerWidget.element.data('stateless')){\r\n\r\n                //only _container that are NOT stateless need to change its state to sleep before activating the new one.\r\n                listenToWidgetCreation();\r\n                containerWidget.changeState('sleep');\r\n\r\n            }else if(Element.isA(containerWidget.element, 'choice')){\r\n\r\n                listenToWidgetCreation();\r\n                containerWidget.changeState('question');\r\n\r\n            }else if(Element.isA(innerWidget.element, 'choice')){\r\n\r\n                innerWidget.changeState('choice');\r\n\r\n            }else{\r\n\r\n                innerWidget.changeState('active');\r\n            }\r\n\r\n        }else{\r\n\r\n            innerWidget.changeState('active');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Special encoding of ouput html generated from ie8 : moved to xmlRenderer\r\n     */\r\n    function _htmlEncode(encodedStr){\r\n        return encodedStr;\r\n    }\r\n\r\n    /**\r\n     * Focus the editor and set the cursor to the end\r\n     *\r\n     * @param {Object} editor - the ckeditor instance\r\n     * @returns {undefined}\r\n     */\r\n    function _focus(editor){\r\n        var range;\r\n        if (editor.editable() && editor.editable().parentNode){\r\n            editor.focus();\r\n            range = editor.createRange();\r\n            range.moveToElementEditablePosition(editor.editable(), true);\r\n            editor.getSelection().selectRanges([range]);\r\n        }\r\n    }\r\n\r\n    var editorFactory = {\r\n        /**\r\n         * Check if all data-html-editable has an editor\r\n         *\r\n         * @param {type} $container\r\n         * @returns {undefined}\r\n         */\r\n        hasEditor : function($container){\r\n\r\n            var hasEditor = false;\r\n\r\n            _find($container, 'html-editable').each(function(){\r\n                hasEditor = !!$(this).data('editor');\r\n                return hasEditor; //continue if true, break if false\r\n            });\r\n\r\n            return hasEditor;\r\n        },\r\n        /**\r\n         * Instanciate the editor\r\n         *\r\n         * @param {JQuery} $container\r\n         * @param {Object} [editorOptions]\r\n         * @param {String} [editorOptions.placeholder] - the place holder text\r\n         * @param {Boolean} [editorOptions.shieldInnerContent] - define if the inner widget content should be protected or not\r\n         * @param {Boolean} [editorOptions.passthroughInnerContent] - define if the inner widget content should be accessible directly or not\r\n         * @param {Boolean} [editorOptions.hideTriggerOnBlur] - define if the ckeditor trigger should be hidden when the editor is blurred\r\n         * @param {Boolean} [editorOptions.enterMode] - what is the behavior of the \"Enter\" key (see ENTER_MODE_xxx in ckEditor configuration)\r\n         * @returns {undefined}\r\n         */\r\n        buildEditor : function($container, editorOptions){\r\n\r\n            _find($container, 'html-editable-container').each(function(){\r\n\r\n                var $editableContainer = $(this),\r\n                    $editable = $editableContainer.find('[data-html-editable]');\r\n\r\n                //need to make the element html editable to enable ck inline editing:\r\n                $editable.attr('contenteditable', true);\r\n\r\n                //build it\r\n                _buildEditor($editable, $editableContainer, editorOptions);\r\n\r\n            });\r\n\r\n        },\r\n        /**\r\n         * Destroy the editor\r\n         *\r\n         * @param {JQuery} $container\r\n         * @returns {undefined}\r\n         */\r\n        destroyEditor : function($container){\r\n\r\n            _find($container, 'html-editable-container').each(function(){\r\n\r\n                var $editableContainer = $(this),\r\n                    $editable = $editableContainer.find('[data-html-editable]'),\r\n                    $trigger = getTrigger($editableContainer);\r\n\r\n                $trigger\r\n                    .off()\r\n                    .removeClass('active')\r\n                    .hide();\r\n\r\n                $editable.removeAttr('contenteditable');\r\n                if($editable.data('editor')){\r\n\r\n                    var editor = $editable.data('editor'),\r\n                        options = $editable.data('editor-options');\r\n\r\n                    //before destroying, ensure that data is stored\r\n                    if(_.isFunction(options.change)){\r\n                        options.change.call(editor, _htmlEncode(editor.getData()));\r\n                    }\r\n                    editor.on('destroy', function () {\r\n                        $container.trigger('editordestroyed');\r\n                    });\r\n\r\n                    editor.focusManager.blur(true);\r\n                    editor.destroy();\r\n\r\n                    $editable.removeData('editor').removeData('editor-options');\r\n                    if($editable.data('qti-container')){\r\n                        _rebuildWidgets($editable.data('qti-container'), $editable);\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        /**\r\n         * Get the editor content\r\n         *\r\n         * @param {JQuery} $editable\r\n         */\r\n        getData : function($editable){\r\n            var editor = $editable.data('editor');\r\n            if(editor){\r\n                return _htmlEncode(editor.getData());\r\n            }else{\r\n                throw new Error('no editor attached to the DOM element');\r\n            }\r\n        },\r\n        /**\r\n         * Allow to set the editor content. Works only with plain text for now.\r\n         *\r\n         * @param {JQuery} $editable\r\n         * @param {String} data\r\n         */\r\n        setData : function($editable, data) {\r\n            var editor = $editable.data('editor');\r\n            if(editor){\r\n                if (_.isString(data)) {\r\n                    editor.setData(_.escape(data));\r\n                }\r\n            }else{\r\n                throw new Error('no editor attached to the DOM element');\r\n            }\r\n        },\r\n        /**\r\n         * Focus all the editors found in the given container\r\n         *\r\n         * @param {JQuery} $editable\r\n         * @returns {undefined}\r\n         */\r\n        focus : function($editable){\r\n            _find($editable, 'html-editable').each(function(){\r\n                var editor = $(this).data('editor');\r\n                if(editor){\r\n                    _focus(editor);\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    return editorFactory;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/text', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <em>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"no configuration property needed\", options) : helperMissing.call(depth0, \"__\", \"no configuration property needed\", options)))\n    + \"</em>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/static/text/states/Active',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/text'\r\n], function(stateFactory, Active, htmlEditor, content, formTpl){\r\n\r\n    var TextActive = stateFactory.extend(Active, function(){\r\n\r\n        this.buildEditor();\r\n        this.initForm();\r\n\r\n    }, function(){\r\n\r\n        this.destroyEditor();\r\n        this.widget.$form.empty();\r\n    });\r\n\r\n    TextActive.prototype.buildEditor = function(){\r\n\r\n        var widget = this.widget,\r\n            $editableContainer = widget.$container,\r\n            container = widget.element;\r\n\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                change : content.getChangeCallback(container),\r\n                blur : function(){\r\n                    widget.changeState('sleep');\r\n                },\r\n                data : {\r\n                    widget : widget,\r\n                    container : container\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    TextActive.prototype.destroyEditor = function(){\r\n        //search and destroy the editor\r\n        htmlEditor.destroyEditor(this.widget.$container);\r\n    };\r\n\r\n    TextActive.prototype.initForm = function(){\r\n        this.widget.$form.html(formTpl());\r\n    };\r\n\r\n    return TextActive;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/text/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/text/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/text/states/Active'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/textBlock', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"mini-tlb\\\" data-edit=\\\"\";\n  if (helper = helpers.state) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.state); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <div class=\\\"rgt tlb-button\\\" title=\\\"Delete\\\" data-role=\\\"delete\\\">\\r\\n        <span class=\\\"icon-bin\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"rgt tlb-button\\\" data-role=\\\"cke-launcher\\\" title=\\\"Formatting options\\\">\\r\\n        <span class=\\\"icon-font\\\"></span>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/static/text/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/text/states/states',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/textBlock'\r\n], function($, Widget, states, toolbarTpl){\r\n\r\n    var TextWidget = Widget.clone();\r\n\r\n    TextWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.registerStates(states);\r\n\r\n    };\r\n\r\n    TextWidget.buildContainer = function(){\r\n\r\n        var $wrap = $('<div>', {'data-serial' : this.element.serial, 'data-qti-class' : '_container', 'class' : 'widget-box widget-block widget-textBlock'})\r\n            .append($('<div>', {'data-html-editable' : true}));\r\n\r\n        this.$original.wrapInner($wrap);\r\n\r\n        this.$container = this.$original.children('.widget-box');\r\n    };\r\n\r\n    TextWidget.createToolbar = function(){\r\n\r\n        var _this = this,\r\n            $tlb = $(toolbarTpl({\r\n            serial : this.serial,\r\n            state : 'active'\r\n        }));\r\n\r\n        this.$container.append($tlb);\r\n\r\n        $tlb.find('[data-role=\"delete\"]').on('click.widget-box', function(e){\r\n            e.stopPropagation();//to prevent direct deleting;\r\n            _this.changeState('deleting');\r\n        });\r\n\r\n        return this;\r\n    };\r\n    \r\n    return TextWidget;\r\n});\n","define('taoQtiItem/qtiCreator/editor/blockAdder/blockAdder',[\r\n    'jquery',\r\n    'lodash',\r\n    'tpl!taoQtiItem/qtiCreator/editor/blockAdder/tpl/addColumnRow',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/helper/creatorRenderer',\r\n    'taoQtiItem/qtiCreator/model/helper/container',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'taoQtiItem/qtiCreator/editor/elementSelector/selector',\r\n    'taoQtiItem/qtiCreator/widgets/static/text/Widget'\r\n], function($, _, adderTpl, Element, creatorRenderer, containerHelper, contentHelper, elementSelector, TextWidget){\r\n    'use strict';\r\n\r\n    var _ns = '.block-adder';\r\n    var _wrap = '<div class=\"colrow\"></div>';\r\n    var _placeholder = '<div class=\"placeholder\">';\r\n\r\n    /**\r\n     * Init the block adder on the item editor panel\r\n     *\r\n     * @param {Object} item - standard qti js object\r\n     * @param {JQuery} $editorPanel - the container the selector popup will be located in\r\n     * @param {Array} interactions - the array of authorable interactions\r\n     */\r\n    function create(item, $editorPanel, interactions){\r\n\r\n        var selector, widget;\r\n        var $itemEditorPanel = $('#item-editor-panel');\r\n\r\n        /**\r\n         * Get the qti item body dom\r\n         *\r\n         * @returns {JQuery}\r\n         */\r\n        function _getItemBody(){\r\n            return $editorPanel.find('.qti-itemBody');\r\n        }\r\n\r\n        /**\r\n         * Init insertion relative to a widget container\r\n         *\r\n         * @param {JQuery} $widget\r\n         */\r\n        function _initInsertion($widget){\r\n\r\n            var $wrap = $(_wrap);\r\n            var $colRow = $widget.parent('.colrow');\r\n\r\n            //trigger event to restore all currently active widget back to sleep state\r\n            $itemEditorPanel.trigger('beforesave.qti-creator.active');\r\n\r\n            if(!$colRow.length){\r\n                $widget.wrap(_wrap);\r\n                $colRow = $widget.parent('.colrow');\r\n            }\r\n            $colRow.after($wrap);\r\n\r\n            //create a new selector instance\r\n            selector = elementSelector.create($wrap, $editorPanel, interactions);\r\n\r\n            $editorPanel.off('.element-selector').on('selected.element-selector', function(e, qtiClass){\r\n\r\n                var $placeholder = $(_placeholder);\r\n\r\n                //remove old widget if applicable:\r\n                if(widget){\r\n                    //from model\r\n                    widget.element.remove();\r\n                    widget = null;\r\n                    //from dom\r\n                    $wrap.find('.widget-box').remove();\r\n                }\r\n\r\n                $wrap.addClass('tmp').prepend($placeholder);\r\n                _insertElement(qtiClass, $placeholder);\r\n                selector.reposition();\r\n\r\n            }).on('done.element-selector', function(){\r\n                _done($wrap);\r\n            }).on('cancel.element-selector', function(){\r\n                _cancel($wrap);\r\n            });\r\n\r\n            //when clicking outside of the selector popup, consider it done\r\n            $itemEditorPanel.on('click' + _ns + ' mousedown' + _ns, function(e){\r\n                var popup = selector.getPopup()[0];\r\n                if(popup !== e.target && !$.contains(popup, e.target)){\r\n                    _done($wrap);\r\n                }\r\n            });\r\n\r\n            //select a default element type\r\n            selector.activateElement('_container');\r\n            selector.activatePanel('Text Block');\r\n\r\n            //set into the inserting state\r\n            _getItemBody().addClass('edit-inserting');\r\n        }\r\n\r\n        /**\r\n         * End the current insertion state\r\n         *\r\n         * @returns {undefined}\r\n         */\r\n        function _endInsertion(){\r\n\r\n            //destroy selector\r\n            selector.destroy();\r\n\r\n            //reset references\r\n            selector = null;\r\n            widget = null;\r\n\r\n            $editorPanel.off('.element-selector');\r\n            _getItemBody().removeClass('edit-inserting');\r\n\r\n            //need to update item body\r\n            item.body(contentHelper.getContent(_getItemBody()));\r\n\r\n            //unbind events\r\n            $itemEditorPanel.off(_ns);\r\n        }\r\n\r\n        /**\r\n         * Function to define behaviour when the insertion is completed\r\n         *\r\n         * @param {JQuery} $wrap\r\n         * @returns {undefined}\r\n         */\r\n        function _done($wrap){\r\n\r\n            //remove tmp class\r\n            $wrap.removeClass('tmp');\r\n\r\n            //append button\r\n            _appendButton(widget.$container);\r\n\r\n            //activate the new widget:\r\n            _.defer(function(){\r\n                if(widget.element.is('interaction')){\r\n                    widget.changeState('question');\r\n                }else{\r\n                    widget.changeState('active');\r\n                }\r\n                _endInsertion();\r\n            });\r\n\r\n        }\r\n\r\n        /**\r\n         * Function defining the behaviour when the insertion has been aborted\r\n         *\r\n         * @param {JQuery} $wrap\r\n         * @returns {undefined}\r\n         */\r\n        function _cancel($wrap){\r\n\r\n            //destroy interaction + colRow\r\n            widget.element.remove();\r\n            $wrap.remove();\r\n\r\n            _endInsertion();\r\n        }\r\n\r\n        $editorPanel.find('.widget-block, .widget-blockInteraction').each(function(){\r\n            _appendButton($(this));\r\n        });\r\n\r\n        //bind add event\r\n        $editorPanel.on('mousedown', '.add-block-element .circle', function(e){\r\n\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            var $widget = $(this).parents('.widget-box');\r\n            _initInsertion($widget);\r\n\r\n        }).on('ready.qti-widget', function(e, _widget){\r\n\r\n            var qtiElement = _widget.element;\r\n\r\n            if(qtiElement.is('blockInteraction') || qtiElement.is('_container') || qtiElement.is('customInteraction')){\r\n\r\n                _appendButton(_widget.$container);\r\n\r\n                if(selector && _widget.$container.parent('.colrow.tmp').length){\r\n\r\n                    //after update when we are in the selecting mode:\r\n                    if(qtiElement.is('customInteraction')){\r\n                        //pci rendering is asynchornous:\r\n                        qtiElement.onPciReady(function(){\r\n                            selector.reposition();\r\n                        });\r\n                    }\r\n                    selector.reposition();\r\n\r\n                    //store the reference to the newly created widget\r\n                    widget = _widget;\r\n                }\r\n            }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Append the \"plus\" button into a widget\r\n     *\r\n     * @param {JQuery} $widget\r\n     * @returns {undefined}\r\n     */\r\n    function _appendButton($widget){\r\n\r\n        //only append button to no-tmp widget and only add it once:\r\n        if(!$widget.children('.add-block-element').length &&\r\n            !$widget.parent('.colrow.tmp').length){\r\n\r\n            var $adder = $(adderTpl());\r\n            $widget.append($adder);\r\n            $adder.on('click mouseenter mouseleave', function(e){\r\n                e.stopPropagation();\r\n                //consider it outside of the widget element\r\n                $(this).parent().trigger('mouseleave');\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create a new qti element in place of the give $placehoder\r\n     *\r\n     * @param {String} qtiClass\r\n     * @param {JQuery} $placeholder\r\n     */\r\n    function _insertElement(qtiClass, $placeholder){\r\n\r\n        //a new qti element has been added: update the model + render\r\n        $placeholder.removeAttr('id');//prevent it from being deleted\r\n\r\n        if(qtiClass === 'rubricBlock'){\r\n            //qti strange exception: a rubricBlock must be the first child of itemBody, nothing else...\r\n            //so in this specific case, consider the whole row as the rubricBlock\r\n            //by the way, in our grid system, rubricBlock can only have a width of col-12\r\n            $placeholder = $placeholder.parent('.col-12').parent('.grid-row');\r\n        }\r\n\r\n        $placeholder.addClass('widget-box');//required for it to be considered as a widget during container serialization\r\n        $placeholder.attr({\r\n            'data-new' : true,\r\n            'data-qti-class' : qtiClass\r\n        });//add data attribute to get the dom ready to be replaced by rendering\r\n\r\n        var $widget = $placeholder.parent().closest('.widget-box, .qti-item');\r\n        var $editable = $placeholder.closest('[data-html-editable], .qti-itemBody');\r\n        var widget = $widget.data('widget');\r\n        var element = widget.element;\r\n        var container = Element.isA(element, '_container') ? element : element.getBody();\r\n\r\n        if(!element || !$editable.length){\r\n            throw new Error('cannot create new element');\r\n        }\r\n\r\n        containerHelper.createElements(container, contentHelper.getContent($editable), function(newElts){\r\n\r\n            var creator = creatorRenderer.get();\r\n            creator.load(function(){\r\n\r\n                for(var serial in newElts){\r\n\r\n                    var elt = newElts[serial],\r\n                        $widget,\r\n                        widget,\r\n                        $colParent = $placeholder.parent();\r\n\r\n                    elt.setRenderer(this);\r\n\r\n                    if(Element.isA(elt, '_container')){\r\n                        //the text widget is \"inner-wrapped\" so need to build a temporary container:\r\n                        $placeholder.replaceWith('<div class=\"text-block\"></div>');\r\n                        var $textBlock = $colParent.find('.text-block');\r\n                        $textBlock.html(elt.render());\r\n\r\n                        //build the widget\r\n                        widget = TextWidget.build(elt, $textBlock, creator.getOption('textOptionForm'), {\r\n                            ready : function(){\r\n                                //remove the temorary container\r\n                                this.$container.unwrap();\r\n                            }\r\n                        });\r\n                        $widget = widget.$container;\r\n\r\n                    }else{\r\n                        elt.render($placeholder);\r\n                        elt.postRender();\r\n                        widget = elt.data('widget');\r\n                        if(Element.isA(elt, 'blockInteraction')){\r\n                            $widget = widget.$container;\r\n                        }else{\r\n                            //leave the container in place\r\n                            $widget = widget.$original;\r\n                        }\r\n                    }\r\n\r\n                    //inform height modification\r\n                    $widget.trigger('contentChange.gridEdit');\r\n                    $widget.trigger('resize.gridEdit');\r\n\r\n                }\r\n            }, this.getUsedClasses());\r\n        });\r\n    }\r\n\r\n    return {\r\n        create : create\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/ckEditor/ckProtector',[\r\n    'jquery',\r\n    'i18n'\r\n], function($, __){\r\n    'use strict';\r\n\r\n    /**\r\n     * Protect / unprotect an element to avoid edition by CK EDITOR\r\n     *\r\n     * @returns {{protect: protect, init: init, unprotect: unprotect}}\r\n     */\r\n    var ckeProtector = (function() {\r\n\r\n        var selector = '.widget-box';\r\n\r\n        /**\r\n         * Observe changes to content editable elements\r\n         *\r\n         * @param context\r\n         */\r\n        var observeContentChanges = function($context) {\r\n\r\n            var contextDomNode = $context[0];\r\n\r\n            var MutationObserver = (window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver);\r\n\r\n            // IE 10\r\n            if (!MutationObserver) {\r\n                contextDomNode.addEventListener('DOMCharacterDataModified', function() {\r\n                    $context.trigger('contentchange.protector');\r\n                }, false);\r\n            }\r\n            // all recent browser apart from IE 10\r\n            else {\r\n                var observer = new MutationObserver(function(mutations) {\r\n                    mutations.forEach(function() {\r\n                        $context.trigger('contentchange.protector');\r\n                    })\r\n                });\r\n                observer.observe(contextDomNode, {\r\n                    subtree: true,\r\n                    characterData: true\r\n                });\r\n            }\r\n\r\n        };\r\n\r\n        /**\r\n         * Retrieve selector from the outside\r\n         *\r\n         * @returns {string}\r\n         */\r\n        var getSelector = function() {\r\n            return selector;\r\n        };\r\n\r\n        /**\r\n         * Protect elements from being edited by CKeditor.\r\n         * Global selector can be overridden by any function\r\n         *\r\n         * @param context optional\r\n         * @param selectorParam optional\r\n         */\r\n        var protect = function(context, selectorParam) {\r\n            if(selectorParam) {\r\n                selector = selectorParam;\r\n            }\r\n            context.find(selector).each(function() {\r\n                var widget = $(this),\r\n                    iWidth = widget.outerWidth(),\r\n                    iHeight = widget.outerHeight(),\r\n                    cover = $('<button class=\"cke-cover-up\">'),\r\n                    wrapper,\r\n                    // cke copies the widget to a kind of shadow dom, hence this trickery\r\n                    getProtectedWidgetBySerial = function(serial) {\r\n                        $('[data-serial=\"' + serial + '\"]').each(function() {\r\n                            var widget = $(this);\r\n                            if(widget.parent().hasClass('cke-qti-wrapper')) {\r\n                                return false;\r\n                            }\r\n                        });\r\n                        return widget.length ? widget : $();\r\n                    },\r\n                    positionCover = function(cover) {\r\n                        var wrapper = getProtectedWidgetBySerial(cover.prop('serial')).parent('.cke-qti-wrapper'),\r\n                            iOffset = wrapper.offset();\r\n                        cover.css({\r\n                            left: iOffset.left,\r\n                            top: iOffset.top\r\n                        })\r\n                    };\r\n\r\n                if(widget.parent('.cke-qti-wrapper').length) {\r\n                    return false;\r\n                }\r\n\r\n                // avoid empty elements since they would be killed by CKE\r\n                // &#8203; means zero-width-space\r\n                widget.find('*').each(function() {\r\n                    if(!this.innerHTML) {\r\n                        this.innerHTML = '&#8203;'\r\n                    }\r\n                });\r\n\r\n                widget.wrap($('<span class=\"cke-qti-wrapper\" />'));\r\n\r\n                wrapper = widget.parent();\r\n\r\n                cover.css({\r\n                    width: iWidth,\r\n                    height: iHeight\r\n                });\r\n                $('body').append(cover);\r\n\r\n                wrapper.css({\r\n                    width: iWidth,\r\n                    height: iHeight\r\n                });\r\n                wrapper.attr('contenteditable', false);\r\n                wrapper.prop('cover', cover);\r\n\r\n                cover.prop('serial', widget.data('serial'));\r\n\r\n                positionCover(cover);\r\n\r\n                cover.attr('title', __('Click to display interaction widget'));\r\n\r\n                cover.on('click', function() {\r\n                    var widget = getProtectedWidgetBySerial($(this).prop('serial'));\r\n                    //unprotect(widget);\r\n                    $(document).trigger('removeprotection.ckprotector', { context: context, widget: widget });\r\n                });\r\n\r\n                observeContentChanges(context);\r\n\r\n                context.on('contentchange.protector', function() {\r\n                    positionCover(cover);\r\n                });\r\n            });\r\n        };\r\n\r\n        /**\r\n         * Protect protection\r\n         * Global selector can be overridden by any function\r\n         *\r\n         * @param protectedArea optional\r\n         */\r\n        var unprotect = function(widget) {\r\n            widget.each(function() {\r\n                var widget = $(this),\r\n                    wrapper = widget.parent('.cke-qti-wrapper');\r\n                if(wrapper.length) {\r\n                    wrapper.prop('cover').remove();\r\n                    widget.unwrap();\r\n                }\r\n            });\r\n        };\r\n\r\n        return {\r\n            protect: protect,\r\n            unprotect: unprotect,\r\n            getSelector: getSelector\r\n        };\r\n    }());\r\n    return ckeProtector;\r\n});\r\n\r\n\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/editor/colorPicker/tpl/popup', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  \n\n\n  return \"<div class=\\\"color-picker-container sidebar-popup\\\">\\r\\n    <div class=\\\"sidebar-popup-title\\\">\\r\\n        <h3 style=\\\"font-size:13px;margin:0\\\"></h3>\\r\\n        <a class=\\\"closer\\\" href=\\\"#\\\"></a>\\r\\n    </div>\\r\\n    <div class=\\\"sidebar-popup-content\\\">\\r\\n        <div class=\\\"color-picker\\\"></div>\\r\\n        <input class=\\\"color-picker-input\\\" type=\\\"text\\\" value=\\\"#000000\\\">\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  });\n});\n\n","define('taoQtiItem/qtiCreator/editor/colorPicker/colorPicker',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/helper/popup',\r\n    'tpl!taoQtiItem/qtiCreator/editor/colorPicker/tpl/popup',\r\n    'lib/farbtastic/farbtastic'\r\n], function($, _, __, popup, popupTpl){\r\n\r\n    'use strict';\r\n\r\n    var _defaults = {\r\n        title : __('Color Picker'),\r\n        offsetTop : -40\r\n    };\r\n\r\n    /**\r\n     * Create and attach a color picker to a JQuery container\r\n     * \r\n     * @param {Object} $colorTrigger - a JQuery container\r\n     * @param {Object} config\r\n     * @param {Integer} [config.offsetTop = -40] - the offset top relative to the trigger\r\n     * @param {String|Function} [config.title = 'Color Picker'] - defines the title of the color picker\r\n     * @returns {undefined}\r\n     */\r\n    function create($colorTrigger, config){\r\n\r\n        config = _.defaults(config || {}, _defaults);\r\n\r\n        var color, $input = $colorTrigger.siblings('input');\r\n\r\n        //set color recorded in the hidden input to the color trigger\r\n        if(config.color){\r\n            color = config.color;\r\n            $input.val(color);\r\n        }else{\r\n            color = $input.val();\r\n        }\r\n\r\n        $colorTrigger.css('background-color', color);\r\n\r\n        var $popup = $(popupTpl());\r\n        $colorTrigger.data('color-picker', $popup);\r\n        $('#item-editor-wrapper').append($popup);\r\n        \r\n        // basic popup functionality\r\n        popup.init($colorTrigger, {popup : $popup});\r\n        \r\n\r\n        // after popup opens\r\n        $colorTrigger.on('open.popup', function(e, params){\r\n\r\n            var $trigger = $(this),\r\n                $container = $trigger.parents('.sidebar-popup'),\r\n                title,\r\n                // this is the input of the color picker\r\n                color = $input.val();\r\n\r\n            var $colorPicker = params.popup.find('.color-picker'),\r\n                $colorPickerInput = params.popup.find('.color-picker-input');\r\n\r\n            params.popup.css({right : $(window).width() - $container.offset().left + 2, top : $trigger.offset().top + config.offsetTop - $('#item-editor-wrapper').offset().top});\r\n            if(_.isFunction(config.title)){\r\n                title = config.title.call(this);\r\n            }else if(_.isString(config.title)){\r\n                title = config.title;\r\n            }\r\n            params.popup.find('h3').text(title);\r\n\r\n            // Init the color picker\r\n            $colorPicker.farbtastic($colorPickerInput);\r\n\r\n            // Set the color to the currently set on the form init\r\n            $colorPickerInput.val(color).trigger('keyup');\r\n            config.color = color;\r\n\r\n            // Populate the input with the color on quitting the modal\r\n            params.popup.find('.closer').off('click').on('click', function(){\r\n                params.popup.hide();\r\n                $colorPicker.off('.farbtastic');\r\n            });\r\n\r\n            //listen to color change\r\n            $colorPicker.off('.farbtastic').on('colorchange.farbtastic', function(e, color){\r\n                $colorTrigger.css('background-color', color);\r\n                $input.val(color).trigger('change');\r\n            });\r\n\r\n        });\r\n\r\n        // after popup closes\r\n        $colorTrigger.on('close.popup', function(e, params){\r\n            params.popup.find('.color-picker').off('.farbtastic');\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Destroy the color picker attached to a JQuery conttainer\r\n     * \r\n     * @param {Object} $colorTrigger - a JQuery container\r\n     * @returns {undefined}\r\n     */\r\n    function destroy($colorTrigger){\r\n        $colorTrigger.off('.color-picker');\r\n        $colorTrigger.removeAttr('data-color-picker');\r\n        var $popup = $colorTrigger.data('color-picker');\r\n        if($popup instanceof $){\r\n            $popup.remove();\r\n        }\r\n    }\r\n\r\n    return {\r\n        create : create,\r\n        destroy : destroy\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/Container',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/Container'\r\n], function(_, editable, Container){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        afterCreate : function(){\r\n            this.body('<p>Lorem ipsum dolor sit amet, consectetur adipisicing ...</p>');\r\n        },\r\n        beforeRemove : function(){\r\n            _.each(this.getComposingElements(), function(element){\r\n                if(_.isFunction(element.beforeRemove)){\r\n                    element.beforeRemove();\r\n                }\r\n            });\r\n        }\r\n    });\r\n    return Container.extend(methods);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/htmlEditorTrigger', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"mini-tlb\\\" data-edit=\\\"\";\n  if (helper = helpers.state) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.state); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-role=\\\"cke-launcher-tlb\\\">\\r\\n    <div class=\\\"rgt tlb-button\\\" data-role=\\\"cke-launcher\\\" title=\\\"Formatting options\\\">\\r\\n        <span class=\\\"icon-font\\\"></span>\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/containerEditor',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiItem/core/Loader',\r\n    'taoQtiItem/qtiCreator/model/Container',\r\n    'taoQtiItem/qtiCreator/model/Item',\r\n    'taoQtiItem/qtiCreator/model/helper/event',\r\n    'taoQtiItem/qtiCreator/model/qtiClasses',\r\n    'taoQtiItem/qtiCreator/helper/commonRenderer',\r\n    'taoQtiItem/qtiCreator/helper/xmlRenderer',\r\n    'taoQtiItem/qtiItem/helper/simpleParser',\r\n    'taoQtiItem/qtiCreator/helper/creatorRenderer',\r\n    'taoQtiItem/qtiCreator/helper/xincludeRenderer',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/htmlEditorTrigger'\r\n], function(_, $, Loader, Container, Item, event, qtiClasses, commonRenderer, xmlRenderer, simpleParser, creatorRenderer, xincludeRenderer, content, htmlEditor, toolbarTpl){\r\n    \"use strict\";\r\n\r\n    var _ns = 'containereditor';\r\n\r\n    var _defaults = {\r\n        change : _.noop,\r\n        markup : '',\r\n        markupSelector : '',\r\n        qtiMedia : false\r\n    };\r\n\r\n    function parser($container){\r\n\r\n        //detect math ns :\r\n        var mathNs = 'm';//for 'http://www.w3.org/1998/Math/MathML'\r\n\r\n        //parse qti xml content to build a data object\r\n        var data = simpleParser.parse($container.clone(), {\r\n            ns : {\r\n                math : mathNs\r\n            }\r\n        });\r\n\r\n        if(data.body){\r\n            return data.body;\r\n        }else{\r\n            throw new Error('invalid content for qti container');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Transform the given dom element into a rich-text editor\r\n     *\r\n     * @param {JQuery} $container - the container of the DOM element that is going to editable\r\n     * @param {Object} [options]\r\n     * @param {String} [options.markup] - the markup to be use as the initial editor content\r\n     * @param {String} [options.markupSelector] - the element in $xontainer that holds the html to be used as the initial editor content\r\n     * @param {Object} [options.related] - define the qti element object this editor is attached too. Very important to edit a picture or math element inside it because prevents leaving the editing state of the related element.\r\n     * @param {Function} [options.change] - the callback called when the editor content has been modified\r\n     * @param {Function} [options.hideTriggerOnBlur] - define if the trigger <A> should be hidden when the editor is blurred or not\r\n     * @param {Function} [options.placeholder] - the placeholder text of the container editor when\r\n     * @param {Function} [options.$toolbarLocation] - the location of the toolbar\r\n     * @param {Function} [options.toolbar] - the ck toolbar\r\n     * @param {Function} [options.qtiMedia=false] - allow insert media object\r\n     * @returns {undefined}\r\n     */\r\n    function create($container, options){\r\n\r\n        var html, htmls, data, loader;\r\n\r\n        options = _.defaults(options || {}, _defaults);\r\n\r\n        //assign proper markup\r\n        if(options.markup){\r\n            html = options.markup;\r\n            if(options.markupSelector){\r\n                htmls = extractHtmlFromMarkup(html, options.markupSelector);\r\n                html = htmls[0] || '';\r\n            }\r\n            $container.html(html);\r\n        }\r\n\r\n        data = parser($container);\r\n        loader = new Loader().setClassesLocation(qtiClasses);\r\n        loader.loadRequiredClasses(data, function(){\r\n\r\n            var item, containerEditors;\r\n\r\n            //create a new container object\r\n            var container = new Container();\r\n\r\n            //tag the new container as statelss, which means that its state is not supposed to change\r\n            container.data('stateless', true);\r\n\r\n            $container.data('container', container);\r\n\r\n            //need to attach a container to the item to enable innserElement.remove()\r\n            //@todo fix this\r\n            item = new Item().setElement(container);\r\n            container.setRelatedItem(item);\r\n\r\n            //associate it to the interaction?\r\n            if(options.related){\r\n                containerEditors = options.related.data('container-editors') || [];\r\n                containerEditors.push(container);\r\n                options.related.data('container-editors', containerEditors);\r\n            }\r\n\r\n            this.loadContainer(container, data);\r\n\r\n            //apply common renderer :\r\n            creatorRenderer.load(['img', 'object', 'math', 'include', '_container'], function(){\r\n\r\n                var baseUrl = this.getOption('baseUrl');\r\n                container.setRenderer(this);\r\n                $container.html(container.render());\r\n                container.postRender();\r\n\r\n                //resolve xinclude\r\n                _.each(container.getComposingElements(), function(element){\r\n                    if(element.qtiClass === 'include'){\r\n                        xincludeRenderer.render(element.data('widget'), baseUrl);\r\n                    }\r\n                });\r\n\r\n                buildContainer($container);\r\n                createToolbar($container, options.$toolbarLocation);\r\n                buildEditor($container, container, {\r\n                    hideTriggerOnBlur: !!options.hideTriggerOnBlur,\r\n                    placeholder : options.placeholder || undefined,\r\n                    toolbar : options.toolbar || undefined,\r\n                    qtiMedia : options.qtiMedia,\r\n                    highlight : options.highlight\r\n                });\r\n\r\n                $container.off('.' + _ns).on(event.getList(_ns + event.getNs() + event.getNsModel()).join(' '), _.throttle(function(e, data){\r\n                    var html = container.render(xmlRenderer.get());\r\n                    $container.trigger('containerchange.' + _ns, [html]);\r\n                    if(_.isFunction(options.change)){\r\n                        options.change(html);\r\n                    }\r\n                }, 600));\r\n\r\n                $container.trigger('editorready.containereditor');\r\n            });\r\n\r\n        });\r\n\r\n    }\r\n\r\n    function buildContainer($container){\r\n\r\n        $container.wrapInner($('<div>', {'class' : 'container-editor', 'data-html-editable' : true}));\r\n    }\r\n\r\n    function createToolbar($container, $appendTo){\r\n\r\n        var $tlb = $(toolbarTpl({\r\n            serial : 'serial123456',\r\n            state : 'active'\r\n        }));\r\n\r\n        if(!$appendTo || !$appendTo.length){\r\n            $appendTo = $container;\r\n        }\r\n\r\n        $appendTo.append($tlb);\r\n        $tlb.show();\r\n\r\n        $container.data('editor-toolbar', $tlb);\r\n\r\n        return this;\r\n    }\r\n\r\n    function cleanup($container){\r\n        var $toolbar, container;\r\n\r\n        //remove the text toolbar\r\n        $toolbar = $container.data('editor-toolbar');\r\n        if($toolbar){\r\n            $toolbar.remove();\r\n        }\r\n\r\n        container = $container.data('container');\r\n        if(container){\r\n            $(document).off('.' + container.serial);\r\n            commonRenderer.load(['img', 'object', 'math', 'include', '_container'], function(){\r\n                $container.html(container.render(this));\r\n            });\r\n        }\r\n\r\n        $container.removeData('container');\r\n\r\n    }\r\n\r\n    /**\r\n     * create a fase widget that is required in html editor\r\n     *\r\n     * @param {JQuery} $editableContainer\r\n     * @param {Object} container\r\n     * @returns {Object} The fake widget object\r\n     */\r\n    function createFakeWidget($editableContainer, container){\r\n\r\n        var widget = {\r\n            $container : $editableContainer,\r\n            element : container,\r\n            changeState : _.noop\r\n        };\r\n        //associate the widget to the container\r\n        container.data('widget', widget);\r\n\r\n        return widget;\r\n    }\r\n\r\n    function buildEditor($editableContainer, container, options){\r\n\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n\r\n            htmlEditor.buildEditor($editableContainer, _.defaults(options || {}, {\r\n                shieldInnerContent : false,\r\n                passthroughInnerContent : false,\r\n                change : content.getChangeCallback(container),\r\n                data : {\r\n                    widget : createFakeWidget($editableContainer, container),\r\n                    container : container\r\n                }\r\n            }));\r\n        }\r\n    }\r\n\r\n    function destroyEditor($editableContainer){\r\n        htmlEditor.destroyEditor($editableContainer);\r\n        $editableContainer.removeAttr('data-html-editable-container');\r\n    }\r\n\r\n    function destroy($container){\r\n        destroyEditor($container);\r\n        cleanup($container);\r\n    }\r\n\r\n    function extractHtmlFromMarkup(markupStr, selector){\r\n        var $found = $('<div>').html(markupStr).find(selector);\r\n        var ret = [];\r\n        $found.each(function(){\r\n            ret.push($(this).html());\r\n        });\r\n        return ret;\r\n    }\r\n\r\n    return {\r\n        create : create,\r\n        destroy : destroy\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/customInteractionRegistry',[\r\n    'taoQtiItem/portableElementRegistry/ciRegistry'\r\n], function(ciRegistry){\r\n    \"use strict\";\r\n\r\n    console.warn('deprected use of \"taoQtiItem/qtiCreator/editor/customInteractionRegistry\", please use \"taoQtiItem/portableElementRegistry/ciRegistry\" now');\r\n\r\n    return {\r\n        get : function get(id){\r\n            var portableElement = {};\r\n            console.warn('deprected use of \"taoQtiItem/qtiCreator/editor/customInteractionRegistry::get()\", please use \"taoQtiItem/portableElementRegistry/ciRegistry::get()\" now');\r\n            portableElement.manifest = ciRegistry.get(id);\r\n            return portableElement;\r\n        },\r\n        getBaseUrl : function getBaseUrl(id){\r\n            console.warn('deprected use of \"taoQtiItem/qtiCreator/editor/customInteractionRegistry::getBaseUrl()\", please use \"taoQtiItem/portableElementRegistry/ciRegistry::getBaseUrl()\" now');\r\n            return this.get(id).manifest.baseUrl;\r\n        }\r\n    }\r\n});\n","define('taoQtiItem/qtiCreator/editor/gridEditor/arrow',['jquery', 'lodash'], function($, _){\r\n    \"use strict\";\r\n    var _eventName = 'arrowenter.gridEdit.gridDragDrop';\r\n\r\n    //build arrow for inter-column insertion:\r\n    var _buildArrows = function _buildArrows($col, options){\r\n\r\n        var defaults = {\r\n            insertZoneWidth : 20,\r\n            marginWidth : 0\r\n        };\r\n\r\n        options = _.extend(defaults, options);\r\n\r\n        //create inter-column insertion helper\r\n        var $insertRight = $('<div>', {'class' : 'grid-edit-insert-box'})\r\n            .css({\r\n                top : 0,\r\n                width: options.insertZoneWidth,\r\n                right : -(options.marginWidth + (options.insertZoneWidth - options.marginWidth) / 2),\r\n                height : $col.parent('.grid-row').height() - parseFloat($col.css('margin-bottom'))\r\n            })\r\n            .append($('<div>', {'class' : 'grid-edit-insert-square'}))\r\n            .append($('<div>', {'class' : 'grid-edit-insert-triangle'}))\r\n            .append($('<div>', {'class' : 'grid-edit-insert-line'}))\r\n            .on('mouseenter', '.grid-edit-insert-triangle, .grid-edit-insert-square', function(){\r\n                $col.trigger(_eventName, ['right']);\r\n                _removeArrows($col);\r\n            });\r\n\r\n        var $insertLeft = $insertRight\r\n            .clone()\r\n            .css({'left' : -(options.marginWidth + 5), 'right' : 'auto'})\r\n            .on('mouseenter', '.grid-edit-insert-triangle, .grid-edit-insert-square', function(){\r\n                $col.trigger(_eventName, ['left']);\r\n                _removeArrows($col);\r\n            });\r\n\r\n        $col.append($insertRight).append($insertLeft);\r\n\r\n        _arrowFall($insertRight, function(){\r\n            $col.trigger(_eventName, ['right']);\r\n            _removeArrows($col);\r\n        });\r\n\r\n        _arrowFall($insertLeft, function(){\r\n            $col.trigger(_eventName, ['left']);\r\n            _removeArrows($col);\r\n        });\r\n\r\n    };\r\n\r\n    //remove arrows:\r\n    var _removeArrows = function _removeArrows($col){\r\n        $col.find('.grid-edit-insert-box').remove();\r\n    };\r\n\r\n    //animate arrow fall:\r\n    var _arrowFall = function _arrowFall($insert, callback){\r\n\r\n        var interval = null;\r\n        $insert.on('mouseenter', function(e){\r\n\r\n            var relY = e.pageY - $(this).offset().top\r\n                - parseInt($(this).find('.grid-edit-insert-triangle').outerHeight())\r\n                - parseInt($(this).find('.grid-edit-insert-square').outerHeight());\r\n\r\n            var $arrow = $(this).find('.grid-edit-insert-triangle, .grid-edit-insert-square');\r\n\r\n            var t = 0;\r\n            interval = setInterval(function(){\r\n                var top = 0.5 * 9.81 * Math.pow(t, 2) / 100;\r\n                $arrow.css('top', top);\r\n\r\n                if(top > relY){\r\n                    clearInterval(interval);\r\n                    callback();\r\n                }\r\n\r\n                t++;\r\n            }, 10);\r\n        }).on('mouseleave', function(){\r\n            $(this).find('.grid-edit-insert-triangle, .grid-edit-insert-square').css('top', 0);\r\n            clearInterval(interval);\r\n        });\r\n    };\r\n\r\n    return {\r\n        create : _buildArrows\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/targetFinder',[\r\n    'jquery',\r\n    'lodash',\r\n    'ui/ckeditor/dtdHandler',\r\n    'taoQtiItem/qtiCreator/helper/qtiElements'\r\n], function($, _, dtdHandler, qtiElements){\r\n    'use strict';\r\n\r\n    var _qtiHtmlEditableTypes = {\r\n        'itemBody' : '.widget-textBlock > [data-html-editable]',\r\n        'prompt' : '.qti-prompt[data-html-editable]',\r\n        'choice' : '.qti-choice [data-html-editable]'\r\n    };\r\n\r\n    /**\r\n     * Extends taoQtiItem/qtiCreator/editor/dtdHandler\r\n     * to retrieve a collection of jQuery elements within a given context\r\n     */\r\n    var targetFinder = (function($, _, dh){\r\n\r\n        /**\r\n         * Inherit functions from parent class\r\n         */\r\n        var inheritedFunctions = (function(){\r\n            var fns = {}, fn;\r\n            for(fn in dh){\r\n                if(!dh.hasOwnProperty(fn)){\r\n                    continue;\r\n                }\r\n                if(!(dh[fn] instanceof Function)){\r\n                    continue;\r\n                }\r\n                fns[fn] = dh[fn];\r\n            }\r\n            return fns;\r\n        }());\r\n\r\n        /**\r\n         * Find potential targets within a given context\r\n         *\r\n         * @param child\r\n         * @param context (string|DOM element|jQuery element), defaults to document.body\r\n         * @returns {*}\r\n         */\r\n        var getTargetsFor = function(qtiClass, context){\r\n\r\n            var child,\r\n                $qtiContainers,\r\n                $targets = $();\r\n\r\n            context = context || document.body;\r\n            context = $(context);\r\n\r\n            if(qtiElements.is(qtiClass, 'inlineInteraction')){\r\n\r\n                $qtiContainers = context.find(_qtiHtmlEditableTypes['itemBody']);\r\n                child = 'object';\r\n\r\n            }else{\r\n\r\n                $qtiContainers = context.find(_.values(_qtiHtmlEditableTypes).join(','));\r\n                $qtiContainers = context.find(_qtiHtmlEditableTypes['itemBody']);//beta limitation\r\n                switch(qtiClass){\r\n                    case 'math':\r\n                        child = 'object';\r\n                        break;\r\n                    case 'object.audio':\r\n                    case 'object.video':\r\n                        child = 'object';\r\n                        break;\r\n                    default:\r\n                        child = qtiClass;\r\n                }\r\n            }\r\n\r\n            var parents = dh.getParentsOf(child),\r\n                parentSelector = parents.join(',');\r\n\r\n            $qtiContainers.each(function(){\r\n\r\n                var $qtiContainer = $(this),\r\n                    $widget = $qtiContainer.closest('.widget-box');\r\n\r\n                if($qtiContainer.is(parentSelector)){\r\n                    $targets = $targets.add($qtiContainer);\r\n                }\r\n                $targets = $targets.add($qtiContainer.find(parentSelector).not(function(){\r\n                    var $closest = $(this).closest('.widget-box');\r\n                    return ($closest.length && $closest[0] !== $widget[0]);\r\n                }));\r\n            });\r\n\r\n            return $targets;\r\n        };\r\n\r\n        /**\r\n         * return both parent and own functions\r\n         */\r\n        return _.extend(inheritedFunctions, {\r\n            getTargetsFor : getTargetsFor\r\n        });\r\n\r\n    }($, _, dtdHandler));\r\n\r\n    return targetFinder;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiCreator/editor/gridEditor/droppable',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/helper/gridUnits',\r\n    'taoQtiItem/qtiCreator/helper/qtiElements',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/helper',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/arrow',\r\n    'taoQtiItem/qtiCreator/editor/targetFinder'\r\n], function($, _, gridUnits, qtiElements, helper, arrow, targetFinder){\r\n    \"use strict\";\r\n    var droppableGridEditor = {};\r\n\r\n    droppableGridEditor.createDroppableBlocks = function createDroppableBlocks(qtiClass, $el, options){\r\n\r\n        options = options || {};\r\n\r\n        var minUnits = (typeof options.min === 'string') ? options.min : 0,\r\n            $colInitial = (options.initialPosition instanceof $) ? options.initialPosition : null,\r\n            ns = options.namespace ? '.' + options.namespace : '',\r\n            data = options.data || {};\r\n\r\n        var $placeholder = $('<div>', {'id' : 'qti-block-element-placeholder', 'class' : 'qti-droppable-block-hover'}),\r\n        marginWidth = parseFloat($el.find('[class^=\"col-\"]:last, [class*=\" col-\"]:last').css('margin-left')),\r\n            isEmpty = ($el.children('.grid-row').length === 0);\r\n\r\n        //add dropping class (used to fix col-*:first margin issue);\r\n        $el.addClass('dropping');\r\n\r\n        //prepare tmp rows and cols\r\n        if(isEmpty){\r\n\r\n            $el.append(_getNewRow().append(_getNewCol().addClass('col-12')));\r\n\r\n        }else{\r\n\r\n            $el.find('.grid-row').each(function(){\r\n\r\n                var $row = $(this), cols = [];\r\n\r\n                //build tmp new cols:\r\n                var maxHeight = 0;\r\n                var $cols = $row.children(':not(.new-col)').each(function(){\r\n                    $(this).before(_getNewCol().attr('data-index', $(this).index() / 2));\r\n                    maxHeight = Math.max($(this).height(), maxHeight);\r\n                    cols.push({\r\n                        'elt' : $(this),\r\n                        'units' : parseInt($(this).attr('data-units'))\r\n                    });\r\n                });\r\n                $cols.last().after(_getNewCol().attr('data-index', 'last'));\r\n                $cols.height(maxHeight);\r\n\r\n                $row.data('distributed-units', gridUnits.distribute(cols, minUnits, 12));\r\n\r\n                //build tmp new rows:\r\n                $row.before(_getNewRow().append(_getNewCol()));\r\n\r\n            }).last().after(_getNewRow().append(_getNewCol()));\r\n        }\r\n\r\n        //append the dropping element placeholder:\r\n        var _appendPlaceholder = function($col){\r\n\r\n            if($col.length){\r\n\r\n                $placeholder\r\n                    .data('dropped', true)\r\n                    .show()\r\n                    .parent().removeClass('col-12')\r\n                    .parent().removeData('active');\r\n\r\n                $col.append($placeholder);\r\n\r\n            }else{\r\n                //insertion failed\r\n            }\r\n        };\r\n\r\n        //restore the dropping element placeholder back to its default location:\r\n        var _resetPlaceholder = function(){\r\n\r\n            $placeholder.parent().parent().removeData('active');\r\n\r\n            $placeholder\r\n                .removeData('dropped')\r\n                .hide();\r\n\r\n            $el.append($placeholder);\r\n        };\r\n\r\n        //function to be called for inter-column insertions:\r\n        var _insertBetween = function($col, location){\r\n\r\n            if(location === 'left' || location === 'right'){\r\n                _restoreTmpCol($el);\r\n                var $row = $col.parent().attr('data-active', true);\r\n\r\n                //store temporary the original classes before columns are resized\r\n                $row.children(':not(.new-col)').each(function(){\r\n                    $(this).attr('data-original-class', $(this).attr('class'));\r\n                });\r\n\r\n                var distributedUnits = $row.data('distributed-units');\r\n                var $newCol = (location === 'left') ? $col.prev() : $col.next();\r\n                _appendPlaceholder($newCol);\r\n\r\n                if(distributedUnits.refactoredTotalUnits > 12){\r\n                    //need to create a new row\r\n                    var newUnit = ($newCol.is(':last-child') && distributedUnits.last) ? distributedUnits.last : distributedUnits.middle;\r\n                    $newCol.attr('class', 'new-col col-' + newUnit);\r\n\r\n                    var cumulatedUnits = 0,\r\n                        index = $newCol.data('index');\r\n\r\n                    var _appendToNextRow = function _appendToNextRow($row, $newCol){\r\n                        $row.next().attr('data-active', true).append($newCol);\r\n                    };\r\n\r\n                    if(index === 'last'){\r\n                        _appendToNextRow($row, $newCol);\r\n                    }else{\r\n                        for(var i in distributedUnits.cols){\r\n\r\n                            if(i == index){//note: no strict comparison here\r\n                                if(cumulatedUnits + newUnit > 12){\r\n                                    _appendToNextRow($row, $newCol)\r\n                                }\r\n                                cumulatedUnits += newUnit;\r\n                            }\r\n\r\n                            var col = distributedUnits.cols[i];\r\n                            if(cumulatedUnits + col.refactoredUnits > 12){\r\n                                _appendToNextRow($row, col.elt);\r\n                            }\r\n                            col.elt.attr('class', 'col-' + col.refactoredUnits);\r\n                            cumulatedUnits += col.refactoredUnits;\r\n                        }\r\n                    }\r\n\r\n                }else{\r\n                    if($newCol.is(':last-child') && distributedUnits.last){\r\n                        $newCol.attr('class', 'new-col col-' + distributedUnits.last);\r\n                    }else{\r\n                        $newCol.attr('class', 'new-col col-' + distributedUnits.middle);\r\n                    }\r\n                    _.each(distributedUnits.cols, function(col){\r\n                        col.elt.attr('class', 'col-' + col.refactoredUnits);\r\n                    });\r\n                }\r\n\r\n                var h = _resetColsHeight($col);\r\n                $placeholder.css('height', '100%').parent().height(h);//causes issue on new-col sizes!\r\n            }\r\n        };\r\n\r\n        //recalculate the cols height according to new layout\r\n        var _resetColsHeight = function($col, self){\r\n\r\n            var maxHeight = 0;\r\n            if(self === undefined){\r\n                self = true;\r\n            }\r\n\r\n            $placeholder.css('height', 'auto').parent().removeAttr('style');//remove added height, to reset the height to auto\r\n\r\n            var $cols = $col.siblings('[class^=\"col-\"]:not(.new-col), [class*=\" col-\"]:not(.new-col)').andSelf();\r\n            $cols.removeAttr('style');//remove added height, to reset the height to auto\r\n            $cols.each(function(){\r\n                maxHeight = Math.max($(this).height(), maxHeight);\r\n            });\r\n\r\n            $cols.height(maxHeight);\r\n            if(!self){\r\n                $col.removeAttr('style');\r\n            }\r\n            return maxHeight;\r\n        };\r\n\r\n        _resetPlaceholder();\r\n\r\n        //manage initial positioning, useful in the \"move\" context\r\n        if($colInitial && $colInitial.length){\r\n\r\n            var $prev = $colInitial.prevAll('[class^=\"col-\"], [class*=\" col-\"]').first();\r\n            var $next = $colInitial.nextAll('[class^=\"col-\"], [class*=\" col-\"]').first();\r\n            if($prev.length){\r\n                _insertBetween($prev, 'right');\r\n            }else if($next.length){\r\n                _insertBetween($next, 'left');\r\n            }else{\r\n                //replace it self...\r\n            }\r\n        }\r\n\r\n        //bind all event handlers:\r\n        $el.on('mouseover.gridEdit.gridDragDrop', function(){\r\n\r\n            var $previousCol = $placeholder.parent('.new-col');\r\n            _restoreTmpCol($el);//restore tmp columns before reevaluating the heights\r\n            _resetColsHeight($previousCol, false);//recalculate the height of the previously located row\r\n\r\n            var $newCol = $el.find('.new-col:last').css('background', '1px solid red');\r\n            _appendPlaceholder($newCol);\r\n            $newCol.addClass('col-12');\r\n\r\n        }).on('mouseover.gridEdit.gridDragDrop', '.grid-row', function(e){\r\n\r\n            e.stopPropagation();\r\n\r\n        }).on('mouseenter.gridEdit.gridDragDrop', '[class^=\"col-\"]:not(.new-col), [class*=\" col-\"]:not(.new-col)', function(e){\r\n\r\n            var $col = $(this), $previousCol = $placeholder.parent('.new-col');\r\n\r\n            _resetPlaceholder();//remove the placeholder from the previous location\r\n            _restoreTmpCol($el);//restore tmp columns before reevaluating the heights\r\n\r\n            _resetColsHeight($previousCol, false);//recalculate the height of the previously located row\r\n            _resetColsHeight($col);//recalculate the height for the current row\r\n\r\n            arrow.create($col, {marginWidth : marginWidth});\r\n\r\n        }).on('arrowenter.gridEdit.gridDragDrop', '[class^=\"col-\"]:not(.new-col), [class*=\" col-\"]:not(.new-col)', function(e, position){\r\n\r\n            _insertBetween($(this), position);\r\n\r\n        }).on('mousemove.gridEdit.gridDragDrop', '[class^=\"col-\"]:not(.new-col), [class*=\" col-\"]:not(.new-col)', _.throttle(function(e){\r\n\r\n            //insert element above or below the col's row:\r\n            var $col = $(this),\r\n                h = $col.height(),\r\n                relY = e.pageY - $col.offset().top;\r\n\r\n            //insert on top or bottom:\r\n            var $newRow = (relY < h / 2) ? $col.parent().prev() : $col.parent().next();\r\n            if(!$newRow.find('#qti-block-element-placeholder').length){//append row only not already included\r\n                var $newCol = $newRow.attr('data-active', true).children('.new-col').addClass('col-12');\r\n                if($newCol.length){\r\n                    _appendPlaceholder($newCol);\r\n                }else{\r\n                    console.log('insert form col failure ', $col, $newRow);\r\n                }\r\n            }\r\n\r\n        }, 100)).on('mouseleave.gridEdit.gridDragDrop', '[class^=\"col-\"], [class*=\" col-\"]', function(e){\r\n\r\n            //destroy inter-column insertion helper\r\n            e.stopPropagation();\r\n            $(this).find('.grid-edit-insert-box').remove();\r\n\r\n        }).on('mouseleave.gridEdit.gridDragDrop', function(){\r\n\r\n            //restore dom when the mouse leaves the drop area \"$el\":\r\n            $placeholder.hide();\r\n            _resetPlaceholder();\r\n            _restoreTmpCol($el);\r\n\r\n        });\r\n\r\n        //listen to the end of the dragging\r\n        //on element drop (mouseout in the drop area $el)\r\n        $el.one('dragoverstop.gridEdit', function(){\r\n\r\n            $el.off('.gridEdit.gridDragDrop');\r\n\r\n            var $selectedCol = $placeholder.parent('.new-col'),\r\n                dropped = !!$selectedCol.length;\r\n\r\n            if(dropped){//has been properly dropped:\r\n\r\n                //make the placeholder permanent\r\n                $placeholder.removeAttr('id').removeClass('qti-droppable-block-hover');\r\n\r\n                //make the dropped col permanent\r\n                $selectedCol\r\n                    .data('qti-class', qtiClass)\r\n                    .removeClass('new-col')\r\n                    .removeAttr('data-index');\r\n\r\n                helper.setUnitsFromClass($selectedCol);\r\n\r\n                //make the dropped row permanent\r\n                $selectedCol.parent('.grid-row-new').removeClass('grid-row-new');\r\n\r\n                //manage the temp grid-new-row:\r\n                $el.find('.grid-row[data-active=true]').each(function(){\r\n\r\n                    var $row = $(this);\r\n\r\n                    $row.removeClass('grid-row-new');\r\n\r\n                    //make the modified  col-n class permanent and update data attribute \"data-units\"\r\n                    $row.children(':not(.new-col)').removeAttr('data-original-class').each(function(){\r\n                        helper.setUnitsFromClass($(this));\r\n                    });\r\n                });\r\n            }\r\n\r\n            _destroyDroppableBlocks($el);\r\n\r\n            if(dropped && $placeholder.data('dropped')){\r\n                //trigger dropped event\r\n                $el.trigger('dropped.gridEdit' + ns, [qtiClass, $placeholder, data]);\r\n            }\r\n\r\n        });\r\n\r\n    };\r\n\r\n    var _mapQtiToHtml = function _mapQtiToHtml(qtiClass){\r\n\r\n        if(qtiElements.is(qtiClass, 'inlineInteraction')){\r\n            return 'object';//an inlineInteraction is a flow, like xhtml \"object\" elements\r\n        }else{\r\n            switch(qtiClass){\r\n                case 'math':\r\n                    return 'div';\r\n                case 'object.audio':\r\n                case 'object.video':\r\n                    return 'object';\r\n            }\r\n        }\r\n\r\n        //else return the html itself : a qti img is an img:\r\n        return qtiClass;\r\n    };\r\n\r\n    var _pulseTimer = null;\r\n    var _pulse = function($el){\r\n\r\n        if(_pulseTimer){\r\n            clearInterval(_pulseTimer);\r\n        }\r\n        var intervalDuration = 1000;\r\n\r\n        setInterval(function(){\r\n\r\n            $el.animate({\r\n                opacity : 0.1\r\n            }, intervalDuration * 0.5, function(){\r\n                $el.animate({\r\n                    opacity : 0.9\r\n                }, intervalDuration * 0.5);\r\n            });\r\n\r\n        }, intervalDuration);\r\n\r\n    };\r\n\r\n    droppableGridEditor.createDroppableInlines = function createDroppableInlines(qtiClass, $el, options){\r\n\r\n        var ns = options.namespace ? '.' + options.namespace : '',\r\n            data = options.data || {},\r\n            $targets = targetFinder.getTargetsFor(qtiClass, $el),\r\n            dropped = false;\r\n\r\n        $targets.addClass('drop-target');\r\n\r\n        $targets.contents().each(function(){\r\n            //a text node\r\n            if(this.nodeType === 3 && !this.nodeValue.match(/^\\s+$/)){\r\n                $(this).replaceWith($.map(this.nodeValue.split(/(\\S+)/), function(w){\r\n                    return w.match(/^\\s*$/) ? document.createTextNode(w) : $('<span>', {'text' : w, 'class' : 'qti-word-wrap'}).get();\r\n                }));\r\n            }\r\n        });\r\n\r\n        var $placeholder = $('<span>', {'id' : 'qti-inline-element-placeholder', 'data-inline' : true});\r\n        $placeholder.append($('<span>', {'class' : 'cursor-h'})).append($('<span>', {'class' : 'cursor-v'}));\r\n        _pulse($placeholder);\r\n        var _resetPlaceholder = function($el){\r\n            $placeholder.detach();\r\n            dropped = false;\r\n        };\r\n        _resetPlaceholder($el);\r\n\r\n        var _showPlaceholder = function(){\r\n            dropped = true;\r\n            return $placeholder;\r\n        };\r\n\r\n        $el.on('mousemove.gridEdit.gridDragDrop', 'span.qti-word-wrap', function(e){\r\n\r\n            var w = $(this).width(),\r\n                parentOffset = $(this).offset(),\r\n                relX = e.pageX - parentOffset.left;\r\n\r\n            $placeholder;\r\n            if(relX < w / 2){\r\n                $(this).before(_showPlaceholder());\r\n            }else{\r\n                $(this).after(_showPlaceholder());\r\n            }\r\n\r\n        }).on('mouseover.gridEdit.gridDragDrop', function(e){\r\n            \r\n            e.stopPropagation();\r\n            var $target = $(e.target);\r\n            \r\n            if($target.hasClass('drop-target') && !$target.find($placeholder).length){\r\n                \r\n                //make first insertion easier\r\n                $target.append(_showPlaceholder());\r\n                \r\n            }else if($target[0] !== $placeholder[0]\r\n                && !$target.hasClass('qti-word-wrap')\r\n                && !$target.children('.qti-word-wrap').length){\r\n\r\n                _resetPlaceholder($el);\r\n            }\r\n        });\r\n\r\n        //listen to the end of the dragging \r\n        $el.one('dragoverstop.gridEdit', function(){\r\n            \r\n            //make placeholder permanent\r\n            if(dropped){\r\n                $placeholder.removeAttr('id').removeAttr('class');\r\n            }\r\n\r\n            //destroy droppable\r\n            _destroyDroppableInlines($el);\r\n\r\n            //call callback function:\r\n            if(dropped){\r\n                $el.trigger('dropped.gridEdit' + ns, [qtiClass, $placeholder, data]);\r\n            }else{\r\n                //clean up :\r\n                $placeholder.remove();\r\n                $placeholder = null;\r\n            }\r\n        });\r\n    };\r\n\r\n    droppableGridEditor.destroyDroppables = function destroyDroppables($el){\r\n\r\n        _destroyDroppableInlines($el);\r\n        _destroyDroppableBlocks($el);\r\n    };\r\n\r\n    var _destroyDroppableInlines = function($el){\r\n\r\n        $el.off('.gridEdit.gridDragDrop');\r\n\r\n        $el.find('span.qti-word-wrap').replaceWith(function(){\r\n            return $(this).text();\r\n        });\r\n        \r\n        $el.find('.drop-target').removeClass('drop-target');\r\n    };\r\n\r\n    var _destroyDroppableBlocks = function($el){\r\n\r\n        $el.removeClass('dropping').off('.gridEdit.gridDragDrop');\r\n\r\n        $el.find('[class^=\"col-\"], [class*=\" col-\"]').removeAttr('style');\r\n\r\n        _restoreTmpCol($el);\r\n\r\n        var _toBeRemoved = [\r\n            '#qti-block-element-placeholder',\r\n            '.new-col',\r\n            '.grid-row-new',\r\n            '.grid-edit-insert-box'\r\n        ];\r\n\r\n        $el.find(_toBeRemoved.join(',')).remove();\r\n\r\n    };\r\n\r\n    var _getNewRow = function _getNewRow(){\r\n        return $('<div>', {'class' : 'grid-row grid-row-new', 'data-units' : 0});\r\n    };\r\n\r\n    var _getNewCol = function _getNewCol(){\r\n        return $('<div>', {'class' : 'new-col'});\r\n    };\r\n\r\n    var _restoreTmpCol = function _restoreTmpCol($el){\r\n        $el.find('.grid-row').each(function(){\r\n            var $row = $(this);\r\n            $row.children('.new-col').attr('class', 'new-col').removeAttr('style');//reset all column\r\n\r\n            //restore location of overflown cols\r\n            if($row.hasClass('grid-row-new')){\r\n                var $children = $row.children();\r\n                if($children.length > 1){\r\n                    $row.prev().append($children);\r\n                    $row.append($children.first());\r\n                }\r\n            }\r\n\r\n            //restore original classes\r\n            $row.children(':not(.new-col)').each(function(){\r\n                var $col = $(this), originalClasses = $col.attr('data-original-class');\r\n                if(originalClasses){\r\n                    $col.attr('class', originalClasses).removeAttr('data-original-class');\r\n                }\r\n            });\r\n            $row.removeAttr('data-active');\r\n        });\r\n    };\r\n\r\n    return droppableGridEditor;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/gridEditor/draggable',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/helper/qtiElements',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/droppable',\r\n    'jqueryui'\r\n], function($, _, QtiElements, droppable){\r\n    \"use strict\";\r\n    var _insertableDefaultsOptions = {\r\n        helper : function(){\r\n            return $(this).clone();\r\n        }\r\n    };\r\n\r\n    var createInsertable = function createInsertable($el, $to, opts){\r\n\r\n        var options = _.defaults(opts, _insertableDefaultsOptions);\r\n\r\n        createDraggable($el, $to, {\r\n            helper : options.helper,\r\n            namespace : 'insertable'\r\n        });\r\n    };\r\n\r\n    var createDraggable = function createDraggable($el, $to, opts){\r\n\r\n        var options = _.defaults(opts, {\r\n            distance : 1,\r\n            helper : 'original'\r\n        });\r\n\r\n        $el.draggable({\r\n            distance : parseInt(options.distance),\r\n            helper : options.helper,\r\n           // appendTo : $('#item-editor-panel'), // @TODO needs to be set to $to => very important ! to enable movable correct positioning\r\n            // this will create the issue that elements dragged from the sidebar will be UNDER the sidebar\r\n            // so far no solution found (before scroll-new scroll bar r.XXX)\r\n            appendTo : $(document.body), // @TODO needs to be set to $to => very important ! to enable movable correct positioning\r\n                                         // this will create the issue that elements dragged from the sidebar will be UNDER the sidebar\r\n                                         // so far no solution found\r\n            opacity : 1,\r\n            scroll : false,\r\n            cursor : 'crosshair',\r\n            cursorAt : {left : -5, bottom : -5},\r\n            create : function(){\r\n                $(this).addClass('grid-draggable');\r\n            },\r\n            start : function(e, ui){\r\n                \r\n                $to.trigger('beforedragoverstart.gridEdit');\r\n\r\n                if(typeof(options.start) === 'function'){\r\n                    options.start.call(this, e, ui);\r\n                }\r\n\r\n                $(this).removeClass('grid-draggable-active');\r\n\r\n                //define the type of draggable block/inline?\r\n                var qtiClass = $(this).data('qti-class');\r\n                if(QtiElements.isInline(qtiClass)){\r\n                    droppable.createDroppableInlines(qtiClass, $to, options);\r\n                }else if(QtiElements.isBlock(qtiClass)){\r\n                    droppable.createDroppableBlocks(qtiClass, $to, options);\r\n                }else{\r\n                    throw 'undefined qti class';\r\n                }\r\n\r\n                $to.trigger('dragoverstart.gridEdit');\r\n            },\r\n            stop : function(e, ui){\r\n                \r\n                //restore dom:\r\n                $('body').css('cursor', 'auto');\r\n                \r\n                //no longer needed\r\n                ui.helper.remove();\r\n                \r\n                //fire \"stop\" events\r\n                \r\n                if(typeof(options.stop) === 'function'){\r\n                    options.stop.call(this, e, ui);\r\n                }\r\n\r\n                $to.trigger('dragoverstop.gridEdit');\r\n            }\r\n        });\r\n\r\n        $el.on('mousedown.gridDraggable.gridEdit', function(){\r\n            $(this).addClass('grid-draggable-active');\r\n        }).on('mouseup.gridDraggable.gridEdit', function(){\r\n            $(this).removeClass('grid-draggable-active');\r\n        });\r\n    };\r\n\r\n    var createMovable = function createMovable($el, $to){\r\n\r\n        var $parent = $el.parent('[class^=\"col-\"], [class*=\" col-\"]');\r\n        createDraggable($el, $to, {\r\n            distance : 5,\r\n            initialPosition : $el.parent(),\r\n            namespace : 'movable',\r\n            start : function(e, ui){\r\n\r\n                $el.hide();\r\n\r\n                $parent.data({\r\n                    'initial-position' : true,\r\n                    'initial-class' : $parent.attr('class')\r\n                }).attr('class', 'new-col');\r\n            },\r\n            helper : function(){\r\n\r\n                return $(this).clone()\r\n                    .addClass('grid-draggable-helper')\r\n                    .css({\r\n                    height : $(this).height(),\r\n                    width : $(this).width()\r\n                });\r\n            },\r\n            stop : function(e, ui){\r\n\r\n                //restore initial position if given:\r\n                if(!$el.data('grid-element-dropped')){\r\n                    $parent.attr('class', $parent.data('initial-class'));\r\n                }\r\n\r\n                //re-init the dropped value:\r\n                $el.data('grid-element-dropped', false);\r\n//                $el.removeData('grid-element-dropped');\r\n\r\n                //show it\r\n                $el.show();\r\n\r\n            },\r\n            data : {\r\n                widget : $el.data('widget')\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    var _destroyDraggables = function _destroyDraggables($el){\r\n        $el.draggable('destroy');\r\n        $el.removeClass('grid-draggable');\r\n        $el.off('.gridDraggable');\r\n    };\r\n\r\n    return {\r\n        createInsertable : function($el, $to, opts){\r\n            createInsertable($el, $to, opts);\r\n        },\r\n        createMovable : function($el, $to, opts){\r\n            createMovable($el, $to, opts);\r\n        },\r\n        destroy : _destroyDraggables\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/infoControlRegistry',[\r\n    'taoQtiItem/portableElementRegistry/icRegistry'\r\n], function(icRegistry){\r\n    \"use strict\";\r\n\r\n    console.warn('deprected use of \"taoQtiItem/qtiCreator/editor/infoControlRegistry\", please use \"taoQtiItem/portableElementRegistry/icRegistry\" now');\r\n\r\n    return {\r\n        get : function get(id){\r\n            var portableElement = {};\r\n            portableElement.manifest = icRegistry.get(id);\r\n            return portableElement;\r\n        }\r\n    }\r\n});\n","define('taoQtiItem/qtiCreator/editor/jquery.gridEditor',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/helper',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/draggable',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/resizable'\r\n], function($, helper, contentHelper, draggable, resizable) {\r\n\r\n    'use strict';\r\n\r\n    $.fn.gridEditor = function(options) {\r\n\r\n        var opts = {};\r\n        var method = '';\r\n        var args = [];\r\n        var ret = undefined;\r\n        if (typeof options === 'object') {\r\n            opts = $.extend({}, $.fn.gridEditor.defaults, options);\r\n        } else if (options === undefined) {\r\n            opts = $.extend({}, $.fn.gridEditor.defaults);//use default\r\n        } else if (typeof options === 'string') {\r\n            if (typeof methods[options] === 'function') {\r\n                method = options;\r\n                args = Array.prototype.slice.call(arguments, 1);\r\n            }\r\n        }\r\n\r\n        this.each(function() {\r\n            var $this = $(this);\r\n            if (method) {\r\n                if (isCreated($this)) {\r\n                    ret = methods[method].apply($(this), args);\r\n                } else {\r\n                    $.error('call of method of gridEditor while it has not been initialized');\r\n                }\r\n            } else if (!isCreated($this) && typeof opts === 'object') {\r\n                create($this, opts);\r\n            }\r\n        });\r\n\r\n        if (ret === undefined) {\r\n            return this;\r\n        } else {\r\n            return ret;\r\n        }\r\n    };\r\n\r\n    $.fn.gridEditor.defaults = {\r\n        'elementClass': 'itemBody'\r\n    };\r\n\r\n    var methods = {\r\n        addInsertables: function($elts, options) {\r\n            var $grid = $(this);\r\n            $elts.each(function() {\r\n                draggable.createInsertable($(this), $grid, options);\r\n            });\r\n        },\r\n        createMovables: function($elts) {\r\n            var $grid = $(this);\r\n            $elts.each(function() {\r\n                draggable.createMovable($(this), $grid);\r\n            });\r\n        },\r\n        destroy: function() {\r\n            destroy($(this));\r\n        },\r\n        getContent: function() {\r\n            return getContent($(this));\r\n        },\r\n        setContent: function(content) {\r\n            if (content) {\r\n                setContent($(this), content);\r\n            }\r\n        },\r\n        resizable: function() {\r\n            resizable.create($(this));\r\n        }\r\n    };\r\n\r\n    function isCreated($elt) {\r\n        return (typeof $elt.data('qti-grid-options') === 'object');\r\n    }\r\n\r\n    function create($elt, options) {\r\n\r\n        $elt.data('qti-grid-options', options);\r\n\r\n        //initialize grid count\r\n        $elt.find('.grid-row').each(function() {\r\n            var totalUnits = 0;\r\n            $(this).children('[class*=\" col-\"], [class^=\"col-\"]').each(function() {\r\n                totalUnits += helper.setUnitsFromClass($(this));\r\n            });\r\n//            $(this).attr('data-units', parseInt(totalUnits));//useless??\r\n        });\r\n    }\r\n\r\n    function destroy($elt) {\r\n        contentHelper.destroyGridWidgets($elt);\r\n    }\r\n\r\n    function getContent($el) {\r\n        return contentHelper.getContent($el);\r\n    }\r\n\r\n});\n","define('taoQtiItem/qtiCreator/editor/MathEditor',[\r\n    'lodash',\r\n    'jquery',\r\n    'mathJax',\r\n    'ui/feedback'\r\n], function(_, $, MathJax, feedback){\r\n    \"use strict\";\r\n    var MathEditor = function MathEditor(config){\r\n\r\n        config = config || {};\r\n\r\n        this.setMathML(config.mathML || '');\r\n        this.tex = config.tex || '';\r\n        this.display = config.display || 'inline';\r\n\r\n        //computed, system variables:\r\n        this.processing = false;\r\n        this.$target = config.target || $();\r\n\r\n        if(config.buffer && config.buffer instanceof $ && config.buffer.length){\r\n            this.$buffer = config.buffer;\r\n        }else{\r\n            throw 'missing required element in config \"buffer\"';\r\n        }\r\n    };\r\n\r\n    MathEditor.prototype.setMathML = function(mathMLstr){\r\n\r\n        mathMLstr = _stripMathTags(mathMLstr);\r\n        mathMLstr = _stripComments(mathMLstr);\r\n        this.mathML = mathMLstr;\r\n\r\n        return this;//for chaining purpose\r\n    };\r\n\r\n    MathEditor.prototype.setTex = function(texStr){\r\n\r\n        this.tex = texStr;\r\n\r\n        //need to run renderFromTex\r\n\r\n        return this;//for chaining purpose\r\n    };\r\n\r\n    var _processArguments = function(mathEditor, args){\r\n\r\n\r\n        var ret = {\r\n            target : null,\r\n            callback : null\r\n        };\r\n\r\n        _.each(args, function(arg){\r\n            if(_.isFunction(arg)){\r\n                ret.callback = arg;\r\n            }else if(arg instanceof $){\r\n                ret.target = arg;\r\n            }\r\n        });\r\n\r\n        if(!ret.target){\r\n            if(mathEditor.$target){\r\n                ret.target = mathEditor.$target;\r\n            }else{\r\n                throw 'no target defined for rendering';\r\n            }\r\n        }\r\n\r\n        return ret;\r\n    };\r\n\r\n    MathEditor.prototype.renderFromMathML = function(){\r\n\r\n        var args = _processArguments(this, arguments);\r\n\r\n        if(typeof(MathJax) !== 'undefined'){\r\n\r\n            if(this.processing){\r\n                return;\r\n            }\r\n            var jaxQueue = MathJax.Hub.queue;\r\n            var mathStr = _wrapMathTags(this.mathML, (this.display === 'block'));\r\n            this.$buffer.html(mathStr);\r\n\r\n            var _this = this;\r\n            jaxQueue.Push(\r\n                [\"Typeset\", MathJax.Hub, this.$buffer[0]],\r\n                function(){\r\n                    var $script = _this.$buffer.find('script');\r\n\r\n                    _this.processing = false;\r\n\r\n                    args.target.html(_this.$buffer.html());\r\n\r\n                    if ($script.length){\r\n                        _this.mathML = _stripMathTags($script.html());\r\n                    }\r\n\r\n                    _this.$buffer.empty();\r\n                }\r\n            );\r\n\r\n            if(args.callback){\r\n                jaxQueue.Push(args.callback);\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    MathEditor.prototype.renderFromTex = function(){\r\n\r\n        var args = _processArguments(this, arguments);\r\n        var _this = this;\r\n        var jaxQueue = MathJax.Hub.queue;\r\n\r\n        if(typeof (MathJax) !== 'undefined'){\r\n\r\n            if(this.display === 'block'){\r\n                _this.$buffer.text('\\\\[\\\\displaystyle{' + _this.tex + '}\\\\]');\r\n            }else{\r\n                _this.$buffer.text('\\\\(\\\\displaystyle{' + _this.tex + '}\\\\)');\r\n            }\r\n\r\n            //render preview:\r\n            jaxQueue.Push(\r\n                //programmatically typeset the buffer\r\n                    ['Typeset', MathJax.Hub, _this.$buffer[0]],\r\n                    function(){\r\n                        var texJax;\r\n                        try {\r\n                            //replace the target element\r\n                            args.target.html(_this.$buffer.html());\r\n\r\n                            //store mathjax \"tex\", for tex for later mathML conversion\r\n                            texJax = _getJaxByElement(_this.$buffer);\r\n\r\n                            //empty buffer;\r\n                            _this.$buffer.empty();\r\n\r\n                            //sync MathML\r\n                            if (typeof (texJax) !== 'undefined') {\r\n                                _this.texToMathML(texJax, function (mathML) {\r\n                                    _this.setMathML(_stripMathTags(mathML));\r\n                                });\r\n                            }\r\n                        } catch (err) {\r\n                            feedback().error('Mathjax error: ' + err.message);\r\n                        }\r\n                    }\r\n                );\r\n\r\n                if(args.callback){\r\n                    jaxQueue.Push(args.callback);\r\n                }\r\n            }\r\n\r\n        };\r\n\r\n        var _stripMathTags = function(mathMLstr){\r\n\r\n            mathMLstr = mathMLstr.replace(/<(\\/)?math[^>]*>/g, '');\r\n            mathMLstr = mathMLstr.replace(/^\\s*[\\r\\n]/gm, '');//remove first blank line\r\n            mathMLstr = mathMLstr.replace(/\\s*[\\r\\n]$/gm, '');//last blank line\r\n\r\n            return mathMLstr;\r\n        };\r\n\r\n        var _stripComments = function(mathMLstr) {\r\n            mathMLstr = mathMLstr.replace(/<!--.*?-->/g, '');\r\n            mathMLstr = mathMLstr.replace(/&lt;!--.*?--&gt;/g, '');\r\n\r\n            return mathMLstr;\r\n        };\r\n\r\n        var _getJaxByElement = function($element){\r\n\r\n            if($element instanceof $ && $element.length){\r\n                var $script = $element.find('script');\r\n                if($script.length && $script[0].MathJax && $script[0].MathJax.elementJax){\r\n                    return $script[0].MathJax.elementJax;\r\n                }\r\n            }\r\n        };\r\n\r\n        var _wrapMathTags = function(mathMLstr, displayBlock){\r\n\r\n            if(!mathMLstr.match(/<math[^>]*>/)){\r\n                var display = displayBlock ? ' display=\"block\"' : '';\r\n                mathMLstr = '<math' + display + '>' + mathMLstr;//always show preview in block mode\r\n            }\r\n            if(!mathMLstr.match(/<\\/math[^>]*>/)){\r\n                mathMLstr += '</math>';\r\n            }\r\n\r\n            return mathMLstr;\r\n        };\r\n\r\n        MathEditor.prototype.texToMathML = function(texJax, callback){\r\n\r\n            var _this = this;\r\n            var mathML = '';\r\n\r\n            try{\r\n                mathML = _stripComments(texJax.root.toMathML(''));\r\n            }catch(err){\r\n                if(!err.restart){\r\n                    throw err;\r\n                }\r\n                return MathJax.Callback.After(function(){\r\n                    _this.texToMathML(texJax, callback);\r\n                }, err.restart);\r\n            }\r\n\r\n            MathJax.Callback(callback)(mathML);\r\n        };\r\n\r\n        return MathEditor;\r\n    });\r\n\n","/**\r\n * ORGINAL VERSION:\r\n * MathQuill v0.10.1               http://mathquill.com\r\n * by Han, Jeanine, and Mary  maintainers@mathquill.com\r\n *\r\n * This Source Code Form is subject to the terms of the\r\n * Mozilla Public License, v. 2.0. If a copy of the MPL\r\n * was not distributed with this file, You can obtain\r\n * one at http://mozilla.org/MPL/2.0/.\r\n *\r\n * MODIFIED VERSION:\r\n * @author Christophe Noël <christophe@taotesting.com> for OAT SA in 2017\r\n * - wrap in a AMD module\r\n * - Disabled eslint warnings\r\n */\r\n/* eslint-disable */\r\ndefine('taoQtiItem/lib/mathquill/mathquill',['jquery'], function(jQuery) {\r\n    var undefined,\r\n        mqCmdId = 'mathquill-command-id',\r\n        mqBlockId = 'mathquill-block-id',\r\n        min = Math.min,\r\n        max = Math.max;\r\n\r\n    function noop() {}\r\n\r\n    /**\r\n     * A utility higher-order function that makes defining variadic\r\n     * functions more convenient by letting you essentially define functions\r\n     * with the last argument as a splat, i.e. the last argument \"gathers up\"\r\n     * remaining arguments to the function:\r\n     *   var doStuff = variadic(function(first, rest) { return rest; });\r\n     *   doStuff(1, 2, 3); // => [2, 3]\r\n     */\r\n    var __slice = [].slice;\r\n    function variadic(fn) {\r\n        var numFixedArgs = fn.length - 1;\r\n        return function() {\r\n            var args = __slice.call(arguments, 0, numFixedArgs);\r\n            var varArg = __slice.call(arguments, numFixedArgs);\r\n            return fn.apply(this, args.concat([ varArg ]));\r\n        };\r\n    }\r\n\r\n    /**\r\n     * A utility higher-order function that makes combining object-oriented\r\n     * programming and functional programming techniques more convenient:\r\n     * given a method name and any number of arguments to be bound, returns\r\n     * a function that calls it's first argument's method of that name (if\r\n     * it exists) with the bound arguments and any additional arguments that\r\n     * are passed:\r\n     *   var sendMethod = send('method', 1, 2);\r\n     *   var obj = { method: function() { return Array.apply(this, arguments); } };\r\n     *   sendMethod(obj, 3, 4); // => [1, 2, 3, 4]\r\n     *   // or more specifically,\r\n     *   var obj2 = { method: function(one, two, three) { return one*two + three; } };\r\n     *   sendMethod(obj2, 3); // => 5\r\n     *   sendMethod(obj2, 4); // => 6\r\n     */\r\n    var send = variadic(function(method, args) {\r\n        return variadic(function(obj, moreArgs) {\r\n            if (method in obj) return obj[method].apply(obj, args.concat(moreArgs));\r\n        });\r\n    });\r\n\r\n    /**\r\n     * A utility higher-order function that creates \"implicit iterators\"\r\n     * from \"generators\": given a function that takes in a sole argument,\r\n     * a \"yield_\" function, that calls \"yield_\" repeatedly with an object as\r\n     * a sole argument (presumably objects being iterated over), returns\r\n     * a function that calls it's first argument on each of those objects\r\n     * (if the first argument is a function, it is called repeatedly with\r\n     * each object as the first argument, otherwise it is stringified and\r\n     * the method of that name is called on each object (if such a method\r\n     * exists)), passing along all additional arguments:\r\n     *   var a = [\r\n     *     { method: function(list) { list.push(1); } },\r\n     *     { method: function(list) { list.push(2); } },\r\n     *     { method: function(list) { list.push(3); } }\r\n     *   ];\r\n     *   a.each = iterator(function(yield_) {\r\n *     for (var i in this) yield_(this[i]);\r\n *   });\r\n     *   var list = [];\r\n     *   a.each('method', list);\r\n     *   list; // => [1, 2, 3]\r\n     *   // Note that the for-in loop will yield 'each', but 'each' maps to\r\n     *   // the function object created by iterator() which does not have a\r\n     *   // .method() method, so that just fails silently.\r\n     */\r\n    function iterator(generator) {\r\n        return variadic(function(fn, args) {\r\n            if (typeof fn !== 'function') fn = send(fn);\r\n            var yield_ = function(obj) { return fn.apply(obj, [ obj ].concat(args)); };\r\n            return generator.call(this, yield_);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * sugar to make defining lots of commands easier.\r\n     * TODO: rethink this.\r\n     */\r\n    function bind(cons /*, args... */) {\r\n        var args = __slice.call(arguments, 1);\r\n        return function() {\r\n            return cons.apply(this, args);\r\n        };\r\n    }\r\n\r\n    /**\r\n     * a development-only debug method.  This definition and all\r\n     * calls to `pray` will be stripped from the minified\r\n     * build of mathquill.\r\n     *\r\n     * This function must be called by name to be removed\r\n     * at compile time.  Do not define another function\r\n     * with the same name, and only call this function by\r\n     * name.\r\n     */\r\n    function pray(message, cond) {\r\n        if (!cond) throw new Error('prayer failed: '+message);\r\n    }\r\n    var P = (function(prototype, ownProperty, undefined) {\r\n        // helper functions that also help minification\r\n        function isObject(o) { return typeof o === 'object'; }\r\n        function isFunction(f) { return typeof f === 'function'; }\r\n\r\n        // used to extend the prototypes of superclasses (which might not\r\n        // have `.Bare`s)\r\n        function SuperclassBare() {}\r\n\r\n        return function P(_superclass /* = Object */, definition) {\r\n            // handle the case where no superclass is given\r\n            if (definition === undefined) {\r\n                definition = _superclass;\r\n                _superclass = Object;\r\n            }\r\n\r\n            // C is the class to be returned.\r\n            //\r\n            // It delegates to instantiating an instance of `Bare`, so that it\r\n            // will always return a new instance regardless of the calling\r\n            // context.\r\n            //\r\n            //  TODO: the Chrome inspector shows all created objects as `C`\r\n            //        rather than `Object`.  Setting the .name property seems to\r\n            //        have no effect.  Is there a way to override this behavior?\r\n            function C() {\r\n                var self = new Bare;\r\n                if (isFunction(self.init)) self.init.apply(self, arguments);\r\n                return self;\r\n            }\r\n\r\n            // C.Bare is a class with a noop constructor.  Its prototype is the\r\n            // same as C, so that instances of C.Bare are also instances of C.\r\n            // New objects can be allocated without initialization by calling\r\n            // `new MyClass.Bare`.\r\n            function Bare() {}\r\n            C.Bare = Bare;\r\n\r\n            // Set up the prototype of the new class.\r\n            var _super = SuperclassBare[prototype] = _superclass[prototype];\r\n            var proto = Bare[prototype] = C[prototype] = C.p = new SuperclassBare;\r\n\r\n            // other variables, as a minifier optimization\r\n            var extensions;\r\n\r\n\r\n            // set the constructor property on the prototype, for convenience\r\n            proto.constructor = C;\r\n\r\n            C.mixin = function(def) {\r\n                Bare[prototype] = C[prototype] = P(C, def)[prototype];\r\n                return C;\r\n            }\r\n\r\n            return (C.open = function(def) {\r\n                extensions = {};\r\n\r\n                if (isFunction(def)) {\r\n                    // call the defining function with all the arguments you need\r\n                    // extensions captures the return value.\r\n                    extensions = def.call(C, proto, _super, C, _superclass);\r\n                }\r\n                else if (isObject(def)) {\r\n                    // if you passed an object instead, we'll take it\r\n                    extensions = def;\r\n                }\r\n\r\n                // ...and extend it\r\n                if (isObject(extensions)) {\r\n                    for (var ext in extensions) {\r\n                        if (ownProperty.call(extensions, ext)) {\r\n                            proto[ext] = extensions[ext];\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // if there's no init, we assume we're inheriting a non-pjs class, so\r\n                // we default to applying the superclass's constructor.\r\n                if (!isFunction(proto.init)) {\r\n                    proto.init = _superclass;\r\n                }\r\n\r\n                return C;\r\n            })(definition);\r\n        }\r\n\r\n        // as a minifier optimization, we've closured in a few helper functions\r\n        // and the string 'prototype' (C[p] is much shorter than C.prototype)\r\n    })('prototype', ({}).hasOwnProperty);\r\n    /*************************************************\r\n     * Base classes of edit tree-related objects\r\n     *\r\n     * Only doing tree node manipulation via these\r\n     * adopt/ disown methods guarantees well-formedness\r\n     * of the tree.\r\n     ************************************************/\r\n\r\n// L = 'left'\r\n// R = 'right'\r\n//\r\n// the contract is that they can be used as object properties\r\n// and (-L) === R, and (-R) === L.\r\n    var L = -1;\r\n    var R = 1;\r\n\r\n    function prayDirection(dir) {\r\n        pray('a direction was passed', dir === L || dir === R);\r\n    }\r\n\r\n    /**\r\n     * Tiny extension of jQuery adding directionalized DOM manipulation methods.\r\n     *\r\n     * Funny how Pjs v3 almost just works with `jQuery.fn.init`.\r\n     *\r\n     * jQuery features that don't work on $:\r\n     *   - jQuery.*, like jQuery.ajax, obviously (Pjs doesn't and shouldn't\r\n     *                                            copy constructor properties)\r\n     *\r\n     *   - jQuery(function), the shortcut for `jQuery(document).ready(function)`,\r\n     *     because `jQuery.fn.init` is idiosyncratic and Pjs doing, essentially,\r\n     *     `jQuery.fn.init.apply(this, arguments)` isn't quite right, you need:\r\n     *\r\n     *       _.init = function(s, c) { jQuery.fn.init.call(this, s, c, $(document)); };\r\n     *\r\n     *     if you actually give a shit (really, don't bother),\r\n     *     see https://github.com/jquery/jquery/blob/1.7.2/src/core.js#L889\r\n     *\r\n     *   - jQuery(selector), because jQuery translates that to\r\n     *     `jQuery(document).find(selector)`, but Pjs doesn't (should it?) let\r\n     *     you override the result of a constructor call\r\n     *       + note that because of the jQuery(document) shortcut-ness, there's also\r\n     *         the 3rd-argument-needs-to-be-`$(document)` thing above, but the fix\r\n     *         for that (as can be seen above) is really easy. This problem requires\r\n     *         a way more intrusive fix\r\n     *\r\n     * And that's it! Everything else just magically works because jQuery internally\r\n     * uses `this.constructor()` everywhere (hence calling `$`), but never ever does\r\n     * `this.constructor.find` or anything like that, always doing `jQuery.find`.\r\n     */\r\n    var $ = P(jQuery, function(_) {\r\n        _.insDirOf = function(dir, el) {\r\n            return dir === L ?\r\n                this.insertBefore(el.first()) : this.insertAfter(el.last());\r\n        };\r\n        _.insAtDirEnd = function(dir, el) {\r\n            return dir === L ? this.prependTo(el) : this.appendTo(el);\r\n        };\r\n    });\r\n\r\n    var Point = P(function(_) {\r\n        _.parent = 0;\r\n        _[L] = 0;\r\n        _[R] = 0;\r\n\r\n        _.init = function(parent, leftward, rightward) {\r\n            this.parent = parent;\r\n            this[L] = leftward;\r\n            this[R] = rightward;\r\n        };\r\n\r\n        this.copy = function(pt) {\r\n            return Point(pt.parent, pt[L], pt[R]);\r\n        };\r\n    });\r\n\r\n    /**\r\n     * MathQuill virtual-DOM tree-node abstract base class\r\n     */\r\n    var Node = P(function(_) {\r\n        _[L] = 0;\r\n        _[R] = 0\r\n        _.parent = 0;\r\n\r\n        var id = 0;\r\n        function uniqueNodeId() { return id += 1; }\r\n        this.byId = {};\r\n\r\n        _.init = function() {\r\n            this.id = uniqueNodeId();\r\n            Node.byId[this.id] = this;\r\n\r\n            this.ends = {};\r\n            this.ends[L] = 0;\r\n            this.ends[R] = 0;\r\n        };\r\n\r\n        _.dispose = function() { delete Node.byId[this.id]; };\r\n\r\n        _.toString = function() { return '{{ MathQuill Node #'+this.id+' }}'; };\r\n\r\n        _.jQ = $();\r\n        _.jQadd = function(jQ) { return this.jQ = this.jQ.add(jQ); };\r\n        _.jQize = function(jQ) {\r\n            // jQuery-ifies this.html() and links up the .jQ of all corresponding Nodes\r\n            var jQ = $(jQ || this.html());\r\n\r\n            function jQadd(el) {\r\n                if (el.getAttribute) {\r\n                    var cmdId = el.getAttribute('mathquill-command-id');\r\n                    var blockId = el.getAttribute('mathquill-block-id');\r\n                    if (cmdId) Node.byId[cmdId].jQadd(el);\r\n                    if (blockId) Node.byId[blockId].jQadd(el);\r\n                }\r\n                for (el = el.firstChild; el; el = el.nextSibling) {\r\n                    jQadd(el);\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < jQ.length; i += 1) jQadd(jQ[i]);\r\n            return jQ;\r\n        };\r\n\r\n        _.createDir = function(dir, cursor) {\r\n            prayDirection(dir);\r\n            var node = this;\r\n            node.jQize();\r\n            node.jQ.insDirOf(dir, cursor.jQ);\r\n            cursor[dir] = node.adopt(cursor.parent, cursor[L], cursor[R]);\r\n            return node;\r\n        };\r\n        _.createLeftOf = function(el) { return this.createDir(L, el); };\r\n\r\n        _.selectChildren = function(leftEnd, rightEnd) {\r\n            return Selection(leftEnd, rightEnd);\r\n        };\r\n\r\n        _.bubble = iterator(function(yield_) {\r\n            for (var ancestor = this; ancestor; ancestor = ancestor.parent) {\r\n                var result = yield_(ancestor);\r\n                if (result === false) break;\r\n            }\r\n\r\n            return this;\r\n        });\r\n\r\n        _.postOrder = iterator(function(yield_) {\r\n            (function recurse(descendant) {\r\n                descendant.eachChild(recurse);\r\n                yield_(descendant);\r\n            })(this);\r\n\r\n            return this;\r\n        });\r\n\r\n        _.isEmpty = function() {\r\n            return this.ends[L] === 0 && this.ends[R] === 0;\r\n        };\r\n\r\n        _.children = function() {\r\n            return Fragment(this.ends[L], this.ends[R]);\r\n        };\r\n\r\n        _.eachChild = function() {\r\n            var children = this.children();\r\n            children.each.apply(children, arguments);\r\n            return this;\r\n        };\r\n\r\n        _.foldChildren = function(fold, fn) {\r\n            return this.children().fold(fold, fn);\r\n        };\r\n\r\n        _.withDirAdopt = function(dir, parent, withDir, oppDir) {\r\n            Fragment(this, this).withDirAdopt(dir, parent, withDir, oppDir);\r\n            return this;\r\n        };\r\n\r\n        _.adopt = function(parent, leftward, rightward) {\r\n            Fragment(this, this).adopt(parent, leftward, rightward);\r\n            return this;\r\n        };\r\n\r\n        _.disown = function() {\r\n            Fragment(this, this).disown();\r\n            return this;\r\n        };\r\n\r\n        _.remove = function() {\r\n            this.jQ.remove();\r\n            this.postOrder('dispose');\r\n            return this.disown();\r\n        };\r\n    });\r\n\r\n    function prayWellFormed(parent, leftward, rightward) {\r\n        pray('a parent is always present', parent);\r\n        pray('leftward is properly set up', (function() {\r\n            // either it's empty and `rightward` is the left end child (possibly empty)\r\n            if (!leftward) return parent.ends[L] === rightward;\r\n\r\n            // or it's there and its [R] and .parent are properly set up\r\n            return leftward[R] === rightward && leftward.parent === parent;\r\n        })());\r\n\r\n        pray('rightward is properly set up', (function() {\r\n            // either it's empty and `leftward` is the right end child (possibly empty)\r\n            if (!rightward) return parent.ends[R] === leftward;\r\n\r\n            // or it's there and its [L] and .parent are properly set up\r\n            return rightward[L] === leftward && rightward.parent === parent;\r\n        })());\r\n    }\r\n\r\n\r\n    /**\r\n     * An entity outside the virtual tree with one-way pointers (so it's only a\r\n     * \"view\" of part of the tree, not an actual node/entity in the tree) that\r\n     * delimits a doubly-linked list of sibling nodes.\r\n     * It's like a fanfic love-child between HTML DOM DocumentFragment and the Range\r\n     * classes: like DocumentFragment, its contents must be sibling nodes\r\n     * (unlike Range, whose contents are arbitrary contiguous pieces of subtrees),\r\n     * but like Range, it has only one-way pointers to its contents, its contents\r\n     * have no reference to it and in fact may still be in the visible tree (unlike\r\n     * DocumentFragment, whose contents must be detached from the visible tree\r\n     * and have their 'parent' pointers set to the DocumentFragment).\r\n     */\r\n    var Fragment = P(function(_) {\r\n        _.init = function(withDir, oppDir, dir) {\r\n            if (dir === undefined) dir = L;\r\n            prayDirection(dir);\r\n\r\n            pray('no half-empty fragments', !withDir === !oppDir);\r\n\r\n            this.ends = {};\r\n\r\n            if (!withDir) return;\r\n\r\n            pray('withDir is passed to Fragment', withDir instanceof Node);\r\n            pray('oppDir is passed to Fragment', oppDir instanceof Node);\r\n            pray('withDir and oppDir have the same parent',\r\n                withDir.parent === oppDir.parent);\r\n\r\n            this.ends[dir] = withDir;\r\n            this.ends[-dir] = oppDir;\r\n\r\n            // To build the jquery collection for a fragment, accumulate elements\r\n            // into an array and then call jQ.add once on the result. jQ.add sorts the\r\n            // collection according to document order each time it is called, so\r\n            // building a collection by folding jQ.add directly takes more than\r\n            // quadratic time in the number of elements.\r\n            //\r\n            // https://github.com/jquery/jquery/blob/2.1.4/src/traversing.js#L112\r\n            var accum = this.fold([], function (accum, el) {\r\n                accum.push.apply(accum, el.jQ.get());\r\n                return accum;\r\n            });\r\n\r\n            this.jQ = this.jQ.add(accum);\r\n        };\r\n        _.jQ = $();\r\n\r\n        // like Cursor::withDirInsertAt(dir, parent, withDir, oppDir)\r\n        _.withDirAdopt = function(dir, parent, withDir, oppDir) {\r\n            return (dir === L ? this.adopt(parent, withDir, oppDir)\r\n                : this.adopt(parent, oppDir, withDir));\r\n        };\r\n        _.adopt = function(parent, leftward, rightward) {\r\n            prayWellFormed(parent, leftward, rightward);\r\n\r\n            var self = this;\r\n            self.disowned = false;\r\n\r\n            var leftEnd = self.ends[L];\r\n            if (!leftEnd) return this;\r\n\r\n            var rightEnd = self.ends[R];\r\n\r\n            if (leftward) {\r\n                // NB: this is handled in the ::each() block\r\n                // leftward[R] = leftEnd\r\n            } else {\r\n                parent.ends[L] = leftEnd;\r\n            }\r\n\r\n            if (rightward) {\r\n                rightward[L] = rightEnd;\r\n            } else {\r\n                parent.ends[R] = rightEnd;\r\n            }\r\n\r\n            self.ends[R][R] = rightward;\r\n\r\n            self.each(function(el) {\r\n                el[L] = leftward;\r\n                el.parent = parent;\r\n                if (leftward) leftward[R] = el;\r\n\r\n                leftward = el;\r\n            });\r\n\r\n            return self;\r\n        };\r\n\r\n        _.disown = function() {\r\n            var self = this;\r\n            var leftEnd = self.ends[L];\r\n\r\n            // guard for empty and already-disowned fragments\r\n            if (!leftEnd || self.disowned) return self;\r\n\r\n            self.disowned = true;\r\n\r\n            var rightEnd = self.ends[R]\r\n            var parent = leftEnd.parent;\r\n\r\n            prayWellFormed(parent, leftEnd[L], leftEnd);\r\n            prayWellFormed(parent, rightEnd, rightEnd[R]);\r\n\r\n            if (leftEnd[L]) {\r\n                leftEnd[L][R] = rightEnd[R];\r\n            } else {\r\n                parent.ends[L] = rightEnd[R];\r\n            }\r\n\r\n            if (rightEnd[R]) {\r\n                rightEnd[R][L] = leftEnd[L];\r\n            } else {\r\n                parent.ends[R] = leftEnd[L];\r\n            }\r\n\r\n            return self;\r\n        };\r\n\r\n        _.remove = function() {\r\n            this.jQ.remove();\r\n            this.each('postOrder', 'dispose');\r\n            return this.disown();\r\n        };\r\n\r\n        _.each = iterator(function(yield_) {\r\n            var self = this;\r\n            var el = self.ends[L];\r\n            if (!el) return self;\r\n\r\n            for (; el !== self.ends[R][R]; el = el[R]) {\r\n                var result = yield_(el);\r\n                if (result === false) break;\r\n            }\r\n\r\n            return self;\r\n        });\r\n\r\n        _.fold = function(fold, fn) {\r\n            this.each(function(el) {\r\n                fold = fn.call(this, fold, el);\r\n            });\r\n\r\n            return fold;\r\n        };\r\n    });\r\n\r\n\r\n    /**\r\n     * Registry of LaTeX commands and commands created when typing\r\n     * a single character.\r\n     *\r\n     * (Commands are all subclasses of Node.)\r\n     */\r\n    var LatexCmds = {}, CharCmds = {};\r\n    /********************************************\r\n     * Cursor and Selection \"singleton\" classes\r\n     *******************************************/\r\n\r\n  /* The main thing that manipulates the Math DOM. Makes sure to manipulate the\r\n   HTML DOM to match. */\r\n\r\n  /* Sort of singletons, since there should only be one per editable math\r\n   textbox, but any one HTML document can contain many such textboxes, so any one\r\n   JS environment could actually contain many instances. */\r\n\r\n//A fake cursor in the fake textbox that the math is rendered in.\r\n    var Cursor = P(Point, function(_) {\r\n        _.init = function(initParent, options) {\r\n            this.parent = initParent;\r\n            this.options = options;\r\n\r\n            var jQ = this.jQ = this._jQ = $('<span class=\"mq-cursor\">&#8203;</span>');\r\n            //closured for setInterval\r\n            this.blink = function(){ jQ.toggleClass('mq-blink'); };\r\n\r\n            this.upDownCache = {};\r\n        };\r\n\r\n        _.show = function() {\r\n            this.jQ = this._jQ.removeClass('mq-blink');\r\n            if ('intervalId' in this) //already was shown, just restart interval\r\n                clearInterval(this.intervalId);\r\n            else { //was hidden and detached, insert this.jQ back into HTML DOM\r\n                if (this[R]) {\r\n                    if (this.selection && this.selection.ends[L][L] === this[L])\r\n                        this.jQ.insertBefore(this.selection.jQ);\r\n                    else\r\n                        this.jQ.insertBefore(this[R].jQ.first());\r\n                }\r\n                else\r\n                    this.jQ.appendTo(this.parent.jQ);\r\n                this.parent.focus();\r\n            }\r\n            this.intervalId = setInterval(this.blink, 500);\r\n            return this;\r\n        };\r\n        _.hide = function() {\r\n            if ('intervalId' in this)\r\n                clearInterval(this.intervalId);\r\n            delete this.intervalId;\r\n            this.jQ.detach();\r\n            this.jQ = $();\r\n            return this;\r\n        };\r\n\r\n        _.withDirInsertAt = function(dir, parent, withDir, oppDir) {\r\n            var oldParent = this.parent;\r\n            this.parent = parent;\r\n            this[dir] = withDir;\r\n            this[-dir] = oppDir;\r\n            // by contract, .blur() is called after all has been said and done\r\n            // and the cursor has actually been moved\r\n            if (oldParent !== parent && oldParent.blur) oldParent.blur();\r\n        };\r\n        _.insDirOf = function(dir, el) {\r\n            prayDirection(dir);\r\n            this.jQ.insDirOf(dir, el.jQ);\r\n            this.withDirInsertAt(dir, el.parent, el[dir], el);\r\n            this.parent.jQ.addClass('mq-hasCursor');\r\n            return this;\r\n        };\r\n        _.insLeftOf = function(el) { return this.insDirOf(L, el); };\r\n        _.insRightOf = function(el) { return this.insDirOf(R, el); };\r\n\r\n        _.insAtDirEnd = function(dir, el) {\r\n            prayDirection(dir);\r\n            this.jQ.insAtDirEnd(dir, el.jQ);\r\n            this.withDirInsertAt(dir, el, 0, el.ends[dir]);\r\n            el.focus();\r\n            return this;\r\n        };\r\n        _.insAtLeftEnd = function(el) { return this.insAtDirEnd(L, el); };\r\n        _.insAtRightEnd = function(el) { return this.insAtDirEnd(R, el); };\r\n\r\n        /**\r\n         * jump up or down from one block Node to another:\r\n         * - cache the current Point in the node we're jumping from\r\n         * - check if there's a Point in it cached for the node we're jumping to\r\n         *   + if so put the cursor there,\r\n         *   + if not seek a position in the node that is horizontally closest to\r\n         *     the cursor's current position\r\n         */\r\n        _.jumpUpDown = function(from, to) {\r\n            var self = this;\r\n            self.upDownCache[from.id] = Point.copy(self);\r\n            var cached = self.upDownCache[to.id];\r\n            if (cached) {\r\n                cached[R] ? self.insLeftOf(cached[R]) : self.insAtRightEnd(cached.parent);\r\n            }\r\n            else {\r\n                var pageX = self.offset().left;\r\n                to.seek(pageX, self);\r\n            }\r\n        };\r\n        _.offset = function() {\r\n            //in Opera 11.62, .getBoundingClientRect() and hence jQuery::offset()\r\n            //returns all 0's on inline elements with negative margin-right (like\r\n            //the cursor) at the end of their parent, so temporarily remove the\r\n            //negative margin-right when calling jQuery::offset()\r\n            //Opera bug DSK-360043\r\n            //http://bugs.jquery.com/ticket/11523\r\n            //https://github.com/jquery/jquery/pull/717\r\n            var self = this, offset = self.jQ.removeClass('mq-cursor').offset();\r\n            self.jQ.addClass('mq-cursor');\r\n            return offset;\r\n        }\r\n        _.unwrapGramp = function() {\r\n            var gramp = this.parent.parent;\r\n            var greatgramp = gramp.parent;\r\n            var rightward = gramp[R];\r\n            var cursor = this;\r\n\r\n            var leftward = gramp[L];\r\n            gramp.disown().eachChild(function(uncle) {\r\n                if (uncle.isEmpty()) return;\r\n\r\n                uncle.children()\r\n                    .adopt(greatgramp, leftward, rightward)\r\n                    .each(function(cousin) {\r\n                        cousin.jQ.insertBefore(gramp.jQ.first());\r\n                    })\r\n                ;\r\n\r\n                leftward = uncle.ends[R];\r\n            });\r\n\r\n            if (!this[R]) { //then find something to be rightward to insLeftOf\r\n                if (this[L])\r\n                    this[R] = this[L][R];\r\n                else {\r\n                    while (!this[R]) {\r\n                        this.parent = this.parent[R];\r\n                        if (this.parent)\r\n                            this[R] = this.parent.ends[L];\r\n                        else {\r\n                            this[R] = gramp[R];\r\n                            this.parent = greatgramp;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (this[R])\r\n                this.insLeftOf(this[R]);\r\n            else\r\n                this.insAtRightEnd(greatgramp);\r\n\r\n            gramp.jQ.remove();\r\n\r\n            if (gramp[L].siblingDeleted) gramp[L].siblingDeleted(cursor.options, R);\r\n            if (gramp[R].siblingDeleted) gramp[R].siblingDeleted(cursor.options, L);\r\n        };\r\n        _.startSelection = function() {\r\n            var anticursor = this.anticursor = Point.copy(this);\r\n            var ancestors = anticursor.ancestors = {}; // a map from each ancestor of\r\n            // the anticursor, to its child that is also an ancestor; in other words,\r\n            // the anticursor's ancestor chain in reverse order\r\n            for (var ancestor = anticursor; ancestor.parent; ancestor = ancestor.parent) {\r\n                ancestors[ancestor.parent.id] = ancestor;\r\n            }\r\n        };\r\n        _.endSelection = function() {\r\n            delete this.anticursor;\r\n        };\r\n        _.select = function() {\r\n            var anticursor = this.anticursor;\r\n            if (this[L] === anticursor[L] && this.parent === anticursor.parent) return false;\r\n\r\n            // Find the lowest common ancestor (`lca`), and the ancestor of the cursor\r\n            // whose parent is the LCA (which'll be an end of the selection fragment).\r\n            for (var ancestor = this; ancestor.parent; ancestor = ancestor.parent) {\r\n                if (ancestor.parent.id in anticursor.ancestors) {\r\n                    var lca = ancestor.parent;\r\n                    break;\r\n                }\r\n            }\r\n            pray('cursor and anticursor in the same tree', lca);\r\n            // The cursor and the anticursor should be in the same tree, because the\r\n            // mousemove handler attached to the document, unlike the one attached to\r\n            // the root HTML DOM element, doesn't try to get the math tree node of the\r\n            // mousemove target, and Cursor::seek() based solely on coordinates stays\r\n            // within the tree of `this` cursor's root.\r\n\r\n            // The other end of the selection fragment, the ancestor of the anticursor\r\n            // whose parent is the LCA.\r\n            var antiAncestor = anticursor.ancestors[lca.id];\r\n\r\n            // Now we have two either Nodes or Points, guaranteed to have a common\r\n            // parent and guaranteed that if both are Points, they are not the same,\r\n            // and we have to figure out which is the left end and which the right end\r\n            // of the selection.\r\n            var leftEnd, rightEnd, dir = R;\r\n\r\n            // This is an extremely subtle algorithm.\r\n            // As a special case, `ancestor` could be a Point and `antiAncestor` a Node\r\n            // immediately to `ancestor`'s left.\r\n            // In all other cases,\r\n            // - both Nodes\r\n            // - `ancestor` a Point and `antiAncestor` a Node\r\n            // - `ancestor` a Node and `antiAncestor` a Point\r\n            // `antiAncestor[R] === rightward[R]` for some `rightward` that is\r\n            // `ancestor` or to its right, if and only if `antiAncestor` is to\r\n            // the right of `ancestor`.\r\n            if (ancestor[L] !== antiAncestor) {\r\n                for (var rightward = ancestor; rightward; rightward = rightward[R]) {\r\n                    if (rightward[R] === antiAncestor[R]) {\r\n                        dir = L;\r\n                        leftEnd = ancestor;\r\n                        rightEnd = antiAncestor;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (dir === R) {\r\n                leftEnd = antiAncestor;\r\n                rightEnd = ancestor;\r\n            }\r\n\r\n            // only want to select Nodes up to Points, can't select Points themselves\r\n            if (leftEnd instanceof Point) leftEnd = leftEnd[R];\r\n            if (rightEnd instanceof Point) rightEnd = rightEnd[L];\r\n\r\n            this.hide().selection = lca.selectChildren(leftEnd, rightEnd);\r\n            this.insDirOf(dir, this.selection.ends[dir]);\r\n            this.selectionChanged();\r\n            return true;\r\n        };\r\n\r\n        _.clearSelection = function() {\r\n            if (this.selection) {\r\n                this.selection.clear();\r\n                delete this.selection;\r\n                this.selectionChanged();\r\n            }\r\n            return this;\r\n        };\r\n        _.deleteSelection = function() {\r\n            if (!this.selection) return;\r\n\r\n            this[L] = this.selection.ends[L][L];\r\n            this[R] = this.selection.ends[R][R];\r\n            this.selection.remove();\r\n            this.selectionChanged();\r\n            delete this.selection;\r\n        };\r\n        _.replaceSelection = function() {\r\n            var seln = this.selection;\r\n            if (seln) {\r\n                this[L] = seln.ends[L][L];\r\n                this[R] = seln.ends[R][R];\r\n                delete this.selection;\r\n            }\r\n            return seln;\r\n        };\r\n    });\r\n\r\n    var Selection = P(Fragment, function(_, super_) {\r\n        _.init = function() {\r\n            super_.init.apply(this, arguments);\r\n            this.jQ = this.jQ.wrapAll('<span class=\"mq-selection\"></span>').parent();\r\n            //can't do wrapAll(this.jQ = $(...)) because wrapAll will clone it\r\n        };\r\n        _.adopt = function() {\r\n            this.jQ.replaceWith(this.jQ = this.jQ.children());\r\n            return super_.adopt.apply(this, arguments);\r\n        };\r\n        _.clear = function() {\r\n            // using the browser's native .childNodes property so that we\r\n            // don't discard text nodes.\r\n            this.jQ.replaceWith(this.jQ[0].childNodes);\r\n            return this;\r\n        };\r\n        _.join = function(methodName) {\r\n            return this.fold('', function(fold, child) {\r\n                return fold + child[methodName]();\r\n            });\r\n        };\r\n    });\r\n    /*********************************************\r\n     * Controller for a MathQuill instance,\r\n     * on which services are registered with\r\n     *\r\n     *   Controller.open(function(_) { ... });\r\n     *\r\n     ********************************************/\r\n\r\n    var Controller = P(function(_) {\r\n        _.init = function(root, container, options) {\r\n            this.id = root.id;\r\n            this.data = {};\r\n\r\n            this.root = root;\r\n            this.container = container;\r\n            this.options = options;\r\n\r\n            root.controller = this;\r\n\r\n            this.cursor = root.cursor = Cursor(root, options);\r\n            // TODO: stop depending on root.cursor, and rm it\r\n        };\r\n\r\n        _.handle = function(name, dir) {\r\n            var handlers = this.options.handlers;\r\n            if (handlers && handlers.fns[name]) {\r\n                var mq = handlers.APIClasses[this.KIND_OF_MQ](this);\r\n                if (dir === L || dir === R) handlers.fns[name](dir, mq);\r\n                else handlers.fns[name](mq);\r\n            }\r\n        };\r\n\r\n        var notifyees = [];\r\n        this.onNotify = function(f) { notifyees.push(f); };\r\n        _.notify = function() {\r\n            for (var i = 0; i < notifyees.length; i += 1) {\r\n                notifyees[i].apply(this.cursor, arguments);\r\n            }\r\n            return this;\r\n        };\r\n    });\r\n    /*********************************************************\r\n     * The publicly exposed MathQuill API.\r\n     ********************************************************/\r\n\r\n    var API = {}, Options = P(), optionProcessors = {}, Progenote = P(), EMBEDS = {};\r\n\r\n    /**\r\n     * Interface Versioning (#459, #495) to allow us to virtually guarantee\r\n     * backcompat. v0.10.x introduces it, so for now, don't completely break the\r\n     * API for people who don't know about it, just complain with console.warn().\r\n     *\r\n     * The methods are shimmed in outro.js so that MQ.MathField.prototype etc can\r\n     * be accessed.\r\n     */\r\n    function insistOnInterVer() {\r\n        if (window.console) console.warn(\r\n            'You are using the MathQuill API without specifying an interface version, ' +\r\n            'which will fail in v1.0.0. You can fix this easily by doing this before ' +\r\n            'doing anything else:\\n' +\r\n            '\\n' +\r\n            '    MathQuill = MathQuill.getInterface(1);\\n' +\r\n            '    // now MathQuill.MathField() works like it used to\\n' +\r\n            '\\n' +\r\n            'See also the \"`dev` branch (2014\\u20132015) \\u2192 v0.10.0 Migration Guide\" at\\n' +\r\n            '  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide'\r\n        );\r\n    }\r\n// globally exported API object\r\n    function MathQuill(el) {\r\n        insistOnInterVer();\r\n        return MQ1(el);\r\n    };\r\n    MathQuill.prototype = Progenote.p;\r\n    MathQuill.interfaceVersion = function(v) {\r\n        // shim for #459-era interface versioning (ended with #495)\r\n        if (v !== 1) throw 'Only interface version 1 supported. You specified: ' + v;\r\n        insistOnInterVer = function() {\r\n            if (window.console) console.warn(\r\n                'You called MathQuill.interfaceVersion(1); to specify the interface ' +\r\n                'version, which will fail in v1.0.0. You can fix this easily by doing ' +\r\n                'this before doing anything else:\\n' +\r\n                '\\n' +\r\n                '    MathQuill = MathQuill.getInterface(1);\\n' +\r\n                '    // now MathQuill.MathField() works like it used to\\n' +\r\n                '\\n' +\r\n                'See also the \"`dev` branch (2014\\u20132015) \\u2192 v0.10.0 Migration Guide\" at\\n' +\r\n                '  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide'\r\n            );\r\n        };\r\n        insistOnInterVer();\r\n        return MathQuill;\r\n    };\r\n    MathQuill.getInterface = getInterface;\r\n\r\n    var MIN = getInterface.MIN = 1, MAX = getInterface.MAX = 2;\r\n    function getInterface(v) {\r\n        if (!(MIN <= v && v <= MAX)) throw 'Only interface versions between ' +\r\n        MIN + ' and ' + MAX + ' supported. You specified: ' + v;\r\n\r\n        /**\r\n         * Function that takes an HTML element and, if it's the root HTML element of a\r\n         * static math or math or text field, returns an API object for it (else, null).\r\n         *\r\n         *   var mathfield = MQ.MathField(mathFieldSpan);\r\n         *   assert(MQ(mathFieldSpan).id === mathfield.id);\r\n         *   assert(MQ(mathFieldSpan).id === MQ(mathFieldSpan).id);\r\n         *\r\n         */\r\n        function MQ(el) {\r\n            if (!el || !el.nodeType) return null; // check that `el` is a HTML element, using the\r\n            // same technique as jQuery: https://github.com/jquery/jquery/blob/679536ee4b7a92ae64a5f58d90e9cc38c001e807/src/core/init.js#L92\r\n            var blockId = $(el).children('.mq-root-block').attr(mqBlockId);\r\n            var ctrlr = blockId && Node.byId[blockId].controller;\r\n            return ctrlr ? APIClasses[ctrlr.KIND_OF_MQ](ctrlr) : null;\r\n        };\r\n        var APIClasses = {};\r\n\r\n        MQ.L = L;\r\n        MQ.R = R;\r\n\r\n        function config(currentOptions, newOptions) {\r\n            if (newOptions && newOptions.handlers) {\r\n                newOptions.handlers = { fns: newOptions.handlers, APIClasses: APIClasses };\r\n            }\r\n            for (var name in newOptions) if (newOptions.hasOwnProperty(name)) {\r\n                var value = newOptions[name], processor = optionProcessors[name];\r\n                currentOptions[name] = (processor ? processor(value) : value);\r\n            }\r\n        }\r\n        MQ.config = function(opts) { config(Options.p, opts); return this; };\r\n        MQ.registerEmbed = function(name, options) {\r\n            if (!/^[a-z][a-z0-9]*$/i.test(name)) {\r\n                throw 'Embed name must start with letter and be only letters and digits';\r\n            }\r\n            EMBEDS[name] = options;\r\n        };\r\n\r\n        var AbstractMathQuill = APIClasses.AbstractMathQuill = P(Progenote, function(_) {\r\n            _.init = function(ctrlr) {\r\n                this.__controller = ctrlr;\r\n                this.__options = ctrlr.options;\r\n                this.id = ctrlr.id;\r\n                this.data = ctrlr.data;\r\n            };\r\n            _.__mathquillify = function(classNames) {\r\n                var ctrlr = this.__controller, root = ctrlr.root, el = ctrlr.container;\r\n                ctrlr.createTextarea();\r\n\r\n                var contents = el.addClass(classNames).contents().detach();\r\n                root.jQ =\r\n                    $('<span class=\"mq-root-block\"/>').attr(mqBlockId, root.id).appendTo(el);\r\n                this.latex(contents.text());\r\n\r\n                this.revert = function() {\r\n                    return el.empty().unbind('.mathquill')\r\n                        .removeClass('mq-editable-field mq-math-mode mq-text-mode')\r\n                        .append(contents);\r\n                };\r\n            };\r\n            _.config = function(opts) { config(this.__options, opts); return this; };\r\n            _.el = function() { return this.__controller.container[0]; };\r\n            _.text = function() { return this.__controller.exportText(); };\r\n            _.latex = function(latex) {\r\n                if (arguments.length > 0) {\r\n                    this.__controller.renderLatexMath(latex);\r\n                    if (this.__controller.blurred) this.__controller.cursor.hide().parent.blur();\r\n                    return this;\r\n                }\r\n                return this.__controller.exportLatex();\r\n            };\r\n            _.html = function() {\r\n                return this.__controller.root.jQ.html()\r\n                    .replace(/ mathquill-(?:command|block)-id=\"?\\d+\"?/g, '')\r\n                    .replace(/<span class=\"?mq-cursor( mq-blink)?\"?>.?<\\/span>/i, '')\r\n                    .replace(/ mq-hasCursor|mq-hasCursor ?/, '')\r\n                    .replace(/ class=(\"\"|(?= |>))/g, '');\r\n            };\r\n            _.reflow = function() {\r\n                this.__controller.root.postOrder('reflow');\r\n                return this;\r\n            };\r\n        });\r\n        MQ.prototype = AbstractMathQuill.prototype;\r\n\r\n        APIClasses.EditableField = P(AbstractMathQuill, function(_, super_) {\r\n            _.__mathquillify = function() {\r\n                super_.__mathquillify.apply(this, arguments);\r\n                this.__controller.editable = true;\r\n                this.__controller.delegateMouseEvents();\r\n                this.__controller.editablesTextareaEvents();\r\n                return this;\r\n            };\r\n            _.focus = function() { this.__controller.textarea.focus(); return this; };\r\n            _.blur = function() { this.__controller.textarea.blur(); return this; };\r\n            _.write = function(latex) {\r\n                this.__controller.writeLatex(latex);\r\n                this.__controller.scrollHoriz();\r\n                if (this.__controller.blurred) this.__controller.cursor.hide().parent.blur();\r\n                return this;\r\n            };\r\n            _.cmd = function(cmd) {\r\n                var ctrlr = this.__controller.notify(), cursor = ctrlr.cursor;\r\n                if (/^\\\\[a-z]+$/i.test(cmd)) {\r\n                    cmd = cmd.slice(1);\r\n                    var klass = LatexCmds[cmd];\r\n                    if (klass) {\r\n                        cmd = klass(cmd);\r\n                        if (cursor.selection) cmd.replaces(cursor.replaceSelection());\r\n                        cmd.createLeftOf(cursor.show());\r\n                        this.__controller.scrollHoriz();\r\n                    }\r\n                    else /* TODO: API needs better error reporting */;\r\n                }\r\n                else cursor.parent.write(cursor, cmd);\r\n                if (ctrlr.blurred) cursor.hide().parent.blur();\r\n                return this;\r\n            };\r\n            _.select = function() {\r\n                var ctrlr = this.__controller;\r\n                ctrlr.notify('move').cursor.insAtRightEnd(ctrlr.root);\r\n                while (ctrlr.cursor[L]) ctrlr.selectLeft();\r\n                return this;\r\n            };\r\n            _.clearSelection = function() {\r\n                this.__controller.cursor.clearSelection();\r\n                return this;\r\n            };\r\n\r\n            _.moveToDirEnd = function(dir) {\r\n                this.__controller.notify('move').cursor.insAtDirEnd(dir, this.__controller.root);\r\n                return this;\r\n            };\r\n            _.moveToLeftEnd = function() { return this.moveToDirEnd(L); };\r\n            _.moveToRightEnd = function() { return this.moveToDirEnd(R); };\r\n\r\n            _.keystroke = function(keys) {\r\n                var keys = keys.replace(/^\\s+|\\s+$/g, '').split(/\\s+/);\r\n                for (var i = 0; i < keys.length; i += 1) {\r\n                    this.__controller.keystroke(keys[i], { preventDefault: noop });\r\n                }\r\n                return this;\r\n            };\r\n            _.typedText = function(text) {\r\n                for (var i = 0; i < text.length; i += 1) this.__controller.typedText(text.charAt(i));\r\n                return this;\r\n            };\r\n            _.dropEmbedded = function(pageX, pageY, options) {\r\n                var clientX = pageX - $(window).scrollLeft();\r\n                var clientY = pageY - $(window).scrollTop();\r\n\r\n                var el = document.elementFromPoint(clientX, clientY);\r\n                this.__controller.seek($(el), pageX, pageY);\r\n                var cmd = Embed().setOptions(options);\r\n                cmd.createLeftOf(this.__controller.cursor);\r\n            };\r\n        });\r\n        MQ.EditableField = function() { throw \"wtf don't call me, I'm 'abstract'\"; };\r\n        MQ.EditableField.prototype = APIClasses.EditableField.prototype;\r\n\r\n        /**\r\n         * Export the API functions that MathQuill-ify an HTML element into API objects\r\n         * of each class. If the element had already been MathQuill-ified but into a\r\n         * different kind (or it's not an HTML element), return null.\r\n         */\r\n        for (var kind in API) (function(kind, defAPIClass) {\r\n            var APIClass = APIClasses[kind] = defAPIClass(APIClasses);\r\n            MQ[kind] = function(el, opts) {\r\n                var mq = MQ(el);\r\n                if (mq instanceof APIClass || !el || !el.nodeType) return mq;\r\n                var ctrlr = Controller(APIClass.RootBlock(), $(el), Options());\r\n                ctrlr.KIND_OF_MQ = kind;\r\n                return APIClass(ctrlr).__mathquillify(opts, v);\r\n            };\r\n            MQ[kind].prototype = APIClass.prototype;\r\n        }(kind, API[kind]));\r\n\r\n        return MQ;\r\n    }\r\n\r\n    MathQuill.noConflict = function() {\r\n        window.MathQuill = origMathQuill;\r\n        return MathQuill;\r\n    };\r\n    var origMathQuill = window.MathQuill;\r\n    window.MathQuill = MathQuill;\r\n\r\n    function RootBlockMixin(_) {\r\n        var names = 'moveOutOf deleteOutOf selectOutOf upOutOf downOutOf'.split(' ');\r\n        for (var i = 0; i < names.length; i += 1) (function(name) {\r\n            _[name] = function(dir) { this.controller.handle(name, dir); };\r\n        }(names[i]));\r\n        _.reflow = function() {\r\n            this.controller.handle('reflow');\r\n            this.controller.handle('edited');\r\n            this.controller.handle('edit');\r\n        };\r\n    }\r\n    var Parser = P(function(_, super_, Parser) {\r\n        // The Parser object is a wrapper for a parser function.\r\n        // Externally, you use one to parse a string by calling\r\n        //   var result = SomeParser.parse('Me Me Me! Parse Me!');\r\n        // You should never call the constructor, rather you should\r\n        // construct your Parser from the base parsers and the\r\n        // parser combinator methods.\r\n\r\n        function parseError(stream, message) {\r\n            if (stream) {\r\n                stream = \"'\"+stream+\"'\";\r\n            }\r\n            else {\r\n                stream = 'EOF';\r\n            }\r\n\r\n            throw 'Parse Error: '+message+' at '+stream;\r\n        }\r\n\r\n        _.init = function(body) { this._ = body; };\r\n\r\n        _.parse = function(stream) {\r\n            return this.skip(eof)._(''+stream, success, parseError);\r\n\r\n            function success(stream, result) { return result; }\r\n        };\r\n\r\n        // -*- primitive combinators -*- //\r\n        _.or = function(alternative) {\r\n            pray('or is passed a parser', alternative instanceof Parser);\r\n\r\n            var self = this;\r\n\r\n            return Parser(function(stream, onSuccess, onFailure) {\r\n                return self._(stream, onSuccess, failure);\r\n\r\n                function failure(newStream) {\r\n                    return alternative._(stream, onSuccess, onFailure);\r\n                }\r\n            });\r\n        };\r\n\r\n        _.then = function(next) {\r\n            var self = this;\r\n\r\n            return Parser(function(stream, onSuccess, onFailure) {\r\n                return self._(stream, success, onFailure);\r\n\r\n                function success(newStream, result) {\r\n                    var nextParser = (next instanceof Parser ? next : next(result));\r\n                    pray('a parser is returned', nextParser instanceof Parser);\r\n                    return nextParser._(newStream, onSuccess, onFailure);\r\n                }\r\n            });\r\n        };\r\n\r\n        // -*- optimized iterative combinators -*- //\r\n        _.many = function() {\r\n            var self = this;\r\n\r\n            return Parser(function(stream, onSuccess, onFailure) {\r\n                var xs = [];\r\n                while (self._(stream, success, failure));\r\n                return onSuccess(stream, xs);\r\n\r\n                function success(newStream, x) {\r\n                    stream = newStream;\r\n                    xs.push(x);\r\n                    return true;\r\n                }\r\n\r\n                function failure() {\r\n                    return false;\r\n                }\r\n            });\r\n        };\r\n\r\n        _.times = function(min, max) {\r\n            if (arguments.length < 2) max = min;\r\n            var self = this;\r\n\r\n            return Parser(function(stream, onSuccess, onFailure) {\r\n                var xs = [];\r\n                var result = true;\r\n                var failure;\r\n\r\n                for (var i = 0; i < min; i += 1) {\r\n                    result = self._(stream, success, firstFailure);\r\n                    if (!result) return onFailure(stream, failure);\r\n                }\r\n\r\n                for (; i < max && result; i += 1) {\r\n                    result = self._(stream, success, secondFailure);\r\n                }\r\n\r\n                return onSuccess(stream, xs);\r\n\r\n                function success(newStream, x) {\r\n                    xs.push(x);\r\n                    stream = newStream;\r\n                    return true;\r\n                }\r\n\r\n                function firstFailure(newStream, msg) {\r\n                    failure = msg;\r\n                    stream = newStream;\r\n                    return false;\r\n                }\r\n\r\n                function secondFailure(newStream, msg) {\r\n                    return false;\r\n                }\r\n            });\r\n        };\r\n\r\n        // -*- higher-level combinators -*- //\r\n        _.result = function(res) { return this.then(succeed(res)); };\r\n        _.atMost = function(n) { return this.times(0, n); };\r\n        _.atLeast = function(n) {\r\n            var self = this;\r\n            return self.times(n).then(function(start) {\r\n                return self.many().map(function(end) {\r\n                    return start.concat(end);\r\n                });\r\n            });\r\n        };\r\n\r\n        _.map = function(fn) {\r\n            return this.then(function(result) { return succeed(fn(result)); });\r\n        };\r\n\r\n        _.skip = function(two) {\r\n            return this.then(function(result) { return two.result(result); });\r\n        };\r\n\r\n        // -*- primitive parsers -*- //\r\n        var string = this.string = function(str) {\r\n            var len = str.length;\r\n            var expected = \"expected '\"+str+\"'\";\r\n\r\n            return Parser(function(stream, onSuccess, onFailure) {\r\n                var head = stream.slice(0, len);\r\n\r\n                if (head === str) {\r\n                    return onSuccess(stream.slice(len), head);\r\n                }\r\n                else {\r\n                    return onFailure(stream, expected);\r\n                }\r\n            });\r\n        };\r\n\r\n        var regex = this.regex = function(re) {\r\n            pray('regexp parser is anchored', re.toString().charAt(1) === '^');\r\n\r\n            var expected = 'expected '+re;\r\n\r\n            return Parser(function(stream, onSuccess, onFailure) {\r\n                var match = re.exec(stream);\r\n\r\n                if (match) {\r\n                    var result = match[0];\r\n                    return onSuccess(stream.slice(result.length), result);\r\n                }\r\n                else {\r\n                    return onFailure(stream, expected);\r\n                }\r\n            });\r\n        };\r\n\r\n        var succeed = Parser.succeed = function(result) {\r\n            return Parser(function(stream, onSuccess) {\r\n                return onSuccess(stream, result);\r\n            });\r\n        };\r\n\r\n        var fail = Parser.fail = function(msg) {\r\n            return Parser(function(stream, _, onFailure) {\r\n                return onFailure(stream, msg);\r\n            });\r\n        };\r\n\r\n        var letter = Parser.letter = regex(/^[a-z]/i);\r\n        var letters = Parser.letters = regex(/^[a-z]*/i);\r\n        var digit = Parser.digit = regex(/^[0-9]/);\r\n        var digits = Parser.digits = regex(/^[0-9]*/);\r\n        var whitespace = Parser.whitespace = regex(/^\\s+/);\r\n        var optWhitespace = Parser.optWhitespace = regex(/^\\s*/);\r\n\r\n        var any = Parser.any = Parser(function(stream, onSuccess, onFailure) {\r\n            if (!stream) return onFailure(stream, 'expected any character');\r\n\r\n            return onSuccess(stream.slice(1), stream.charAt(0));\r\n        });\r\n\r\n        var all = Parser.all = Parser(function(stream, onSuccess, onFailure) {\r\n            return onSuccess('', stream);\r\n        });\r\n\r\n        var eof = Parser.eof = Parser(function(stream, onSuccess, onFailure) {\r\n            if (stream) return onFailure(stream, 'expected EOF');\r\n\r\n            return onSuccess(stream, stream);\r\n        });\r\n    });\r\n    /*************************************************\r\n     * Sane Keyboard Events Shim\r\n     *\r\n     * An abstraction layer wrapping the textarea in\r\n     * an object with methods to manipulate and listen\r\n     * to events on, that hides all the nasty cross-\r\n     * browser incompatibilities behind a uniform API.\r\n     *\r\n     * Design goal: This is a *HARD* internal\r\n     * abstraction barrier. Cross-browser\r\n     * inconsistencies are not allowed to leak through\r\n     * and be dealt with by event handlers. All future\r\n     * cross-browser issues that arise must be dealt\r\n     * with here, and if necessary, the API updated.\r\n     *\r\n     * Organization:\r\n     * - key values map and stringify()\r\n     * - saneKeyboardEvents()\r\n     *    + defer() and flush()\r\n     *    + event handler logic\r\n     *    + attach event handlers and export methods\r\n     ************************************************/\r\n\r\n    var saneKeyboardEvents = (function() {\r\n        // The following [key values][1] map was compiled from the\r\n        // [DOM3 Events appendix section on key codes][2] and\r\n        // [a widely cited report on cross-browser tests of key codes][3],\r\n        // except for 10: 'Enter', which I've empirically observed in Safari on iOS\r\n        // and doesn't appear to conflict with any other known key codes.\r\n        //\r\n        // [1]: http://www.w3.org/TR/2012/WD-DOM-Level-3-Events-20120614/#keys-keyvalues\r\n        // [2]: http://www.w3.org/TR/2012/WD-DOM-Level-3-Events-20120614/#fixed-virtual-key-codes\r\n        // [3]: http://unixpapa.com/js/key.html\r\n        var KEY_VALUES = {\r\n            8: 'Backspace',\r\n            9: 'Tab',\r\n\r\n            10: 'Enter', // for Safari on iOS\r\n\r\n            13: 'Enter',\r\n\r\n            16: 'Shift',\r\n            17: 'Control',\r\n            18: 'Alt',\r\n            20: 'CapsLock',\r\n\r\n            27: 'Esc',\r\n\r\n            32: 'Spacebar',\r\n\r\n            33: 'PageUp',\r\n            34: 'PageDown',\r\n            35: 'End',\r\n            36: 'Home',\r\n\r\n            37: 'Left',\r\n            38: 'Up',\r\n            39: 'Right',\r\n            40: 'Down',\r\n\r\n            45: 'Insert',\r\n\r\n            46: 'Del',\r\n\r\n            144: 'NumLock'\r\n        };\r\n\r\n        // To the extent possible, create a normalized string representation\r\n        // of the key combo (i.e., key code and modifier keys).\r\n        function stringify(evt) {\r\n            var which = evt.which || evt.keyCode;\r\n            var keyVal = KEY_VALUES[which];\r\n            var key;\r\n            var modifiers = [];\r\n\r\n            if (evt.ctrlKey) modifiers.push('Ctrl');\r\n            if (evt.originalEvent && evt.originalEvent.metaKey) modifiers.push('Meta');\r\n            if (evt.altKey) modifiers.push('Alt');\r\n            if (evt.shiftKey) modifiers.push('Shift');\r\n\r\n            key = keyVal || String.fromCharCode(which);\r\n\r\n            if (!modifiers.length && !keyVal) return key;\r\n\r\n            modifiers.push(key);\r\n            return modifiers.join('-');\r\n        }\r\n\r\n        // create a keyboard events shim that calls callbacks at useful times\r\n        // and exports useful public methods\r\n        return function saneKeyboardEvents(el, handlers) {\r\n            var keydown = null;\r\n            var keypress = null;\r\n\r\n            var textarea = jQuery(el);\r\n            var target = jQuery(handlers.container || textarea);\r\n\r\n            // checkTextareaFor() is called after keypress or paste events to\r\n            // say \"Hey, I think something was just typed\" or \"pasted\" (resp.),\r\n            // so that at all subsequent opportune times (next event or timeout),\r\n            // will check for expected typed or pasted text.\r\n            // Need to check repeatedly because #135: in Safari 5.1 (at least),\r\n            // after selecting something and then typing, the textarea is\r\n            // incorrectly reported as selected during the input event (but not\r\n            // subsequently).\r\n            var checkTextarea = noop, timeoutId;\r\n            function checkTextareaFor(checker) {\r\n                checkTextarea = checker;\r\n                clearTimeout(timeoutId);\r\n                timeoutId = setTimeout(checker);\r\n            }\r\n            target.bind('keydown keypress input keyup focusout paste', function(e) { checkTextarea(e); });\r\n\r\n\r\n            // -*- public methods -*- //\r\n            function select(text) {\r\n                // check textarea at least once/one last time before munging (so\r\n                // no race condition if selection happens after keypress/paste but\r\n                // before checkTextarea), then never again ('cos it's been munged)\r\n                checkTextarea();\r\n                checkTextarea = noop;\r\n                clearTimeout(timeoutId);\r\n\r\n                textarea.val(text);\r\n                if (text && textarea[0].select) textarea[0].select();\r\n                shouldBeSelected = !!text;\r\n            }\r\n            var shouldBeSelected = false;\r\n\r\n            // -*- helper subroutines -*- //\r\n\r\n            // Determine whether there's a selection in the textarea.\r\n            // This will always return false in IE < 9, which don't support\r\n            // HTMLTextareaElement::selection{Start,End}.\r\n            function hasSelection() {\r\n                var dom = textarea[0];\r\n\r\n                if (!('selectionStart' in dom)) return false;\r\n                return dom.selectionStart !== dom.selectionEnd;\r\n            }\r\n\r\n            function handleKey() {\r\n                handlers.keystroke(stringify(keydown), keydown);\r\n            }\r\n\r\n            // -*- event handlers -*- //\r\n            function onKeydown(e) {\r\n                keydown = e;\r\n                keypress = null;\r\n\r\n                if (shouldBeSelected) checkTextareaFor(function(e) {\r\n                    if (!(e && e.type === 'focusout') && textarea[0].select) {\r\n                        textarea[0].select(); // re-select textarea in case it's an unrecognized\r\n                    }\r\n                    checkTextarea = noop; // key that clears the selection, then never\r\n                    clearTimeout(timeoutId); // again, 'cos next thing might be blur\r\n                });\r\n\r\n                handleKey();\r\n            }\r\n\r\n            function onKeypress(e) {\r\n                // call the key handler for repeated keypresses.\r\n                // This excludes keypresses that happen directly\r\n                // after keydown.  In that case, there will be\r\n                // no previous keypress, so we skip it here\r\n                if (keydown && keypress) handleKey();\r\n\r\n                keypress = e;\r\n\r\n                checkTextareaFor(typedText);\r\n            }\r\n            function typedText() {\r\n                // If there is a selection, the contents of the textarea couldn't\r\n                // possibly have just been typed in.\r\n                // This happens in browsers like Firefox and Opera that fire\r\n                // keypress for keystrokes that are not text entry and leave the\r\n                // selection in the textarea alone, such as Ctrl-C.\r\n                // Note: we assume that browsers that don't support hasSelection()\r\n                // also never fire keypress on keystrokes that are not text entry.\r\n                // This seems reasonably safe because:\r\n                // - all modern browsers including IE 9+ support hasSelection(),\r\n                //   making it extremely unlikely any browser besides IE < 9 won't\r\n                // - as far as we know IE < 9 never fires keypress on keystrokes\r\n                //   that aren't text entry, which is only as reliable as our\r\n                //   tests are comprehensive, but the IE < 9 way to do\r\n                //   hasSelection() is poorly documented and is also only as\r\n                //   reliable as our tests are comprehensive\r\n                // If anything like #40 or #71 is reported in IE < 9, see\r\n                // b1318e5349160b665003e36d4eedd64101ceacd8\r\n                if (hasSelection()) return;\r\n\r\n                var text = textarea.val();\r\n                if (text.length === 1) {\r\n                    textarea.val('');\r\n                    handlers.typedText(text);\r\n                } // in Firefox, keys that don't type text, just clear seln, fire keypress\r\n                // https://github.com/mathquill/mathquill/issues/293#issuecomment-40997668\r\n                else if (text && textarea[0].select) textarea[0].select(); // re-select if that's why we're here\r\n            }\r\n\r\n            function onBlur() { keydown = keypress = null; }\r\n\r\n            function onPaste(e) {\r\n                // browsers are dumb.\r\n                //\r\n                // In Linux, middle-click pasting causes onPaste to be called,\r\n                // when the textarea is not necessarily focused.  We focus it\r\n                // here to ensure that the pasted text actually ends up in the\r\n                // textarea.\r\n                //\r\n                // It's pretty nifty that by changing focus in this handler,\r\n                // we can change the target of the default action.  (This works\r\n                // on keydown too, FWIW).\r\n                //\r\n                // And by nifty, we mean dumb (but useful sometimes).\r\n                textarea.focus();\r\n\r\n                checkTextareaFor(pastedText);\r\n            }\r\n            function pastedText() {\r\n                var text = textarea.val();\r\n                textarea.val('');\r\n                if (text) handlers.paste(text);\r\n            }\r\n\r\n            // -*- attach event handlers -*- //\r\n            target.bind({\r\n                keydown: onKeydown,\r\n                keypress: onKeypress,\r\n                focusout: onBlur,\r\n                paste: onPaste\r\n            });\r\n\r\n            // -*- export public methods -*- //\r\n            return {\r\n                select: select\r\n            };\r\n        };\r\n    }());\r\n    /***********************************************\r\n     * Export math in a human-readable text format\r\n     * As you can see, only half-baked so far.\r\n     **********************************************/\r\n\r\n    Controller.open(function(_, super_) {\r\n        _.exportText = function() {\r\n            return this.root.foldChildren('', function(text, child) {\r\n                return text + child.text();\r\n            });\r\n        };\r\n    });\r\n    Controller.open(function(_) {\r\n        _.focusBlurEvents = function() {\r\n            var ctrlr = this, root = ctrlr.root, cursor = ctrlr.cursor;\r\n            var blurTimeout;\r\n            ctrlr.textarea.focus(function() {\r\n                ctrlr.blurred = false;\r\n                clearTimeout(blurTimeout);\r\n                ctrlr.container.addClass('mq-focused');\r\n                if (!cursor.parent)\r\n                    cursor.insAtRightEnd(root);\r\n                if (cursor.selection) {\r\n                    cursor.selection.jQ.removeClass('mq-blur');\r\n                    ctrlr.selectionChanged(); //re-select textarea contents after tabbing away and back\r\n                }\r\n                else\r\n                    cursor.show();\r\n            }).blur(function() {\r\n                ctrlr.blurred = true;\r\n                blurTimeout = setTimeout(function() { // wait for blur on window; if\r\n                    root.postOrder('intentionalBlur'); // none, intentional blur: #264\r\n                    cursor.clearSelection().endSelection();\r\n                    blur();\r\n                });\r\n                $(window).on('blur', windowBlur);\r\n            });\r\n            function windowBlur() { // blur event also fired on window, just switching\r\n                clearTimeout(blurTimeout); // tabs/windows, not intentional blur\r\n                if (cursor.selection) cursor.selection.jQ.addClass('mq-blur');\r\n                blur();\r\n            }\r\n            function blur() { // not directly in the textarea blur handler so as to be\r\n                cursor.hide().parent.blur(); // synchronous with/in the same frame as\r\n                ctrlr.container.removeClass('mq-focused'); // clearing/blurring selection\r\n                $(window).off('blur', windowBlur);\r\n            }\r\n            ctrlr.blurred = true;\r\n            cursor.hide().parent.blur();\r\n        };\r\n    });\r\n\r\n    /**\r\n     * TODO: I wanted to move MathBlock::focus and blur here, it would clean\r\n     * up lots of stuff like, TextBlock::focus is set to MathBlock::focus\r\n     * and TextBlock::blur calls MathBlock::blur, when instead they could\r\n     * use inheritance and super_.\r\n     *\r\n     * Problem is, there's lots of calls to .focus()/.blur() on nodes\r\n     * outside Controller::focusBlurEvents(), such as .postOrder('blur') on\r\n     * insertion, which if MathBlock::blur becomes Node::blur, would add the\r\n     * 'blur' CSS class to all Symbol's (because .isEmpty() is true for all\r\n     * of them).\r\n     *\r\n     * I'm not even sure there aren't other troublesome calls to .focus() or\r\n     * .blur(), so this is TODO for now.\r\n     */\r\n    /*****************************************\r\n     * Deals with the browser DOM events from\r\n     * interaction with the typist.\r\n     ****************************************/\r\n\r\n    Controller.open(function(_) {\r\n        _.keystroke = function(key, evt) {\r\n            this.cursor.parent.keystroke(key, evt, this);\r\n        };\r\n    });\r\n\r\n    Node.open(function(_) {\r\n        _.keystroke = function(key, e, ctrlr) {\r\n            var cursor = ctrlr.cursor;\r\n\r\n            switch (key) {\r\n                case 'Ctrl-Shift-Backspace':\r\n                case 'Ctrl-Backspace':\r\n                    ctrlr.ctrlDeleteDir(L);\r\n                    break;\r\n\r\n                case 'Shift-Backspace':\r\n                case 'Backspace':\r\n                    ctrlr.backspace();\r\n                    break;\r\n\r\n                // Tab or Esc -> go one block right if it exists, else escape right.\r\n                case 'Esc':\r\n                case 'Tab':\r\n                    ctrlr.escapeDir(R, key, e);\r\n                    return;\r\n\r\n                // Shift-Tab -> go one block left if it exists, else escape left.\r\n                case 'Shift-Tab':\r\n                case 'Shift-Esc':\r\n                    ctrlr.escapeDir(L, key, e);\r\n                    return;\r\n\r\n                // End -> move to the end of the current block.\r\n                case 'End':\r\n                    ctrlr.notify('move').cursor.insAtRightEnd(cursor.parent);\r\n                    break;\r\n\r\n                // Ctrl-End -> move all the way to the end of the root block.\r\n                case 'Ctrl-End':\r\n                    ctrlr.notify('move').cursor.insAtRightEnd(ctrlr.root);\r\n                    break;\r\n\r\n                // Shift-End -> select to the end of the current block.\r\n                case 'Shift-End':\r\n                    while (cursor[R]) {\r\n                        ctrlr.selectRight();\r\n                    }\r\n                    break;\r\n\r\n                // Ctrl-Shift-End -> select to the end of the root block.\r\n                case 'Ctrl-Shift-End':\r\n                    while (cursor[R] || cursor.parent !== ctrlr.root) {\r\n                        ctrlr.selectRight();\r\n                    }\r\n                    break;\r\n\r\n                // Home -> move to the start of the root block or the current block.\r\n                case 'Home':\r\n                    ctrlr.notify('move').cursor.insAtLeftEnd(cursor.parent);\r\n                    break;\r\n\r\n                // Ctrl-Home -> move to the start of the current block.\r\n                case 'Ctrl-Home':\r\n                    ctrlr.notify('move').cursor.insAtLeftEnd(ctrlr.root);\r\n                    break;\r\n\r\n                // Shift-Home -> select to the start of the current block.\r\n                case 'Shift-Home':\r\n                    while (cursor[L]) {\r\n                        ctrlr.selectLeft();\r\n                    }\r\n                    break;\r\n\r\n                // Ctrl-Shift-Home -> move to the start of the root block.\r\n                case 'Ctrl-Shift-Home':\r\n                    while (cursor[L] || cursor.parent !== ctrlr.root) {\r\n                        ctrlr.selectLeft();\r\n                    }\r\n                    break;\r\n\r\n                case 'Left': ctrlr.moveLeft(); break;\r\n                case 'Shift-Left': ctrlr.selectLeft(); break;\r\n                case 'Ctrl-Left': break;\r\n\r\n                case 'Right': ctrlr.moveRight(); break;\r\n                case 'Shift-Right': ctrlr.selectRight(); break;\r\n                case 'Ctrl-Right': break;\r\n\r\n                case 'Up': ctrlr.moveUp(); break;\r\n                case 'Down': ctrlr.moveDown(); break;\r\n\r\n                case 'Shift-Up':\r\n                    if (cursor[L]) {\r\n                        while (cursor[L]) ctrlr.selectLeft();\r\n                    } else {\r\n                        ctrlr.selectLeft();\r\n                    }\r\n\r\n                case 'Shift-Down':\r\n                    if (cursor[R]) {\r\n                        while (cursor[R]) ctrlr.selectRight();\r\n                    }\r\n                    else {\r\n                        ctrlr.selectRight();\r\n                    }\r\n\r\n                case 'Ctrl-Up': break;\r\n                case 'Ctrl-Down': break;\r\n\r\n                case 'Ctrl-Shift-Del':\r\n                case 'Ctrl-Del':\r\n                    ctrlr.ctrlDeleteDir(R);\r\n                    break;\r\n\r\n                case 'Shift-Del':\r\n                case 'Del':\r\n                    ctrlr.deleteForward();\r\n                    break;\r\n\r\n                case 'Meta-A':\r\n                case 'Ctrl-A':\r\n                    ctrlr.notify('move').cursor.insAtRightEnd(ctrlr.root);\r\n                    while (cursor[L]) ctrlr.selectLeft();\r\n                    break;\r\n\r\n                default:\r\n                    return;\r\n            }\r\n            e.preventDefault();\r\n            ctrlr.scrollHoriz();\r\n        };\r\n\r\n        _.moveOutOf = // called by Controller::escapeDir, moveDir\r\n            _.moveTowards = // called by Controller::moveDir\r\n                _.deleteOutOf = // called by Controller::deleteDir\r\n                    _.deleteTowards = // called by Controller::deleteDir\r\n                        _.unselectInto = // called by Controller::selectDir\r\n                            _.selectOutOf = // called by Controller::selectDir\r\n                                _.selectTowards = // called by Controller::selectDir\r\n                                    function() { pray('overridden or never called on this node'); };\r\n    });\r\n\r\n    Controller.open(function(_) {\r\n        this.onNotify(function(e) {\r\n            if (e === 'move' || e === 'upDown') this.show().clearSelection();\r\n        });\r\n        _.escapeDir = function(dir, key, e) {\r\n            prayDirection(dir);\r\n            var cursor = this.cursor;\r\n\r\n            // only prevent default of Tab if not in the root editable\r\n            if (cursor.parent !== this.root) e.preventDefault();\r\n\r\n            // want to be a noop if in the root editable (in fact, Tab has an unrelated\r\n            // default browser action if so)\r\n            if (cursor.parent === this.root) return;\r\n\r\n            cursor.parent.moveOutOf(dir, cursor);\r\n            return this.notify('move');\r\n        };\r\n\r\n        optionProcessors.leftRightIntoCmdGoes = function(updown) {\r\n            if (updown && updown !== 'up' && updown !== 'down') {\r\n                throw '\"up\" or \"down\" required for leftRightIntoCmdGoes option, '\r\n                + 'got \"'+updown+'\"';\r\n            }\r\n            return updown;\r\n        };\r\n        _.moveDir = function(dir) {\r\n            prayDirection(dir);\r\n            var cursor = this.cursor, updown = cursor.options.leftRightIntoCmdGoes;\r\n\r\n            if (cursor.selection) {\r\n                cursor.insDirOf(dir, cursor.selection.ends[dir]);\r\n            }\r\n            else if (cursor[dir]) cursor[dir].moveTowards(dir, cursor, updown);\r\n            else cursor.parent.moveOutOf(dir, cursor, updown);\r\n\r\n            return this.notify('move');\r\n        };\r\n        _.moveLeft = function() { return this.moveDir(L); };\r\n        _.moveRight = function() { return this.moveDir(R); };\r\n\r\n        /**\r\n         * moveUp and moveDown have almost identical algorithms:\r\n         * - first check left and right, if so insAtLeft/RightEnd of them\r\n         * - else check the parent's 'upOutOf'/'downOutOf' property:\r\n         *   + if it's a function, call it with the cursor as the sole argument and\r\n         *     use the return value as if it were the value of the property\r\n         *   + if it's a Node, jump up or down into it:\r\n         *     - if there is a cached Point in the block, insert there\r\n         *     - else, seekHoriz within the block to the current x-coordinate (to be\r\n         *       as close to directly above/below the current position as possible)\r\n         *   + unless it's exactly `true`, stop bubbling\r\n         */\r\n        _.moveUp = function() { return moveUpDown(this, 'up'); };\r\n        _.moveDown = function() { return moveUpDown(this, 'down'); };\r\n        function moveUpDown(self, dir) {\r\n            var cursor = self.notify('upDown').cursor;\r\n            var dirInto = dir+'Into', dirOutOf = dir+'OutOf';\r\n            if (cursor[R][dirInto]) cursor.insAtLeftEnd(cursor[R][dirInto]);\r\n            else if (cursor[L][dirInto]) cursor.insAtRightEnd(cursor[L][dirInto]);\r\n            else {\r\n                cursor.parent.bubble(function(ancestor) {\r\n                    var prop = ancestor[dirOutOf];\r\n                    if (prop) {\r\n                        if (typeof prop === 'function') prop = ancestor[dirOutOf](cursor);\r\n                        if (prop instanceof Node) cursor.jumpUpDown(ancestor, prop);\r\n                        if (prop !== true) return false;\r\n                    }\r\n                });\r\n            }\r\n            return self;\r\n        }\r\n        this.onNotify(function(e) { if (e !== 'upDown') this.upDownCache = {}; });\r\n\r\n        this.onNotify(function(e) { if (e === 'edit') this.show().deleteSelection(); });\r\n        _.deleteDir = function(dir) {\r\n            prayDirection(dir);\r\n            var cursor = this.cursor;\r\n\r\n            var hadSelection = cursor.selection;\r\n            this.notify('edit'); // deletes selection if present\r\n            if (!hadSelection) {\r\n                if (cursor[dir]) cursor[dir].deleteTowards(dir, cursor);\r\n                else cursor.parent.deleteOutOf(dir, cursor);\r\n            }\r\n\r\n            if (cursor[L].siblingDeleted) cursor[L].siblingDeleted(cursor.options, R);\r\n            if (cursor[R].siblingDeleted) cursor[R].siblingDeleted(cursor.options, L);\r\n            cursor.parent.bubble('reflow');\r\n\r\n            return this;\r\n        };\r\n        _.ctrlDeleteDir = function(dir) {\r\n            prayDirection(dir);\r\n            var cursor = this.cursor;\r\n            if (!cursor[L] || cursor.selection) return ctrlr.deleteDir();\r\n\r\n            this.notify('edit');\r\n            Fragment(cursor.parent.ends[L], cursor[L]).remove();\r\n            cursor.insAtDirEnd(L, cursor.parent);\r\n\r\n            if (cursor[L].siblingDeleted) cursor[L].siblingDeleted(cursor.options, R);\r\n            if (cursor[R].siblingDeleted) cursor[R].siblingDeleted(cursor.options, L);\r\n            cursor.parent.bubble('reflow');\r\n\r\n            return this;\r\n        };\r\n        _.backspace = function() { return this.deleteDir(L); };\r\n        _.deleteForward = function() { return this.deleteDir(R); };\r\n\r\n        this.onNotify(function(e) { if (e !== 'select') this.endSelection(); });\r\n        _.selectDir = function(dir) {\r\n            var cursor = this.notify('select').cursor, seln = cursor.selection;\r\n            prayDirection(dir);\r\n\r\n            if (!cursor.anticursor) cursor.startSelection();\r\n\r\n            var node = cursor[dir];\r\n            if (node) {\r\n                // \"if node we're selecting towards is inside selection (hence retracting)\r\n                // and is on the *far side* of the selection (hence is only node selected)\r\n                // and the anticursor is *inside* that node, not just on the other side\"\r\n                if (seln && seln.ends[dir] === node && cursor.anticursor[-dir] !== node) {\r\n                    node.unselectInto(dir, cursor);\r\n                }\r\n                else node.selectTowards(dir, cursor);\r\n            }\r\n            else cursor.parent.selectOutOf(dir, cursor);\r\n\r\n            cursor.clearSelection();\r\n            cursor.select() || cursor.show();\r\n        };\r\n        _.selectLeft = function() { return this.selectDir(L); };\r\n        _.selectRight = function() { return this.selectDir(R); };\r\n    });\r\n// Parser MathCommand\r\n    var latexMathParser = (function() {\r\n        function commandToBlock(cmd) {\r\n            var block = MathBlock();\r\n            cmd.adopt(block, 0, 0);\r\n            return block;\r\n        }\r\n        function joinBlocks(blocks) {\r\n            var firstBlock = blocks[0] || MathBlock();\r\n\r\n            for (var i = 1; i < blocks.length; i += 1) {\r\n                blocks[i].children().adopt(firstBlock, firstBlock.ends[R], 0);\r\n            }\r\n\r\n            return firstBlock;\r\n        }\r\n\r\n        var string = Parser.string;\r\n        var regex = Parser.regex;\r\n        var letter = Parser.letter;\r\n        var any = Parser.any;\r\n        var optWhitespace = Parser.optWhitespace;\r\n        var succeed = Parser.succeed;\r\n        var fail = Parser.fail;\r\n\r\n        // Parsers yielding either MathCommands, or Fragments of MathCommands\r\n        //   (either way, something that can be adopted by a MathBlock)\r\n        var variable = letter.map(function(c) { return Letter(c); });\r\n        var symbol = regex(/^[^${}\\\\_^]/).map(function(c) { return VanillaSymbol(c); });\r\n\r\n        var controlSequence =\r\n            regex(/^[^\\\\a-eg-zA-Z]/) // hotfix #164; match MathBlock::write\r\n                .or(string('\\\\').then(\r\n                    regex(/^[a-z]+/i)\r\n                        .or(regex(/^\\s+/).result(' '))\r\n                        .or(any)\r\n                )).then(function(ctrlSeq) {\r\n                var cmdKlass = LatexCmds[ctrlSeq];\r\n\r\n                if (cmdKlass) {\r\n                    return cmdKlass(ctrlSeq).parser();\r\n                }\r\n                else {\r\n                    return fail('unknown command: \\\\'+ctrlSeq);\r\n                }\r\n            })\r\n        ;\r\n\r\n        var command =\r\n            controlSequence\r\n                .or(variable)\r\n                .or(symbol)\r\n        ;\r\n\r\n        // Parsers yielding MathBlocks\r\n        var mathGroup = string('{').then(function() { return mathSequence; }).skip(string('}'));\r\n        var mathBlock = optWhitespace.then(mathGroup.or(command.map(commandToBlock)));\r\n        var mathSequence = mathBlock.many().map(joinBlocks).skip(optWhitespace);\r\n\r\n        var optMathBlock =\r\n            string('[').then(\r\n                mathBlock.then(function(block) {\r\n                        return block.join('latex') !== ']' ? succeed(block) : fail();\r\n                    })\r\n                    .many().map(joinBlocks).skip(optWhitespace)\r\n            ).skip(string(']'))\r\n        ;\r\n\r\n        var latexMath = mathSequence;\r\n\r\n        latexMath.block = mathBlock;\r\n        latexMath.optBlock = optMathBlock;\r\n        return latexMath;\r\n    })();\r\n\r\n    Controller.open(function(_, super_) {\r\n        _.exportLatex = function() {\r\n            return this.root.latex().replace(/(\\\\[a-z]+) (?![a-z])/ig,'$1');\r\n        };\r\n        _.writeLatex = function(latex) {\r\n            var cursor = this.notify('edit').cursor;\r\n\r\n            var all = Parser.all;\r\n            var eof = Parser.eof;\r\n\r\n            var block = latexMathParser.skip(eof).or(all.result(false)).parse(latex);\r\n\r\n            if (block && !block.isEmpty()) {\r\n                block.children().adopt(cursor.parent, cursor[L], cursor[R]);\r\n                var jQ = block.jQize();\r\n                jQ.insertBefore(cursor.jQ);\r\n                cursor[L] = block.ends[R];\r\n                block.finalizeInsert(cursor.options, cursor);\r\n                if (block.ends[R][R].siblingCreated) block.ends[R][R].siblingCreated(cursor.options, L);\r\n                if (block.ends[L][L].siblingCreated) block.ends[L][L].siblingCreated(cursor.options, R);\r\n                cursor.parent.bubble('reflow');\r\n            }\r\n\r\n            return this;\r\n        };\r\n        _.renderLatexMath = function(latex) {\r\n            var root = this.root, cursor = this.cursor;\r\n\r\n            var all = Parser.all;\r\n            var eof = Parser.eof;\r\n\r\n            var block = latexMathParser.skip(eof).or(all.result(false)).parse(latex);\r\n\r\n            root.eachChild('postOrder', 'dispose');\r\n            root.ends[L] = root.ends[R] = 0;\r\n\r\n            if (block) {\r\n                block.children().adopt(root, 0, 0);\r\n            }\r\n\r\n            var jQ = root.jQ;\r\n\r\n            if (block) {\r\n                var html = block.join('html');\r\n                jQ.html(html);\r\n                root.jQize(jQ.children());\r\n                root.finalizeInsert(cursor.options);\r\n            }\r\n            else {\r\n                jQ.empty();\r\n            }\r\n\r\n            delete cursor.selection;\r\n            cursor.insAtRightEnd(root);\r\n        };\r\n        _.renderLatexText = function(latex) {\r\n            var root = this.root, cursor = this.cursor;\r\n\r\n            root.jQ.children().slice(1).remove();\r\n            root.eachChild('postOrder', 'dispose');\r\n            root.ends[L] = root.ends[R] = 0;\r\n            delete cursor.selection;\r\n            cursor.show().insAtRightEnd(root);\r\n\r\n            var regex = Parser.regex;\r\n            var string = Parser.string;\r\n            var eof = Parser.eof;\r\n            var all = Parser.all;\r\n\r\n            // Parser RootMathCommand\r\n            var mathMode = string('$').then(latexMathParser)\r\n                // because TeX is insane, math mode doesn't necessarily\r\n                // have to end.  So we allow for the case that math mode\r\n                // continues to the end of the stream.\r\n                .skip(string('$').or(eof))\r\n                .map(function(block) {\r\n                    // HACK FIXME: this shouldn't have to have access to cursor\r\n                    var rootMathCommand = RootMathCommand(cursor);\r\n\r\n                    rootMathCommand.createBlocks();\r\n                    var rootMathBlock = rootMathCommand.ends[L];\r\n                    block.children().adopt(rootMathBlock, 0, 0);\r\n\r\n                    return rootMathCommand;\r\n                })\r\n            ;\r\n\r\n            var escapedDollar = string('\\\\$').result('$');\r\n            var textChar = escapedDollar.or(regex(/^[^$]/)).map(VanillaSymbol);\r\n            var latexText = mathMode.or(textChar).many();\r\n            var commands = latexText.skip(eof).or(all.result(false)).parse(latex);\r\n\r\n            if (commands) {\r\n                for (var i = 0; i < commands.length; i += 1) {\r\n                    commands[i].adopt(root, root.ends[R], 0);\r\n                }\r\n\r\n                root.jQize().appendTo(root.jQ);\r\n\r\n                root.finalizeInsert(cursor.options);\r\n            }\r\n        };\r\n    });\r\n    /********************************************************\r\n     * Deals with mouse events for clicking, drag-to-select\r\n     *******************************************************/\r\n\r\n    Controller.open(function(_) {\r\n        _.delegateMouseEvents = function() {\r\n            var ultimateRootjQ = this.root.jQ;\r\n            //drag-to-select event handling\r\n            this.container.bind('mousedown.mathquill', function(e) {\r\n                var rootjQ = $(e.target).closest('.mq-root-block');\r\n                var root = Node.byId[rootjQ.attr(mqBlockId) || ultimateRootjQ.attr(mqBlockId)];\r\n                var ctrlr = root.controller, cursor = ctrlr.cursor, blink = cursor.blink;\r\n                var textareaSpan = ctrlr.textareaSpan, textarea = ctrlr.textarea;\r\n\r\n                var target;\r\n                function mousemove(e) { target = $(e.target); }\r\n                function docmousemove(e) {\r\n                    if (!cursor.anticursor) cursor.startSelection();\r\n                    ctrlr.seek(target, e.pageX, e.pageY).cursor.select();\r\n                    target = undefined;\r\n                }\r\n                // outside rootjQ, the MathQuill node corresponding to the target (if any)\r\n                // won't be inside this root, so don't mislead Controller::seek with it\r\n\r\n                function mouseup(e) {\r\n                    cursor.blink = blink;\r\n                    if (!cursor.selection) {\r\n                        if (ctrlr.editable) {\r\n                            cursor.show();\r\n                        }\r\n                        else {\r\n                            textareaSpan.detach();\r\n                        }\r\n                    }\r\n\r\n                    // delete the mouse handlers now that we're not dragging anymore\r\n                    rootjQ.unbind('mousemove', mousemove);\r\n                    $(e.target.ownerDocument).unbind('mousemove', docmousemove).unbind('mouseup', mouseup);\r\n                }\r\n\r\n                if (ctrlr.blurred) {\r\n                    if (!ctrlr.editable) rootjQ.prepend(textareaSpan);\r\n                    textarea.focus();\r\n                }\r\n                e.preventDefault(); // doesn't work in IE\\u22648, but it's a one-line fix:\r\n                e.target.unselectable = true; // http://jsbin.com/yagekiji/1\r\n\r\n                cursor.blink = noop;\r\n                ctrlr.seek($(e.target), e.pageX, e.pageY).cursor.startSelection();\r\n\r\n                rootjQ.mousemove(mousemove);\r\n                $(e.target.ownerDocument).mousemove(docmousemove).mouseup(mouseup);\r\n                // listen on document not just body to not only hear about mousemove and\r\n                // mouseup on page outside field, but even outside page, except iframes: https://github.com/mathquill/mathquill/commit/8c50028afcffcace655d8ae2049f6e02482346c5#commitcomment-6175800\r\n            });\r\n        }\r\n    });\r\n\r\n    Controller.open(function(_) {\r\n        _.seek = function(target, pageX, pageY) {\r\n            var cursor = this.notify('select').cursor;\r\n\r\n            if (target) {\r\n                var nodeId = target.attr(mqBlockId) || target.attr(mqCmdId);\r\n                if (!nodeId) {\r\n                    var targetParent = target.parent();\r\n                    nodeId = targetParent.attr(mqBlockId) || targetParent.attr(mqCmdId);\r\n                }\r\n            }\r\n            var node = nodeId ? Node.byId[nodeId] : this.root;\r\n            pray('nodeId is the id of some Node that exists', node);\r\n\r\n            // don't clear selection until after getting node from target, in case\r\n            // target was selection span, otherwise target will have no parent and will\r\n            // seek from root, which is less accurate (e.g. fraction)\r\n            cursor.clearSelection().show();\r\n\r\n            node.seek(pageX, cursor);\r\n            this.scrollHoriz(); // before .selectFrom when mouse-selecting, so\r\n                                // always hits no-selection case in scrollHoriz and scrolls slower\r\n            return this;\r\n        };\r\n    });\r\n    /***********************************************\r\n     * Horizontal panning for editable fields that\r\n     * overflow their width\r\n     **********************************************/\r\n\r\n    Controller.open(function(_) {\r\n        _.scrollHoriz = function() {\r\n            var cursor = this.cursor, seln = cursor.selection;\r\n            var rootRect = this.root.jQ[0].getBoundingClientRect();\r\n            if (!seln) {\r\n                var x = cursor.jQ[0].getBoundingClientRect().left;\r\n                if (x > rootRect.right - 20) var scrollBy = x - (rootRect.right - 20);\r\n                else if (x < rootRect.left + 20) var scrollBy = x - (rootRect.left + 20);\r\n                else return;\r\n            }\r\n            else {\r\n                var rect = seln.jQ[0].getBoundingClientRect();\r\n                var overLeft = rect.left - (rootRect.left + 20);\r\n                var overRight = rect.right - (rootRect.right - 20);\r\n                if (seln.ends[L] === cursor[R]) {\r\n                    if (overLeft < 0) var scrollBy = overLeft;\r\n                    else if (overRight > 0) {\r\n                        if (rect.left - overRight < rootRect.left + 20) var scrollBy = overLeft;\r\n                        else var scrollBy = overRight;\r\n                    }\r\n                    else return;\r\n                }\r\n                else {\r\n                    if (overRight > 0) var scrollBy = overRight;\r\n                    else if (overLeft < 0) {\r\n                        if (rect.right - overLeft > rootRect.right - 20) var scrollBy = overRight;\r\n                        else var scrollBy = overLeft;\r\n                    }\r\n                    else return;\r\n                }\r\n            }\r\n            this.root.jQ.stop().animate({ scrollLeft: '+=' + scrollBy}, 100);\r\n        };\r\n    });\r\n    /*********************************************\r\n     * Manage the MathQuill instance's textarea\r\n     * (as owned by the Controller)\r\n     ********************************************/\r\n\r\n    Controller.open(function(_) {\r\n        Options.p.substituteTextarea = function() {\r\n            return $('<textarea autocapitalize=off autocomplete=off autocorrect=off ' +\r\n                'spellcheck=false x-palm-disable-ste-all=true />')[0];\r\n        };\r\n        _.createTextarea = function() {\r\n            var textareaSpan = this.textareaSpan = $('<span class=\"mq-textarea\"></span>'),\r\n                textarea = this.options.substituteTextarea();\r\n            if (!textarea.nodeType) {\r\n                throw 'substituteTextarea() must return a DOM element, got ' + textarea;\r\n            }\r\n            textarea = this.textarea = $(textarea).appendTo(textareaSpan);\r\n\r\n            var ctrlr = this;\r\n            ctrlr.cursor.selectionChanged = function() { ctrlr.selectionChanged(); };\r\n            ctrlr.container.bind('copy', function() { ctrlr.setTextareaSelection(); });\r\n        };\r\n        _.selectionChanged = function() {\r\n            var ctrlr = this;\r\n            forceIERedraw(ctrlr.container[0]);\r\n\r\n            // throttle calls to setTextareaSelection(), because setting textarea.value\r\n            // and/or calling textarea.select() can have anomalously bad performance:\r\n            // https://github.com/mathquill/mathquill/issues/43#issuecomment-1399080\r\n            if (ctrlr.textareaSelectionTimeout === undefined) {\r\n                ctrlr.textareaSelectionTimeout = setTimeout(function() {\r\n                    ctrlr.setTextareaSelection();\r\n                });\r\n            }\r\n        };\r\n        _.setTextareaSelection = function() {\r\n            this.textareaSelectionTimeout = undefined;\r\n            var latex = '';\r\n            if (this.cursor.selection) {\r\n                latex = this.cursor.selection.join('latex');\r\n                if (this.options.statelessClipboard) {\r\n                    // FIXME: like paste, only this works for math fields; should ask parent\r\n                    latex = '$' + latex + '$';\r\n                }\r\n            }\r\n            this.selectFn(latex);\r\n        };\r\n        _.staticMathTextareaEvents = function() {\r\n            var ctrlr = this, root = ctrlr.root, cursor = ctrlr.cursor,\r\n                textarea = ctrlr.textarea, textareaSpan = ctrlr.textareaSpan;\r\n\r\n            this.container.prepend('<span class=\"mq-selectable\">$'+ctrlr.exportLatex()+'$</span>');\r\n            ctrlr.blurred = true;\r\n            textarea.bind('cut paste', false)\r\n                .focus(function() { ctrlr.blurred = false; }).blur(function() {\r\n                if (cursor.selection) cursor.selection.clear();\r\n                setTimeout(detach); //detaching during blur explodes in WebKit\r\n            });\r\n            function detach() {\r\n                textareaSpan.detach();\r\n                ctrlr.blurred = true;\r\n            }\r\n\r\n            ctrlr.selectFn = function(text) {\r\n                textarea.val(text);\r\n                if (text) textarea.select();\r\n            };\r\n        };\r\n        _.editablesTextareaEvents = function() {\r\n            var ctrlr = this, root = ctrlr.root, cursor = ctrlr.cursor,\r\n                textarea = ctrlr.textarea, textareaSpan = ctrlr.textareaSpan;\r\n\r\n            var keyboardEventsShim = saneKeyboardEvents(textarea, this);\r\n            this.selectFn = function(text) { keyboardEventsShim.select(text); };\r\n\r\n            this.container.prepend(textareaSpan)\r\n                .on('cut', function(e) {\r\n                    if (cursor.selection) {\r\n                        setTimeout(function() {\r\n                            ctrlr.notify('edit'); // deletes selection if present\r\n                            cursor.parent.bubble('reflow');\r\n                        });\r\n                    }\r\n                });\r\n\r\n            this.focusBlurEvents();\r\n        };\r\n        _.typedText = function(ch) {\r\n            if (ch === '\\n') return this.handle('enter');\r\n            var cursor = this.notify().cursor;\r\n            cursor.parent.write(cursor, ch);\r\n            this.scrollHoriz();\r\n        };\r\n        _.paste = function(text) {\r\n            // TODO: document `statelessClipboard` config option in README, after\r\n            // making it work like it should, that is, in both text and math mode\r\n            // (currently only works in math fields, so worse than pointless, it\r\n            //  only gets in the way by \\text{}-ifying pasted stuff and $-ifying\r\n            //  cut/copied LaTeX)\r\n            if (this.options.statelessClipboard) {\r\n                if (text.slice(0,1) === '$' && text.slice(-1) === '$') {\r\n                    text = text.slice(1, -1);\r\n                }\r\n                else {\r\n                    text = '\\\\text{'+text+'}';\r\n                }\r\n            }\r\n            // FIXME: this always inserts math or a TextBlock, even in a RootTextBlock\r\n            this.writeLatex(text).cursor.show();\r\n        };\r\n    });\r\n    /*************************************************\r\n     * Abstract classes of math blocks and commands.\r\n     ************************************************/\r\n\r\n    /**\r\n     * Math tree node base class.\r\n     * Some math-tree-specific extensions to Node.\r\n     * Both MathBlock's and MathCommand's descend from it.\r\n     */\r\n    var MathElement = P(Node, function(_, super_) {\r\n        _.finalizeInsert = function(options, cursor) { // `cursor` param is only for\r\n            // SupSub::contactWeld, and is deliberately only passed in by writeLatex,\r\n            // see ea7307eb4fac77c149a11ffdf9a831df85247693\r\n            var self = this;\r\n            self.postOrder('finalizeTree', options);\r\n            self.postOrder('contactWeld', cursor);\r\n\r\n            // note: this order is important.\r\n            // empty elements need the empty box provided by blur to\r\n            // be present in order for their dimensions to be measured\r\n            // correctly by 'reflow' handlers.\r\n            self.postOrder('blur');\r\n\r\n            self.postOrder('reflow');\r\n            if (self[R].siblingCreated) self[R].siblingCreated(options, L);\r\n            if (self[L].siblingCreated) self[L].siblingCreated(options, R);\r\n            self.bubble('reflow');\r\n        };\r\n    });\r\n\r\n    /**\r\n     * Commands and operators, like subscripts, exponents, or fractions.\r\n     * Descendant commands are organized into blocks.\r\n     */\r\n    var MathCommand = P(MathElement, function(_, super_) {\r\n        _.init = function(ctrlSeq, htmlTemplate, textTemplate) {\r\n            var cmd = this;\r\n            super_.init.call(cmd);\r\n\r\n            if (!cmd.ctrlSeq) cmd.ctrlSeq = ctrlSeq;\r\n            if (htmlTemplate) cmd.htmlTemplate = htmlTemplate;\r\n            if (textTemplate) cmd.textTemplate = textTemplate;\r\n        };\r\n\r\n        // obvious methods\r\n        _.replaces = function(replacedFragment) {\r\n            replacedFragment.disown();\r\n            this.replacedFragment = replacedFragment;\r\n        };\r\n        _.isEmpty = function() {\r\n            return this.foldChildren(true, function(isEmpty, child) {\r\n                return isEmpty && child.isEmpty();\r\n            });\r\n        };\r\n\r\n        _.parser = function() {\r\n            var block = latexMathParser.block;\r\n            var self = this;\r\n\r\n            return block.times(self.numBlocks()).map(function(blocks) {\r\n                self.blocks = blocks;\r\n\r\n                for (var i = 0; i < blocks.length; i += 1) {\r\n                    blocks[i].adopt(self, self.ends[R], 0);\r\n                }\r\n\r\n                return self;\r\n            });\r\n        };\r\n\r\n        // createLeftOf(cursor) and the methods it calls\r\n        _.createLeftOf = function(cursor) {\r\n            var cmd = this;\r\n            var replacedFragment = cmd.replacedFragment;\r\n\r\n            cmd.createBlocks();\r\n            super_.createLeftOf.call(cmd, cursor);\r\n            if (replacedFragment) {\r\n                replacedFragment.adopt(cmd.ends[L], 0, 0);\r\n                replacedFragment.jQ.appendTo(cmd.ends[L].jQ);\r\n            }\r\n            cmd.finalizeInsert(cursor.options);\r\n            cmd.placeCursor(cursor);\r\n        };\r\n        _.createBlocks = function() {\r\n            var cmd = this,\r\n                numBlocks = cmd.numBlocks(),\r\n                blocks = cmd.blocks = Array(numBlocks);\r\n\r\n            for (var i = 0; i < numBlocks; i += 1) {\r\n                var newBlock = blocks[i] = MathBlock();\r\n                newBlock.adopt(cmd, cmd.ends[R], 0);\r\n            }\r\n        };\r\n        _.placeCursor = function(cursor) {\r\n            //insert the cursor at the right end of the first empty child, searching\r\n            //left-to-right, or if none empty, the right end child\r\n            cursor.insAtRightEnd(this.foldChildren(this.ends[L], function(leftward, child) {\r\n                return leftward.isEmpty() ? leftward : child;\r\n            }));\r\n        };\r\n\r\n        // editability methods: called by the cursor for editing, cursor movements,\r\n        // and selection of the MathQuill tree, these all take in a direction and\r\n        // the cursor\r\n        _.moveTowards = function(dir, cursor, updown) {\r\n            var updownInto = updown && this[updown+'Into'];\r\n            cursor.insAtDirEnd(-dir, updownInto || this.ends[-dir]);\r\n        };\r\n        _.deleteTowards = function(dir, cursor) {\r\n            if (this.isEmpty()) cursor[dir] = this.remove()[dir];\r\n            else this.moveTowards(dir, cursor, null);\r\n        };\r\n        _.selectTowards = function(dir, cursor) {\r\n            cursor[-dir] = this;\r\n            cursor[dir] = this[dir];\r\n        };\r\n        _.selectChildren = function() {\r\n            return Selection(this, this);\r\n        };\r\n        _.unselectInto = function(dir, cursor) {\r\n            cursor.insAtDirEnd(-dir, cursor.anticursor.ancestors[this.id]);\r\n        };\r\n        _.seek = function(pageX, cursor) {\r\n            function getBounds(node) {\r\n                var bounds = {}\r\n                bounds[L] = node.jQ.offset().left;\r\n                bounds[R] = bounds[L] + node.jQ.outerWidth();\r\n                return bounds;\r\n            }\r\n\r\n            var cmd = this;\r\n            var cmdBounds = getBounds(cmd);\r\n\r\n            if (pageX < cmdBounds[L]) return cursor.insLeftOf(cmd);\r\n            if (pageX > cmdBounds[R]) return cursor.insRightOf(cmd);\r\n\r\n            var leftLeftBound = cmdBounds[L];\r\n            cmd.eachChild(function(block) {\r\n                var blockBounds = getBounds(block);\r\n                if (pageX < blockBounds[L]) {\r\n                    // closer to this block's left bound, or the bound left of that?\r\n                    if (pageX - leftLeftBound < blockBounds[L] - pageX) {\r\n                        if (block[L]) cursor.insAtRightEnd(block[L]);\r\n                        else cursor.insLeftOf(cmd);\r\n                    }\r\n                    else cursor.insAtLeftEnd(block);\r\n                    return false;\r\n                }\r\n                else if (pageX > blockBounds[R]) {\r\n                    if (block[R]) leftLeftBound = blockBounds[R]; // continue to next block\r\n                    else { // last (rightmost) block\r\n                        // closer to this block's right bound, or the cmd's right bound?\r\n                        if (cmdBounds[R] - pageX < pageX - blockBounds[R]) {\r\n                            cursor.insRightOf(cmd);\r\n                        }\r\n                        else cursor.insAtRightEnd(block);\r\n                    }\r\n                }\r\n                else {\r\n                    block.seek(pageX, cursor);\r\n                    return false;\r\n                }\r\n            });\r\n        }\r\n\r\n        // methods involved in creating and cross-linking with HTML DOM nodes\r\n      /*\r\n       They all expect an .htmlTemplate like\r\n       '<span>&0</span>'\r\n       or\r\n       '<span><span>&0</span><span>&1</span></span>'\r\n\r\n       See html.test.js for more examples.\r\n\r\n       Requirements:\r\n       - For each block of the command, there must be exactly one \"block content\r\n       marker\" of the form '&<number>' where <number> is the 0-based index of the\r\n       block. (Like the LaTeX \\newcommand syntax, but with a 0-based rather than\r\n       1-based index, because JavaScript because C because Dijkstra.)\r\n       - The block content marker must be the sole contents of the containing\r\n       element, there can't even be surrounding whitespace, or else we can't\r\n       guarantee sticking to within the bounds of the block content marker when\r\n       mucking with the HTML DOM.\r\n       - The HTML not only must be well-formed HTML (of course), but also must\r\n       conform to the XHTML requirements on tags, specifically all tags must\r\n       either be self-closing (like '<br/>') or come in matching pairs.\r\n       Close tags are never optional.\r\n\r\n       Note that &<number> isn't well-formed HTML; if you wanted a literal '&123',\r\n       your HTML template would have to have '&amp;123'.\r\n       */\r\n        _.numBlocks = function() {\r\n            var matches = this.htmlTemplate.match(/&\\d+/g);\r\n            return matches ? matches.length : 0;\r\n        };\r\n        _.html = function() {\r\n            // Render the entire math subtree rooted at this command, as HTML.\r\n            // Expects .createBlocks() to have been called already, since it uses the\r\n            // .blocks array of child blocks.\r\n            //\r\n            // See html.test.js for example templates and intended outputs.\r\n            //\r\n            // Given an .htmlTemplate as described above,\r\n            // - insert the mathquill-command-id attribute into all top-level tags,\r\n            //   which will be used to set this.jQ in .jQize().\r\n            //   This is straightforward:\r\n            //     * tokenize into tags and non-tags\r\n            //     * loop through top-level tokens:\r\n            //         * add #cmdId attribute macro to top-level self-closing tags\r\n            //         * else add #cmdId attribute macro to top-level open tags\r\n            //             * skip the matching top-level close tag and all tag pairs\r\n            //               in between\r\n            // - for each block content marker,\r\n            //     + replace it with the contents of the corresponding block,\r\n            //       rendered as HTML\r\n            //     + insert the mathquill-block-id attribute into the containing tag\r\n            //   This is even easier, a quick regex replace, since block tags cannot\r\n            //   contain anything besides the block content marker.\r\n            //\r\n            // Two notes:\r\n            // - The outermost loop through top-level tokens should never encounter any\r\n            //   top-level close tags, because we should have first encountered a\r\n            //   matching top-level open tag, all inner tags should have appeared in\r\n            //   matching pairs and been skipped, and then we should have skipped the\r\n            //   close tag in question.\r\n            // - All open tags should have matching close tags, which means our inner\r\n            //   loop should always encounter a close tag and drop nesting to 0. If\r\n            //   a close tag is missing, the loop will continue until i >= tokens.length\r\n            //   and token becomes undefined. This will not infinite loop, even in\r\n            //   production without pray(), because it will then TypeError on .slice().\r\n\r\n            var cmd = this;\r\n            var blocks = cmd.blocks;\r\n            var cmdId = ' mathquill-command-id=' + cmd.id;\r\n            var tokens = cmd.htmlTemplate.match(/<[^<>]+>|[^<>]+/g);\r\n\r\n            pray('no unmatched angle brackets', tokens.join('') === this.htmlTemplate);\r\n\r\n            // add cmdId to all top-level tags\r\n            for (var i = 0, token = tokens[0]; token; i += 1, token = tokens[i]) {\r\n                // top-level self-closing tags\r\n                if (token.slice(-2) === '/>') {\r\n                    tokens[i] = token.slice(0,-2) + cmdId + '/>';\r\n                }\r\n                // top-level open tags\r\n                else if (token.charAt(0) === '<') {\r\n                    pray('not an unmatched top-level close tag', token.charAt(1) !== '/');\r\n\r\n                    tokens[i] = token.slice(0,-1) + cmdId + '>';\r\n\r\n                    // skip matching top-level close tag and all tag pairs in between\r\n                    var nesting = 1;\r\n                    do {\r\n                        i += 1, token = tokens[i];\r\n                        pray('no missing close tags', token);\r\n                        // close tags\r\n                        if (token.slice(0,2) === '</') {\r\n                            nesting -= 1;\r\n                        }\r\n                        // non-self-closing open tags\r\n                        else if (token.charAt(0) === '<' && token.slice(-2) !== '/>') {\r\n                            nesting += 1;\r\n                        }\r\n                    } while (nesting > 0);\r\n                }\r\n            }\r\n            return tokens.join('').replace(/>&(\\d+)/g, function($0, $1) {\r\n                return ' mathquill-block-id=' + blocks[$1].id + '>' + blocks[$1].join('html');\r\n            });\r\n        };\r\n\r\n        // methods to export a string representation of the math tree\r\n        _.latex = function() {\r\n            return this.foldChildren(this.ctrlSeq, function(latex, child) {\r\n                return latex + '{' + (child.latex() || ' ') + '}';\r\n            });\r\n        };\r\n        _.textTemplate = [''];\r\n        _.text = function() {\r\n            var cmd = this, i = 0;\r\n            return cmd.foldChildren(cmd.textTemplate[i], function(text, child) {\r\n                i += 1;\r\n                var child_text = child.text();\r\n                if (text && cmd.textTemplate[i] === '('\r\n                    && child_text[0] === '(' && child_text.slice(-1) === ')')\r\n                    return text + child_text.slice(1, -1) + cmd.textTemplate[i];\r\n                return text + child.text() + (cmd.textTemplate[i] || '');\r\n            });\r\n        };\r\n    });\r\n\r\n    /**\r\n     * Lightweight command without blocks or children.\r\n     */\r\n    var Symbol = P(MathCommand, function(_, super_) {\r\n        _.init = function(ctrlSeq, html, text) {\r\n            if (!text) text = ctrlSeq && ctrlSeq.length > 1 ? ctrlSeq.slice(1) : ctrlSeq;\r\n\r\n            super_.init.call(this, ctrlSeq, html, [ text ]);\r\n        };\r\n\r\n        _.parser = function() { return Parser.succeed(this); };\r\n        _.numBlocks = function() { return 0; };\r\n\r\n        _.replaces = function(replacedFragment) {\r\n            replacedFragment.remove();\r\n        };\r\n        _.createBlocks = noop;\r\n\r\n        _.moveTowards = function(dir, cursor) {\r\n            cursor.jQ.insDirOf(dir, this.jQ);\r\n            cursor[-dir] = this;\r\n            cursor[dir] = this[dir];\r\n        };\r\n        _.deleteTowards = function(dir, cursor) {\r\n            cursor[dir] = this.remove()[dir];\r\n        };\r\n        _.seek = function(pageX, cursor) {\r\n            // insert at whichever side the click was closer to\r\n            if (pageX - this.jQ.offset().left < this.jQ.outerWidth()/2)\r\n                cursor.insLeftOf(this);\r\n            else\r\n                cursor.insRightOf(this);\r\n        };\r\n\r\n        _.latex = function(){ return this.ctrlSeq; };\r\n        _.text = function(){ return this.textTemplate; };\r\n        _.placeCursor = noop;\r\n        _.isEmpty = function(){ return true; };\r\n    });\r\n    var VanillaSymbol = P(Symbol, function(_, super_) {\r\n        _.init = function(ch, html) {\r\n            super_.init.call(this, ch, '<span>'+(html || ch)+'</span>');\r\n        };\r\n    });\r\n    var BinaryOperator = P(Symbol, function(_, super_) {\r\n        _.init = function(ctrlSeq, html, text) {\r\n            super_.init.call(this,\r\n                ctrlSeq, '<span class=\"mq-binary-operator\">'+html+'</span>', text\r\n            );\r\n        };\r\n    });\r\n\r\n    /**\r\n     * Children and parent of MathCommand's. Basically partitions all the\r\n     * symbols and operators that descend (in the Math DOM tree) from\r\n     * ancestor operators.\r\n     */\r\n    var MathBlock = P(MathElement, function(_, super_) {\r\n        _.join = function(methodName) {\r\n            return this.foldChildren('', function(fold, child) {\r\n                return fold + child[methodName]();\r\n            });\r\n        };\r\n        _.html = function() { return this.join('html'); };\r\n        _.latex = function() { return this.join('latex'); };\r\n        _.text = function() {\r\n            return (this.ends[L] === this.ends[R] && this.ends[L] !== 0) ?\r\n                this.ends[L].text() :\r\n                this.join('text')\r\n                ;\r\n        };\r\n\r\n        _.keystroke = function(key, e, ctrlr) {\r\n            if (ctrlr.options.spaceBehavesLikeTab\r\n                && (key === 'Spacebar' || key === 'Shift-Spacebar')) {\r\n                e.preventDefault();\r\n                ctrlr.escapeDir(key === 'Shift-Spacebar' ? L : R, key, e);\r\n                return;\r\n            }\r\n            return super_.keystroke.apply(this, arguments);\r\n        };\r\n\r\n        // editability methods: called by the cursor for editing, cursor movements,\r\n        // and selection of the MathQuill tree, these all take in a direction and\r\n        // the cursor\r\n        _.moveOutOf = function(dir, cursor, updown) {\r\n            var updownInto = updown && this.parent[updown+'Into'];\r\n            if (!updownInto && this[dir]) cursor.insAtDirEnd(-dir, this[dir]);\r\n            else cursor.insDirOf(dir, this.parent);\r\n        };\r\n        _.selectOutOf = function(dir, cursor) {\r\n            cursor.insDirOf(dir, this.parent);\r\n        };\r\n        _.deleteOutOf = function(dir, cursor) {\r\n            cursor.unwrapGramp();\r\n        };\r\n        _.seek = function(pageX, cursor) {\r\n            var node = this.ends[R];\r\n            if (!node || node.jQ.offset().left + node.jQ.outerWidth() < pageX) {\r\n                return cursor.insAtRightEnd(this);\r\n            }\r\n            if (pageX < this.ends[L].jQ.offset().left) return cursor.insAtLeftEnd(this);\r\n            while (pageX < node.jQ.offset().left) node = node[L];\r\n            return node.seek(pageX, cursor);\r\n        };\r\n        _.chToCmd = function(ch) {\r\n            var cons;\r\n            // exclude f because it gets a dedicated command with more spacing\r\n            if (ch.match(/^[a-eg-zA-Z]$/))\r\n                return Letter(ch);\r\n            else if (/^\\d$/.test(ch))\r\n                return Digit(ch);\r\n            else if (cons = CharCmds[ch] || LatexCmds[ch])\r\n                return cons(ch);\r\n            else\r\n                return VanillaSymbol(ch);\r\n        };\r\n        _.write = function(cursor, ch) {\r\n            var cmd = this.chToCmd(ch);\r\n            if (cursor.selection) cmd.replaces(cursor.replaceSelection());\r\n            cmd.createLeftOf(cursor.show());\r\n        };\r\n\r\n        _.focus = function() {\r\n            this.jQ.addClass('mq-hasCursor');\r\n            this.jQ.removeClass('mq-empty');\r\n\r\n            return this;\r\n        };\r\n        _.blur = function() {\r\n            this.jQ.removeClass('mq-hasCursor');\r\n            if (this.isEmpty())\r\n                this.jQ.addClass('mq-empty');\r\n\r\n            return this;\r\n        };\r\n    });\r\n\r\n    API.StaticMath = function(APIClasses) {\r\n        return P(APIClasses.AbstractMathQuill, function(_, super_) {\r\n            this.RootBlock = MathBlock;\r\n            _.__mathquillify = function() {\r\n                super_.__mathquillify.call(this, 'mq-math-mode');\r\n                this.__controller.delegateMouseEvents();\r\n                this.__controller.staticMathTextareaEvents();\r\n                return this;\r\n            };\r\n            _.init = function() {\r\n                super_.init.apply(this, arguments);\r\n                this.__controller.root.postOrder(\r\n                    'registerInnerField', this.innerFields = [], APIClasses.MathField);\r\n            };\r\n            _.latex = function() {\r\n                var returned = super_.latex.apply(this, arguments);\r\n                if (arguments.length > 0) {\r\n                    this.__controller.root.postOrder(\r\n                        'registerInnerField', this.innerFields = [], APIClasses.MathField);\r\n                }\r\n                return returned;\r\n            };\r\n        });\r\n    };\r\n\r\n    var RootMathBlock = P(MathBlock, RootBlockMixin);\r\n    API.MathField = function(APIClasses) {\r\n        return P(APIClasses.EditableField, function(_, super_) {\r\n            this.RootBlock = RootMathBlock;\r\n            _.__mathquillify = function(opts, interfaceVersion) {\r\n                this.config(opts);\r\n                if (interfaceVersion > 1) this.__controller.root.reflow = noop;\r\n                super_.__mathquillify.call(this, 'mq-editable-field mq-math-mode');\r\n                delete this.__controller.root.reflow;\r\n                return this;\r\n            };\r\n        });\r\n    };\r\n    /*************************************************\r\n     * Abstract classes of text blocks\r\n     ************************************************/\r\n\r\n    /**\r\n     * Blocks of plain text, with one or two TextPiece's as children.\r\n     * Represents flat strings of typically serif-font Roman characters, as\r\n     * opposed to hierchical, nested, tree-structured math.\r\n     * Wraps a single HTMLSpanElement.\r\n     */\r\n    var TextBlock = P(Node, function(_, super_) {\r\n        _.ctrlSeq = '\\\\text';\r\n\r\n        _.replaces = function(replacedText) {\r\n            if (replacedText instanceof Fragment)\r\n                this.replacedText = replacedText.remove().jQ.text();\r\n            else if (typeof replacedText === 'string')\r\n                this.replacedText = replacedText;\r\n        };\r\n\r\n        _.jQadd = function(jQ) {\r\n            super_.jQadd.call(this, jQ);\r\n            if (this.ends[L]) this.ends[L].jQadd(this.jQ[0].firstChild);\r\n        };\r\n\r\n        _.createLeftOf = function(cursor) {\r\n            var textBlock = this;\r\n            super_.createLeftOf.call(this, cursor);\r\n\r\n            if (textBlock[R].siblingCreated) textBlock[R].siblingCreated(cursor.options, L);\r\n            if (textBlock[L].siblingCreated) textBlock[L].siblingCreated(cursor.options, R);\r\n            textBlock.bubble('reflow');\r\n\r\n            cursor.insAtRightEnd(textBlock);\r\n\r\n            if (textBlock.replacedText)\r\n                for (var i = 0; i < textBlock.replacedText.length; i += 1)\r\n                    textBlock.write(cursor, textBlock.replacedText.charAt(i));\r\n        };\r\n\r\n        _.parser = function() {\r\n            var textBlock = this;\r\n\r\n            // TODO: correctly parse text mode\r\n            var string = Parser.string;\r\n            var regex = Parser.regex;\r\n            var optWhitespace = Parser.optWhitespace;\r\n            return optWhitespace\r\n                .then(string('{')).then(regex(/^[^}]*/)).skip(string('}'))\r\n                .map(function(text) {\r\n                    // TODO: is this the correct behavior when parsing\r\n                    // the latex \\text{} ?  This violates the requirement that\r\n                    // the text contents are always nonempty.  Should we just\r\n                    // disown the parent node instead?\r\n                    TextPiece(text).adopt(textBlock, 0, 0);\r\n                    return textBlock;\r\n                })\r\n                ;\r\n        };\r\n\r\n        _.textContents = function() {\r\n            return this.foldChildren('', function(text, child) {\r\n                return text + child.text;\r\n            });\r\n        };\r\n        _.text = function() { return '\"' + this.textContents() + '\"'; };\r\n        _.latex = function() { return '\\\\text{' + this.textContents() + '}'; };\r\n        _.html = function() {\r\n            return (\r\n                '<span class=\"mq-text-mode\" mathquill-command-id='+this.id+'>'\r\n                +   this.textContents()\r\n                + '</span>'\r\n            );\r\n        };\r\n\r\n        // editability methods: called by the cursor for editing, cursor movements,\r\n        // and selection of the MathQuill tree, these all take in a direction and\r\n        // the cursor\r\n        _.moveTowards = function(dir, cursor) { cursor.insAtDirEnd(-dir, this); };\r\n        _.moveOutOf = function(dir, cursor) { cursor.insDirOf(dir, this); };\r\n        _.unselectInto = _.moveTowards;\r\n\r\n        // TODO: make these methods part of a shared mixin or something.\r\n        _.selectTowards = MathCommand.prototype.selectTowards;\r\n        _.deleteTowards = MathCommand.prototype.deleteTowards;\r\n\r\n        _.selectOutOf = function(dir, cursor) {\r\n            cursor.insDirOf(dir, this);\r\n        };\r\n        _.deleteOutOf = function(dir, cursor) {\r\n            // backspace and delete at ends of block don't unwrap\r\n            if (this.isEmpty()) cursor.insRightOf(this);\r\n        };\r\n        _.write = function(cursor, ch) {\r\n            cursor.show().deleteSelection();\r\n\r\n            if (ch !== '$') {\r\n                if (!cursor[L]) TextPiece(ch).createLeftOf(cursor);\r\n                else cursor[L].appendText(ch);\r\n            }\r\n            else if (this.isEmpty()) {\r\n                cursor.insRightOf(this);\r\n                VanillaSymbol('\\\\$','$').createLeftOf(cursor);\r\n            }\r\n            else if (!cursor[R]) cursor.insRightOf(this);\r\n            else if (!cursor[L]) cursor.insLeftOf(this);\r\n            else { // split apart\r\n                var leftBlock = TextBlock();\r\n                var leftPc = this.ends[L];\r\n                leftPc.disown();\r\n                leftPc.adopt(leftBlock, 0, 0);\r\n\r\n                cursor.insLeftOf(this);\r\n                super_.createLeftOf.call(leftBlock, cursor);\r\n            }\r\n        };\r\n\r\n        _.seek = function(pageX, cursor) {\r\n            cursor.hide();\r\n            var textPc = fuseChildren(this);\r\n\r\n            // insert cursor at approx position in DOMTextNode\r\n            var avgChWidth = this.jQ.width()/this.text.length;\r\n            var approxPosition = Math.round((pageX - this.jQ.offset().left)/avgChWidth);\r\n            if (approxPosition <= 0) cursor.insAtLeftEnd(this);\r\n            else if (approxPosition >= textPc.text.length) cursor.insAtRightEnd(this);\r\n            else cursor.insLeftOf(textPc.splitRight(approxPosition));\r\n\r\n            // move towards mousedown (pageX)\r\n            var displ = pageX - cursor.show().offset().left; // displacement\r\n            var dir = displ && displ < 0 ? L : R;\r\n            var prevDispl = dir;\r\n            // displ * prevDispl > 0 iff displacement direction === previous direction\r\n            while (cursor[dir] && displ * prevDispl > 0) {\r\n                cursor[dir].moveTowards(dir, cursor);\r\n                prevDispl = displ;\r\n                displ = pageX - cursor.offset().left;\r\n            }\r\n            if (dir*displ < -dir*prevDispl) cursor[-dir].moveTowards(-dir, cursor);\r\n\r\n            if (!cursor.anticursor) {\r\n                // about to start mouse-selecting, the anticursor is gonna get put here\r\n                this.anticursorPosition = cursor[L] && cursor[L].text.length;\r\n                // ^ get it? 'cos if there's no cursor[L], it's 0... I'm a terrible person.\r\n            }\r\n            else if (cursor.anticursor.parent === this) {\r\n                // mouse-selecting within this TextBlock, re-insert the anticursor\r\n                var cursorPosition = cursor[L] && cursor[L].text.length;;\r\n                if (this.anticursorPosition === cursorPosition) {\r\n                    cursor.anticursor = Point.copy(cursor);\r\n                }\r\n                else {\r\n                    if (this.anticursorPosition < cursorPosition) {\r\n                        var newTextPc = cursor[L].splitRight(this.anticursorPosition);\r\n                        cursor[L] = newTextPc;\r\n                    }\r\n                    else {\r\n                        var newTextPc = cursor[R].splitRight(this.anticursorPosition - cursorPosition);\r\n                    }\r\n                    cursor.anticursor = Point(this, newTextPc[L], newTextPc);\r\n                }\r\n            }\r\n        };\r\n\r\n        _.blur = function() {\r\n            MathBlock.prototype.blur.call(this);\r\n            fuseChildren(this);\r\n        };\r\n\r\n        function fuseChildren(self) {\r\n            self.jQ[0].normalize();\r\n\r\n            var textPcDom = self.jQ[0].firstChild;\r\n            pray('only node in TextBlock span is Text node', textPcDom.nodeType === 3);\r\n            // nodeType === 3 has meant a Text node since ancient times:\r\n            //   http://reference.sitepoint.com/javascript/Node/nodeType\r\n\r\n            var textPc = TextPiece(textPcDom.data);\r\n            textPc.jQadd(textPcDom);\r\n\r\n            self.children().disown();\r\n            return textPc.adopt(self, 0, 0);\r\n        }\r\n\r\n        _.focus = MathBlock.prototype.focus;\r\n    });\r\n\r\n    /**\r\n     * Piece of plain text, with a TextBlock as a parent and no children.\r\n     * Wraps a single DOMTextNode.\r\n     * For convenience, has a .text property that's just a JavaScript string\r\n     * mirroring the text contents of the DOMTextNode.\r\n     * Text contents must always be nonempty.\r\n     */\r\n    var TextPiece = P(Node, function(_, super_) {\r\n        _.init = function(text) {\r\n            super_.init.call(this);\r\n            this.text = text;\r\n        };\r\n        _.jQadd = function(dom) { this.dom = dom; this.jQ = $(dom); };\r\n        _.jQize = function() {\r\n            return this.jQadd(document.createTextNode(this.text));\r\n        };\r\n        _.appendText = function(text) {\r\n            this.text += text;\r\n            this.dom.appendData(text);\r\n        };\r\n        _.prependText = function(text) {\r\n            this.text = text + this.text;\r\n            this.dom.insertData(0, text);\r\n        };\r\n        _.insTextAtDirEnd = function(text, dir) {\r\n            prayDirection(dir);\r\n            if (dir === R) this.appendText(text);\r\n            else this.prependText(text);\r\n        };\r\n        _.splitRight = function(i) {\r\n            var newPc = TextPiece(this.text.slice(i)).adopt(this.parent, this, this[R]);\r\n            newPc.jQadd(this.dom.splitText(i));\r\n            this.text = this.text.slice(0, i);\r\n            return newPc;\r\n        };\r\n\r\n        function endChar(dir, text) {\r\n            return text.charAt(dir === L ? 0 : -1 + text.length);\r\n        }\r\n\r\n        _.moveTowards = function(dir, cursor) {\r\n            prayDirection(dir);\r\n\r\n            var ch = endChar(-dir, this.text)\r\n\r\n            var from = this[-dir];\r\n            if (from) from.insTextAtDirEnd(ch, dir);\r\n            else TextPiece(ch).createDir(-dir, cursor);\r\n\r\n            return this.deleteTowards(dir, cursor);\r\n        };\r\n\r\n        _.latex = function() { return this.text; };\r\n\r\n        _.deleteTowards = function(dir, cursor) {\r\n            if (this.text.length > 1) {\r\n                if (dir === R) {\r\n                    this.dom.deleteData(0, 1);\r\n                    this.text = this.text.slice(1);\r\n                }\r\n                else {\r\n                    // note that the order of these 2 lines is annoyingly important\r\n                    // (the second line mutates this.text.length)\r\n                    this.dom.deleteData(-1 + this.text.length, 1);\r\n                    this.text = this.text.slice(0, -1);\r\n                }\r\n            }\r\n            else {\r\n                this.remove();\r\n                this.jQ.remove();\r\n                cursor[dir] = this[dir];\r\n            }\r\n        };\r\n\r\n        _.selectTowards = function(dir, cursor) {\r\n            prayDirection(dir);\r\n            var anticursor = cursor.anticursor;\r\n\r\n            var ch = endChar(-dir, this.text)\r\n\r\n            if (anticursor[dir] === this) {\r\n                var newPc = TextPiece(ch).createDir(dir, cursor);\r\n                anticursor[dir] = newPc;\r\n                cursor.insDirOf(dir, newPc);\r\n            }\r\n            else {\r\n                var from = this[-dir];\r\n                if (from) from.insTextAtDirEnd(ch, dir);\r\n                else {\r\n                    var newPc = TextPiece(ch).createDir(-dir, cursor);\r\n                    newPc.jQ.insDirOf(-dir, cursor.selection.jQ);\r\n                }\r\n\r\n                if (this.text.length === 1 && anticursor[-dir] === this) {\r\n                    anticursor[-dir] = this[-dir]; // `this` will be removed in deleteTowards\r\n                }\r\n            }\r\n\r\n            return this.deleteTowards(dir, cursor);\r\n        };\r\n    });\r\n\r\n    CharCmds.$ =\r\n        LatexCmds.text =\r\n            LatexCmds.textnormal =\r\n                LatexCmds.textrm =\r\n                    LatexCmds.textup =\r\n                        LatexCmds.textmd = TextBlock;\r\n\r\n    function makeTextBlock(latex, tagName, attrs) {\r\n        return P(TextBlock, {\r\n            ctrlSeq: latex,\r\n            htmlTemplate: '<'+tagName+' '+attrs+'>&0</'+tagName+'>'\r\n        });\r\n    }\r\n\r\n    LatexCmds.em = LatexCmds.italic = LatexCmds.italics =\r\n        LatexCmds.emph = LatexCmds.textit = LatexCmds.textsl =\r\n            makeTextBlock('\\\\textit', 'i', 'class=\"mq-text-mode\"');\r\n    LatexCmds.strong = LatexCmds.bold = LatexCmds.textbf =\r\n        makeTextBlock('\\\\textbf', 'b', 'class=\"mq-text-mode\"');\r\n    LatexCmds.sf = LatexCmds.textsf =\r\n        makeTextBlock('\\\\textsf', 'span', 'class=\"mq-sans-serif mq-text-mode\"');\r\n    LatexCmds.tt = LatexCmds.texttt =\r\n        makeTextBlock('\\\\texttt', 'span', 'class=\"mq-monospace mq-text-mode\"');\r\n    LatexCmds.textsc =\r\n        makeTextBlock('\\\\textsc', 'span', 'style=\"font-variant:small-caps\" class=\"mq-text-mode\"');\r\n    LatexCmds.uppercase =\r\n        makeTextBlock('\\\\uppercase', 'span', 'style=\"text-transform:uppercase\" class=\"mq-text-mode\"');\r\n    LatexCmds.lowercase =\r\n        makeTextBlock('\\\\lowercase', 'span', 'style=\"text-transform:lowercase\" class=\"mq-text-mode\"');\r\n\r\n\r\n    var RootMathCommand = P(MathCommand, function(_, super_) {\r\n        _.init = function(cursor) {\r\n            super_.init.call(this, '$');\r\n            this.cursor = cursor;\r\n        };\r\n        _.htmlTemplate = '<span class=\"mq-math-mode\">&0</span>';\r\n        _.createBlocks = function() {\r\n            super_.createBlocks.call(this);\r\n\r\n            this.ends[L].cursor = this.cursor;\r\n            this.ends[L].write = function(cursor, ch) {\r\n                if (ch !== '$')\r\n                    MathBlock.prototype.write.call(this, cursor, ch);\r\n                else if (this.isEmpty()) {\r\n                    cursor.insRightOf(this.parent);\r\n                    this.parent.deleteTowards(dir, cursor);\r\n                    VanillaSymbol('\\\\$','$').createLeftOf(cursor.show());\r\n                }\r\n                else if (!cursor[R])\r\n                    cursor.insRightOf(this.parent);\r\n                else if (!cursor[L])\r\n                    cursor.insLeftOf(this.parent);\r\n                else\r\n                    MathBlock.prototype.write.call(this, cursor, ch);\r\n            };\r\n        };\r\n        _.latex = function() {\r\n            return '$' + this.ends[L].latex() + '$';\r\n        };\r\n    });\r\n\r\n    var RootTextBlock = P(RootMathBlock, function(_, super_) {\r\n        _.keystroke = function(key) {\r\n            if (key === 'Spacebar' || key === 'Shift-Spacebar') return;\r\n            return super_.keystroke.apply(this, arguments);\r\n        };\r\n        _.write = function(cursor, ch) {\r\n            cursor.show().deleteSelection();\r\n            if (ch === '$')\r\n                RootMathCommand(cursor).createLeftOf(cursor);\r\n            else {\r\n                var html;\r\n                if (ch === '<') html = '&lt;';\r\n                else if (ch === '>') html = '&gt;';\r\n                VanillaSymbol(ch, html).createLeftOf(cursor);\r\n            }\r\n        };\r\n    });\r\n    API.TextField = function(APIClasses) {\r\n        return P(APIClasses.EditableField, function(_, super_) {\r\n            this.RootBlock = RootTextBlock;\r\n            _.__mathquillify = function() {\r\n                return super_.__mathquillify.call(this, 'mq-editable-field mq-text-mode');\r\n            };\r\n            _.latex = function(latex) {\r\n                if (arguments.length > 0) {\r\n                    this.__controller.renderLatexText(latex);\r\n                    if (this.__controller.blurred) this.__controller.cursor.hide().parent.blur();\r\n                    return this;\r\n                }\r\n                return this.__controller.exportLatex();\r\n            };\r\n        });\r\n    };\r\n    /****************************************\r\n     * Input box to type backslash commands\r\n     ***************************************/\r\n\r\n    var LatexCommandInput =\r\n        CharCmds['\\\\'] = P(MathCommand, function(_, super_) {\r\n            _.ctrlSeq = '\\\\';\r\n            _.replaces = function(replacedFragment) {\r\n                this._replacedFragment = replacedFragment.disown();\r\n                this.isEmpty = function() { return false; };\r\n            };\r\n            _.htmlTemplate = '<span class=\"mq-latex-command-input mq-non-leaf\">\\\\<span>&0</span></span>';\r\n            _.textTemplate = ['\\\\'];\r\n            _.createBlocks = function() {\r\n                super_.createBlocks.call(this);\r\n                this.ends[L].focus = function() {\r\n                    this.parent.jQ.addClass('mq-hasCursor');\r\n                    if (this.isEmpty())\r\n                        this.parent.jQ.removeClass('mq-empty');\r\n\r\n                    return this;\r\n                };\r\n                this.ends[L].blur = function() {\r\n                    this.parent.jQ.removeClass('mq-hasCursor');\r\n                    if (this.isEmpty())\r\n                        this.parent.jQ.addClass('mq-empty');\r\n\r\n                    return this;\r\n                };\r\n                this.ends[L].write = function(cursor, ch) {\r\n                    cursor.show().deleteSelection();\r\n\r\n                    if (ch.match(/[a-z]/i)) VanillaSymbol(ch).createLeftOf(cursor);\r\n                    else {\r\n                        this.parent.renderCommand(cursor);\r\n                        if (ch !== '\\\\' || !this.isEmpty()) this.parent.parent.write(cursor, ch);\r\n                    }\r\n                };\r\n                this.ends[L].keystroke = function(key, e, ctrlr) {\r\n                    if (key === 'Tab' || key === 'Enter' || key === 'Spacebar') {\r\n                        this.parent.renderCommand(ctrlr.cursor);\r\n                        e.preventDefault();\r\n                        return;\r\n                    }\r\n                    return super_.keystroke.apply(this, arguments);\r\n                };\r\n            };\r\n            _.createLeftOf = function(cursor) {\r\n                super_.createLeftOf.call(this, cursor);\r\n\r\n                if (this._replacedFragment) {\r\n                    var el = this.jQ[0];\r\n                    this.jQ =\r\n                        this._replacedFragment.jQ.addClass('mq-blur').bind(\r\n                            'mousedown mousemove', //FIXME: is monkey-patching the mousedown and mousemove handlers the right way to do this?\r\n                            function(e) {\r\n                                $(e.target = el).trigger(e);\r\n                                return false;\r\n                            }\r\n                        ).insertBefore(this.jQ).add(this.jQ);\r\n                }\r\n            };\r\n            _.latex = function() {\r\n                return '\\\\' + this.ends[L].latex() + ' ';\r\n            };\r\n            _.renderCommand = function(cursor) {\r\n                this.jQ = this.jQ.last();\r\n                this.remove();\r\n                if (this[R]) {\r\n                    cursor.insLeftOf(this[R]);\r\n                } else {\r\n                    cursor.insAtRightEnd(this.parent);\r\n                }\r\n\r\n                var latex = this.ends[L].latex();\r\n                if (!latex) latex = ' ';\r\n                var cmd = LatexCmds[latex];\r\n                if (cmd) {\r\n                    cmd = cmd(latex);\r\n                    if (this._replacedFragment) cmd.replaces(this._replacedFragment);\r\n                    cmd.createLeftOf(cursor);\r\n                }\r\n                else {\r\n                    cmd = TextBlock();\r\n                    cmd.replaces(latex);\r\n                    cmd.createLeftOf(cursor);\r\n                    cursor.insRightOf(cmd);\r\n                    if (this._replacedFragment)\r\n                        this._replacedFragment.remove();\r\n                }\r\n            };\r\n        });\r\n\r\n    /************************************\r\n     * Symbols for Advanced Mathematics\r\n     ***********************************/\r\n\r\n    LatexCmds.notin =\r\n        LatexCmds.cong =\r\n            LatexCmds.equiv =\r\n                LatexCmds.oplus =\r\n                    LatexCmds.otimes = P(BinaryOperator, function(_, super_) {\r\n                        _.init = function(latex) {\r\n                            super_.init.call(this, '\\\\'+latex+' ', '&'+latex+';');\r\n                        };\r\n                    });\r\n\r\n    LatexCmds['\\u2260'] = LatexCmds.ne = LatexCmds.neq = bind(BinaryOperator,'\\\\ne ','&ne;');\r\n\r\n    LatexCmds.ast = LatexCmds.star = LatexCmds.loast = LatexCmds.lowast =\r\n        bind(BinaryOperator,'\\\\ast ','&lowast;');\r\n    //case 'there4 = // a special exception for this one, perhaps?\r\n    LatexCmds.therefor = LatexCmds.therefore =\r\n        bind(BinaryOperator,'\\\\therefore ','&there4;');\r\n\r\n    LatexCmds.cuz = // l33t\r\n        LatexCmds.because = bind(BinaryOperator,'\\\\because ','&#8757;');\r\n\r\n    LatexCmds.prop = LatexCmds.propto = bind(BinaryOperator,'\\\\propto ','&prop;');\r\n\r\n    LatexCmds['\\u2248'] = LatexCmds.asymp = LatexCmds.approx = bind(BinaryOperator,'\\\\approx ','&asymp;');\r\n\r\n    LatexCmds.isin = LatexCmds['in'] = bind(BinaryOperator,'\\\\in ','&isin;');\r\n\r\n    LatexCmds.ni = LatexCmds.contains = bind(BinaryOperator,'\\\\ni ','&ni;');\r\n\r\n    LatexCmds.notni = LatexCmds.niton = LatexCmds.notcontains = LatexCmds.doesnotcontain =\r\n        bind(BinaryOperator,'\\\\not\\\\ni ','&#8716;');\r\n\r\n    LatexCmds.sub = LatexCmds.subset = bind(BinaryOperator,'\\\\subset ','&sub;');\r\n\r\n    LatexCmds.sup = LatexCmds.supset = LatexCmds.superset =\r\n        bind(BinaryOperator,'\\\\supset ','&sup;');\r\n\r\n    LatexCmds.nsub = LatexCmds.notsub =\r\n        LatexCmds.nsubset = LatexCmds.notsubset =\r\n            bind(BinaryOperator,'\\\\not\\\\subset ','&#8836;');\r\n\r\n    LatexCmds.nsup = LatexCmds.notsup =\r\n        LatexCmds.nsupset = LatexCmds.notsupset =\r\n            LatexCmds.nsuperset = LatexCmds.notsuperset =\r\n                bind(BinaryOperator,'\\\\not\\\\supset ','&#8837;');\r\n\r\n    LatexCmds.sube = LatexCmds.subeq = LatexCmds.subsete = LatexCmds.subseteq =\r\n        bind(BinaryOperator,'\\\\subseteq ','&sube;');\r\n\r\n    LatexCmds.supe = LatexCmds.supeq =\r\n        LatexCmds.supsete = LatexCmds.supseteq =\r\n            LatexCmds.supersete = LatexCmds.superseteq =\r\n                bind(BinaryOperator,'\\\\supseteq ','&supe;');\r\n\r\n    LatexCmds.nsube = LatexCmds.nsubeq =\r\n        LatexCmds.notsube = LatexCmds.notsubeq =\r\n            LatexCmds.nsubsete = LatexCmds.nsubseteq =\r\n                LatexCmds.notsubsete = LatexCmds.notsubseteq =\r\n                    bind(BinaryOperator,'\\\\not\\\\subseteq ','&#8840;');\r\n\r\n    LatexCmds.nsupe = LatexCmds.nsupeq =\r\n        LatexCmds.notsupe = LatexCmds.notsupeq =\r\n            LatexCmds.nsupsete = LatexCmds.nsupseteq =\r\n                LatexCmds.notsupsete = LatexCmds.notsupseteq =\r\n                    LatexCmds.nsupersete = LatexCmds.nsuperseteq =\r\n                        LatexCmds.notsupersete = LatexCmds.notsuperseteq =\r\n                            bind(BinaryOperator,'\\\\not\\\\supseteq ','&#8841;');\r\n\r\n\r\n//the canonical sets of numbers\r\n    LatexCmds.N = LatexCmds.naturals = LatexCmds.Naturals =\r\n        bind(VanillaSymbol,'\\\\mathbb{N}','&#8469;');\r\n\r\n    LatexCmds.P =\r\n        LatexCmds.primes = LatexCmds.Primes =\r\n            LatexCmds.projective = LatexCmds.Projective =\r\n                LatexCmds.probability = LatexCmds.Probability =\r\n                    bind(VanillaSymbol,'\\\\mathbb{P}','&#8473;');\r\n\r\n    LatexCmds.Z = LatexCmds.integers = LatexCmds.Integers =\r\n        bind(VanillaSymbol,'\\\\mathbb{Z}','&#8484;');\r\n\r\n    LatexCmds.Q = LatexCmds.rationals = LatexCmds.Rationals =\r\n        bind(VanillaSymbol,'\\\\mathbb{Q}','&#8474;');\r\n\r\n    LatexCmds.R = LatexCmds.reals = LatexCmds.Reals =\r\n        bind(VanillaSymbol,'\\\\mathbb{R}','&#8477;');\r\n\r\n    LatexCmds.C =\r\n        LatexCmds.complex = LatexCmds.Complex =\r\n            LatexCmds.complexes = LatexCmds.Complexes =\r\n                LatexCmds.complexplane = LatexCmds.Complexplane = LatexCmds.ComplexPlane =\r\n                    bind(VanillaSymbol,'\\\\mathbb{C}','&#8450;');\r\n\r\n    LatexCmds.H = LatexCmds.Hamiltonian = LatexCmds.quaternions = LatexCmds.Quaternions =\r\n        bind(VanillaSymbol,'\\\\mathbb{H}','&#8461;');\r\n\r\n//spacing\r\n    LatexCmds.quad = LatexCmds.emsp = bind(VanillaSymbol,'\\\\quad ','    ');\r\n    LatexCmds.qquad = bind(VanillaSymbol,'\\\\qquad ','        ');\r\n  /* spacing special characters, gonna have to implement this in LatexCommandInput::onText somehow\r\n   case ',':\r\n   return VanillaSymbol('\\\\, ',' ');\r\n   case ':':\r\n   return VanillaSymbol('\\\\: ','  ');\r\n   case ';':\r\n   return VanillaSymbol('\\\\; ','   ');\r\n   case '!':\r\n   return Symbol('\\\\! ','<span style=\"margin-right:-.2em\"></span>');\r\n   */\r\n\r\n//binary operators\r\n    LatexCmds.diamond = bind(VanillaSymbol, '\\\\diamond ', '&#9671;');\r\n    LatexCmds.bigtriangleup = bind(VanillaSymbol, '\\\\bigtriangleup ', '&#9651;');\r\n    LatexCmds.ominus = bind(VanillaSymbol, '\\\\ominus ', '&#8854;');\r\n    LatexCmds.uplus = bind(VanillaSymbol, '\\\\uplus ', '&#8846;');\r\n    LatexCmds.bigtriangledown = bind(VanillaSymbol, '\\\\bigtriangledown ', '&#9661;');\r\n    LatexCmds.sqcap = bind(VanillaSymbol, '\\\\sqcap ', '&#8851;');\r\n    LatexCmds.triangleleft = bind(VanillaSymbol, '\\\\triangleleft ', '&#8882;');\r\n    LatexCmds.sqcup = bind(VanillaSymbol, '\\\\sqcup ', '&#8852;');\r\n    LatexCmds.triangleright = bind(VanillaSymbol, '\\\\triangleright ', '&#8883;');\r\n//circledot is not a not real LaTex command see https://github.com/mathquill/mathquill/pull/552 for more details\r\n    LatexCmds.odot = LatexCmds.circledot = bind(VanillaSymbol, '\\\\odot ', '&#8857;');\r\n    LatexCmds.bigcirc = bind(VanillaSymbol, '\\\\bigcirc ', '&#9711;');\r\n    LatexCmds.dagger = bind(VanillaSymbol, '\\\\dagger ', '&#0134;');\r\n    LatexCmds.ddagger = bind(VanillaSymbol, '\\\\ddagger ', '&#135;');\r\n    LatexCmds.wr = bind(VanillaSymbol, '\\\\wr ', '&#8768;');\r\n    LatexCmds.amalg = bind(VanillaSymbol, '\\\\amalg ', '&#8720;');\r\n\r\n//relationship symbols\r\n    LatexCmds.models = bind(VanillaSymbol, '\\\\models ', '&#8872;');\r\n    LatexCmds.prec = bind(VanillaSymbol, '\\\\prec ', '&#8826;');\r\n    LatexCmds.succ = bind(VanillaSymbol, '\\\\succ ', '&#8827;');\r\n    LatexCmds.preceq = bind(VanillaSymbol, '\\\\preceq ', '&#8828;');\r\n    LatexCmds.succeq = bind(VanillaSymbol, '\\\\succeq ', '&#8829;');\r\n    LatexCmds.simeq = bind(VanillaSymbol, '\\\\simeq ', '&#8771;');\r\n    LatexCmds.mid = bind(VanillaSymbol, '\\\\mid ', '&#8739;');\r\n    LatexCmds.ll = bind(VanillaSymbol, '\\\\ll ', '&#8810;');\r\n    LatexCmds.gg = bind(VanillaSymbol, '\\\\gg ', '&#8811;');\r\n    LatexCmds.parallel = bind(VanillaSymbol, '\\\\parallel ', '&#8741;');\r\n    LatexCmds.nparallel = bind(VanillaSymbol, '\\\\nparallel ', '&#8742;');\r\n    LatexCmds.bowtie = bind(VanillaSymbol, '\\\\bowtie ', '&#8904;');\r\n    LatexCmds.sqsubset = bind(VanillaSymbol, '\\\\sqsubset ', '&#8847;');\r\n    LatexCmds.sqsupset = bind(VanillaSymbol, '\\\\sqsupset ', '&#8848;');\r\n    LatexCmds.smile = bind(VanillaSymbol, '\\\\smile ', '&#8995;');\r\n    LatexCmds.sqsubseteq = bind(VanillaSymbol, '\\\\sqsubseteq ', '&#8849;');\r\n    LatexCmds.sqsupseteq = bind(VanillaSymbol, '\\\\sqsupseteq ', '&#8850;');\r\n    LatexCmds.doteq = bind(VanillaSymbol, '\\\\doteq ', '&#8784;');\r\n    LatexCmds.frown = bind(VanillaSymbol, '\\\\frown ', '&#8994;');\r\n    LatexCmds.vdash = bind(VanillaSymbol, '\\\\vdash ', '&#8870;');\r\n    LatexCmds.dashv = bind(VanillaSymbol, '\\\\dashv ', '&#8867;');\r\n    LatexCmds.nless = bind(VanillaSymbol, '\\\\nless ', '&#8814;');\r\n    LatexCmds.ngtr = bind(VanillaSymbol, '\\\\ngtr ', '&#8815;');\r\n\r\n//arrows\r\n    LatexCmds.longleftarrow = bind(VanillaSymbol, '\\\\longleftarrow ', '&#8592;');\r\n    LatexCmds.longrightarrow = bind(VanillaSymbol, '\\\\longrightarrow ', '&#8594;');\r\n    LatexCmds.Longleftarrow = bind(VanillaSymbol, '\\\\Longleftarrow ', '&#8656;');\r\n    LatexCmds.Longrightarrow = bind(VanillaSymbol, '\\\\Longrightarrow ', '&#8658;');\r\n    LatexCmds.longleftrightarrow = bind(VanillaSymbol, '\\\\longleftrightarrow ', '&#8596;');\r\n    LatexCmds.updownarrow = bind(VanillaSymbol, '\\\\updownarrow ', '&#8597;');\r\n    LatexCmds.Longleftrightarrow = bind(VanillaSymbol, '\\\\Longleftrightarrow ', '&#8660;');\r\n    LatexCmds.Updownarrow = bind(VanillaSymbol, '\\\\Updownarrow ', '&#8661;');\r\n    LatexCmds.mapsto = bind(VanillaSymbol, '\\\\mapsto ', '&#8614;');\r\n    LatexCmds.nearrow = bind(VanillaSymbol, '\\\\nearrow ', '&#8599;');\r\n    LatexCmds.hookleftarrow = bind(VanillaSymbol, '\\\\hookleftarrow ', '&#8617;');\r\n    LatexCmds.hookrightarrow = bind(VanillaSymbol, '\\\\hookrightarrow ', '&#8618;');\r\n    LatexCmds.searrow = bind(VanillaSymbol, '\\\\searrow ', '&#8600;');\r\n    LatexCmds.leftharpoonup = bind(VanillaSymbol, '\\\\leftharpoonup ', '&#8636;');\r\n    LatexCmds.rightharpoonup = bind(VanillaSymbol, '\\\\rightharpoonup ', '&#8640;');\r\n    LatexCmds.swarrow = bind(VanillaSymbol, '\\\\swarrow ', '&#8601;');\r\n    LatexCmds.leftharpoondown = bind(VanillaSymbol, '\\\\leftharpoondown ', '&#8637;');\r\n    LatexCmds.rightharpoondown = bind(VanillaSymbol, '\\\\rightharpoondown ', '&#8641;');\r\n    LatexCmds.nwarrow = bind(VanillaSymbol, '\\\\nwarrow ', '&#8598;');\r\n\r\n//Misc\r\n    LatexCmds.ldots = bind(VanillaSymbol, '\\\\ldots ', '&#8230;');\r\n    LatexCmds.cdots = bind(VanillaSymbol, '\\\\cdots ', '&#8943;');\r\n    LatexCmds.vdots = bind(VanillaSymbol, '\\\\vdots ', '&#8942;');\r\n    LatexCmds.ddots = bind(VanillaSymbol, '\\\\ddots ', '&#8945;');\r\n    LatexCmds.surd = bind(VanillaSymbol, '\\\\surd ', '&#8730;');\r\n    LatexCmds.triangle = bind(VanillaSymbol, '\\\\triangle ', '&#9651;');\r\n    LatexCmds.ell = bind(VanillaSymbol, '\\\\ell ', '&#8467;');\r\n    LatexCmds.top = bind(VanillaSymbol, '\\\\top ', '&#8868;');\r\n    LatexCmds.flat = bind(VanillaSymbol, '\\\\flat ', '&#9837;');\r\n    LatexCmds.natural = bind(VanillaSymbol, '\\\\natural ', '&#9838;');\r\n    LatexCmds.sharp = bind(VanillaSymbol, '\\\\sharp ', '&#9839;');\r\n    LatexCmds.wp = bind(VanillaSymbol, '\\\\wp ', '&#8472;');\r\n    LatexCmds.bot = bind(VanillaSymbol, '\\\\bot ', '&#8869;');\r\n    LatexCmds.clubsuit = bind(VanillaSymbol, '\\\\clubsuit ', '&#9827;');\r\n    LatexCmds.diamondsuit = bind(VanillaSymbol, '\\\\diamondsuit ', '&#9826;');\r\n    LatexCmds.heartsuit = bind(VanillaSymbol, '\\\\heartsuit ', '&#9825;');\r\n    LatexCmds.spadesuit = bind(VanillaSymbol, '\\\\spadesuit ', '&#9824;');\r\n//not real LaTex command see https://github.com/mathquill/mathquill/pull/552 for more details\r\n    LatexCmds.parallelogram = bind(VanillaSymbol, '\\\\parallelogram ', '&#9649;');\r\n    LatexCmds.square = bind(VanillaSymbol, '\\\\square ', '&#11036;');\r\n\r\n//variable-sized\r\n    LatexCmds.oint = bind(VanillaSymbol, '\\\\oint ', '&#8750;');\r\n    LatexCmds.bigcap = bind(VanillaSymbol, '\\\\bigcap ', '&#8745;');\r\n    LatexCmds.bigcup = bind(VanillaSymbol, '\\\\bigcup ', '&#8746;');\r\n    LatexCmds.bigsqcup = bind(VanillaSymbol, '\\\\bigsqcup ', '&#8852;');\r\n    LatexCmds.bigvee = bind(VanillaSymbol, '\\\\bigvee ', '&#8744;');\r\n    LatexCmds.bigwedge = bind(VanillaSymbol, '\\\\bigwedge ', '&#8743;');\r\n    LatexCmds.bigodot = bind(VanillaSymbol, '\\\\bigodot ', '&#8857;');\r\n    LatexCmds.bigotimes = bind(VanillaSymbol, '\\\\bigotimes ', '&#8855;');\r\n    LatexCmds.bigoplus = bind(VanillaSymbol, '\\\\bigoplus ', '&#8853;');\r\n    LatexCmds.biguplus = bind(VanillaSymbol, '\\\\biguplus ', '&#8846;');\r\n\r\n//delimiters\r\n    LatexCmds.lfloor = bind(VanillaSymbol, '\\\\lfloor ', '&#8970;');\r\n    LatexCmds.rfloor = bind(VanillaSymbol, '\\\\rfloor ', '&#8971;');\r\n    LatexCmds.lceil = bind(VanillaSymbol, '\\\\lceil ', '&#8968;');\r\n    LatexCmds.rceil = bind(VanillaSymbol, '\\\\rceil ', '&#8969;');\r\n    LatexCmds.opencurlybrace = LatexCmds.lbrace = bind(VanillaSymbol, '\\\\lbrace ', '{');\r\n    LatexCmds.closecurlybrace = LatexCmds.rbrace = bind(VanillaSymbol, '\\\\rbrace ', '}');\r\n    LatexCmds.lbrack = bind(VanillaSymbol, '[');\r\n    LatexCmds.rbrack = bind(VanillaSymbol, ']');\r\n\r\n//various symbols\r\n    LatexCmds['\\u222b'] =\r\n        LatexCmds['int'] =\r\n            LatexCmds.integral = bind(Symbol,'\\\\int ','<big>&int;</big>');\r\n\r\n    LatexCmds.slash = bind(VanillaSymbol, '/');\r\n    LatexCmds.vert = bind(VanillaSymbol,'|');\r\n    LatexCmds.perp = LatexCmds.perpendicular = bind(VanillaSymbol,'\\\\perp ','&perp;');\r\n    LatexCmds.nabla = LatexCmds.del = bind(VanillaSymbol,'\\\\nabla ','&nabla;');\r\n    LatexCmds.hbar = bind(VanillaSymbol,'\\\\hbar ','&#8463;');\r\n\r\n    LatexCmds.AA = LatexCmds.Angstrom = LatexCmds.angstrom =\r\n        bind(VanillaSymbol,'\\\\text\\\\AA ','&#8491;');\r\n\r\n    LatexCmds.ring = LatexCmds.circ = LatexCmds.circle =\r\n        bind(VanillaSymbol,'\\\\circ ','&#8728;');\r\n\r\n    LatexCmds.bull = LatexCmds.bullet = bind(VanillaSymbol,'\\\\bullet ','&bull;');\r\n\r\n    LatexCmds.setminus = LatexCmds.smallsetminus =\r\n        bind(VanillaSymbol,'\\\\setminus ','&#8726;');\r\n\r\n    LatexCmds.not = //bind(Symbol,'\\\\not ','<span class=\"not\">/</span>');\r\n        LatexCmds['\\u00ac'] = LatexCmds.neg = bind(VanillaSymbol,'\\\\neg ','&not;');\r\n\r\n    LatexCmds['\\u2026'] = LatexCmds.dots = LatexCmds.ellip = LatexCmds.hellip =\r\n        LatexCmds.ellipsis = LatexCmds.hellipsis =\r\n            bind(VanillaSymbol,'\\\\dots ','&hellip;');\r\n\r\n    LatexCmds.converges =\r\n        LatexCmds.darr = LatexCmds.dnarr = LatexCmds.dnarrow = LatexCmds.downarrow =\r\n            bind(VanillaSymbol,'\\\\downarrow ','&darr;');\r\n\r\n    LatexCmds.dArr = LatexCmds.dnArr = LatexCmds.dnArrow = LatexCmds.Downarrow =\r\n        bind(VanillaSymbol,'\\\\Downarrow ','&dArr;');\r\n\r\n    LatexCmds.diverges = LatexCmds.uarr = LatexCmds.uparrow =\r\n        bind(VanillaSymbol,'\\\\uparrow ','&uarr;');\r\n\r\n    LatexCmds.uArr = LatexCmds.Uparrow = bind(VanillaSymbol,'\\\\Uparrow ','&uArr;');\r\n\r\n    LatexCmds.to = bind(BinaryOperator,'\\\\to ','&rarr;');\r\n\r\n    LatexCmds.rarr = LatexCmds.rightarrow = bind(VanillaSymbol,'\\\\rightarrow ','&rarr;');\r\n\r\n    LatexCmds.implies = bind(BinaryOperator,'\\\\Rightarrow ','&rArr;');\r\n\r\n    LatexCmds.rArr = LatexCmds.Rightarrow = bind(VanillaSymbol,'\\\\Rightarrow ','&rArr;');\r\n\r\n    LatexCmds.gets = bind(BinaryOperator,'\\\\gets ','&larr;');\r\n\r\n    LatexCmds.larr = LatexCmds.leftarrow = bind(VanillaSymbol,'\\\\leftarrow ','&larr;');\r\n\r\n    LatexCmds.impliedby = bind(BinaryOperator,'\\\\Leftarrow ','&lArr;');\r\n\r\n    LatexCmds.lArr = LatexCmds.Leftarrow = bind(VanillaSymbol,'\\\\Leftarrow ','&lArr;');\r\n\r\n    LatexCmds.harr = LatexCmds.lrarr = LatexCmds.leftrightarrow =\r\n        bind(VanillaSymbol,'\\\\leftrightarrow ','&harr;');\r\n\r\n    LatexCmds.iff = bind(BinaryOperator,'\\\\Leftrightarrow ','&hArr;');\r\n\r\n    LatexCmds.hArr = LatexCmds.lrArr = LatexCmds.Leftrightarrow =\r\n        bind(VanillaSymbol,'\\\\Leftrightarrow ','&hArr;');\r\n\r\n    LatexCmds.Re = LatexCmds.Real = LatexCmds.real = bind(VanillaSymbol,'\\\\Re ','&real;');\r\n\r\n    LatexCmds.Im = LatexCmds.imag =\r\n        LatexCmds.image = LatexCmds.imagin = LatexCmds.imaginary = LatexCmds.Imaginary =\r\n            bind(VanillaSymbol,'\\\\Im ','&image;');\r\n\r\n    LatexCmds.part = LatexCmds.partial = bind(VanillaSymbol,'\\\\partial ','&part;');\r\n\r\n    LatexCmds.infty = LatexCmds.infin = LatexCmds.infinity =\r\n        bind(VanillaSymbol,'\\\\infty ','&infin;');\r\n\r\n    LatexCmds.alef = LatexCmds.alefsym = LatexCmds.aleph = LatexCmds.alephsym =\r\n        bind(VanillaSymbol,'\\\\aleph ','&alefsym;');\r\n\r\n    LatexCmds.xist = //LOL\r\n        LatexCmds.xists = LatexCmds.exist = LatexCmds.exists =\r\n            bind(VanillaSymbol,'\\\\exists ','&exist;');\r\n\r\n    LatexCmds.and = LatexCmds.land = LatexCmds.wedge =\r\n        bind(VanillaSymbol,'\\\\wedge ','&and;');\r\n\r\n    LatexCmds.or = LatexCmds.lor = LatexCmds.vee = bind(VanillaSymbol,'\\\\vee ','&or;');\r\n\r\n    LatexCmds.o = LatexCmds.O =\r\n        LatexCmds.empty = LatexCmds.emptyset =\r\n            LatexCmds.oslash = LatexCmds.Oslash =\r\n                LatexCmds.nothing = LatexCmds.varnothing =\r\n                    bind(BinaryOperator,'\\\\varnothing ','&empty;');\r\n\r\n    LatexCmds.cup = LatexCmds.union = bind(BinaryOperator,'\\\\cup ','&cup;');\r\n\r\n    LatexCmds.cap = LatexCmds.intersect = LatexCmds.intersection =\r\n        bind(BinaryOperator,'\\\\cap ','&cap;');\r\n\r\n// FIXME: the correct LaTeX would be ^\\circ but we can't parse that\r\n    LatexCmds.deg = LatexCmds.degree = bind(VanillaSymbol,'\\\\degree ','&deg;');\r\n\r\n    LatexCmds.ang = LatexCmds.angle = bind(VanillaSymbol,'\\\\angle ','&ang;');\r\n    LatexCmds.measuredangle = bind(VanillaSymbol,'\\\\measuredangle ','&#8737;');\r\n    /*********************************\r\n     * Symbols for Basic Mathematics\r\n     ********************************/\r\n\r\n    var Digit = P(VanillaSymbol, function(_, super_) {\r\n        _.createLeftOf = function(cursor) {\r\n            if (cursor.options.autoSubscriptNumerals\r\n                && cursor.parent !== cursor.parent.parent.sub\r\n                && ((cursor[L] instanceof Variable && cursor[L].isItalic !== false)\r\n                || (cursor[L] instanceof SupSub\r\n                && cursor[L][L] instanceof Variable\r\n                && cursor[L][L].isItalic !== false))) {\r\n                LatexCmds._().createLeftOf(cursor);\r\n                super_.createLeftOf.call(this, cursor);\r\n                cursor.insRightOf(cursor.parent.parent);\r\n            }\r\n            else super_.createLeftOf.call(this, cursor);\r\n        };\r\n    });\r\n\r\n    var Variable = P(Symbol, function(_, super_) {\r\n        _.init = function(ch, html) {\r\n            super_.init.call(this, ch, '<var>'+(html || ch)+'</var>');\r\n        };\r\n        _.text = function() {\r\n            var text = this.ctrlSeq;\r\n            if (this[L] && !(this[L] instanceof Variable)\r\n                && !(this[L] instanceof BinaryOperator)\r\n                && this[L].ctrlSeq !== \"\\\\ \")\r\n                text = '*' + text;\r\n            if (this[R] && !(this[R] instanceof BinaryOperator)\r\n                && !(this[R] instanceof SupSub))\r\n                text += '*';\r\n            return text;\r\n        };\r\n    });\r\n\r\n    Options.p.autoCommands = { _maxLength: 0 };\r\n    optionProcessors.autoCommands = function(cmds) {\r\n        if (!/^[a-z]+(?: [a-z]+)*$/i.test(cmds)) {\r\n            throw '\"'+cmds+'\" not a space-delimited list of only letters';\r\n        }\r\n        var list = cmds.split(' '), dict = {}, maxLength = 0;\r\n        for (var i = 0; i < list.length; i += 1) {\r\n            var cmd = list[i];\r\n            if (cmd.length < 2) {\r\n                throw 'autocommand \"'+cmd+'\" not minimum length of 2';\r\n            }\r\n            if (LatexCmds[cmd] === OperatorName) {\r\n                throw '\"' + cmd + '\" is a built-in operator name';\r\n            }\r\n            dict[cmd] = 1;\r\n            maxLength = max(maxLength, cmd.length);\r\n        }\r\n        dict._maxLength = maxLength;\r\n        return dict;\r\n    };\r\n\r\n    var Letter = P(Variable, function(_, super_) {\r\n        _.init = function(ch) { return super_.init.call(this, this.letter = ch); };\r\n        _.createLeftOf = function(cursor) {\r\n            var autoCmds = cursor.options.autoCommands, maxLength = autoCmds._maxLength;\r\n            if (maxLength > 0) {\r\n                // want longest possible autocommand, so join together longest\r\n                // sequence of letters\r\n                var str = this.letter, l = cursor[L], i = 1;\r\n                while (l instanceof Letter && i < maxLength) {\r\n                    str = l.letter + str, l = l[L], i += 1;\r\n                }\r\n                // check for an autocommand, going thru substrings longest to shortest\r\n                while (str.length) {\r\n                    if (autoCmds.hasOwnProperty(str)) {\r\n                        for (var i = 2, l = cursor[L]; i < str.length; i += 1, l = l[L]);\r\n                        Fragment(l, cursor[L]).remove();\r\n                        cursor[L] = l[L];\r\n                        return LatexCmds[str](str).createLeftOf(cursor);\r\n                    }\r\n                    str = str.slice(1);\r\n                }\r\n            }\r\n            super_.createLeftOf.apply(this, arguments);\r\n        };\r\n        _.italicize = function(bool) {\r\n            this.isItalic = bool;\r\n            this.jQ.toggleClass('mq-operator-name', !bool);\r\n            return this;\r\n        };\r\n        _.finalizeTree = _.siblingDeleted = _.siblingCreated = function(opts, dir) {\r\n            // don't auto-un-italicize if the sibling to my right changed (dir === R or\r\n            // undefined) and it's now a Letter, it will un-italicize everyone\r\n            if (dir !== L && this[R] instanceof Letter) return;\r\n            this.autoUnItalicize(opts);\r\n        };\r\n        _.autoUnItalicize = function(opts) {\r\n            var autoOps = opts.autoOperatorNames;\r\n            if (autoOps._maxLength === 0) return;\r\n            // want longest possible operator names, so join together entire contiguous\r\n            // sequence of letters\r\n            var str = this.letter;\r\n            for (var l = this[L]; l instanceof Letter; l = l[L]) str = l.letter + str;\r\n            for (var r = this[R]; r instanceof Letter; r = r[R]) str += r.letter;\r\n\r\n            // removeClass and delete flags from all letters before figuring out\r\n            // which, if any, are part of an operator name\r\n            Fragment(l[R] || this.parent.ends[L], r[L] || this.parent.ends[R]).each(function(el) {\r\n                el.italicize(true).jQ.removeClass('mq-first mq-last');\r\n                el.ctrlSeq = el.letter;\r\n            });\r\n\r\n            // check for operator names: at each position from left to right, check\r\n            // substrings from longest to shortest\r\n            outer: for (var i = 0, first = l[R] || this.parent.ends[L]; i < str.length; i += 1, first = first[R]) {\r\n                for (var len = min(autoOps._maxLength, str.length - i); len > 0; len -= 1) {\r\n                    var word = str.slice(i, i + len);\r\n                    if (autoOps.hasOwnProperty(word)) {\r\n                        for (var j = 0, letter = first; j < len; j += 1, letter = letter[R]) {\r\n                            letter.italicize(false);\r\n                            var last = letter;\r\n                        }\r\n\r\n                        var isBuiltIn = BuiltInOpNames.hasOwnProperty(word);\r\n                        first.ctrlSeq = (isBuiltIn ? '\\\\' : '\\\\operatorname{') + first.ctrlSeq;\r\n                        last.ctrlSeq += (isBuiltIn ? ' ' : '}');\r\n                        if (TwoWordOpNames.hasOwnProperty(word)) last[L][L][L].jQ.addClass('mq-last');\r\n                        if (nonOperatorSymbol(first[L])) first.jQ.addClass('mq-first');\r\n                        if (nonOperatorSymbol(last[R])) last.jQ.addClass('mq-last');\r\n\r\n                        i += len - 1;\r\n                        first = last;\r\n                        continue outer;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n        function nonOperatorSymbol(node) {\r\n            return node instanceof Symbol && !(node instanceof BinaryOperator);\r\n        }\r\n    });\r\n    var BuiltInOpNames = {}; // the set of operator names like \\sin, \\cos, etc that\r\n    // are built-into LaTeX: http://latex.wikia.com/wiki/List_of_LaTeX_symbols#Named_operators:_sin.2C_cos.2C_etc.\r\n    // MathQuill auto-unitalicizes some operator names not in that set, like 'hcf'\r\n    // and 'arsinh', which must be exported as \\operatorname{hcf} and\r\n    // \\operatorname{arsinh}. Note: over/under line/arrow \\lim variants like\r\n    // \\varlimsup are not supported\r\n    var AutoOpNames = Options.p.autoOperatorNames = { _maxLength: 9 }; // the set\r\n    // of operator names that MathQuill auto-unitalicizes by default; overridable\r\n    var TwoWordOpNames = { limsup: 1, liminf: 1, projlim: 1, injlim: 1 };\r\n    (function() {\r\n        var mostOps = ('arg deg det dim exp gcd hom inf ker lg lim ln log max min sup'\r\n        + ' limsup liminf injlim projlim Pr').split(' ');\r\n        for (var i = 0; i < mostOps.length; i += 1) {\r\n            BuiltInOpNames[mostOps[i]] = AutoOpNames[mostOps[i]] = 1;\r\n        }\r\n\r\n        var builtInTrigs = // why coth but not sech and csch, LaTeX?\r\n            'sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth'.split(' ');\r\n        for (var i = 0; i < builtInTrigs.length; i += 1) {\r\n            BuiltInOpNames[builtInTrigs[i]] = 1;\r\n        }\r\n\r\n        var autoTrigs = 'sin cos tan sec cosec csc cotan cot ctg'.split(' ');\r\n        for (var i = 0; i < autoTrigs.length; i += 1) {\r\n            AutoOpNames[autoTrigs[i]] =\r\n                AutoOpNames['arc'+autoTrigs[i]] =\r\n                    AutoOpNames[autoTrigs[i]+'h'] =\r\n                        AutoOpNames['ar'+autoTrigs[i]+'h'] =\r\n                            AutoOpNames['arc'+autoTrigs[i]+'h'] = 1;\r\n        }\r\n\r\n        // compat with some of the nonstandard LaTeX exported by MathQuill\r\n        // before #247. None of these are real LaTeX commands so, seems safe\r\n        var moreNonstandardOps = 'gcf hcf lcm proj span'.split(' ');\r\n        for (var i = 0; i < moreNonstandardOps.length; i += 1) {\r\n            AutoOpNames[moreNonstandardOps[i]] = 1;\r\n        }\r\n    }());\r\n    optionProcessors.autoOperatorNames = function(cmds) {\r\n        if (!/^[a-z]+(?: [a-z]+)*$/i.test(cmds)) {\r\n            throw '\"'+cmds+'\" not a space-delimited list of only letters';\r\n        }\r\n        var list = cmds.split(' '), dict = {}, maxLength = 0;\r\n        for (var i = 0; i < list.length; i += 1) {\r\n            var cmd = list[i];\r\n            if (cmd.length < 2) {\r\n                throw '\"'+cmd+'\" not minimum length of 2';\r\n            }\r\n            dict[cmd] = 1;\r\n            maxLength = max(maxLength, cmd.length);\r\n        }\r\n        dict._maxLength = maxLength;\r\n        return dict;\r\n    };\r\n    var OperatorName = P(Symbol, function(_, super_) {\r\n        _.init = function(fn) { this.ctrlSeq = fn; };\r\n        _.createLeftOf = function(cursor) {\r\n            var fn = this.ctrlSeq;\r\n            for (var i = 0; i < fn.length; i += 1) {\r\n                Letter(fn.charAt(i)).createLeftOf(cursor);\r\n            }\r\n        };\r\n        _.parser = function() {\r\n            var fn = this.ctrlSeq;\r\n            var block = MathBlock();\r\n            for (var i = 0; i < fn.length; i += 1) {\r\n                Letter(fn.charAt(i)).adopt(block, block.ends[R], 0);\r\n            }\r\n            return Parser.succeed(block.children());\r\n        };\r\n    });\r\n    for (var fn in AutoOpNames) if (AutoOpNames.hasOwnProperty(fn)) {\r\n        LatexCmds[fn] = OperatorName;\r\n    }\r\n    LatexCmds.operatorname = P(MathCommand, function(_) {\r\n        _.createLeftOf = noop;\r\n        _.numBlocks = function() { return 1; };\r\n        _.parser = function() {\r\n            return latexMathParser.block.map(function(b) { return b.children(); });\r\n        };\r\n    });\r\n\r\n    LatexCmds.f = P(Letter, function(_, super_) {\r\n        _.init = function() {\r\n            Symbol.p.init.call(this, this.letter = 'f', '<var class=\"mq-f\">f</var>');\r\n        };\r\n        _.italicize = function(bool) {\r\n            this.jQ.html('f').toggleClass('mq-f', bool);\r\n            return super_.italicize.apply(this, arguments);\r\n        };\r\n    });\r\n\r\n// VanillaSymbol's\r\n    LatexCmds[' '] = LatexCmds.space = bind(VanillaSymbol, '\\\\ ', '&nbsp;');\r\n\r\n    LatexCmds[\"'\"] = LatexCmds.prime = bind(VanillaSymbol, \"'\", '&prime;');\r\n\r\n    LatexCmds.backslash = bind(VanillaSymbol,'\\\\backslash ','\\\\');\r\n    if (!CharCmds['\\\\']) CharCmds['\\\\'] = LatexCmds.backslash;\r\n\r\n    LatexCmds.$ = bind(VanillaSymbol, '\\\\$', '$');\r\n\r\n// does not use Symbola font\r\n    var NonSymbolaSymbol = P(Symbol, function(_, super_) {\r\n        _.init = function(ch, html) {\r\n            super_.init.call(this, ch, '<span class=\"mq-nonSymbola\">'+(html || ch)+'</span>');\r\n        };\r\n    });\r\n\r\n    LatexCmds['@'] = NonSymbolaSymbol;\r\n    LatexCmds['&'] = bind(NonSymbolaSymbol, '\\\\&', '&amp;');\r\n    LatexCmds['%'] = bind(NonSymbolaSymbol, '\\\\%', '%');\r\n\r\n//the following are all Greek to me, but this helped a lot: http://www.ams.org/STIX/ion/stixsig03.html\r\n\r\n//lowercase Greek letter variables\r\n    LatexCmds.alpha =\r\n        LatexCmds.beta =\r\n            LatexCmds.gamma =\r\n                LatexCmds.delta =\r\n                    LatexCmds.zeta =\r\n                        LatexCmds.eta =\r\n                            LatexCmds.theta =\r\n                                LatexCmds.iota =\r\n                                    LatexCmds.kappa =\r\n                                        LatexCmds.mu =\r\n                                            LatexCmds.nu =\r\n                                                LatexCmds.xi =\r\n                                                    LatexCmds.rho =\r\n                                                        LatexCmds.sigma =\r\n                                                            LatexCmds.tau =\r\n                                                                LatexCmds.chi =\r\n                                                                    LatexCmds.psi =\r\n                                                                        LatexCmds.omega = P(Variable, function(_, super_) {\r\n                                                                            _.init = function(latex) {\r\n                                                                                super_.init.call(this,'\\\\'+latex+' ','&'+latex+';');\r\n                                                                            };\r\n                                                                        });\r\n\r\n//why can't anybody FUCKING agree on these\r\n    LatexCmds.phi = //W3C or Unicode?\r\n        bind(Variable,'\\\\phi ','&#981;');\r\n\r\n    LatexCmds.phiv = //Elsevier and 9573-13\r\n        LatexCmds.varphi = //AMS and LaTeX\r\n            bind(Variable,'\\\\varphi ','&phi;');\r\n\r\n    LatexCmds.epsilon = //W3C or Unicode?\r\n        bind(Variable,'\\\\epsilon ','&#1013;');\r\n\r\n    LatexCmds.epsiv = //Elsevier and 9573-13\r\n        LatexCmds.varepsilon = //AMS and LaTeX\r\n            bind(Variable,'\\\\varepsilon ','&epsilon;');\r\n\r\n    LatexCmds.piv = //W3C/Unicode and Elsevier and 9573-13\r\n        LatexCmds.varpi = //AMS and LaTeX\r\n            bind(Variable,'\\\\varpi ','&piv;');\r\n\r\n    LatexCmds.sigmaf = //W3C/Unicode\r\n        LatexCmds.sigmav = //Elsevier\r\n            LatexCmds.varsigma = //LaTeX\r\n                bind(Variable,'\\\\varsigma ','&sigmaf;');\r\n\r\n    LatexCmds.thetav = //Elsevier and 9573-13\r\n        LatexCmds.vartheta = //AMS and LaTeX\r\n            LatexCmds.thetasym = //W3C/Unicode\r\n                bind(Variable,'\\\\vartheta ','&thetasym;');\r\n\r\n    LatexCmds.upsilon = //AMS and LaTeX and W3C/Unicode\r\n        LatexCmds.upsi = //Elsevier and 9573-13\r\n            bind(Variable,'\\\\upsilon ','&upsilon;');\r\n\r\n//these aren't even mentioned in the HTML character entity references\r\n    LatexCmds.gammad = //Elsevier\r\n        LatexCmds.Gammad = //9573-13 -- WTF, right? I dunno if this was a typo in the reference (see above)\r\n            LatexCmds.digamma = //LaTeX\r\n                bind(Variable,'\\\\digamma ','&#989;');\r\n\r\n    LatexCmds.kappav = //Elsevier\r\n        LatexCmds.varkappa = //AMS and LaTeX\r\n            bind(Variable,'\\\\varkappa ','&#1008;');\r\n\r\n    LatexCmds.rhov = //Elsevier and 9573-13\r\n        LatexCmds.varrho = //AMS and LaTeX\r\n            bind(Variable,'\\\\varrho ','&#1009;');\r\n\r\n//Greek constants, look best in non-italicized Times New Roman\r\n    LatexCmds.pi = LatexCmds['\\u03c0'] = bind(NonSymbolaSymbol,'\\\\pi ','&pi;');\r\n    LatexCmds.lambda = bind(NonSymbolaSymbol,'\\\\lambda ','&lambda;');\r\n\r\n//uppercase greek letters\r\n\r\n    LatexCmds.Upsilon = //LaTeX\r\n        LatexCmds.Upsi = //Elsevier and 9573-13\r\n            LatexCmds.upsih = //W3C/Unicode \"upsilon with hook\"\r\n                LatexCmds.Upsih = //'cos it makes sense to me\r\n                    bind(Symbol,'\\\\Upsilon ','<var style=\"font-family: serif\">&upsih;</var>'); //Symbola's 'upsilon with a hook' is a capital Y without hooks :(\r\n\r\n//other symbols with the same LaTeX command and HTML character entity reference\r\n    LatexCmds.Gamma =\r\n        LatexCmds.Delta =\r\n            LatexCmds.Theta =\r\n                LatexCmds.Lambda =\r\n                    LatexCmds.Xi =\r\n                        LatexCmds.Pi =\r\n                            LatexCmds.Sigma =\r\n                                LatexCmds.Phi =\r\n                                    LatexCmds.Psi =\r\n                                        LatexCmds.Omega =\r\n                                            LatexCmds.forall = P(VanillaSymbol, function(_, super_) {\r\n                                                _.init = function(latex) {\r\n                                                    super_.init.call(this,'\\\\'+latex+' ','&'+latex+';');\r\n                                                };\r\n                                            });\r\n\r\n// symbols that aren't a single MathCommand, but are instead a whole\r\n// Fragment. Creates the Fragment from a LaTeX string\r\n    var LatexFragment = P(MathCommand, function(_) {\r\n        _.init = function(latex) { this.latex = latex; };\r\n        _.createLeftOf = function(cursor) {\r\n            var block = latexMathParser.parse(this.latex);\r\n            block.children().adopt(cursor.parent, cursor[L], cursor[R]);\r\n            cursor[L] = block.ends[R];\r\n            block.jQize().insertBefore(cursor.jQ);\r\n            block.finalizeInsert(cursor.options, cursor);\r\n            if (block.ends[R][R].siblingCreated) block.ends[R][R].siblingCreated(cursor.options, L);\r\n            if (block.ends[L][L].siblingCreated) block.ends[L][L].siblingCreated(cursor.options, R);\r\n            cursor.parent.bubble('reflow');\r\n        };\r\n        _.parser = function() {\r\n            var frag = latexMathParser.parse(this.latex).children();\r\n            return Parser.succeed(frag);\r\n        };\r\n    });\r\n\r\n// for what seems to me like [stupid reasons][1], Unicode provides\r\n// subscripted and superscripted versions of all ten Arabic numerals,\r\n// as well as [so-called \"vulgar fractions\"][2].\r\n// Nobody really cares about most of them, but some of them actually\r\n// predate Unicode, dating back to [ISO-8859-1][3], apparently also\r\n// known as \"Latin-1\", which among other things [Windows-1252][4]\r\n// largely coincides with, so Microsoft Word sometimes inserts them\r\n// and they get copy-pasted into MathQuill.\r\n//\r\n// (Irrelevant but funny story: though not a superset of Latin-1 aka\r\n// ISO-8859-1, Windows-1252 **is** a strict superset of the \"closely\r\n// related but distinct\"[3] \"ISO 8859-1\" -- see the lack of a dash\r\n// after \"ISO\"? Completely different character set, like elephants vs\r\n// elephant seals, or \"Zombies\" vs \"Zombie Redneck Torture Family\".\r\n// What kind of idiot would get them confused.\r\n// People in fact got them confused so much, it was so common to\r\n// mislabel Windows-1252 text as ISO-8859-1, that most modern web\r\n// browsers and email clients treat the MIME charset of ISO-8859-1\r\n// as actually Windows-1252, behavior now standard in the HTML5 spec.)\r\n//\r\n// [1]: http://en.wikipedia.org/wiki/Unicode_subscripts_andsuper_scripts\r\n// [2]: http://en.wikipedia.org/wiki/Number_Forms\r\n// [3]: http://en.wikipedia.org/wiki/ISO/IEC_8859-1\r\n// [4]: http://en.wikipedia.org/wiki/Windows-1252\r\n    LatexCmds['\\u00b9'] = bind(LatexFragment, '^1');\r\n    LatexCmds['\\u00b2'] = bind(LatexFragment, '^2');\r\n    LatexCmds['\\u00b3'] = bind(LatexFragment, '^3');\r\n    LatexCmds['\\u00bc'] = bind(LatexFragment, '\\\\frac14');\r\n    LatexCmds['\\u00bd'] = bind(LatexFragment, '\\\\frac12');\r\n    LatexCmds['\\u00be'] = bind(LatexFragment, '\\\\frac34');\r\n\r\n    var PlusMinus = P(BinaryOperator, function(_) {\r\n        _.init = VanillaSymbol.prototype.init;\r\n\r\n        _.contactWeld = _.siblingCreated = _.siblingDeleted = function(opts, dir) {\r\n            if (dir === R) return; // ignore if sibling only changed on the right\r\n            this.jQ[0].className =\r\n                (!this[L] || this[L] instanceof BinaryOperator ? '' : 'mq-binary-operator');\r\n            return this;\r\n        };\r\n    });\r\n\r\n    LatexCmds['+'] = bind(PlusMinus, '+', '+');\r\n//yes, these are different dashes, I think one is an en dash and the other is a hyphen\r\n    LatexCmds['\\u2013'] = LatexCmds['-'] = bind(PlusMinus, '-', '&minus;');\r\n    LatexCmds['\\u00b1'] = LatexCmds.pm = LatexCmds.plusmn = LatexCmds.plusminus =\r\n        bind(PlusMinus,'\\\\pm ','&plusmn;');\r\n    LatexCmds.mp = LatexCmds.mnplus = LatexCmds.minusplus =\r\n        bind(PlusMinus,'\\\\mp ','&#8723;');\r\n\r\n    CharCmds['*'] = LatexCmds.sdot = LatexCmds.cdot =\r\n        bind(BinaryOperator, '\\\\cdot ', '&middot;', '*');\r\n//semantically should be &sdot;, but &middot; looks better\r\n\r\n    var Inequality = P(BinaryOperator, function(_, super_) {\r\n        _.init = function(data, strict) {\r\n            this.data = data;\r\n            this.strict = strict;\r\n            var strictness = (strict ? 'Strict' : '');\r\n            super_.init.call(this, data['ctrlSeq'+strictness], data['html'+strictness],\r\n                data['text'+strictness]);\r\n        };\r\n        _.swap = function(strict) {\r\n            this.strict = strict;\r\n            var strictness = (strict ? 'Strict' : '');\r\n            this.ctrlSeq = this.data['ctrlSeq'+strictness];\r\n            this.jQ.html(this.data['html'+strictness]);\r\n            this.textTemplate = [ this.data['text'+strictness] ];\r\n        };\r\n        _.deleteTowards = function(dir, cursor) {\r\n            if (dir === L && !this.strict) {\r\n                this.swap(true);\r\n                this.bubble('reflow');\r\n                return;\r\n            }\r\n            super_.deleteTowards.apply(this, arguments);\r\n        };\r\n    });\r\n\r\n    var less = { ctrlSeq: '\\\\le ', html: '&le;', text: '\\u2264',\r\n        ctrlSeqStrict: '<', htmlStrict: '&lt;', textStrict: '<' };\r\n    var greater = { ctrlSeq: '\\\\ge ', html: '&ge;', text: '\\u2265',\r\n        ctrlSeqStrict: '>', htmlStrict: '&gt;', textStrict: '>' };\r\n\r\n    LatexCmds['<'] = LatexCmds.lt = bind(Inequality, less, true);\r\n    LatexCmds['>'] = LatexCmds.gt = bind(Inequality, greater, true);\r\n    LatexCmds['\\u2264'] = LatexCmds.le = LatexCmds.leq = bind(Inequality, less, false);\r\n    LatexCmds['\\u2265'] = LatexCmds.ge = LatexCmds.geq = bind(Inequality, greater, false);\r\n\r\n    var Equality = P(BinaryOperator, function(_, super_) {\r\n        _.init = function() {\r\n            super_.init.call(this, '=', '=');\r\n        };\r\n        _.createLeftOf = function(cursor) {\r\n            if (cursor[L] instanceof Inequality && cursor[L].strict) {\r\n                cursor[L].swap(false);\r\n                cursor[L].bubble('reflow');\r\n                return;\r\n            }\r\n            super_.createLeftOf.apply(this, arguments);\r\n        };\r\n    });\r\n    LatexCmds['='] = Equality;\r\n\r\n    LatexCmds['\\u00d7'] = LatexCmds.times = bind(BinaryOperator, '\\\\times ', '&times;', '[x]');\r\n\r\n    LatexCmds['\\u00f7'] = LatexCmds.div = LatexCmds.divide = LatexCmds.divides =\r\n        bind(BinaryOperator,'\\\\div ','&divide;', '[/]');\r\n\r\n    CharCmds['~'] = LatexCmds.sim = bind(BinaryOperator, '\\\\sim ', '~', '~');\r\n    /***************************\r\n     * Commands and Operators.\r\n     **************************/\r\n\r\n    var scale, // = function(jQ, x, y) { ... }\r\n//will use a CSS 2D transform to scale the jQuery-wrapped HTML elements,\r\n//or the filter matrix transform fallback for IE 5.5-8, or gracefully degrade to\r\n//increasing the fontSize to match the vertical Y scaling factor.\r\n\r\n//ideas from http://github.com/louisremi/jquery.transform.js\r\n//see also http://msdn.microsoft.com/en-us/library/ms533014(v=vs.85).aspx\r\n\r\n        forceIERedraw = noop,\r\n        div = document.createElement('div'),\r\n        div_style = div.style,\r\n        transformPropNames = {\r\n            transform:1,\r\n            WebkitTransform:1,\r\n            MozTransform:1,\r\n            OTransform:1,\r\n            msTransform:1\r\n        },\r\n        transformPropName;\r\n\r\n    for (var prop in transformPropNames) {\r\n        if (prop in div_style) {\r\n            transformPropName = prop;\r\n            break;\r\n        }\r\n    }\r\n\r\n    if (transformPropName) {\r\n        scale = function(jQ, x, y) {\r\n            jQ.css(transformPropName, 'scale('+x+','+y+')');\r\n        };\r\n    }\r\n    else if ('filter' in div_style) { //IE 6, 7, & 8 fallback, see https://github.com/laughinghan/mathquill/wiki/Transforms\r\n        forceIERedraw = function(el){ el.className = el.className; };\r\n        scale = function(jQ, x, y) { //NOTE: assumes y > x\r\n            x /= (1+(y-1)/2);\r\n            jQ.css('fontSize', y + 'em');\r\n            if (!jQ.hasClass('mq-matrixed-container')) {\r\n                jQ.addClass('mq-matrixed-container')\r\n                    .wrapInner('<span class=\"mq-matrixed\"></span>');\r\n            }\r\n            var innerjQ = jQ.children()\r\n                .css('filter', 'progid:DXImageTransform.Microsoft'\r\n                    + '.Matrix(M11=' + x + \",SizingMethod='auto expand')\"\r\n                );\r\n            function calculateMarginRight() {\r\n                jQ.css('marginRight', (innerjQ.width()-1)*(x-1)/x + 'px');\r\n            }\r\n            calculateMarginRight();\r\n            var intervalId = setInterval(calculateMarginRight);\r\n            $(window).load(function() {\r\n                clearTimeout(intervalId);\r\n                calculateMarginRight();\r\n            });\r\n        };\r\n    }\r\n    else {\r\n        scale = function(jQ, x, y) {\r\n            jQ.css('fontSize', y + 'em');\r\n        };\r\n    }\r\n\r\n    var Style = P(MathCommand, function(_, super_) {\r\n        _.init = function(ctrlSeq, tagName, attrs) {\r\n            super_.init.call(this, ctrlSeq, '<'+tagName+' '+attrs+'>&0</'+tagName+'>');\r\n        };\r\n    });\r\n\r\n//fonts\r\n    LatexCmds.mathrm = bind(Style, '\\\\mathrm', 'span', 'class=\"mq-roman mq-font\"');\r\n    LatexCmds.mathit = bind(Style, '\\\\mathit', 'i', 'class=\"mq-font\"');\r\n    LatexCmds.mathbf = bind(Style, '\\\\mathbf', 'b', 'class=\"mq-font\"');\r\n    LatexCmds.mathsf = bind(Style, '\\\\mathsf', 'span', 'class=\"mq-sans-serif mq-font\"');\r\n    LatexCmds.mathtt = bind(Style, '\\\\mathtt', 'span', 'class=\"mq-monospace mq-font\"');\r\n//text-decoration\r\n    LatexCmds.underline = bind(Style, '\\\\underline', 'span', 'class=\"mq-non-leaf mq-underline\"');\r\n    LatexCmds.overline = LatexCmds.bar = bind(Style, '\\\\overline', 'span', 'class=\"mq-non-leaf mq-overline\"');\r\n    LatexCmds.overrightarrow = bind(Style, '\\\\overrightarrow', 'span', 'class=\"mq-non-leaf mq-overarrow mq-arrow-right\"');\r\n    LatexCmds.overleftarrow = bind(Style, '\\\\overleftarrow', 'span', 'class=\"mq-non-leaf mq-overarrow mq-arrow-left\"');\r\n\r\n// `\\textcolor{color}{math}` will apply a color to the given math content, where\r\n// `color` is any valid CSS Color Value (see [SitePoint docs][] (recommended),\r\n// [Mozilla docs][], or [W3C spec][]).\r\n//\r\n// [SitePoint docs]: http://reference.sitepoint.com/css/colorvalues\r\n// [Mozilla docs]: https://developer.mozilla.org/en-US/docs/CSS/color_value#Values\r\n// [W3C spec]: http://dev.w3.org/csswg/css3-color/#colorunits\r\n    var TextColor = LatexCmds.textcolor = P(MathCommand, function(_, super_) {\r\n        _.setColor = function(color) {\r\n            this.color = color;\r\n            this.htmlTemplate =\r\n                '<span class=\"mq-textcolor\" style=\"color:' + color + '\">&0</span>';\r\n        };\r\n        _.latex = function() {\r\n            return '\\\\textcolor{' + this.color + '}{' + this.blocks[0].latex() + '}';\r\n        };\r\n        _.parser = function() {\r\n            var self = this;\r\n            var optWhitespace = Parser.optWhitespace;\r\n            var string = Parser.string;\r\n            var regex = Parser.regex;\r\n\r\n            return optWhitespace\r\n                .then(string('{'))\r\n                .then(regex(/^[#\\w\\s.,()%-]*/))\r\n                .skip(string('}'))\r\n                .then(function(color) {\r\n                    self.setColor(color);\r\n                    return super_.parser.call(self);\r\n                })\r\n                ;\r\n        };\r\n    });\r\n\r\n// Very similar to the \\textcolor command, but will add the given CSS class.\r\n// Usage: \\class{classname}{math}\r\n// Note regex that whitelists valid CSS classname characters:\r\n// https://github.com/mathquill/mathquill/pull/191#discussion_r4327442\r\n    var Class = LatexCmds['class'] = P(MathCommand, function(_, super_) {\r\n        _.parser = function() {\r\n            var self = this, string = Parser.string, regex = Parser.regex;\r\n            return Parser.optWhitespace\r\n                .then(string('{'))\r\n                .then(regex(/^[-\\w\\s\\\\\\xA0-\\xFF]*/))\r\n                .skip(string('}'))\r\n                .then(function(cls) {\r\n                    self.htmlTemplate = '<span class=\"mq-class '+cls+'\">&0</span>';\r\n                    return super_.parser.call(self);\r\n                })\r\n                ;\r\n        };\r\n    });\r\n\r\n    var SupSub = P(MathCommand, function(_, super_) {\r\n        _.ctrlSeq = '_{...}^{...}';\r\n        _.createLeftOf = function(cursor) {\r\n            if (!cursor[L] && cursor.options.supSubsRequireOperand) return;\r\n            return super_.createLeftOf.apply(this, arguments);\r\n        };\r\n        _.contactWeld = function(cursor) {\r\n            // Look on either side for a SupSub, if one is found compare my\r\n            // .sub, .sup with its .sub, .sup. If I have one that it doesn't,\r\n            // then call .addBlock() on it with my block; if I have one that\r\n            // it also has, then insert my block's children into its block,\r\n            // unless my block has none, in which case insert the cursor into\r\n            // its block (and not mine, I'm about to remove myself) in the case\r\n            // I was just typed.\r\n            // TODO: simplify\r\n\r\n            // equiv. to [L, R].forEach(function(dir) { ... });\r\n            for (var dir = L; dir; dir = (dir === L ? R : false)) {\r\n                if (this[dir] instanceof SupSub) {\r\n                    // equiv. to 'sub sup'.split(' ').forEach(function(supsub) { ... });\r\n                    for (var supsub = 'sub'; supsub; supsub = (supsub === 'sub' ? 'sup' : false)) {\r\n                        var src = this[supsub], dest = this[dir][supsub];\r\n                        if (!src) continue;\r\n                        if (!dest) this[dir].addBlock(src.disown());\r\n                        else if (!src.isEmpty()) { // ins src children at -dir end of dest\r\n                            src.jQ.children().insAtDirEnd(-dir, dest.jQ);\r\n                            var children = src.children().disown();\r\n                            var pt = Point(dest, children.ends[R], dest.ends[L]);\r\n                            if (dir === L) children.adopt(dest, dest.ends[R], 0);\r\n                            else children.adopt(dest, 0, dest.ends[L]);\r\n                        }\r\n                        else var pt = Point(dest, 0, dest.ends[L]);\r\n                        this.placeCursor = (function(dest, src) { // TODO: don't monkey-patch\r\n                            return function(cursor) { cursor.insAtDirEnd(-dir, dest || src); };\r\n                        }(dest, src));\r\n                    }\r\n                    this.remove();\r\n                    if (cursor && cursor[L] === this) {\r\n                        if (dir === R && pt) {\r\n                            pt[L] ? cursor.insRightOf(pt[L]) : cursor.insAtLeftEnd(pt.parent);\r\n                        }\r\n                        else cursor.insRightOf(this[dir]);\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            this.respace();\r\n        };\r\n        Options.p.charsThatBreakOutOfSupSub = '';\r\n        _.finalizeTree = function() {\r\n            this.ends[L].write = function(cursor, ch) {\r\n                if (cursor.options.autoSubscriptNumerals && this === this.parent.sub) {\r\n                    if (ch === '_') return;\r\n                    var cmd = this.chToCmd(ch);\r\n                    if (cmd instanceof Symbol) cursor.deleteSelection();\r\n                    else cursor.clearSelection().insRightOf(this.parent);\r\n                    return cmd.createLeftOf(cursor.show());\r\n                }\r\n                if (cursor[L] && !cursor[R] && !cursor.selection\r\n                    && cursor.options.charsThatBreakOutOfSupSub.indexOf(ch) > -1) {\r\n                    cursor.insRightOf(this.parent);\r\n                }\r\n                MathBlock.p.write.apply(this, arguments);\r\n            };\r\n        };\r\n        _.moveTowards = function(dir, cursor, updown) {\r\n            if (cursor.options.autoSubscriptNumerals && !this.sup) {\r\n                cursor.insDirOf(dir, this);\r\n            }\r\n            else super_.moveTowards.apply(this, arguments);\r\n        };\r\n        _.deleteTowards = function(dir, cursor) {\r\n            if (cursor.options.autoSubscriptNumerals && this.sub) {\r\n                var cmd = this.sub.ends[-dir];\r\n                if (cmd instanceof Symbol) cmd.remove();\r\n                else if (cmd) cmd.deleteTowards(dir, cursor.insAtDirEnd(-dir, this.sub));\r\n\r\n                // TODO: factor out a .removeBlock() or something\r\n                if (this.sub.isEmpty()) {\r\n                    this.sub.deleteOutOf(L, cursor.insAtLeftEnd(this.sub));\r\n                    if (this.sup) cursor.insDirOf(-dir, this);\r\n                    // Note `-dir` because in e.g. x_1^2| want backspacing (leftward)\r\n                    // to delete the 1 but to end up rightward of x^2; with non-negated\r\n                    // `dir` (try it), the cursor appears to have gone \"through\" the ^2.\r\n                }\r\n            }\r\n            else super_.deleteTowards.apply(this, arguments);\r\n        };\r\n        _.latex = function() {\r\n            function latex(prefix, block) {\r\n                var l = block && block.latex();\r\n                return block ? prefix + (l.length === 1 ? l : '{' + (l || ' ') + '}') : '';\r\n            }\r\n            return latex('_', this.sub) + latex('^', this.sup);\r\n        };\r\n        _.respace = _.siblingCreated = _.siblingDeleted = function(opts, dir) {\r\n            if (dir === R) return; // ignore if sibling only changed on the right\r\n            this.jQ.toggleClass('mq-limit', this[L].ctrlSeq === '\\\\int ');\r\n        };\r\n        _.addBlock = function(block) {\r\n            if (this.supsub === 'sub') {\r\n                this.sup = this.upInto = this.sub.upOutOf = block;\r\n                block.adopt(this, this.sub, 0).downOutOf = this.sub;\r\n                block.jQ = $('<span class=\"mq-sup\"/>').append(block.jQ.children())\r\n                    .attr(mqBlockId, block.id).prependTo(this.jQ);\r\n            }\r\n            else {\r\n                this.sub = this.downInto = this.sup.downOutOf = block;\r\n                block.adopt(this, 0, this.sup).upOutOf = this.sup;\r\n                block.jQ = $('<span class=\"mq-sub\"></span>').append(block.jQ.children())\r\n                    .attr(mqBlockId, block.id).appendTo(this.jQ.removeClass('mq-sup-only'));\r\n                this.jQ.append('<span style=\"display:inline-block;width:0\">&#8203;</span>');\r\n            }\r\n            // like 'sub sup'.split(' ').forEach(function(supsub) { ... });\r\n            for (var i = 0; i < 2; i += 1) (function(cmd, supsub, oppositeSupsub, updown) {\r\n                cmd[supsub].deleteOutOf = function(dir, cursor) {\r\n                    cursor.insDirOf((this[dir] ? -dir : dir), this.parent);\r\n                    if (!this.isEmpty()) {\r\n                        var end = this.ends[dir];\r\n                        this.children().disown()\r\n                            .withDirAdopt(dir, cursor.parent, cursor[dir], cursor[-dir])\r\n                            .jQ.insDirOf(-dir, cursor.jQ);\r\n                        cursor[-dir] = end;\r\n                    }\r\n                    cmd.supsub = oppositeSupsub;\r\n                    delete cmd[supsub];\r\n                    delete cmd[updown+'Into'];\r\n                    cmd[oppositeSupsub][updown+'OutOf'] = insLeftOfMeUnlessAtEnd;\r\n                    delete cmd[oppositeSupsub].deleteOutOf;\r\n                    if (supsub === 'sub') $(cmd.jQ.addClass('mq-sup-only')[0].lastChild).remove();\r\n                    this.remove();\r\n                };\r\n            }(this, 'sub sup'.split(' ')[i], 'sup sub'.split(' ')[i], 'down up'.split(' ')[i]));\r\n        };\r\n    });\r\n\r\n    function insLeftOfMeUnlessAtEnd(cursor) {\r\n        // cursor.insLeftOf(cmd), unless cursor at the end of block, and every\r\n        // ancestor cmd is at the end of every ancestor block\r\n        var cmd = this.parent, ancestorCmd = cursor;\r\n        do {\r\n            if (ancestorCmd[R]) return cursor.insLeftOf(cmd);\r\n            ancestorCmd = ancestorCmd.parent.parent;\r\n        } while (ancestorCmd !== cmd);\r\n        cursor.insRightOf(cmd);\r\n    }\r\n\r\n    LatexCmds.subscript =\r\n        LatexCmds._ = P(SupSub, function(_, super_) {\r\n            _.supsub = 'sub';\r\n            _.htmlTemplate =\r\n                '<span class=\"mq-supsub mq-non-leaf\">'\r\n                +   '<span class=\"mq-sub\">&0</span>'\r\n                +   '<span style=\"display:inline-block;width:0\">&#8203;</span>'\r\n                + '</span>'\r\n            ;\r\n            _.textTemplate = [ '_' ];\r\n            _.finalizeTree = function() {\r\n                this.downInto = this.sub = this.ends[L];\r\n                this.sub.upOutOf = insLeftOfMeUnlessAtEnd;\r\n                super_.finalizeTree.call(this);\r\n            };\r\n        });\r\n\r\n    LatexCmds.superscript =\r\n        LatexCmds.supscript =\r\n            LatexCmds['^'] = P(SupSub, function(_, super_) {\r\n                _.supsub = 'sup';\r\n                _.htmlTemplate =\r\n                    '<span class=\"mq-supsub mq-non-leaf mq-sup-only\">'\r\n                    +   '<span class=\"mq-sup\">&0</span>'\r\n                    + '</span>'\r\n                ;\r\n                _.textTemplate = [ '^' ];\r\n                _.finalizeTree = function() {\r\n                    this.upInto = this.sup = this.ends[R];\r\n                    this.sup.downOutOf = insLeftOfMeUnlessAtEnd;\r\n                    super_.finalizeTree.call(this);\r\n                };\r\n            });\r\n\r\n    var SummationNotation = P(MathCommand, function(_, super_) {\r\n        _.init = function(ch, html) {\r\n            var htmlTemplate =\r\n                '<span class=\"mq-large-operator mq-non-leaf\">'\r\n                +   '<span class=\"mq-to\"><span>&1</span></span>'\r\n                +   '<big>'+html+'</big>'\r\n                +   '<span class=\"mq-from\"><span>&0</span></span>'\r\n                + '</span>'\r\n            ;\r\n            Symbol.prototype.init.call(this, ch, htmlTemplate);\r\n        };\r\n        _.createLeftOf = function(cursor) {\r\n            super_.createLeftOf.apply(this, arguments);\r\n            if (cursor.options.sumStartsWithNEquals) {\r\n                Letter('n').createLeftOf(cursor);\r\n                Equality().createLeftOf(cursor);\r\n            }\r\n        };\r\n        _.latex = function() {\r\n            function simplify(latex) {\r\n                return latex.length === 1 ? latex : '{' + (latex || ' ') + '}';\r\n            }\r\n            return this.ctrlSeq + '_' + simplify(this.ends[L].latex()) +\r\n                '^' + simplify(this.ends[R].latex());\r\n        };\r\n        _.parser = function() {\r\n            var string = Parser.string;\r\n            var optWhitespace = Parser.optWhitespace;\r\n            var succeed = Parser.succeed;\r\n            var block = latexMathParser.block;\r\n\r\n            var self = this;\r\n            var blocks = self.blocks = [ MathBlock(), MathBlock() ];\r\n            for (var i = 0; i < blocks.length; i += 1) {\r\n                blocks[i].adopt(self, self.ends[R], 0);\r\n            }\r\n\r\n            return optWhitespace.then(string('_').or(string('^'))).then(function(supOrSub) {\r\n                var child = blocks[supOrSub === '_' ? 0 : 1];\r\n                return block.then(function(block) {\r\n                    block.children().adopt(child, child.ends[R], 0);\r\n                    return succeed(self);\r\n                });\r\n            }).many().result(self);\r\n        };\r\n        _.finalizeTree = function() {\r\n            this.downInto = this.ends[L];\r\n            this.upInto = this.ends[R];\r\n            this.ends[L].upOutOf = this.ends[R];\r\n            this.ends[R].downOutOf = this.ends[L];\r\n        };\r\n    });\r\n\r\n    LatexCmds['\\u2211'] =\r\n        LatexCmds.sum =\r\n            LatexCmds.summation = bind(SummationNotation,'\\\\sum ','&sum;');\r\n\r\n    LatexCmds['\\u220f'] =\r\n        LatexCmds.prod =\r\n            LatexCmds.product = bind(SummationNotation,'\\\\prod ','&prod;');\r\n\r\n    LatexCmds.coprod =\r\n        LatexCmds.coproduct = bind(SummationNotation,'\\\\coprod ','&#8720;');\r\n\r\n    var Fraction =\r\n        LatexCmds.frac =\r\n            LatexCmds.dfrac =\r\n                LatexCmds.cfrac =\r\n                    LatexCmds.fraction = P(MathCommand, function(_, super_) {\r\n                        _.ctrlSeq = '\\\\frac';\r\n                        _.htmlTemplate =\r\n                            '<span class=\"mq-fraction mq-non-leaf\">'\r\n                            +   '<span class=\"mq-numerator\">&0</span>'\r\n                            +   '<span class=\"mq-denominator\">&1</span>'\r\n                            +   '<span style=\"display:inline-block;width:0\">&#8203;</span>'\r\n                            + '</span>'\r\n                        ;\r\n                        _.textTemplate = ['(', ')/(', ')'];\r\n                        _.finalizeTree = function() {\r\n                            this.upInto = this.ends[R].upOutOf = this.ends[L];\r\n                            this.downInto = this.ends[L].downOutOf = this.ends[R];\r\n                        };\r\n                    });\r\n\r\n    var LiveFraction =\r\n        LatexCmds.over =\r\n            CharCmds['/'] = P(Fraction, function(_, super_) {\r\n                _.createLeftOf = function(cursor) {\r\n                    if (!this.replacedFragment) {\r\n                        var leftward = cursor[L];\r\n                        while (leftward &&\r\n                        !(\r\n                            leftward instanceof BinaryOperator ||\r\n                            leftward instanceof (LatexCmds.text || noop) ||\r\n                            leftward instanceof SummationNotation ||\r\n                            leftward.ctrlSeq === '\\\\ ' ||\r\n                            /^[,;:]$/.test(leftward.ctrlSeq)\r\n                        ) //lookbehind for operator\r\n                            ) leftward = leftward[L];\r\n\r\n                        if (leftward instanceof SummationNotation && leftward[R] instanceof SupSub) {\r\n                            leftward = leftward[R];\r\n                            if (leftward[R] instanceof SupSub && leftward[R].ctrlSeq != leftward.ctrlSeq)\r\n                                leftward = leftward[R];\r\n                        }\r\n\r\n                        if (leftward !== cursor[L]) {\r\n                            this.replaces(Fragment(leftward[R] || cursor.parent.ends[L], cursor[L]));\r\n                            cursor[L] = leftward;\r\n                        }\r\n                    }\r\n                    super_.createLeftOf.call(this, cursor);\r\n                };\r\n            });\r\n\r\n    var SquareRoot =\r\n        LatexCmds.sqrt =\r\n            LatexCmds['\\u221a'] = P(MathCommand, function(_, super_) {\r\n                _.ctrlSeq = '\\\\sqrt';\r\n                _.htmlTemplate =\r\n                    '<span class=\"mq-non-leaf\">'\r\n                    +   '<span class=\"mq-scaled mq-sqrt-prefix\">&radic;</span>'\r\n                    +   '<span class=\"mq-non-leaf mq-sqrt-stem\">&0</span>'\r\n                    + '</span>'\r\n                ;\r\n                _.textTemplate = ['sqrt(', ')'];\r\n                _.parser = function() {\r\n                    return latexMathParser.optBlock.then(function(optBlock) {\r\n                        return latexMathParser.block.map(function(block) {\r\n                            var nthroot = NthRoot();\r\n                            nthroot.blocks = [ optBlock, block ];\r\n                            optBlock.adopt(nthroot, 0, 0);\r\n                            block.adopt(nthroot, optBlock, 0);\r\n                            return nthroot;\r\n                        });\r\n                    }).or(super_.parser.call(this));\r\n                };\r\n                _.reflow = function() {\r\n                    var block = this.ends[R].jQ;\r\n                    scale(block.prev(), 1, block.innerHeight()/+block.css('fontSize').slice(0,-2) - .1);\r\n                };\r\n            });\r\n\r\n    var Vec = LatexCmds.vec = P(MathCommand, function(_, super_) {\r\n        _.ctrlSeq = '\\\\vec';\r\n        _.htmlTemplate =\r\n            '<span class=\"mq-non-leaf\">'\r\n            +   '<span class=\"mq-vector-prefix\">&rarr;</span>'\r\n            +   '<span class=\"mq-vector-stem\">&0</span>'\r\n            + '</span>'\r\n        ;\r\n        _.textTemplate = ['vec(', ')'];\r\n    });\r\n\r\n    var NthRoot =\r\n        LatexCmds.nthroot = P(SquareRoot, function(_, super_) {\r\n            _.htmlTemplate =\r\n                '<sup class=\"mq-nthroot mq-non-leaf\">&0</sup>'\r\n                + '<span class=\"mq-scaled\">'\r\n                +   '<span class=\"mq-sqrt-prefix mq-scaled\">&radic;</span>'\r\n                +   '<span class=\"mq-sqrt-stem mq-non-leaf\">&1</span>'\r\n                + '</span>'\r\n            ;\r\n            _.textTemplate = ['sqrt[', '](', ')'];\r\n            _.latex = function() {\r\n                return '\\\\sqrt['+this.ends[L].latex()+']{'+this.ends[R].latex()+'}';\r\n            };\r\n        });\r\n\r\n    function DelimsMixin(_, super_) {\r\n        _.jQadd = function() {\r\n            super_.jQadd.apply(this, arguments);\r\n            this.delimjQs = this.jQ.children(':first').add(this.jQ.children(':last'));\r\n            this.contentjQ = this.jQ.children(':eq(1)');\r\n        };\r\n        _.reflow = function() {\r\n            var height = this.contentjQ.outerHeight()\r\n                / parseFloat(this.contentjQ.css('fontSize'));\r\n            scale(this.delimjQs, min(1 + .2*(height - 1), 1.2), 1.2*height);\r\n        };\r\n    }\r\n\r\n// Round/Square/Curly/Angle Brackets (aka Parens/Brackets/Braces)\r\n//   first typed as one-sided bracket with matching \"ghost\" bracket at\r\n//   far end of current block, until you type an opposing one\r\n    var Bracket = P(P(MathCommand, DelimsMixin), function(_, super_) {\r\n        _.init = function(side, open, close, ctrlSeq, end) {\r\n            super_.init.call(this, '\\\\left'+ctrlSeq, undefined, [open, close]);\r\n            this.side = side;\r\n            this.sides = {};\r\n            this.sides[L] = { ch: open, ctrlSeq: ctrlSeq };\r\n            this.sides[R] = { ch: close, ctrlSeq: end };\r\n        };\r\n        _.numBlocks = function() { return 1; };\r\n        _.html = function() { // wait until now so that .side may\r\n            this.htmlTemplate = // be set by createLeftOf or parser\r\n                '<span class=\"mq-non-leaf\">'\r\n                +   '<span class=\"mq-scaled mq-paren'+(this.side === R ? ' mq-ghost' : '')+'\">'\r\n                +     this.sides[L].ch\r\n                +   '</span>'\r\n                +   '<span class=\"mq-non-leaf\">&0</span>'\r\n                +   '<span class=\"mq-scaled mq-paren'+(this.side === L ? ' mq-ghost' : '')+'\">'\r\n                +     this.sides[R].ch\r\n                +   '</span>'\r\n                + '</span>'\r\n            ;\r\n            return super_.html.call(this);\r\n        };\r\n        _.latex = function() {\r\n            return '\\\\left'+this.sides[L].ctrlSeq+this.ends[L].latex()+'\\\\right'+this.sides[R].ctrlSeq;\r\n        };\r\n        _.oppBrack = function(opts, node, expectedSide) {\r\n            // return node iff it's a 1-sided bracket of expected side (if any, may be\r\n            // undefined), and of opposite side from me if I'm not a pipe\r\n            return node instanceof Bracket && node.side && node.side !== -expectedSide\r\n                && (this.sides[this.side].ch === '|' || node.side === -this.side)\r\n                && (!opts.restrictMismatchedBrackets\r\n                || OPP_BRACKS[this.sides[this.side].ch] === node.sides[node.side].ch\r\n                || { '(': ']', '[': ')' }[this.sides[L].ch] === node.sides[R].ch) && node;\r\n        };\r\n        _.closeOpposing = function(brack) {\r\n            brack.side = 0;\r\n            brack.sides[this.side] = this.sides[this.side]; // copy over my info (may be\r\n            brack.delimjQs.eq(this.side === L ? 0 : 1) // mismatched, like [a, b))\r\n                .removeClass('mq-ghost').html(this.sides[this.side].ch);\r\n        };\r\n        _.createLeftOf = function(cursor) {\r\n            if (!this.replacedFragment) { // unless wrapping seln in brackets,\r\n                // check if next to or inside an opposing one-sided bracket\r\n                // (must check both sides 'cos I might be a pipe)\r\n                var opts = cursor.options;\r\n                var brack = this.oppBrack(opts, cursor[L], L)\r\n                    || this.oppBrack(opts, cursor[R], R)\r\n                    || this.oppBrack(opts, cursor.parent.parent);\r\n            }\r\n            if (brack) {\r\n                var side = this.side = -brack.side; // may be pipe with .side not yet set\r\n                this.closeOpposing(brack);\r\n                if (brack === cursor.parent.parent && cursor[side]) { // move the stuff between\r\n                    Fragment(cursor[side], cursor.parent.ends[side], -side) // me and ghost outside\r\n                        .disown().withDirAdopt(-side, brack.parent, brack, brack[side])\r\n                        .jQ.insDirOf(side, brack.jQ);\r\n                    brack.bubble('reflow');\r\n                }\r\n            }\r\n            else {\r\n                brack = this, side = brack.side;\r\n                if (brack.replacedFragment) brack.side = 0; // wrapping seln, don't be one-sided\r\n                else if (cursor[-side]) { // elsewise, auto-expand so ghost is at far end\r\n                    brack.replaces(Fragment(cursor[-side], cursor.parent.ends[-side], side));\r\n                    cursor[-side] = 0;\r\n                }\r\n                super_.createLeftOf.call(brack, cursor);\r\n            }\r\n            if (side === L) cursor.insAtLeftEnd(brack.ends[L]);\r\n            else cursor.insRightOf(brack);\r\n        };\r\n        _.placeCursor = noop;\r\n        _.unwrap = function() {\r\n            this.ends[L].children().disown().adopt(this.parent, this, this[R])\r\n                .jQ.insertAfter(this.jQ);\r\n            this.remove();\r\n        };\r\n        _.deleteSide = function(side, outward, cursor) {\r\n            var parent = this.parent, sib = this[side], farEnd = parent.ends[side];\r\n\r\n            if (side === this.side) { // deleting non-ghost of one-sided bracket, unwrap\r\n                this.unwrap();\r\n                sib ? cursor.insDirOf(-side, sib) : cursor.insAtDirEnd(side, parent);\r\n                return;\r\n            }\r\n\r\n            var opts = cursor.options, wasSolid = !this.side;\r\n            this.side = -side;\r\n            // if deleting like, outer close-brace of [(1+2)+3} where inner open-paren\r\n            if (this.oppBrack(opts, this.ends[L].ends[this.side], side)) { // is ghost,\r\n                this.closeOpposing(this.ends[L].ends[this.side]); // then become [1+2)+3\r\n                var origEnd = this.ends[L].ends[side];\r\n                this.unwrap();\r\n                if (origEnd.siblingCreated) origEnd.siblingCreated(cursor.options, side);\r\n                sib ? cursor.insDirOf(-side, sib) : cursor.insAtDirEnd(side, parent);\r\n            }\r\n            else { // if deleting like, inner close-brace of ([1+2}+3) where outer\r\n                if (this.oppBrack(opts, this.parent.parent, side)) { // open-paren is\r\n                    this.parent.parent.closeOpposing(this); // ghost, then become [1+2+3)\r\n                    this.parent.parent.unwrap();\r\n                } // else if deleting outward from a solid pair, unwrap\r\n                else if (outward && wasSolid) {\r\n                    this.unwrap();\r\n                    sib ? cursor.insDirOf(-side, sib) : cursor.insAtDirEnd(side, parent);\r\n                    return;\r\n                }\r\n                else { // else deleting just one of a pair of brackets, become one-sided\r\n                    this.sides[side] = { ch: OPP_BRACKS[this.sides[this.side].ch],\r\n                        ctrlSeq: OPP_BRACKS[this.sides[this.side].ctrlSeq] };\r\n                    this.delimjQs.removeClass('mq-ghost')\r\n                        .eq(side === L ? 0 : 1).addClass('mq-ghost').html(this.sides[side].ch);\r\n                }\r\n                if (sib) { // auto-expand so ghost is at far end\r\n                    var origEnd = this.ends[L].ends[side];\r\n                    Fragment(sib, farEnd, -side).disown()\r\n                        .withDirAdopt(-side, this.ends[L], origEnd, 0)\r\n                        .jQ.insAtDirEnd(side, this.ends[L].jQ.removeClass('mq-empty'));\r\n                    if (origEnd.siblingCreated) origEnd.siblingCreated(cursor.options, side);\r\n                    cursor.insDirOf(-side, sib);\r\n                } // didn't auto-expand, cursor goes just outside or just inside parens\r\n                else (outward ? cursor.insDirOf(side, this)\r\n                    : cursor.insAtDirEnd(side, this.ends[L]));\r\n            }\r\n        };\r\n        _.deleteTowards = function(dir, cursor) {\r\n            this.deleteSide(-dir, false, cursor);\r\n        };\r\n        _.finalizeTree = function() {\r\n            this.ends[L].deleteOutOf = function(dir, cursor) {\r\n                this.parent.deleteSide(dir, true, cursor);\r\n            };\r\n            // FIXME HACK: after initial creation/insertion, finalizeTree would only be\r\n            // called if the paren is selected and replaced, e.g. by LiveFraction\r\n            this.finalizeTree = this.intentionalBlur = function() {\r\n                this.delimjQs.eq(this.side === L ? 1 : 0).removeClass('mq-ghost');\r\n                this.side = 0;\r\n            };\r\n        };\r\n        _.siblingCreated = function(opts, dir) { // if something typed between ghost and far\r\n            if (dir === -this.side) this.finalizeTree(); // end of its block, solidify\r\n        };\r\n    });\r\n\r\n    var OPP_BRACKS = {\r\n        '(': ')',\r\n        ')': '(',\r\n        '[': ']',\r\n        ']': '[',\r\n        '{': '}',\r\n        '}': '{',\r\n        '\\\\{': '\\\\}',\r\n        '\\\\}': '\\\\{',\r\n        '&lang;': '&rang;',\r\n        '&rang;': '&lang;',\r\n        '\\\\langle ': '\\\\rangle ',\r\n        '\\\\rangle ': '\\\\langle ',\r\n        '|': '|'\r\n    };\r\n\r\n    function bindCharBracketPair(open, ctrlSeq) {\r\n        var ctrlSeq = ctrlSeq || open, close = OPP_BRACKS[open], end = OPP_BRACKS[ctrlSeq];\r\n        CharCmds[open] = bind(Bracket, L, open, close, ctrlSeq, end);\r\n        CharCmds[close] = bind(Bracket, R, open, close, ctrlSeq, end);\r\n    }\r\n    bindCharBracketPair('(');\r\n    bindCharBracketPair('[');\r\n    bindCharBracketPair('{', '\\\\{');\r\n    LatexCmds.langle = bind(Bracket, L, '&lang;', '&rang;', '\\\\langle ', '\\\\rangle ');\r\n    LatexCmds.rangle = bind(Bracket, R, '&lang;', '&rang;', '\\\\langle ', '\\\\rangle ');\r\n    CharCmds['|'] = bind(Bracket, L, '|', '|', '|', '|');\r\n\r\n    LatexCmds.left = P(MathCommand, function(_) {\r\n        _.parser = function() {\r\n            var regex = Parser.regex;\r\n            var string = Parser.string;\r\n            var succeed = Parser.succeed;\r\n            var optWhitespace = Parser.optWhitespace;\r\n\r\n            return optWhitespace.then(regex(/^(?:[([|]|\\\\\\{)/))\r\n                .then(function(ctrlSeq) { // TODO: \\langle, \\rangle\r\n                    var open = (ctrlSeq.charAt(0) === '\\\\' ? ctrlSeq.slice(1) : ctrlSeq);\r\n                    return latexMathParser.then(function (block) {\r\n                        return string('\\\\right').skip(optWhitespace)\r\n                            .then(regex(/^(?:[\\])|]|\\\\\\})/)).map(function(end) {\r\n                                var close = (end.charAt(0) === '\\\\' ? end.slice(1) : end);\r\n                                var cmd = Bracket(0, open, close, ctrlSeq, end);\r\n                                cmd.blocks = [ block ];\r\n                                block.adopt(cmd, 0, 0);\r\n                                return cmd;\r\n                            })\r\n                            ;\r\n                    });\r\n                })\r\n                ;\r\n        };\r\n    });\r\n\r\n    LatexCmds.right = P(MathCommand, function(_) {\r\n        _.parser = function() {\r\n            return Parser.fail('unmatched \\\\right');\r\n        };\r\n    });\r\n\r\n    var Binomial =\r\n        LatexCmds.binom =\r\n            LatexCmds.binomial = P(P(MathCommand, DelimsMixin), function(_, super_) {\r\n                _.ctrlSeq = '\\\\binom';\r\n                _.htmlTemplate =\r\n                    '<span class=\"mq-non-leaf\">'\r\n                    +   '<span class=\"mq-paren mq-scaled\">(</span>'\r\n                    +   '<span class=\"mq-non-leaf\">'\r\n                    +     '<span class=\"mq-array mq-non-leaf\">'\r\n                    +       '<span>&0</span>'\r\n                    +       '<span>&1</span>'\r\n                    +     '</span>'\r\n                    +   '</span>'\r\n                    +   '<span class=\"mq-paren mq-scaled\">)</span>'\r\n                    + '</span>'\r\n                ;\r\n                _.textTemplate = ['choose(',',',')'];\r\n            });\r\n\r\n    var Choose =\r\n        LatexCmds.choose = P(Binomial, function(_) {\r\n            _.createLeftOf = LiveFraction.prototype.createLeftOf;\r\n        });\r\n\r\n    LatexCmds.editable = // backcompat with before cfd3620 on #233\r\n        LatexCmds.MathQuillMathField = P(MathCommand, function(_, super_) {\r\n            _.ctrlSeq = '\\\\MathQuillMathField';\r\n            _.htmlTemplate =\r\n                '<span class=\"mq-editable-field\">'\r\n                +   '<span class=\"mq-root-block\">&0</span>'\r\n                + '</span>'\r\n            ;\r\n            _.parser = function() {\r\n                var self = this,\r\n                    string = Parser.string, regex = Parser.regex, succeed = Parser.succeed;\r\n                return string('[').then(regex(/^[a-z][a-z0-9]*/i)).skip(string(']'))\r\n                    .map(function(name) { self.name = name; }).or(succeed())\r\n                    .then(super_.parser.call(self));\r\n            };\r\n            _.finalizeTree = function() {\r\n                var ctrlr = Controller(this.ends[L], this.jQ, Options());\r\n                ctrlr.KIND_OF_MQ = 'MathField';\r\n                ctrlr.editable = true;\r\n                ctrlr.createTextarea();\r\n                ctrlr.editablesTextareaEvents();\r\n                ctrlr.cursor.insAtRightEnd(ctrlr.root);\r\n                RootBlockMixin(ctrlr.root);\r\n            };\r\n            _.registerInnerField = function(innerFields, MathField) {\r\n                innerFields.push(innerFields[this.name] = MathField(this.ends[L].controller));\r\n            };\r\n            _.latex = function(){ return this.ends[L].latex(); };\r\n            _.text = function(){ return this.ends[L].text(); };\r\n        });\r\n\r\n// Embed arbitrary things\r\n// Probably the closest DOM analogue would be an iframe?\r\n// From MathQuill's perspective, it's a Symbol, it can be\r\n// anywhere and the cursor can go around it but never in it.\r\n// Create by calling public API method .dropEmbedded(),\r\n// or by calling the global public API method .registerEmbed()\r\n// and rendering LaTeX like \\embed{registeredName} (see test).\r\n    var Embed = LatexCmds.embed = P(Symbol, function(_, super_) {\r\n        _.setOptions = function(options) {\r\n            function noop () { return \"\"; }\r\n            this.text = options.text || noop;\r\n            this.htmlTemplate = options.htmlString || \"\";\r\n            this.latex = options.latex || noop;\r\n            return this;\r\n        };\r\n        _.parser = function() {\r\n            var self = this;\r\n            string = Parser.string, regex = Parser.regex, succeed = Parser.succeed;\r\n            return string('{').then(regex(/^[a-z][a-z0-9]*/i)).skip(string('}'))\r\n                .then(function(name) {\r\n                    // the chars allowed in the optional data block are arbitrary other than\r\n                    // excluding curly braces and square brackets (which'd be too confusing)\r\n                    return string('[').then(regex(/^[-\\w\\s]*/)).skip(string(']'))\r\n                        .or(succeed()).map(function(data) {\r\n                            return self.setOptions(EMBEDS[name](data));\r\n                        })\r\n                        ;\r\n                })\r\n                ;\r\n        };\r\n    });\r\n    var MQ1 = getInterface(1);\r\n    for (var key in MQ1) (function(key, val) {\r\n        if (typeof val === 'function') {\r\n            MathQuill[key] = function() {\r\n                insistOnInterVer();\r\n                return val.apply(this, arguments);\r\n            };\r\n            MathQuill[key].prototype = val.prototype;\r\n        }\r\n        else MathQuill[key] = val;\r\n    }(key, MQ1[key]));\r\n\r\n    return MathQuill;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/editor/mathInput/tpl/mathInput', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  \n\n\n  return \"<div class=\\\"math-input\\\">\\r\\n    <div class=\\\"math-input-toolbar\\\"></div>\\r\\n    <div class=\\\"math-input-form\\\">\\r\\n        <span class=\\\"math-input-mathquill\\\"></span>\\r\\n    </div>\\r\\n</div>\";\n  });\n});\n\n","\ndefine('css!taoQtiItem/lib/mathquill/mathquill',[],function(){});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * This component present a MathQuill (Latex Wysiwyg) input with a toolbar that allows to add some predefined symbols\r\n *\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/mathInput/mathInput',[\r\n    'lodash',\r\n    'i18n',\r\n    'jquery',\r\n    'ui/component',\r\n    'taoQtiItem/lib/mathquill/mathquill',\r\n    'tpl!taoQtiItem/qtiCreator/editor/mathInput/tpl/mathInput',\r\n    'css!taoQtiItem/lib/mathquill/mathquill'\r\n], function(\r\n    _,\r\n    __,\r\n    $,\r\n    componentFactory,\r\n    MathQuill,\r\n    layoutTpl\r\n) {\r\n    'use strict';\r\n\r\n    var eventNs = '.mathInputWysiwyg';\r\n\r\n    /**\r\n     * 'cmd' vs 'write'\r\n     * ================\r\n     * 'write': You're supposed to pass fully formed LaTeX to 'write', such as '\\log\\left\\{\\right\\}'. The idea is, it inserts\r\n     * that LaTeX math to the left of the cursor. The LaTeX passed in will be inserted at the current cursor position\r\n     * or replace the current selection, and the cursor ends up to the right of what was just inserted.\r\n     *\r\n     * 'cmd': You're only supposed to pass a single MathQuill command to 'cmd', such as '\\sqrt'. The idea is, it's as if\r\n     * you just typed in that MathQuill command. If there is a current selection, it will end up inside the square root,\r\n     * otherwise it inserts the square root at the current cursor position, but the cursor now instead ends up inside\r\n     * the square root command.\r\n     *\r\n     * src: https://github.com/mathquill/mathquill/issues/74\r\n     */\r\n    var allTools = {\r\n            frac:       { label: 'x/y',         latex: '\\\\frac',        fn: 'cmd',      desc: __('Fraction') },\r\n            sqrt:       { label: '&radic;',     latex: '\\\\sqrt',        fn: 'cmd',      desc: __('Square root') },\r\n            exp:        { label: 'x&#8319;',    latex: '^',             fn: 'cmd',      desc: __('Exponent') },\r\n            log:        { label: 'log',         latex: '\\\\log',         fn: 'cmd',      desc: __('Log') },\r\n            ln:         { label: 'ln',          latex: '\\\\ln',          fn: 'cmd',      desc: __('Ln') },\r\n            e:          { label: '&#8494;',     latex: '\\\\mathrm{e}',   fn: 'write',    desc: __('Euler\\'s constant') },\r\n            infinity:   { label: '&#8734;',     latex: '\\\\infty',       fn: 'cmd',      desc: __('Infinity') },\r\n            lbrack:     { label: '[',           latex: '\\\\lbrack',      fn: 'cmd',      desc: __('Left bracket') },\r\n            rbrack:     { label: ']',           latex: '\\\\rbrack',      fn: 'cmd',      desc: __('Right bracket') },\r\n            pi:         { label: '&pi;',        latex: '\\\\pi',          fn: 'cmd',      desc: __('Pi') },\r\n            cos:        { label: 'cos',         latex: '\\\\cos',         fn: 'cmd',      desc: __('Cosinus') },\r\n            sin:        { label: 'sin',         latex: '\\\\sin',         fn: 'cmd',      desc: __('Sinus') },\r\n            lte:        { label: '&le;',        latex: '\\\\le',          fn: 'cmd',      desc: __('Lower than or equal') },\r\n            gte:        { label: '&ge;',        latex: '\\\\ge',          fn: 'cmd',      desc: __('Greater than or equal') },\r\n            times:      { label: '&times;',     latex: '\\\\times',       fn: 'cmd',      desc: __('Multiply') },\r\n            divide:     { label: '&divide;',    latex: '\\\\div',         fn: 'cmd',      desc: __('Divide') },\r\n            plusminus:  { label: '&#177;',      latex: '\\\\pm',          fn: 'cmd',      desc:__( 'Plus/minus') }\r\n        },\r\n        allToolGroups = [\r\n            { id: 'functions',  tools: ['sqrt', 'frac', 'exp', 'log', 'ln'] },\r\n            { id: 'symbols',    tools: ['e', 'infinity', 'lbrack', 'rbrack'] },\r\n            { id: 'trigo',      tools: ['pi', 'sin', 'cos'] },\r\n            { id: 'comparison', tools: ['lte', 'gte'] },\r\n            { id: 'operands',   tools: ['times', 'divide', 'plusminus'] }\r\n        ];\r\n\r\n    /**\r\n     * Create the toolbar markup with event attached\r\n     * @param {jQuery} $container - where to render the toolbar\r\n     * @param {Object} mathField - MathQuill input field\r\n     */\r\n    function createToolbar($container, mathField) {\r\n        $container.empty();\r\n\r\n        // create buttons\r\n        _.forOwn(allToolGroups, function(toolGroup) {\r\n            $container.append(createToolGroup(toolGroup.tools, toolGroup.id));\r\n        });\r\n\r\n        // add behaviour\r\n        // using mousedown instead of click so we can apply the button command without loosing the current selection\r\n        $container\r\n            .off('mousedown' + eventNs)\r\n            .on('mousedown' + eventNs, function(e) {\r\n                var $target = $(e.target),\r\n                    fn = $target.data('fn'),\r\n                    latex = $target.data('latex');\r\n\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n\r\n                switch (fn) {\r\n                    case 'cmd':\r\n                        mathField.cmd(latex);\r\n                        break;\r\n                    case 'write':\r\n                        mathField.write(latex);\r\n                        break;\r\n                }\r\n                mathField.focus();\r\n            });\r\n    }\r\n\r\n    /**\r\n     * @param {String[]} toolGroup - array of tools id composing the tool group\r\n     * @param {String} toolGroupId\r\n     * @returns {jQuery} the group of tool buttons\r\n     */\r\n    function createToolGroup(toolGroup, toolGroupId) {\r\n        var $toolGroup = $('<div>', {\r\n            'class': 'math-input-toolgroup',\r\n            'data-identifier': toolGroupId\r\n        });\r\n\r\n        toolGroup.forEach(function(toolId) {\r\n            var toolConfig = allTools[toolId];\r\n            toolConfig.id = toolId;\r\n\r\n            $toolGroup.append(createTool(toolConfig));\r\n        });\r\n        return $toolGroup;\r\n    }\r\n\r\n    /**\r\n     * Create a single button\r\n     * @param {Object} config\r\n     * @param {String} config.id - id of the tool\r\n     * @param {String} config.latex - latex code to be generated\r\n     * @param {String} config.fn - Mathquill function to be called (ie. cmd or write)\r\n     * @param {String} config.desc - mouse over description of the button\r\n     * @param {String} config.label - label of the rendered button\r\n     * @returns {jQuery} the created button\r\n     */\r\n    function createTool(config) {\r\n        return $('<button>', {\r\n            'class': 'small btn-info math-input-tool',\r\n            'data-identifier': config.id,\r\n            'data-latex': config.latex,\r\n            'data-fn': config.fn,\r\n            title: config.desc,\r\n            html: config.label\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * The component factory\r\n     */\r\n    return function mathInputFactory() {\r\n        var mathInputApi = {\r\n            /**\r\n             * @param {String} latexString\r\n             */\r\n            setLatex: function setLatex(latexString) {\r\n                if (this.mathField) {\r\n                    this.mathField.latex(latexString);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * @returns {String} the current latex string contained in the MathQuill object\r\n             */\r\n            getLatex: function getLatex() {\r\n                if (this.mathField) {\r\n                    return this.mathField.latex();\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Turns a DOM element into a MathQuill field\r\n             * @param {jQuery} $element\r\n             * @private\r\n             */\r\n            _initMathQuill: function _initMathQuill($element) {\r\n                var self = this,\r\n                    MQ = MathQuill.getInterface(2),\r\n                    MQConfig = {\r\n                        spaceBehavesLikeTab: true,\r\n                        handlers: {\r\n                            edit: function onChange() {\r\n                                self.trigger('change', self.mathField.latex());\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                this.mathField = MQ.MathField($element.get(0), MQConfig);\r\n            }\r\n        };\r\n\r\n        /**\r\n         * @returns {component}\r\n         */\r\n        return componentFactory(mathInputApi)\r\n            .setTemplate(layoutTpl)\r\n            .on('render', function init() {\r\n                var $component = this.getElement(),\r\n                    $toolbar = $component.find('.math-input-toolbar'),\r\n                    $inputField = $component.find('.math-input-mathquill');\r\n\r\n                this._initMathQuill($inputField);\r\n                createToolbar($toolbar, this.mathField);\r\n\r\n                // prevent dragging when the field is rendered in a draggable component\r\n                $inputField.on('mousedown' + eventNs, function preventDrag(e) {\r\n                    e.stopPropagation();\r\n                });\r\n            })\r\n            .on('destroy', function() {\r\n                var $component = this.getElement(),\r\n                    $toolbar = $component.find('.math-input-toolbar'),\r\n                    $inputField = $component.find('.math-input-mathquill');\r\n\r\n                $toolbar.off(eventNs);\r\n                $inputField.off(eventNs);\r\n\r\n                if (this.mathField) {\r\n                    this.mathField.revert().html();\r\n                    this.mathField = null;\r\n                }\r\n            });\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/choiceSelector', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"multiple=\\\"multiple\\\"\";\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    <option value=\\\"\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" title=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n    \";\n  return buffer;\n  }\nfunction program4(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\n  buffer += \"<div class=\\\"choices-selector\\\">\\r\\n    <select \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.multiple), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" placeholder=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Enter choices…\", options) : helperMissing.call(depth0, \"__\", \"Enter choices…\", options)))\n    + \"\\\" data-has-search=\\\"false\\\">\\r\\n    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.options), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n\\r\\n    </select>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/editor/response/choiceSelector',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'ui/component',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/choiceSelector',\r\n    'select2'\r\n], function($, _, __, component, choiceSelectorTpl){\r\n\r\n    'use strict';\r\n\r\n    var _defaults = {\r\n            titleLength: 0 // no title\r\n        };\r\n\r\n    /**\r\n     * Format option for select2 usage\r\n     *\r\n     * @param state\r\n     * @returns {string}\r\n     */\r\n    function formatOption (state) {\r\n        var title = $(state.element).attr('title');\r\n        return title ? '<span title=\"' + title + '\">' + state.text + '</span>' : state.text;\r\n    }\r\n\r\n    /**\r\n     * Add a title to select2 options\r\n     *\r\n     * @param {String} content\r\n     * @param {Number} threshold\r\n     * @returns {*}\r\n     */\r\n    function createOptionTitle (content, threshold) {\r\n        var fullText = $('<div>', { html: content }).text().trim().replace(/\\s+/g, ' ');\r\n        var shortText = fullText.substr(0, threshold);\r\n        return fullText.length - shortText.length <= 5 ? fullText : shortText + '…';\r\n    }\r\n\r\n\r\n    /**\r\n     * Set some additional parameters\r\n     */\r\n    var init = function init(){\r\n        var selected =  _.map(this.config.choices || [], function(c){\r\n            return c.id();\r\n        });\r\n        var choices = this.config.interaction.getChoices();\r\n        var response = this.config.interaction.getResponseDeclaration();\r\n        var config = _.defaults(this.config || {}, _defaults);\r\n        \r\n        config.multiple = response.isCardinality(['multiple', 'ordered']);\r\n        config.options = [];\r\n\r\n        _.each(choices, function(choice) {\r\n            var id = choice.id();\r\n            var choiceText = '';\r\n            var option = {\r\n                value: id,\r\n                label: id,\r\n                selected: selected.indexOf(id) > -1\r\n            };\r\n            \r\n            if(choice.is('containerChoice')){\r\n                choiceText = choice.body();\r\n            }else if(choice.is('textVariableChoice')){\r\n                choiceText = choice.val();\r\n            }else{\r\n                return;//not available yet\r\n            }\r\n            \r\n            // 0 as titleLength => no title\r\n            if(config.titleLength) {\r\n                option.title = createOptionTitle(choiceText, config.titleLength);\r\n            }\r\n            config.options.push(option);\r\n        });\r\n    };\r\n\r\n\r\n    /**\r\n     * Select 2 needs to be removed prior to destruction of the component\r\n     */\r\n    var destroy = function destroy(){\r\n        this.$component.find('select').select2('destroy');\r\n    };\r\n\r\n\r\n    /**\r\n     * Populate select box and apply select2\r\n     */\r\n    var render = function postRender() {\r\n\r\n        var self = this;\r\n        var $selectBox = this.$component.find('select');\r\n        \r\n        $selectBox.select2({\r\n            dropdownAutoWidth: true,\r\n            placeholder: $selectBox.attr('placeholder'),\r\n            minimumResultsForSearch: -1,\r\n            formatResult: formatOption,\r\n            formatSelection: formatOption\r\n        }).on('change', function() {\r\n            var selection = $selectBox.select2('val');\r\n            self.setSelectedChoices(_.isArray(selection) ? selection : [selection]);\r\n            self.trigger('change', self.getSelectedChoices());\r\n        });\r\n    };\r\n\r\n\r\n    /**\r\n     * @param {Object} config\r\n     * @param {Integer} [config.titleLength] - Number of characters used for the title attribute of an option (may be used loosely)\r\n     *\r\n     */\r\n    var choiceSelectorFactory = function choiceSelectorFactory(config) {\r\n        \r\n        var _selectedChoices = {};\r\n        var choices = {};\r\n        _.each(config.interaction.getChoices(), function(choice){\r\n            choices[choice.id()] = choice;\r\n        });\r\n        \r\n        /**\r\n        * Exposed methods\r\n        * @type {{getChoices: choiceSelector.getChoices, getSelectedChoices: choiceSelector.getSelectedChoices}}\r\n        */\r\n        var choiceSelector = {\r\n            getSelectedChoices : function() {\r\n                return _selectedChoices;\r\n            },\r\n            setSelectedChoices : function(choicesId) {\r\n                _selectedChoices = _.map(choicesId, function(id){\r\n                    return choices[id];\r\n                });\r\n            }\r\n        };\r\n    \r\n        return component(choiceSelector)\r\n                .on('init', init)\r\n                .on('destroy', destroy)\r\n                .on('render', render)\r\n                .setTemplate(choiceSelectorTpl)\r\n                .init(config);\r\n    };\r\n\r\n    return choiceSelectorFactory;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/editor/simpleContentEditableElement',['jquery', 'lodash'], function($, _){\r\n    \"use strict\";\r\n    function create($container, selector, callback){\r\n\r\n        function _init($elt){\r\n            $elt.attr('contenteditable', true).addClass('simple-editable');\r\n        }\r\n\r\n        _init($container.find(selector));\r\n\r\n        $container.on('mouseenter.simpleeditable', selector, _.throttle(function(){\r\n\r\n            var $elt = $(this);\r\n            if(!$elt.attr('contenteditable')){\r\n                //incase the element does not exists on init()\r\n                _init($elt);\r\n            }\r\n\r\n        }, 200)).on('keyup.simpleeditable', selector, _.throttle(function(e){\r\n\r\n            callback($(this).text());\r\n\r\n        }, 200)).on('keydown.simpleeditable', selector, function(e){\r\n\r\n            if(e.which === 13){\r\n                e.preventDefault();\r\n                $(this).blur();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    function destroy($container){\r\n\r\n        $container.find('.simple-editable')\r\n            .removeClass('simple-editable')\r\n            .removeAttr('contenteditable');\r\n\r\n        $container.off('.simpleeditable');\r\n    }\r\n\r\n    return {\r\n        create : create,\r\n        destroy : destroy\r\n    };\r\n\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/devTools',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/helper/xmlRenderer',\r\n    'taoQtiItem/qtiCreator/model/helper/event'\r\n], function(_, $, xmlRenderer, event) {\r\n    \"use strict\";\r\n    var tools = {};\r\n\r\n    tools.listenStateChange = function() {\r\n\r\n        $(document).on('afterStateInit.qti-widget', function(e, element, state) {\r\n            console.log('->state : ' + state.name + ' : ' + element.serial);\r\n        }).on('afterStateExit.qti-widget', function(e, element, state) {\r\n            console.log('<-state : ' + state.name + ' : ' + element.serial);\r\n        });\r\n    };\r\n\r\n    tools.getStates = function(item){\r\n\r\n        var states = {},\r\n            elements = item.getComposingElements();\r\n\r\n        _.each(elements, function(element){\r\n           var widget = element.data('widget');\r\n           if(widget){\r\n               states[element.getSerial()] = widget.getCurrentState().name;\r\n           }\r\n        });\r\n\r\n        return states;\r\n    };\r\n\r\n    tools.liveXmlPreview = function(item, $destination) {\r\n\r\n        //render qti xml:\r\n        $(document).on(event.getList().join(' '), _.throttle(function(){\r\n\r\n            var rawXml = xmlRenderer.render(item);\r\n\r\n            _printXml(rawXml, $destination);\r\n\r\n        }, 200));\r\n\r\n    };\r\n\r\n    var _formatXml = function(xml) {\r\n        return vkbeautify.xml(xml, '\\t');\r\n    };\r\n\r\n    var _printXml = function(rawXml, $destination) {\r\n\r\n        var $code = $(),\r\n                xml = _formatXml(rawXml);\r\n\r\n        xml = xml\r\n                .replace(/&/g, \"&amp;\")\r\n                .replace(/</g, \"&lt;\")\r\n                .replace(/>/g, \"&gt;\")\r\n                .replace(/\"/g, \"&quot;\")\r\n                .replace(/'/g, \"&#039;\");\r\n\r\n        if ($destination.hasClass('language-markup')) {\r\n            $code = $destination;\r\n        } else {\r\n            $code = $destination.find('code.language-markup');\r\n            if (!$code.length) {\r\n                $code = $('<code>', {'class': 'language-markup'});\r\n                $destination.addClass('line-numbers').html($code);\r\n            }\r\n        }\r\n\r\n        if ($code.length) {\r\n            $code.html(xml);\r\n            Prism.highlightElement($code[0]);\r\n        }\r\n    };\r\n\r\n    return tools;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/dummyElement',[\r\n    'jquery',\r\n    'lodash'\r\n], function ($, _) {\r\n    'use strict';\r\n\r\n    var dummyElement = (function () {\r\n\r\n        var types = {\r\n            maths: {\r\n                icon: 'maths',\r\n                css: {\r\n                    width : 40,\r\n                    height : 22\r\n                }\r\n            },\r\n            image: {\r\n                icon: 'image',\r\n                css: {\r\n                    width : 50,\r\n                    height : 35\r\n                }\r\n            },\r\n            video: {\r\n                icon: 'video',\r\n                css: {\r\n                    width : 200,\r\n                    height : 150\r\n                }\r\n            },\r\n            media: {\r\n                icon: 'media',\r\n                css: {\r\n                    width : 150,\r\n                    height : 100\r\n                }\r\n            },\r\n            include: {\r\n                icon: 'shared-file',\r\n                css: {\r\n                    width : '100%',\r\n                    height : 100\r\n                }\r\n            }\r\n        };\r\n\r\n        /**\r\n         * create dummy element\r\n         *\r\n         * Examples:\r\n         *\r\n         * 1. Generic placeholder\r\n         * dummyElement.get();\r\n         * -> <span class=\"dummy-element\" style=\"width:80px; height: 22px\"></span>\r\n         *\r\n         * 2. Pre-defined placeholder\r\n         * dummyElement.get('math|image|video|...')\r\n         * -> <span style=\"width: 150px; height: 100px; font-size: 80px; padding-top: 9px;\" class=\"dummy-element\">\r\n         *       <span class=\"icon-image\"></span>\r\n         *    </span>\r\n         *\r\n         * 3. Freestyle\r\n         * works almost like $('<element>'), except that 'element' and 'css' (both optionally) are part of an object\r\n         * dummyElement.get({ element: 'div', class: 'foo bar', css: { color: 'red'}})\r\n         * -> <div class=\"dummy-element foo bar\" style=\"color: red; width:80px; height: 22px\">\r\n         *       <span class=\"icon-image\"></span>\r\n         *    </div>\r\n         *\r\n         *\r\n         * @param arg {} | string\r\n         * @returns {*|HTMLElement}\r\n         */\r\n        var get = function (arg) {\r\n            var options = {\r\n                element: 'span',\r\n                'class': 'dummy-element',\r\n                css: {\r\n                    width : 80,\r\n                    height : 22\r\n                }\r\n            },\r\n            element,\r\n            $element,\r\n            $icon,\r\n            css,\r\n            finalOptions;\r\n\r\n            if(arg) {\r\n                if($.isPlainObject(arg)) {\r\n                    // class names must be added to 'dummy-element'\r\n                    if(arg.class) {\r\n                        options.class += ' ' + arg.class;\r\n                        delete(arg.class);\r\n                    }\r\n                    // 'deep' required to copy CSS correctly\r\n                    options = $.extend(true, {}, options, arg);\r\n                }\r\n                else if (types[arg]) {\r\n                    options = $.extend({}, options, types[arg]);\r\n                }\r\n            }\r\n\r\n            // icon\r\n            $icon = options.icon ? $('<span>', { class: 'icon-' + options.icon.replace('icon-', '') }) : false;\r\n\r\n            element = '<' + options.element + '>';\r\n\r\n            css = _.cloneDeep(options.css);\r\n\r\n            // adapt font size to container size\r\n            css['font-size'] = css.height && !css['font-size']\r\n                ? (css.height * .8)\r\n                : 14;\r\n\r\n            css['line-height'] = css['font-size'].toString() + 'px';\r\n\r\n            if(css['height'] > 30) {\r\n                css['padding-top'] = ((css['height'] - css['font-size']) / 2) * .9;\r\n            }\r\n\r\n            // don't scale background-picture on large elements\r\n            if(css.height && css.height > 100) {\r\n                css['background-size'] = 'auto';\r\n            }\r\n\r\n            finalOptions = _.cloneDeep(options);\r\n            delete(finalOptions.icon);\r\n            delete(finalOptions.element);\r\n            delete(finalOptions.css);\r\n\r\n            $element = $(element, finalOptions).css(css);\r\n\r\n            if($icon) {\r\n                $element.append($icon);\r\n            }\r\n            return $element;\r\n        };\r\n\r\n        return {\r\n            get: get\r\n        }\r\n\r\n    }());\r\n    return dummyElement;\r\n});\r\n\r\n\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/helper/windowPopup',[\r\n    'lodash',\r\n    'jquery',\r\n    'ui/component',\r\n    'ui/component/draggable',\r\n    'ui/component/resizable',\r\n    'ui/component/stackable',\r\n    'ui/component/windowed'\r\n], function (_, $, componentFactory, makeDraggable, makeResizable, makeStackable, makeWindowed) {\r\n    'use strict';\r\n\r\n    var defaultConfig = {\r\n        draggable : true,\r\n        resizable : true\r\n    };\r\n\r\n    /**\r\n     * @param {Object} specs - extra functions to extend the component\r\n     * @param {Object} config\r\n     * @param {Boolean} config.draggable - if the window should be draggable\r\n     * @param {Boolean} config.resizable - if the window should be resizable\r\n     */\r\n    return function windowPopupFactory(specs, config) {\r\n        var windowPopup;\r\n\r\n        config = _.defaults(config || {}, defaultConfig);\r\n\r\n        windowPopup = componentFactory(specs, config);\r\n\r\n        if (config.draggable) {\r\n            makeDraggable(windowPopup);\r\n        }\r\n        if (config.resizable) {\r\n            makeResizable(windowPopup);\r\n        }\r\n        makeStackable(windowPopup, { stackingScope: 'qti-creator' });\r\n        makeWindowed(windowPopup);\r\n\r\n        windowPopup\r\n            .on('render', function() {\r\n                var $component = this.getElement();\r\n\r\n                $component.addClass('window-popup');\r\n            });\r\n\r\n        return windowPopup;\r\n    };\r\n\r\n});\n","define('taoQtiItem/qtiItem/core/choices/Choice',['taoQtiItem/qtiItem/core/IdentifiedElement'], function(IdentifiedElement){\r\n\r\n    var Choice = IdentifiedElement.extend({\r\n        init : function(serial, attributes){\r\n            this._super(serial, attributes);\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'choice') || this._super(qtiClass);\r\n        },\r\n        getInteraction : function(){\r\n            var found, ret = null, item = this.getRelatedItem();\r\n            if(item){\r\n                found = item.find(this.serial);\r\n                if(found){\r\n                    ret = found.parent;\r\n                }\r\n            }\r\n            return ret;\r\n        }\r\n    });\r\n\r\n    return Choice;\r\n});\n","define('taoQtiItem/qtiItem/core/choices/Hotspot',['taoQtiItem/qtiItem/core/choices/Choice'], function(QtiChoice){\r\n    var QtiHotspot = QtiChoice.extend({});\r\n    return QtiHotspot;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/choices/AssociableHotspot',['taoQtiItem/qtiItem/core/choices/Hotspot'], function(QtiHotspot){\r\n    var QtiAssociableHotspot = QtiHotspot.extend({\r\n        qtiClass : 'associableHotspot'\r\n    });\r\n    return QtiAssociableHotspot;\r\n});\r\n\r\n\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/choices/AssociableHotspot',[\r\n    'lodash', \r\n    'taoQtiItem/qtiCreator/model/mixin/editable', \r\n    'taoQtiItem/qtiItem/core/choices/AssociableHotspot'\r\n], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        \r\n        /**\r\n         * Set the default values for the model\r\n         * @returns {Object} the default attributes \r\n         */ \r\n        getDefaultAttributes : function(){\r\n            return {\r\n               matchMax : 0,\r\n               matchMin : 0 \r\n            };\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/choices/Gap',['taoQtiItem/qtiItem/core/choices/Choice'], function(QtiChoice){\r\n    var QtiGap = QtiChoice.extend({\r\n        qtiClass : 'gap'\r\n    });\r\n    return QtiGap;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/choices/Gap',[\r\n    'lodash', \r\n    'taoQtiItem/qtiCreator/model/mixin/editable', \r\n    'taoQtiItem/qtiItem/core/choices/Gap'\r\n], function(_, editable, Gap){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n               required : false\r\n            };\r\n        }\r\n    });\r\n    return Gap.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/Object',[\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig',\r\n    'taoQtiItem/qtiItem/helper/util'\r\n], function(Element, _, rendererConfig, util){\r\n\r\n    var QtiObject = Element.extend({\r\n        qtiClass : 'object',\r\n        getMediaType : function(){\r\n            var type = 'undefined';\r\n            var mimetype = this.attr('type');\r\n            if(mimetype){\r\n                if(mimetype.indexOf('video') === 0){\r\n                    type = 'video';\r\n                }else if(mimetype.indexOf('audio') === 0){\r\n                    type = 'audio';\r\n                }else if(mimetype.indexOf('image') === 0){\r\n                    type = 'image';\r\n                }else if(mimetype.indexOf('text/html') === 0){\r\n                    type = 'html';\r\n                }else{\r\n                    type = 'object';\r\n                }\r\n            }\r\n            return type;\r\n        },\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {};\r\n\r\n            switch(this.getMediaType()){\r\n                case 'video':\r\n                    defaultData.video = true;\r\n                    break;\r\n                case 'audio':\r\n                    defaultData.audio = true;\r\n                    break;\r\n                case 'html':\r\n                    defaultData.html = true;\r\n                    break;\r\n                case 'image':\r\n                default:\r\n                    defaultData.object = true;\r\n            }\r\n\r\n            defaultData.attributes = {data : renderer.resolveUrl(this.attr('data'))};\r\n            defaultData.body = this._alt;\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n        isEmpty : function(){\r\n            return (!this.attr('data'));\r\n        }\r\n    });\r\n\r\n    return QtiObject;\r\n});\r\n\n","define('taoQtiItem/qtiItem/core/choices/GapImg',['taoQtiItem/qtiItem/core/choices/Choice', 'taoQtiItem/qtiItem/core/Object'], function(QtiChoice, QtiObject){\r\n    var QtiGapImg = QtiChoice.extend({\r\n        qtiClass : 'gapImg',\r\n        //common methods to object containers (start)\r\n        initObject : function(object){\r\n            this.object = object || new QtiObject();\r\n        },\r\n        getObject : function(){\r\n            return this.object;\r\n        }\r\n        //common methods to object containers (end)\r\n    });\r\n    return QtiGapImg;\r\n});\r\n\r\n\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/choices/GapImg',[\r\n    'lodash', \r\n    'taoQtiItem/qtiCreator/model/mixin/editable', \r\n    'taoQtiItem/qtiItem/core/choices/GapImg'\r\n], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        \r\n        /**\r\n         * Set the default values for the model\r\n         * @returns {Object} the default attributes \r\n         */ \r\n        getDefaultAttributes : function(){\r\n            return {\r\n                matchMin : 0,\r\n                matchMax : 0  \r\n            };\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/choices/ContainerChoice',['taoQtiItem/qtiItem/core/choices/Choice', 'taoQtiItem/qtiItem/mixin/Container'], function(Choice, Container){\r\n\r\n    var ContainerChoice = Choice.extend({\r\n        init : function(serial, attributes){\r\n            this._super(serial, attributes);\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'containerChoice') || this._super(qtiClass);\r\n        }\r\n    });\r\n    \r\n    Container.augment(ContainerChoice);\r\n    \r\n    return ContainerChoice;\r\n});\r\n\r\n\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiItem/core/choices/GapText',[\r\n    'taoQtiItem/qtiItem/core/choices/ContainerChoice'\r\n], function(QtiContainerChoice) {\r\n    'use strict';\r\n    var QtiGapText = QtiContainerChoice.extend({\r\n        qtiClass : 'gapText'\r\n    });\r\n    return QtiGapText;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/choices/GapText',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/choices/GapText'\r\n], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                fixed : false,\r\n                matchMax : 1,\r\n                matchMin : 0\r\n            };\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/choices/HotspotChoice',['taoQtiItem/qtiItem/core/choices/Hotspot'], function(QtiHotspot){\r\n    var QtiHotspotChoice = QtiHotspot.extend({\r\n        qtiClass : 'hotspotChoice'\r\n    });\r\n    return QtiHotspotChoice;\r\n});\r\n\r\n\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/choices/HotspotChoice',[\r\n    'lodash', \r\n    'taoQtiItem/qtiCreator/model/mixin/editable', \r\n    'taoQtiItem/qtiItem/core/choices/HotspotChoice'\r\n], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        \r\n        /**\r\n         * Set the default values for the model\r\n         * @returns {Object} the default attributes \r\n         */ \r\n        getDefaultAttributes : function(){\r\n            return {};\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/mixin/ContainerInline',['taoQtiItem/qtiItem/mixin/Mixin', 'taoQtiItem/qtiItem/mixin/Container', 'lodash'], function(Mixin, Container, _){\r\n    \r\n    var methods = {};\r\n    _.extend(methods, Container.methods);\r\n    _.extend(methods, {\r\n        initContainer:function(body){\r\n            Container.methods.initContainer.call(this, body);\r\n            this.bdy.contentModel = 'inlineStatic';\r\n        }\r\n    });\r\n\r\n    return {\r\n        augment : function(targetClass){\r\n            Mixin.augment(targetClass, methods);\r\n        },\r\n        methods : methods\r\n    };\r\n});\n","define('taoQtiItem/qtiItem/core/choices/Hottext',['taoQtiItem/qtiItem/core/choices/Choice', 'taoQtiItem/qtiItem/mixin/ContainerInline'], function(Choice, Container){\r\n    \r\n    var Hottext = Choice.extend({\r\n        qtiClass : 'hottext'\r\n    });\r\n    \r\n    Container.augment(Hottext);\r\n    \r\n    return Hottext;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/choices/Hottext',[\r\n    'lodash', \r\n    'taoQtiItem/qtiCreator/model/mixin/editable', \r\n    'taoQtiItem/qtiItem/core/choices/Hottext'\r\n], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n               fixed : false\r\n            };\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/core/choices/TextVariableChoice',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/choices/Choice',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function($, _, QtiChoice, rendererConfig){\r\n\r\n    var QtiTextVariableChoice = QtiChoice.extend({\r\n        init : function(serial, attributes, text){\r\n            this._super(serial, attributes);\r\n            this.val(text || '');\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'textVariableChoice') || this._super(qtiClass);\r\n        },\r\n        val : function(text){\r\n            if(typeof text === 'undefined'){\r\n                return this.text;\r\n            }else{\r\n                if(typeof text === 'string'){\r\n                    this.text = text;\r\n                    $(document).trigger('choiceTextChange', {\r\n                        choice: this,\r\n                        text: text\r\n                    });\r\n                }else{\r\n                    throw 'text must be a string';\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        render : function(){\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer||this.getRenderer(),\r\n                defaultData = {\r\n                    body : this.text\r\n                };\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        }\r\n    });\r\n\r\n    return QtiTextVariableChoice;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/choices/InlineChoice',['taoQtiItem/qtiItem/core/choices/TextVariableChoice'], function(QtiTextVariableChoice){\r\n    var QtiInlineChoice = QtiTextVariableChoice.extend({\r\n        qtiClass : 'inlineChoice'\r\n    });\r\n    return QtiInlineChoice;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/choices/InlineChoice',['lodash', 'taoQtiItem/qtiCreator/model/mixin/editable', 'taoQtiItem/qtiItem/core/choices/InlineChoice'], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'fixed' : false,\r\n                'showHide' : 'show'\r\n            };\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',['taoQtiItem/qtiItem/core/choices/ContainerChoice'], function(QtiContainerChoice){\r\n\r\n    var QtiSimpleAssociableChoice = QtiContainerChoice.extend({\r\n        qtiClass : 'simpleAssociableChoice'\r\n    });\r\n    \r\n    return QtiSimpleAssociableChoice;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/choices/SimpleAssociableChoice',['lodash', 'taoQtiItem/qtiCreator/model/mixin/editable', 'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice'], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'fixed' : false,\r\n                'showHide' : 'show',\r\n                'matchMax' : 0,\r\n                'matchMin' : 0\r\n            };\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/core/choices/SimpleChoice',['taoQtiItem/qtiItem/core/choices/ContainerChoice'], function(QtiContainerChoice){\r\n\r\n    var QtiSimpleChoice = QtiContainerChoice.extend({\r\n        qtiClass : 'simpleChoice'\r\n    });\r\n\r\n    return QtiSimpleChoice;\r\n\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/choices/SimpleChoice',['lodash', 'taoQtiItem/qtiCreator/model/mixin/editable', 'taoQtiItem/qtiItem/core/choices/SimpleChoice'], function(_, editable, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'fixed' : false,\r\n                'showHide' : 'show'\r\n            };\r\n        }\r\n    });\r\n    return Choice.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\n\r\n/**\r\n * Helpers for portable elements\r\n *\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/helper/portableElement',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiItem/helper/util'\r\n], function(_, $, util){\r\n    'use strict';\r\n\r\n    /**\r\n     * Get common methods to augment a portableElement implementation\r\n     *\r\n     * @param {object} registry\r\n     * @returns {object}\r\n     */\r\n    function getDefaultMethods(registry){\r\n\r\n        return {\r\n            getDefaultAttributes : function(){\r\n                return {};\r\n            },\r\n            getDefaultProperties : function(){\r\n                \r\n                var creator = registry.getCreator(this.typeIdentifier);\r\n                if(creator && creator.module && _.isFunction(creator.module.getDefaultProperties)){\r\n                    return creator.getDefaultProperties(this);\r\n                }else{\r\n                    return {};\r\n                }\r\n            },\r\n            afterCreate : function(){\r\n\r\n                var typeId = this.typeIdentifier,\r\n                    creator = registry.getCreator(typeId),\r\n                    creatorModule = creator.module,\r\n                    response;\r\n\r\n                //set default markup (for initial rendering)\r\n                creatorModule.getMarkupTemplate();\r\n\r\n                //set pci props\r\n                this.properties = creatorModule.getDefaultProperties();\r\n\r\n                //@todo fix this !\r\n                if(creator.response && _.size(creator.response)){//for custom interaciton only\r\n                    //create response\r\n                    response = this.createResponse({\r\n                        cardinality : creator.response.cardinality\r\n                    });\r\n                    \r\n                    //the base type is optional\r\n                    if(creator.response.baseType){\r\n                        response.attr('baseType', creator.response.baseType);\r\n                    }\r\n                } else {\r\n                    //the attribute is mandatory for info control\r\n                    this.attr('title', creator.label);\r\n\r\n                    //we ensure the info control has an identifier\r\n                    if(!this.attr('id')){\r\n                        this.attr('id', util.buildId(this.getRelatedItem(), typeId));\r\n                    }\r\n                }\r\n\r\n                //set markup\r\n                this.markup = this.renderMarkup();\r\n\r\n                //set pci namespace to item\r\n                this.getNamespace();\r\n\r\n                //after create\r\n                //@todo need afterCreate() to return a promise\r\n                if(_.isFunction(creatorModule.afterCreate)){\r\n                    return creatorModule.afterCreate(this);\r\n                }\r\n            },\r\n            renderMarkup : function(){\r\n\r\n                var creatorModule = registry.getCreator(this.typeIdentifier).module,\r\n                    markupTpl = creatorModule.getMarkupTemplate(),\r\n                    markupData = this.getDefaultMarkupTemplateData();\r\n\r\n                if(_.isFunction(creatorModule.getMarkupData)){\r\n                    //extends the default data with the custom one\r\n                    markupData = creatorModule.getMarkupData(this, markupData);\r\n                }\r\n\r\n                return markupTpl(markupData);\r\n            },\r\n            updateMarkup : function(){\r\n                this.markup = this.renderMarkup();\r\n            }\r\n        };\r\n    }\r\n\r\n    return {\r\n        getDefaultMethods : getDefaultMethods\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/helper/response',['lodash'], function(_){\r\n    \"use strict\";\r\n    return {\r\n        removeChoice : function(response, choice){\r\n\r\n            var escapedIdentifier = choice.id().replace(/([.-])/g, '\\\\$1'),\r\n                regex = new RegExp('([^a-z_\\-\\d\\.]*)(' + escapedIdentifier + ')([^a-z_\\-\\d\\.]*)');\r\n            \r\n            _.remove(response.correctResponse, function(entry){\r\n                return entry.match(regex);\r\n            });\r\n            \r\n            var mapEntries = {};\r\n            _.forIn(response.mapEntries, function(value, mapKey){\r\n                if(!mapKey.match(regex)){\r\n                    mapEntries[mapKey] = value;\r\n                }\r\n            });\r\n            response.mapEntries = mapEntries;\r\n\r\n        }\r\n    };\r\n});\n","define('taoQtiItem/qtiItem/core/Img',[\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function(Element, _, rendererConfig){\r\n\r\n    var Img = Element.extend({\r\n        qtiClass : 'img',\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {};\r\n\r\n            defaultData.attributes = {\r\n                src : renderer.resolveUrl(this.attr('src'))\r\n            };\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n        isEmpty : function(){\r\n            return (!this.attr('src'));\r\n        }\r\n    });\r\n\r\n    return Img;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/Img',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/Img'\r\n], function(_, editable, Img){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                src : '',\r\n                alt : ''\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.data('responsive', true);\r\n        }\r\n    });\r\n    return Img.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/mixin/NamespacedElement',['taoQtiItem/qtiItem/mixin/Mixin', 'lodash'], function(Mixin, _){\r\n\r\n    var methods = {\r\n        getNamespace : function(){\r\n\r\n            if(this.ns && this.ns.name && this.ns.uri){\r\n                return _.clone(this.ns);\r\n            }else{\r\n\r\n                var relatedItem = this.getRelatedItem();\r\n                if(relatedItem){\r\n                    var namespaces = relatedItem.getNamespaces();\r\n                    for(var ns in namespaces){\r\n                        if(namespaces[ns].indexOf(this.nsUriFragment) > 0){\r\n                            return {\r\n                                name : ns,\r\n                                uri : namespaces[ns]\r\n                            };\r\n                        }\r\n                    }\r\n                    //if no ns found in the item, set the default one!\r\n                    relatedItem.namespaces[this.defaultNsName] = this.defaultNsUri;\r\n                    return {\r\n                        name : this.defaultNsName,\r\n                        uri : this.defaultNsUri\r\n                    };\r\n                }\r\n            }\r\n\r\n            return {};\r\n        },\r\n        setNamespace : function(name, uri){\r\n            this.ns = {\r\n                name : name,\r\n                uri : uri\r\n            };\r\n        }\r\n    };\r\n\r\n    return {\r\n        augment : function(targetClass){\r\n            Mixin.augment(targetClass, methods);\r\n        },\r\n        methods : methods\r\n    };\r\n});\n","define('taoQtiItem/qtiItem/core/Include',[\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/mixin/ContainerInline',\r\n    'taoQtiItem/qtiItem/mixin/NamespacedElement'\r\n], function(Element, Container, NamespacedElement){\r\n    \r\n    var Include = Element.extend({\r\n        qtiClass : 'include',\r\n        defaultNsName : 'xi',\r\n        defaultNsUri : 'http://www.w3.org/2001/XInclude',\r\n        nsUriFragment : 'XInclude',\r\n        isEmpty : function(){\r\n            return (!this.attr('href') || this.getBody().isEmpty());\r\n        }\r\n    });\r\n    Container.augment(Include);\r\n    NamespacedElement.augment(Include);\r\n    return Include;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/Include',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/Include'\r\n], function(_, editable, Include){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {};\r\n        },\r\n        afterCreate : function(){\r\n            this.getNamespace();\r\n        }\r\n    });\r\n    return Include.extend(methods);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/variables/ResponseDeclaration',['taoQtiItem/qtiItem/core/variables/VariableDeclaration', 'lodash'], function(VariableDeclaration, _){\r\n    'use strict';\r\n    \r\n    var ResponseDeclaration = VariableDeclaration.extend({\r\n        qtiClass : 'responseDeclaration',\r\n        init : function(serial, attributes){\r\n\r\n            this._super(serial, attributes);\r\n\r\n            //MATCH_CORRECT, MAP_RESPONSE, MAP_RESPONSE_POINT\r\n            this.template = '';//previously called 'howMatch'\r\n\r\n            //when template equals ont of the \"map\" one (MAP_RESPONSE, MAP_RESPONSE_POINT)\r\n            this.mappingAttributes = {};\r\n            this.mapEntries = {};\r\n\r\n            //correct response [0..*]\r\n            this.correctResponse = null;\r\n\r\n            //tao internal usage:\r\n            this.feedbackRules = {};\r\n        },\r\n        getFeedbackRules : function(){\r\n            return _.values(this.feedbackRules);\r\n        },\r\n        getComposingElements : function(){\r\n            var elts = this._super();\r\n            elts = _.extend(elts, this.feedbackRules);\r\n            return elts;\r\n        },\r\n        toArray : function(){\r\n            var arr = this._super();\r\n            arr.howMatch = this.template;\r\n            arr.correctResponses = this.correctResponse;\r\n            arr.mapping = this.mapEntries;\r\n            arr.mappingAttributes = this.mappingAttributes;\r\n            arr.feedbackRules = _.map(this.feedbackRules, function(rule){\r\n                return rule.toArray();\r\n            });\r\n            return arr;\r\n        },\r\n        getInteraction : function(){\r\n            var interaction = null;\r\n            var responseId = this.id();\r\n            var item = this.getRelatedItem();\r\n            var interactions = item.getInteractions();\r\n            _.each(interactions, function(i){\r\n                if(i.attributes.responseIdentifier === responseId){\r\n                    interaction = i;\r\n                    return false;//break\r\n                }\r\n            });\r\n            return interaction;\r\n        },\r\n        isCardinality : function(cardinalities){\r\n            var comparison;\r\n            if(_.isArray(cardinalities)){\r\n                comparison = cardinalities;\r\n            }else if(_.isString(cardinalities)){\r\n                cardinalities = [cardinalities];\r\n            }else{\r\n                return false;\r\n            }\r\n            return (_.indexOf(comparison, this.attr('cardinality')) >= 0);\r\n        }\r\n    });\r\n\r\n    return ResponseDeclaration;\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',['taoQtiItem/qtiItem/core/Element', 'lodash'], function(Element, _){\r\n    'use strict';\r\n    \r\n    var SimpleFeedbackRule = Element.extend({\r\n        qtiClass : '_simpleFeedbackRule',\r\n        serial : '',\r\n        relatedItem : null,\r\n        init : function(serial, feedbackOutcome, feedbackThen, feedbackElse){\r\n\r\n            this._super(serial, {});\r\n\r\n            this.condition = 'correct';\r\n            this.comparedOutcome = null;\r\n            this.comparedValue = 0.0;\r\n\r\n            this.feedbackOutcome = feedbackOutcome;\r\n            if(Element.isA(feedbackThen, 'feedback')){\r\n                this.feedbackThen = feedbackThen;\r\n            }else{\r\n                this.feedbackThen = null;\r\n            }\r\n            if(Element.isA(feedbackElse, 'feedback')){\r\n                this.feedbackElse = feedbackThen;\r\n            }else{\r\n                this.feedbackElse = null;\r\n            }\r\n\r\n        },\r\n        setCondition : function(comparedOutcome, condition, comparedValue){\r\n            var _comparedValues = [];\r\n            if(Element.isA(comparedOutcome, 'variableDeclaration')){\r\n                switch(condition){\r\n                    case 'correct':\r\n                    case 'incorrect':\r\n                        if(Element.isA(comparedOutcome, 'responseDeclaration')){\r\n                            this.comparedOutcome = comparedOutcome;\r\n                            this.condition = condition;\r\n                        }else{\r\n                            throw 'invalid outcome type: must be a responseDeclaration';\r\n                        }\r\n                        break;\r\n                    case 'lt':\r\n                    case 'lte':\r\n                    case 'equal':\r\n                    case 'gte':\r\n                    case 'gt':\r\n                        if(comparedValue !== null && comparedValue !== undefined){\r\n                            this.comparedOutcome = comparedOutcome;\r\n                            this.condition = condition;\r\n                            this.comparedValue = comparedValue;\r\n                        }else{\r\n                            throw 'compared value must not be null';\r\n                        }\r\n                        break;\r\n                    case 'choices':\r\n                        if(Element.isA(comparedOutcome, 'responseDeclaration') && comparedValue !== null && _.isArray(comparedValue)){\r\n                            var choices = _.values(comparedOutcome.getInteraction().getChoices());\r\n                            this.comparedOutcome = comparedOutcome;\r\n                            this.condition = condition;\r\n                            _.each(comparedValue, function(v){\r\n                                if(v instanceof Element){\r\n                                    _comparedValues.push(v);\r\n                                }else if(_.isString(v)){\r\n                                    _.each(choices, function(c){\r\n                                        if(c.attr('identifier') === v){\r\n                                            _comparedValues.push(c);\r\n                                            return false;//break\r\n                                        }\r\n                                    });\r\n                                }\r\n                            });\r\n                            \r\n                            this.comparedValue = _comparedValues;\r\n                        }else{\r\n                            throw 'compared value must not be null';\r\n                        }\r\n                        break;\r\n                    default:\r\n                        throw 'unknown condition type : '.condition;\r\n                }\r\n            }else{\r\n                throw 'invalid outcome type: must be a variableDeclaration';\r\n            }\r\n\r\n            return this;\r\n        },\r\n        setFeedbackElse : function(feedback){\r\n            if(Element.isA(feedback, 'feedback')){\r\n                this.feedbackElse = feedback;\r\n            }\r\n        },\r\n        toArray : function(){\r\n            var val = this.comparedValue;\r\n            var _toString = function(v){\r\n                if(val instanceof Element){\r\n                    return val.attr('identifier') ;\r\n                }else{\r\n                    return val+'';\r\n                }\r\n            };\r\n            if(_.isArray(val)){\r\n                val = _.map(val, _toString);\r\n            }else{\r\n                val = _toString(val);\r\n            }\r\n            return {\r\n                condition : this.condition,\r\n                comparedOutcome : this.comparedOutcome.id(),\r\n                comparedValue : val\r\n            };\r\n        }\r\n    });\r\n\r\n    return SimpleFeedbackRule;\r\n});\n","define('taoQtiItem/qtiCreator/model/variables/ResponseDeclaration',[\r\n    'jquery',\r\n    'lodash',\r\n    'ui/hider',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/core/variables/ResponseDeclaration',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/response/SimpleFeedbackRule',\r\n    'taoQtiItem/qtiItem/helper/response'\r\n], function($, _, hider, Element, ResponseDeclaration, editable, SimpleFeedbackRule, responseHelper){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        setTemplate : function(template){\r\n            var templateUri = responseHelper.getTemplateUriFromName(template);\r\n            if(templateUri && this.template !== templateUri){\r\n                this.template = templateUri;\r\n                $(document).trigger('responseTemplateChange.qti-widget', {'element' : this, 'value' : template});\r\n            }\r\n            return this;\r\n        },\r\n        getTemplate : function(){\r\n            return this.template;\r\n        },\r\n        resetCorrect : function(){\r\n            this.correctResponse = null;\r\n            $(document).trigger('correctResponseChange.qti-widget', {'element' : this, 'value' : null});\r\n            return this;\r\n        },\r\n        setCorrect : function(value){\r\n            if(_.isString(value)){\r\n                value = [value];\r\n            }\r\n            this.correctResponse = value;\r\n            $(document).trigger('correctResponseChange.qti-widget', {'element' : this, 'value' : value});\r\n            return this;\r\n        },\r\n        getCorrect : function(){\r\n            return _.clone(this.correctResponse);\r\n        },\r\n        setMappingAttribute : function(name, value){\r\n            this.mappingAttributes[name] = value;\r\n            $(document).trigger('mappingAttributeChange.qti-widget', {'element' : this, 'key' : name, 'value' : value});\r\n        },\r\n        removeMappingAttribute : function(name){\r\n            delete this.mappingAttributes[name];\r\n            $(document).trigger('mappingAttributeChange.qti-widget', {'element' : this, 'key' : name, 'value' : null});\r\n        },\r\n        getMappingAttribute : function(name){\r\n            return this.mappingAttributes[name];\r\n        },\r\n        toggleMappingForm: function toggleMappingForm() {\r\n            var mappingDisabled = _.isEmpty(this.mapEntries);\r\n            var $panel = this.renderer.getAreaBroker().getPropertyPanelArea();\r\n            $('.response-mapping-attributes input', $panel).each(function () {\r\n                $(this).attr(\"disabled\", mappingDisabled);\r\n            });\r\n\r\n            hider.toggle($('.response-mapping-attributes', $panel), !mappingDisabled);\r\n            hider.toggle($('.response-mapping-info', $panel), mappingDisabled);\r\n        },\r\n        setMapEntry : function(mapKey, mappedValue, caseSensitive){\r\n\r\n            mappedValue = parseFloat(mappedValue);\r\n            caseSensitive = caseSensitive ? true : false;\r\n\r\n            if(!isNaN(mappedValue)){\r\n                if(this.attr('cardinality') === 'multiple' && this.attr('baseType') === 'pair'){\r\n                    //in this case, A-B is equivalent to B-A so need to check if any of those conbination already exists:\r\n\r\n                    var mapKeys = mapKey.split(' '),\r\n                        mapKeysReverse = mapKeys[1] + ' ' + mapKeys[0];\r\n\r\n                    if(this.mapEntries[mapKeysReverse]){\r\n                        this.mapEntries[mapKeysReverse] = mappedValue;\r\n                    }else{\r\n                        this.mapEntries[mapKey] = mappedValue;\r\n                    }\r\n                }else{\r\n                    this.mapEntries[mapKey] = mappedValue;\r\n                }\r\n\r\n                this.toggleMappingForm();\r\n\r\n                /**\r\n                 * @todo caseSensitive is always set to \"false\" currently, need to add an option for this\r\n                 * this.mapEntries[mapKey] = {\r\n                 'mappedValue' : mappedValue,\r\n                 'caseSensitive' : caseSensitive\r\n                 };\r\n                 */\r\n\r\n                $(document).trigger('mapEntryChange.qti-widget', {\r\n                    element : this,\r\n                    mapKey : mapKey,\r\n                    mappedValue : mappedValue,\r\n                    caseSensitive : caseSensitive\r\n                });\r\n            }else{\r\n                throw 'the mapped value is not a number';\r\n            }\r\n\r\n            return this;\r\n        },\r\n        removeMapEntry : function(mapKey, canBeEmpty){\r\n            //is there a opportunity mapKey to be empty string\r\n            if(typeof canBeEmpty == 'undefined'){\r\n                canBeEmpty = false;\r\n            }\r\n\r\n            if(mapKey || canBeEmpty){\r\n                if(this.attr('cardinality') === 'multiple' && this.attr('baseType') === 'pair'){\r\n                    //in this case, A-B is equivalent to B-A so need to check if any of those conbination already exists:\r\n                    var mapKeys = mapKey.split(' '),\r\n                        mapKeysReverse = mapKeys[1] + ' ' + mapKeys[0];\r\n\r\n                    delete this.mapEntries[mapKeysReverse];\r\n                }\r\n                delete this.mapEntries[mapKey];\r\n\r\n                this.toggleMappingForm();\r\n\r\n                $(document).trigger('mapEntryRemove.qti-widget', {element : this, mapKey : mapKey});\r\n            }\r\n\r\n            return this;\r\n        },\r\n        getMapEntries : function(){\r\n            return _.clone(this.mapEntries);\r\n        },\r\n        removeMapEntries : function(){\r\n            _(this.mapEntries).keys().forEach(this.removeMapEntry, this);\r\n        },\r\n        createFeedbackRule : function(){\r\n\r\n            var item = this.getRelatedItem();\r\n\r\n            var outcome = item.createOutcomeDeclaration({\r\n                identifier : 'FEEDBACK',\r\n                cardinality : 'single',\r\n                baseType : 'identifier'\r\n            });\r\n\r\n            var modalFeedback = item.createModalFeedback({\r\n                identifier : 'feedbackModal',\r\n                outcomeIdentifier : outcome.id()\r\n            }, this);\r\n\r\n            var rule = new SimpleFeedbackRule('', outcome, modalFeedback);\r\n\r\n            rule.setCondition(this, 'correct');\r\n            this.feedbackRules[rule.getSerial()] = rule;\r\n\r\n            //set renderer\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                rule.setRenderer(renderer);\r\n                modalFeedback.setRenderer(renderer);\r\n            }\r\n\r\n            //trigger creation event\r\n            $(document).trigger('feedbackRuleCreated.qti-widget', {element : this, rule : rule});\r\n\r\n            return rule;\r\n        },\r\n        getFeedbackRule : function(serial){\r\n            return this.feedbackRules[serial];\r\n        },\r\n        getFeedbackRules : function(){\r\n            return _.clone(this.feedbackRules);\r\n        },\r\n        setCondition : function(rule, condition, value){\r\n            rule.setCondition(this, condition, value);\r\n            $(document).trigger('feedbackRuleConditionChange.qti-widget', {element : this, rule : rule, condition : condition, value : value});\r\n        },\r\n        deleteFeedbackRule : function(rule){\r\n\r\n            var item = this.getRelatedItem(), ret;\r\n\r\n            item.remove('outcomes', rule.feedbackOutcome);\r\n            item.remove('modalFeedbacks', rule.feedbackThen);\r\n            item.remove('modalFeedbacks', rule.feedbackElse || '');//feedback \"else\" is optional\r\n\r\n            ret = this.remove('feedbackRules', rule);\r\n\r\n            $(document).trigger('feedbackRuleRemoved.qti-widget', {element : this, rule : rule});\r\n\r\n            return ret;\r\n        },\r\n        createFeedbackElse : function(rule){\r\n\r\n            var modalFeedback;\r\n\r\n            if(Element.isA(rule, '_simpleFeedbackRule')){\r\n\r\n                modalFeedback = this.getRelatedItem().createModalFeedback({\r\n                    identifier : 'feedbackModal',\r\n                    outcomeIdentifier : rule.feedbackOutcome.id()\r\n                }, this);\r\n\r\n                rule.setFeedbackElse(modalFeedback);\r\n\r\n                //set renderer\r\n                var renderer = this.getRenderer();\r\n                if(renderer){\r\n                    modalFeedback.setRenderer(renderer);\r\n                }\r\n\r\n                $(document).trigger('feedbackRuleElseCreated.qti-widget', {element : this, rule : rule, modalFeedback : modalFeedback});\r\n            }\r\n\r\n            return modalFeedback;\r\n        },\r\n        deleteFeedbackElse : function(rule){\r\n\r\n            this.getRelatedItem().remove('modalFeedbacks', rule.feedbackElse);\r\n            rule.feedbackElse = null;\r\n\r\n            $(document).trigger('feedbackRuleElseRemoved.qti-widget', {element : this, rule : rule});\r\n        },\r\n        getDefaultAttributes : function(){\r\n            return {};\r\n        }\r\n    });\r\n\r\n    return ResponseDeclaration.extend(methods);\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/mixin/editableInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/model/variables/ResponseDeclaration',\r\n    'taoQtiItem/qtiCreator/model/helper/event',\r\n    'taoQtiItem/qtiCreator/model/helper/response'\r\n], function(_, Element, ResponseDeclaration, event, responseHelper){\r\n    \"use strict\";\r\n    var methods = {\r\n        /**\r\n         * Remove a choice from the interaction\r\n         * \r\n         * @param {string|choice} choice\r\n         * @returns {object} this\r\n         */\r\n        removeChoice : function removeChoice(choice){\r\n\r\n            var serial = '', c;\r\n            if(typeof(choice) === 'string'){\r\n                serial = choice;\r\n            }else if(Element.isA(choice, 'choice')){\r\n                serial = choice.getSerial();\r\n            }\r\n            if(this.choices[serial]){\r\n\r\n                //remove choice\r\n                c = this.choices[serial];\r\n                delete this.choices[serial];\r\n\r\n                //update the response\r\n                responseHelper.removeChoice(this.getResponseDeclaration(), c);\r\n\r\n                //trigger event\r\n                event.deleted(c, this);\r\n            }\r\n            return this;\r\n        },\r\n        createResponse : function createResponse(attrs, template){\r\n\r\n            var item,\r\n                renderer,\r\n                outcomeScore;\r\n            var response = new ResponseDeclaration();\r\n            if(attrs){\r\n                response.attr(attrs);\r\n            }\r\n\r\n            //we assume in the context of edition, every element is created from the api so alwayd bound to an item:\r\n            item = this.getRelatedItem();\r\n            item.addResponseDeclaration(response);\r\n\r\n            //assign responseIdentifier only after attaching it to the item to generate a unique id\r\n            response.buildIdentifier('RESPONSE', false);\r\n            response.setTemplate(template || 'MATCH_CORRECT');\r\n            this.attr('responseIdentifier', response.id());\r\n\r\n            //adding a response processing template require the outcome SCORE:\r\n            outcomeScore = item.getOutcomeDeclaration('SCORE');\r\n            if(!outcomeScore){\r\n                outcomeScore = item.createOutcomeDeclaration({\r\n                    cardinality : 'single',\r\n                    baseType : 'float'\r\n                });\r\n                outcomeScore.buildIdentifier('SCORE', false);\r\n            }\r\n\r\n            //se the default value for the score default value\r\n            response.mappingAttributes.defaultValue = 0;\r\n\r\n            //set renderer\r\n            renderer = this.getRenderer();\r\n            if(renderer){\r\n                response.setRenderer(renderer);\r\n            }\r\n\r\n            return response;\r\n        },\r\n        /**\r\n         * To be called before deleting the interaction\r\n         */\r\n        deleteResponse : function deleteResponse(){\r\n\r\n            var response = this.getResponseDeclaration();\r\n            if(response){\r\n                this.getRelatedItem().deleteResponseDeclaration(response);\r\n            }\r\n            this.removeAttr('responseIdentifier');\r\n            return this;\r\n        },\r\n        beforeRemove : function beforeRemove(){\r\n            \r\n            var serial = this.serial,\r\n                interactions = this.getRelatedItem().getInteractions();\r\n            \r\n            //delete its response\r\n            this.deleteResponse();\r\n            \r\n            //when there is only one interaction remaining, its reponseIdentifier must be RESPONSE to be able to use one of the standard rp\r\n            if(_.size(interactions) === 2){\r\n                _.forEach(interactions, function(interaction){\r\n                    \r\n                    var response = interaction.getResponseDeclaration();\r\n                    \r\n                    //find the other interaction, which will be the last remaining one\r\n                    if(response && interaction.serial !== serial && interaction.qtiClass !== 'endAttemptInteraction'){\r\n                        \r\n                        interaction.attr('responseIdentifier', 'RESPONSE');\r\n                        response.id('RESPONSE');\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    return methods;\r\n});\r\n\n","define('taoQtiItem/qtiItem/core/interactions/Interaction',[\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig',\r\n    'taoQtiItem/qtiItem/helper/util'\r\n], function(Element, _, rendererConfig, util){\r\n    'use strict';\r\n\r\n    var QtiInteraction = Element.extend({\r\n        init : function(serial, attributes){\r\n            this._super(serial, attributes);\r\n            this.choices = {};\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'interaction') || this._super(qtiClass);\r\n        },\r\n        addChoice : function(choice){\r\n            choice.setRelatedItem(this.getRelatedItem() || null);\r\n            this.choices[choice.getSerial()] = choice;\r\n            return this;\r\n        },\r\n        getChoices : function(){\r\n            var choices = {};\r\n            for(var i in this.choices){//prevent passing the whole array by ref\r\n                choices[i] = this.choices[i];\r\n            }\r\n            return choices;\r\n        },\r\n        getChoice : function(serial){\r\n            var ret = null;\r\n            if(this.choices[serial]){\r\n                ret = this.choices[serial];\r\n            }\r\n            return ret;\r\n        },\r\n        getChoiceByIdentifier : function(identifier){\r\n            for(var i in this.choices){\r\n                if(this.choices[i].id() === identifier){\r\n                    return this.choices[i];\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        getComposingElements : function(){\r\n            var elts = this._super();\r\n            //recursive to choices:\r\n            for(var serial in this.choices){\r\n                if(Element.isA(this.choices[serial], 'choice')){\r\n                    elts[serial] = this.choices[serial];\r\n                    elts = _.extend(elts, this.choices[serial].getComposingElements());\r\n                }\r\n            }\r\n            return elts;\r\n        },\r\n        find : function(serial){\r\n            var found = this._super(serial);\r\n            if(!found){\r\n                found = util.findInCollection(this, 'choices', serial);\r\n            }\r\n            return found;\r\n        },\r\n        getResponseDeclaration : function(){\r\n            var response = null;\r\n            var responseId = this.attr('responseIdentifier');\r\n            if(responseId){\r\n                var item = this.getRelatedItem();\r\n                if(item){\r\n                    response = item.getResponseDeclaration(responseId);\r\n                }else{\r\n                    throw 'cannot get response of an interaction out of its item context';\r\n                }\r\n            }\r\n            return response;\r\n        },\r\n        /**\r\n         * Render the interaction to the view.\r\n         * The optional argument \"subClass\" allows distinguishing customInteraction: e.g. customInteraction.matrix, customInteraction.likertScale ...\r\n         */\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    '_type' : this.qtiClass.replace(/([A-Z])/g, function($1){\r\n                        return \"_\" + $1.toLowerCase();\r\n                    }),\r\n                    'choices' : [],\r\n                    'choiceShuffle' : true\r\n                };\r\n\r\n            if(!renderer){\r\n                throw 'no renderer found for the interaction ' + this.qtiClass;\r\n            }\r\n            \r\n            var choices = (this.attr('shuffle') && renderer.getOption('shuffleChoices')) ? renderer.getShuffledChoices(this) : this.getChoices();\r\n            var interactionData = {'interaction' : {'serial' : this.serial, 'attributes' : this.attributes}};\r\n            var _this = this;\r\n            _.each(choices, function(choice){\r\n                if(Element.isA(choice, 'choice')){\r\n                    try{\r\n                        var renderedChoice = choice.render(_.clone(interactionData, true), null, choice.qtiClass + '.' + _this.qtiClass, renderer); //use interaction type as choice subclass\r\n                        defaultData.choices.push(renderedChoice);\r\n                    }catch(e){\r\n                        //leave choices empty in case of error\r\n                    }\r\n                }\r\n            });\r\n            \r\n            var tplName = args.subclass ? this.qtiClass + '.' + args.subclass : this.qtiClass;\r\n            \r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, tplName, renderer);\r\n        },\r\n        postRender : function(data, altClassName, renderer){\r\n            var self = this;\r\n            renderer = renderer || this.getRenderer();\r\n\r\n            return _(this.getChoices())\r\n                .filter(function(elt){\r\n                    return Element.isA(elt, 'choice');\r\n                })\r\n                .map(function(choice){\r\n                    return choice.postRender({}, choice.qtiClass + '.' + self.qtiClass, renderer);\r\n                })\r\n                .value()\r\n                .concat(this._super(data, altClassName, renderer));\r\n        },\r\n        setResponse : function(values){\r\n            var ret = null;\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                ret = renderer.setResponse(this, values);\r\n            }else{\r\n                throw 'no renderer found for the interaction ' + this.qtiClass;\r\n            }\r\n            return ret;\r\n        },\r\n        getResponse : function(){\r\n            var ret = null;\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                ret = renderer.getResponse(this);\r\n            }else{\r\n                throw 'no renderer found for the interaction ' + this.qtiClass;\r\n            }\r\n            return ret;\r\n        },\r\n        resetResponse : function(){\r\n            var ret = null;\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                ret = renderer.resetResponse(this);\r\n            }else{\r\n                throw 'no renderer found for the interaction ' + this.qtiClass;\r\n            }\r\n            return ret;\r\n        },\r\n\r\n        /**\r\n         * Retrieve the state of the interaction. \r\n         * The state is provided by the interaction's renderer.\r\n         * \r\n         * @returns {Object} the interaction's state\r\n         * @throws {Error} if no renderer is found \r\n         */\r\n        getState : function(){\r\n            var ret = null;\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                if(_.isFunction(renderer.getState)){\r\n                    ret = renderer.getState(this);\r\n                }\r\n            }else{\r\n                throw 'no renderer found for the interaction ' + this.qtiClass;\r\n            }\r\n            return ret;\r\n        },\r\n\r\n        /**\r\n         * Retrieve the state of the interaction. \r\n         * The state will be given to the interaction's renderer.\r\n         * \r\n         * @param {Object} state - the interaction's state\r\n         * @throws {Error} if no renderer is found \r\n         */\r\n        setState : function(state){\r\n            var renderer = this.getRenderer();\r\n            if(renderer){\r\n                if(_.isFunction(renderer.setState)){\r\n                    renderer.setState(this, state);\r\n                }\r\n            }else{\r\n                throw 'no renderer found for the interaction ' + this.qtiClass;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Clean up an interaction rendering.\r\n         * Ask the renderer to run destroy if exists.\r\n         * \r\n         * @throws {Error} if no renderer is found \r\n         */\r\n        clear : function(){\r\n            var renderer = this.getRenderer();\r\n            if(renderer && _.isFunction(renderer.destroy)){\r\n                renderer.destroy(this);\r\n            }\r\n        },\r\n\r\n        toArray : function(){\r\n            var arr = this._super();\r\n            arr.choices = {};\r\n            for(var serial in this.choices){\r\n                if(Element.isA(this.choices[serial], 'choice')){\r\n                    arr.choices[serial] = this.choices[serial].toArray();\r\n                }\r\n            }\r\n            return arr;\r\n        },\r\n\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            //by default\r\n            return false;\r\n        }\r\n    });\r\n    return QtiInteraction;\r\n});\r\n\n","define('taoQtiItem/qtiItem/core/interactions/Prompt',['taoQtiItem/qtiItem/core/Element', 'taoQtiItem/qtiItem/mixin/ContainerInline'], function(Element, Container){\r\n    var Prompt = Element.extend({qtiClass : 'prompt'});\r\n    Container.augment(Prompt);\r\n    return Prompt;\r\n});\n","define('taoQtiItem/qtiItem/core/interactions/BlockInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/Interaction',\r\n    'taoQtiItem/qtiItem/core/interactions/Prompt',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function(Interaction, Prompt, _, rendererConfig){\r\n    'use strict';\r\n\r\n    var BlockInteraction = Interaction.extend({\r\n        init : function(serial, attributes){\r\n            this._super(serial, attributes);\r\n            this.prompt = new Prompt('');\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'blockInteraction') || this._super(qtiClass);\r\n        },\r\n        getComposingElements : function(){\r\n            var elts = this._super();\r\n            elts = _.extend(elts, this.prompt.getComposingElements());\r\n            elts[this.prompt.getSerial()] = this.prompt;\r\n            return elts;\r\n        },\r\n        find : function(serial){\r\n            return this._super(serial) || this.prompt.find(serial);\r\n        },\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    'prompt' : this.prompt.render(renderer)\r\n                };\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n        postRender : function(data, altClassName, renderer){\r\n            renderer = renderer || this.getRenderer();\r\n            return []\r\n                    .concat(this.prompt.postRender({}, '', renderer))\r\n                    .concat(this._super(data, altClassName, renderer));\r\n        },\r\n        toArray : function(){\r\n            var arr = this._super();\r\n            arr.prompt = this.prompt.toArray();\r\n            return arr;\r\n        }\r\n    });\r\n    return BlockInteraction;\r\n});\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/AssociateInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/BlockInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(BlockInteraction, maxScore){\r\n    'use strict';\r\n\r\n    var AssociateInteraction = BlockInteraction.extend({\r\n        qtiClass : 'associateInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            var calculatePossiblePairs = function calculatePossiblePairs(associateInteraction){\r\n                var i, j, pairs = [];\r\n                var choices = maxScore.getMatchMaxOrderedChoices(associateInteraction.getChoices());\r\n                for(i=0; i < choices.length; i++){\r\n                    for(j=i; j < choices.length; j++){\r\n                        pairs.push([choices[i].id, choices[j].id]);\r\n                    }\r\n                }\r\n                return pairs;\r\n            };\r\n            return maxScore.associateInteractionBased(this, {possiblePairs: calculatePossiblePairs(this)});\r\n        }\r\n    });\r\n    return AssociateInteraction;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/AssociateInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/AssociateInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/SimpleAssociableChoice'\r\n], function($, _, editable, editableInteraction, Interaction, Choice){\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'shuffle' : false,\r\n                'maxAssociations' : 0,\r\n                'minAssociations' : 0\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createChoice();\r\n            this.createChoice();\r\n            this.createResponse({\r\n                baseType:'pair',\r\n                cardinality:'multiple'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            var choice = new Choice();\r\n\r\n            this.addChoice(choice);\r\n\r\n            var rank = _.size(this.getChoices());\r\n\r\n            choice\r\n                .body('choice' + ' #' + rank)\r\n                .buildIdentifier('choice');\r\n\r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n\r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n\r\n            return choice;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/BlockInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(BlockInteraction, maxScore){\r\n    'use strict';\r\n    var ChoiceInteraction = BlockInteraction.extend({\r\n        qtiClass : 'choiceInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.choiceInteractionBased(this);\r\n        }\r\n    });\r\n    return ChoiceInteraction;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/ChoiceInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/ChoiceInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/SimpleChoice'\r\n], function($, _, editable, editableInteraction, Interaction, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'shuffle' : false,\r\n                'maxChoices' : 0,\r\n                'minChoices' : 0,\r\n                'orientation' : 'vertical'\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createChoice();\r\n            this.createChoice();\r\n            this.createChoice();\r\n            this.createResponse({\r\n                baseType:'identifier',\r\n                cardinality:'multiple'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            var choice = new Choice();\r\n\r\n            this.addChoice(choice);\r\n\r\n            var rank = _.size(this.getChoices());\r\n\r\n            choice\r\n                .body('choice' + ' #' + rank)\r\n                .buildIdentifier('choice');\r\n\r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n\r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n\r\n            return choice;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/InlineInteraction',['taoQtiItem/qtiItem/core/interactions/Interaction'], function(Interaction){\r\n    'use strict';\r\n    return Interaction.extend({\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'inlineInteraction') || this._super(qtiClass);\r\n        }\r\n    });\r\n});\n","define('taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',['taoQtiItem/qtiItem/core/interactions/InlineInteraction'], function(InlineInteraction){\r\n    return InlineInteraction.extend({\r\n        'qtiClass' : 'endAttemptInteraction'\r\n    });\r\n});\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/EndAttemptInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/EndAttemptInteraction',\r\n    'i18n'\r\n], function(_, editable, editableInteraction, Interaction, __){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                title : __('End Attempt')\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createResponse({\r\n                baseType:'boolean',\r\n                cardinality:'single'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            throw new Error('end attempt interaction has no choice');\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction',['taoQtiItem/qtiItem/core/interactions/BlockInteraction', 'lodash', 'taoQtiItem/qtiItem/helper/rendererConfig'], function(BlockInteraction, _, rendererConfig){\r\n    \r\n    var ExtendedTextInteraction = BlockInteraction.extend({\r\n        qtiClass : 'extendedTextInteraction',\r\n        render : function(){\r\n            \r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    'multiple' : false,\r\n                    'maxStringLoop' : []\r\n                },\r\n                response = this.getResponseDeclaration();\r\n        \r\n            if(this.attr('maxStrings') && (response.attr('cardinality') === 'multiple' || response.attr('cardinality') === 'ordered')){\r\n                defaultData.multiple = true;\r\n                for(var i = 0; i < this.attr('maxStrings'); i++){\r\n                    defaultData.maxStringLoop.push(i + '');//need to convert to string. The tpl engine fails otherwise\r\n                }\r\n            }\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        }\r\n    });\r\n    \r\n    return ExtendedTextInteraction;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/ExtendedTextInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/ExtendedTextInteraction'\r\n], function(_, editable, editableInteraction, Interaction){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                format: 'plain'\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createResponse({\r\n                baseType: 'string',\r\n                cardinality: 'single'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            throw \"extendedTextInteraction does not have any choices\";\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/interactions/ContainerInteraction',['taoQtiItem/qtiItem/core/interactions/BlockInteraction', 'taoQtiItem/qtiItem/mixin/Container'], function(BlockInteraction, Container){\r\n    var ContainerInteraction = BlockInteraction.extend({});\r\n    Container.augment(ContainerInteraction);\r\n    return ContainerInteraction;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/ContainerInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(ContainerInteraction, maxScore){\r\n    'use strict';\r\n    var GapMatchInteraction = ContainerInteraction.extend({\r\n        qtiClass : 'gapMatchInteraction',\r\n        getGaps : function getGaps(){\r\n            return this.getBody().getElements('gap');\r\n        },\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.gapMatchInteractionBased(this);\r\n        }\r\n    });\r\n    return GapMatchInteraction;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/interactions/GapMatchInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/GapMatchInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/GapText',\r\n    'taoQtiItem/qtiCreator/model/helper/event',\r\n    'taoQtiItem/qtiCreator/model/helper/response'\r\n], function(_, Element, editable, editableInteraction, Interaction, Choice, event, responseHelper){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                shuffle : false\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.body('<p>Lorem ipsum dolor sit amet, consectetur adipisicing ...</p>');\r\n            this.createChoice();//gapMatchInteraction requires at least one gapMatch to be valid http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10307\r\n            this.createResponse({\r\n                baseType : 'directedPair',\r\n                cardinality : 'multiple'\r\n            });\r\n        },\r\n        getNextPlaceholder : function getNextPlaceholder() {\r\n            var allChoices = this.getChoices(),\r\n                existingChoicesLabels = _.map(allChoices, function(choice) {\r\n                    var choiceBody = choice.getBody() || {};\r\n                    return choiceBody.bdy;\r\n                }),\r\n                placeHolderIndex = 1,\r\n                placeHolderPrefix = 'choice #',\r\n                placeHolder = placeHolderPrefix + placeHolderIndex;\r\n\r\n            while (existingChoicesLabels.indexOf(placeHolder) !== -1) {\r\n                placeHolderIndex++;\r\n                placeHolder = placeHolderPrefix + placeHolderIndex;\r\n            }\r\n            return placeHolder;\r\n        },\r\n        createChoice : function(text){\r\n\r\n            var choice = new Choice();\r\n\r\n            this.addChoice(choice);\r\n\r\n            choice\r\n                .body(text || this.getNextPlaceholder())\r\n                .buildIdentifier('choice');\r\n\r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n\r\n            event.choiceCreated(choice, this);\r\n\r\n            return choice;\r\n        },\r\n        createGap : function(attr, body){\r\n\r\n            var choice = new Choice('', attr);\r\n\r\n            this.addChoice(choice);\r\n            choice.buildIdentifier('gap');\r\n            choice.body(body);\r\n\r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n\r\n            event.choiceCreated(choice, this);\r\n\r\n            return choice;\r\n        },\r\n        removeChoice : function(element){\r\n            var serial = '', c;\r\n\r\n            if(typeof(element) === 'string'){\r\n                serial = element;\r\n            }else if(Element.isA(element, 'gap')){\r\n                serial = element.serial;\r\n            }else if(Element.isA(element, 'gapText')){\r\n                serial = element.serial;\r\n            }\r\n\r\n            if(c = this.getBody().getElement(serial)){\r\n                //remove choice\r\n                this.getBody().removeElement(c);\r\n\r\n                //update the response\r\n                responseHelper.removeChoice(this.getResponseDeclaration(), c);\r\n\r\n                //trigger event\r\n                event.deleted(c, this);\r\n            }else if(c = this.getChoice(serial)){\r\n                //remove choice\r\n                delete this.choices[serial];\r\n\r\n                //update the response\r\n                responseHelper.removeChoice(this.getResponseDeclaration(), c);\r\n\r\n                //trigger event\r\n                event.deleted(c, this);\r\n            }\r\n\r\n            return this;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/interactions/ObjectInteraction',['taoQtiItem/qtiItem/core/interactions/BlockInteraction', 'taoQtiItem/qtiItem/core/Object'], function(QtiBlockInteraction, QtiObject){\r\n    var QtiObjectInteraction = QtiBlockInteraction.extend({\r\n        //common methods to object containers (start)\r\n        initObject : function(object){\r\n            this.object = object || new QtiObject();\r\n        },\r\n        getObject : function(){\r\n            return this.object;\r\n        }\r\n        //common methods to object containers (end)\r\n    });\r\n    \r\n    return QtiObjectInteraction;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiItem/core/interactions/GraphicInteraction',['taoQtiItem/qtiItem/core/interactions/ObjectInteraction', 'lodash', 'taoQtiItem/qtiItem/helper/rendererConfig'], function(QtiObjectInteraction, _, rendererConfig){\r\n    var QtiGraphicInteraction = QtiObjectInteraction.extend({\r\n        render : function(){\r\n            \r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    'backgroundImage' : this.object.getAttributes(),\r\n                    'object' : this.object.render(renderer)\r\n                };\r\n                \r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        }\r\n    });\r\n\r\n    return QtiGraphicInteraction;\r\n});\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(GraphicInteraction, maxScore){\r\n    'use strict';\r\n    var GraphicAssociateInteraction = GraphicInteraction.extend({\r\n        qtiClass : 'graphicAssociateInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            var calculatePossiblePairs = function calculatePossiblePairs(associateInteraction){\r\n                var i, j, pairs = [];\r\n                var choices = maxScore.getMatchMaxOrderedChoices(associateInteraction.getChoices());\r\n                for(i=0; i < choices.length; i++){\r\n                    for(j=i; j < choices.length; j++){\r\n                        if(i !== j){\r\n                            pairs.push([choices[i].id, choices[j].id]);\r\n                        }\r\n                    }\r\n                }\r\n                return pairs;\r\n            };\r\n            return maxScore.associateInteractionBased(this, {possiblePairs: calculatePossiblePairs(this)});\r\n        }\r\n    });\r\n    return GraphicAssociateInteraction;\r\n});\r\n\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/interactions/GraphicAssociateInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicAssociateInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/AssociableHotspot'\r\n], function($, _, editable, editableInteraction, Interaction, AssociableHotspot){\r\n    'use strict';\r\n\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        \r\n        /**\r\n         * Set the default values for the model\r\n         * @returns {Object} the default attributes \r\n         */ \r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'maxAssociations' : 0,\r\n                'minAssociations' : 0\r\n            };\r\n        },\r\n\r\n        /**\r\n         * Once the interaction model is created, \r\n         * we set the responsivness and create a default response \r\n         */ \r\n        afterCreate : function(){\r\n            var relatedItem = this.getRelatedItem();\r\n            var isResponsive = relatedItem.data('responsive');\r\n\r\n            if(isResponsive === true){\r\n                this.addClass('responsive');\r\n            }\r\n            this.createResponse({\r\n                baseType:'pair',\r\n                cardinality:'multiple'\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * Create a choice for the interaction\r\n         * @param {Object} attr - the choice attributes\r\n         * @returns {Object} the created choice\r\n         */\r\n        createChoice : function(attr){\r\n            var choice = new AssociableHotspot('', attr);\r\n\r\n            this.addChoice(choice);\r\n            choice.buildIdentifier('associablehotspot');\r\n            \r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n            \r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n           \r\n            return choice;\r\n        }\r\n    });\r\n\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicInteraction',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig',\r\n    'taoQtiItem/qtiItem/helper/maxScore',\r\n    'taoQtiItem/qtiItem/helper/response'\r\n], function(GraphicInteraction, Element, _, rendererConfig, maxScore, responseHelper){\r\n    'use strict';\r\n\r\n    var GraphicGapMatchInteraction = GraphicInteraction.extend({\r\n        qtiClass : 'graphicGapMatchInteraction',\r\n        init : function init(serial, attributes){\r\n            this._super(serial, attributes);\r\n            this.gapImgs = {};\r\n        },\r\n        addGapImg : function addGapImg(gapImg){\r\n            if(Element.isA(gapImg, 'gapImg')){\r\n                gapImg.setRelatedItem(this.getRelatedItem() || null);\r\n                this.gapImgs[gapImg.getSerial()] = gapImg;\r\n            }\r\n        },\r\n        removeGapImg : function removeGapImg(gapImg){\r\n            var serial = '';\r\n            if(typeof(gapImg) === 'string'){\r\n                serial = gapImg;\r\n            }else if(Element.isA(gapImg, 'gapImg')){\r\n                serial = gapImg.getSerial();\r\n            }\r\n            delete this.gapImgs[serial];\r\n            return this;\r\n        },\r\n        getGapImgs : function getGapImgs(){\r\n            return _.clone(this.gapImgs);\r\n        },\r\n        getGapImg : function getGapImg(serial){\r\n            return this.gapImgs[serial];\r\n        },\r\n        getChoiceByIdentifier : function getChoiceByIdentifier(identifier){\r\n            var choice = this._super(identifier);\r\n            if(!choice){\r\n                //if not found among the choices, search the gapImgs\r\n                choice = _.find(this.gapImgs, function(elt){\r\n                    return (elt && elt.id() === identifier);\r\n                });\r\n            }\r\n            return choice;\r\n        },\r\n        getComposingElements : function getComposingElements(){\r\n            var serial, elts = this._super();\r\n            //recursive to choices:\r\n            for(serial in this.gapImgs){\r\n                elts[serial] = this.gapImgs[serial];\r\n                elts = _.extend(elts, this.gapImgs[serial].getComposingElements());\r\n            }\r\n            return elts;\r\n        },\r\n        find : function find(serial){\r\n            var found = this._super(serial);\r\n            if(!found){\r\n                if(this.gapImgs[serial]){\r\n                    found = {'parent' : this, 'element' : this.gapImgs[serial]};\r\n                }\r\n            }\r\n            return found;\r\n        },\r\n        render : function render(){\r\n            var serial,\r\n                args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    'gapImgs' : []\r\n                };\r\n\r\n            //note: no choice shuffling option available for graphic gap match\r\n            var gapImgs = this.getGapImgs();\r\n            for(serial in gapImgs){\r\n                if(Element.isA(gapImgs[serial], 'choice')){\r\n                    defaultData.gapImgs.push(gapImgs[serial].render({}, null, '', renderer));\r\n                }\r\n            }\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n        toArray : function toArray(){\r\n            var serial, gapImgs, arr = this._super();\r\n            arr.gapImgs = {};\r\n            gapImgs = this.getGapImgs();\r\n            for(serial in gapImgs){\r\n                arr.gapImgs[serial] = gapImgs[serial].toArray();\r\n            }\r\n            return arr;\r\n        },\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            var calculatePossiblePairs = function calculatePossiblePairs(graphicGapInteraction){\r\n                var pairs = [];\r\n                var matchSet1 = maxScore.getMatchMaxOrderedChoices(graphicGapInteraction.getGapImgs());\r\n                var matchSet2 = maxScore.getMatchMaxOrderedChoices(graphicGapInteraction.getChoices());\r\n\r\n                _.forEach(matchSet1, function(choice1){\r\n                    _.forEach(matchSet2, function(choice2){\r\n                        pairs.push([choice1.id, choice2.id]);\r\n                    });\r\n                });\r\n\r\n                return pairs;\r\n            };\r\n            return maxScore.associateInteractionBased(this, {possiblePairs : calculatePossiblePairs(this), checkInfinitePair : true});\r\n        }\r\n    });\r\n\r\n    return GraphicGapMatchInteraction;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/interactions/GraphicGapMatchInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicGapMatchInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/GapImg',\r\n    'taoQtiItem/qtiCreator/model/choices/AssociableHotspot'\r\n], function($, _, editable, editableInteraction, Interaction, GapImg, AssociableHotspot){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        \r\n\r\n        /**\r\n         * Once the interaction model is created, \r\n         * we set the responsivness and create a default response \r\n         */ \r\n        afterCreate : function(){\r\n            var relatedItem = this.getRelatedItem();\r\n            var isResponsive = relatedItem.data('responsive');\r\n\r\n            if(isResponsive === true){\r\n                this.addClass('responsive');\r\n            }\r\n            \r\n            this.createResponse({\r\n                baseType : 'directedPair',\r\n                cardinality : 'multiple'\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Create a new gap image\r\n         * @param {Object} object - the qti object\r\n         * @param {String} object.data - the image url\r\n         * @param {String|Number} object.width - the image width\r\n         * @param {String|Number} object.height - the image height\r\n         * @param {String} object.type - the image mime type\r\n         * @param {String} [label] - the object label (ie. alt)\r\n         */\r\n        createGapImg : function(object, label){\r\n            var gapImg = new GapImg();\r\n            gapImg.object.attributes = object; \r\n            if(label){\r\n                gapImg.attr('objectLabel', label); \r\n            }\r\n            if(!this.gapImgs){\r\n                this.gapImgs = [];\r\n            }\r\n            this.addGapImg(gapImg);\r\n            gapImg.buildIdentifier('gapimg');\r\n\r\n            if(this.getRenderer()){\r\n                gapImg.setRenderer(this.getRenderer());\r\n            }\r\n\r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : gapImg, 'interaction' : this});\r\n\r\n            return gapImg;\r\n        },\r\n\r\n        /**\r\n         * Create a choice for the interaction\r\n         * @param {Object} attr - the choice attributes\r\n         * @returns {Object} the created choice\r\n         */\r\n        createChoice : function(attr){\r\n            var choice = new AssociableHotspot('', attr);\r\n\r\n            this.addChoice(choice);\r\n            choice.buildIdentifier('associablehotspot');\r\n            \r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n            \r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n           \r\n            return choice;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(GraphicInteraction, maxScore){\r\n    'use strict';\r\n    var GraphicOrderInteraction = GraphicInteraction.extend({\r\n        qtiClass : 'graphicOrderInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.orderInteractionBased(this);\r\n        }\r\n    });\r\n    return GraphicOrderInteraction;\r\n});\r\n\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/interactions/GraphicOrderInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicOrderInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/HotspotChoice'\r\n], function($, _, editable, editableInteraction, Interaction, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n\r\n        /**\r\n         * Set the default values for the model\r\n         * @returns {Object} the default attributes \r\n         */ \r\n        getDefaultAttributes : function(){\r\n            return {};\r\n        },\r\n\r\n        /**\r\n         * Once the interaction model is created, \r\n         * we set the responsivness and create a default response \r\n         */ \r\n        afterCreate : function(){\r\n            var relatedItem = this.getRelatedItem();\r\n            var isResponsive = relatedItem.data('responsive');\r\n\r\n            if(isResponsive === true){\r\n                this.addClass('responsive');\r\n            }\r\n            this.createResponse({\r\n                baseType:'identifier',\r\n                cardinality:'ordered'\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Create a choice for the interaction\r\n         * @param {Object} attr - the choice attributes\r\n         * @returns {Object} the created choice\r\n         */\r\n        createChoice : function(attr){\r\n            var choice = new Choice('', attr);\r\n\r\n            this.addChoice(choice);\r\n            choice.buildIdentifier('hotspot');\r\n            \r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n            \r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n           \r\n            return choice;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/HotspotInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(GraphicInteraction, maxScore){\r\n    'use strict';\r\n    var HotspotInteraction = GraphicInteraction.extend({\r\n        qtiClass : 'hotspotInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.choiceInteractionBased(this);\r\n        }\r\n    });\r\n    return HotspotInteraction;\r\n});\r\n\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/interactions/HotspotInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/HotspotInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/HotspotChoice'\r\n], function($, _, editable, editableInteraction, Interaction, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        \r\n        /**\r\n         * Set the default values for the model\r\n         * @returns {Object} the default attributes \r\n         */ \r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'maxChoices' : 0,\r\n                'minChoices' : 0\r\n            };\r\n        },\r\n\r\n        /**\r\n         * Once the interaction model is created, \r\n         * we set the responsivness and create a default response \r\n         */ \r\n        afterCreate : function(){\r\n            var relatedItem = this.getRelatedItem();\r\n            var isResponsive = relatedItem.data('responsive');\r\n\r\n            if(isResponsive === true){\r\n                this.addClass('responsive');\r\n            }\r\n            this.createResponse({\r\n                baseType:'identifier',\r\n                cardinality:'single'\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Create a choice for the interaction\r\n         * @param {Object} attr - the choice attributes\r\n         * @returns {Object} the created choice\r\n         */\r\n        createChoice : function(attr){\r\n            var choice = new Choice('', attr);\r\n\r\n            this.addChoice(choice);\r\n            choice.buildIdentifier('hotspot');\r\n            \r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n            \r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n           \r\n            return choice;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/HottextInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/ContainerInteraction',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(ContainerInteraction, Element, maxScore){\r\n    'use strict';\r\n    var HottextInteraction = ContainerInteraction.extend({\r\n        qtiClass : 'hottextInteraction',\r\n        getChoices : function(){\r\n            return this.getBody().getElements('hottext');\r\n        },\r\n        getChoice : function(serial){\r\n            var element = this.getBody().getElement(serial);\r\n            return Element.isA(element, 'choice') ? element : null;\r\n        },\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.choiceInteractionBased(this);\r\n        }\r\n    });\r\n    return HottextInteraction;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/HottextInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/HottextInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/Hottext',\r\n    'taoQtiItem/qtiCreator/model/helper/event',\r\n    'taoQtiItem/qtiCreator/model/helper/response'\r\n], function(_, Element, editable, editableInteraction, Interaction, Choice,event, responseHelper){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                maxChoices : 0,\r\n                minChoices : 0\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.body('<p>Lorem ipsum dolor sit amet, consectetur adipisicing ...</p>');\r\n            this.createResponse({\r\n                baseType : 'identifier',\r\n                cardinality : 'multiple'\r\n            });\r\n        },\r\n        createChoice : function(attr, body){\r\n\r\n            var choice = new Choice('', attr);\r\n\r\n            this.addChoice(choice);\r\n            choice.buildIdentifier('hottext');\r\n            choice.body(body);\r\n                \r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n            \r\n            event.choiceCreated(choice, this);\r\n\r\n            return choice;\r\n        },\r\n        removeChoice : function(hottext){\r\n        \r\n            var serial = '', c;\r\n            \r\n            if(typeof(hottext) === 'string'){\r\n                serial = hottext;\r\n            }else if(Element.isA(hottext, 'hottext')){\r\n                serial = hottext.getSerial();\r\n            }\r\n            \r\n            c = this.getBody().getElement(serial);\r\n            if(c){\r\n                //remove choice\r\n                this.getBody().removeElement(c);\r\n                \r\n                //update the response\r\n                responseHelper.removeChoice(this.getResponseDeclaration(), c);\r\n                \r\n                //trigger event\r\n                event.deleted(c, this);\r\n            }\r\n            \r\n            return this;\r\n        }\r\n    });\r\n    \r\n    return Interaction.extend(methods);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/InlineInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(InlineInteraction, maxScore){\r\n    'use strict';\r\n    var InlineChoiceInteraction = InlineInteraction.extend({\r\n        'qtiClass' : 'inlineChoiceInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.choiceInteractionBased(this, {maxChoices:1});\r\n        }\r\n    });\r\n    return InlineChoiceInteraction;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/InlineChoiceInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/InlineChoiceInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/InlineChoice'\r\n], function($, _, editable, editableInteraction, Interaction, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'shuffle' : false,\r\n                'required' : false\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createChoice();\r\n            this.createChoice();\r\n            this.createChoice();\r\n            this.createResponse({\r\n                baseType:'identifier',\r\n                cardinality:'single'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            var choice = new Choice();\r\n\r\n            this.addChoice(choice);\r\n\r\n            var rank = _.size(this.getChoices());\r\n\r\n            choice\r\n                .val('choice' + ' #' + rank)\r\n                .buildIdentifier('choice');\r\n\r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n\r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n\r\n            return choice;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/MatchInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/BlockInteraction',\r\n    'taoQtiItem/qtiItem/core/choices/SimpleAssociableChoice',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(BlockInteraction, SimpleAssociableChoice, _, rendererConfig, util, maxScore){\r\n    'use strict';\r\n\r\n    var MatchInteraction = BlockInteraction.extend({\r\n        qtiClass : 'matchInteraction',\r\n        init : function init(serial, attributes){\r\n            this._super(serial, attributes);\r\n            this.choices = [{}, {}];\r\n        },\r\n        addChoice : function addChoice(choice, matchSet){\r\n            matchSet = parseInt(matchSet);\r\n            if(this.choices[matchSet]){\r\n                choice.setRelatedItem(this.getRelatedItem() || null);\r\n                this.choices[matchSet][choice.getSerial()] = choice;\r\n            }\r\n        },\r\n        getChoices : function getChoices(matchSet){\r\n            matchSet = parseInt(matchSet);\r\n            if(this.choices[matchSet]){\r\n                return _.clone(this.choices[matchSet]);\r\n            }else{\r\n                return _.clone(this.choices);\r\n            }\r\n        },\r\n        getChoice : function getChoice(serial){\r\n            return this.choices[0][serial] || this.choices[1][serial] || null;\r\n        },\r\n        getChoiceByIdentifier : function getChoiceByIdentifier(identifier){\r\n            var i, matchSet, serial;\r\n            //recursive to both match sets:\r\n            for(i = 0; i < 2; i++){\r\n                matchSet = this.getChoices(i);\r\n                for(serial in matchSet){\r\n                    if(matchSet[serial] instanceof SimpleAssociableChoice && matchSet[serial].id() === identifier){\r\n                        return matchSet[serial];\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        },\r\n        getComposingElements : function getComposingElements(){\r\n            var i, matchSet, serial;\r\n            var elts = this._super();\r\n            //recursive to both match sets:\r\n            for(i = 0; i < 2; i++){\r\n                matchSet = this.getChoices(i);\r\n                for(serial in matchSet){\r\n                    if(matchSet[serial] instanceof SimpleAssociableChoice){\r\n                        elts[serial] = matchSet[serial];\r\n                        elts = _.extend(elts, matchSet[serial].getComposingElements());\r\n                    }\r\n                }\r\n            }\r\n\r\n            return elts;\r\n        },\r\n        find : function find(serial){\r\n            var found = this._super(serial);\r\n            if(!found){\r\n                found = util.findInCollection(this, ['choices.0', 'choices.1'], serial);\r\n            }\r\n            return found;\r\n        },\r\n        render : function render(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments);\r\n            var renderer = args.renderer || this.getRenderer();\r\n            var defaultData = {\r\n                'matchSet1' : [],\r\n                'matchSet2' : []\r\n            };\r\n            var choices, i, matchSet, serial;\r\n            var interactionData = {'interaction' : {'serial' : this.serial, 'attributes' : this.attributes}};\r\n\r\n            if(!renderer){\r\n                throw 'no renderer found for the interaction ' + this.qtiClass;\r\n            }\r\n\r\n            if(this.attr('shuffle') && renderer.getOption('shuffleChoices')){\r\n                choices = renderer.getShuffledChoices(this);\r\n            }else{\r\n                choices = this.getChoices();\r\n            }\r\n\r\n            for(i = 0; i < 2; i++){\r\n                matchSet = choices[i];\r\n                for(serial in matchSet){\r\n                    if(matchSet[serial] instanceof SimpleAssociableChoice){\r\n                        defaultData['matchSet' + (i + 1)].push(matchSet[serial].render(_.clone(interactionData, true), null, 'simpleAssociableChoice.matchInteraction', renderer));\r\n                    }\r\n                }\r\n            }\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n        postRender : function postRender(data, altClassName, renderer){\r\n            renderer = renderer || this.getRenderer();\r\n            return _(this.getChoices())\r\n                .map(function(choices){\r\n                    return _(choices)\r\n                        .filter(function(choice){\r\n                            return choice instanceof SimpleAssociableChoice;\r\n                        })\r\n                        .map(function(choice){\r\n                            return choice.postRender({}, 'simpleAssociableChoice.matchInteraction', renderer);\r\n                        })\r\n                        .value();\r\n                })\r\n                .flatten(true)\r\n                .value()\r\n                .concat(this._super(data, altClassName, renderer));\r\n        },\r\n        toArray : function toArray(){\r\n            var i, matchSet, serial;\r\n            var arr = this._super();\r\n            arr.choices = {0 : {}, 1 : {}};\r\n            for(i = 0; i < 2; i++){\r\n                matchSet = this.getChoices(i);\r\n                for(serial in matchSet){\r\n                    if(matchSet[serial] instanceof SimpleAssociableChoice){\r\n                        arr.choices[i][serial] = matchSet[serial].toArray();\r\n                    }\r\n                }\r\n            }\r\n            return arr;\r\n        },\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            var calculatePossiblePairs = function calculatePossiblePairs(matchInteraction){\r\n                //get max number of pairs\r\n                var pairs = [];\r\n                var matchSet1 = maxScore.getMatchMaxOrderedChoices(matchInteraction.getChoices(0));\r\n                var matchSet2 = maxScore.getMatchMaxOrderedChoices(matchInteraction.getChoices(1));\r\n\r\n                _.forEach(matchSet1, function(choice1){\r\n                    _.forEach(matchSet2, function(choice2){\r\n                        pairs.push([choice1.id, choice2.id]);\r\n                    });\r\n                });\r\n\r\n                return pairs;\r\n            };\r\n            return maxScore.associateInteractionBased(this, {possiblePairs : calculatePossiblePairs(this)});\r\n        }\r\n    });\r\n\r\n    return MatchInteraction;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/MatchInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/MatchInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/SimpleAssociableChoice',\r\n    'taoQtiItem/qtiCreator/model/helper/event',\r\n    'taoQtiItem/qtiCreator/model/helper/response'\r\n], function(_, Element, editable, editableInteraction, Interaction, Choice, event, responseHelper){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'shuffle' : false,\r\n                'maxAssociations' : 0,\r\n                'minAssociations' : 0\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createChoice(0);\r\n            this.createChoice(0);\r\n            this.createChoice(1);\r\n            this.createChoice(1);\r\n            this.createResponse({\r\n                baseType:'directedPair',\r\n                cardinality:'multiple'\r\n            });\r\n        },\r\n        createChoice : function(matchSet, attr){\r\n        \r\n            var choice = new Choice('', attr);\r\n            \r\n            this.addChoice(choice, matchSet);\r\n            \r\n            var rank = _.size(this.getChoices(matchSet));\r\n            \r\n            choice\r\n                .body('choice' + ' #' + rank)\r\n                .buildIdentifier('choice');\r\n            \r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n            \r\n            event.choiceCreated(choice, this);\r\n            \r\n            return choice;\r\n        },\r\n        removeChoice : function(choice){\r\n            \r\n            var serial = '', c;\r\n            \r\n            if(typeof(choice) === 'string'){\r\n                serial = choice;\r\n            }else if(Element.isA(choice, 'choice')){\r\n                serial = choice.getSerial();\r\n            }\r\n            \r\n            c = this.choices[0][serial] || this.choices[1][serial] || null;\r\n            \r\n            if(c){\r\n                \r\n                //remove choice\r\n                delete this.choices[0][serial];\r\n                delete this.choices[1][serial];\r\n                \r\n                //update the response\r\n                responseHelper.removeChoice(this.getResponseDeclaration(), c);\r\n                \r\n                //trigger event\r\n                event.deleted(c, this);\r\n            }\r\n            \r\n            return this;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/MediaInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/interactions/ObjectInteraction',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function(_, ObjectInteraction, rendererConfig){\r\n    'use strict';\r\n\r\n    var MediaInteraction = ObjectInteraction.extend({\r\n        qtiClass : 'mediaInteraction',\r\n        render : function render(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    object : this.object.render({}, null, '', renderer)\r\n                };\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        }\r\n    });\r\n    return MediaInteraction;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/MediaInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/MediaInteraction'\r\n], function(_, editable, editableInteraction, Interaction){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n\r\n            //var defAtt = interaction.getDefaultAttributes();\r\n            //_.extend(interaction.attributes, defAtt);\r\n            //delete interaction.attributes.media;\r\n            //_.extend(interaction.object.attributes, defAtt.media);\r\n            \r\n            return {\r\n                /*media: {\r\n                  //data: 'http://tao.localdomain/filemanager/views/data/media/echo-hereweare.mp4',\r\n                  data: '',\r\n                  type: 'video/mp4',\r\n                  width: 480,\r\n                  height: 270\r\n                },*/\r\n                autostart : false,\r\n                minPlays : 0,\r\n                maxPlays : 0,\r\n                loop : false\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            //function that will immediately be called after its creation in the item creator\r\n            //nothing special to do here ?\r\n            \r\n            this.createResponse({\r\n                baseType:'integer',\r\n                cardinality:'single'\r\n            });\r\n            \r\n        },\r\n        createChoice : function(){\r\n            throw 'mediaInteraction does not have any choices';\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/OrderInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/BlockInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(BlockInteraction, maxScore){\r\n    'use strict';\r\n    var OrderInteraction = BlockInteraction.extend({\r\n        qtiClass : 'orderInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.orderInteractionBased(this);\r\n        }\r\n    });\r\n    return OrderInteraction;\r\n});\n","define('taoQtiItem/qtiCreator/model/interactions/OrderInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/OrderInteraction',\r\n    'taoQtiItem/qtiCreator/model/choices/SimpleChoice'\r\n], function($, _, editable, editableInteraction, Interaction, Choice){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                shuffle : false,\r\n                orientation : 'vertical'\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createChoice();\r\n            this.createChoice();\r\n            this.createChoice();\r\n            this.createResponse({\r\n                baseType:'identifier',\r\n                cardinality:'ordered'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            var choice = new Choice();\r\n\r\n            this.addChoice(choice);\r\n\r\n            var rank = _.size(this.getChoices());\r\n\r\n            choice\r\n                .body('choice' + ' #' + rank)\r\n                .buildIdentifier('choice');\r\n\r\n            if(this.getRenderer()){\r\n                choice.setRenderer(this.getRenderer());\r\n            }\r\n\r\n            $(document).trigger('choiceCreated.qti-widget', {'choice' : choice, 'interaction' : this});\r\n\r\n            return choice;\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/mixin/CustomElement',[\r\n    'taoQtiItem/qtiItem/mixin/Mixin',\r\n    'lodash'\r\n], function(Mixin, _){\r\n\r\n    var methods = {\r\n        prop : function(name, value){\r\n            if(name){\r\n                if(value !== undefined){\r\n                    this.properties[name] = value;\r\n                }else{\r\n                    if(typeof (name) === 'object'){\r\n                        for(var prop in name){\r\n                            this.prop(prop, name[prop]);\r\n                        }\r\n                    }else if(typeof (name) === 'string'){\r\n                        if(this.properties[name] === undefined){\r\n                            return undefined;\r\n                        }else{\r\n                            return this.properties[name];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return this;\r\n        },\r\n        removeProp : function(propNames){\r\n            var _this = this;\r\n            if(typeof (propNames) === 'string'){\r\n                propNames = [propNames];\r\n            }\r\n            _.each(propNames, function(propName){\r\n                delete _this.attributes[propName];\r\n            });\r\n            return this;\r\n        },\r\n        getProperties : function(){\r\n            return _.clone(this.properties);\r\n        },\r\n        getMarkupNamespace : function(){\r\n\r\n            if(this.markupNs && this.markupNs.name && this.markupNs.uri){\r\n                return _.clone(this.markupNs);\r\n            }else{\r\n                var relatedItem = this.getRelatedItem();\r\n                if(relatedItem){\r\n                    //set the default one:\r\n                    relatedItem.namespaces[this.defaultMarkupNsName] = this.defaultMarkupNsUri;\r\n                    return {\r\n                        name : this.defaultMarkupNsName,\r\n                        uri : this.defaultMarkupNsUri\r\n                    };\r\n                }\r\n            }\r\n\r\n            return {};\r\n        },\r\n        setMarkupNamespace : function(name, uri){\r\n            this.markupNs = {\r\n                name : name,\r\n                uri : uri\r\n            };\r\n        }\r\n    };\r\n\r\n    return {\r\n        augment : function(targetClass){\r\n            Mixin.augment(targetClass, methods);\r\n        },\r\n        methods : methods\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiItem/core/interactions/CustomInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/interactions/Interaction',\r\n    'taoQtiItem/qtiItem/mixin/CustomElement',\r\n    'taoQtiItem/qtiItem/mixin/NamespacedElement',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function(_, Interaction, CustomElement, NamespacedElement, rendererConfig){\r\n\r\n    var CustomInteraction = Interaction.extend({\r\n        qtiClass : 'customInteraction',\r\n        defaultNsName : 'pci',\r\n        defaultNsUri : 'http://www.imsglobal.org/xsd/portableCustomInteraction',\r\n        nsUriFragment : 'portableCustomInteraction',\r\n        defaultMarkupNsName : 'html5',\r\n        defaultMarkupNsUri : 'html5',\r\n        init : function(serial, attributes){\r\n\r\n            this._super(serial, attributes);\r\n\r\n            this.typeIdentifier = '';\r\n            this.markup = '';\r\n            this.properties = {};\r\n            this.libraries = [];\r\n            this.entryPoint = '';\r\n\r\n            //note : if the uri is defined, it will be set the uri in the xml on xml serialization,\r\n            //which may trigger xsd validation, which is troublesome for html5 (use xhtml5 maybe ?)\r\n            this.markupNs = {};\r\n\r\n            this.pciReadyCallbacks = [];\r\n        },\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'customInteraction') || this._super(qtiClass);\r\n        },\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    typeIdentifier : this.typeIdentifier,\r\n                    markup : this.markup,\r\n                    properties : this.properties,\r\n                    libraries : this.libraries,\r\n                    entryPoint : this.entryPoint,\r\n                    ns : {\r\n                        pci : this.getNamespace().name + ':'\r\n                    }\r\n                };\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n        toArray : function(){\r\n            var arr = this._super();\r\n            arr.markup = this.markup;\r\n            arr.properties = this.properties;\r\n            return arr;\r\n        },\r\n        getMarkupNamespace : function(){\r\n\r\n            if(this.markupNs && this.markupNs.name && this.markupNs.uri){\r\n                return _.clone(this.markupNs);\r\n            }else{\r\n                var relatedItem = this.getRelatedItem();\r\n                if(relatedItem){\r\n                    //set the default one:\r\n                    relatedItem.namespaces[this.defaultMarkupNsName] = this.defaultMarkupNsUri;\r\n                    return {\r\n                        name : this.defaultMarkupNsName,\r\n                        uri : this.defaultMarkupNsUri\r\n                    };\r\n                }\r\n            }\r\n\r\n            return {};\r\n        },\r\n        setMarkupNamespace : function(name, uri){\r\n            this.markupNs = {\r\n                name : name,\r\n                uri : uri\r\n            };\r\n        },\r\n        onPciReady : function(callback){\r\n\r\n            this.pciReadyCallbacks.push(callback);\r\n\r\n            if(this.data('pci')){\r\n                //if pci is already ready, call it immediately\r\n                this.triggerPciReady();\r\n            }\r\n        },\r\n        triggerPciReady : function(){\r\n\r\n            var _this = this,\r\n                pci = this.data('pci');\r\n\r\n            if(pci){\r\n                _.each(this.pciReadyCallbacks, function(fn){\r\n                    fn.call(_this, pci);\r\n                });\r\n                \r\n                //empty the stack of ready callbacks\r\n                this.pciReadyCallbacks = [];\r\n                \r\n                //mark the interaction as ready\r\n                this.data('pciReady', true);\r\n                \r\n            }else{\r\n                throw 'cannot trigger pci ready when no pci is actually attached to the interaction';\r\n            }\r\n\r\n        },\r\n        onPci : function(event, callback){\r\n            this.onPciReady(function(pci){\r\n                if(_.isFunction(pci.on)){\r\n                    pci.on(event, callback);\r\n                }else{\r\n                    throw 'the pci does not implement on() function';\r\n                }\r\n            });\r\n            return this;\r\n        },\r\n        offPci : function(event){\r\n            this.onPciReady(function(pci){\r\n                if(_.isFunction(pci.off)){\r\n                    pci.off(event);\r\n                }else{\r\n                    throw 'the pci does not implement off() function';\r\n                }\r\n            });\r\n            return this;\r\n        },\r\n        triggerPci : function(event, args){\r\n            this.onPciReady(function(pci){\r\n                if(_.isFunction(pci.off)){\r\n                    pci.trigger(event, args);\r\n                }else{\r\n                    throw 'the pci does not implement off() function';\r\n                }\r\n            });\r\n            return this;\r\n        }\r\n    });\r\n    \r\n    //add portable element standard functions\r\n    CustomElement.augment(CustomInteraction);\r\n    NamespacedElement.augment(CustomInteraction);\r\n    \r\n    return CustomInteraction;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/PortableCustomInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiCreator/model/helper/portableElement',\r\n    'taoQtiItem/portableElementRegistry/ciRegistry',\r\n    'taoQtiItem/qtiItem/core/interactions/CustomInteraction'\r\n], function(_, editable, editableInteraction, portableElement, ciRegistry, Interaction){\r\n    \"use strict\";\r\n    var _throwMissingImplementationError = function(pci, fnName){\r\n        throw fnName + ' not available for pci of type ' + pci.typeIdentifier;\r\n    };\r\n\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, portableElement.getDefaultMethods(ciRegistry));\r\n    _.extend(methods, {\r\n        createChoice : function(){\r\n\r\n            var creator = ciRegistry.getCreator(this.typeIdentifier);\r\n            if(_.isFunction(creator.createChoice)){\r\n                return creator.createChoice(this);\r\n            }else{\r\n                _throwMissingImplementationError(this, 'createChoice');\r\n            }\r\n        },\r\n        getDefaultMarkupTemplateData : function(){\r\n            return {\r\n                responseIdentifier : this.attr('responseIdentifier')\r\n            };\r\n        }\r\n    });\r\n\r\n    return Interaction.extend(methods);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/SelectPointInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/GraphicInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(GraphicInteraction, maxScore){\r\n    'use strict';\r\n    var SelectPointInteraction = GraphicInteraction.extend({\r\n        qtiClass : 'selectPointInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.selectPointInteractionBased(this);\r\n        }\r\n    });\r\n    return SelectPointInteraction;\r\n});\r\n\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/interactions/SelectPointInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/SelectPointInteraction'\r\n], function($, _, editable, editableInteraction, Interaction){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        \r\n        /**\r\n         * Set the default values for the model\r\n         * @returns {Object} the default attributes \r\n         */ \r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'maxChoices' : 0,\r\n                'minChoices' : 0\r\n            };\r\n        },\r\n\r\n        /**\r\n         * Once the interaction model is created, \r\n         * we set the responsivness and create a default response \r\n         */ \r\n        afterCreate : function(){\r\n            var relatedItem = this.getRelatedItem();\r\n            var isResponsive = relatedItem.data('responsive');\r\n\r\n            if(isResponsive === true){\r\n                this.addClass('responsive');\r\n            }\r\n            this.createResponse({\r\n                baseType:'point',\r\n                cardinality:'multiple'\r\n            }, 'MAP_RESPONSE_POINT');\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/SliderInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/BlockInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore',\r\n], function(BlockInteraction, maxScore){\r\n    'use strict';\r\n    var SliderInteraction = BlockInteraction.extend({\r\n        qtiClass : 'sliderInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.sliderInteractionBased(this);\r\n        }\r\n    });\r\n    return SliderInteraction;\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/SliderInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/SliderInteraction'\r\n], function(_, editable, editableInteraction, Interaction){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'lowerBound': 0.0,\r\n                'upperBound': 100.0,\r\n                'orientation': 'horizontal',\r\n                'reverse': false,\r\n                'step': 1,\r\n                'stepLabel': false\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createResponse({\r\n                baseType: 'integer',\r\n                cardinality: 'single'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            throw \"sliderInteraction does not have any choices\";\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiItem/core/interactions/TextEntryInteraction',[\r\n    'taoQtiItem/qtiItem/core/interactions/InlineInteraction',\r\n    'taoQtiItem/qtiItem/helper/maxScore'\r\n], function(InlineInteraction, maxScore){\r\n    'use strict';\r\n    var TextEntryInteraction = InlineInteraction.extend({\r\n        'qtiClass' : 'textEntryInteraction',\r\n        getNormalMaximum : function getNormalMaximum(){\r\n            return maxScore.textEntryInteractionBased(this);\r\n        }\r\n    });\r\n    return TextEntryInteraction;\r\n});\n","define('taoQtiItem/qtiCreator/model/interactions/TextEntryInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/TextEntryInteraction'\r\n], function(_, editable, editableInteraction, Interaction){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                base : 10,\r\n                placeholderText : ''\r\n            };\r\n        },\r\n        afterCreate : function(){\r\n            this.createResponse({\r\n                baseType:'string',\r\n                cardinality:'single'\r\n            });\r\n        },\r\n        createChoice : function(){\r\n            throw new Error('text entry interaction has no choice');\r\n        }\r\n    });\r\n    return Interaction.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/core/interactions/UploadInteraction',['taoQtiItem/qtiItem/core/interactions/BlockInteraction'], function(InlineInteraction){\r\n    var UploadInteraction = InlineInteraction.extend({\r\n        'qtiClass' : 'uploadInteraction'\r\n    });\r\n    return UploadInteraction;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiCreator/model/interactions/UploadInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/mixin/editableInteraction',\r\n    'taoQtiItem/qtiItem/core/interactions/UploadInteraction'\r\n], function(_, editable, editableInteraction, Interaction) {\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, editableInteraction);\r\n    _.extend(methods, {\r\n        getDefaultAttributes: function() {\r\n            // The QTI uploadInteraction has a option\r\n            // attribute 'type'\r\n            // https://www.imsglobal.org/question/qti_v2p0/imsqti_infov2p0.html#element10350\r\n            return {};\r\n        },\r\n        \r\n        afterCreate: function() {\r\n            // As per specs, a QTI uploadInteraction\r\n            // is always bound to a response variable\r\n            // with base-type file and single cardinality.\r\n            this.createResponse({\r\n                baseType:'file',\r\n                cardinality:'single'\r\n            });\r\n        },\r\n        \r\n        createChoice: function() {\r\n            throw 'uploadInteraction does not have any choices';\r\n        }\r\n    });\r\n    \r\n    return Interaction.extend(methods);\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiItem/core/Math',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig',\r\n    'taoQtiItem/qtiItem/mixin/NamespacedElement'\r\n], function($, _, Element, rendererConfig, NamespacedElement){\r\n    'use strict';\r\n\r\n    var Math;\r\n\r\n    /**\r\n     * Remove the closing MathML tags and remove useless line breaks before and after it\r\n     *\r\n     * @param {String} mathML\r\n     * @param {String} nsName\r\n     * @returns {String}\r\n     */\r\n    function _stripMathTags(mathML, nsName){\r\n        var regex = new RegExp('<(\\/)?' + (nsName ? nsName + ':' : '') + 'math[^>]*>', 'g');\r\n        return mathML.replace(regex, '')\r\n            .replace(/^\\s*[\\r\\n]/gm, '')//remove first blank line\r\n            .replace(/\\s*[\\r\\n]$/gm, '');//last blank line\r\n    }\r\n\r\n    /**\r\n     * Remove mathML ns name prefix from the mathML\r\n     *\r\n     * @param {String} mathML\r\n     * @param {String} nsName\r\n     * @returns {String}\r\n     */\r\n    function _stripNamespace(mathML, nsName){\r\n        var regex = new RegExp('<(\\/)?' + (nsName ? nsName + ':' : ''), 'g');\r\n        return mathML.replace(regex, '<$1');\r\n    }\r\n\r\n    /**\r\n     * Check if the mathML string is to be considered empty\r\n     *\r\n     * @param {String} mathStr\r\n     * @returns {Boolean}\r\n     */\r\n    function _isEmptyMathML(mathStr){\r\n        var $math,\r\n            mathText,\r\n            hasContent = false;\r\n\r\n        if(mathStr && mathStr.trim()){\r\n            $math = $($.parseHTML(mathStr));\r\n            mathText = $math.text();\r\n            hasContent = (_.isString(mathText) && !!mathText.trim());\r\n        }\r\n\r\n        return !hasContent;\r\n    }\r\n\r\n    Math = Element.extend({\r\n        qtiClass : 'math',\r\n        defaultNsName : 'm',\r\n        defaultNsUri : 'http://www.w3.org/1998/Math/MathML',\r\n        nsUriFragment : 'MathML',\r\n        init : function(serial, attributes){\r\n            this._super(serial, attributes);\r\n            this.ns = null;\r\n            this.mathML = '';\r\n            this.annotations = {};\r\n        },\r\n        setAnnotation : function(encoding, value){\r\n            this.annotations[encoding] = _.unescape(value);\r\n        },\r\n        getAnnotation : function(encoding){\r\n            return this.annotations[encoding];\r\n        },\r\n        removeAnnotation : function(encoding){\r\n            delete this.annotations[encoding];\r\n        },\r\n        setMathML : function(mathML){\r\n            var ns = this.getNamespace(),\r\n                nsName = (ns.name && ns.uri) ? ns.name : '';\r\n\r\n            mathML = _stripMathTags(mathML, nsName);\r\n            if(ns){\r\n                mathML = _stripNamespace(mathML, nsName);\r\n            }\r\n            this.mathML = mathML;\r\n        },\r\n        getMathML : function(){\r\n            return this.mathML;\r\n        },\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                tag = this.qtiClass,\r\n                raw = this.mathML,\r\n                body = raw,\r\n                ns = this.getNamespace(),\r\n                annotations = '',\r\n                encoding,\r\n                defaultData;\r\n\r\n            for(encoding in this.annotations){\r\n                annotations += '<annotation encoding=\"' + encoding + '\">' + _.escape(this.annotations[encoding]) + '</annotation>';\r\n            }\r\n\r\n            if(annotations){\r\n                if(raw.indexOf('</semantics>') > 0){\r\n                    raw = raw.replace('</semantics>', annotations + '</semantics>');\r\n                }else{\r\n                    raw = '<semantics>' + raw + annotations + '</semantics>';\r\n                }\r\n            }\r\n\r\n            if (ns && ns.name) {\r\n                body = raw.replace(/<(\\/)?([^!<])/g, '<$1' + ns.name + ':$2');\r\n                tag = ns.name + ':' + tag;\r\n            }\r\n\r\n            body = body.replace(/<!--.*?-->/g, ''); // remove Mathjax-generated comments\r\n            body = body.replace(/&lt;!--.*?--&gt;/g, ''); // fix for broken items because of Mathjax comments\r\n\r\n            defaultData = {\r\n                block : (this.attr('display') === 'block') ? true : false,\r\n                body : body,\r\n                raw : raw,\r\n                tag : tag,\r\n                ns : ns\r\n            };\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n        isEmpty : function(){\r\n            return _isEmptyMathML(this.mathML) && (!this.annotations.latex || !this.annotations.latex.trim());\r\n        }\r\n    });\r\n\r\n    NamespacedElement.augment(Math);\r\n\r\n    return Math;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/Math',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/Math'\r\n], function(_, editable, Math){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {};\r\n        },\r\n        afterCreate : function(){\r\n            this.getNamespace();\r\n        }\r\n    });\r\n    return Math.extend(methods);\r\n});\n","define('taoQtiItem/qtiCreator/model/Object',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/Object'\r\n], function(_, editable, Object){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                data : '',\r\n                type : ''\r\n            };\r\n        }\r\n    });\r\n    return Object.extend(methods);\r\n});\n","define('taoQtiItem/qtiCreator/model/pciCreatorContext',['lodash'], function(_){\r\n    \r\n    \"use strict\";\r\n    \r\n    var _pciModels = {};\r\n    \r\n    /**\r\n     * Global object accessible by all PCIs\r\n     * \r\n     * @type Object\r\n     */\r\n    var pciCreatorContext = {\r\n        /**\r\n         * register a custom interaction (its runtime model) in global registery\r\n         * register a renderer\r\n         * \r\n         * @param {Object} pciModel\r\n         * @returns {undefined}\r\n         */\r\n        register : function(pciModel){\r\n            //@todo check pciModel validity\r\n            _pciModels[pciModel.getTypeIdentifier()] = pciModel;\r\n        },\r\n        /**\r\n         * Get a cloned object representing the PCI model\r\n         * \r\n         * @param {string} pciTypeIdentifier\r\n         * @returns {Object} clonedPciModel\r\n         */\r\n        createPciInstance : function(pciTypeIdentifier){\r\n            if(_pciModels[pciTypeIdentifier]){\r\n                return _.cloneDeep(_pciModels[pciTypeIdentifier]);\r\n            }\r\n        }\r\n    };\r\n\r\n    return pciCreatorContext;\r\n});\n","define('taoQtiItem/qtiItem/core/PortableInfoControl',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/mixin/CustomElement',\r\n    'taoQtiItem/qtiItem/mixin/NamespacedElement',\r\n    'taoQtiItem/qtiItem/helper/rendererConfig'\r\n], function(_, Element, CustomElement, NamespacedElement, rendererConfig){\r\n    'use strict';\r\n\r\n    var PortableInfoControl = Element.extend({\r\n        qtiClass : 'infoControl',\r\n        defaultNsName : 'pic',\r\n        defaultNsUri : 'http://www.imsglobal.org/xsd/portableInfoControl',\r\n        nsUriFragment : 'portableInfoControl',\r\n        defaultMarkupNsName : 'html5',\r\n        defaultMarkupNsUri : 'html5',\r\n\r\n        init : function(serial, attributes){\r\n\r\n            this._super(serial, attributes);\r\n\r\n            this.typeIdentifier = '';\r\n            this.markup = '';\r\n            this.properties = {};\r\n            this.libraries = [];\r\n            this.entryPoint = '';\r\n\r\n            //note : if the uri is defined, it will be set the uri in the xml on xml serialization,\r\n            //which may trigger xsd validation, which is troublesome for html5 (use xhtml5 maybe ?)\r\n            this.markupNs = {};\r\n\r\n            //stack of callback waiting to be ready\r\n            this.readyStack = [];\r\n        },\r\n\r\n        is : function(qtiClass){\r\n            return (qtiClass === 'infoControl') || this._super(qtiClass);\r\n        },\r\n\r\n        render : function(){\r\n\r\n            var args = rendererConfig.getOptionsFromArguments(arguments),\r\n                renderer = args.renderer || this.getRenderer(),\r\n                defaultData = {\r\n                    typeIdentifier : this.typeIdentifier,\r\n                    markup : this.markup,\r\n                    properties : this.properties,\r\n                    libraries : this.libraries,\r\n                    entryPoint : this.entryPoint,\r\n                    ns : {\r\n                        pic : this.getNamespace().name + ':'\r\n                    }\r\n                };\r\n\r\n            return this._super(_.merge(defaultData, args.data), args.placeholder, args.subclass, renderer);\r\n        },\r\n\r\n        /**\r\n         * Retrieve the state of the infoControl\r\n         * The call will be delegated to the infoControl's renderer.\r\n         *\r\n         * @returns {Object} the state\r\n         */\r\n        getState : function getState(){\r\n            var ret = null;\r\n            var renderer = this.getRenderer();\r\n            if(renderer && _.isFunction(renderer.getState)){\r\n                ret = renderer.getState(this);\r\n            }\r\n            return ret;\r\n        },\r\n\r\n        /**\r\n         * Set the state of the infoControl\r\n         * The state will be set to the infoControl's renderer.\r\n         *\r\n         * @param {Object} state - the infoControl's state\r\n         */\r\n        setState : function setState(state){\r\n            var renderer = this.getRenderer();\r\n            if(renderer && _.isFunction(renderer.getState)){\r\n                renderer.setState(this, state);\r\n            }\r\n        },\r\n\r\n        toArray : function(){\r\n            var arr = this._super();\r\n            arr.markup = this.markup;\r\n            arr.properties = this.properties;\r\n            return arr;\r\n        },\r\n\r\n\r\n        /**\r\n         * Execute a callback when the PIC is ready (ie. registered, loaded and rendererd)\r\n         * @param {Function} cb - the function to execute once ready\r\n         */\r\n        onReady : function onReady(cb){\r\n\r\n            this.readyStack.push(cb);\r\n\r\n            //if we are ready this will pop the stack\r\n            if(this.data('_ready') && this.data('pic')){\r\n                this.triggerReady();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Define the PIC as ready and consume the waiting functions in the stack.\r\n         */\r\n        triggerReady : function triggerReady(){\r\n            var self = this;\r\n            _.forEach(this.readyStack, function(cb){\r\n                cb.call(self, self.data('pic'));\r\n            });\r\n\r\n            //empty the stack\r\n            this.readyStack = [];\r\n\r\n            //mark the infoControl as ready\r\n            this.data('_ready', true);\r\n        }\r\n    });\r\n\r\n    //add portable element standard functions\r\n    CustomElement.augment(PortableInfoControl);\r\n    NamespacedElement.augment(PortableInfoControl);\r\n\r\n    return PortableInfoControl;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/model/PortableInfoControl',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiCreator/model/helper/portableElement',\r\n    'taoQtiItem/portableElementRegistry/icRegistry',\r\n    'taoQtiItem/qtiItem/core/PortableInfoControl'\r\n], function(_, editable, portableElement, icRegistry, PortableInfoControl){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, portableElement.getDefaultMethods(icRegistry));//@todo to be adapted with new icRegistry\r\n    _.extend(methods, {\r\n        getDefaultMarkupTemplateData : function(){\r\n            return {};\r\n        }\r\n    });\r\n\r\n    return PortableInfoControl.extend(methods);\r\n});\n","define('taoQtiItem/qtiItem/core/RubricBlock',['taoQtiItem/qtiItem/core/Element', 'taoQtiItem/qtiItem/mixin/Container'], function(Element, Container){\r\n\r\n    var RubricBlock = Element.extend({\r\n        qtiClass : 'rubricBlock',\r\n        isEmpty : function isEmpty(){\r\n            return !(this.bdy && this.bdy.body());\r\n        }\r\n    });\r\n    \r\n    Container.augment(RubricBlock);\r\n    \r\n    return RubricBlock;\r\n});\n","define('taoQtiItem/qtiCreator/model/RubricBlock',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/RubricBlock'\r\n], function(_, editable, RubricBlock){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    _.extend(methods, {\r\n        getDefaultAttributes : function(){\r\n            return {\r\n                'view' : ['candidate'],\r\n                'use' : ''\r\n            };\r\n        }\r\n    });\r\n    return RubricBlock.extend(methods);\r\n});\r\n\r\n\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiItem/mixin/ContainerTable',[\r\n    'taoQtiItem/qtiItem/mixin/Mixin',\r\n    'taoQtiItem/qtiItem/mixin/Container',\r\n    'lodash'\r\n], function(Mixin, Container, _){\r\n    'use strict';\r\n\r\n    var methods = {};\r\n    _.extend(methods, Container.methods);\r\n    _.extend(methods, {\r\n        initContainer:function(body){\r\n            Container.methods.initContainer.call(this, body);\r\n            this.bdy.contentModel = 'table';\r\n        }\r\n    });\r\n\r\n    return {\r\n        augment : function(targetClass){\r\n            Mixin.augment(targetClass, methods);\r\n        },\r\n        methods : methods\r\n    };\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiItem/core/Table',[\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiItem/mixin/ContainerTable'\r\n], function(Element, Container){\r\n    'use strict';\r\n\r\n    var Table = Element.extend({\r\n        qtiClass : 'table'\r\n    });\r\n\r\n    Container.augment(Table);\r\n\r\n    return Table;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/model/Table',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/model/mixin/editable',\r\n    'taoQtiItem/qtiItem/core/Table'\r\n], function(_, editable, Table){\r\n    \"use strict\";\r\n    var methods = {};\r\n    _.extend(methods, editable);\r\n    return Table.extend(methods);\r\n});\n","\r\n/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * This plugin add a \"plus\" button below each content block to add content more easily.\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/content/blockAdder',[\r\n    'lodash',\r\n    'core/plugin',\r\n    'taoQtiItem/qtiCreator/editor/blockAdder/blockAdder',\r\n    'taoQtiItem/qtiCreator/helper/qtiElements',\r\n    'taoQtiItem/portableElementRegistry/ciRegistry'\r\n], function(_, pluginFactory, blockAdder, qtiElements, ciRegistry){\r\n    'use strict';\r\n\r\n    /**\r\n     * Returns the configured plugin\r\n     * @returns {Function} the plugin\r\n     */\r\n    return pluginFactory({\r\n\r\n        name : 'blockAdder',\r\n\r\n        /**\r\n         * Hook to the host's init\r\n         */\r\n        init : function init(){\r\n\r\n            var interactions = qtiElements.getAvailableAuthoringElements() || {};\r\n\r\n            _.forIn(ciRegistry.getAllVersions(), function(versions, typeId){\r\n                var data = ciRegistry.getAuthoringData(typeId, {enabledOnly : true});\r\n                if(data && data.tags){\r\n                    interactions[data.qtiClass] = data;\r\n                }\r\n            });\r\n\r\n            this.interations = interactions;\r\n        },\r\n\r\n        /**\r\n         * Hook to the host's render\r\n         */\r\n        render : function render(){\r\n\r\n            //set up the block adder\r\n            blockAdder.create(\r\n                this.getHost().getItem(),\r\n                this.getAreaBroker().getItemPanelArea(),\r\n                this.interations\r\n            );\r\n        }\r\n    });\r\n});\r\n\n","\r\n/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * This plugin adds a \"back\" button that does a History.go(-1)\r\n * (like your browser's back button).\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/plugins/navigation/back',[\r\n    'jquery',\r\n    'i18n',\r\n    'core/plugin',\r\n    'ui/hider',\r\n    'layout/section',\r\n    'html5-history-api',\r\n    'tpl!taoQtiItem/qtiCreator/plugins/button'\r\n], function($, __, pluginFactory, hider, section, history, buttonTpl){\r\n    'use strict';\r\n\r\n    /**\r\n     * Returns the configured plugin\r\n     * @returns {Function} the plugin\r\n     */\r\n    return pluginFactory({\r\n\r\n        name : 'back',\r\n\r\n        /**\r\n         * Initialize the plugin (called during itemCreator's init)\r\n         * @fires {itemCreator#exit}\r\n         */\r\n        init : function init(){\r\n            var itemCreator = this.getHost();\r\n\r\n            itemCreator.on('exit', function(){\r\n                var itemSection = section.get('manage_items');\r\n\r\n                if(itemSection){\r\n                    itemSection.activate();\r\n                } else{\r\n                    history.back();\r\n                }\r\n            });\r\n\r\n            this.$element = $(buttonTpl({\r\n                icon: 'left',\r\n                title: __('Back to Manage Items'),\r\n                text : __('Manage Items'),\r\n                cssClass: 'back-action'\r\n            })).on('click', function backHandler(e){\r\n                e.preventDefault();\r\n                itemCreator.trigger('exit');\r\n            });\r\n            this.hide();\r\n        },\r\n\r\n        /**\r\n         * Called during the itemCreator's render phase\r\n         */\r\n        render : function render(){\r\n\r\n            //attach the element to the menu area\r\n            var $container = this.getAreaBroker().getMenuLeftArea();\r\n            $container.append(this.$element);\r\n            this.show();\r\n        },\r\n\r\n        /**\r\n         * Called during the itemCreator's destroy phase\r\n         */\r\n        destroy : function destroy (){\r\n            this.$element.remove();\r\n        },\r\n\r\n        /**\r\n         * Enable the button\r\n         */\r\n        enable : function enable (){\r\n            this.$element.removeProp('disabled')\r\n                         .removeClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Disable the button\r\n         */\r\n        disable : function disable (){\r\n            this.$element.prop('disabled', true)\r\n                         .addClass('disabled');\r\n        },\r\n\r\n        /**\r\n         * Show the button\r\n         */\r\n        show: function show(){\r\n            hider.show(this.$element);\r\n        },\r\n\r\n        /**\r\n         * Hide the button\r\n         */\r\n        hide: function hide(){\r\n            hider.hide(this.$element);\r\n        }\r\n    });\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/gap', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"qti-choice qti-gap\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" class=\\\"gapmatch-content\\\">&nbsp;</span>\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/choices/Gap',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/gap',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'gap',\r\n        getContainer : containerHelper.get,\r\n        template : tpl\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/Widget',['taoQtiItem/qtiCreator/widgets/Widget'], function(Widget){\r\n\r\n    var ChoiceWidget = Widget.clone();\r\n\r\n    ChoiceWidget.buildContainer = function(){\r\n        this.$container = this.$original;\r\n    };\r\n\r\n    ChoiceWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.interaction = this.element.getInteraction();\r\n        if(!this.interaction){\r\n            throw new Error('cannot find related interaction');\r\n        }\r\n\r\n        this.listenToInteractionStates();\r\n    };\r\n\r\n    ChoiceWidget.listenToInteractionStates = function(){\r\n\r\n        var _this = this;\r\n\r\n        //follow interaction state change\r\n        this.beforeStateInit(function(e, element, state){\r\n            \r\n            if(element.is('interaction')\r\n                && element.getSerial() === _this.interaction.getSerial()\r\n                && state.name !== _this.getCurrentState().name){\r\n                \r\n                switch(state.name){\r\n                    case 'answer':\r\n                    case 'sleep':\r\n                    case 'question':\r\n                        _this.changeState(state.name);\r\n                        break;\r\n                    case 'delete':\r\n                        _this.changeState('sleep');\r\n                        break;\r\n                }\r\n\r\n            }\r\n        });\r\n        \r\n        this.beforeStateExit(function(e, element, state){\r\n            if(element.is('interaction')\r\n                && element.getSerial() === _this.interaction.getSerial()\r\n                && state.name === 'choice'){\r\n                \r\n                _this.changeState('question');\r\n            }\r\n            \r\n        });\r\n    };\r\n\r\n    return ChoiceWidget;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/states/Answer',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    return stateFactory.create('answer', ['active'], function(){\r\n        throw new Error('state \"answer\" prototype init method must be implemented');\r\n    },function(){\r\n        throw new Error('state \"answer\" prototype exit method must be implemented');\r\n    });\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/states/Choice',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    'use strict';\r\n\r\n    return stateFactory.create('choice', ['question', 'active'], function(){\r\n        throw new Error('state \"choice\" prototype init method must be implemented');\r\n    },function(){\r\n        throw new Error('state \"choice\" prototype exit method must be implemented');\r\n    });\r\n});\n","define('taoQtiItem/qtiCreator/widgets/states/Correct',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    return stateFactory.create('correct', ['answer', 'active'], function(){\r\n        throw new Error('state \"correct\" prototype init method must be implemented');\r\n    },function(){\r\n        throw new Error('state \"correct\" prototype exit method must be implemented');\r\n    });\r\n});\n","define('taoQtiItem/qtiCreator/widgets/states/Map',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    return stateFactory.create('map', ['answer', 'active'], function(){\r\n        throw new Error('state \"map\" prototype init method must be implemented');\r\n    },function(){\r\n        throw new Error('state \"map\" prototype exit method must be implemented');\r\n    });\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * The NoRp state stands for \"no response processing\" state.\r\n * It is a sub-state of the state answer.\r\n * It defines the state of an interaction when it is in the response editing mode with response processing disabled\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/states/NoRp',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    'use strict';\r\n    return stateFactory.create('norp', ['answer', 'active'], function(){\r\n        throw new Error('state \"norp\" prototype init method must be implemented');\r\n    },function(){\r\n        throw new Error('state \"norp\" prototype exit method must be implemented');\r\n    });\r\n});\n","define('taoQtiItem/qtiCreator/widgets/states/Question',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    return stateFactory.create('question', ['active'], function(){\r\n        throw new Error('state \"question\" prototype init method must be implemented');\r\n    },function(){\r\n        throw new Error('state \"question\" prototype exit method must be implemented');\r\n    });\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/notifications/invalidInfoBox', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div class=\\\"feedback-warning popup\\\" data-widget-component=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"icon-warning\\\"></span>\\r\\n    \";\n  stack1 = (helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"There is an incomplete element in your item: please click on it to complete it.\", options) : helperMissing.call(depth0, \"__\", \"There is an incomplete element in your item: please click on it to complete it.\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/states/Invalid',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/notifications/invalidInfoBox'\r\n], function($, stateFactory, invalidInfoBoxTpl){\r\n\r\n    return stateFactory.create('invalid', ['sleep'], function(){\r\n\r\n        this.widget.$container.addClass('invalid');\r\n\r\n        this.$messageBox = $(invalidInfoBoxTpl({\r\n            serial : this.widget.serial\r\n        }));\r\n        $('.qti-item').append(this.$messageBox);\r\n\r\n    },function(){\r\n\r\n        this.widget.$container.removeClass('invalid');\r\n        this.$messageBox.remove();\r\n    });\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Active',\r\n    'taoQtiItem/qtiCreator/widgets/states/Answer',\r\n    'taoQtiItem/qtiCreator/widgets/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/states/Deleting',\r\n    'taoQtiItem/qtiCreator/widgets/states/Inactive',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/states/NoRp',\r\n    'taoQtiItem/qtiCreator/widgets/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/states/Invalid'\r\n], function(factory){\r\n    'use strict';\r\n    return factory.createBundle(arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/states/Sleep'], function(stateFactory, Sleep){\r\n    \r\n    var ChoiceStateSleep = stateFactory.create(Sleep, function(){\r\n        \r\n    }, function(){\r\n        \r\n    });\r\n    \r\n    return ChoiceStateSleep;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/states/Active',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/states/Active'], function(stateFactory, Active){\r\n    \r\n    var ChoiceStateActive = stateFactory.create(Active, function(){\r\n        \r\n    },function(){\r\n        \r\n    });\r\n\r\n    return ChoiceStateActive;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/simpleChoice.content', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"display:none;\";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"icon-pin\";\n  }\n\nfunction program7(depth0,data) {\n  \n  \n  return \"icon-shuffle\";\n  }\n\n  buffer += \"<div class=\\\"mini-tlb\\\" data-edit=\\\"question\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <div class=\\\"rgt tlb-button\\\" title=\\\"Delete\\\" data-role=\\\"delete\\\">\\r\\n        <span class=\\\"icon-bin\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"rgt tlb-button\\\" data-role=\\\"shuffle-pin\\\" title=\\\"Shuffle/Pin\\\" style=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.interactionShuffle), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n        <span class=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.fixed), {hash:{},inverse:self.program(7, program7, data),fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"rgt tlb-button\\\" data-role=\\\"cke-launcher\\\" title=\\\"Formatting options\\\">\\r\\n        <span class=\\\"icon-font\\\"></span>\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/choices/helpers/formElement',['jquery'], function($) {\r\n\r\n    var formElementHelper = {\r\n        initShufflePinToggle: function(widget) {\r\n\r\n            var $container = widget.$container,\r\n                choice = widget.element,\r\n                interaction = choice.getInteraction(),\r\n                $shuffleToggle = $container.find('[data-role=\"shuffle-pin\"]');\r\n\r\n            $shuffleToggle.off('mousedown').on('mousedown', function(e) {\r\n                e.stopPropagation();\r\n                var $icon = $(this).children();\r\n                if ($icon.length === 0) {\r\n                    $icon = $(this);\r\n                }\r\n                if ($icon.hasClass('icon-shuffle')) {\r\n                    $icon.removeClass('icon-shuffle').addClass('icon-pin');\r\n                    choice.attr('fixed', true);\r\n                } else {\r\n                    $icon.removeClass('icon-pin').addClass('icon-shuffle');\r\n                    choice.attr('fixed', false);\r\n                }\r\n            });\r\n\r\n            var _toggleVisibility = function(show) {\r\n                if (show) {\r\n                    $shuffleToggle.show();\r\n                } else {\r\n                    $shuffleToggle.hide();\r\n                }\r\n                $('.qti-item').trigger('toolbarchange', {\r\n                    callee: 'formElementHelper'\r\n                });\r\n            };\r\n\r\n            _toggleVisibility(interaction.attr('shuffle'));\r\n\r\n            //listen to interaction property change\r\n            widget.on('attributeChange', function(data) {\r\n                if (data.element.serial === interaction.serial && data.key === 'shuffle') {\r\n                    _toggleVisibility(data.value);\r\n                }\r\n            });\r\n        },\r\n        initDelete: function(widget) {\r\n\r\n            var $container = widget.$container;\r\n\r\n            $container.find('[data-role=\"delete\"]:not([data-html-editable] *)').on('mousedown', function(e) {\r\n                e.stopPropagation();\r\n                widget.changeState('deleting');\r\n            });\r\n        }\r\n    };\r\n\r\n    return formElementHelper;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/states/Question',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Question',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/simpleChoice.content',\r\n    'taoQtiItem/qtiCreator/widgets/choices/helpers/formElement'\r\n], function($, stateFactory, QuestionState, contentToolbarTpl, formElement){\r\n\r\n    var ChoiceStateQuestion = stateFactory.create(QuestionState, function(){\r\n\r\n        var _widget = this.widget;\r\n\r\n        //add some event listeners\r\n        _widget.$container.on('click.question', function(){\r\n            //show option form\r\n            _widget.changeState('choice');\r\n        }).on('mouseenter.question', function(){\r\n            //add listener to display proper hover style\r\n            $(this).addClass('hover');\r\n        }).on('mouseleave.question', function(){\r\n            $(this).removeClass('hover');\r\n        });\r\n\r\n        this.createToolbar().show();\r\n\r\n    }, function(){\r\n\r\n        //remove the question state toolbar properly\r\n        this.removeToolbar();\r\n\r\n        //!! very important, always unbind the event on exit!\r\n        this.widget.$container.off('.question');\r\n    });\r\n\r\n    ChoiceStateQuestion.prototype.createToolbar = function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = _widget.$container,\r\n            choice = _widget.element,\r\n            interaction,\r\n            $toolbar = $container.find('.mini-tlb').not('[data-html-editable] *');\r\n\r\n        if(!$toolbar.length){\r\n\r\n            interaction = choice.getInteraction();\r\n\r\n            //add mini toolbars\r\n            $toolbar = $(contentToolbarTpl({\r\n                choiceSerial : choice.getSerial(),\r\n                interactionSerial : interaction.getSerial(),\r\n                fixed : choice.attr('fixed'),\r\n                interactionShuffle : interaction.attr('shuffle')\r\n            }));\r\n\r\n            $container.append($toolbar);\r\n\r\n            //set toolbar button behaviour:\r\n            formElement.initShufflePinToggle(_widget);\r\n            formElement.initDelete(_widget);\r\n        }\r\n\r\n        return $toolbar;\r\n    };\r\n\r\n    ChoiceStateQuestion.prototype.removeToolbar = function(){\r\n\r\n        this.widget.$container.find('.mini-tlb[data-edit=question]').remove()\r\n    };\r\n\r\n    return ChoiceStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/states/Answer',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Answer'\r\n], function(stateFactory, Answer){\r\n\r\n    var ChoiceStateAnswer = stateFactory.create(Answer, function(){\r\n        \r\n    }, function(){\r\n        \r\n    });\r\n        \r\n    return ChoiceStateAnswer;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Active',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Answer'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Choice',\r\n    'taoQtiItem/qtiItem/core/Element'\r\n], function(stateFactory, Choice, Element){\r\n\r\n    var ChoiceStateChoice = stateFactory.create(Choice, function(){\r\n\r\n        var _widget = this.widget;\r\n\r\n        //focus on the selected choice\r\n\r\n        //listener to other siblings choice mode\r\n        _widget.beforeStateInit(function(e, element, state){\r\n            \r\n            if(Element.isA(element, 'choice') && _widget.interaction.getChoice(element.serial)){//@todo hottext an\r\n                \r\n                if(state.name === 'choice' && element.serial !== _widget.serial){\r\n                    _widget.changeState('question');\r\n                }else if(state.name === 'active'){\r\n                    _widget.changeState('question');\r\n                }\r\n                \r\n            }else if(element.is('img') || element.is('math') || element.is('object')){\r\n                \r\n                if(state.name === 'active'){\r\n                    _widget.changeState('question');\r\n                }\r\n                \r\n            }\r\n        }, 'otherActive');\r\n\r\n        //add options form\r\n        this.initForm();\r\n        this.widget.$form.show();\r\n\r\n    }, function(){\r\n\r\n        //destroy and hide the form\r\n        this.widget.$form.empty().hide();\r\n        \r\n        this.widget.offEvents('otherActive');\r\n    });\r\n\r\n    ChoiceStateChoice.prototype.initForm = function(){\r\n        stateFactory.throwMissingRequiredImplementationError('initForm');\r\n    };\r\n\r\n    return ChoiceStateChoice;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/choices/gap', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"identifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. my-choice_1\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"required\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.required), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"required\", options) : helperMissing.call(depth0, \"__\", \"required\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Define whether a choice must be selected by the candidate in order to form a valid response to the interaction.\", options) : helperMissing.call(depth0, \"__\", \"Define whether a choice must be selected by the candidate in order to form a valid response to the interaction.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shape position\", options) : helperMissing.call(depth0, \"__\", \"Shape position\", options)))\n    + \"</h3>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"x\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Left\", options) : helperMissing.call(depth0, \"__\", \"Left\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The left position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The left position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"x\\\" value=\\\"\";\n  if (helper = helpers.x) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.x); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"y\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Top\", options) : helperMissing.call(depth0, \"__\", \"Top\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The top position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The top position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"y\\\" value=\\\"\";\n  if (helper = helpers.y) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.y); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Width\", options) : helperMissing.call(depth0, \"__\", \"Width\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The shape width in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The shape width in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"height\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Height\", options) : helperMissing.call(depth0, \"__\", \"Height\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The shape height in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The shape height in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/helpers/identifier',['lodash'], function(_){\r\n\r\n    var _updateChoiceIdentifierInResponse = function(response, oldId, newId){\r\n        \r\n        var escapedOldId = oldId.replace(/([.-])/g, '\\\\$1'),//escape spec characters allowed in the standard and that is meaningful in regex\r\n            regex = new RegExp('([^\\\\s]*\\\\s+|^)(' + escapedOldId + ')(\\\\s+[^\\\\s]*|$)');//prepare the regex to watch the oldId to be replaced\r\n\r\n        for(var i in response.correctResponse){\r\n            response.correctResponse[i] = response.correctResponse[i].replace(regex, '$1'+newId+'$3');\r\n        }\r\n\r\n        var mapEntries = {};\r\n        _.forIn(response.mapEntries, function(value, mapKey){\r\n            mapKey = mapKey.replace(regex, '$1'+newId+'$3');\r\n            mapEntries[mapKey] = value;\r\n        });\r\n        response.mapEntries = mapEntries;\r\n    };\r\n\r\n    var _updateChoiceIdentifier = _.throttle(function(choice, newId, response){\r\n        \r\n        var oldId = choice.id();\r\n        if(oldId !== newId){\r\n            //need to update correct response and mapping values too !\r\n            _updateChoiceIdentifierInResponse(response, oldId, newId);\r\n\r\n            //finally, set the new identifier to the choice\r\n            choice.id(newId);\r\n\r\n            //update domi\r\n            var interaction = _get('interactionFromChoice', choice, function(){\r\n                return choice.getInteraction();\r\n            });\r\n                \r\n            //FIXME some choices may not have a renderer, so we catch the thrown exception silently\r\n            try{\r\n                var $choiceContainer = choice.getContainer(null, choice.qtiClass+'.'+interaction.qtiClass);\r\n                $choiceContainer.attr('data-identifier', choice.id());\r\n                $choiceContainer.find('input').val(choice.id());\r\n            } catch(ex){}\r\n\r\n        }\r\n    }, 500);\r\n\r\n\r\n    var _cache = [];\r\n\r\n    var _setCache = function(cache, element, value){\r\n        if(!_cache[cache]){\r\n            _cache[cache] = {};\r\n        }\r\n        _cache[cache][element.getSerial()] = value;\r\n    };\r\n\r\n    var _getCache = function(cache, element){\r\n        var serial = element.getSerial();\r\n        if(serial && _cache[cache] && _cache[cache][serial]){\r\n            return _cache[cache][serial];\r\n        }\r\n        return null;\r\n    };\r\n\r\n    var _get = function(cache, element, callback){\r\n        var ret = _getCache(cache, element);\r\n        if(!ret){\r\n            ret = callback.call(element);\r\n            _setCache(cache, element, ret);\r\n        }\r\n        return ret;\r\n    };\r\n\r\n    return {\r\n        updateChoiceIdentifier : function(choice, value){\r\n            \r\n            value = value.trim();\r\n            if(value){\r\n                var response = _get('responseFromChoice', choice, function(){\r\n                    var interaction = _get('interactionFromChoice', choice, function(){\r\n                        return choice.getInteraction();\r\n                    });\r\n                    return interaction.getResponseDeclaration();\r\n                });\r\n\r\n                _updateChoiceIdentifier(choice, value, response);\r\n            }\r\n        },\r\n        updateResponseIdentifier : function(response, value){\r\n            throw 'to be implemented';\r\n        }\r\n    };\r\n\r\n});\r\n\r\n\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/gap/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Choice',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/gap',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier',\r\n    'taoQtiItem/qtiItem/core/Element'\r\n], function(stateFactory, Choice, formTpl, formElement, identifierHelper, Element){\r\n\r\n    var GapStateChoice = stateFactory.extend(Choice, function(){\r\n        \r\n        var _widget = this.widget;\r\n        \r\n        //listener to changes of sibling choices' mode \r\n        _widget.beforeStateInit(function(e, element, state){\r\n            \r\n            if(Element.isA(element, 'gap') && _widget.interaction.getBody().getElement(element.serial)){\r\n                \r\n                if(state.name === 'choice' && element.serial !== _widget.serial){\r\n                    _widget.changeState('question');\r\n                }else if(state.name === 'active'){\r\n                    _widget.changeState('question');\r\n                }\r\n                \r\n            }\r\n        }, 'otherActive');\r\n        \r\n    }, function(){\r\n\r\n        //add remove the toolbar\r\n        this.widget.offEvents('otherActive');\r\n    });\r\n\r\n    GapStateChoice.prototype.initForm = function(){\r\n\r\n        var $form = this.widget.$form,\r\n            interaction = this.widget.element;\r\n\r\n        //build form:\r\n        $form.html(formTpl({\r\n            serial : interaction.getSerial(),\r\n            identifier : interaction.id(),\r\n            required : !!interaction.attr('required')\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        //init data validation and binding\r\n        formElement.setChangeCallbacks($form, interaction, {\r\n            identifier : identifierHelper.updateChoiceIdentifier,\r\n            required : formElement.getAttributeChangeCallback()\r\n        });\r\n    };\r\n\r\n    return GapStateChoice;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/gap', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"mini-tlb\\\" data-edit=\\\"\";\n  if (helper = helpers.state) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.state); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"rgt tlb-button\\\" title=\\\"Delete\\\" data-role=\\\"delete\\\">\\r\\n        <span class=\\\"icon-bin\\\"></span>\\r\\n    </span>\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/choices/gap/states/Question',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Question',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/gap',\r\n    'taoQtiItem/qtiCreator/widgets/choices/helpers/formElement'\r\n], function($, stateFactory, QuestionState, gapTpl, formElement){\r\n\r\n    var GapStateQuestion = stateFactory.extend(QuestionState);\r\n\r\n    GapStateQuestion.prototype.createToolbar = function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = _widget.$container,\r\n            gap = _widget.element,\r\n            $toolbar = $container.find('.mini-tlb').not('[data-html-editable] *');\r\n\r\n        if(!$toolbar.length){\r\n\r\n            //add mini toolbars\r\n            $toolbar = $(gapTpl({\r\n                serial : gap.getSerial(),\r\n                state : 'question'\r\n            }));\r\n\r\n            $container.append($toolbar);\r\n\r\n            formElement.initDelete(_widget);\r\n        }\r\n\r\n        return $toolbar;\r\n    };\r\n\r\n    return GapStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/gap/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/choices/gap/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/choices/gap/states/Question'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/gap/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/choices/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/choices/gap/states/states'\r\n], function(Widget, states){\r\n\r\n    var GapWidget = Widget.clone();\r\n\r\n    GapWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.registerStates(states);\r\n        \r\n    };\r\n    \r\n    GapWidget.buildContainer = function(){\r\n        this.$container = this.$original.addClass('widget-box');\r\n        this.$container.attr('contenteditable', false);\r\n    };\r\n    \r\n    return GapWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/choices/Gap',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/choices/Gap',\r\n    'taoQtiItem/qtiCreator/widgets/choices/gap/Widget'\r\n], function(_, Gap, GapWidget){\r\n    'use strict';\r\n\r\n    var CreatorGap = _.clone(Gap);\r\n\r\n    CreatorGap.render = function(choice, options){\r\n\r\n        GapWidget.build(\r\n            choice,\r\n            Gap.getContainer(choice),\r\n            this.getOption('choiceOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorGap;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/choice', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<li class=\\\"qti-choice\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</li>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/choices/GapText',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/choice',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'gapText',\r\n        getContainer : containerHelper.get,\r\n        template : tpl\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/choices/simpleAssociableChoice', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"identifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. my-choice_1\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <h3 class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed number of uses\", options) : helperMissing.call(depth0, \"__\", \"Allowed number of uses\", options)))\n    + \"\\r\\n    </h3>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices this choice may be associated with. If matchMax is 0 there is no restriction.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices this choice may be associated with. If matchMax is 0 there is no restriction.\", options)))\n    + \"\\r\\n    </span>\\r\\n\\r\\n    <!--not supported yet-->\\r\\n    <div style=\\\"display:none;\\\">\\r\\n        <label for=\\\"matchMin\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Min\", options) : helperMissing.call(depth0, \"__\", \"Min\", options)))\n    + \"</label>\\r\\n        <input name=\\\"matchMin\\\" value=\\\"\";\n  if (helper = helpers.matchMin) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.matchMin); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"100\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n\\r\\n    <div>\\r\\n        <label for=\\\"matchMax\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max\", options) : helperMissing.call(depth0, \"__\", \"Max\", options)))\n    + \"</label>\\r\\n        <input name=\\\"matchMax\\\" value=\\\"\";\n  if (helper = helpers.matchMax) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.matchMax); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"100\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Choice',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/simpleAssociableChoice',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content'\r\n], function(stateFactory, Choice, formTpl, formElement, identifierHelper, htmlEditor, contentHelper){\r\n\r\n    var SimpleAssociableChoiceStateChoice = stateFactory.extend(Choice, function(){\r\n        \r\n        this.buildEditor();\r\n        \r\n    }, function(){\r\n        \r\n        this.destroyEditor();\r\n    });\r\n    \r\n    SimpleAssociableChoiceStateChoice.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            choice = _widget.element;\r\n\r\n        //build form:\r\n        $form.html(formTpl({\r\n            serial : choice.getSerial(),\r\n            identifier : choice.id(),\r\n            matchMin : choice.attr('matchMin'),\r\n            matchMax : choice.attr('matchMax')\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        //init data validation and binding\r\n        var callbacks = formElement.getMinMaxAttributeCallbacks(this.widget.$form, 'matchMin', 'matchMax');\r\n        callbacks.identifier = identifierHelper.updateChoiceIdentifier;\r\n        formElement.setChangeCallbacks($form, choice, callbacks);\r\n    };\r\n    \r\n    SimpleAssociableChoiceStateChoice.prototype.buildEditor = function(){\r\n        \r\n        var _widget = this.widget,\r\n            container = _widget.element.getBody(),\r\n            $editableContainer = _widget.$container;\r\n\r\n        //@todo set them in the tpl\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n            \r\n            htmlEditor.buildEditor($editableContainer, {\r\n                change : contentHelper.getChangeCallback(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _widget\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    SimpleAssociableChoiceStateChoice.prototype.destroyEditor = function(){\r\n        \r\n        //search and destroy the editor\r\n        htmlEditor.destroyEditor(this.widget.$container);\r\n    };\r\n    \r\n    return SimpleAssociableChoiceStateChoice;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/gapText/states/Choice',[\r\n    'jquery',\r\n    'lodash',\r\n    'ckeditor',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/states/Choice',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content'\r\n], function($, _, CKEditor, stateFactory, Choice, SimpleAssociableChoice, Element, htmlEditor, contentHelper){\r\n    'use strict';\r\n\r\n    var GapTextStateChoice = stateFactory.extend(Choice, function(){\r\n\r\n        var _widget = this.widget;\r\n\r\n        //listener to other siblings choice mode\r\n        _widget.beforeStateInit(function(e, element, state){\r\n\r\n            if(Element.isA(element, 'choice') && _widget.interaction.getBody().getElement(element.serial)){//@todo hottext an\r\n\r\n                if(state.name === 'choice' && element.serial !== _widget.serial){\r\n                    _widget.changeState('question');\r\n                }\r\n\r\n            }\r\n\r\n        }, 'otherActive');\r\n\r\n        this.buildEditor();\r\n\r\n    }, function(){\r\n\r\n        this.destroyEditor();\r\n\r\n        this.widget.offEvents('otherActive');\r\n    });\r\n\r\n    GapTextStateChoice.prototype.initForm = function(){\r\n        SimpleAssociableChoice.prototype.initForm.call(this);\r\n    };\r\n\r\n    GapTextStateChoice.prototype.buildEditor = function(){\r\n\r\n        var _widget = this.widget,\r\n            container = _widget.element.getBody(),\r\n            $editableContainer = _widget.$container;\r\n\r\n        //@todo set them in the tpl\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                change : contentHelper.getChangeCallback(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _widget\r\n                },\r\n                hideTriggerOnBlur: true,\r\n                toolbar: [{\r\n                    name : 'basicstyles',\r\n                    items : ['Bold', 'Italic', 'Subscript', 'Superscript']\r\n                }, {\r\n                    name : 'insert',\r\n                    items : ['SpecialChar']\r\n                }],\r\n                qtiMedia: false,\r\n                qtiInclude: false,\r\n                enterMode : CKEditor.ENTER_BR\r\n            });\r\n        }\r\n\r\n        $editableContainer.on('keypress.qti-widget', function(e){\r\n            if(e.which === 13){\r\n                e.preventDefault();\r\n                $(this).blur();\r\n            }\r\n\r\n        });\r\n    };\r\n\r\n    GapTextStateChoice.prototype.destroyEditor = function(){\r\n        var _widget = this.widget,\r\n            interaction = _widget.interaction,\r\n            $editableContainer = _widget.$container,\r\n            $editable = $editableContainer.find('[data-html-editable]'),\r\n            placeholder;\r\n\r\n        /**\r\n         * Workaround for ckEditor. When adding text to an empty choice, when initialising the widget on an empty content,\r\n         * ck automatically wraps it in a <p>, which breaks QTI compatibility.\r\n         * Therefore, we replace an empty choice with a placeholder text.\r\n         */\r\n        if (! htmlEditor.getData($editable) || htmlEditor.getData($editable) === '') {\r\n            placeholder = interaction.getNextPlaceholder();\r\n            htmlEditor.setData($editable, placeholder);\r\n        }\r\n\r\n        $editableContainer.off('.qti-widget');\r\n\r\n        //search and destroy the editor\r\n        htmlEditor.destroyEditor(this.widget.$container);\r\n    };\r\n\r\n    return GapTextStateChoice;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/gapText/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/choices/gapText/states/Choice'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/gapText/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/choices/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/choices/gapText/states/states'\r\n], function(Widget, states){\r\n\r\n    var GapTextWidget = Widget.clone();\r\n\r\n    GapTextWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.registerStates(states);\r\n        \r\n    };\r\n\r\n    return GapTextWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/choices/GapText',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/choices/GapText',\r\n    'taoQtiItem/qtiCreator/widgets/choices/gapText/Widget'\r\n], function(_, GapText, GapTextWidget){\r\n    'use strict';\r\n\r\n    var CreatorGapText = _.clone(GapText);\r\n\r\n    CreatorGapText.render = function(choice, options){\r\n\r\n        GapTextWidget.build(\r\n            choice,\r\n            GapText.getContainer(choice),\r\n            this.getOption('choiceOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorGapText;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/hottext', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"qti-choice qti-hottext hottext\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <label class=\\\"hottext-checkmark\\\">\\r\\n        <input type=\\\"checkbox\\\" value=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n        <span class=\\\"icon-checkbox small\\\"></span>\\r\\n    </label>\\r\\n    <span class=\\\"hottext-content\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</span>\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/choices/Hottext',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/hottext',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'hottext',\r\n        getContainer : containerHelper.get,\r\n        template : tpl\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/choices/choice', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"identifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. my-choice_1\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/choices/simpleChoice/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Choice',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/choice',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content'\r\n], function(stateFactory, Choice, formTpl, formElement, identifierHelper, htmlEditor, contentHelper){\r\n\r\n    var SimpleChoiceStateChoice = stateFactory.extend(Choice, function(){\r\n        \r\n        this.buildEditor();\r\n        \r\n    }, function(){\r\n        \r\n        this.destroyEditor();\r\n    });\r\n\r\n    SimpleChoiceStateChoice.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget;\r\n\r\n        //build form:\r\n        _widget.$form.html(formTpl({\r\n            serial : _widget.element.getSerial(),\r\n            identifier : _widget.element.id()\r\n        }));\r\n\r\n        formElement.initWidget(_widget.$form);\r\n\r\n        //init data validation and binding\r\n        formElement.setChangeCallbacks(_widget.$form, _widget.element, {\r\n            identifier : identifierHelper.updateChoiceIdentifier\r\n        });\r\n    };\r\n    \r\n    SimpleChoiceStateChoice.prototype.buildEditor = function(){\r\n\r\n        var _widget = this.widget,\r\n            container = _widget.element.getBody(),\r\n            $editableContainer = _widget.$container;\r\n\r\n        //@todo set them in the tpl\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n            \r\n            htmlEditor.buildEditor($editableContainer, {\r\n                change : contentHelper.getChangeCallback(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _widget\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    SimpleChoiceStateChoice.prototype.destroyEditor = function(){\r\n        \r\n        //search and destroy the editor\r\n        htmlEditor.destroyEditor(this.widget.$container);\r\n    };\r\n\r\n    return SimpleChoiceStateChoice;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/hottext/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleChoice/states/Choice'\r\n], function(stateFactory, Choice, SimpleChoice){\r\n\r\n    var HottextStateChoice = stateFactory.extend(Choice);\r\n\r\n    HottextStateChoice.prototype.initForm = function(){\r\n        SimpleChoice.prototype.initForm.call(this);\r\n    };\r\n\r\n    return HottextStateChoice;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/hottext', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"mini-tlb\\\" data-edit=\\\"\";\n  if (helper = helpers.state) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.state); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"tlb-button\\\" title=\\\"Restore\\\" data-role=\\\"restore\\\">\\r\\n        <span class=\\\"icon-undo\\\" data-role=\\\"restore\\\"></span>\\r\\n    </span>\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/choices/hottext/states/Question',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Question',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/hottext'\r\n], function(_, $, stateFactory, QuestionState, gapTpl){\r\n    'use strict';\r\n\r\n    var HottextStateQuestion = stateFactory.extend(QuestionState);\r\n\r\n    HottextStateQuestion.prototype.createToolbar = function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = _widget.$container,\r\n            hottext = _widget.element,\r\n            $toolbar = $container.find('.mini-tlb').not('[data-html-editable] *');\r\n\r\n        if(!$toolbar.length){\r\n\r\n            //add mini toolbars\r\n            $toolbar = $(gapTpl({\r\n                serial : hottext.getSerial(),\r\n                state : 'question'\r\n            }));\r\n\r\n            $container.append($toolbar);\r\n\r\n            //init delete:\r\n            $toolbar.find('[data-role=restore]').on('mousedown.question', function(){\r\n\r\n                var inlineStaticElements = hottext.getElements(),\r\n                    parent = hottext.parent(),\r\n                    newBody = parent.body().replace(hottext.placeholder(), hottext.body());\r\n\r\n                //prepare the replacement of the hottext html rendering by prerendering inner element\r\n                var hottextHtmlReplacement = _.reduce(inlineStaticElements, function(hottextBody, elt){\r\n                    //move all inner element of the hottext to its parent\r\n                    parent.setElement(elt);\r\n                    hottext.removeElement(elt);\r\n\r\n                    //prerender inner element to html\r\n                    return hottextBody.replace(elt.placeholder(), elt.render());\r\n                }, hottext.body());\r\n\r\n                //properly destroy the old hottext and its widget\r\n                _widget.destroy();\r\n                hottext.remove();\r\n\r\n                //set the new body into the model of the parent\r\n                parent.body(newBody);\r\n\r\n                //render static elements\r\n                $container.replaceWith(hottextHtmlReplacement);\r\n                _.each(inlineStaticElements, function(elt){\r\n                    elt.postRender();\r\n                });\r\n            });\r\n        }\r\n\r\n        return $toolbar;\r\n    };\r\n\r\n    return HottextStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/hottext/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/choices/hottext/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/choices/hottext/states/Question'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/hottext/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/choices/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/choices/hottext/states/states'\r\n], function(Widget, states){\r\n\r\n    var HottextWidget = Widget.clone();\r\n\r\n    HottextWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.registerStates(states);\r\n        \r\n    };\r\n    \r\n    HottextWidget.buildContainer = function(){\r\n        this.$container = this.$original.addClass('widget-box');\r\n        this.$container.attr('contenteditable', false);\r\n        this.$original.find('.hottext-checkmark > input').prop('disabled', 'disabled');\r\n    };\r\n    \r\n    return HottextWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/choices/Hottext',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/choices/Hottext',\r\n    'taoQtiItem/qtiCreator/widgets/choices/hottext/Widget'\r\n], function(_, Hottext, HottextWidget){\r\n    'use strict';\r\n\r\n    var CreatorHottext = _.clone(Hottext);\r\n\r\n    CreatorHottext.render = function(choice, options){\r\n\r\n        HottextWidget.build(\r\n            choice,\r\n            Hottext.getContainer(choice),\r\n            this.getOption('choiceOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorHottext;\r\n});\r\n\n","//not used\r\n;\ndefine(\"taoQtiItem/qtiCreator/renderers/choices/InlineChoice\", function(){});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/choice',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'simpleAssociableChoice.associateInteraction',\r\n        getContainer : containerHelper.get,\r\n        template : tpl\r\n    };\r\n});\r\n\n"," define('taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/states/Question',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Question',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/simpleChoice.content',\r\n    'taoQtiItem/qtiCreator/widgets/choices/helpers/formElement'\r\n], function($, stateFactory, QuestionState, contentToolbarTpl, formElement){\r\n\r\n    var SimpleAssociableChoiceStateQuestion = stateFactory.extend(QuestionState, function(){\r\n\r\n    }, function(){\r\n\r\n    });\r\n\r\n    SimpleAssociableChoiceStateQuestion.prototype.createToolbar = function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = _widget.$container,\r\n            choice = _widget.element,\r\n            interaction,\r\n            $toolbar = $container.find('.mini-tlb').not('[data-html-editable] *');\r\n\r\n        if(!$toolbar.length){\r\n\r\n            interaction = choice.getInteraction();\r\n\r\n            //add mini toolbars\r\n            $toolbar = $(contentToolbarTpl({\r\n                choiceSerial : choice.getSerial(),\r\n                interactionSerial : interaction.getSerial(),\r\n                fixed : choice.attr('fixed'),\r\n                interactionShuffle : interaction.attr('shuffle')\r\n            }));\r\n\r\n            $container.children('.inner-wrapper').append($toolbar);\r\n\r\n            //set toolbar button behaviour:\r\n            formElement.initShufflePinToggle(_widget);\r\n            formElement.initDelete(_widget);\r\n        }\r\n\r\n        return $toolbar;\r\n    };\r\n\r\n    return SimpleAssociableChoiceStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/states/Choice'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/choices/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/states/states'\r\n], function($, Widget, states){\r\n\r\n    var SimpleAssociableChoiceWidget = Widget.clone();\r\n\r\n    SimpleAssociableChoiceWidget.initCreator = function(){\r\n\r\n        this.registerStates(states);\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        //matchInteraction:\r\n        //need to wrap the container + tlb around a div because in mathInteraction, tlb cannot be position absolutely in <th>\r\n        this.$container.wrapInner($('<div>', {'class' : 'inner-wrapper'}));\r\n\r\n        //prevent checkbox from being selectable\r\n        this.$container.closest('table.matrix').find('input[type=checkbox]:enabled').prop('disabled', 'disabled');\r\n    };\r\n\r\n    return SimpleAssociableChoiceWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/choices/SimpleAssociableChoice.AssociateInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.AssociateInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/Widget'\r\n], function(_, SimpleAssociableChoice, SimpleChoiceWidget){\r\n    'use strict';\r\n\r\n    var CreatorSimpleChoice = _.clone(SimpleAssociableChoice);\r\n\r\n    CreatorSimpleChoice.render = function(choice, options){\r\n\r\n        SimpleChoiceWidget.build(\r\n            choice,\r\n            SimpleAssociableChoice.getContainer(choice),\r\n            this.getOption('choiceOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorSimpleChoice;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/simpleAssociableChoice.matchInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<th class=\\\"qti-choice qti-associableChoice qti-simpleAssociableChoice\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</th>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/simpleAssociableChoice.matchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n    return {\r\n        qtiClass : 'simpleAssociableChoice.matchInteraction',\r\n        getContainer : containerHelper.get,\r\n        template : tpl\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/choices/SimpleAssociableChoice.MatchInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleAssociableChoice.MatchInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleAssociableChoice/Widget'\r\n], function(_, SimpleAssociableChoice, SimpleAssociableChoiceWidget){\r\n    'use strict';\r\n\r\n    var CreatorSimpleAssociableChoice = _.clone(SimpleAssociableChoice);\r\n\r\n    CreatorSimpleAssociableChoice.render = function(choice, options){\r\n\r\n        SimpleAssociableChoiceWidget.build(\r\n            choice,\r\n            SimpleAssociableChoice.getContainer(choice),\r\n            this.getOption('choiceOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorSimpleAssociableChoice;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/simpleChoice.choiceInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            <input type=\\\"radio\\\" name=\\\"response-\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.interaction)),stack1 == null || stack1 === false ? stack1 : stack1.serial)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" value=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"1\\\">\\r\\n            <span class=\\\"icon-radio\\\"></span>\\r\\n            \";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            <input type=\\\"checkbox\\\" name=\\\"response-\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.interaction)),stack1 == null || stack1 === false ? stack1 : stack1.serial)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" value=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"1\\\">\\r\\n            <span class=\\\"icon-checkbox\\\"></span>\\r\\n            \";\n  return buffer;\n  }\n\n  buffer += \"<li class=\\\"qti-choice qti-simpleChoice\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <div class=\\\"pseudo-label-box\\\">\\r\\n        <label class=\\\"real-label\\\">\\r\\n            \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.unique), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </label>\\r\\n        <div class=\\\"label-box\\\">\\r\\n            <div class=\\\"label-content clear\\\" contenteditable=\\\"false\\\">\\r\\n                \";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                <svg class=\\\"overlay-answer-eliminator\\\">\\r\\n                    <line x1=\\\"0\\\" y1=\\\"100%\\\" x2=\\\"100%\\\" y2=\\\"0\\\"/>\\r\\n                    <line x1=\\\"0\\\" y1=\\\"0\\\" x2=\\\"100%\\\" y2=\\\"100%\\\"/>\\r\\n                </svg>\\r\\n            </div>\\r\\n        </div>\\r\\n    </div>\\r\\n    <label data-eliminable=\\\"container\\\" data-label=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Eliminate\", options) : helperMissing.call(depth0, \"__\", \"Eliminate\", options)))\n    + \"\\\">\\r\\n        <span data-eliminable=\\\"trigger\\\" class=\\\"icon-checkbox\\\"></span>\\r\\n    </label>\\r\\n</li>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction',[\r\n   'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/simpleChoice.choiceInteraction',\r\n   'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'simpleChoice.choiceInteraction',\r\n        getContainer : containerHelper.get,\r\n        getData:function(choice, data){\r\n            data.unique = (parseInt(data.interaction.attributes.maxChoices) === 1);\r\n            return data;\r\n        },\r\n        template : tpl\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/simpleChoice/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleChoice/states/Choice'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/simpleChoice/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/choices/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleChoice/states/states'\r\n], function(Widget, states){\r\n\r\n    var SimpleChoiceWidget = Widget.clone();\r\n\r\n    SimpleChoiceWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.registerStates(states);\r\n\r\n        //choiceInteraction:\r\n        //prevent checkbox/radio from being selectable\r\n        var $realLabel = this.$container.find('.real-label');\r\n        $realLabel.children('input').attr('disabled', 'disabled');\r\n    };\r\n\r\n    return SimpleChoiceWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/choices/SimpleChoice.ChoiceInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.ChoiceInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleChoice/Widget'\r\n], function(_, SimpleChoice, SimpleChoiceWidget){\r\n    'use strict';\r\n\r\n    var CreatorSimpleChoice = _.clone(SimpleChoice);\r\n\r\n    CreatorSimpleChoice.render = function(choice, options){\r\n        SimpleChoiceWidget.build(\r\n            choice,\r\n            SimpleChoice.getContainer(choice),\r\n            this.getOption('choiceOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorSimpleChoice;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/choice',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'simpleChoice.orderInteraction',\r\n        getContainer : containerHelper.get,\r\n        template : tpl\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/choices/SimpleChoice.OrderInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/choices/SimpleChoice.OrderInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/choices/simpleChoice/Widget'\r\n], function(_, SimpleChoice, SimpleChoiceWidget){\r\n    'use strict';\r\n\r\n    var CreatorSimpleChoice = _.clone(SimpleChoice);\r\n\r\n    CreatorSimpleChoice.render = function(choice, options){\r\n\r\n        SimpleChoiceWidget.build(\r\n            choice,\r\n            SimpleChoice.getContainer(choice),\r\n            this.getOption('choiceOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorSimpleChoice;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/container', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, helper, options, functionType=\"function\", self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<div data-html-editable=\\\"true\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\n  stack1 = (helper = helpers.equal || (depth0 && depth0.equal),options={hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data},helper ? helper.call(depth0, (depth0 && depth0.contentModel), \"blockStatic\", options) : helperMissing.call(depth0, \"equal\", (depth0 && depth0.contentModel), \"blockStatic\", options));\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/Container',['tpl!taoQtiItem/qtiCreator/tpl/container'], function(tpl){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : '_container',\r\n        template : tpl\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/img', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"class=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"height=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.height)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"width=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.width)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \";\n  return buffer;\n  }\n\n  buffer += \"<img \\r\\n    data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n    data-qti-class=\\\"img\\\" \\r\\n    src=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.src)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \\r\\n    alt=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.alt)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.height), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.width), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    />\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Img',[\r\n    'core/promise',\r\n    'ui/waitForMedia',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/img',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(Promise, waitForMedia, tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'img',\r\n        template : tpl,\r\n        getContainer : containerHelper.get,\r\n        render : function render (img, data){\r\n            return new Promise(function(resolve, reject){\r\n                containerHelper.get(img).waitForMedia(resolve);\r\n            });\r\n        }\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/img/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/static/states/Sleep'], function(stateFactory, SleepState){\r\n    \r\n    var ImgStateSleep = stateFactory.extend(SleepState, function(){}, function(){});\r\n    \r\n    return ImgStateSleep;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/img', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"src\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the image.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the image.\", options)))\n    + \"</div>\\r\\n    <input type=\\\"text\\\" name=\\\"src\\\" value=\\\"\";\n  if (helper = helpers.src) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.src); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n    <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select image\", options) : helperMissing.call(depth0, \"__\", \"Select image\", options)))\n    + \"</button>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"alt\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Alt Text\", options) : helperMissing.call(depth0, \"__\", \"Alt Text\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The text to be displayed if the image is not available.\", options) : helperMissing.call(depth0, \"__\", \"The text to be displayed if the image is not available.\", options)))\n    + \"</div>\\r\\n    <input type=\\\"text\\\" name=\\\"alt\\\" value=\\\"\";\n  if (helper = helpers.alt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.alt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" placeholder=\\\"e.g. House with a garden\\\"/>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"change-alt-modal-feedback modal\\\">\\r\\n    <div class=\\\"modal-body clearfix\\\">\\r\\n        <p>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Would you like to replace the alt text\", options) : helperMissing.call(depth0, \"__\", \"Would you like to replace the alt text\", options)))\n    + \"</p>\\r\\n        <p class=\\\"alt-text\\\"></p>\\r\\n\\r\\n        <div class=\\\"rgt\\\">\\r\\n            <button class=\\\"btn-regular small cancel\\\" type=\\\"button\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"No\", options) : helperMissing.call(depth0, \"__\", \"No\", options)))\n    + \"</button>\\r\\n            <button class=\\\"btn-info small save\\\" type=\\\"button\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Yes\", options) : helperMissing.call(depth0, \"__\", \"Yes\", options)))\n    + \"</button>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\\r\\n<div data-role=\\\"advanced\\\" style=\\\"display:none\\\">\\r\\n    \\r\\n    <hr/>\\r\\n    \\r\\n<!--    <div class=\\\"panel\\\">\\r\\n        <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Size and position\", options) : helperMissing.call(depth0, \"__\", \"Size and position\", options)))\n    + \"</h3>\\r\\n\\r\\n        <p class=\\\"img-resizer-slider\\\"></p>\\r\\n\\r\\n        <label for=\\\"height\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Height\", options) : helperMissing.call(depth0, \"__\", \"Height\", options)))\n    + \"</label>\\r\\n        <span id=\\\"item-editor-font-size-manual-input\\\" class=\\\"item-editor-unit-input-box\\\">\\r\\n            <input type=\\\"text\\\" name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty;\\\"/>\\r\\n            <span class=\\\"unit-indicator\\\">px</span>\\r\\n        </span>\\r\\n    </div>\\r\\n    <div class=\\\"panel\\\">\\r\\n\\r\\n        <label for=\\\"width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Width\", options) : helperMissing.call(depth0, \"__\", \"Width\", options)))\n    + \"</label>\\r\\n        <span id=\\\"item-editor-font-size-manual-input\\\" class=\\\"item-editor-unit-input-box\\\">\\r\\n            <input type=\\\"text\\\" name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty;\\\"/>\\r\\n            <span class=\\\"unit-indicator\\\">px</span>\\r\\n        </span>\\r\\n    </div>\\r\\n    <div class=\\\"panel\\\">\\r\\n\\r\\n        <label for=\\\"align\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Alignment\", options) : helperMissing.call(depth0, \"__\", \"Alignment\", options)))\n    + \"</label>\\r\\n        <select name=\\\"align\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n            <option value=\\\"default\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"default\", options) : helperMissing.call(depth0, \"__\", \"default\", options)))\n    + \"</option>\\r\\n            <option value=\\\"left\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"left\", options) : helperMissing.call(depth0, \"__\", \"left\", options)))\n    + \"</option>\\r\\n            <option value=\\\"right\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"right\", options) : helperMissing.call(depth0, \"__\", \"right\", options)))\n    + \"</option>\\r\\n        </select>\\r\\n    </div>-->\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Size and position\", options) : helperMissing.call(depth0, \"__\", \"Size and position\", options)))\n    + \"</h3>\\r\\n    <div class=\\\"panel img-resizer\\\"></div>\\r\\n    \\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/static/helpers/inline',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/helper/dummyElement',\r\n    'core/validator/validators'\r\n], function(_, dummyElement, validators){\r\n\r\n    var _qtiClassToDummies = {\r\n        math : 'maths',\r\n        img : 'image',\r\n        object : 'media'\r\n    };\r\n\r\n    //only valid for a state\r\n    var inlineHelper = {\r\n        checkFileExists : function(widget, fileSrcAttrName, baseUrl){\r\n\r\n            var element = widget.element;\r\n\r\n            validators.validators.fileExists.validate(\r\n                element.attr(fileSrcAttrName),\r\n                function(fileExists){\r\n                    if(!fileExists){\r\n                        //clear value:\r\n                        element.attr(fileSrcAttrName, '');\r\n                        inlineHelper.togglePlaceholder(widget);\r\n                    }\r\n                },\r\n                {\r\n                    baseUrl : baseUrl || ''\r\n                });\r\n\r\n        },\r\n        togglePlaceholder : function(widget, opts){\r\n\r\n            var options = _.defaults(opts || {}, {\r\n                container : widget.$original,\r\n                type : widget.element.qtiClass\r\n            });\r\n\r\n            var $container = options.container;\r\n            var $placeholder = $container.siblings('.dummy-element');\r\n            \r\n            if(widget.element.isEmpty()){\r\n\r\n                $container.hide();\r\n\r\n                var type = _qtiClassToDummies[options.type] || options.type;\r\n                if(!$placeholder.length){\r\n                    $placeholder = dummyElement.get(type);\r\n                    $container.after($placeholder);\r\n                }\r\n                $placeholder.show();\r\n\r\n            }else{\r\n                \r\n                $container.show();\r\n                $placeholder.hide();\r\n            }\r\n\r\n            widget.$container.trigger('contentChange.qti-widget');\r\n        },\r\n        positionFloat : function(widget, position){\r\n\r\n            var $container = widget.$container,\r\n                elt = widget.element;\r\n\r\n            //remove class\r\n            $container.removeClass('rgt lft');\r\n\r\n            elt.removeClass('rgt');\r\n            elt.removeClass('lft');\r\n            switch(position){\r\n                case 'right':\r\n                    $container.addClass('rgt');\r\n                    elt.addClass('rgt');\r\n                    break;\r\n                case 'left':\r\n                    $container.addClass('lft');\r\n                    elt.addClass('lft');\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n\r\n    return inlineHelper;\r\n});\r\n\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/img/states/Active',[\r\n    'jquery',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/img',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/inline',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'lodash',\r\n    'util/image',\r\n    'ui/mediasizer',\r\n    'ui/resourcemgr',\r\n    'nouislider',\r\n    'ui/tooltip'\r\n], function($, __, stateFactory, Active, formTpl, formElement, inlineHelper, itemUtil, _, imageUtil){\r\n    'use strict';\r\n\r\n    var ImgStateActive = stateFactory.extend(Active, function(){\r\n\r\n        this.initForm();\r\n\r\n    }, function(){\r\n\r\n        this.widget.$form.empty();\r\n    });\r\n\r\n    /**\r\n     * Extract a default label from a file/path name\r\n     * @param {String} fileName - the file/path\r\n     * @returns {String} a label\r\n     */\r\n    var _extractLabel = function extractLabel(fileName){\r\n        return fileName\r\n            .replace(/\\.[^.]+$/, '')\r\n            .replace(/^(.*)\\//, '')\r\n            .replace(/\\W/, ' ')\r\n            .substr(0, 255);\r\n    };\r\n\r\n    ImgStateActive.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $img = _widget.$original,\r\n            $form = _widget.$form,\r\n            img = _widget.element,\r\n            baseUrl = _widget.options.baseUrl,\r\n            responsive = true;\r\n\r\n        $form.html(formTpl({\r\n            baseUrl : baseUrl || '',\r\n            src : img.attr('src'),\r\n            alt : img.attr('alt'),\r\n            height : img.attr('height'),\r\n            width : img.attr('width'),\r\n            responsive : responsive\r\n        }));\r\n\r\n        //init slider and set align value before ...\r\n        _initAdvanced(_widget);\r\n        _initMediaSizer(_widget);\r\n        _initAlign(_widget);\r\n        _initUpload(_widget);\r\n\r\n        //... init standard ui widget\r\n        formElement.initWidget($form);\r\n\r\n        //init data change callbacks\r\n        formElement.setChangeCallbacks($form, img, {\r\n            src : _.throttle(function(img, value){\r\n\r\n                img.attr('src', value);\r\n                $img.attr('src', _widget.getAssetManager().resolve(value));\r\n                $img.trigger('contentChange.qti-widget').change();\r\n\r\n                inlineHelper.togglePlaceholder(_widget);\r\n\r\n                _initAdvanced(_widget);\r\n                _initMediaSizer(_widget);\r\n            }, 1000),\r\n            alt : function(img, value){\r\n                img.attr('alt', value);\r\n            },\r\n            longdesc : formElement.getAttributeChangeCallback(),\r\n            align : function(img, value){\r\n                inlineHelper.positionFloat(_widget, value);\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    var _initAlign = function(widget){\r\n\r\n        var align = 'default';\r\n\r\n        //init float positioning:\r\n        if(widget.element.hasClass('rgt')){\r\n            align = 'right';\r\n        }else if(widget.element.hasClass('lft')){\r\n            align = 'left';\r\n        }\r\n\r\n        inlineHelper.positionFloat(widget, align);\r\n        widget.$form.find('select[name=align]').val(align);\r\n    };\r\n\r\n\r\n    var _initMediaSizer = function(widget){\r\n\r\n        var img = widget.element,\r\n            $src = widget.$form.find('input[name=src]'),\r\n            $mediaResizer = widget.$form.find('.img-resizer'),\r\n            $mediaSpan = widget.$container;\r\n\r\n        if($src.val()){\r\n\r\n            //init data-responsive:\r\n            if(img.data('responsive') === undefined){\r\n                if(img.attr('width') && !/[0-9]+%/.test(img.attr('width'))){\r\n                    img.data('responsive', false);\r\n                }else{\r\n                    img.data('responsive', true);\r\n                }\r\n            }\r\n\r\n            //hack to fix the initial width issue:\r\n            if(img.data('responsive')){\r\n                $mediaSpan.css('width', img.attr('width'))\r\n                $mediaSpan.css('height', '')\r\n            }\r\n\r\n            //init media sizer\r\n            $mediaResizer.mediasizer({\r\n                responsive : (img.data('responsive') !== undefined) ? !!img.data('responsive') : true,\r\n                target : widget.$original,\r\n                applyToMedium : false\r\n            });\r\n\r\n            //bind modification events\r\n            $mediaResizer\r\n                .off('.mediasizer')\r\n                .on('responsiveswitch.mediasizer', function(e, responsive){\r\n\r\n                    img.data('responsive', responsive);\r\n\r\n                })\r\n                .on('sizechange.mediasizer', function(e, size){\r\n\r\n                \r\n                _(['width', 'height']).each(function(sizeAttr){\r\n                    if(size[sizeAttr] === '' || size[sizeAttr] === undefined || size[sizeAttr] === null){\r\n                        img.removeAttr(sizeAttr);\r\n                        $mediaSpan.css(sizeAttr, '')\r\n                    }else{\r\n                        img.attr(sizeAttr, size[sizeAttr]);\r\n                        $mediaSpan.css(sizeAttr, size[sizeAttr])\r\n                    }\r\n\r\n                    //trigger choice container size adaptation\r\n                    widget.$container.trigger('contentChange.qti-widget');\r\n                });\r\n\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n    var _initAdvanced = function(widget){\r\n\r\n        var $form = widget.$form,\r\n            src = widget.element.attr('src');\r\n\r\n        if(src){\r\n            $form.find('[data-role=advanced]').show();\r\n        }else{\r\n            $form.find('[data-role=advanced]').hide();\r\n        }\r\n    };\r\n\r\n\r\n    var _initUpload = function(widget){\r\n\r\n        var $form = widget.$form,\r\n            options = widget.options,\r\n            img = widget.element,\r\n            $container = widget.$container,\r\n            $uploadTrigger = $form.find('[data-role=\"upload-trigger\"]'),\r\n            $src = $form.find('input[name=src]'),\r\n            $alt = $form.find('input[name=alt]');\r\n\r\n        var _openResourceMgr = function(){\r\n            $uploadTrigger.resourcemgr({\r\n                title : __('Please select an image file from the resource manager. You can add files from your computer with the button \"Add file(s)\".'),\r\n                appendContainer : options.mediaManager.appendContainer,\r\n                mediaSourcesUrl : options.mediaManager.mediaSourcesUrl,\r\n                browseUrl : options.mediaManager.browseUrl,\r\n                uploadUrl : options.mediaManager.uploadUrl,\r\n                deleteUrl : options.mediaManager.deleteUrl,\r\n                downloadUrl : options.mediaManager.downloadUrl,\r\n                fileExistsUrl : options.mediaManager.fileExistsUrl,\r\n                params : {\r\n                    uri : options.uri,\r\n                    lang : options.lang,\r\n                    filters : [\r\n                        {'mime':'image/jpeg'},\r\n                        {'mime':'image/png'},\r\n                        {'mime':'image/gif'},\r\n                        {'mime':'image/svg+xml'},\r\n                        {'mime':'application/x-gzip', 'extension':'svgz'}\r\n                    ]\r\n                },\r\n                pathParam : 'path',\r\n                select : function(e, files){\r\n                    \r\n                    var file, alt;\r\n                    \r\n                    if(files && files.length){\r\n                        \r\n                        file = files[0].file;\r\n                        alt = files[0].alt;\r\n                        $src.val(file);\r\n\r\n                        imageUtil.getSize(options.baseUrl + file, function(size){\r\n\r\n                            if(size && size.width >= 0){\r\n                                \r\n                                var w = parseInt(size.width, 10),\r\n                                    maxW = $container.parents().innerWidth();\r\n                                    \r\n                                //always set the image size in % of the container size with a seurity margin of 5%\r\n                                if(w >= maxW * 0.95){\r\n                                    img.attr('width', '100%');\r\n                                }else{\r\n                                    w = parseInt(100*w/maxW);\r\n                                    img.attr('width', w+'%');\r\n                                }\r\n                                img.removeAttr('height');\r\n                            }\r\n\r\n                            if($.trim($alt.val()) === ''){\r\n                                if(alt === ''){\r\n                                    alt = _extractLabel(file);\r\n                                }\r\n                                img.attr('alt', alt);\r\n                                $alt.val(alt).trigger('change');\r\n                            }\r\n                            else{\r\n                                var confirmBox = $('.change-alt-modal-feedback'),\r\n                                    cancel = confirmBox.find('.cancel'),\r\n                                    save = confirmBox.find('.save'),\r\n                                    close = confirmBox.find('.modal-close');\r\n\r\n                                $('.alt-text',confirmBox).html('\"' + $alt.val() + '\"<br>with<br>\"' + alt+'\" ?');\r\n\r\n                                confirmBox.modal({ width: 500 });\r\n\r\n                                save.off('click')\r\n                                    .on('click', function () {\r\n                                        img.attr('alt', alt);\r\n                                        $alt.val(alt).trigger('change');\r\n                                        confirmBox.modal('close');\r\n                                    });\r\n\r\n                                cancel.off('click')\r\n                                    .on('click', function () {\r\n                                        confirmBox.modal('close');\r\n                                    });\r\n                            }\r\n\r\n                            _.defer(function(){\r\n                                $src.trigger('change');\r\n                            });\r\n                        });\r\n                    }\r\n                },\r\n                open : function(){\r\n                    //hide tooltip if displayed\r\n                    if($src.data('qtip')){\r\n                        $src.blur().qtip('hide');\r\n                    }\r\n                },\r\n                close : function(){\r\n                    //triggers validation : \r\n                    $src.blur();\r\n                }\r\n            });\r\n        };\r\n\r\n        $uploadTrigger.on('click', _openResourceMgr);\r\n\r\n        //if empty, open file manager immediately\r\n        if(!$src.val()){\r\n            _openResourceMgr();\r\n        }\r\n\r\n    };\r\n\r\n    return ImgStateActive;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/img/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/img/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/img/states/Active'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/helpers/widget',['jquery', 'lodash'], function($, _){\r\n\r\n    var helper = {\r\n        buildInlineContainer : function(widget){\r\n            \r\n            var float = '';\r\n            if(widget.element.hasClass('lft')){\r\n                float = ' lft';\r\n            }else if(widget.element.hasClass('rgt')){\r\n                float = ' rgt';\r\n            }\r\n            \r\n            var $wrap = $('<span>', {\r\n                'data-serial' : widget.element.serial,\r\n                'class' : 'widget-box widget-inline widget-'+widget.element.qtiClass+float,\r\n                'data-qti-class' : widget.element.qtiClass,\r\n                'contenteditable' : 'false'\r\n            });\r\n            widget.$container = widget.$original.wrap($wrap).parent();\r\n            if(widget.$container.length){\r\n                var textNode = widget.$container[0].nextSibling;\r\n                if(textNode){\r\n                    //@todo : make text cursor positioning after an inline widget easier\r\n                    textNode.nodeValue = ' '+textNode.nodeValue;\r\n                }\r\n            }\r\n        },\r\n        buildBlockContainer : function(widget){\r\n            \r\n            //absolutely need a div here (not span), otherwise mathjax will break\r\n            var $wrap = $('<div>', {\r\n                'data-serial' : widget.element.serial,\r\n                'class' : 'widget-box widget-block widget-'+widget.element.qtiClass,\r\n                'data-qti-class' : widget.element.qtiClass\r\n            });\r\n            widget.$container = widget.$original.wrap($wrap).parent();\r\n        },\r\n        createToolbar : function(widget, toolbarTpl){\r\n        \r\n            if(_.isFunction(toolbarTpl)){\r\n\r\n                var $tlb = $(toolbarTpl({\r\n                    serial : widget.serial,\r\n                    state : 'active'\r\n                }));\r\n\r\n                widget.$container.append($tlb);\r\n\r\n                $tlb.find('[data-role=\"delete\"]').on('click.widget-box', function(e){\r\n                    e.stopPropagation();//to prevent direct deleting;\r\n                    widget.changeState('deleting');\r\n                });\r\n\r\n            }else{\r\n                throw 'the toolbarTpl must be a handlebars function';\r\n            }\r\n        }\r\n    };\r\n\r\n    return helper;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/media', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"mini-tlb\\\" data-edit=\\\"\";\n  if (helper = helpers.state) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.state); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"rgt tlb-button\\\" title=\\\"Delete\\\" data-role=\\\"delete\\\">\\r\\n        <span class=\\\"icon-bin\\\"></span>\\r\\n    </span>\\r\\n</span>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/img/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/img/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/media',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/inline'\r\n], function($, Widget, states, helper, toolbarTpl, inlineHelper){\r\n    'use strict';\r\n\r\n    var ImgWidget = Widget.clone();\r\n\r\n    ImgWidget.initCreator = function initCreator(options){\r\n\r\n        var self = this;\r\n        var img = this.element;\r\n\r\n        this.registerStates(states);\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        inlineHelper.togglePlaceholder(this);\r\n\r\n        //check file exists:\r\n        inlineHelper.checkFileExists(this, 'src', options.baseUrl);\r\n        $('#item-editor-scope').on('filedelete.resourcemgr.' + this.element.serial, function(e, src){\r\n            if (self.getAssetManager().resolve(img.attr('src')) === self.getAssetManager().resolve(src)) {\r\n                img.attr('src', '');\r\n                inlineHelper.togglePlaceholder(self);\r\n            }\r\n        });\r\n    };\r\n\r\n    ImgWidget.destroy = function destroy(){\r\n        $('#item-editor-scope').off('.' + this.element.serial);\r\n    };\r\n\r\n    ImgWidget.getRequiredOptions = function(){\r\n        return ['baseUrl', 'uri', 'lang', 'mediaManager', 'assetManager'];\r\n    };\r\n\r\n    ImgWidget.buildContainer = function buildContainer(){\r\n\r\n        helper.buildInlineContainer(this);\r\n\r\n        this.$container.css({\r\n            width: this.element.attr('width'),\r\n            height: this.element.attr('height')\r\n        });\r\n        this.$original[0].setAttribute('width', '100%');\r\n        this.$original[0].setAttribute('height', '100%');\r\n\r\n        return this;\r\n    };\r\n\r\n    ImgWidget.createToolbar = function createToolbar(){\r\n\r\n        helper.createToolbar(this, toolbarTpl);\r\n\r\n        return this;\r\n    };\r\n\r\n    return ImgWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/Img',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Img',\r\n    'taoQtiItem/qtiCreator/widgets/static/img/Widget'\r\n], function(_, Renderer, Widget){\r\n    'use strict';\r\n\r\n    var CreatorImg = _.clone(Renderer);\r\n\r\n    CreatorImg.render = function(img, options){\r\n\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        Widget.build(\r\n            img,\r\n            Renderer.getContainer(img),\r\n            this.getOption('bodyElementOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorImg;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/include', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, helper, functionType=\"function\";\n\n\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Include',['tpl!taoQtiItem/qtiCommonRenderer/tpl/include'], function(tpl){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'include',\r\n        template : tpl\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/include', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"href\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the shared stimulus.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the shared stimulus.\", options)))\n    + \"</div>\\r\\n    <input type=\\\"text\\\" name=\\\"href\\\" value=\\\"\";\n  if (helper = helpers.href) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.href); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty;\\\" readonly/>\\r\\n    <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select shared stimulus\", options) : helperMissing.call(depth0, \"__\", \"Select shared stimulus\", options)))\n    + \"</button>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technlogies SA\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/include/states/Active',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/include',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/helper/xincludeRenderer',\r\n    'ui/resourcemgr',\r\n    'ui/tooltip'\r\n], function($, _, __, stateFactory, Active, formTpl, formElement, xincludeRenderer){\r\n    'use strict';\r\n\r\n    var IncludeStateActive = stateFactory.extend(Active, function(){\r\n\r\n        this.initForm();\r\n\r\n    }, function(){\r\n\r\n        this.widget.$form.empty();\r\n    });\r\n\r\n    IncludeStateActive.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            include = _widget.element,\r\n            baseUrl = _widget.options.baseUrl;\r\n\r\n        $form.html(formTpl({\r\n            baseUrl : baseUrl || '',\r\n            href : include.attr('href')\r\n        }));\r\n\r\n        //init slider and set align value before ...\r\n        _initUpload(_widget);\r\n\r\n        //... init standard ui widget\r\n        formElement.initWidget($form);\r\n\r\n    };\r\n\r\n    var _initUpload = function(widget){\r\n\r\n        var $form = widget.$form,\r\n            options = widget.options,\r\n            $uploadTrigger = $form.find('[data-role=\"upload-trigger\"]'),\r\n            $href = $form.find('input[name=href]');\r\n\r\n        var _openResourceMgr = function(){\r\n            $uploadTrigger.resourcemgr({\r\n                title : __('Please select a shared stimulus file from the resource manager.'),\r\n                appendContainer : options.mediaManager.appendContainer,\r\n                mediaSourcesUrl : options.mediaManager.mediaSourcesUrl+'?exclude=local',\r\n                browseUrl : options.mediaManager.browseUrl,\r\n                uploadUrl : options.mediaManager.uploadUrl,\r\n                deleteUrl : options.mediaManager.deleteUrl,\r\n                downloadUrl : options.mediaManager.downloadUrl,\r\n                fileExistsUrl : options.mediaManager.fileExistsUrl,\r\n                disableUpload : true,\r\n                params : {\r\n                    uri : options.uri,\r\n                    lang : options.lang,\r\n                    filters : 'application/qti+xml'\r\n                },\r\n                pathParam : 'path',\r\n                select : function(e, files){\r\n\r\n                    var file;\r\n\r\n                    if(files && files.length){\r\n\r\n                        file = files[0].file;\r\n                        $href.val(file);\r\n                        \r\n                        //set the selected file as the new href and refresh rendering\r\n                        xincludeRenderer.render(widget, options.baseUrl, file);\r\n\r\n                        _.defer(function(){\r\n                            $href.trigger('change');\r\n                        });\r\n                    }\r\n                },\r\n                open : function(){\r\n                    //hide tooltip if displayed\r\n                    if($href.data('qtip')){\r\n                        $href.blur().qtip('hide');\r\n                    }\r\n                },\r\n                close : function(){\r\n                    //triggers validation : \r\n                    $href.blur();\r\n                }\r\n            });\r\n        };\r\n        \r\n        $uploadTrigger.on('click', _openResourceMgr);\r\n        $href.on('click', _openResourceMgr);//href input is read only\r\n\r\n        //if empty, open file manager immediately\r\n        if(!$href.val()){\r\n            _openResourceMgr();\r\n        }\r\n\r\n    };\r\n\r\n    return IncludeStateActive;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/include/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/include/states/Active'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *               every occurrence of deprecated helper usage was replaced\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/include/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/include/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/media',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/inline'\r\n], function($, Widget, states, helper, toolbarTpl, inlineHelper){\r\n    'use strict';\r\n\r\n    var IncludeWidget = Widget.clone();\r\n    /**\r\n     *\r\n     * @param {Object} options\r\n     * @param {String} options.baseUrl\r\n     */\r\n    IncludeWidget.initCreator = function(options){\r\n\r\n        this.registerStates(states);\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        inlineHelper.togglePlaceholder(this);\r\n    };\r\n\r\n    IncludeWidget.destroy = function(){\r\n        $('#item-editor-scope').off('.' + this.element.serial);\r\n    };\r\n\r\n    IncludeWidget.getRequiredOptions = function(){\r\n        return ['baseUrl', 'uri', 'lang', 'mediaManager'];\r\n    };\r\n\r\n    IncludeWidget.buildContainer = function(){\r\n        \r\n        helper.buildBlockContainer(this);\r\n        this.$container.css({\r\n            width: this.element.attr('width'),\r\n            height: this.element.attr('height')\r\n        });\r\n        this.$original.removeAttr('data-serial');\r\n        this.$original[0].setAttribute('width', '100%');\r\n        this.$original[0].setAttribute('height', '100%');\r\n\r\n        return this;\r\n    };\r\n\r\n    IncludeWidget.createToolbar = function(){\r\n\r\n        helper.createToolbar(this, toolbarTpl);\r\n\r\n        return this;\r\n    };\r\n\r\n    return IncludeWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/include', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"qti-include\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/Include',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Include',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCreator/widgets/static/include/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/include'\r\n], function(_, Renderer, containerHelper, Widget, tpl){\r\n    'use strict';\r\n\r\n    var CreatorXInclude = _.clone(Renderer);\r\n\r\n    CreatorXInclude.template = tpl;\r\n\r\n    CreatorXInclude.getContainer = containerHelper.get;\r\n\r\n    CreatorXInclude.render = function(include, options){\r\n\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        Widget.build(\r\n            include,\r\n            containerHelper.get(include),\r\n            this.getOption('bodyElementOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorXInclude;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/associateInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-associateInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"associateInteraction\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <ul class=\\\"choice-area clearfix  none block-listing solid horizontal source\\\" data-eyecatcher=\\\">li\\\">\\r\\n        \";\n  options={hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </ul>\\r\\n    <ul class=\\\"result-area none target clearfix\\\">\\r\\n    </ul>\\r\\n    <div class=\\\"notification-container\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/associateInteraction.pair', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"incomplete-pair\";\n  }\n\n  buffer += \"<li class=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.empty), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n    <div class=\\\"target lft\\\"></div>\\r\\n    <div class=\\\"target rgt\\\"></div>\\r\\n</li>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/instruction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div id=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"small feedback-info item-instruction\\\">\\r\\n    <span class=\\\"icon-info icon\\\"></span><span class=\\\"instruction-message\\\">\";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCommonRenderer/helpers/instructions/Instruction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/instruction',\r\n], function(_, util, instructionTpl){\r\n\r\n    var _notificationLevels = ['info', 'warning', 'error', 'success'];\r\n\r\n    var Instruction = function(interaction, message, callback){\r\n        this.interaction = interaction;\r\n        this.defaultMessage = message || '';\r\n        this.currentMessage = '';\r\n        this.level = 'info';\r\n        this.serial = util.buildSerial('instruction_');\r\n        this.callback = callback;\r\n        this.$dom = null;\r\n        this.state = false;\r\n    };\r\n\r\n    Instruction.isValidLevel = function(level){\r\n        return (_.indexOf(_notificationLevels, level) >= 0);\r\n    };\r\n\r\n    Instruction.prototype.setState = function(state){\r\n        this.state = state;\r\n    };\r\n\r\n    Instruction.prototype.checkState = function(state){\r\n        return (this.state === state);\r\n    };\r\n\r\n    Instruction.prototype.getId = function(){\r\n        return this.serial;\r\n    };\r\n\r\n    Instruction.prototype.create = function($container){\r\n\r\n        $container.append(instructionTpl({\r\n            'message' : this.defaultMessage,\r\n            'serial' : this.serial\r\n        }));\r\n\r\n        this.$dom = $container.find('#' + this.serial);\r\n    };\r\n\r\n    Instruction.prototype.update = function(options){\r\n\r\n        var level = (options && options.level) ? options.level : '',\r\n            message = (options && options.message) ? options.message : '',\r\n            timeout = (options && options.timeout) ? options.timeout : 0,\r\n            start = (options && typeof(options.start) === 'function') ? options.start : null,\r\n            stop = (options && typeof(options.stop) === 'function') ? options.stop : null;\r\n\r\n        if(level && Instruction.isValidLevel(level)){\r\n            this.$dom.removeClass('feedback-' + this.level).addClass('feedback-' + level);\r\n            this.$dom.find('.icon').removeClass('icon-' + this.level).addClass('icon-' + level);\r\n            this.level = level;\r\n        }\r\n\r\n        if(message){\r\n            this.$dom.find('.instruction-message').html(message);\r\n            this.currentMessage = message;\r\n        }\r\n\r\n        if(timeout){\r\n            var _this = this;\r\n            if(start){\r\n                start.call(_this);\r\n            }\r\n            _this.timer = setTimeout(function(){\r\n                if(stop){\r\n                    stop.call(_this);\r\n                }\r\n                _this.timer = null;\r\n            }, timeout);\r\n        }\r\n\r\n    };\r\n\r\n    Instruction.prototype.setLevel = function(level, timeout){\r\n        var options = {\r\n            level : level\r\n        };\r\n        \r\n        if(timeout){\r\n            options.timeout = parseInt(timeout);\r\n            options.stop = function(){\r\n                this.setLevel('info');\r\n            };\r\n        }\r\n        \r\n        this.update(options);\r\n    };\r\n    \r\n    Instruction.prototype.getLevel = function() {\r\n        return this.level;\r\n    };\r\n\r\n    Instruction.prototype.setMessage = function(message, timeout){\r\n        this.update({message : message, timeout : timeout});\r\n    };\r\n\r\n    Instruction.prototype.reset = function(){\r\n        this.update({level : 'info', message : this.defaultMessage});\r\n        this.state = false;\r\n    };\r\n\r\n    Instruction.prototype.validate = function(data){\r\n        if(typeof(this.callback) === 'function'){\r\n            this.callback.call(this, data);\r\n        }\r\n    };\r\n\r\n    return Instruction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/notification', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div class=\\\"small feedback-\";\n  if (helper = helpers.level) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.level); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \" item-notification\\\">\\r\\n    <span class=\\\"icon-\";\n  if (helper = helpers.level) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.level); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></span><span class=\\\"feedback-message\\\">\";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\r\\n    <span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove Message\", options) : helperMissing.call(depth0, \"__\", \"Remove Message\", options)))\n    + \"\\\" class=\\\"icon-close close-trigger\\\"></span>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',[\r\n    'lodash',\r\n    'jquery',\r\n    'i18n',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/Instruction',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/notification'\r\n], function(_, $, __, containerHelper, Instruction, notifTpl){\r\n    'use strict';\r\n\r\n    //stores the instructions\r\n    var _instructions = {};\r\n\r\n    /**\r\n     * The instruction manager helps you in managing instructions and\r\n     * constraints on a QTI Element, usually an interaction or a choice.\r\n     *\r\n     * @exports qtiCommonRenderer/helpers/Instructions/instructionManager\r\n     */\r\n    var instructionManager = {\r\n\r\n        /**\r\n         * Validate the instructions of an element\r\n         * @param {QtiElement} element - a QTI element like an interaction or a choice\r\n         * @param {Object} [data] - any data to give to the instructions\r\n         */\r\n        validateInstructions : function(element, data){\r\n            var serial = element.getSerial();\r\n            if(_instructions[serial]){\r\n                _.each(_instructions[serial], function(instruction){\r\n                    instruction.validate(data || {});\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Add a new instructions to an element\r\n         * @param {QtiElement} element - a QTI element like an interaction or a choice\r\n         * @param {String} message - the message to give to display to the user when the instruction is validated\r\n         * @param {Function} validateCallback - how to validate the instruction\r\n         * @returns {Instruction} the created instruction\r\n         */\r\n        appendInstruction : function(element, message, validateCallback){\r\n            var serial = element.getSerial(),\r\n                instruction = new Instruction(element, message, validateCallback);\r\n\r\n            if(!_instructions[serial]){\r\n                _instructions[serial] = {};\r\n            }\r\n            _instructions[serial][instruction.getId()] = instruction;\r\n\r\n            instruction.create($('.instruction-container', containerHelper.get(element)));\r\n\r\n            return instruction;\r\n        },\r\n\r\n        /**\r\n         * Remove instructions from an element\r\n         * @param {QtiElement} element - a QTI element like an interaction or a choice\r\n         */\r\n        removeInstructions : function(element){\r\n            _instructions[element.getSerial()] = {};\r\n            containerHelper.get(element).find('.instruction-container').empty();\r\n        },\r\n\r\n        /**\r\n         * Reset the instructions states for an element (but keeps configuration)\r\n         * @param {Object} element - the qti object, ie. interaction, choice, etc.\r\n         */\r\n        resetInstructions : function(element){\r\n            var serial = element.getSerial();\r\n            if(_instructions[serial]){\r\n                _.each(_instructions[serial], function(instruction){\r\n                    instruction.reset();\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Default instuction set with a min/max constraints.\r\n         * @param {Object} interaction\r\n         * @param {jQueryElement} $container\r\n         * @param {Object} options\r\n         * @param {Number} [options.min = 0] -\r\n         * @param {Number} [options.max = 0] -\r\n         * @param {Function} options.getResponse - a ref to a function that get the raw response (array) from the interaction in parameter\r\n         * @param {Function} [options.onError] - called by once an error occurs with validateInstruction data in parameters\r\n         */\r\n        minMaxChoiceInstructions : function(interaction, options){\r\n\r\n            var self = this,\r\n                min = options.min || 0,\r\n                max = options.max || 0,\r\n                getResponse = options.getResponse,\r\n                onError = options.onError || _.noop(),\r\n                choiceCount = options.choiceCount === false ? false : _.size(interaction.getChoices()),\r\n                minInstructionSet = false,\r\n                msg;\r\n\r\n            if(!_.isFunction(getResponse)){\r\n                throw \"invalid parameter getResponse\";\r\n            }\r\n\r\n            //if maxChoice = 0, inifinite choice possible\r\n            if(max > 0 && (choiceCount === false || max < choiceCount)){\r\n                if(max === min){\r\n                    minInstructionSet = true;\r\n                    msg = (max <= 1) ? __('You must select exactly %d choice', max) : __('You must select exactly %d choices', max);\r\n\r\n                    self.appendInstruction(interaction, msg, function(data){\r\n\r\n                        if(getResponse(interaction).length >= max){\r\n                            this.setLevel('success');\r\n                            if(this.checkState('fulfilled')){\r\n                                this.update({\r\n                                    level : 'warning',\r\n                                    message : __('Maximum choices reached'),\r\n                                    timeout : 2000,\r\n                                    start : function(){\r\n                                        onError(data);\r\n                                    },\r\n                                    stop : function(){\r\n                                        this.update({level : 'success', message : msg});\r\n                                    }\r\n                                });\r\n                            }\r\n                            this.setState('fulfilled');\r\n                        }else{\r\n                            this.reset();\r\n                        }\r\n                    });\r\n                }else if(max > min){\r\n                    msg = (max <= 1) ? __('You can select maximum %d choice', max) : __('You can select maximum %d choices', max);\r\n                    self.appendInstruction(interaction,  msg, function(data){\r\n\r\n                        if(getResponse(interaction).length >= max){\r\n\r\n                            this.setLevel('success');\r\n                            this.setMessage(__('Maximum choices reached'));\r\n                            if(this.checkState('fulfilled')){\r\n                                this.update({\r\n                                    level : 'warning',\r\n                                    timeout : 2000,\r\n                                    start : function(){\r\n                                        onError(data);\r\n                                    },\r\n                                    stop : function(){\r\n                                        this.setLevel('info');\r\n                                    }\r\n                                });\r\n                            }\r\n\r\n                            this.setState('fulfilled');\r\n                        }else{\r\n                            this.reset();\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n\r\n            if(!minInstructionSet && min > 0 && (choiceCount === false || min < choiceCount)){\r\n                msg = (min <= 1) ? __('You must at least %d choice', min) : __('You must select at least %d choices', max);\r\n                self.appendInstruction(interaction, msg, function(){\r\n                    if(getResponse(interaction).length >= min){\r\n                        this.setLevel('success');\r\n                    }else{\r\n                        this.reset();\r\n                    }\r\n                });\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Appends a instruction  notification message\r\n         * @deprecated in favor of instructions\r\n         * @param {QtiElement} element - a QTI element like an interaction or a choice\r\n         * @param {String} message - the message to give to display\r\n         * @param {String} [level = 'info'] - the notification level in info, success, error or warning\r\n         */\r\n        appendNotification : function(element, message, level){\r\n\r\n            level = level || 'info';\r\n\r\n            if(Instruction.isValidLevel(level)){\r\n\r\n                var $container = containerHelper.get(element);\r\n\r\n                $container.find('.notification-container').prepend(notifTpl({\r\n                    'level' : level,\r\n                    'message' : message\r\n                }));\r\n\r\n                var $notif = $container.find('.item-notification:first');\r\n                var _remove = function(){\r\n                    $notif.fadeOut();\r\n                };\r\n\r\n                $notif.find('.close-trigger').on('click', _remove);\r\n                setTimeout(_remove, 2000);\r\n\r\n                return $notif;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Removes all the displayed notifications\r\n         * @deprecated in favor of instructions\r\n         */\r\n        removeNotifications : function(element){\r\n            containerHelper.get(element).find('.item-notification').remove();\r\n        }\r\n    };\r\n    return instructionManager;\r\n});\r\n\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/PciPrettyPrint',['lodash'], function(_){\r\n    \r\n    'use strict';\r\n\r\n    var _formatters = {\r\n        boolean : function(value){\r\n            return value ? 'true' : 'false';\r\n        },\r\n        integer : function(value){\r\n            return value;\r\n        },\r\n        float : function(value){\r\n            return value;\r\n        },\r\n        string : function(value){\r\n            return (value === '') ? 'NULL' : ('\"' + value + '\"');\r\n        },\r\n        point : function(value){\r\n            return '[' + value[0] + ', ' + value[1] + ']';\r\n        },\r\n        pair : function(value){\r\n            return '[' + value[0] + ', ' + value[1] + ']';\r\n        },\r\n        directedPair : function(value){\r\n            return '[' + value[0] + ', ' + value[1] + ']';\r\n        },\r\n        duration : function(value){\r\n            return value;\r\n        },\r\n        file : function(value){\r\n            return 'binary data';\r\n        },\r\n        uri : function(value){\r\n            return value;\r\n        },\r\n        intOrIdentifier : function(value){\r\n            return value;\r\n        },\r\n        identifier : function(value){\r\n            return value;\r\n        }\r\n    };\r\n    \r\n    /**\r\n     * Return the pretty print string for a qti base variable\r\n     * \r\n     * @param {type} value\r\n     * @param {type} withType - the qti baseType\r\n     * @returns {String}\r\n     */\r\n    function printBase(value, withType){\r\n\r\n        var print = '',\r\n            base = value.base;\r\n\r\n        withType = (typeof withType !== 'undefined') ? withType : true;\r\n\r\n        if(base){\r\n            \r\n            _.forIn(_formatters, function(formatter, baseType){\r\n                if(base[baseType] !== undefined){\r\n\r\n                    print += (withType) ? '(' + baseType + ') ' : '';\r\n                    print += formatter(base[baseType]);\r\n\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            return print;\r\n        }\r\n\r\n    };\r\n    \r\n    /**\r\n     * Return the pretty print string for a qti list variable\r\n     * \r\n     * @param {object} value\r\n     * @param {string} withType - the qti basetype of the list\r\n     * @returns {string}\r\n     */\r\n    function printList(value, withType){\r\n\r\n        var print = '',\r\n            list = value.list;\r\n\r\n        withType = (typeof withType !== 'undefined') ? withType : true;\r\n\r\n        if(list){\r\n\r\n            _.forIn(_formatters, function(formatter, baseType){\r\n                if(list[baseType] !== undefined){\r\n\r\n                    print += (withType) ? '(' + baseType + ') ' : '';\r\n\r\n                    print += '[';\r\n\r\n                    _.each(list[baseType], function(value){\r\n                        print += formatter(value) + ', ';\r\n                    });\r\n\r\n                    if(_.size(list[baseType])){\r\n                        print = print.substring(0, print.length - 2);\r\n                    }\r\n\r\n                    print += ']';\r\n\r\n                    return false;\r\n                }\r\n            });\r\n\r\n            return print;\r\n        }\r\n    };\r\n    \r\n    /**\r\n     * Return the pretty print string for a qti record variable\r\n     * \r\n     * @param {object} value\r\n     * @returns {String}\r\n     */\r\n    function printRecord(value){\r\n        if(value && value.record){\r\n            return '(record) ' + JSON.stringify(value.record);\r\n        }\r\n        return '';\r\n    }\r\n    \r\n    return {\r\n        printBase : printBase,\r\n        printList : printList,\r\n        printRecord : printRecord\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/PciResponse',['lodash', 'taoQtiItem/qtiCommonRenderer/helpers/PciPrettyPrint'], function(_, pciPrettyPrint){\r\n    'use strict';\r\n\r\n    var _qtiModelPciResponseCardinalities = {\r\n        single : 'base',\r\n        multiple : 'list',\r\n        ordered : 'list',\r\n        record : 'record'\r\n    };\r\n\r\n    return {\r\n\r\n        /**\r\n         * Parse a response variable formatted according to IMS PCI: http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n         *\r\n         * @see serialize\r\n         * @param {Object} response\r\n         * @param {Object} interaction\r\n         * @returns {Array}\r\n         */\r\n        unserialize : function(response, interaction){\r\n\r\n            var ret = [],\r\n                responseDeclaration = interaction.getResponseDeclaration(),\r\n                baseType = responseDeclaration.attr('baseType'),\r\n                cardinality = responseDeclaration.attr('cardinality'),\r\n                mappedCardinality;\r\n\r\n            if(_qtiModelPciResponseCardinalities[cardinality]){\r\n                mappedCardinality = _qtiModelPciResponseCardinalities[cardinality];\r\n                var responseValues = response[mappedCardinality];\r\n\r\n                if(responseValues === null){\r\n                    ret = [];\r\n                }else if(_.isObject(responseValues)){\r\n                    if(responseValues[baseType] !== undefined){\r\n                        ret = responseValues[baseType];\r\n                        ret = _.isArray(ret) ? ret : [ret];\r\n                    }else{\r\n                        throw 'invalid response baseType';\r\n                    }\r\n                }else{\r\n                    throw 'invalid response cardinality, expected '+cardinality+' ('+mappedCardinality+')';\r\n                }\r\n            }else{\r\n                throw 'unknown cardinality in the responseDeclaration of the interaction';\r\n            }\r\n\r\n            return ret;\r\n        },\r\n        /**\r\n         * Serialize the input response array into the format to be send to result server according to IMS PCI recommendation :\r\n         * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n         * With the only exception for empty response, which is represented by a javascript \"null\" value\r\n         *\r\n         * @see http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n         * @param {Array} responseValues\r\n         * @param {Object} interaction\r\n         * @returns {Object|null}\r\n         */\r\n        serialize : function(responseValues, interaction){\r\n\r\n            if(!_.isArray(responseValues)){\r\n                throw 'invalid argument : responseValues must be an Array';\r\n            }\r\n\r\n            var response = {},\r\n                responseDeclaration = interaction.getResponseDeclaration(),\r\n                baseType = responseDeclaration.attr('baseType'),\r\n                cardinality = responseDeclaration.attr('cardinality'),\r\n                mappedCardinality;\r\n\r\n            responseValues = _.map(responseValues || [], function(v){\r\n                return (baseType === 'boolean') ? (v === true || v === 'true') : v;\r\n            });\r\n\r\n            if(_qtiModelPciResponseCardinalities[cardinality]){\r\n                mappedCardinality = _qtiModelPciResponseCardinalities[cardinality];\r\n                if(mappedCardinality === 'base'){\r\n                    if(responseValues.length === 0){\r\n                        //return empty response:\r\n                        response.base = null;\r\n                    }else{\r\n                        response.base = {};\r\n                        response.base[baseType] = responseValues[0];\r\n                    }\r\n                }else{\r\n                    response[mappedCardinality] = {};\r\n                    response[mappedCardinality][baseType] = responseValues;\r\n                }\r\n            }else{\r\n                throw 'unknown cardinality in the responseDeclaration of the interaction';\r\n            }\r\n\r\n            return response;\r\n        },\r\n        isEmpty : function(response){\r\n            return (\r\n                response === null\r\n                || _.isEmpty(response)\r\n                || response.base === null\r\n                || _.isArray(response.list) && _.isEmpty(response.list)\r\n                || _.isArray(response.record) && _.isEmpty(response.record)\r\n            );\r\n        },\r\n\r\n        /**\r\n         * Print a PCI JSON response into a human-readable string.\r\n         *\r\n         * @param {Object} response A response in PCI JSON representation.\r\n         * @returns {String} A human-readable version of the PCI JSON representation.\r\n         */\r\n        prettyPrint: function(response) {\r\n            var print = '';\r\n\r\n            if (typeof response.base !== 'undefined') {\r\n                // -- BaseType.\r\n                print += pciPrettyPrint.printBase(response, true);\r\n            }\r\n            else if (typeof response.list !== 'undefined') {\r\n                // -- ListType\r\n                print += pciPrettyPrint.printList(response, true);\r\n            }\r\n            else if (typeof response.record !== 'undefined') {\r\n                // -- RecordType\r\n                print += pciPrettyPrint.printRecord(response, true);\r\n            }\r\n            else {\r\n                throw 'Not a valid PCI JSON Response';\r\n            }\r\n\r\n            return print;\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter',[\r\n    'jquery',\r\n    'lodash',\r\n    'util/adaptSize',\r\n    'ui/waitForMedia'\r\n], function ($, _, adaptSize, waitForMedia) {\r\n\r\n    'use strict';\r\n\r\n    return {\r\n\r\n        /**\r\n         * Resize jQueryElement that have changed their dimensions due to a change of the content\r\n         *\r\n         * @param {jQueryElement|widget} target\r\n         */\r\n        adaptSize: function (target) {\r\n\r\n            var $elements;\r\n            var $container;\r\n\r\n            switch (true) {\r\n                // widget\r\n                case (typeof target.$container !== 'undefined'):\r\n                    $elements = target.$container.find('.add-option, .result-area .target, .choice-area .qti-choice');\r\n                    $container = target.$container;\r\n                    break;\r\n\r\n                // jquery elements\r\n                default:\r\n                    $elements = target;\r\n                    $container = $($elements).first().parent();\r\n            }\r\n\r\n            $container.waitForMedia(function () {\r\n                adaptSize.height($elements);\r\n            });\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/associateInteraction',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/associateInteraction.pair',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter',\r\n    'interact',\r\n    'ui/interactUtils'\r\n], function ($, _, __, Promise, tpl, pairTpl, containerHelper, instructionMgr, pciResponse, sizeAdapter, interact, interactUtils) {\r\n\r\n    'use strict';\r\n\r\n    var setChoice = function(interaction, $choice, $target){\r\n\r\n        var $container      = containerHelper.get(interaction);\r\n        var choiceSerial    = $choice.data('serial');\r\n        var usage           = $choice.data('usage') || 0;\r\n        var choice          = interaction.getChoice(choiceSerial);\r\n\r\n        if(!choiceSerial){\r\n            throw 'empty choice serial';\r\n        }\r\n\r\n        //to track number of times a choice is used in a pair\r\n        usage++;\r\n        $choice.data('usage', usage);\r\n\r\n        var _setChoice = function(){\r\n\r\n            $target\r\n                .data('serial', choiceSerial)\r\n                .html($choice.html())\r\n                .addClass('filled');\r\n\r\n            if(!interaction.responseMappingMode &&\r\n                choice.attr('matchMax') &&\r\n                usage >= choice.attr('matchMax')){\r\n\r\n                $choice.addClass('deactivated');\r\n            }\r\n        };\r\n\r\n        if($target.siblings('div').hasClass('filled')){\r\n\r\n            var $resultArea = $('.result-area', $container),\r\n                $pair = $target.parent(),\r\n                thisPairSerial = [$target.siblings('div').data('serial'), choiceSerial],\r\n                $otherRepeatedPair = $();\r\n\r\n            //check if it is not a repeating association!\r\n            $resultArea.children().not($pair).each(function(){\r\n                var $otherPair = $(this).children('.filled');\r\n                if($otherPair.length === 2){\r\n                    var otherPairSerial = [$($otherPair[0]).data('serial'), $($otherPair[1]).data('serial')];\r\n                    if(_.intersection(thisPairSerial, otherPairSerial).length === 2){\r\n                        $otherRepeatedPair = $otherPair;\r\n                        return false;\r\n                    }\r\n                }\r\n            });\r\n\r\n            if($otherRepeatedPair.length === 0){\r\n                //no repeated pair, so allow the choice to be set:\r\n                _setChoice();\r\n\r\n                //trigger pair made event\r\n                containerHelper.triggerResponseChangeEvent(interaction, {\r\n                    type : 'added',\r\n                    $pair : $pair,\r\n                    choices : thisPairSerial\r\n                });\r\n\r\n                instructionMgr.validateInstructions(interaction, {choice : $choice, target : $target});\r\n\r\n                if(interaction.responseMappingMode || parseInt(interaction.attr('maxAssociations')) === 0){\r\n\r\n                    $pair.removeClass('incomplete-pair');\r\n\r\n                    //append new pair option?\r\n                    if(!$resultArea.children('.incomplete-pair').length){\r\n                        $resultArea.append(pairTpl({empty : true}));\r\n                        $resultArea.children('.incomplete-pair').fadeIn(600, function(){\r\n                            $(this).show();\r\n                        });\r\n                    }\r\n                }\r\n            }else{\r\n                //repeating pair: show it:\r\n\r\n                //@todo add a notification message here in warning\r\n                $otherRepeatedPair.css('border', '1px solid orange');\r\n                $target.html(__('identical pair already exists')).css({\r\n                    color : 'orange',\r\n                    border : '1px solid orange'\r\n                });\r\n                setTimeout(function(){\r\n                    $otherRepeatedPair.removeAttr('style');\r\n                    $target.empty().css({color:\"\",border:\"\"});\r\n                }, 2000);\r\n            }\r\n\r\n        }else{\r\n            _setChoice();\r\n        }\r\n    };\r\n\r\n    var unsetChoice = function(interaction, $filledChoice, animate, triggerChange){\r\n\r\n        var $container      = containerHelper.get(interaction);\r\n        var choiceSerial    = $filledChoice.data('serial');\r\n        var $choice         = $container.find('.choice-area [data-serial=' + choiceSerial + ']');\r\n        var usage           = $choice.data('usage') || 0;\r\n        var $parent         = $filledChoice.parent();\r\n        var $sibling        = $container.find('.choice-area [data-serial=' + $filledChoice.siblings('.target').data('serial') + ']');\r\n\r\n        //decrease the  use for this choice\r\n        usage--;\r\n\r\n        $choice\r\n            .data('usage', usage)\r\n            .removeClass('deactivated');\r\n\r\n\r\n        $filledChoice\r\n            .removeClass('filled')\r\n            .removeData('serial')\r\n            .empty();\r\n\r\n        if(!interaction.swapping){\r\n\r\n            if(triggerChange !== false){\r\n                //a pair with one single element is not valid, so consider the response to be modified:\r\n                containerHelper.triggerResponseChangeEvent(interaction, {\r\n                    type : 'removed',\r\n                    $pair : $filledChoice.parent()\r\n                });\r\n                instructionMgr.validateInstructions(interaction, {choice : $choice});\r\n            }\r\n\r\n            //if we are to remove the sibling too, update its usage:\r\n            $sibling.data('usage', $sibling.data('usage') - 1).removeClass('deactivated');\r\n\r\n            //completely empty pair:\r\n            if(!$choice.siblings('div').hasClass('filled') && (parseInt(interaction.attr('maxAssociations')) === 0 || interaction.responseMappingMode)){\r\n                //shall we remove it?\r\n                if(!$parent.hasClass('incomplete-pair')){\r\n                    if(animate){\r\n                        $parent.addClass('removing').fadeOut(500, function(){\r\n                            $(this).remove();\r\n                        });\r\n                    }else{\r\n                        $parent.remove();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    var getChoice = function(interaction, identifier){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //warning: do not use selector data-identifier=identifier because data-identifier may change dynamically\r\n        var choice = interaction.getChoiceByIdentifier(identifier);\r\n        if(!choice){\r\n            throw new Error('cannot find a choice with the identifier : ' + identifier);\r\n        }\r\n        return $('.choice-area [data-serial=' + choice.getSerial() + ']', $container);\r\n    };\r\n\r\n    var renderEmptyPairs = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var max = parseInt(interaction.attr('maxAssociations'));\r\n        var $resultArea = $('.result-area', $container);\r\n\r\n        if(interaction.responseMappingMode || max === 0){\r\n            $resultArea.append(pairTpl({empty : true}));\r\n            $resultArea.children('.incomplete-pair').show();\r\n        }else{\r\n            for(var i = 0; i < max; i++){\r\n                $resultArea.append(pairTpl());\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10291\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function(interaction){\r\n\r\n        var self = this;\r\n\r\n        return new Promise(function(resolve, reject){\r\n\r\n            var $container = containerHelper.get(interaction);\r\n            var $choiceArea = $container.find('.choice-area');\r\n            var $resultArea = $container.find('.result-area');\r\n\r\n            var $activeChoice = null;\r\n\r\n            var isDragAndDropEnabled;\r\n            var dragOptions;\r\n            var dropOptions;\r\n\r\n            var $bin = $('<span>', {'class' : 'icon-undo remove-choice', 'title' : __('remove')});\r\n\r\n            var choiceSelector = $choiceArea.selector + ' >li';\r\n            var resultSelector = $resultArea.selector + ' >li>div';\r\n            var binSelector = $container.selector + \" .remove-choice\";\r\n\r\n            var _getChoice = function(serial){\r\n                return $choiceArea.find('[data-serial=' + serial + ']');\r\n            };\r\n\r\n            /**\r\n             * @todo Tried to store $resultArea.find[...] in a variable but this fails\r\n             * @param $choice\r\n             * @param $target\r\n             * @private\r\n             */\r\n            var _setChoice = function($choice, $target){\r\n                setChoice(interaction, $choice, $target);\r\n                sizeAdapter.adaptSize($('.result-area .target, .choice-area .qti-choice', containerHelper.get(interaction)));\r\n            };\r\n\r\n            var _resetSelection = function(){\r\n                if($activeChoice){\r\n                    $resultArea.find('.remove-choice').remove();\r\n                    $activeChoice.removeClass('active');\r\n                    $container.find('.empty').removeClass('empty');\r\n                    $activeChoice = null;\r\n                }\r\n            };\r\n\r\n            var _unsetChoice = function($choice){\r\n                unsetChoice(interaction, $choice, true);\r\n                sizeAdapter.adaptSize($('.result-area .target, .choice-area .qti-choice', containerHelper.get(interaction)));\r\n            };\r\n\r\n            var _isInsertionMode = function(){\r\n                return ($activeChoice && $activeChoice.data('identifier'));\r\n            };\r\n\r\n            var _isModeEditing = function(){\r\n                return ($activeChoice && !$activeChoice.data('identifier'));\r\n            };\r\n\r\n            var _handleChoiceActivate = function($target) {\r\n                if($target.hasClass('deactivated')){\r\n                    return;\r\n                }\r\n\r\n                if(_isModeEditing()){\r\n                    //swapping:\r\n                    interaction.swapping = true;\r\n                    _unsetChoice($activeChoice);\r\n                    _setChoice($target, $activeChoice);\r\n                    _resetSelection();\r\n                    interaction.swapping = false;\r\n                }else{\r\n                    if($target.hasClass('active')){\r\n                        _resetSelection();\r\n\r\n                    }else{\r\n                        _activateChoice($target);\r\n                    }\r\n                }\r\n            };\r\n\r\n            var _activateChoice = function($choice) {\r\n                _resetSelection();\r\n                $activeChoice = $choice;\r\n                $choice.addClass('active');\r\n                $resultArea.find('>li>.target').addClass('empty');\r\n            };\r\n\r\n            var _handleResultActivate = function($target) {\r\n                var choiceSerial,\r\n                    targetSerial = $target.data('serial');\r\n\r\n                if(_isInsertionMode()){\r\n\r\n                    choiceSerial = $activeChoice.data('serial');\r\n\r\n                    if(targetSerial !== choiceSerial){\r\n\r\n                        if($target.hasClass('filled')){\r\n                            interaction.swapping = true;//hack to prevent deleting empty pair in infinite association mode\r\n                        }\r\n                        //set choices:\r\n                        if(targetSerial){\r\n                            _unsetChoice($target);\r\n                        }\r\n                        _setChoice($activeChoice, $target);\r\n\r\n                        //always reset swapping mode after the choice is set\r\n                        interaction.swapping = false;\r\n                    }\r\n\r\n                    _resetSelection();\r\n\r\n                }else if(_isModeEditing()){\r\n\r\n                    choiceSerial = $activeChoice.data('serial');\r\n\r\n                    if(targetSerial !== choiceSerial){\r\n\r\n                        if($target.hasClass('filled') || $activeChoice.siblings('div')[0] === $target[0]){\r\n                            interaction.swapping = true;//hack to prevent deleting empty pair in infinite association mode\r\n                        }\r\n\r\n                        _unsetChoice($activeChoice);\r\n                        if(targetSerial){\r\n                            //swapping:\r\n                            _unsetChoice($target);\r\n                            _setChoice(_getChoice(targetSerial), $activeChoice);\r\n                        }\r\n                        _setChoice(_getChoice(choiceSerial), $target);\r\n\r\n                        //always reset swapping mode after the choice is set\r\n                        interaction.swapping = false;\r\n                    }\r\n\r\n                    _resetSelection();\r\n\r\n                }else if(targetSerial){\r\n                    _activateResult($target);\r\n                    $target.append($bin);\r\n                }\r\n            };\r\n\r\n            var _activateResult = function ($target) {\r\n                var targetSerial = $target.data('serial');\r\n\r\n                $activeChoice = $target;\r\n                $activeChoice.addClass('active');\r\n\r\n                $resultArea.find('>li>.target').filter(function(){\r\n                    return $(this).data('serial') !== targetSerial;\r\n                }).addClass('empty');\r\n\r\n                $choiceArea.find('>li:not(.deactivated)').filter(function(){\r\n                    return $(this).data('serial') !== targetSerial;\r\n                }).addClass('empty');\r\n            };\r\n\r\n\r\n            // Point & click handlers\r\n\r\n            interact($container.selector).on('tap', function() {\r\n                _resetSelection();\r\n            });\r\n\r\n            interact($choiceArea.selector + ' >li').on('tap', function(e) {\r\n                var $target = $(e.currentTarget);\r\n                e.stopPropagation();\r\n                _handleChoiceActivate($target);\r\n                e.preventDefault();\r\n            });\r\n\r\n            interact($resultArea.selector + ' >li>div').on('tap', function(e) {\r\n                var $target = $(e.currentTarget);\r\n                e.stopPropagation();\r\n                _handleResultActivate($target);\r\n                e.preventDefault();\r\n            });\r\n\r\n            interact(binSelector).on('tap', function (e) {\r\n                e.stopPropagation();\r\n                _unsetChoice($activeChoice);\r\n                _resetSelection();\r\n                e.preventDefault();\r\n            });\r\n\r\n            if(!interaction.responseMappingMode){\r\n                _setInstructions(interaction);\r\n            }\r\n\r\n\r\n            // Drag & drop handlers\r\n\r\n            if (self.getOption && self.getOption(\"enableDragAndDrop\") && self.getOption(\"enableDragAndDrop\").associate) {\r\n                isDragAndDropEnabled = self.getOption(\"enableDragAndDrop\").associate;\r\n            }\r\n\r\n            function _iFrameDragFix(draggableSelector, target) {\r\n                interactUtils.iFrameDragFixOn(function () {\r\n                    var $activeDrop = $(resultSelector + '.dropzone');\r\n                    if ($activeDrop.length) {\r\n                        interact(resultSelector).fire({\r\n                            type: 'drop',\r\n                            target: $activeDrop.eq(0),\r\n                            relatedTarget: target\r\n                        });\r\n                    }\r\n                    $activeDrop = $(choiceSelector + '.dropzone');\r\n                    if ($activeDrop.length) {\r\n                        interact(choiceSelector + '.empty').fire({\r\n                            type: 'drop',\r\n                            target: $activeDrop.eq(0),\r\n                            relatedTarget: target\r\n                        });\r\n                    }\r\n                    interact(draggableSelector).fire({\r\n                        type: 'dragend',\r\n                        target: target\r\n                    });\r\n                });\r\n            }\r\n\r\n            if (isDragAndDropEnabled) {\r\n                dragOptions = {\r\n                    inertia: false,\r\n                    autoScroll: true,\r\n                    restrict: {\r\n                        restriction: \".qti-interaction\",\r\n                        endOnly: false,\r\n                        elementRect: {top: 0, left: 0, bottom: 1, right: 1}\r\n                    }\r\n                };\r\n\r\n                // makes choices draggables\r\n                interact(choiceSelector + ':not(.deactivated)').draggable(_.defaults({\r\n                    onstart: function (e) {\r\n                        var $target = $(e.target);\r\n                        $target.addClass(\"dragged\");\r\n                        _activateChoice($target);\r\n                        _iFrameDragFix(choiceSelector + ':not(.deactivated)', e.target);\r\n                    },\r\n                    onmove: function (e) {\r\n                        interactUtils.moveElement(e.target, e.dx, e.dy);\r\n                    },\r\n                    onend: function (e) {\r\n                        var $target = $(e.target);\r\n                        $target.removeClass(\"dragged\");\r\n                        _resetSelection();\r\n\r\n                        interactUtils.restoreOriginalPosition($target);\r\n                        interactUtils.iFrameDragFixOff();\r\n                    }\r\n                }, dragOptions)).styleCursor(false);\r\n\r\n                // makes results draggables\r\n                interact(resultSelector + '.filled').draggable(_.defaults({\r\n                    onstart: function (e) {\r\n                        var $target = $(e.target);\r\n                        $target.addClass(\"dragged\");\r\n                        _resetSelection();\r\n                        _activateResult($target);\r\n                        _iFrameDragFix(resultSelector + '.filled', e.target);\r\n                    },\r\n                    onmove: function (e) {\r\n                        interactUtils.moveElement(e.target, e.dx, e.dy);\r\n                    },\r\n                    onend: function (e) {\r\n                        var $target = $(e.target);\r\n                        $target.removeClass(\"dragged\");\r\n\r\n                        interactUtils.restoreOriginalPosition($target);\r\n\r\n                        if ($activeChoice) {\r\n                            _unsetChoice($activeChoice);\r\n                        }\r\n                        _resetSelection();\r\n\r\n                        interactUtils.iFrameDragFixOff();\r\n                    }\r\n                }, dragOptions)).styleCursor(false);\r\n\r\n\r\n                dropOptions = {\r\n                    overlap: 0.15,\r\n                    ondragenter: function(e) {\r\n                        $(e.target).addClass('dropzone');\r\n                        $(e.relatedTarget).addClass('droppable');\r\n                    },\r\n                    ondragleave: function(e) {\r\n                        $(e.target).removeClass('dropzone');\r\n                        $(e.relatedTarget).removeClass('droppable');\r\n                    }\r\n                };\r\n\r\n                // makes hotspots droppables\r\n                interact(resultSelector).dropzone(_.defaults({\r\n                    ondrop: function (e) {\r\n                        this.ondragleave(e);\r\n                        _handleResultActivate($(e.target));\r\n                    }\r\n                }, dropOptions));\r\n\r\n                // makes available choices droppables\r\n                interact(choiceSelector + '.empty').dropzone(_.defaults({\r\n                    ondrop: function (e) {\r\n                        this.ondragleave(e);\r\n                        _handleChoiceActivate($(e.target));\r\n                    }\r\n                }, dropOptions));\r\n            }\r\n\r\n\r\n            // interaction init\r\n\r\n            renderEmptyPairs(interaction);\r\n\r\n            sizeAdapter.adaptSize($('.result-area .target, .choice-area .qti-choice', $container));\r\n\r\n            resolve();\r\n\r\n        });\r\n    };\r\n\r\n    var _setInstructions = function(interaction){\r\n\r\n        var min = parseInt(interaction.attr('minAssociations'), 10),\r\n            max = parseInt(interaction.attr('maxAssociations'), 10);\r\n\r\n        //infinite association:\r\n        if(min === 0){\r\n            if(max === 0){\r\n                instructionMgr.appendInstruction(interaction, __('You may make as many association pairs as you want.'));\r\n            }\r\n        }else{\r\n            if(max === 0){\r\n                instructionMgr.appendInstruction(interaction, __('The maximum number of association is unlimited.'));\r\n            }\r\n            //the max value is implicit since the appropriate number of empty pairs have already been created\r\n            var msg = __('You need to make') + ' ';\r\n            msg += (min > 1) ? __('at least') + ' ' + min + ' ' + __('association pairs') : __('one association pair');\r\n            instructionMgr.appendInstruction(interaction, msg, function(){\r\n                if(_getRawResponse(interaction).length >= min){\r\n                    this.setLevel('success');\r\n                }else{\r\n                    this.reset();\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    var resetResponse = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //destroy selected choice:\r\n        $container.find('.result-area .active').each(function () {\r\n           interactUtils.tapOn(this);\r\n        });\r\n\r\n        $('.result-area>li>div', $container).each(function(){\r\n            unsetChoice(interaction, $(this), false, false);\r\n        });\r\n\r\n        containerHelper.triggerResponseChangeEvent(interaction);\r\n        instructionMgr.validateInstructions(interaction);\r\n    };\r\n\r\n    var _setPairs = function(interaction, pairs){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var addedPairs = 0;\r\n        var $emptyPair = $('.result-area>li:first', $container);\r\n        if(pairs && interaction.getResponseDeclaration().attr('cardinality') === 'single' && pairs.length){\r\n            pairs = [pairs];\r\n        }\r\n        _.each(pairs, function(pair){\r\n            if($emptyPair.length){\r\n                var $divs = $emptyPair.children('div');\r\n                setChoice(interaction, getChoice(interaction, pair[0]), $($divs[0]));\r\n                setChoice(interaction, getChoice(interaction, pair[1]), $($divs[1]));\r\n                addedPairs++;\r\n                $emptyPair = $emptyPair.next('li');\r\n            }else{\r\n                //the number of pairs exceeds the maximum allowed pairs: break;\r\n                return false;\r\n            }\r\n        });\r\n\r\n        return addedPairs;\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10291\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n\r\n        _setPairs(interaction, pciResponse.unserialize(response, interaction));\r\n    };\r\n\r\n    var _getRawResponse = function(interaction){\r\n        var response = [];\r\n        var $container = containerHelper.get(interaction);\r\n        $('.result-area>li', $container).each(function(){\r\n            var pair = [];\r\n            $(this).find('div').each(function(){\r\n                var serial = $(this).data('serial');\r\n                if(serial){\r\n                    pair.push(interaction.getChoice(serial).id());\r\n                }\r\n            });\r\n            if(pair.length === 2){\r\n                response.push(pair);\r\n            }\r\n        });\r\n        return response;\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10291\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        return pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    /**\r\n     * Destroy the interaction by leaving the DOM exactly in the same state it was before loading the interaction.\r\n     * @param {Object} interaction - the interaction\r\n     */\r\n    var destroy = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //remove event\r\n        interact($container.selector).unset();\r\n        interact($container.find('.choice-area').selector + ' >li').unset();\r\n        interact($container.find('.result-area').selector + ' >li>div').unset();\r\n        interact($container.find('.remove-choice').selector).unset();\r\n\r\n        //remove instructions\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        $('.result-area', $container).empty();\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        var $container;\r\n\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n\r\n            //restore order of previously shuffled choices\r\n            if(_.isArray(state.order) && state.order.length === _.size(interaction.getChoices())){\r\n\r\n                $container = containerHelper.get(interaction);\r\n\r\n                $('.choice-area .qti-choice', $container)\r\n                    .sort(function(a, b){\r\n                        var aIndex = _.indexOf(state.order, $(a).data('identifier'));\r\n                        var bIndex = _.indexOf(state.order, $(b).data('identifier'));\r\n                        if(aIndex > bIndex) {\r\n                            return 1;\r\n                        }\r\n                        if(aIndex < bIndex) {\r\n                            return -1;\r\n                        }\r\n                        return 0;\r\n                    })\r\n                    .detach()\r\n                    .appendTo($('.choice-area', $container));\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n\r\n        //we store also the choice order if shuffled\r\n        if(interaction.attr('shuffle') === true){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            state.order = [];\r\n            $('.choice-area .qti-choice', $container).each(function(){\r\n               state.order.push($(this).data('identifier'));\r\n            });\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the associate interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/AssociateInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'associateInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState: setState,\r\n        getState : getState,\r\n\r\n        renderEmptyPairs : renderEmptyPairs\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/grip', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"common-tlb\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"tlb-button\\\" title=\\\"move\\\" data-role=\\\"move\\\">\\r\\n        <span class=\\\"icon-grip\\\"></span>\\r\\n    </span>\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/helpers/movable',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/draggable',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/grip'\r\n], function($, draggable, gripTpl){\r\n\r\n    var movable = {\r\n        create : function(widget){\r\n\r\n            var item = widget.element.getRelatedItem(),\r\n                $container = widget.$container,\r\n                $itemBody;\r\n\r\n            var $grip = $(gripTpl({\r\n                serial : widget.serial\r\n            }));\r\n\r\n            $container.append($grip);\r\n\r\n            $grip.on('mouseenter.qti-widget', function(){\r\n\r\n                if(!$itemBody || !$itemBody.length){\r\n                    $itemBody = item.data('widget').$container;\r\n                }\r\n\r\n                //create movable\r\n                //enable the new element to be movable\r\n                draggable.createMovable($container, $itemBody);\r\n\r\n            }).on('mouseleave.qti-widget', function(){\r\n                //destroy movable\r\n                draggable.destroy($container);\r\n            });\r\n        }\r\n    }\r\n    \r\n    return movable;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/interaction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\r\\n        <div class=\\\"state-switcher\\\">\\r\\n            <span class=\\\"selected\\\" data-state=\\\"question\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Question\", options) : helperMissing.call(depth0, \"__\", \"Question\", options)))\n    + \"</span>\\r\\n            <span class=\\\"separator\\\"> | </span>\\r\\n            <span class=\\\"link\\\" data-state=\\\"answer\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Response\", options) : helperMissing.call(depth0, \"__\", \"Response\", options)))\n    + \"</span>\\r\\n        </div>\\r\\n        \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"tlb-wrapper\\\" style=\\\"\\\" data-edit=\\\"active\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <span class=\\\"tlb-title\\\" title=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\r\\n    <div class=\\\"tlb\\\">\\r\\n        <div class=\\\"rgt tlb-button\\\" data-role=\\\"delete\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"delete\", options) : helperMissing.call(depth0, \"__\", \"delete\", options)))\n    + \"\\\">\\r\\n            <span class=\\\"icon-bin\\\"></span>\\r\\n        </div>\\r\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.switcher), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/okButton', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<button class=\\\"btn-info small widget-ok\\\" data-edit=\\\"active\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"done\", options) : helperMissing.call(depth0, \"__\", \"done\", options)))\n    + \"</button>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/Widget',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/movable',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/interaction',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/okButton'\r\n], function(_, $, Widget, movable, toolbarTpl, okButtonTpl){\r\n\r\n    /**\r\n     * \r\n     * Create a new widget definition from another prototype.\r\n     */\r\n    var InteractionWidget = Widget.clone();\r\n\r\n    /**\r\n     * Optional method to be implemented :\r\n     * Init the widget\r\n     * It should never be called directly in normal usage\r\n     * Here, it is overwriten to accomodate for a new argument \r\n     * that other widgets does not have: $responseForm\r\n     */\r\n    InteractionWidget.init = function(element, $container, $form, $responseForm, options){\r\n        Widget.init.call(this, element, $container, $form, options);\r\n        this.$responseForm = $responseForm;\r\n        return this;\r\n    };\r\n\r\n    /**\r\n     * Optional method to be implemented :\r\n     * Build the widget and return an instance ready to be used\r\n     * Here, it is overwritten to accomodate for a new argument\r\n     * that other widgets does not have: $responseForm\r\n     */\r\n    InteractionWidget.build = function(element, $container, $form, $responseForm, options){\r\n        return this.clone().init(element, $container, $form, $responseForm, options);\r\n    };\r\n\r\n    /**\r\n     * Required method to be implemented : \r\n     * define the states and common structure valid for all states\r\n     */\r\n    InteractionWidget.initCreator = function(){\r\n        \r\n        Widget.initCreator.call(this);\r\n        \r\n        this.createToolbar({});\r\n        this.createOkButton();\r\n        this.listenToChoiceStates();\r\n    };\r\n\r\n    /**\r\n     * Required method to be implemented : \r\n     * Define the contaieinr where everything is going on. \r\n     * It normally used this.$original as the start point : from there, you can wrap, innerWrap\r\n     */\r\n    InteractionWidget.buildContainer = function(){\r\n\r\n        var $wrap = $('<div>', {\r\n            'data-serial' : this.element.serial,\r\n            'class' : 'widget-box widget-blockInteraction clearfix',\r\n            'data-qti-class' : this.element.qtiClass\r\n        });\r\n        var $interactionContainer = this.$original.wrap($wrap);\r\n        this.$container = $interactionContainer.parent();\r\n\r\n        //@todo : implement movable interaction here:\r\n//        movable.create(this);\r\n\r\n        return this;\r\n    };\r\n\r\n    function _convertToTitle(str){\r\n        str = str.replace(/[A-Z]/g, function(match){\r\n            return ' ' + match.toUpperCase();\r\n        });\r\n        return str.charAt(0).toUpperCase() + str.substr(1);\r\n    }\r\n\r\n    /**\r\n     * Below here, optional ui component init functions\r\n     */\r\n\r\n    /**\r\n     * Create a toolbar\r\n     */\r\n    InteractionWidget.createToolbar = function(options){\r\n\r\n        options = _.defaults(options || {}, {\r\n            title : _convertToTitle(this.element.qtiClass)\r\n        });\r\n\r\n        var _this = this,\r\n            $toolbar;\r\n\r\n        $toolbar = $(toolbarTpl({\r\n            title : options.title,\r\n            serial : this.element.serial,\r\n            switcher : !!this.registeredStates.answer\r\n        }));\r\n\r\n        this.$container.append($toolbar);\r\n        $toolbar.hide();\r\n\r\n        $toolbar.find('[data-role=\"delete\"]').click(function(e){\r\n            e.stopPropagation();//prevent direct deleting\r\n            _this.changeState('deleting');\r\n        });\r\n\r\n        //if the answer state has been registered\r\n        if(this.registeredStates.answer){\r\n\r\n            //initialize the state switcher\r\n            $toolbar.on('click', '.link', function(){\r\n                var $link = $(this),\r\n                    state = $link.data('state');\r\n\r\n                $link.siblings('.selected').removeClass('selected').addClass('link');\r\n                $link.removeClass('link').addClass('selected');\r\n                _this.changeState(state);\r\n            });\r\n\r\n            //add stateChange event listener to auto toggle the question/answer trigger\r\n            this.beforeStateInit(function(e, element, state){\r\n                if(element.getSerial() === _this.serial){\r\n                    var $link = $toolbar.find('.link[data-state=\"' + state.name + '\"]');\r\n                    if($link.length){\r\n                        //a known active state:\r\n                        $link.siblings('.selected').removeClass('selected').addClass('link');\r\n                        $link.removeClass('link').addClass('selected');\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        return this;\r\n\r\n    };\r\n\r\n    InteractionWidget.createOkButton = function(){\r\n\r\n        var _this = this,\r\n            $ok = $(okButtonTpl()).on('click.qti-widget', function(e){\r\n            e.stopPropagation();\r\n            _this.changeState('sleep');\r\n        });\r\n\r\n        this.$container.append($ok);\r\n    };\r\n\r\n    InteractionWidget.listenToChoiceStates = function(){\r\n\r\n        var _this = this;\r\n\r\n        this.afterStateInit(function(e, element, state){\r\n\r\n            var currentState = _this.getCurrentState();\r\n\r\n            if(element.is('choice')\r\n                && _this.element.getChoice(element.getSerial())\r\n                && currentState\r\n                && state.name !== currentState.name){\r\n\r\n                switch(state.name){\r\n                    case 'choice':\r\n                        _this.changeState(state.name);\r\n                        break;\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    return InteractionWidget;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/states/Sleep'], function(stateFactory, SleepState){\r\n    \r\n    var InteractionStateSleep = stateFactory.extend(SleepState, function(){\r\n        \r\n        var _widget = this.widget;\r\n        \r\n        _widget.$container.on('click.qti-widget.sleep', function(e){\r\n            e.stopPropagation();\r\n            //if active == false do this: (else nothing)\r\n            //show toolbar, prompt widget and choice widgets and property form\r\n\r\n            //init default mode: question\r\n            _widget.changeState('question');\r\n        });\r\n        \r\n    }, function(){\r\n        \r\n        var _widget = this.widget;\r\n        \r\n        //remove hover outline box display\r\n        _widget.$container.off('.sleep');\r\n    });\r\n    \r\n    return InteractionStateSleep;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Active',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Active',\r\n    'lodash'\r\n], function(stateFactory, Active, _){\r\n\r\n    var _containsInModalFeedbackElts = function(response, searchSerial){\r\n\r\n        var found = false,\r\n            modalFeedbacks = [];\r\n\r\n        _.each(response.feedbackRules, function(rule){\r\n            if(rule.feedbackThen && rule.feedbackThen.qtiClass === 'modalFeedback'){\r\n                modalFeedbacks.push(rule.feedbackThen);\r\n            }\r\n            if(rule.feedbackElse && rule.feedbackElse.qtiClass === 'modalFeedback'){\r\n                modalFeedbacks.push(rule.feedbackElse);\r\n            }\r\n        });\r\n        _.each(modalFeedbacks, function(fb){\r\n            var elt = fb.getBody().getElement(searchSerial);\r\n            if(elt){\r\n                found = true;\r\n                return false;//break\r\n            }\r\n        });\r\n\r\n        return found;\r\n    };\r\n\r\n    var InteractionStateActive = stateFactory.extend(Active, function(){\r\n        \r\n        var _widget = this.widget,\r\n            $container = _widget.$container,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        $container.attr('contenteditable', false);\r\n\r\n        _widget.beforeStateInit(function(e, element, state){\r\n            \r\n            var serial = element.getSerial();\r\n            \r\n            if(element.qtiClass === 'modalFeedback'){\r\n                return false;\r\n            }\r\n            \r\n            if(state.name === 'active' && serial !== _widget.serial){\r\n                \r\n                //when it does not click on itself, check if the newly activated element is its own composing element:\r\n                var composingElts = interaction.getComposingElements();\r\n                var inModalFeedback = _containsInModalFeedbackElts(response, serial);\r\n                if(!composingElts[serial] && !inModalFeedback){\r\n                    _widget.changeState('sleep');\r\n                }\r\n            }\r\n        }, 'otherActive');\r\n\r\n        $container.on('mouseenter.active', function(e){\r\n            e.stopPropagation();\r\n            $container.parent().trigger('mouseleave.sleep');\r\n        }).on('mouseleave.active', function(e){\r\n            e.stopPropagation();\r\n            $container.parent().trigger('mouseenter.sleep');\r\n        }).on('click.active', function(e){\r\n            e.stopPropagation();\r\n        });\r\n\r\n    }, function(){\r\n\r\n        this.widget.offEvents('otherActive');\r\n    });\r\n\r\n    return InteractionStateActive;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/addChoice', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<li class=\\\"add-option\\\" data-edit=\\\"question\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-role=\\\"add-option\\\">\\r\\n    <span class=\\\"icon-add\\\"></span>\\r\\n    \";\n  if (helper = helpers.text) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.text); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\r\\n</li>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Question',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Question',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/addChoice',\r\n    'i18n'\r\n], function($, stateFactory, Question, addChoiceTpl, __){\r\n\r\n    var InteractionStateQuestion = stateFactory.create(Question, function(){\r\n\r\n        //show option form\r\n        this.initForm();\r\n        this.widget.$form.show();\r\n\r\n        //allow quick edit of internal element (toggle shuffle/fix, delete choices via minit-toolbar)\r\n\r\n        //init add choice button if needed\r\n        this.addNewChoiceButton(this.widget);\r\n\r\n        //switchable to choice(click), answer(toolbar), deleting(toolbar), sleep (OK button)\r\n\r\n        //init form:\r\n\r\n\r\n    }, function(){\r\n\r\n        //destroy and hide it\r\n        this.widget.$form.empty().hide();\r\n\r\n        //disable/destroy editor, hide mini-toolbar\r\n    });\r\n\r\n\r\n    InteractionStateQuestion.prototype.addNewChoiceButton = function(){\r\n\r\n        var widget = this.widget,\r\n            $choiceArea = widget.$container.find('.choice-area'),\r\n            interaction = widget.element;\r\n\r\n        //init add choice button if needed\r\n        if($choiceArea.length && !$choiceArea.children('.add-option').length){\r\n\r\n            $choiceArea.append(addChoiceTpl({\r\n                serial : this.serial,\r\n                text : __('Add choice')\r\n            }));\r\n\r\n            $choiceArea.children('.add-option').show().on('click.qti-widget', function(e){\r\n\r\n                e.stopPropagation();\r\n\r\n                //add a new choice\r\n                var choice = interaction.createChoice(),\r\n                    $newChoicePlaceholder = $('<li>'),\r\n                    qtiChoiceClassName = choice.qtiClass + '.' + interaction.qtiClass,\r\n                    tplData = {\r\n                    interaction : {\r\n                        serial : interaction.serial,\r\n                        attributes : interaction.attributes\r\n                    }\r\n                };\r\n\r\n                //append placeholder\r\n                $(this).before($newChoicePlaceholder);\r\n\r\n                //render the new choice\r\n                choice.render(tplData, $newChoicePlaceholder, qtiChoiceClassName);\r\n                choice.postRender({\r\n                    ready : function(widget){\r\n                        //transition state directly back to \"question\"\r\n                        widget.changeState('choice');\r\n                    }\r\n                }, qtiChoiceClassName);\r\n            });\r\n\r\n        }\r\n    };\r\n\r\n    InteractionStateQuestion.prototype.initForm = function(){\r\n        stateFactory.throwMissingRequiredImplementationError('initForm');\r\n    };\r\n\r\n    return InteractionStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Choice',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/content'\r\n], function($, stateFactory, Choice, contentHelper){\r\n\r\n    var InteractionStateChoice = stateFactory.create(Choice, function(){\r\n\r\n        var _widget = this.widget;\r\n\r\n        //move to question state by clicking everywhere in the interaction but outside of the choice\r\n        _widget.$container.on('click.choice', function(e){\r\n\r\n            if(!$(e.target).closest('.qti-choice').length){\r\n                _widget.changeState('question');\r\n            }\r\n        });\r\n\r\n        contentHelper.changeInnerWidgetState(this.widget, 'sleep');\r\n\r\n    }, function(){\r\n\r\n        this.widget.$container.off('.choice');\r\n    });\r\n\r\n    return InteractionStateChoice;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/response/responseForm', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n        <option value=\\\"\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"</option>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n<hr/>\\r\\n\\r\\n<div class=\\\"response-mapping-attributes\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.mappingDisabled), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n    <div class=\\\"panel\\\" data-editx=\\\"map\\\">\\r\\n        <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Score range\", options) : helperMissing.call(depth0, \"__\", \"Score range\", options)))\n    + \"</h3>\\r\\n        <div>\\r\\n            <label for=\\\"lowerBound\\\" class=\\\"spinner\\\">Min</label>\\r\\n            <input name=\\\"lowerBound\\\" value=\\\"\";\n  if (helper = helpers.lowerBound) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.lowerBound); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.mappingDisabled), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"score\\\" type=\\\"text\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\" />\\r\\n            <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Minimal  score for this interaction.\", options) : helperMissing.call(depth0, \"__\", \"Minimal  score for this interaction.\", options)))\n    + \"</span>\\r\\n        </div>\\r\\n        <div>\\r\\n            <label for=\\\"upperBound\\\" class=\\\"spinner\\\">Max</label>\\r\\n            <input name=\\\"upperBound\\\" value=\\\"\";\n  if (helper = helpers.upperBound) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.upperBound); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.mappingDisabled), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"score\\\" type=\\\"text\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\" />\\r\\n            <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Maximal score for this interaction.\", options) : helperMissing.call(depth0, \"__\", \"Maximal score for this interaction.\", options)))\n    + \"</span>\\r\\n        </div>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"panel\\\" data-editx=\\\"map\\\">\\r\\n        <label for=\\\"defaultValue\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Mapping default\", options) : helperMissing.call(depth0, \"__\", \"Mapping default\", options)))\n    + \"</label>\\r\\n        <input name=\\\"defaultValue\\\" value=\\\"\";\n  if (helper = helpers.defaultValue) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.defaultValue); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.mappingDisabled), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"score\\\" type=\\\"text\\\" data-validate=\\\"$notEmpty; $numeric;\\\" data-validate-option=\\\"$lazy; $event(type=keyup)\\\" />\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The default value from the target set to be used when no explicit mapping for a source value is given.\", options) : helperMissing.call(depth0, \"__\", \"The default value from the target set to be used when no explicit mapping for a source value is given.\", options)))\n    + \"</span>\\r\\n    </div>\\r\\n</div>\\r\\n<div class=\\\"response-mapping-info\";\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.mappingDisabled), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n    <p class=\\\"feedback-info\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The mapping options are available when at least one map entry is defined.\", options) : helperMissing.call(depth0, \"__\", \"The mapping options are available when at least one map entry is defined.\", options)))\n    + \"</p>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\" data-editx=\\\"map\\\">\\r\\n    <label>\\r\\n        <input name=\\\"defineCorrect\\\" type=\\\"checkbox\\\" data-role=\\\"defineCorrect\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.defineCorrect), {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Define correct response\", options) : helperMissing.call(depth0, \"__\", \"Define correct response\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Define the correct response.\", options) : helperMissing.call(depth0, \"__\", \"Define the correct response.\", options)))\n    + \"</span>\\r\\n</div>\\r\\n\";\n  return buffer;\n  }\nfunction program4(depth0,data) {\n  \n  \n  return \" hidden\";\n  }\n\nfunction program6(depth0,data) {\n  \n  \n  return \" disabled=\\\"true\\\"\";\n  }\n\nfunction program8(depth0,data) {\n  \n  \n  return \" checked=\\\"checked\\\"\";\n  }\n\nfunction program10(depth0,data) {\n  \n  \n  return \"\\r\\n<hr/>\\r\\n\\r\\n<div class=\\\"panel feedbackRule-panel\\\"></div>\\r\\n\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Response identifier\", options) : helperMissing.call(depth0, \"__\", \"Response identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the choice. This identifier must not be used by any other response or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the choice. This identifier must not be used by any other response or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\"\\r\\n           name=\\\"identifier\\\"\\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n           placeholder=\\\"e.g. RESPONSE\\\"\\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Response processing\", options) : helperMissing.call(depth0, \"__\", \"Response processing\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select the way the response of your interaction should be processed\", options) : helperMissing.call(depth0, \"__\", \"Select the way the response of your interaction should be processed\", options)))\n    + \"</div>\\r\\n\\r\\n    <select name=\\\"template\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.templates), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </select>\\r\\n</div>\\r\\n\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.editMapping), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\\r\\n\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.editFeedbacks), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/modalFeedback/rule', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n            <option value=\\\"\";\n  if (helper = helpers.name) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.name); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = (helper = helpers.equal || (depth0 && depth0.equal),options={hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data},helper ? helper.call(depth0, (depth0 && depth0.name), (depth1 && depth1.condition), options) : helperMissing.call(depth0, \"equal\", (depth0 && depth0.name), (depth1 && depth1.condition), options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n            \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\nfunction program4(depth0,data) {\n  \n  \n  return \"style=\\\"display:none\\\"\";\n  }\n\nfunction program6(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\r\\n    <a title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add else feedback\", options) : helperMissing.call(depth0, \"__\", \"Add else feedback\", options)))\n    + \"\\\" href=\\\"#\\\" class=\\\"adder feedbackRule-add-else\\\">else</a>\\r\\n    \";\n  return buffer;\n  }\n\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\r\\n     <div class=\\\"feedbackRule-then-else\\\">\\r\\n            <span class=\\\"feedbackRule-desc i\\\">else</span>\\r\\n            <button class=\\\"btn-info small\\\" type=\\\"button\\\" data-feedback=\\\"else\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Feedback\", options) : helperMissing.call(depth0, \"__\", \"Feedback\", options)))\n    + \"</button>\\r\\n            <span class=\\\"feedbackRule-button-delete icon-bin\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Delete else statement\", options) : helperMissing.call(depth0, \"__\", \"Delete else statement\", options)))\n    + \"\\\" data-role=\\\"else\\\"></span>\\r\\n        </div>\\r\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"feedbackRule-container\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <div class=\\\"feedbackRule-rule-if\\\">\\r\\n        <span class=\\\"feedbackRule-desc i\\\">if</span>\\r\\n        <select class=\\\"feedbackRule-condition select2\\\" data-has-search=\\\"false\\\">\\r\\n            \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.availableConditions), {hash:{},inverse:self.noop,fn:self.programWithDepth(1, program1, data, depth0),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </select>\\r\\n        <input class=\\\"feedbackRule-compared-value score\\\" type=\\\"text\\\" value=\\\"\";\n  if (helper = helpers.comparedValue) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.comparedValue); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.hideScore), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n    </div>\\r\\n    <div class=\\\"feedbackRule-then-else\\\">\\r\\n        <span class=\\\"feedbackRule-desc i\\\">then</span>\\r\\n        <button class=\\\"btn-info small\\\" type=\\\"button\\\" data-feedback=\\\"then\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Feedback\", options) : helperMissing.call(depth0, \"__\", \"Feedback\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.addElse), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.feedbackElse), {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <span class=\\\"feedbackRule-button-delete icon-bin\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Delete this modal feedback\", options) : helperMissing.call(depth0, \"__\", \"Delete this modal feedback\", options)))\n    + \"\\\" data-role=\\\"rule\\\"></span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/modalFeedback/panel', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<h3 class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Modal Feedbacks\", options) : helperMissing.call(depth0, \"__\", \"Modal Feedbacks\", options)))\n    + \"</h3>\\r\\n<span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n<span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Modal feedback is shown to the candidate directly following response processing.\", options) : helperMissing.call(depth0, \"__\", \"Modal feedback is shown to the candidate directly following response processing.\", options)))\n    + \"</span>\\r\\n<div class=\\\"feedbackRules\\\">\\r\\n    <p><i>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"None defined yet.\", options) : helperMissing.call(depth0, \"__\", \"None defined yet.\", options)))\n    + \"</i></p>\\r\\n</div>\\r\\n<a href=\\\"#\\\" class=\\\"adder feedbackRule-add\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add a modal feedback\", options) : helperMissing.call(depth0, \"__\", \"Add a modal feedback\", options)))\n    + \"</a>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'ui/tooltip'\r\n], function($, _, formElement, Element){\r\n\r\n    var _scoreTooltipContent = {\r\n        required : 'this is required',\r\n        invalid : 'the score format is not numeric'\r\n    };\r\n\r\n    var formElementHelper = {\r\n        init : function(widget){\r\n            formElement.initWidget(widget.$form);\r\n        },\r\n\r\n        /**\r\n         * Helps you to synchrnonize min/max widgets so the min isn't greater than the max, etc.\r\n         * @param {Object} widget - the interacion's widget (where widget.element is the interaction)\r\n         * @param {String} [attributeNameMin = minChoices] - the name of the min field and attribute\r\n         * @param {String} [attributeNameMax = maxChoices] - the name of the max field and attribute\r\n         * @param {Function} [getMax = _.size] - how to get the max value from the choices lists (in attributes)\r\n         */\r\n        syncMaxChoices : function(widget, attributeNameMin, attributeNameMax, getMax){\r\n\r\n            attributeNameMin = attributeNameMin || 'minChoices';\r\n            attributeNameMax = attributeNameMax || 'maxChoices';\r\n            getMax = getMax || _.size;\r\n            var $min = widget.$form.find('input[name=' + attributeNameMin + ']'),\r\n                $max = widget.$form.find('input[name=' + attributeNameMax + ']');\r\n\r\n            var _syncMaxChoices = function(){\r\n                var newOptions = {max : getMax(widget.element.getChoices())};\r\n                $min.incrementer('options', newOptions).keyup();\r\n                $max.incrementer('options', newOptions).keyup();\r\n            };\r\n\r\n            widget.on('choiceCreated', function(data){\r\n\r\n                if(data.interaction.serial === widget.element.serial){\r\n                    _syncMaxChoices();\r\n                }\r\n\r\n            }).on('deleted', function(data){\r\n\r\n                if(data.parent.serial === widget.element.serial &&\r\n                    Element.isA(data.element, 'choice')){\r\n\r\n                    _syncMaxChoices();\r\n                }\r\n            });\r\n\r\n        },\r\n\r\n        //set float (used for score)\r\n        setScore : function($scoreInput, options){\r\n            options = _.defaults(options || {}, {\r\n                required : false,\r\n                empty : function(){\r\n                },\r\n                set : function(){\r\n                },\r\n                key : function(){\r\n                    return $(this).attr('name');\r\n                },\r\n                tooltipContent : _scoreTooltipContent\r\n            });\r\n\r\n            if($scoreInput.data('hasqtip') === undefined){\r\n                $scoreInput.qtip({\r\n                    show: {\r\n                        event : 'custom'\r\n                    },\r\n                    hide: {\r\n                        event : 'custom'\r\n                    },\r\n                    theme : 'error',\r\n                    position: {\r\n                        container: $scoreInput.parent()\r\n                    },\r\n                    content: {\r\n                        text: ''\r\n                    }\r\n                });\r\n            }\r\n\r\n            var value = $scoreInput.val(),\r\n                score = parseFloat(value),\r\n                key = options.key.call($scoreInput[0]);\r\n\r\n            if(value === ''){\r\n                if(options.required){\r\n                    //missing required score value!\r\n                    $scoreInput.qtip('set', 'content.text', options.tooltipContent.required);\r\n                    $scoreInput.qtip('show');\r\n                }else{\r\n                    $scoreInput.qtip('hide');\r\n                    options.empty(key);\r\n                }\r\n            }else if(!isNaN(score)){\r\n                //is a correct number\r\n                $scoreInput.qtip('hide');\r\n                options.set(key, score);\r\n            }else{\r\n                //invalid input!\r\n                $scoreInput.qtip('set', 'content.text', options.tooltipContent.invalid);\r\n                $scoreInput.qtip('show');\r\n            }\r\n\r\n        }\r\n        //set text (used for controlled pattern, especially id)\r\n    };\r\n\r\n    return formElementHelper;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/modalFeedbackConditions',[\r\n    'lodash',\r\n    'i18n',\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/editor/response/choiceSelector'\r\n], function(_, __, $, formElement, choiceSelector){\r\n    \r\n    'use strict';\r\n    \r\n    var _ns = '.modal-feedback-condition';\r\n    \r\n    var _availableConditions = [\r\n        {\r\n            name : 'correct',\r\n            label : __('correct'),\r\n            init : hideScore,\r\n            onSet : onSetScore,\r\n            onUnset : onUnsetCorrect\r\n        },\r\n        {\r\n            name : 'incorrect',\r\n            label : __('incorrect'),\r\n            init : hideScore,\r\n            onSet : onSetScore,\r\n            onUnset : onUnsetCorrect\r\n        },\r\n        {\r\n            name : 'choices',\r\n            label : __('choices'),\r\n            init : function initChoice(fbRule, $select){\r\n                hideScore(fbRule, $select);\r\n                var condition = this.name;\r\n                var response = fbRule.comparedOutcome;\r\n                var interaction = response.getInteraction();\r\n                var $choiceSelectorContainer = $('<div>', {'class' : 'choiceSelectorContainer'}).insertAfter($select);\r\n\r\n                var cSelector = choiceSelector({\r\n                    renderTo : $choiceSelectorContainer,\r\n                    interaction : interaction,\r\n                    choices : fbRule.comparedValue || [],\r\n                    titleLength : 30\r\n                });\r\n                $choiceSelectorContainer.data('choice-selector', cSelector);\r\n\r\n                cSelector.on('change', function(selectedChoices){\r\n                    response.setCondition(fbRule, condition, selectedChoices || []);\r\n                });\r\n\r\n            },\r\n            onSet : function onSetChoices(fbRule, $select){\r\n                var response = fbRule.comparedOutcome;\r\n                var interaction = response.getInteraction();\r\n                var choice;\r\n                var intialValue = [];\r\n                if(!response.isCardinality(['multiple', 'ordered'])){\r\n                    choice = _.head(_.values(interaction.getChoices()));\r\n                    if(choice){\r\n                        intialValue = [choice];//a single cardinality response comparison requires a choice selected\r\n                    }\r\n                }\r\n                fbRule.comparedOutcome.setCondition(fbRule, this.name, intialValue);\r\n            },\r\n            onUnset : function onUnsetChoices(fbRule, $select){\r\n                //this needs to be executed to restore the feedback rule value\r\n                _resetScore(fbRule, $select);\r\n                this.destroy($select);\r\n            },\r\n            destroy : function($select){\r\n                var $cContainer = $select.next('.choiceSelectorContainer');\r\n                var choiceSelector = $cContainer.data('choice-selector');\r\n                if(choiceSelector){\r\n                    choiceSelector.destroy();\r\n                    $cContainer.remove();\r\n                }\r\n            },\r\n            filter : function filterChoices(response){\r\n                var interaction = response.getInteraction();\r\n                return (interaction.is('choiceInteraction') || interaction.is('inlineChoiceInteraction'));\r\n            }\r\n        },\r\n        {\r\n            name : 'lt',\r\n            label : '<',\r\n            init : initCompare,\r\n            onSet : onSetScore\r\n        },\r\n        {\r\n            name : 'lte',\r\n            label : '<=',\r\n            init : initCompare,\r\n            onSet : onSetScore\r\n        },\r\n        {\r\n            name : 'equal',\r\n            label : '=',\r\n            init : initCompare,\r\n            onSet : onSetScore\r\n        },\r\n        {\r\n            name : 'gte',\r\n            label : '>=',\r\n            init : initCompare,\r\n            onSet : onSetScore\r\n        },\r\n        {\r\n            name : 'gt',\r\n            label : '>',\r\n            init : initCompare,\r\n            onSet : onSetScore\r\n        }\r\n    ];\r\n    \r\n    function _resetScore(fbRule, $select){\r\n        $select.siblings('.feedbackRule-compared-value').val('0');\r\n    }\r\n\r\n    function onSetScore(fbRule, $select){\r\n        var response = fbRule.comparedOutcome;\r\n        var condition = this.name;\r\n        var $comparedValue = $select.siblings('.feedbackRule-compared-value');\r\n        formElement.setScore($comparedValue, {\r\n            required : true,\r\n            set : function(key, value){\r\n                response.setCondition(fbRule, condition, value);\r\n            }\r\n        });\r\n    }\r\n\r\n    function onUnsetCorrect(fbRule, $select){\r\n        _resetScore(fbRule, $select);\r\n    }\r\n\r\n    function initCompare(fbRule, $select){\r\n\r\n        var response = fbRule.comparedOutcome;\r\n        $select.siblings('.feedbackRule-compared-value')\r\n            .show()\r\n            .off('keyup' + _ns)\r\n            .on('keyup' + _ns, '.feedbackRule-compared-value', function(){\r\n\r\n                var fbRule = response.getFeedbackRule($(this).parents('.feedbackRule-container').data('serial'));\r\n\r\n                formElement.setScore($(this), {\r\n                    required : true,\r\n                    set : function(key, value){\r\n                        response.setCondition(fbRule, fbRule.condition, value);\r\n                    }\r\n                });\r\n            });\r\n    }\r\n\r\n    function hideScore(fbRule, $select){\r\n        $select.siblings('.feedbackRule-compared-value').hide();\r\n\r\n    }\r\n    \r\n    function getAvailableConditions(response){\r\n\r\n        return _.filter(_availableConditions, function(condition){\r\n            if(_.isFunction(condition.filter)){\r\n                return condition.filter(response);\r\n            }\r\n            return true;//accept by default\r\n        });\r\n    }\r\n    \r\n    return  {\r\n        get : getAvailableConditions\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/modalFeedbackRule',[\r\n    'lodash',\r\n    'jquery',\r\n    'ui/selecter',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/modalFeedback/rule',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/modalFeedback/panel',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/modalFeedbackConditions'\r\n], function(_, $, selecter, ruleTpl, panelTpl, modalFeedbackConditions){\r\n    'use strict';\r\n\r\n    var _renderFeedbackRule = function(feedbackRule){\r\n\r\n        var feedbackElseSerial,\r\n            feedbackElse = feedbackRule.feedbackElse,\r\n            addElse = !feedbackElse;\r\n\r\n        if(feedbackElse){\r\n            feedbackElseSerial = feedbackElse.serial;\r\n        }\r\n        var availableConditions = modalFeedbackConditions.get(feedbackRule.comparedOutcome);\r\n        var rule =  ruleTpl({\r\n            availableConditions : availableConditions,\r\n            serial : feedbackRule.serial,\r\n            condition : feedbackRule.condition,\r\n            comparedValue : feedbackRule.comparedValue,\r\n            feedbackThen : feedbackRule.feedbackThen.serial,\r\n            feedbackElse : feedbackElseSerial,\r\n            addElse : addElse,\r\n            hideScore : (feedbackRule.condition === 'correct' || feedbackRule.condition === 'incorrect' || feedbackRule.condition === 'choices')//@todo remove this, put in init()\r\n        });\r\n\r\n        var $rule = $(rule);\r\n\r\n        selecter($rule);\r\n\r\n        //init rule editing\r\n        var condition = _.find(availableConditions, {name : feedbackRule.condition});\r\n        condition.init(feedbackRule, $rule.find('select.feedbackRule-condition'));\r\n\r\n        return $rule;\r\n    };\r\n\r\n    var _initFeedbackEventListener = function($feedbacksPanel, response){\r\n\r\n        var $feedbacks = $feedbacksPanel.find('.feedbackRules');\r\n        $feedbacksPanel.on('click', '.feedbackRule-add', function(e){\r\n            e.preventDefault();\r\n\r\n            var feedbackRule = response.createFeedbackRule(),\r\n                $lastRule = $feedbacks.children('.feedbackRule-container:last');\r\n\r\n            if($lastRule.length){\r\n                $lastRule.after(_renderFeedbackRule(feedbackRule));\r\n            }else{\r\n                $feedbacks.html(_renderFeedbackRule(feedbackRule));\r\n            }\r\n        }).on('click', '.feedbackRule-add-else', function(e){\r\n\r\n            e.preventDefault();\r\n\r\n            var $fbContainer = $(this).parents('.feedbackRule-container'),\r\n                fbSerial = $fbContainer.data('serial'),\r\n                fbRule = response.getFeedbackRule(fbSerial),\r\n                fbModal = response.createFeedbackElse(fbRule);\r\n\r\n            $fbContainer.replaceWith(_renderFeedbackRule(fbRule));\r\n\r\n        }).on('click', '.feedbackRule-button-delete', function(){\r\n            \r\n            var $deleteButton = $(this),\r\n                $fbContainer = $deleteButton.parents('.feedbackRule-container'),\r\n                fbSerial = $fbContainer.data('serial'),\r\n                fbRule = response.getFeedbackRule(fbSerial);\r\n\r\n            switch($deleteButton.data('role')){\r\n                case 'rule':\r\n                    response.deleteFeedbackRule(fbRule);\r\n                    $fbContainer.remove();\r\n                    break;\r\n                case 'else':\r\n                    response.deleteFeedbackElse(fbRule);\r\n                    $fbContainer.replaceWith(_renderFeedbackRule(fbRule));//replace all to display the add \"else\" button\r\n                    break;\r\n            }\r\n        }).on('change', '.feedbackRule-condition', function(){\r\n\r\n            var $select = $(this),\r\n                condition = $select.val(),\r\n                availableConditions = modalFeedbackConditions.get(response),\r\n                fbRule = response.getFeedbackRule($(this).parents('.feedbackRule-container').data('serial')),\r\n                newCondition = _.find(availableConditions, {name : condition}),\r\n                oldCondition = _.find(availableConditions, {name : fbRule.condition});\r\n\r\n            //exec unset old condition callback\r\n            if(oldCondition && _.isFunction(oldCondition.onUnset)){\r\n                oldCondition.onUnset(fbRule, $select);\r\n            }\r\n\r\n            //exec set new condition callback\r\n            if(newCondition && _.isFunction(newCondition.onSet)){\r\n                newCondition.onSet(fbRule, $select);\r\n            }\r\n\r\n            //init the new condition editing\r\n            newCondition.init(fbRule, $select);\r\n\r\n        }).on('click', '[data-feedback]', function(){\r\n\r\n            var $btn = $(this),\r\n                fbRule = response.getFeedbackRule($btn.parents('.feedbackRule-container').data('serial')),\r\n                modalFeedback,\r\n                modalFeedbackWidget;\r\n\r\n            switch($btn.data('feedback')){\r\n                case 'then':\r\n                    modalFeedback = fbRule.feedbackThen;\r\n                    break;\r\n                case 'else':\r\n                    modalFeedback = fbRule.feedbackElse;\r\n                    break;\r\n            }\r\n\r\n            if(modalFeedback){\r\n                //show modal feedback editor:\r\n                modalFeedbackWidget = _getModalFeedbackWidget(modalFeedback);\r\n                modalFeedbackWidget.changeState('active');\r\n            }\r\n\r\n        });\r\n\r\n    };\r\n\r\n    var _widgets = {};\r\n\r\n    var _getModalFeedbackWidget = function(modalFeedback){\r\n\r\n        var $feedbacksContainer = $('#modalFeedbacks');\r\n        if(!_widgets[modalFeedback.serial]){\r\n            $feedbacksContainer.append(modalFeedback.render());\r\n            modalFeedback.postRender();\r\n            _widgets[modalFeedback.serial] = modalFeedback.data('widget');\r\n        }\r\n\r\n        return _widgets[modalFeedback.serial];\r\n    };\r\n\r\n    return {\r\n        initFeedbacksPanel : function($feedbacksPanel, response){\r\n\r\n            $feedbacksPanel.html(panelTpl());\r\n\r\n            var $feedbackRules = $feedbacksPanel.find('.feedbackRules'),\r\n                feedbackRules = response.getFeedbackRules();\r\n\r\n            if(feedbackRules && _.size(feedbackRules)){\r\n                $feedbackRules.empty();\r\n                _.each(feedbackRules, function(feedbackRule){\r\n                    $feedbackRules.append(_renderFeedbackRule(feedbackRule));\r\n                });\r\n            }\r\n\r\n            _initFeedbackEventListener($feedbacksPanel, response);\r\n        },\r\n        renderFeedbackRule : _renderFeedbackRule\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiItem/helper/response',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/response/responseForm',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/modalFeedbackRule'\r\n], function($, _, __, responseHelper, formElement, responseFormTpl, modalFeedbackRule){\r\n    'use strict';\r\n\r\n    var _saveCallbacks = {\r\n        mappingAttr : function mappingAttr(response, value, key){\r\n            if(value === ''){\r\n                response.removeMappingAttribute(key);\r\n            }else{\r\n                response.setMappingAttribute(key, value);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the list of all available response processing templates available in the plateform\r\n     * @returns {Object}\r\n     */\r\n    var getAvailableTemplates = function getAvailableTemplates(){\r\n        return {\r\n            'CUSTOM' : __('custom'),\r\n            'MATCH_CORRECT' : __('match correct'),\r\n            'MAP_RESPONSE' : __('map response'),\r\n            'MAP_RESPONSE_POINT' : __('map response'),\r\n            'NONE' : __('none')\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Get available rp templates according to interaction type and response processing type\r\n     *\r\n     * @param {Object} interaction - standard interaction object model\r\n     * @param {Array} [filteredTemplates] - shorted listed of templates the interaction can use\r\n     * @returns {Object} templates\r\n     */\r\n    var _getAvailableRpTemplates = function _getAvailableRpTemplates(interaction, filteredTemplates){\r\n\r\n        var rp = interaction.getRelatedItem().responseProcessing;\r\n        var allTemplates = getAvailableTemplates();\r\n        var templates = {};\r\n        if(!_.isEmpty(filteredTemplates)){\r\n            _.forEach(filteredTemplates, function(templateName){\r\n                if(allTemplates[templateName]){\r\n                    templates[templateName] = allTemplates[templateName];\r\n                }\r\n            });\r\n        }else{\r\n            templates = allTemplates;\r\n        }\r\n\r\n        switch(interaction.qtiClass){\r\n            case 'orderInteraction':\r\n            case 'graphicOrderInteraction':\r\n            case 'extendedTextInteraction':\r\n            case 'sliderInteraction':\r\n            case 'uploadInteraction':\r\n            case 'mediaInteraction':\r\n            case 'endAttemptInteraction':\r\n                delete templates.MAP_RESPONSE;\r\n                delete templates.MAP_RESPONSE_POINT;\r\n                break;\r\n            case 'selectPointInteraction':\r\n                delete templates.MATCH_CORRECT;\r\n                delete templates.MAP_RESPONSE;\r\n                break;\r\n            default:\r\n                delete templates.MAP_RESPONSE_POINT;\r\n        }\r\n\r\n        if(rp.processingType === 'templateDriven'){\r\n            delete templates.CUSTOM;\r\n        }else{\r\n            //consider as custom\r\n        }\r\n\r\n        return templates;\r\n    };\r\n\r\n    var answerStateHelper = {\r\n        /**\r\n         * forward to one of the available sub-state of the answer, according to the response processing template\r\n         * @param {Object} widget\r\n         */\r\n        forward : function forward(widget){\r\n\r\n            var response = widget.element.getResponseDeclaration();\r\n            if(responseHelper.isUsingTemplate(response, 'MATCH_CORRECT')){\r\n\r\n                widget.changeState('correct');\r\n\r\n            }else if(responseHelper.isUsingTemplate(response, 'MAP_RESPONSE') ||\r\n                responseHelper.isUsingTemplate(response, 'MAP_RESPONSE_POINT')){\r\n\r\n                widget.changeState('map');\r\n            }else if(responseHelper.isUsingTemplate(response, 'NONE')){\r\n\r\n                widget.changeState('norp');\r\n            }else{\r\n\r\n                widget.changeState('custom');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Allow getting and setting the possibility to define the correct response in the map response mode\r\n         * @param {Object} response - standard response object\r\n         * @param {boolean} [newDefineCorrectActive] - set the possibility or not to define the correct response\r\n         * @returns {boolean}\r\n         */\r\n        defineCorrect : function defineCorrect(response, newDefineCorrectActive){\r\n\r\n            var defineCorrectActive = false,\r\n                template = responseHelper.getTemplateNameFromUri(response.template),\r\n                corrects = response.getCorrect();\r\n\r\n            if(_.isUndefined(newDefineCorrectActive)){\r\n                //get:\r\n\r\n                if(template === 'MAP_RESPONSE' || template === 'MAP_RESPONSE_POINT'){\r\n\r\n                    if(!_.isUndefined(response.data('defineCorrect'))){\r\n                        defineCorrectActive = !!response.data('defineCorrect');\r\n                    }else{\r\n                        //infer it :\r\n                        defineCorrectActive = (corrects && _.size(corrects));\r\n                        response.data('defineCorrect', defineCorrectActive);//set it\r\n                    }\r\n\r\n                }else if(template === 'MATCH_CORRECT'){\r\n                    defineCorrectActive = true;\r\n                }\r\n\r\n            }else{\r\n                //set:\r\n                if(!newDefineCorrectActive){\r\n                    //empty correct response\r\n                    response.correctResponse = [];\r\n                }\r\n                response.data('defineCorrect', newDefineCorrectActive);\r\n            }\r\n\r\n            return defineCorrectActive;\r\n        },\r\n\r\n        /**\r\n         * Init the response form the interaction answer state\r\n         * @param {Object} widget\r\n         * @param {Object} [options]\r\n         * @param {Array} [options.rpTemplates] - the array of response processing templates name to be used\r\n         */\r\n        initResponseForm : function initResponseForm(widget, options){\r\n\r\n            var interaction = widget.element,\r\n                item = interaction.getRelatedItem(),\r\n                rp = item.responseProcessing,\r\n                response = interaction.getResponseDeclaration(),\r\n                template = responseHelper.getTemplateNameFromUri(response.template),\r\n                editMapping = (_.indexOf(['MAP_RESPONSE', 'MAP_RESPONSE_POINT'], template) >= 0),\r\n                defineCorrect = answerStateHelper.defineCorrect(response);\r\n\r\n            var _toggleCorrectWidgets = function(show){\r\n\r\n                var $correctWidgets = widget.$container.find('[data-edit=correct]');\r\n\r\n                if(show){\r\n                    $correctWidgets.show();\r\n                }else{\r\n                    $correctWidgets.hide();\r\n                }\r\n            };\r\n\r\n            options = _.defaults(options || {}, {\r\n                rpTemplates : []\r\n            });\r\n\r\n            if(!template || rp.processingType === 'custom'){\r\n                template = 'CUSTOM';\r\n            }\r\n\r\n            widget.$responseForm.html(responseFormTpl({\r\n                identifier : response.id(),\r\n                serial : response.getSerial(),\r\n                defineCorrect : defineCorrect,\r\n                editMapping : editMapping,\r\n                editFeedbacks : (template !== 'CUSTOM'),\r\n                mappingDisabled: _.isEmpty(response.mapEntries),\r\n                template : template,\r\n                templates : _getAvailableRpTemplates(interaction, options.rpTemplates),\r\n                defaultValue : response.getMappingAttribute('defaultValue'),\r\n                lowerBound : response.getMappingAttribute('lowerBound'),\r\n                upperBound : response.getMappingAttribute('upperBound')\r\n            }));\r\n            widget.$responseForm.find('select[name=template]').val(template);\r\n\r\n            if(editMapping){\r\n                _toggleCorrectWidgets(defineCorrect);\r\n            }\r\n\r\n            formElement.setChangeCallbacks(widget.$responseForm, response, {\r\n                identifier : function(res, value){\r\n                    response.id(value);\r\n                    interaction.attr('responseIdentifier', value);\r\n                },\r\n                defaultValue : _saveCallbacks.mappingAttr,\r\n                lowerBound : _saveCallbacks.mappingAttr,\r\n                upperBound : _saveCallbacks.mappingAttr,\r\n                template : function(res, value){\r\n\r\n                    rp.setProcessingType('templateDriven');\r\n                    response.setTemplate(value);\r\n                    answerStateHelper.forward(widget);\r\n                    answerStateHelper.initResponseForm(widget);\r\n                },\r\n                defineCorrect : function(res, value){\r\n\r\n                    _toggleCorrectWidgets(value);\r\n                    answerStateHelper.defineCorrect(response, !!value);\r\n                }\r\n            });\r\n\r\n            modalFeedbackRule.initFeedbacksPanel($('.feedbackRule-panel', widget.$responseForm), response);\r\n\r\n            widget.$responseForm.trigger('initResponseForm');\r\n\r\n            formElement.initWidget(widget.$responseForm);\r\n        },\r\n\r\n        /**\r\n         * Check if any correct response is defined\r\n         * @param {Object} widget\r\n         * @returns {Boolean}\r\n         */\r\n        isCorrectDefined : function isCorrectDefined(widget){\r\n            var response = widget.element.getResponseDeclaration();\r\n            return !!_.size(response.getCorrect());\r\n        }\r\n    };\r\n\r\n    return answerStateHelper;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Answer',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Answer',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/content'\r\n], function(stateFactory, Answer, answerStateHelper, contentHelper){\r\n    'use strict';\r\n\r\n    var InteractionStateAnswer = stateFactory.create(Answer, function initInteractionStateAnswer(){\r\n\r\n        //add class runtime to display hover style\r\n        this.widget.$container.addClass('runtime');\r\n\r\n        this.initResponseForm();\r\n\r\n        answerStateHelper.forward(this.widget);\r\n\r\n        this.widget.$responseForm.show();\r\n\r\n        contentHelper.changeInnerWidgetState(this.widget, 'inactive');\r\n\r\n    }, function exitInteractionStateAnswer(){\r\n\r\n        //remove runtime style\r\n        this.widget.$container.removeClass('runtime');\r\n\r\n        this.widget.$responseForm.empty().hide();\r\n        \r\n        contentHelper.changeInnerWidgetState(this.widget, 'sleep');\r\n    });\r\n\r\n    //default initResponseForm will intialize the common form applicable to most of the interactions\r\n    //some exception might be stringInteractions that require additional baseType selection\r\n    //therfore, in the case of stringInteractions, please overwrite the prototype function with a new implementation\r\n    InteractionStateAnswer.prototype.initResponseForm = function initResponseForm(){\r\n        answerStateHelper.initResponseForm(this.widget);\r\n    };\r\n\r\n    return InteractionStateAnswer;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Correct',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct'\r\n], function(stateFactory, Correct){\r\n\r\n    var InteractionStateCorrect = stateFactory.create(Correct, function(){\r\n        //use default [data-edit=\"correct\"].show();\r\n    }, function(){\r\n        //use default [data-edit=\"correct\"].hide();\r\n    });\r\n\r\n    return InteractionStateCorrect;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Map',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState'\r\n], function(stateFactory, Map, answerState){\r\n    'use strict';\r\n\r\n    var InteractionStateMap = stateFactory.create(Map, function(){\r\n        \r\n        var $correctWidgets = this.widget.$container.find('[data-edit=\"correct\"]');\r\n        \r\n        //check if the interaction response has a correct defined and show correct if so:\r\n        if(answerState.isCorrectDefined(this.widget)){\r\n            $correctWidgets.show();\r\n        }else{\r\n            $correctWidgets.hide();\r\n        }\r\n        \r\n    }, function(){\r\n        //plus, hide correct widget\r\n        this.widget.$container.find('[data-edit=\"correct\"]').hide();\r\n    });\r\n\r\n    return InteractionStateMap;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/states/NoRp',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/NoRp',\r\n    'taoQtiItem/qtiCreator/helper/xmlRenderer'\r\n], function(stateFactory, NoRp, xmlRenderer){\r\n    'use strict';\r\n\r\n    return stateFactory.create(NoRp, function initStateNoRp(){\r\n        var interaction = this.widget.element;\r\n        var item = interaction.getRelatedItem();\r\n        var rp = item.responseProcessing;\r\n        var rpXml = xmlRenderer.render(rp);\r\n\r\n        //remove outcome SCORE if there is no response processing\r\n        if(!rpXml.trim()){\r\n            item.removeOutcome('SCORE');\r\n            item.removeOutcome('MAXSCORE');\r\n        }\r\n\r\n    }, function exitStateNoRp(){\r\n        var interaction = this.widget.element;\r\n        var item = interaction.getRelatedItem();\r\n        var outcomeScore = item.getOutcomeDeclaration('SCORE');\r\n        var rp = item.responseProcessing;\r\n        var rpXml = xmlRenderer.render(rp);\r\n\r\n        //create the outcome score if rp required\r\n        if(rpXml && !outcomeScore){\r\n            outcomeScore = item.createOutcomeDeclaration({\r\n                cardinality : 'single',\r\n                baseType : 'float'\r\n            });\r\n            outcomeScore.buildIdentifier('SCORE', false);\r\n        }\r\n    });\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/states/Custom',['taoQtiItem/qtiCreator/widgets/states/factory'], function(stateFactory){\r\n    return stateFactory.create('custom', ['answer', 'active'], function(){\r\n        throw new Error('state \"custom\" prototype init method must be implemented');\r\n    },function(){\r\n        throw new Error('state \"custom\" prototype exit method must be implemented');\r\n    });\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/notifications/widgetOverlay', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<span class=\\\"message\\\">\";\n  if (helper = helpers.message) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.message); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\";\n  return buffer;\n  }\n\n  buffer += \"<span class=\\\"overlay\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.message), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/states/Custom',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Custom',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/notifications/widgetOverlay',\r\n    'i18n'\r\n], function(stateFactory, Custom, overlayTpl, __){\r\n\r\n    var InteractionStateCustom = stateFactory.create(Custom, function(){\r\n        //use default [data-edit=\"custom\"].show();\r\n        this.widget.$container.append(overlayTpl({\r\n            message : __('Custom Response Processing Mode')\r\n        }));\r\n        var $e = this.widget.$container.find('[data-edit=map], [data-edit=correct]').hide();\r\n        \r\n        //ok button z-index\r\n    }, function(){\r\n        //use default [data-edit=\"custom\"].hide();\r\n        this.widget.$container.children('.overlay').remove();\r\n    });\r\n\r\n    return InteractionStateCustom;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Active',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Answer',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/NoRp',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Custom'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Question',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/htmlEditorTrigger',\r\n    'i18n'\r\n], function($, stateFactory, Question, htmlEditor, contentHelper, promptToolbarTpl, __){\r\n    'use strict';\r\n\r\n    var BlockInteractionStateQuestion = stateFactory.extend(Question, function(){\r\n\r\n        this.buildPromptEditor();\r\n\r\n    }, function(){\r\n\r\n        this.destroyPromptEditor();\r\n    });\r\n\r\n    BlockInteractionStateQuestion.prototype.buildPromptEditor = function(){\r\n\r\n        var _widget = this.widget,\r\n            $editableContainer = _widget.$container.find('.qti-prompt-container'),\r\n            $editable = $editableContainer.find('.qti-prompt'),\r\n            container = _widget.element.prompt.getBody();\r\n\r\n        //@todo set them in the tpl\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n        $editable.attr('data-html-editable', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n\r\n            var $promptTlb = $(promptToolbarTpl({\r\n                serial : _widget.serial,\r\n                state : 'question'\r\n            }));\r\n\r\n            //add toolbar once only:\r\n            $editableContainer.append($promptTlb);\r\n            $promptTlb.show();\r\n\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                placeholder : __('define prompt'),\r\n                change : contentHelper.getChangeCallback(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _widget\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    BlockInteractionStateQuestion.prototype.destroyPromptEditor = function(){\r\n\r\n        var $editableContainer = this.widget.$container.find('.qti-prompt-container');\r\n        $editableContainer.find('.mini-tlb').remove();\r\n        htmlEditor.destroyEditor($editableContainer);\r\n    };\r\n\r\n    return BlockInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/associate', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, self=this, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"shuffle\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.shuffle), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shuffle choices\", options) : helperMissing.call(depth0, \"__\", \"Shuffle choices\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be “shuffled” of “fixed” individually.\", options) : helperMissing.call(depth0, \"__\", \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be “shuffled” of “fixed” individually.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Number of associations\", options) : helperMissing.call(depth0, \"__\", \"Number of associations\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div>\\r\\n        <label for=\\\"minAssociations\\\" class=\\\"spinner\\\">Min</label>\\r\\n        <input name=\\\"minAssociations\\\" value=\\\"\";\n  if (helper = helpers.minAssociations) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.minAssociations); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"100\\\" type=\\\"text\\\" />\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices that the candidate is required to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices that the candidate is required to select to form a valid response.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n    <div>\\r\\n        <label for=\\\"maxAssociations\\\" class=\\\"spinner\\\">Max</label>\\r\\n        <input name=\\\"maxAssociations\\\" value=\\\"\";\n  if (helper = helpers.maxAssociations) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxAssociations); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"100\\\" type=\\\"text\\\" />\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices that the candidate is allowed to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices that the candidate is allowed to select to form a valid response.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Question',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/associate',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter'\r\n], function(stateFactory, Question, formElement, formTpl, sizeAdapter){\r\n\r\n    'use strict';\r\n\r\n    var AssociateInteractionStateQuestion = stateFactory.extend(Question);\r\n\r\n    AssociateInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n       var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            interaction = _widget.element;\r\n\r\n        $form.html(formTpl({\r\n            shuffle : !!interaction.attr('shuffle'),\r\n            minAssociations : parseInt(interaction.attr('minAssociations')),\r\n            maxAssociations : parseInt(interaction.attr('maxAssociations'))\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n        \r\n        //init data change callbacks\r\n        var callbacks = formElement.getMinMaxAttributeCallbacks(this.widget.$form, 'minAssociations', 'maxAssociations');\r\n        callbacks.shuffle = formElement.getAttributeChangeCallback();\r\n        formElement.setChangeCallbacks($form, interaction, callbacks);\r\n        \r\n        //adapt size\r\n        sizeAdapter.adaptSize(_widget);\r\n        _widget.on('choiceCreated', function(){\r\n            sizeAdapter.adaptSize(_widget);\r\n        });\r\n    };\r\n    \r\n    return AssociateInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Choice',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter'\r\n], function(stateFactory, Choice, sizeAdapter){\r\n\r\n    'use strict';\r\n\r\n    var AssociateInteractionStateChoice = stateFactory.extend(Choice, function(){\r\n        \r\n        var widget = this.widget;\r\n        \r\n        widget.on('containerBodyChange contentChange choiceCreated', function(){\r\n            sizeAdapter.adaptSize(widget);\r\n        });\r\n        \r\n    }, function(){\r\n        \r\n    });\r\n\r\n    return AssociateInteractionStateChoice;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/ResponseWidget',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager'\r\n], function(_, __, commonRenderer, sizeAdapter, instructionMgr){\r\n\r\n    'use strict';\r\n\r\n    var ResponseWidget = {\r\n        create : function(widget, responseMappingMode){\r\n\r\n            var interaction = widget.element;\r\n\r\n            commonRenderer.resetResponse(interaction);\r\n            commonRenderer.destroy(interaction);\r\n\r\n            if(responseMappingMode){\r\n                instructionMgr.appendInstruction(widget.element, __('Please define association pairs and their scores below.'));\r\n                interaction.responseMappingMode = true;\r\n            }else{\r\n                instructionMgr.appendInstruction(widget.element, __('Please define the correct association pairs below.'));\r\n            }\r\n\r\n            commonRenderer.render(interaction);\r\n            \r\n            sizeAdapter.adaptSize(widget);\r\n        },\r\n        setResponse : function(interaction, response){\r\n            var responseDeclaration = interaction.getResponseDeclaration();\r\n            commonRenderer.setResponse(interaction, ResponseWidget.formatResponse(response, responseDeclaration.attr('cardinality')));\r\n            \r\n            sizeAdapter.adaptSize(interaction.data('widget'));\r\n            \r\n        },\r\n        destroy : function(widget){\r\n\r\n            var interaction = widget.element;\r\n\r\n            commonRenderer.resetResponse(interaction);\r\n            commonRenderer.destroy(interaction);\r\n\r\n            delete interaction.responseMappingMode;\r\n\r\n            commonRenderer.renderEmptyPairs(interaction);\r\n            \r\n            sizeAdapter.adaptSize(widget);\r\n        },\r\n        getResponseSummary : function(responseDeclaration){\r\n            \r\n            var pairs = [],\r\n                correctResponse = _.values(responseDeclaration.getCorrect()),\r\n                mapEntries = responseDeclaration.getMapEntries();\r\n            \r\n            _.each(correctResponse, function(pair) {\r\n\r\n                var sortedIdPair = pair.split(' ').sort(),\r\n                    sortedIdPairKey = sortedIdPair.join(' ');\r\n\r\n                pairs[sortedIdPairKey] = {\r\n                    pair: sortedIdPair,\r\n                    correct: true,\r\n                    score: undefined\r\n                };\r\n            });\r\n\r\n            _.forIn(mapEntries, function(score, pair) {\r\n\r\n                var sortedIdPair = pair.split(' ').sort(),\r\n                    sortedIdPairKey = sortedIdPair.join(' ');\r\n\r\n                if (!pairs[sortedIdPairKey]) {\r\n                    pairs[sortedIdPairKey] = {\r\n                        pair: sortedIdPair,\r\n                        correct: false,\r\n                        score: score\r\n                    };\r\n                } else {\r\n                    pairs[sortedIdPairKey].score = score;\r\n                }\r\n            });\r\n            \r\n            return pairs;\r\n        },\r\n        formatResponse : function(response, cardinality){\r\n\r\n            var formatedRes;\r\n            if(cardinality === 'single'){\r\n                formatedRes = {base : { pair : [] }};\r\n            } else {\r\n                formatedRes = {list : { pair : [] }};\r\n            }\r\n            \r\n            _.each(response, function(pairString){\r\n                var pair = pairString.split(' ');\r\n                if(cardinality === 'single'){\r\n                    formatedRes.base.pair = pair;\r\n                } else {\r\n                    formatedRes.list.pair.push(pair);\r\n                }\r\n            });\r\n\r\n            return formatedRes;\r\n        },\r\n        unformatResponse : function(formatedResponse){\r\n\r\n            var res = [];\r\n\r\n            if(formatedResponse.list && formatedResponse.list.pair){\r\n                _.each(formatedResponse.list.pair, function(pair){\r\n                    res.push(pair.join(' '));\r\n                });\r\n            }else if(formatedResponse.base && formatedResponse.base.pair){\r\n                res.push(formatedResponse.base.pair.join(' '));\r\n            }\r\n            return res;\r\n        }\r\n    };\r\n\r\n    return ResponseWidget;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Correct',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/ResponseWidget',\r\n    'lodash'\r\n], function(stateFactory, Correct, responseWidget, _){\r\n\r\n    var AssociateInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n\r\n        var interaction = this.widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        responseWidget.create(this.widget, false);\r\n        responseWidget.setResponse(interaction, _.values(response.getCorrect()));\r\n\r\n        this.widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            response.setCorrect(responseWidget.unformatResponse(data.response));\r\n        });\r\n\r\n    }, function(){\r\n\r\n        this.widget.$container.off('responseChange.qti-widget');\r\n\r\n        responseWidget.destroy(this.widget);\r\n    });\r\n\r\n    return AssociateInteractionStateCorrect;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/associableChoice.answer', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"mini-tlb\\\" data-edit=\\\"answer\\\" data-for=\\\"\";\n  if (helper = helpers.choiceSerial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choiceSerial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <label class=\\\"tlb-button right\\\" title=\\\"This answer is correct\\\" data-edit=\\\"correct\\\">\\r\\n        <input \\r\\n            type=\\\"checkbox\\\" \\r\\n            data-role=\\\"correct\\\"\\r\\n            name=\\\"correct_\";\n  if (helper = helpers.interactionSerial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.interactionSerial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"[]\\\" \\r\\n            value=\\\"\";\n  if (helper = helpers.choiceIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choiceIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n            \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.correct), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n    </label>\\r\\n    <label class=\\\"tlb-button right\\\" title=\\\"Score of this answer\\\" data-edit=\\\"map\\\">\\r\\n        <input value=\\\"\";\n  if (helper = helpers.score) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.score); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" data-role=\\\"score\\\" data-for=\\\"\";\n  if (helper = helpers.choiceIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choiceIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" name=\\\"score\\\" class=\\\"score\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\" />\\r\\n    </label>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Map',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/ResponseWidget',\r\n    'lodash',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/associableChoice.answer'\r\n], function($, stateFactory, Map, responseWidget, _, responseToolbarTpl){\r\n\r\n    'use strict';\r\n\r\n    var AssociateInteractionStateCorrect = stateFactory.create(Map, function(){\r\n\r\n        var _widget = this.widget,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        //init response widget in responseMapping mode:\r\n        responseWidget.create(_widget, true);\r\n\r\n        //start bind events to detect response changes:\r\n        this.bindResponseChangeListener();\r\n\r\n        //finally, apply defined correct response and response mapping:\r\n        responseWidget.setResponse(interaction, _.keys(responseWidget.getResponseSummary(response)));\r\n\r\n    }, function(){\r\n\r\n        this.widget.$container.off('responseChange.qti-widget');\r\n\r\n        responseWidget.destroy(this.widget);\r\n\r\n        this.widget.$container.find('.mini-tlb').remove();\r\n    });\r\n\r\n    AssociateInteractionStateCorrect.prototype.bindResponseChangeListener = function(){\r\n\r\n        var _widget = this.widget,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        //@todo to be mapped to actual value\r\n        var _defaultMappingValue = 0;\r\n\r\n        var _saveCorrect = function(){\r\n            var correct = [];\r\n            $('input[name=\"correct_' + _widget.serial + '[]\"]:checked').each(function(){\r\n                correct.push($(this).data('pairIdentifier'));\r\n            });\r\n            response.setCorrect(correct);\r\n        };\r\n\r\n        _widget.$container.on('responseChange.qti-widget', function(e, data, extraData){\r\n\r\n            var $miniToolbar;\r\n\r\n            if(extraData.type === 'added'){\r\n\r\n                //choice identifier pair:\r\n                var pair = [],\r\n                    pairs = [],\r\n                    $filled = extraData.$pair.children('.filled');\r\n\r\n                if($filled.length === 2){\r\n\r\n                    pairs = responseWidget.getResponseSummary(response);\r\n\r\n                    //the pair is complete:\r\n                    $filled.each(function(){\r\n\r\n                        var serial = $(this).data('serial'),\r\n                            choice = interaction.getChoice(serial);\r\n\r\n                        pair.push(choice.id());\r\n                    });\r\n\r\n                    pair.sort();\r\n\r\n                    var pairIdentifier = pair.join(' ');\r\n                    $miniToolbar = extraData.$pair.children('.mini-tlb');\r\n\r\n                    if(!$miniToolbar.length){\r\n\r\n                        //if does not exist yet, create it:\r\n                        extraData.$pair.append(responseToolbarTpl({\r\n                            interactionSerial : interaction.getSerial(),\r\n                            choiceSerial : 'n/a',\r\n                            choiceIdentifier : 'n/a'\r\n                        }));\r\n\r\n                        $miniToolbar = extraData.$pair.children('.mini-tlb');\r\n                    }\r\n                    $miniToolbar.show();\r\n                    $miniToolbar.data('pairIdentifier', pairIdentifier);\r\n\r\n                    var $correct = $miniToolbar.find('[data-role=correct]').data('pairIdentifier', pairIdentifier);\r\n                    if(pairs[pairIdentifier] && pairs[pairIdentifier].correct){\r\n                        $correct.prop('checked', true);\r\n                    }else{\r\n                        $correct.prop('checked', false);\r\n                    }\r\n\r\n                    var $score = $miniToolbar.find('[data-role=score]').data('pairIdentifier', pairIdentifier);\r\n                    if(pairs[pairIdentifier] && pairs[pairIdentifier].score){\r\n                        $score.val(pairs[pairIdentifier].score);\r\n                    }else{\r\n                        //@todo set _defaultMappingValue as placeholder text:\r\n                        $score.val(_defaultMappingValue);\r\n                    }\r\n                }\r\n\r\n            }else{\r\n\r\n                //reset and hide toolbar\r\n                $miniToolbar = extraData.$pair.children('.mini-tlb');\r\n                $miniToolbar.hide();\r\n\r\n                //before resetting the correct and score inputs, remove the current map entry from the response:\r\n                response.removeMapEntry($miniToolbar.data('pairIdentifier'));\r\n\r\n                $miniToolbar.removeData('pairIdentifier');\r\n                $miniToolbar.find('[data-role=correct]').prop('checked', false).removeData('pairIdentifier');\r\n                $miniToolbar.find('[data-role=score]').val(_defaultMappingValue).removeData('pairIdentifier');\r\n\r\n                //finally update the correct response\r\n                _saveCorrect();\r\n            }\r\n        });\r\n\r\n        _widget.$container.find('.result-area')\r\n            .on('change', '[data-role=correct]', _saveCorrect)\r\n            .on('keyup', '[data-role=score]', function(){\r\n            var $score = $(this);\r\n            response.setMapEntry($score.data('pairIdentifier'), $score.val());\r\n        });\r\n    };\r\n\r\n    return AssociateInteractionStateCorrect;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Map'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/states',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter'\r\n], function (Widget, states, sizeAdapter) {\r\n\r\n    'use strict';\r\n\r\n    var AssociateInteractionWidget = Widget.clone();\r\n\r\n    AssociateInteractionWidget.initCreator = function () {\r\n\r\n        this.registerStates(states);\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        sizeAdapter.adaptSize(this);\r\n\r\n    };\r\n\r\n    return AssociateInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/AssociateInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/AssociateInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/Widget'\r\n], function(_, AssociateInteraction, AssociateInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorAssociateInteraction = _.clone(AssociateInteraction);\r\n\r\n    CreatorAssociateInteraction.render = function(interaction, options){\r\n\r\n        AssociateInteraction.renderEmptyPairs(interaction);\r\n\r\n        AssociateInteractionWidget.build(\r\n            interaction,\r\n            AssociateInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorAssociateInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/choiceInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  \n  return \" horizontal\";\n  }\n\nfunction program9(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.listStyle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.listStyle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program11(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-choiceInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"choiceInteraction\\\">\\r\\n  \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n  <div class=\\\"instruction-container\\\"></div>\\r\\n  <ol class=\\\"plain block-listing solid choice-area\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.listStyle), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n      \";\n  options={hash:{},inverse:self.noop,fn:self.program(11, program11, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(11, program11, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n  </ol>\\r\\n  <div class=\\\"notification-container\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction',[\r\n    'lodash',\r\n    'jquery',\r\n    'i18n',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/choiceInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter'\r\n], function (_, $, __, tpl, containerHelper, instructionMgr, pciResponse, sizeAdapter) {\r\n    'use strict';\r\n\r\n    var KEY_CODE_SPACE = 32;\r\n    var KEY_CODE_ENTER = 13;\r\n    var KEY_CODE_LEFT  = 37;\r\n    var KEY_CODE_UP    = 38;\r\n    var KEY_CODE_RIGHT = 39;\r\n    var KEY_CODE_DOWN  = 40;\r\n\r\n    /**\r\n     * Propagate the checked state to the actual input.\r\n     * @type {Function}\r\n     * @param {jQuery} $choiceBox - list element with the class `.qti-choice`\r\n     * @param {Boolean} state\r\n     * @private\r\n     */\r\n    var _triggerInput = function _triggerInput($choiceBox, state){\r\n\r\n        var $input       = $choiceBox.find('input:radio,input:checkbox').not('[disabled]').not('.disabled');\r\n        var $choiceBoxes = $choiceBox.add($choiceBox.siblings());\r\n\r\n        if(!$input.length){\r\n            return;\r\n        }\r\n\r\n        if(!_.isBoolean(state)) {\r\n            state = !$input.prop('checked');\r\n        }\r\n\r\n        $input.prop('checked', state);\r\n        $input.trigger('change');\r\n\r\n        $choiceBoxes.removeClass('user-selected');\r\n        $choiceBoxes.find('input:checked').not('[disabled]').not('.disabled').parents('.qti-choice').addClass('user-selected');\r\n    };\r\n\r\n    /**\r\n     * 'pseudo-label' is technically a div that behaves like a label.\r\n     * This allows the usage of block elements inside the fake label\r\n     *\r\n     * @private\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {jQueryElement} $container\r\n     */\r\n    var _pseudoLabel = function _pseudoLabel(interaction, $container){\r\n        var inputSelector = '.qti-choice input:radio:not([disabled]):not(.disabled), .qti-choice input:checkbox:not([disabled]):not(.disabled)';\r\n        $container.off('.commonRenderer');\r\n\r\n        $container.on('keydown.commonRenderer.keyNavigation', inputSelector, function(e){\r\n            var $qtiChoice = $(this).closest('.qti-choice');\r\n            var keyCode = e.keyCode ? e.keyCode : e.charCode;\r\n\r\n            if (keyCode === KEY_CODE_UP || keyCode === KEY_CODE_LEFT){\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                $qtiChoice.prev('.qti-choice').find('input:radio,input:checkbox').not('[disabled]').not('.disabled').focus();\r\n            } else if (keyCode === KEY_CODE_DOWN || keyCode === KEY_CODE_RIGHT){\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                $qtiChoice.next('.qti-choice').find('input:radio,input:checkbox').not('[disabled]').not('.disabled').focus();\r\n            }\r\n        }).on('keyup.commonRenderer.keyNavigation', inputSelector, function(e){\r\n            var keyCode = e.keyCode ? e.keyCode : e.charCode;\r\n\r\n            if( keyCode === KEY_CODE_SPACE || keyCode === KEY_CODE_ENTER){\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                _triggerInput($(this).closest('.qti-choice'));\r\n            }\r\n        });\r\n\r\n        $container.on('click.commonRenderer', '.qti-choice', function(e){\r\n            var $choiceBox = $(this);\r\n            var state;\r\n            var eliminator = e.target.dataset && e.target.dataset.eliminable;\r\n            var input = this.querySelector('.real-label > input');\r\n\r\n            // if the click has been triggered by a keyboard check, prevent this listener to cancel this check\r\n            if (e.originalEvent && $(e.originalEvent.target).is('input')) {\r\n                return;\r\n            }\r\n\r\n            e.preventDefault();\r\n            e.stopPropagation();//required otherwise any tao scoped, form initialization might prevent it from working\r\n\r\n\r\n            if(!_.isUndefined(eliminator)) {\r\n                state = false;\r\n                if(eliminator === 'trigger') {\r\n                    this.classList.toggle('eliminated');\r\n                }\r\n            }\r\n\r\n            _triggerInput($choiceBox, state);\r\n\r\n            if(this.classList.contains('eliminated')) {\r\n                input.setAttribute('disabled', 'disabled');\r\n            }\r\n            else {\r\n                input.removeAttribute('disabled');\r\n            }\r\n\r\n            instructionMgr.validateInstructions(interaction, {choice : $choiceBox});\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Get the responses from the DOM.\r\n     * @private\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Array} the list of choices identifiers\r\n     */\r\n    var _getRawResponse = function _getRawResponse(interaction){\r\n        var values = [];\r\n        var $container = containerHelper.get(interaction);\r\n        $('.real-label > input[name=response-' + interaction.getSerial() + ']:checked', $container).each(function(){\r\n            values.push($(this).val());\r\n        });\r\n        return values;\r\n    };\r\n\r\n    /**\r\n     * Define the instructions for the interaction\r\n     * @private\r\n     * @param {Object} interaction - the interaction instance\r\n     */\r\n    var _setInstructions = function _setInstructions(interaction){\r\n\r\n        var min = interaction.attr('minChoices'),\r\n            max = interaction.attr('maxChoices'),\r\n            msg,\r\n            choiceCount = _.size(interaction.getChoices()),\r\n            minInstructionSet = false;\r\n\r\n        var highlightInvalidInput = function highlightInvalidInput($choice){\r\n            var $input = $choice.find('.real-label > input'),\r\n                $li = $choice.css('color', '#BA122B'),\r\n                $icon = $choice.find('.real-label > span').css('color', '#BA122B').addClass('cross error');\r\n            var timeout = interaction.data('__instructionTimeout');\r\n\r\n            if(timeout){\r\n                clearTimeout(timeout);\r\n            }\r\n            timeout = setTimeout(function(){\r\n                $input.prop('checked', false);\r\n                $li.removeAttr('style');\r\n                $icon.removeAttr('style').removeClass('cross');\r\n                $li.toggleClass('user-selected', false);\r\n                containerHelper.triggerResponseChangeEvent(interaction);\r\n            }, 150);\r\n            interaction.data('__instructionTimeout', timeout);\r\n        };\r\n\r\n        //if maxChoice = 1, use the radio group behaviour\r\n        //if maxChoice = 0, infinite choice possible\r\n        if(max > 1 && max < choiceCount){\r\n            if(max === min){\r\n                minInstructionSet = true;\r\n                msg = __('You must select exactly %s choices', max);\r\n                instructionMgr.appendInstruction(interaction, msg, function(data){\r\n                    if(_getRawResponse(interaction).length >= max){\r\n                        this.setLevel('success');\r\n                        if(this.checkState('fulfilled')){\r\n                            this.update({\r\n                                level : 'warning',\r\n                                message : __('Maximum choices reached'),\r\n                                timeout : 2000,\r\n                                start : function(){\r\n                                    if(data && data.choice){\r\n                                        highlightInvalidInput(data.choice);\r\n                                    }\r\n                                },\r\n                                stop : function(){\r\n                                    this.update({level : 'success', message : msg});\r\n                                }\r\n                            });\r\n                        }\r\n                        this.setState('fulfilled');\r\n                    }else{\r\n                        this.reset();\r\n                    }\r\n                });\r\n            }else if(max > min){\r\n                msg = max === 1 ? __('You can select maximum of 1 choice') : __('You can select maximum of %s choices', max);\r\n                instructionMgr.appendInstruction(interaction, msg, function(data){\r\n                    if(_getRawResponse(interaction).length >= max){\r\n                        this.setMessage(__('Maximum choices reached'));\r\n                        if(this.checkState('fulfilled')){\r\n                            this.update({\r\n                                level : 'warning',\r\n                                timeout : 2000,\r\n                                start : function(){\r\n                                    if(data && data.choice){\r\n                                        highlightInvalidInput(data.choice);\r\n                                    }\r\n                                },\r\n                                stop : function(){\r\n                                    this.setLevel('info');\r\n                                }\r\n                            });\r\n                        }\r\n                        this.setState('fulfilled');\r\n                    }else{\r\n                        this.reset();\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        if(!minInstructionSet && min > 0 && min < choiceCount){\r\n            msg = min === 1 ? __('You must select at least 1 choice') : __('You must select at least %s choices', min);\r\n            instructionMgr.appendInstruction(interaction, msg, function(){\r\n                if(_getRawResponse(interaction).length >= min){\r\n                    this.setLevel('success');\r\n                }else{\r\n                    this.reset();\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10278\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     */\r\n    var render = function render(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        _pseudoLabel(interaction, $container);\r\n\r\n        _setInstructions(interaction);\r\n\r\n        if(interaction.attr('orientation') === 'horizontal') {\r\n            sizeAdapter.adaptSize($('.add-option, .result-area .target, .choice-area .qti-choice', $container));\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset the responses previously set\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     */\r\n    var resetResponse = function resetResponse(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        $('.real-label > input', $container).prop('checked', false);\r\n    };\r\n\r\n    /**\r\n     * Set a new response to the rendered interaction.\r\n     * Please note that it does not reset previous responses.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10278\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {0bject} response - the PCI formated response\r\n     */\r\n    var setResponse = function setResponse(interaction, response){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        try{\r\n            _.forEach(pciResponse.unserialize(response, interaction), function(identifier){\r\n                var $input = $container.find('.real-label > input[value=' + identifier + ']').prop('checked', true);\r\n                $input.closest('.qti-choice').toggleClass('user-selected', true);\r\n            });\r\n            instructionMgr.validateInstructions(interaction);\r\n        }catch(e){\r\n            throw new Error('wrong response format in argument : ' + e);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10278\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the response formatted in PCI\r\n     */\r\n    var getResponse = function getResponse(interaction){\r\n        return pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    /**\r\n     * Check if a choice interaction is choice-eliminable\r\n     *\r\n     * @param {Object} interaction\r\n     * @returns {boolean}\r\n     */\r\n    var isEliminable = function isEliminable(interaction){\r\n        return (/\\beliminable\\b/).test(interaction.attr('class'));\r\n    };\r\n\r\n    /**\r\n     * Set additional data to the template (data that are not really part of the model).\r\n     * @param {Object} interaction - the interaction\r\n     * @param {Object} [data] - interaction custom data\r\n     * @returns {Object} custom data\r\n     */\r\n    var getCustomData = function getCustomData(interaction, data) {\r\n        var listStyles = (interaction.attr('class') || '').match(/\\blist-style-[\\w-]+/) || [];\r\n        return _.merge(data || {}, {\r\n            horizontal : (interaction.attr('orientation') === 'horizontal'),\r\n            listStyle: listStyles.pop(),\r\n            eliminable: isEliminable(interaction)\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Destroy the interaction by leaving the DOM exactly in the same state it was before loading the interaction.\r\n     * @param {Object} interaction - the interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        var timeout = interaction.data('__instructionTimeout');\r\n\r\n        if(timeout){\r\n            clearTimeout(timeout);\r\n        }\r\n\r\n        //remove event\r\n        $container.off('.commonRenderer');\r\n        $(document).off('.commonRenderer');\r\n\r\n        //remove instructions\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        var $container;\r\n\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n\r\n            $container = containerHelper.get(interaction);\r\n\r\n            //restore order of previously shuffled choices\r\n            if(_.isArray(state.order) && state.order.length === _.size(interaction.getChoices())){\r\n                $('.qti-simpleChoice', $container)\r\n                    .sort(function(a, b){\r\n                        var aIndex = _.indexOf(state.order, $(a).data('identifier'));\r\n                        var bIndex = _.indexOf(state.order, $(b).data('identifier'));\r\n                        if(aIndex > bIndex) {\r\n                            return 1;\r\n                        }\r\n                        if(aIndex < bIndex) {\r\n                            return -1;\r\n                        }\r\n                        return 0;\r\n                    })\r\n                    .detach()\r\n                    .appendTo($('.choice-area', $container));\r\n            }\r\n\r\n            //restore eliminated choices\r\n            if(isEliminable(interaction) && _.isArray(state.eliminated) && state.eliminated.length){\r\n                _.forEach(state.eliminated, function(identifier){\r\n                    $container.find('.qti-simpleChoice[data-identifier=' + identifier + ']').addClass('eliminated');\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n\r\n        //we store also the choice order if shuffled\r\n        if(interaction.attr('shuffle') === true){\r\n            state.order = [];\r\n            $('.qti-simpleChoice', $container).each(function(){\r\n                state.order.push($(this).data('identifier'));\r\n            });\r\n        }\r\n\r\n        //store the eliminated choices\r\n        if(isEliminable(interaction)){\r\n            state.eliminated = [];\r\n            $container.find('.qti-simpleChoice.eliminated').each(function(){\r\n                state.eliminated.push($(this).data('identifier'));\r\n            });\r\n        }\r\n\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the choice interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/ChoiceInteraction\r\n     */\r\n    return {\r\n        qtiClass:      'choiceInteraction',\r\n        template:      tpl,\r\n        getData:       getCustomData,\r\n        render:        render,\r\n        getContainer:  containerHelper.get,\r\n        setResponse:   setResponse,\r\n        getResponse:   getResponse,\r\n        resetResponse: resetResponse,\r\n        destroy:       destroy,\r\n        setState:      setState,\r\n        getState:      getState\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/choice', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, self=this, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"checked\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"shuffle\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.shuffle), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shuffle choices\", options) : helperMissing.call(depth0, \"__\", \"Shuffle choices\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be \\\"shuffled\\\" of \\\"fixed\\\" individually.\", options) : helperMissing.call(depth0, \"__\", \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be \\\"shuffled\\\" of \\\"fixed\\\" individually.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<hr/>\\r\\n<div class=\\\"panel\\\">\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed choices\", options) : helperMissing.call(depth0, \"__\", \"Allowed choices\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div>\\r\\n        <label for=\\\"minChoices\\\" class=\\\"spinner\\\">Min</label>\\r\\n        <input name=\\\"minChoices\\\" value=\\\"\";\n  if (helper = helpers.minChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.minChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices that the candidate is required to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices that the candidate is required to select to form a valid response.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n    <div>\\r\\n        <label for=\\\"maxChoices\\\" class=\\\"spinner\\\">Max</label>\\r\\n        <input name=\\\"maxChoices\\\" value=\\\"\";\n  if (helper = helpers.maxChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-zero=\\\"true\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices that the candidate is allowed to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices that the candidate is allowed to select to form a valid response.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n</div>\\r\\n<hr/>\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"eliminable\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.eliminable), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allow elimination\", options) : helperMissing.call(depth0, \"__\", \"Allow elimination\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If this box is checked the student will be able to eliminate choices.\", options) : helperMissing.call(depth0, \"__\", \"If this box is checked the student will be able to eliminate choices.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<hr/>\\r\\n\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"List Style\", options) : helperMissing.call(depth0, \"__\", \"List Style\", options)))\n    + \"</h3>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Use this if you want the list of choices to be prefixed (e.g. 1,2,3 a,b,c)\", options) : helperMissing.call(depth0, \"__\", \"Use this if you want the list of choices to be prefixed (e.g. 1,2,3 a,b,c)\", options)))\n    + \"\\r\\n        </span>\\r\\n\\r\\n    <select data-list-style/>\\r\\n</div>\\r\\n\\r\\n\\r\\n<hr/>\\r\\n<div class=\\\"panel\\\">\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Orientation\", options) : helperMissing.call(depth0, \"__\", \"Orientation\", options)))\n    + \"</h3>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Display the choices either horizontally or vertically\", options) : helperMissing.call(depth0, \"__\", \"Display the choices either horizontally or vertically\", options)))\n    + \"\\r\\n        </span>\\r\\n    <div>\\r\\n        <label class=\\\"smaller-prompt\\\">\\r\\n            <input type=\\\"radio\\\" name=\\\"orientation\\\" value=\\\"vertical\\\" \";\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n            <span class=\\\"icon-radio\\\"></span>\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Vertical\", options) : helperMissing.call(depth0, \"__\", \"Vertical\", options)))\n    + \"\\r\\n        </label>\\r\\n        <br>\\r\\n        <label class=\\\"smaller-prompt\\\">\\r\\n            <input type=\\\"radio\\\" name=\\\"orientation\\\" value=\\\"horizontal\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n            <span class=\\\"icon-radio\\\"></span>\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Horizontal\", options) : helperMissing.call(depth0, \"__\", \"Horizontal\", options)))\n    + \"\\r\\n        </label>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Question',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/choice',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter',\r\n    'ui/liststyler'\r\n], function(stateFactory, Question, formElement, interactionFormElement, formTpl, _, sizeAdapter){\r\n\r\n    'use strict';\r\n\r\n    var ChoiceInteractionStateQuestion = stateFactory.extend(Question);\r\n\r\n    // Note: any change of this needs to be reflected in CSS\r\n    var listStylePrefix = 'list-style-';\r\n\r\n    function getListStyle(interaction) {\r\n        var className = interaction.attr('class') || '',\r\n            listStyle = className.match(/\\blist-style-[\\w-]+/);\r\n\r\n        return !_.isNull(listStyle) ? listStyle.pop().replace(listStylePrefix, '') : null;\r\n    }\r\n\r\n    ChoiceInteractionStateQuestion.prototype.initForm = function(updateCardinality){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            interaction = _widget.element,\r\n            currListStyle = getListStyle(interaction),\r\n            $choiceArea = _widget.$container.find('.choice-area');\r\n\r\n        $form.html(formTpl({\r\n            shuffle : !!interaction.attr('shuffle'),\r\n            maxChoices : parseInt(interaction.attr('maxChoices')),\r\n            minChoices : parseInt(interaction.attr('minChoices')),\r\n            choicesCount : _.size(_widget.element.getChoices()),\r\n            horizontal : interaction.attr('orientation') === 'horizontal',\r\n            eliminable : (/\\beliminable\\b/).test(interaction.attr('class'))\r\n        }));\r\n\r\n\r\n        $form.find('[data-list-style]').liststyler( { selected: currListStyle })\r\n            .on('stylechange.liststyler', function(e, data) {\r\n                // model\r\n                interaction.removeClass(listStylePrefix + data.oldStyle);\r\n                // current visual\r\n                $choiceArea.removeClass(listStylePrefix + data.oldStyle);\r\n                if(data.newStyle !== 'none'){\r\n                    interaction.addClass(listStylePrefix + data.newStyle);\r\n                    $choiceArea.addClass(listStylePrefix + data.newStyle);\r\n                }\r\n            });\r\n\r\n\r\n        // activate the elimination buttons\r\n        $form.find('[name=\"eliminable\"]').on('change.eliminable', function() {\r\n            // model\r\n            interaction.toggleClass('eliminable', this.checked);\r\n            // current visual\r\n            _widget.$original.toggleClass('eliminable', this.checked);\r\n\r\n            // indicate whether this has been unchecked on purpose\r\n            interaction.toggleClass('eliminability-deselected', !this.checked);\r\n        });\r\n\r\n        formElement.initWidget($form);\r\n\r\n        //data change callbacks with the usual min/maxChoices\r\n        var callbacks = formElement.getMinMaxAttributeCallbacks(this.widget.$form, 'minChoices', 'maxChoices', {updateCardinality:updateCardinality});\r\n\r\n        //data change for shuffle\r\n        callbacks.shuffle = formElement.getAttributeChangeCallback();\r\n\r\n        //data change for orientation, change also the current css class\r\n        callbacks.orientation = function(interaction, value){\r\n            interaction.attr('orientation', value);\r\n            if(value === 'horizontal'){\r\n                $choiceArea.addClass('horizontal');\r\n            } else {\r\n                $choiceArea.removeClass('horizontal');\r\n            }\r\n        };\r\n\r\n        formElement.setChangeCallbacks($form, interaction, callbacks);\r\n\r\n        interactionFormElement.syncMaxChoices(_widget);\r\n\r\n        //modify the checkbox/radio input appearances\r\n        _widget.on('attributeChange', function(data){\r\n\r\n            var $checkboxIcons = _widget.$container.find('.real-label > span');\r\n\r\n            if(data.element.serial === interaction.serial && data.key === 'maxChoices'){\r\n                if(parseInt(data.value) === 1){\r\n                    //radio\r\n                    $checkboxIcons.removeClass('icon-checkbox').addClass('icon-radio');\r\n                }else{\r\n                    //checkbox\r\n                    $checkboxIcons.removeClass('icon-radio').addClass('icon-checkbox');\r\n                }\r\n            }\r\n        });\r\n\r\n        //adapt size\r\n        if(_widget.element.attr('orientation') === 'horizontal') {\r\n            sizeAdapter.adaptSize(_widget);\r\n        }\r\n\r\n        _widget.on('choiceCreated', function(){\r\n            if(_widget.element.attr('orientation') === 'horizontal') {\r\n                sizeAdapter.adaptSize(_widget);\r\n            }\r\n        });\r\n    };\r\n\r\n    return ChoiceInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Choice',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter'\r\n], function(stateFactory, Choice, sizeAdapter){\r\n\r\n    'use strict';\r\n\r\n    var ChoiceInteractionStateChoice = stateFactory.extend(Choice, function(){\r\n        \r\n        var widget = this.widget;\r\n        \r\n        widget.on('containerBodyChange contentChange choiceCreated', function(){\r\n            if(widget.element.attr('orientation') === 'horizontal') {\r\n                sizeAdapter.adaptSize(widget);\r\n            }\r\n        });\r\n        \r\n    }, function(){\r\n        \r\n    });\r\n\r\n    return ChoiceInteractionStateChoice;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/simpleChoice.score', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"mini-tlb\\\" data-edit=\\\"answer\\\" data-for=\\\"\";\n  if (helper = helpers.choiceSerial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choiceSerial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <label class=\\\"tlb-button right\\\" title=\\\"Score of this answer\\\" data-edit=\\\"map\\\">\\r\\n        <input value=\\\"\";\n  if (helper = helpers.score) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.score); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n       title=\\\"Score of this answer\\\" \\r\\n       type=\\\"text\\\" \\r\\n       data-for=\\\"\";\n  if (helper = helpers.choiceIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choiceIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n       name=\\\"score\\\" \\r\\n       class=\\\"score\\\" \\r\\n       placeholder = \\\"\";\n  if (helper = helpers.placeholder) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.placeholder); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n       data-validate=\\\"$numeric\\\" \\r\\n       data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\" />\\r\\n    </label>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/simpleChoice.label', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, self=this, functionType=\"function\", escapeExpression=this.escapeExpression;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"style=\\\"display:block;\\\"\";\n  }\n\n  buffer += \"<div class=\\\"mini-tlb-label\\\" data-edit=\\\"answer\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.show), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n    <label class=\\\"right\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</label>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/ResponseWidget',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/simpleChoice.score',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/simpleChoice.label',\r\n    'polyfill/placeholders'\r\n], function($, _, __, commonRenderer, instructionMgr, pciResponse, formElement, answerStateHelper, sizeAdapter, scoreTpl, labelTpl){\r\n\r\n    'use strict';\r\n\r\n    var _fixInputs = function(widget){\r\n\r\n        if(widget.element.attr('maxChoices') === 1){\r\n            //enforce radios:\r\n            widget.$container.find('.real-label > :checkbox').replaceWith(function(){\r\n\r\n                var $checkbox = $(this);\r\n\r\n                return $('<input>', {\r\n                    type : 'radio',\r\n                    value : $checkbox.attr('value'),\r\n                    name : $checkbox.attr('name')\r\n                });\r\n\r\n            });\r\n\r\n        }else{\r\n\r\n            //enforce radios:\r\n            widget.$container.find('.real-label > :radio').replaceWith(function(){\r\n\r\n                var $radio = $(this);\r\n\r\n                return $('<input>', {\r\n                    type : 'checkbox',\r\n                    value : $radio.attr('value'),\r\n                    name : $radio.attr('name')\r\n                });\r\n\r\n            });\r\n        }\r\n\r\n    };\r\n\r\n    var ResponseWidget = {\r\n        create : function(widget, responseMappingMode){\r\n\r\n            var interaction = widget.element;\r\n\r\n            commonRenderer.resetResponse(interaction);\r\n            commonRenderer.destroy(interaction);\r\n\r\n            _fixInputs(widget);\r\n\r\n            if(responseMappingMode){\r\n                instructionMgr.appendInstruction(widget.element, __('Please define the correct response and the score below.'));\r\n                interaction.data('responseMappingMode', true);\r\n                ResponseWidget.createScoreWidgets(widget);\r\n                ResponseWidget.createCorrectWidgets(widget);\r\n            }else{\r\n                instructionMgr.appendInstruction(widget.element, __('Please define the correct response below.'));\r\n                ResponseWidget.createCorrectWidgets(widget);\r\n            }\r\n\r\n            commonRenderer.render(interaction);\r\n\r\n            if(interaction.attr('orientation') === 'horizontal') {\r\n                sizeAdapter.adaptSize(widget);\r\n            }\r\n        },\r\n        setResponse : function(interaction, response){\r\n\r\n            commonRenderer.setResponse(interaction, pciResponse.serialize(_.values(response), interaction));\r\n            if(interaction.attr('orientation') === 'horizontal') {\r\n                sizeAdapter.adaptSize(interaction.data('widget'));\r\n            }\r\n        },\r\n        destroy : function(widget){\r\n\r\n            var interaction = widget.element;\r\n\r\n            commonRenderer.resetResponse(interaction);\r\n            commonRenderer.destroy(interaction);\r\n\r\n            interaction.removeData('responseMappingMode');\r\n\r\n            widget.$container.off('responseChange.qti-widget');\r\n\r\n            widget.$container.find('.real-label > input').attr('disabled', 'disabled');\r\n\r\n            widget.$container.find('.mini-tlb-label[data-edit=answer], .mini-tlb[data-edit=answer]').remove();\r\n\r\n\r\n            if(interaction.attr('orientation') === 'horizontal') {\r\n                sizeAdapter.adaptSize(widget);\r\n            }\r\n        },\r\n        createScoreWidgets : function(widget){\r\n\r\n            var $container = widget.$container,\r\n                interaction = widget.element,\r\n                response = interaction.getResponseDeclaration(),\r\n                mapEntries = response.getMapEntries(),\r\n                defaultValue = response.getMappingAttribute('defaultValue');\r\n\r\n            var $label = $(labelTpl({\r\n                label : __('score'),\r\n                show : true\r\n            })).css({\r\n                right : 3,\r\n                left : 'auto'\r\n            });\r\n\r\n            $container.find('.qti-choice:first .pseudo-label-box').append($label);\r\n\r\n            $container.find('.qti-choice').each(function(){\r\n\r\n                var $choice = $(this),\r\n                    id = $choice.data('identifier'),\r\n                    serial = $choice.data('serial'),\r\n                    $score;\r\n\r\n                $score = $(scoreTpl({\r\n                    serial : interaction.getSerial(),\r\n                    choiceSerial : serial,\r\n                    choiceIdentifier : id,\r\n                    score : mapEntries[id] ? mapEntries[id] : '',\r\n                    placeholder : defaultValue\r\n                }));\r\n\r\n                $choice.find('.pseudo-label-box').append($score);\r\n\r\n                $score.show().on('click', function(e){\r\n                    e.stopPropagation();\r\n                    e.preventDefault();\r\n                });\r\n\r\n            });\r\n\r\n            //add placeholder text to show the default value\r\n            var $scores = $container.find('.score');\r\n            widget.on('mappingAttributeChange', function(data){\r\n                if(data.key === 'defaultValue'){\r\n                    $scores.attr('placeholder', data.value);\r\n                }\r\n            });\r\n\r\n            formElement.setChangeCallbacks($container, response, {\r\n                score : function(response, value){\r\n\r\n                    var key = $(this).data('for');\r\n\r\n                    if(value === ''){\r\n                        response.removeMapEntry(key);\r\n                    }else{\r\n                        response.setMapEntry(key, value, true);\r\n                    }\r\n\r\n                }\r\n            });\r\n\r\n        },\r\n        createCorrectWidgets : function(widget){\r\n\r\n            var $container = widget.$container,\r\n                interaction = widget.element,\r\n                response = interaction.getResponseDeclaration(),\r\n                $corrects = $container.find('.real-label > input');\r\n\r\n            $container.find('.qti-choice:first .pseudo-label-box').append(labelTpl({\r\n                label : __('correct'),\r\n                show : false\r\n            }));\r\n\r\n            $container.on('responseChange.qti-widget', function(e, data){\r\n                response.setCorrect(pciResponse.unserialize(data.response, interaction));\r\n            });\r\n\r\n            var _toggleCorrectInputs = function(show){\r\n                if(show){\r\n                    $corrects.removeAttr('disabled');\r\n                }else{\r\n                    $corrects.attr('disabled', 'disabled').prop('checked', false);\r\n                }\r\n            };\r\n\r\n            _toggleCorrectInputs(answerStateHelper.defineCorrect(response));\r\n\r\n            widget.on('metaChange', function(data){\r\n                if(data.element.serial === response.serial && data.key === 'defineCorrect'){\r\n                    _toggleCorrectInputs(data.value);\r\n                }\r\n            });\r\n\r\n        },\r\n        formatResponse : function(response){\r\n            return pciResponse.serialize(_.values(response));\r\n        },\r\n        unformatResponse : function(formatedResponse){\r\n            return pciResponse.unserialize(formatedResponse);\r\n        }\r\n    };\r\n\r\n    return ResponseWidget;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Correct',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/ResponseWidget',\r\n    'lodash'\r\n], function(stateFactory, Correct, responseWidget, _){\r\n\r\n    var ChoiceInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n\r\n        var _widget = this.widget,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        //init response widget in responseMapping mode:\r\n        responseWidget.create(_widget);\r\n\r\n        //finally, apply defined correct response and response mapping:\r\n        responseWidget.setResponse(interaction, _.values(response.getCorrect()));\r\n\r\n    }, function(){\r\n\r\n        responseWidget.destroy(this.widget);\r\n\r\n    });\r\n\r\n    return ChoiceInteractionStateCorrect;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Map',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/ResponseWidget',\r\n    'lodash'\r\n], function(stateFactory, Map, responseWidget, _){\r\n\r\n    'use strict';\r\n\r\n    var ChoiceInteractionStateMap = stateFactory.create(Map, function(){\r\n\r\n        var _widget = this.widget,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        //init response widget in responseMapping mode:\r\n        responseWidget.create(_widget, true);\r\n\r\n        //finally, apply defined correct response and response mapping:\r\n        responseWidget.setResponse(interaction, _.values(response.getCorrect()));\r\n\r\n    }, function(){\r\n\r\n        responseWidget.destroy(this.widget);\r\n\r\n    });\r\n\r\n    return ChoiceInteractionStateMap;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Choice',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Map'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/states',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter'\r\n], function(Widget, states, sizeAdapter){\r\n\r\n    'use strict';\r\n\r\n    var ChoiceInteractionWidget = Widget.clone();\r\n\r\n    ChoiceInteractionWidget.initCreator = function(){\r\n        \r\n        this.registerStates(states);\r\n        \r\n        Widget.initCreator.call(this);\r\n\r\n        if(this.element.attr('orientation') === 'horizontal') {\r\n            sizeAdapter.adaptSize(this);\r\n        }\r\n    };\r\n    \r\n    return ChoiceInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/ChoiceInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/ChoiceInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/Widget'\r\n], function(_, ChoiceInteraction, ChoiceInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorChoiceInteraction = _.clone(ChoiceInteraction);\r\n\r\n    CreatorChoiceInteraction.render = function(interaction, options){\r\n\r\n        ChoiceInteractionWidget.build(\r\n            interaction,\r\n            ChoiceInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorChoiceInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/endAttemptInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<a class=\\\"qti-interaction qti-inlineInteraction qti-endAttemptInteraction btn small btn-info\\\"\\r\\n        data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n        data-qti-class=\\\"endAttemptInteraction\\\"\\r\\n        value=\\\"false\\\"\\r\\n        tabindex=\\\"0\\\">\\r\\n        \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.title)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\r\\n</a>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n\r\n/**\r\n * CommonRenderer for the EndAttempt interaction\r\n *\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/EndAttemptInteraction',[\r\n    'lodash',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/endAttemptInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'i18n'\r\n], function(_, tpl, containerHelper, pciResponse, __){\r\n    'use strict';\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10402\r\n     *\r\n     * @param {object} interaction\r\n     * @fires endattempt with the response identifier\r\n     */\r\n    function render(interaction, options){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //on click,\r\n        $container.on('click.commonRenderer', function(){\r\n            $container.val(true);\r\n\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n\r\n            $container.trigger('endattempt', [interaction.attr('responseIdentifier')]);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10402\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    function setResponse(interaction, response){\r\n\r\n        _setVal(interaction, pciResponse.unserialize(response, interaction)[0]);\r\n    }\r\n\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10402\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    function getResponse(interaction){\r\n        var val = containerHelper.get(interaction).val();\r\n        val = (val && val !== 'false' && val !== '0');\r\n        return pciResponse.serialize([val], interaction);\r\n    }\r\n\r\n    /**\r\n     * Reset the response ... wondering if it is useful ...\r\n\r\n     * @param {type} interaction\r\n     */\r\n    function resetResponse(interaction){\r\n        _setVal(interaction, false);\r\n    }\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    function getState(interaction){\r\n        var state = {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {Object} interaction\r\n     * @param {Boolean} val\r\n     */\r\n    function _setVal(interaction, val){\r\n\r\n        containerHelper.get(interaction)\r\n            .val(val)\r\n            .change();\r\n\r\n    }\r\n\r\n    /**\r\n     * Destroy the interaction to restore the dom as it is before render() is called\r\n     *\r\n     * @param {Object} interaction\r\n     */\r\n    function destroy(interaction){\r\n        //remove event\r\n        containerHelper.get(interaction).off('.commonRenderer');\r\n    }\r\n\r\n    /**\r\n     * Define default template data\r\n     *\r\n     * @param {Object} interaction\r\n     * @param {Object} data\r\n     * @returns {Object}\r\n     */\r\n    function getCustomData(interaction, data){\r\n        if(!data.attributes.title){\r\n            data.attributes.title = __('End Attempt');\r\n        }\r\n        return data;\r\n    }\r\n\r\n    return {\r\n        qtiClass : 'endAttemptInteraction',\r\n        template : tpl,\r\n        getData : getCustomData,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/Widget',['taoQtiItem/qtiCreator/widgets/interactions/Widget'], function(Widget){\r\n\r\n    var InlineInteractionWidget = Widget.clone();\r\n\r\n    InlineInteractionWidget.destroy = function(){\r\n        \r\n        //remove all events on the original DOM element\r\n        this.$original.off('.qti-widget');\r\n        \r\n        //remove the external container completely\r\n        this.$container.remove();\r\n\r\n        //clean old referenced event\r\n        this.offEvents();\r\n    };\r\n\r\n    return InlineInteractionWidget;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep'], function(stateFactory, SleepState){\r\n\r\n    var InlineInteractionStateSleep = stateFactory.create(SleepState, function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = this.widget.$original;\r\n\r\n        $container.on('click.qti-widget.sleep', function(e){\r\n            e.stopPropagation();\r\n            //if active == false do this: (else nothing)\r\n            //show toolbar, prompt widget and choice widgets and property form\r\n\r\n            //init default mode: question\r\n            _widget.changeState('question');\r\n        });\r\n\r\n        //add listener to display proper hover style\r\n        $container.on('mouseenter.sleep', function(e){\r\n            $container.addClass('hover');\r\n            $container.parent().trigger('mouseleave.sleep');\r\n        }).on('mouseleave.sleep', function(){\r\n            $container.removeClass('hover');\r\n            $container.parent().trigger('mouseenter.sleep');\r\n        });\r\n\r\n    }, function(){\r\n\r\n        this.widget.$original.removeClass('hover').off('.sleep');\r\n    });\r\n\r\n    return InlineInteractionStateSleep;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/Active',[\r\n    'jquery', \r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Active'], \r\nfunction($, _, stateFactory, Active){\r\n\r\n    var InteractionStateActive = stateFactory.extend(Active, function(){\r\n        \r\n        var _this = this;\r\n        $(window).on('resize.active', _.throttle(function(){\r\n            _this.positionWidget();\r\n        }, 200));\r\n        \r\n        this.positionWidget();\r\n\r\n    }, function(){\r\n\r\n        //unbind events\r\n        $(window).off('.active');\r\n        \r\n        //hide it:\r\n        this.widget.$container.hide();\r\n    });\r\n\r\n    InteractionStateActive.prototype.positionWidget = function(){\r\n        \r\n        //show toolbar, ok button, event binding performed by parent state\r\n        var _widget = this.widget,\r\n            itemOffset = _widget.$itemContainer.offset(),\r\n            originalOffset = _widget.$original.offset();\r\n\r\n        //debug\r\n//        _widget.$itemContainer.on('mousemove', _.throttle(function(e){\r\n//            console.log(e.pageX - itemOffset.left, e.pageY - itemOffset.top);\r\n//        }, 200));\r\n//        _widget.$itemContainer.css({border:'2px solid red'});\r\n//        _widget.$container.css({border:'2px solid red'});\r\n//        _widget.$original.css({border:'2px solid red'});\r\n\r\n        //calculate absolute position:\r\n        _widget.$container.show().css({\r\n            position : 'absolute',\r\n            top : originalOffset.top - itemOffset.top - 22,\r\n            left : originalOffset.left - itemOffset.left - 32\r\n        });\r\n        \r\n    };\r\n\r\n    return InteractionStateActive;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/Active'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/endAttempt', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"restrictedIdentifier\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Response identifier\", options) : helperMissing.call(depth0, \"__\", \"Response identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select a response identifier from the list.\", options) : helperMissing.call(depth0, \"__\", \"Select a response identifier from the list.\", options)))\n    + \"</span>\\r\\n    <select name=\\\"restrictedIdentifier\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n    \t\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.restrictedIdentifiers), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </select>\\r\\n</div>\\r\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    \t\t<option value=\\\"\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n    \t\";\n  return buffer;\n  }\nfunction program3(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Response identifier\", options) : helperMissing.call(depth0, \"__\", \"Response identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the response identifier. This identifier must not be used by any other response or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the response identifier. This identifier must not be used by any other response or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"responseIdentifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.responseIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. END_ATTEMPT\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.responseSerial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseSerial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\\r\\n\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.hasRestrictedIdentifier), {hash:{},inverse:self.program(5, program5, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Label\", options) : helperMissing.call(depth0, \"__\", \"Label\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The button label.\", options) : helperMissing.call(depth0, \"__\", \"The button label.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"title\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. End Attempt\\\" \\r\\n           data-validate=\\\"$notEmpty;\\\">\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/endAttemptInteraction/states/Question',[\r\n    'lodash',\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/endAttempt'\r\n], function(_, $, stateFactory, Question, formElement, formTpl){\r\n    'use strict';\r\n    var EndAttemptInteractionStateQuestion = stateFactory.extend(Question, function(){\r\n        \r\n        var $mainOption = this.widget.$container.find('.main-option'),\r\n            $original = this.widget.$original;\r\n        \r\n        //listener to children choice widget change and update the original interaction placehoder\r\n        $(document).on('choiceTextChange.qti-widget.question', function(){\r\n            $original.width($mainOption.width());\r\n        });\r\n\r\n    }, function(){\r\n        \r\n        $(document).off('.qti-widget.question');\r\n    });\r\n\r\n    EndAttemptInteractionStateQuestion.prototype.addNewChoiceButton = function(){};\r\n\r\n    EndAttemptInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            $title = _widget.$container.find('.endAttemptInteraction-placeholder'),\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n        \r\n        var restrictedIdentifiers = _prepareRestrictedIdentifier(_widget);\r\n        var hasRestrictedIdentifier = !!_.size(restrictedIdentifiers);\r\n        \r\n        $form.html(formTpl({\r\n            hasRestrictedIdentifier : hasRestrictedIdentifier,\r\n            restrictedIdentifiers : restrictedIdentifiers,\r\n            responseSerial : response.serial,\r\n            responseIdentifier : interaction.attr('responseIdentifier'),\r\n            title : interaction.attr('title')\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        formElement.setChangeCallbacks($form, interaction, {\r\n            title : function(interaction, title){\r\n                interaction.attr('title', title);\r\n                $title.html(title);\r\n                _widget.$original.html(title);\r\n            },\r\n            responseIdentifier : function(interaction, identifier){\r\n                //directly save the validate response identifier (it went throught the validator so we know it is unique)\r\n                response.id(identifier);\r\n                //sync the response identifier in the interaction\r\n                interaction.attr('responseIdentifier', identifier);\r\n            },\r\n            restrictedIdentifier : function(interaction, identifier){\r\n                //generate a response from that identifier (because might not be unique\r\n                response.buildIdentifier(identifier, false);\r\n                //sync the response identifier in the interaction\r\n                interaction.attr('responseIdentifier', response.id());\r\n            }\r\n        });\r\n    };\r\n    \r\n    /**\r\n     * Prepare the restricted identifiers to be used \r\n     * (when the option in configuration \"responseIdentifiers\" is set)\r\n     * \r\n     * @param {Object} widget\r\n     * @returns {Object}\r\n     */\r\n    function _prepareRestrictedIdentifier(widget){\r\n        \r\n        var ret = {},\r\n            interaction = widget.element,\r\n            response = interaction.getResponseDeclaration(),\r\n            responseIdentifier = interaction.attr('responseIdentifier'),\r\n            config = widget.options.config,\r\n            defaultIdentifier = '',\r\n            isset = '',\r\n            i = 0;\r\n        \r\n        //only execute the code when the config option is set \"responseIdentifiers\"\r\n        if(config && config.responseIdentifiers){\r\n            \r\n            _.forIn(config.responseIdentifiers, function(title, identifier){\r\n                \r\n                //store the first identifier as the default one\r\n                if(!i){\r\n                    defaultIdentifier = identifier;\r\n                }\r\n                \r\n                //considered selected when match the pattern RESPONSE_STUFF === RESPONSE_STUFF_2 === RESPONSE_STUFF_3\r\n                var selected = responseIdentifier.match(new RegExp('^('+identifier+')(_[0-9]*)?$'));\r\n                \r\n                //prepare the template data\r\n                ret[identifier] = {\r\n                    identifier : identifier,\r\n                    title : title,\r\n                    selected : selected\r\n                };\r\n                \r\n                if(selected){\r\n                    isset = true;\r\n                }\r\n                \r\n                i++;\r\n            });\r\n            \r\n            //if none of the authorized identifier is set, set the first one\r\n            if(!isset){\r\n                //directly save the validate response identifier (it went throught the validator so we know it is unique)\r\n                response.buildIdentifier(defaultIdentifier, false);\r\n                //sync the response identifier in the interaction\r\n                interaction.attr('responseIdentifier', response.id());\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    \r\n    return EndAttemptInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/endAttemptInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/endAttemptInteraction/states/Question'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments, ['map']);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/endAttemptInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"widget-box widget-inline widget-endAttemptInteraction qti-interaction\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-edit=\\\"active\\\">\\r\\n    <span class=\\\"btn small btn-info endAttemptInteraction-placeholder\\\">\\r\\n        \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.title)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\r\\n    </span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/endAttemptInteraction/Widget',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/endAttemptInteraction/states/states',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/endAttemptInteraction'\r\n], function(_, InteractionWidget, states, interactionTpl){\r\n    'use strict';\r\n    var EndAttemptInteractionWidget = InteractionWidget.clone();\r\n    \r\n    /**\r\n     * Init the creator\r\n     */\r\n    EndAttemptInteractionWidget.initCreator = function(){\r\n\r\n        this.registerStates(states);\r\n\r\n        InteractionWidget.initCreator.call(this);\r\n\r\n        //remove toolbar title, because it is too large\r\n        this.$container.find('.tlb-title').remove();\r\n    };\r\n    \r\n    /**\r\n     * Render the interaction widget from template\r\n     * \r\n     * @returns {Object}\r\n     */\r\n    EndAttemptInteractionWidget.renderInteraction = function(){\r\n\r\n        var interaction = this.element,\r\n            tplData = {\r\n            tag : interaction.qtiClass,\r\n            serial : interaction.serial,\r\n            attributes : interaction.attributes\r\n        };\r\n\r\n        return interactionTpl(tplData);\r\n    };\r\n    \r\n    /**\r\n     * Prepare and define the end attempt interaction widget container\r\n     */\r\n    EndAttemptInteractionWidget.buildContainer = function(){\r\n        var previous, next;\r\n        //add a space to be able to place the cursor before and after it.\r\n        if(this.$original.length){\r\n            previous = this.$original[0].previousSibling;\r\n            next = this.$original[0].nextSibling;\r\n\r\n            if(!previous || (previous.nodeType === 3 && previous.nodeValue === '') || previous.nodeType !== 3){\r\n                this.$original.before('&nbsp;');\r\n            }\r\n            if(!next || (next.nodeType === 3 && next.nodeValue === '') || next.nodeType !== 3){\r\n                this.$original.after('&nbsp;');\r\n            }\r\n        }\r\n\r\n        //set the itemContainer where the actual widget should be append and be positioned absolutely\r\n        this.$itemContainer = this.$original.parents('.item-editor-item');\r\n\r\n        //prepare html: interaction & choices:\r\n        this.$itemContainer.append(this.renderInteraction());\r\n        \r\n        this.$container = this.$itemContainer.find('.widget-endAttemptInteraction[data-serial=' + this.element.getSerial() + ']');\r\n    };\r\n\r\n    return EndAttemptInteractionWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/endAttemptInteraction.placeholder', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"widget-box btn small btn-info endAttemptInteraction-placeholder\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"endAttemptInteraction\\\">\\r\\n    \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.title)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/EndAttemptInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/EndAttemptInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/endAttemptInteraction/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/endAttemptInteraction.placeholder'\r\n], function($, _, EndAttemptInteraction, EndAttemptInteractionWidget, tpl){\r\n    'use strict';\r\n\r\n    var CreatorEndAttemptInteraction = _.clone(EndAttemptInteraction);\r\n\r\n    CreatorEndAttemptInteraction.template = tpl;\r\n\r\n    /**\r\n     * Render the end attempt interaction widget\r\n     *\r\n     * @param {Object} interaction - the qti js object\r\n     * @param {Object} options\r\n     * @returns {Object}\r\n     */\r\n    CreatorEndAttemptInteraction.render = function(interaction, options){\r\n\r\n        //need to pass choice option form to the interaction widget because it will manage everything\r\n        options = options || {};\r\n\r\n        //complete the option\r\n        var interactionsConfig = this.getOption('interactions');\r\n        if(interactionsConfig.endAttempt){\r\n            options.config = interactionsConfig.endAttempt;\r\n        }\r\n\r\n        EndAttemptInteractionWidget.build(\r\n            interaction,\r\n            $('.endAttemptInteraction-placeholder[data-serial=\"' + interaction.serial + '\"]'),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorEndAttemptInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/extendedTextInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n        \";\n  stack1 = (helper = helpers.equal || (depth0 && depth0.equal),options={hash:{},inverse:self.program(12, program12, data),fn:self.program(8, program8, data),data:data},helper ? helper.call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format), \"xhtml\", options) : helperMissing.call(depth0, \"equal\", ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format), \"xhtml\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        {!-- If there's an expected length or a max length --}}\\r\\n        \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.expectedLength), {hash:{},inverse:self.noop,fn:self.program(16, program16, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.maxLength), {hash:{},inverse:self.noop,fn:self.program(18, program18, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \\r\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.maxWords), {hash:{},inverse:self.noop,fn:self.program(20, program20, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  return buffer;\n  }\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.maxStringLoop), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  return buffer;\n  }\nfunction program9(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n                <div class=\\\"text-container text-\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \" solid\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" name=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"_\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\" contenteditable></div>\\r\\n            \";\n  return buffer;\n  }\nfunction program10(depth0,data) {\n  \n  \n  return \" attributes.class\";\n  }\n\nfunction program12(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.maxStringLoop), {hash:{},inverse:self.noop,fn:self.program(13, program13, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  return buffer;\n  }\nfunction program13(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n                <textarea class=\\\"text-container text-\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \" solid\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" name=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"_\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.patternMask), {hash:{},inverse:self.noop,fn:self.program(14, program14, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"></textarea>\\r\\n            \";\n  return buffer;\n  }\nfunction program14(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"pattern=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.patternMask)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program16(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n            <div class=\\\"text-counter\\\">\\r\\n                <span class=\\\"count-chars\\\">0</span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"of\", options) : helperMissing.call(depth0, \"__\", \"of\", options)))\n    + \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.expectedLength)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"chars\", options) : helperMissing.call(depth0, \"__\", \"chars\", options)))\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"recommanded\", options) : helperMissing.call(depth0, \"__\", \"recommanded\", options)))\n    + \".\\r\\n            </div>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program18(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n            <div class=\\\"text-counter\\\">\\r\\n                <span class=\\\"count-chars\\\">0</span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"of\", options) : helperMissing.call(depth0, \"__\", \"of\", options)))\n    + \" \";\n  if (helper = helpers.maxLength) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxLength); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"chars\", options) : helperMissing.call(depth0, \"__\", \"chars\", options)))\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"maximum\", options) : helperMissing.call(depth0, \"__\", \"maximum\", options)))\n    + \".\\r\\n            </div>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program20(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n            <div class=\\\"text-counter\\\">\\r\\n                <span class=\\\"count-words\\\">0</span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"of\", options) : helperMissing.call(depth0, \"__\", \"of\", options)))\n    + \" \";\n  if (helper = helpers.maxWords) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxWords); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"words\", options) : helperMissing.call(depth0, \"__\", \"words\", options)))\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"maximum\", options) : helperMissing.call(depth0, \"__\", \"maximum\", options)))\n    + \".\\r\\n            </div>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program22(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n        \";\n  stack1 = (helper = helpers.equal || (depth0 && depth0.equal),options={hash:{},inverse:self.program(25, program25, data),fn:self.program(23, program23, data),data:data},helper ? helper.call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format), (depth0 && depth0.xhtml), options) : helperMissing.call(depth0, \"equal\", ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format), (depth0 && depth0.xhtml), options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \\r\\n        \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.expectedLength), {hash:{},inverse:self.noop,fn:self.program(27, program27, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.maxLength), {hash:{},inverse:self.noop,fn:self.program(18, program18, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \\r\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.maxWords), {hash:{},inverse:self.noop,fn:self.program(20, program20, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  return buffer;\n  }\nfunction program23(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            <div class=\\\"text-container text-\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \" solid\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" contenteditable></div>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program25(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            <textarea class=\\\"text-container text-\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.format)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \" solid\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.patternMask), {hash:{},inverse:self.noop,fn:self.program(14, program14, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"></textarea>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program27(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n            <div class=\\\"text-counter\\\">\\r\\n                <span class=\\\"count-chars\\\">0</span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"of\", options) : helperMissing.call(depth0, \"__\", \"of\", options)))\n    + \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.expectedLength)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"chars\", options) : helperMissing.call(depth0, \"__\", \"chars\", options)))\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"recommended\", options) : helperMissing.call(depth0, \"__\", \"recommended\", options)))\n    + \".\\r\\n            </div>\\r\\n        \";\n  return buffer;\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-extendedTextInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"extendedTextInteraction\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.multiple), {hash:{},inverse:self.program(22, program22, data),fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n/**\r\n * @author Jean-Sébastien Conan <jean-sebastien.conan@vesperiagroup.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/ckConfigurator',['ui/ckeditor/ckConfigurator'], function(ckConfigurator) {\r\n    'use strict';\r\n\r\n    /**\r\n     * Generate a configuration object for CKEDITOR\r\n     *\r\n     * @param editor instance of ckeditor\r\n     * @param toolbarType block | inline | flow | qtiBlock | qtiInline | qtiFlow | reset to get back to normal\r\n     * @param {Object} [options] - is based on the CKEDITOR config object with some additional sugar\r\n     *        Note that it's here you need to add parameters for the resource manager.\r\n     *        Some options are not covered in http://docs.ckeditor.com/#!/api/CKEDITOR.config\r\n     * @param [options.dtdOverrides] - @see dtdOverrides which pre-defines them\r\n     * @param {Object} [options.positionedPlugins] - @see ckConfig.positionedPlugins\r\n     * @param {Boolean} [options.qtiImage] - enables the qtiImage plugin\r\n     * @param {Boolean} [options.qtiInclude] - enables the qtiInclude plugin\r\n     * @param {Boolean} [options.underline] - enables the underline plugin\r\n     * @param {Boolean} [options.mathJax] - enables the mathJax plugin\r\n     *\r\n     * @see http://docs.ckeditor.com/#!/api/CKEDITOR.config\r\n     */\r\n    var getConfig = function(editor, toolbarType, options){\r\n        options = options || {};\r\n\r\n        options.underline = true;\r\n\r\n        return ckConfigurator.getConfig(editor, toolbarType, options);\r\n    };\r\n\r\n    return {\r\n        getConfig : getConfig\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2016 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/patternMask',[], function(){\r\n    'use strict';\r\n\r\n    var regexChar = /\\^\\[\\\\s\\\\S\\]\\{\\d+\\,(\\d+)\\}\\$/,\r\n        regexWords =  /\\^\\(\\?\\:\\(\\?\\:\\[\\^\\\\s\\\\:\\\\!\\\\\\?\\\\\\;\\\\\\…\\\\\\€\\]\\+\\)\\[\\\\s\\\\:\\\\!\\\\\\?\\\\;\\\\\\…\\\\\\€\\]\\*\\)\\{\\d+\\,(\\d+)\\}\\$/;\r\n\r\n    var patternMaskHelper = {\r\n        /**\r\n         * Parse the pattern string and according to the given type, try to extract the associate number\r\n         *\r\n         * @param {String} pattern - the pattern string to be parsed\r\n         * @param {String} type - words or chars\r\n         * @returns {*}\r\n         */\r\n        parsePattern : function parsePattern(pattern, type){\r\n            if (pattern === undefined || pattern === null){\r\n                return null;\r\n            }\r\n            if (type === \"words\") {\r\n                //expre = /^(?:(?:[^\\s\\:\\!\\?\\;\\…\\€]+)[\\s\\:\\!\\?\\;\\…\\€]*){0,3}$/;\r\n                var result = pattern.match(regexWords);\r\n\r\n                if (result !== null && result.length > 1) {\r\n                    return result[1];\r\n                }else{\r\n                    return null;\r\n                }\r\n            }else if (type === \"chars\"){\r\n                // This is the original regExp generated by our code\r\n                // expre = /^[\\s\\S]{0,10}$/;\r\n                // and we will try to extract the top limit from it with this regexp\r\n                // which is mostly just escaped version of the first one.\r\n                var result = pattern.match(regexChar);\r\n\r\n                if (result !== null && result.length > 1) {\r\n                    return result[1];\r\n                }else{\r\n                    return null;\r\n                }\r\n            }else{\r\n                return null;\r\n            }\r\n        },\r\n        /**\r\n         * Reverse function of parsePattern for word type\r\n         *\r\n         * @param {Number} max\r\n         * @returns {string}\r\n         */\r\n        createMaxWordPattern : function createMaxWordPattern(max){\r\n            return '^(?:(?:[^\\\\s\\\\:\\\\!\\\\?\\\\;\\\\…\\\\€]+)[\\\\s\\\\:\\\\!\\\\?\\\\;\\\\…\\\\€]*){0,' + max.toString() + '}$';\r\n        },\r\n        /**\r\n         * Reverse function of parsePattern for char type\r\n         *\r\n         * @param {Number} max\r\n         * @returns {string}\r\n         */\r\n        createMaxCharPattern : function createMaxCharPattern(max){\r\n            return '^[\\\\s\\\\S]{0,' + max.toString() + '}$';\r\n        }\r\n    };\r\n\r\n    return patternMaskHelper;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/extendedTextInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'ckeditor',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/ckConfigurator',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/patternMask',\r\n    'polyfill/placeholders'\r\n], function($, _, __, Promise, tpl, containerHelper, instructionMgr, ckEditor, ckConfigurator, patternMaskHelper){\r\n    'use strict';\r\n\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10296\r\n     *\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @returns {Promise} rendering is async\r\n     */\r\n    var render = function render (interaction){\r\n        return new Promise(function(resolve, reject){\r\n\r\n            var $el, expectedLength, minStrings, expectedLines, patternMask, placeholderType, editor;\r\n            var $container = containerHelper.get(interaction);\r\n\r\n            var multiple = _isMultiple(interaction);\r\n            var limiter  = inputLimiter(interaction);\r\n\r\n            var placeholderText = interaction.attr('placeholderText');\r\n\r\n            var toolbarType = 'extendedText';\r\n            var ckOptions = {\r\n                'extraPlugins': 'onchange',\r\n                'language': 'en',\r\n                'defaultLanguage': 'en',\r\n                'resize_enabled': true,\r\n                'secure': location.protocol == 'https:',\r\n                'forceCustomDomain' : true\r\n            };\r\n\r\n            if(!multiple){\r\n\r\n                $el = $container.find('textarea');\r\n                if (placeholderText) {\r\n                    $el.attr('placeholder', placeholderText);\r\n                }\r\n                if (_getFormat(interaction) === \"xhtml\") {\r\n\r\n\r\n                    editor = _setUpCKEditor(interaction, ckOptions);\r\n                    if(!editor){\r\n                        reject('Unable to instantiate ckEditor');\r\n                    }\r\n\r\n                    editor.on('instanceReady', function(){\r\n                        //it seems there's still something done after loaded, so resolved must be defered\r\n                        _.delay(resolve, 300);\r\n                    });\r\n                    if(editor.status === 'ready' || editor.status === 'loaded'){\r\n                        _.defer(resolve);\r\n                    }\r\n                    editor.on('configLoaded', function(e) {\r\n                        editor.config = ckConfigurator.getConfig(editor, toolbarType, ckOptions);\r\n\r\n                        if(limiter.enabled){\r\n                            limiter.listenKeyPress();\r\n                        }\r\n                    });\r\n                    editor.on('change', function(e) {\r\n                        containerHelper.triggerResponseChangeEvent(interaction, {});\r\n                    });\r\n\r\n                } else {\r\n\r\n                    $el.on('keyup.commonRenderer change.commonRenderer', function(e) {\r\n                        containerHelper.triggerResponseChangeEvent(interaction, {});\r\n                    });\r\n\r\n                    if(limiter.enabled){\r\n                        limiter.listenKeyPress();\r\n                    }\r\n\r\n                    resolve();\r\n                }\r\n\r\n            //multiple inputs\r\n            } else {\r\n\r\n                $el            = $container.find('input');\r\n                minStrings     = interaction.attr('minStrings');\r\n                expectedLength = interaction.attr('expectedLength');\r\n                patternMask    = interaction.attr('patternMask');\r\n\r\n                //setting the checking for minimum number of answers\r\n                if (minStrings) {\r\n\r\n                    //get the number of filled inputs\r\n                    var _getNumStrings = function($element) {\r\n                        var num = 0;\r\n                        $element.each(function() {\r\n                            if ($(this).val() !== '') {\r\n                                num++;\r\n                            }\r\n                        });\r\n\r\n                        return num;\r\n                    };\r\n\r\n                    minStrings = parseInt(minStrings, 10);\r\n                    if (minStrings > 0) {\r\n\r\n                        $el.on('blur.commonRenderer', function() {\r\n                            setTimeout(function() {\r\n                                //checking if the user was clicked outside of the input fields\r\n\r\n                                //TODO remove notifications in favor of instructions\r\n\r\n                                if (!$el.is(':focus') && _getNumStrings($el) < minStrings) {\r\n                                    instructionMgr.appendNotification(interaction, __('The minimum number of answers is ') + ' : ' + minStrings, 'warning');\r\n                                }\r\n                            }, 100);\r\n                        });\r\n                    }\r\n                }\r\n\r\n                //set the fields width\r\n                if (expectedLength) {\r\n                    expectedLength = parseInt(expectedLength, 10);\r\n\r\n                    if (expectedLength > 0) {\r\n                        $el.each(function() {\r\n                            $(this).css('width', expectedLength + 'em');\r\n                        });\r\n                    }\r\n                }\r\n\r\n                //set the fields pattern mask\r\n                if (patternMask) {\r\n                    $el.each(function() {\r\n                        _setPattern($(this), patternMask);\r\n                    });\r\n                }\r\n\r\n                //set the fields placeholder\r\n                if (placeholderText) {\r\n                    /**\r\n                     * The type of the fileds placeholder:\r\n                     * multiple - set placeholder for each field\r\n                     * first - set placeholder only for first field\r\n                     * none - dont set placeholder\r\n                     */\r\n                    placeholderType = 'first';\r\n\r\n                    if (placeholderType === 'multiple') {\r\n                        $el.each(function() {\r\n                            $(this).attr('placeholder', placeholderText);\r\n                        });\r\n                    }\r\n                    else if (placeholderType === 'first') {\r\n                        $el.first().attr('placeholder', placeholderText);\r\n                    }\r\n                }\r\n                resolve();\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Reset the textarea / ckEditor\r\n     * @param {Object} interaction - the extended text interaction model\r\n     */\r\n    var resetResponse = function(interaction) {\r\n        if (_getFormat(interaction) === 'xhtml') {\r\n            _getCKEditor(interaction).setData('');\r\n        }else{\r\n            containerHelper.get(interaction).find('input, textarea').val('');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10296\r\n     *\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response) {\r\n\r\n        var _setMultipleVal = function(identifier, value) {\r\n            interaction.getContainer().find('#'+identifier).val(value);\r\n        };\r\n\r\n        var baseType = interaction.getResponseDeclaration().attr('baseType');\r\n\r\n        if (response.base && response.base[baseType] !== undefined) {\r\n            setText(interaction, response.base[baseType]);\r\n        }\r\n        else if (response.list && response.list[baseType]) {\r\n\r\n            for (var i in response.list[baseType]) {\r\n                var serial = (response.list.serial === undefined) ? '' : response.list.serial[i];\r\n                _setMultipleVal(serial + '_' + i, response.list[baseType][i]);\r\n            }\r\n        }\r\n        else {\r\n            throw new Error('wrong response format in argument.');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10296\r\n     *\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction) {\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var attributes = interaction.getAttributes();\r\n        var responseDeclaration = interaction.getResponseDeclaration();\r\n        var baseType = responseDeclaration.attr('baseType');\r\n        var numericBase = attributes.base || 10;\r\n        var multiple = !!(attributes.maxStrings && (responseDeclaration.attr('cardinality') === 'multiple' || responseDeclaration.attr('cardinality') === 'ordered'));\r\n        var ret = multiple ? {list:{}} : {base:{}};\r\n\r\n        if (multiple) {\r\n\r\n            var values = [];\r\n\r\n            $container.find('input').each(function(i) {\r\n\r\n                var $el = $(this);\r\n\r\n                if (attributes.placeholderText && $el.val() === attributes.placeholderText) {\r\n                    values[i] = '';\r\n                }\r\n                else {\r\n                    if (baseType === 'integer') {\r\n                        values[i] = parseInt($el.val(), numericBase);\r\n                        values[i] = isNaN(values[i]) ? '' : values[i];\r\n                    }\r\n                    else if(baseType === 'float') {\r\n                        values[i] = parseFloat($el.val());\r\n                        values[i] = isNaN(values[i]) ? '' : values[i];\r\n                    }\r\n                    else if(baseType === 'string') {\r\n                        values[i] = $el.val();\r\n                    }\r\n                }\r\n            });\r\n\r\n            ret.list[baseType] = values;\r\n        }\r\n        else {\r\n\r\n            var value = '';\r\n\r\n            if (attributes.placeholderText && _getTextareaValue(interaction) === attributes.placeholderText) {\r\n                value = '';\r\n            }\r\n            else {\r\n\r\n                if (baseType === 'integer') {\r\n                    value = parseInt(_getTextareaValue(interaction), numericBase);\r\n                }\r\n                else if (baseType === 'float') {\r\n                    value = parseFloat(_getTextareaValue(interaction));\r\n                }\r\n                else if (baseType === 'string') {\r\n                    value = _getTextareaValue(interaction, true);\r\n                }\r\n            }\r\n\r\n            ret.base[baseType] = isNaN(value) && typeof value === 'number' ? '' : value;\r\n        }\r\n\r\n        return ret;\r\n    };\r\n\r\n    /**\r\n     * Creates an input limiter object\r\n     * @param {Object} interaction - the extended text interaction\r\n     * @returns {Object} the limiter\r\n     */\r\n    var inputLimiter = function userInputLimier(interaction){\r\n\r\n        var $container     = containerHelper.get(interaction);\r\n        var expectedLength = interaction.attr('expectedLength');\r\n        var expectedLines  = interaction.attr('expectedLines');\r\n        var patternMask    = interaction.attr('patternMask');\r\n        var $textarea,\r\n            $charsCounter,\r\n            $wordsCounter,\r\n            maxWords,\r\n            maxLength;\r\n        var enabled = false;\r\n\r\n\r\n\r\n        if (expectedLength || expectedLines || patternMask) {\r\n\r\n            enabled = true;\r\n\r\n            $textarea       = $('.text-container', $container);\r\n            $charsCounter   = $('.count-chars',$container);\r\n            $wordsCounter   = $('.count-words',$container);\r\n\r\n            if (patternMask !== \"\") {\r\n                maxWords = patternMaskHelper.parsePattern(patternMask, 'words');\r\n                maxLength = patternMaskHelper.parsePattern(patternMask, 'chars');\r\n                maxWords = (_.isNaN(maxWords)) ? undefined : maxWords;\r\n                maxLength = (_.isNaN(maxLength) ? undefined : maxLength);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * The limiter instance\r\n         */\r\n        var limiter = {\r\n\r\n            /**\r\n             * Is the limiter enabled regarding the interaction configuration\r\n             */\r\n            enabled : enabled,\r\n\r\n            /**\r\n             * Listen for a key press in the interaction and limit the input if necessary\r\n             */\r\n            listenKeyPress : function listenKeyPress(){\r\n                var self = this;\r\n\r\n                var ignoreKeyCodes = [\r\n                    8, // backspace\r\n                    16, // shift\r\n                    17, // control\r\n                    46, // delete\r\n                    37, // arrow left\r\n                    38, // arrow up\r\n                    39, // arrow right\r\n                    40, // arrow down\r\n                    35, // home\r\n                    36, // end\r\n\r\n                    // ckeditor specific:\r\n                    1114177, // home\r\n                    3342401, // Shift + home\r\n                    1114181, // end\r\n                    3342405, // Shift + end\r\n\r\n                    2228232, // Shift + backspace\r\n                    2228261, // Shift + arrow left\r\n                    4456485, // Alt   + arrow left\r\n                    2228262, // Shift + arrow up\r\n                    2228263, // Shift + arrow right\r\n                    4456487, // Alt   + arrow right\r\n                    2228264, // Shift + arrow down\r\n\r\n                    1114120, // Ctrl + backspace\r\n                    1114177, // Ctrl + a\r\n                    1114202, // Ctrl + z\r\n                    1114200  // Ctrl + x\r\n                ];\r\n                var triggerKeyCodes = [\r\n                    32, // space\r\n                    13, // enter\r\n                    2228237 // shift + enter in ckEditor\r\n                ];\r\n\r\n\r\n                var limitHandler = function limitHandler(e){\r\n                    var keyCode = e && e.data ? e.data.keyCode : e.which ;\r\n                    if ( (!_.contains(ignoreKeyCodes, keyCode) ) &&\r\n                         (maxWords && self.getWordsCount() >= maxWords && _.contains(triggerKeyCodes, keyCode) ||\r\n                         (maxLength && self.getCharsCount() >= maxLength))){\r\n                        if (e.cancel){\r\n                            e.cancel();\r\n                        } else {\r\n                            e.preventDefault();\r\n                            e.stopImmediatePropagation();\r\n                        }\r\n                        return false;\r\n                    }\r\n                    _.defer(function(){\r\n                        self.updateCounter();\r\n                    });\r\n                };\r\n\r\n                if (_getFormat(interaction) === \"xhtml\") {\r\n                    _getCKEditor(interaction).on('key', limitHandler);\r\n                } else {\r\n                    $textarea.on('keydown.commonRenderer', limitHandler);\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Get the number of words that are actually written in the response field\r\n             * @return {Number} number of words\r\n             */\r\n            getWordsCount : function getWordsCount(){\r\n                var value = _getTextareaValue(interaction) || '';\r\n                if(_.isEmpty(value)){\r\n                    return 0;\r\n                }\r\n                return value.replace(/\\s+/gi, ' ').split(' ').length;\r\n            },\r\n\r\n            /**\r\n             * Get the number of characters that are actually written in the response field\r\n             * @return {Number} number of characters\r\n             */\r\n            getCharsCount : function getCharsCount(){\r\n                var value = _getTextareaValue(interaction) || '';\r\n                return value.length;\r\n            },\r\n\r\n\r\n            /**\r\n             * Update the counter element\r\n             */\r\n            updateCounter : function udpateCounter(){\r\n                $charsCounter.text(this.getCharsCount());\r\n                $wordsCounter.text(this.getWordsCount());\r\n            }\r\n        };\r\n\r\n\r\n        return limiter;\r\n    };\r\n\r\n\r\n    /**\r\n     * return the value of the textarea or ckeditor data\r\n     * @param  {Object} interaction\r\n     * @param  {Boolean} raw Tells if the returned data does not have to be filtered (i.e. XHTML tags not removed)\r\n     * @return {String}             the value\r\n     */\r\n    var _getTextareaValue = function(interaction, raw) {\r\n        if (_getFormat(interaction) === 'xhtml') {\r\n            return _ckEditorData(interaction, raw);\r\n        }\r\n        else {\r\n            return containerHelper.get(interaction).find('textarea').val();\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * Setting the pattern mask for the input, for browsers which doesn't support this feature\r\n     * @param {jQuery} $element\r\n     * @param {string} pattern\r\n     */\r\n    var _setPattern = function _setPattern($element, pattern){\r\n        var patt = new RegExp(pattern);\r\n\r\n        //test when some data is entering in the input field\r\n        //@todo plug the validator + tooltip\r\n        $element.on('keyup.commonRenderer', function(){\r\n            $element.removeClass('field-error');\r\n            if(!patt.test($element.val())){\r\n                $element.addClass('field-error');\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Whether or not multiple strings are expected from the candidate to\r\n     * compose a valid response.\r\n     *\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @returns {Boolean} true if a multiple\r\n     */\r\n    var _isMultiple = function _isMultiple(interaction) {\r\n        var attributes = interaction.getAttributes();\r\n        var response = interaction.getResponseDeclaration();\r\n        return !!(attributes.maxStrings && (response.attr('cardinality') === 'multiple' || response.attr('cardinality') === 'ordered'));\r\n    };\r\n\r\n    /**\r\n     * Instantiate CkEditor for the interaction\r\n     *\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @param {Object} [options = {}] - the CKEditor configuration options\r\n     * @returns {Object} the ckEditor instance (or you'll be in trouble\r\n     */\r\n    var _setUpCKEditor = function _setUpCKEditor(interaction, options){\r\n        var $container = containerHelper.get(interaction);\r\n        var editor = ckEditor.replace($container.find('.text-container')[0], options || {});\r\n        if (editor) {\r\n            $container.data('editor', editor.name);\r\n            return editor;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Destroy CKEditor\r\n     *\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @param {Object} [options = {}] - the CKEditor configuration options\r\n     */\r\n    var _destroyCkEditor = function _destroyCkEditor(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var name = $container.data('editor');\r\n        var editor;\r\n        if(name){\r\n            editor = ckEditor.instances[name];\r\n        }\r\n        if(editor){\r\n            editor.destroy();\r\n            $container.removeData('editor');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Gets the CKEditor instance\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @returns {Object}  CKEditor instance\r\n     */\r\n    var _getCKEditor = function _getCKEditor(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var name = $container.data('editor');\r\n\r\n        return ckEditor.instances[name];\r\n    };\r\n\r\n    /**\r\n     * get the text content of the ckEditor ( not the entire html )\r\n     * @param  {object} interaction the interaction\r\n     * @param  {Boolean} raw Tells if the returned data does not have to be filtered (i.e. XHTML tags not removed)\r\n     * @returns {string}             text content of the ckEditor\r\n     */\r\n    var _ckEditorData = function _ckEditorData(interaction, raw) {\r\n        var editor = _getCKEditor(interaction);\r\n        var data = editor && editor.getData() || '';\r\n\r\n        if (!raw) {\r\n            data = _stripTags(data);\r\n        }\r\n\r\n        return data;\r\n    };\r\n\r\n    /**\r\n     * Remove HTML tags from a string\r\n     * @param {String} str\r\n     * @returns {String}\r\n     */\r\n    var _stripTags = function _stripTags(str) {\r\n        var tempNode = document.createElement('div');\r\n        tempNode.innerHTML = str;\r\n        return tempNode.textContent;\r\n    };\r\n\r\n    /**\r\n     * Get the interaction format\r\n     * @param {Object} interaction - the extended text interaction model\r\n     * @returns {String} format in 'plain', 'xhtml', 'preformatted'\r\n     */\r\n    var _getFormat = function _getFormat(interaction) {\r\n        var format = interaction.attr('format');\r\n        if(_.contains(['plain', 'xhtml', 'preformatted'], format)){\r\n            return format;\r\n        }\r\n        return 'plain';\r\n    };\r\n\r\n    var enable = function(interaction) {\r\n        var $container = containerHelper.get(interaction);\r\n        var editor;\r\n\r\n        $container.find('input, textarea').removeAttr('disabled');\r\n\r\n        if (_getFormat(interaction) === 'xhtml') {\r\n            editor = _getCKEditor(interaction);\r\n            if (editor) {\r\n                if (editor.status === 'ready') {\r\n                    editor.setReadOnly(false);\r\n                } else {\r\n                    editor.readOnly = false;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    var disable = function(interaction) {\r\n        var $container = containerHelper.get(interaction);\r\n        var editor;\r\n\r\n        $container.find('input, textarea').attr('disabled', 'disabled');\r\n\r\n        if (_getFormat(interaction) === 'xhtml') {\r\n            editor = _getCKEditor(interaction);\r\n            if (editor) {\r\n                if (editor.status === 'ready') {\r\n                    editor.setReadOnly(true);\r\n                } else {\r\n                    editor.readOnly = true;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    var clearText = function(interaction) {\r\n        setText(interaction, '');\r\n    };\r\n\r\n    var setText = function(interaction, text) {\r\n        var limiter = inputLimiter(interaction);\r\n        if ( _getFormat(interaction) === 'xhtml') {\r\n            try{\r\n            _getCKEditor(interaction).setData(text, function(){\r\n                if(limiter.enabled){\r\n                    limiter.updateCounter();\r\n                }\r\n            });\r\n            } catch(e){\r\n                console.error('setText error', e);\r\n            }\r\n        } else {\r\n            containerHelper.get(interaction).find('textarea').val(text);\r\n            if(limiter.enabled){\r\n                limiter.updateCounter();\r\n            }\r\n        }\r\n    };\r\n\r\n     /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var $el = $container.find('input, textarea');\r\n\r\n        if(_getFormat(interaction) === 'xhtml'){\r\n            _destroyCkEditor(interaction);\r\n        }\r\n\r\n        //remove event\r\n        $el.off('.commonRenderer');\r\n        $(document).off('.commonRenderer');\r\n\r\n        //remove instructions\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                try {\r\n                    interaction.setResponse(state.response);\r\n                } catch(e) {\r\n                    interaction.resetResponse();\r\n                    throw e;\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    var getCustomData = function(interaction, data){\r\n        var pattern = interaction.attr('patternMask'),\r\n            maxWords = parseInt(patternMaskHelper.parsePattern(pattern,'words')),\r\n            maxLength = parseInt(patternMaskHelper.parsePattern(pattern, 'chars')),\r\n            expectedLength = parseInt(interaction.attr('expectedLines'),10);\r\n        return _.merge(data || {}, {\r\n            maxWords : (! isNaN(maxWords)) ? maxWords : undefined,\r\n            maxLength : (! isNaN(maxLength)) ? maxLength : undefined,\r\n            attributes : (! isNaN(expectedLength)) ? { expectedLength :  expectedLength * 72} : undefined\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the extended text interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'extendedTextInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        getData : getCustomData,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        getState : getState,\r\n        setState : setState,\r\n\r\n        enable : enable,\r\n        disable : disable,\r\n        clearText : clearText,\r\n        setText : setText\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/extendedText', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    \t\t<option value=\\\"\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n    \t\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            <option value=\\\"\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program6(depth0,data) {\n  \n  \n  return \"style=\\\"display:none\\\"\";\n  }\n\nfunction program8(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.patternMask) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.patternMask); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  return escapeExpression(stack1);\n  }\n\nfunction program10(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"value=\\\"\";\n  if (helper = helpers.maxLength) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxLength); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program12(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"value=\\\"\";\n  if (helper = helpers.maxWords) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxWords); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program14(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.expectedLength) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.expectedLength); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  return escapeExpression(stack1);\n  }\n\nfunction program16(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.expectedLines) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.expectedLines); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  return escapeExpression(stack1);\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"format\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Format\", options) : helperMissing.call(depth0, \"__\", \"Format\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Used to control the format of the text entered by the candidate.\", options) : helperMissing.call(depth0, \"__\", \"Used to control the format of the text entered by the candidate.\", options)))\n    + \"</span>\\r\\n    <select name=\\\"format\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n    \t\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.formats), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </select>\\r\\n</div>\\r\\n<hr>\\r\\n<div class=\\\"panel\\\">\\r\\n    <h3 class=\\\"full-width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Contraints\", options) : helperMissing.call(depth0, \"__\", \"Contraints\", options)))\n    + \"</h3>\\r\\n    <select name=\\\"constraint\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.constraints), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </select>\\r\\n</div>\\r\\n<div class=\\\"panel extendedText\\\">\\r\\n    \\r\\n    <div class=\\\"constraint constraint-pattern\\\" \";\n  stack1 = helpers.unless.call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.constraints)),stack1 == null || stack1 === false ? stack1 : stack1.pattern)),stack1 == null || stack1 === false ? stack1 : stack1.selected), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n        <label>\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Pattern\", options) : helperMissing.call(depth0, \"__\", \"Pattern\", options)))\n    + \"\\r\\n        </label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If given, the pattern mask specifies a regular expression that the candidate's response must match in order to be considered valid\", options) : helperMissing.call(depth0, \"__\", \"If given, the pattern mask specifies a regular expression that the candidate's response must match in order to be considered valid\", options)))\n    + \"</span>\\r\\n        <input type=\\\"text\\\" name=\\\"patternMask\\\" value=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.patternMask), {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"/>\\r\\n    </div>\\r\\n    \\r\\n    <div class=\\\"constraint constraint-maxLength\\\" \";\n  stack1 = helpers.unless.call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.constraints)),stack1 == null || stack1 === false ? stack1 : stack1.maxLength)),stack1 == null || stack1 === false ? stack1 : stack1.selected), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n        <label class=\\\"spinner\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max length\", options) : helperMissing.call(depth0, \"__\", \"Max length\", options)))\n    + \"\\r\\n        </label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"We will use the patternMask to do this, to be compliant with the IMS standard\", options) : helperMissing.call(depth0, \"__\", \"We will use the patternMask to do this, to be compliant with the IMS standard\", options)))\n    + \"</span>\\r\\n        <input type=\\\"text\\\" data-min=\\\"0\\\" data-increment=\\\"1\\\" class=\\\"incrementer\\\" name=\\\"maxLength\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.maxLength), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n    </div>\\r\\n    \\r\\n    <div class=\\\"constraint constraint-maxWords\\\" \";\n  stack1 = helpers.unless.call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.constraints)),stack1 == null || stack1 === false ? stack1 : stack1.maxWords)),stack1 == null || stack1 === false ? stack1 : stack1.selected), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n        <label class=\\\"spinner\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max words\", options) : helperMissing.call(depth0, \"__\", \"Max words\", options)))\n    + \"\\r\\n        </label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"We will use the patternMask to do this, to be compliant with the IMS standard\", options) : helperMissing.call(depth0, \"__\", \"We will use the patternMask to do this, to be compliant with the IMS standard\", options)))\n    + \"</span>\\r\\n        <input type=\\\"text\\\" data-min=\\\"0\\\" data-increment=\\\"1\\\" class=\\\"incrementer\\\" name=\\\"maxWords\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.maxWords), {hash:{},inverse:self.noop,fn:self.program(12, program12, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n    </div>\\r\\n</div>\\r\\n<hr>\\r\\n<div class=\\\"panel extendedText\\\">\\r\\n    <h3 class=\\\"full-width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Recommendations\", options) : helperMissing.call(depth0, \"__\", \"Recommendations\", options)))\n    + \"</h3>\\r\\n    <label class=\\\"spinner\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Length\", options) : helperMissing.call(depth0, \"__\", \"Length\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Provides a hint to the candidate as to the expected overall length of the desired response measured in number of characters.\", options) : helperMissing.call(depth0, \"__\", \"Provides a hint to the candidate as to the expected overall length of the desired response measured in number of characters.\", options)))\n    + \"</span>\\r\\n    <input type=\\\"text\\\" data-min=\\\"0\\\" data-increment=\\\"1\\\" class=\\\"incrementer\\\" name=\\\"expectedLength\\\" value=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.expectedLength), {hash:{},inverse:self.noop,fn:self.program(14, program14, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"/>\\r\\n    <label for=\\\"\\\" class=\\\"spinner\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Lines\", options) : helperMissing.call(depth0, \"__\", \"Lines\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Provides a hint to the candidate as to the expected number of lines of input required. A line is expected to have about 72 characters.\", options) : helperMissing.call(depth0, \"__\", \"Provides a hint to the candidate as to the expected number of lines of input required. A line is expected to have about 72 characters.\", options)))\n    + \"</span>\\r\\n    <input type=\\\"text\\\" class=\\\"incrementer\\\" data-min=\\\"0\\\" data-increment=\\\"1\\\" name=\\\"expectedLines\\\" value=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.expectedLines), {hash:{},inverse:self.noop,fn:self.program(16, program16, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2013-2016 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/patternMask',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/extendedText',\r\n], function($, _, __, stateFactory, Question, formElement, renderer, patternMaskHelper, formTpl){\r\n    'use strict';\r\n\r\n    var initState = function initState(){\r\n        // Disable inputs until response edition.\r\n        renderer.disable(this.widget.element);\r\n    };\r\n\r\n    var exitState = function exitState(){\r\n        // Enable inputs until response edition.\r\n        renderer.enable(this.widget.element);\r\n    };\r\n\r\n    var ExtendedTextInteractionStateQuestion = stateFactory.extend(Question, initState, exitState);\r\n\r\n    ExtendedTextInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            $inputs,\r\n            interaction = _widget.element,\r\n            format = interaction.attr('format'),\r\n            patternMask = interaction.attr('patternMask'),\r\n            expectedLength = parseInt(interaction.attr('expectedLength'), 10),\r\n            expectedLines = parseInt(interaction.attr('expectedLines'),10),\r\n            maxWords = parseInt(patternMaskHelper.parsePattern(patternMask,'words'),10),\r\n            maxChars = parseInt(patternMaskHelper.parsePattern(patternMask,'chars'),10);\r\n\r\n        var formats = {\r\n            plain : {label : __(\"Plain text\"), selected : false},\r\n            preformatted : {label : __(\"Pre-formatted text\"), selected : false},\r\n            xhtml : {label : __(\"XHTML\"), selected : false}\r\n        };\r\n\r\n        var constraints = {\r\n            none : {label : __(\"None\"), selected : true},\r\n            maxLength : {label : __(\"Max Length\"), selected : false},\r\n            maxWords : {label : __(\"Max Words\"), selected : false},\r\n            pattern : {label : __(\"Pattern\"), selected : false}\r\n        };\r\n\r\n        /**\r\n         * Set the selected on the right items before sending it to the view for constraints\r\n         */\r\n        if ( !isNaN(maxWords) && maxWords > 0) {\r\n            constraints.none.selected = false;\r\n            constraints.maxWords.selected = true;\r\n        }else if (!isNaN(maxChars) && maxChars > 0) {\r\n            constraints.none.selected = false;\r\n            constraints.maxLength.selected = true;\r\n        }else if( patternMask !== null && patternMask !== undefined && patternMask !== \"\"){\r\n            constraints.none.selected = false;\r\n            constraints.pattern.selected = true;\r\n        }\r\n        /**\r\n         * Set the selected on the right items before sending it to the view for formats\r\n         */\r\n        if(formats[format]){\r\n            formats[format].selected = true;\r\n        }\r\n\r\n        $form.html(formTpl({\r\n            formats : formats,\r\n            patternMask : patternMask,\r\n            maxWords : maxWords,\r\n            maxLength : maxChars,\r\n            expectedLength : expectedLength,\r\n            expectedLines : expectedLines,\r\n            constraints : constraints\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        $inputs = {\r\n            maxLength : $form.find('[name=\"maxLength\"]'),\r\n            maxWords : $form.find('[name=\"maxWords\"]'),\r\n            patternMask : $form.find('[name=\"patternMask\"]')\r\n        };\r\n\r\n        //  init data change callbacks\r\n        var callbacks = {};\r\n\r\n        // -- format Callback\r\n        callbacks.format = function(interaction, attrValue){\r\n            var response = interaction.getResponseDeclaration();\r\n            var correctResponse = _.values(response.getCorrect());\r\n            var previousFormat = interaction.attr('format');\r\n\r\n            //remove the interaction\r\n            renderer.destroy(interaction);\r\n\r\n            //change the format and rerender\r\n            interaction.attr('format', attrValue);\r\n            renderer.render(interaction);\r\n\r\n            if(previousFormat === 'xhtml'){\r\n                if(typeof correctResponse[0] !== 'undefined'){\r\n                    // Get a correct response with all possible html tags removed.\r\n                    // (Why not let jquery do that :-) ?)\r\n                    response.setCorrect($('<p>' + correctResponse[0] + '</p>').text());\r\n                }\r\n            }\r\n        };\r\n        callbacks.constraint = function(interaction,attrValue){\r\n            $('.constraint', $form).hide('500');\r\n            $('.constraint-' + attrValue, $form).show('1000');\r\n            if (attrValue === \"none\") {\r\n                //Reset all constraints\r\n                $('input', $form).val('');\r\n                interaction.attr('patternMask',null);\r\n            }\r\n        };\r\n        callbacks.maxWords = function(interaction, attrValue){\r\n            var newValue = parseInt(attrValue,10);\r\n            if (! isNaN(newValue)) {\r\n                interaction.attr('patternMask', patternMaskHelper.createMaxWordPattern(newValue));\r\n            }\r\n            $inputs.maxLength.val('');\r\n            $inputs.patternMask.val(interaction.attr('patternMask'));\r\n        };\r\n        callbacks.maxLength = function(interaction, attrValue){\r\n            var newValue = parseInt(attrValue,10);\r\n            if(! isNaN(newValue)){\r\n                interaction.attr('patternMask', patternMaskHelper.createMaxCharPattern(newValue));\r\n            }\r\n            $inputs.maxWords.val('');\r\n            $inputs.patternMask.val(interaction.attr('patternMask'));\r\n        };\r\n        callbacks.patternMask = function(interaction, attrValue){\r\n            interaction.attr('patternMask', attrValue);\r\n            /**\r\n             * If anything is entered inside the patternMask, reset maxWords / maxLength(interaction, attrValue)\r\n             */\r\n            $inputs.maxWords.val('');\r\n            $inputs.maxLength.val('');\r\n        };\r\n\r\n        callbacks.expectedLength = function(interaction, attrValue){\r\n            var newValue = parseInt(attrValue,10);\r\n            if(! isNaN(newValue)){\r\n                interaction.attr('expectedLength', attrValue);\r\n            }else{\r\n                interaction.attr('expectedLength', -1);//invalid qti, 0\r\n            }\r\n        };\r\n\r\n        callbacks.expectedLines = function(interactions, attrValue){\r\n            var newValue = parseInt(attrValue,10);\r\n            if(! isNaN(newValue)){\r\n                interaction.attr('expectedLines', attrValue);\r\n            }else{\r\n                interaction.attr('expectedLines',-1);//invalid qti, 0\r\n            }\r\n        };\r\n\r\n        formElement.setChangeCallbacks($form, interaction, callbacks);\r\n    };\r\n\r\n    return ExtendedTextInteractionStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/Correct',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager'\r\n], function(_, __,stateFactory, Correct, renderer, instructionMgr){\r\n\r\n    var ExtendedTextInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n\r\n        _createResponseWidget(this.widget);\r\n\r\n    }, function(){\r\n\r\n        _destroyResponseWidget(this.widget);\r\n\r\n    });\r\n\r\n    var _createResponseWidget = function(widget){\r\n\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var correctResponse = _.values(response.getCorrect());\r\n\r\n        renderer.enable(interaction);\r\n        renderer.setText(interaction, correctResponse[0]);\r\n       \r\n        instructionMgr.appendInstruction(interaction, __('Please type the correct response below.'));\r\n        \r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            response.setCorrect([renderer.getResponse(interaction).base.string]);\r\n        });\r\n    };\r\n\r\n    var _destroyResponseWidget = function(widget){\r\n\r\n        var interaction = widget.element;\r\n        renderer.clearText(interaction);\r\n        \r\n        instructionMgr.removeInstructions(widget.element);\r\n        widget.$container.off('responseChange.qti-widget');\r\n    };\r\n\r\n    return ExtendedTextInteractionStateCorrect;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/Sleep',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction'\r\n], function (stateFactory, Sleep, renderer) {\r\n    'use strict';\r\n    var ExtendedTextInteractionStateSleep = stateFactory.extend(Sleep, function () {\r\n        renderer.disable(this.widget.element);\r\n    }, function () {\r\n        \r\n    });\r\n    return ExtendedTextInteractionStateSleep;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/NoRp',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/NoRp',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction'\r\n], function(stateFactory, NoRp, renderer){\r\n    'use strict';\r\n\r\n    return stateFactory.extend(NoRp, function initStateNoRp(){\r\n\r\n        // Disable inputs until response edition.\r\n        renderer.disable(this.widget.element);\r\n\r\n    }, function exitStateNoRp(){\r\n\r\n        // Enable inputs until response edition.\r\n        renderer.enable(this.widget.element);\r\n    });\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/NoRp'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/Widget',[\r\n'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n'taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/states/states'\r\n], function(Widget, states){\r\n    'use strict';\r\n    var ExtendedTextInteractionWidget = Widget.clone();\r\n\r\n    ExtendedTextInteractionWidget.initCreator = function(){\r\n        this.registerStates(states);\r\n        Widget.initCreator.call(this);\r\n    };\r\n\r\n    return ExtendedTextInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/ExtendedTextInteraction',[\r\n'lodash',\r\n'taoQtiItem/qtiCommonRenderer/renderers/interactions/ExtendedTextInteraction',\r\n'taoQtiItem/qtiCreator/widgets/interactions/extendedTextInteraction/Widget'\r\n], function(_, ExtendedTextInteraction,ExtendedTextInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorExtendedTextInteraction = _.clone(ExtendedTextInteraction);\r\n\r\n    CreatorExtendedTextInteraction.render = function(interaction, options) {\r\n\r\n        ExtendedTextInteraction.render(interaction);\r\n\r\n        ExtendedTextInteractionWidget.build(\r\n            interaction,\r\n            ExtendedTextInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorExtendedTextInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/gapMatchInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-gapMatchInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"gapMatchInteraction\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <ul class=\\\"choice-area none block-listing solid horizontal source\\\" data-eyecatcher=\\\">li\\\">\\r\\n        \";\n  options={hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </ul>\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"qti-flow-container\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction',[\r\n    'lodash',\r\n    'i18n',\r\n    'jquery',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/gapMatchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'interact',\r\n    'ui/interactUtils'\r\n], function(_, __, $, tpl, containerHelper, instructionMgr, pciResponse, interact, interactUtils){\r\n    'use strict';\r\n\r\n    /**\r\n     * Global variable to count number of choice usages:\r\n     * @type {object}\r\n     */\r\n    var _choiceUsages = {};\r\n\r\n    var setChoice = function(interaction, $choice, $target){\r\n\r\n        var choiceSerial = $choice.data('serial'),\r\n            choice = interaction.getChoice(choiceSerial);\r\n\r\n        if(!_choiceUsages[choiceSerial]){\r\n            _choiceUsages[choiceSerial] = 0;\r\n        }\r\n        _choiceUsages[choiceSerial]++;\r\n\r\n        $target\r\n            .data('serial', choiceSerial)\r\n            .html($choice.html())\r\n            .addClass('filled');\r\n\r\n        if(!interaction.responseMappingMode &&\r\n            choice.attr('matchMax') &&\r\n            _choiceUsages[choiceSerial] >= choice.attr('matchMax')){\r\n\r\n            $choice.attr(\"class\", \"deactivated\");\r\n        }\r\n\r\n        containerHelper.triggerResponseChangeEvent(interaction);\r\n    };\r\n\r\n    var unsetChoice = function(interaction, $choice){\r\n\r\n        var serial = $choice.data('serial');\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        $container.find('.choice-area [data-serial=' + serial + ']').removeClass().addClass('qti-choice');\r\n\r\n        _choiceUsages[serial]--;\r\n\r\n        $choice\r\n            .removeClass('filled')\r\n            .removeData('serial')\r\n            .empty();\r\n\r\n        if(!interaction.swapping){\r\n            //set correct response\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n        }\r\n    };\r\n\r\n    var getChoice = function(interaction, identifier){\r\n        var $container = containerHelper.get(interaction);\r\n        return $('.choice-area [data-identifier=' + identifier + ']', $container);\r\n    };\r\n\r\n    var getGap = function(interaction, identifier){\r\n        var $container = containerHelper.get(interaction);\r\n        return $('.qti-flow-container [data-identifier=' + identifier + ']', $container);\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10291\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var $choiceArea = $container.find('.choice-area');\r\n        var $flowContainer = $container.find('.qti-flow-container');\r\n\r\n        var $activeChoice = null;\r\n        var $activeDrop = null;\r\n\r\n        var isDragAndDropEnabled;\r\n        var dragOptions;\r\n\r\n        var $bin = $('<span>', {'class' : 'icon-undo remove-choice', 'title' : __('remove')});\r\n\r\n        var choiceSelector = $choiceArea.selector + \" .qti-choice\";\r\n        var gapSelector = $flowContainer.selector + \" .gapmatch-content\";\r\n        var filledGapSelector = gapSelector + \".filled\";\r\n        var binSelector = $container.selector + \" .remove-choice\";\r\n\r\n        var _getChoice = function(serial){\r\n            return $choiceArea.find('[data-serial=' + serial + ']');\r\n        };\r\n\r\n        var _setChoice = function($choice, $target){\r\n            return setChoice(interaction, $choice, $target);\r\n        };\r\n\r\n        var _resetSelection = function(){\r\n            if($activeChoice){\r\n                $flowContainer.find('.remove-choice').remove();\r\n                $activeChoice.removeClass('deactivated active');\r\n                $container.find('.empty').removeClass('empty');\r\n                $activeChoice = null;\r\n            }\r\n        };\r\n\r\n        var _unsetChoice = function($choice){\r\n            return unsetChoice(interaction, $choice);\r\n        };\r\n\r\n        var _isInsertionMode = function(){\r\n            return ($activeChoice && !$activeChoice.hasClass('filled'));\r\n        };\r\n\r\n        var _isModeEditing = function(){\r\n            return ($activeChoice && $activeChoice.hasClass('filled'));\r\n        };\r\n\r\n\r\n        // Drag & drop handlers\r\n\r\n        if (this.getOption && this.getOption(\"enableDragAndDrop\") && this.getOption(\"enableDragAndDrop\").gapMatch) {\r\n            isDragAndDropEnabled = this.getOption(\"enableDragAndDrop\").gapMatch;\r\n        }\r\n\r\n        function _iFrameDragFix(draggableSelector, target) {\r\n            interactUtils.iFrameDragFixOn(function () {\r\n                if ($activeDrop) {\r\n                    interact(gapSelector).fire({\r\n                        type: 'drop',\r\n                        target: $activeDrop.eq(0),\r\n                        relatedTarget: target\r\n                    });\r\n                }\r\n                interact(draggableSelector).fire({\r\n                    type: 'dragend',\r\n                    target: target\r\n                });\r\n            });\r\n        }\r\n\r\n        if (isDragAndDropEnabled) {\r\n            dragOptions = {\r\n                inertia: false,\r\n                autoScroll: true,\r\n                restrict: {\r\n                    restriction: \".qti-interaction\",\r\n                    endOnly: false,\r\n                    elementRect: {top: 0, left: 0, bottom: 1, right: 1}\r\n                }\r\n            };\r\n\r\n            // makes choices draggables\r\n            interact(choiceSelector).draggable(_.assign({}, dragOptions, {\r\n                onstart: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.addClass(\"dragged\");\r\n                    _handleChoiceSelect($target);\r\n\r\n                    _iFrameDragFix(choiceSelector, e.target);\r\n                },\r\n                onmove: function (e) {\r\n                    interactUtils.moveElement(e.target, e.dx, e.dy);\r\n                },\r\n                onend: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.removeClass(\"dragged\");\r\n\r\n                    interactUtils.restoreOriginalPosition($target);\r\n                    interactUtils.iFrameDragFixOff();\r\n                }\r\n            })).styleCursor(false);\r\n\r\n            // makes filled gaps draggables\r\n            interact(filledGapSelector).draggable(_.assign({}, dragOptions, {\r\n                onstart: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.addClass(\"dragged\");\r\n                    _handleFilledGapSelect($target);\r\n\r\n                    _iFrameDragFix(filledGapSelector, e.target);\r\n                },\r\n                onmove: function (e) {\r\n                    interactUtils.moveElement(e.target, e.dx, e.dy);\r\n                },\r\n                onend: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.removeClass(\"dragged\");\r\n\r\n                    interactUtils.restoreOriginalPosition($target);\r\n\r\n                    if ($activeChoice) {\r\n                        _unsetChoice($activeChoice);\r\n                        _resetSelection();\r\n                    }\r\n                    interactUtils.iFrameDragFixOff();\r\n                }\r\n            })).styleCursor(false);\r\n\r\n            // makes gaps droppables\r\n            interact(gapSelector).dropzone({\r\n                overlap: 0.05,\r\n                ondragenter: function(e) {\r\n                    var $target = $(e.target),\r\n                        $dragged = $(e.relatedTarget);\r\n\r\n                    $activeDrop = $target;\r\n                    $target.addClass('dropzone');\r\n                    $dragged.addClass('droppable');\r\n                },\r\n                ondrop: function (e) {\r\n                    _handleGapSelect($(e.target));\r\n\r\n                    this.ondragleave(e);\r\n                },\r\n                ondragleave: function(e) {\r\n                    var $target = $(e.target),\r\n                        $dragged = $(e.relatedTarget);\r\n\r\n                    $target.removeClass('dropzone');\r\n                    $dragged.removeClass('droppable');\r\n\r\n                    $activeDrop = null;\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        // Point & click handlers\r\n\r\n        interact($container.selector).on('tap', function(e) {\r\n            e.stopPropagation();\r\n            _resetSelection();\r\n        });\r\n\r\n        interact(choiceSelector).on('tap', function (e) {\r\n            e.stopPropagation();\r\n            _handleChoiceSelect($(e.currentTarget));\r\n            e.preventDefault();\r\n        });\r\n\r\n        interact(gapSelector).on('tap', function(e) {\r\n            e.stopPropagation();\r\n            _handleGapSelect($(e.currentTarget));\r\n            e.preventDefault();\r\n        });\r\n\r\n        interact(binSelector).on('tap', function (e) {\r\n            e.stopPropagation();\r\n            _unsetChoice($activeChoice);\r\n            _resetSelection();\r\n            e.preventDefault();\r\n        });\r\n\r\n\r\n        // Common handlers\r\n\r\n        function _handleChoiceSelect($target) {\r\n            if (($activeChoice && $target.hasClass('active')) || $target.hasClass('deactivated')) {\r\n                return;\r\n            }\r\n            _resetSelection();\r\n\r\n            $activeChoice = $target.addClass('active');\r\n            $(gapSelector).addClass('empty');\r\n        }\r\n\r\n        function _handleFilledGapSelect($target) {\r\n            $activeChoice = $target;\r\n            $(gapSelector).addClass('active');\r\n        }\r\n\r\n        function _handleGapSelect($target) {\r\n            var choiceSerial, targetSerial;\r\n\r\n            if(_isInsertionMode()){\r\n                choiceSerial = $activeChoice.data('serial');\r\n                targetSerial = $target.data('serial');\r\n\r\n                if(targetSerial !== choiceSerial){\r\n\r\n                    //set choices:\r\n                    if(targetSerial){\r\n                        _unsetChoice($target);\r\n                    }\r\n\r\n                    _setChoice($activeChoice, $target);\r\n                }\r\n\r\n                $activeChoice.removeClass('active');\r\n                $container.find('.empty').removeClass('empty');\r\n                $activeChoice = null;\r\n\r\n            }else if(_isModeEditing()){\r\n                choiceSerial = $activeChoice.data('serial');\r\n                targetSerial = $target.data('serial');\r\n\r\n                if(targetSerial !== choiceSerial){\r\n                    _unsetChoice($activeChoice);\r\n                    if(targetSerial){\r\n                        //swapping:\r\n                        _unsetChoice($target);\r\n                        _setChoice(_getChoice(targetSerial), $activeChoice);\r\n                    }\r\n                    _setChoice(_getChoice(choiceSerial), $target);\r\n                }\r\n\r\n                _resetSelection();\r\n\r\n            }else if($target.data('serial') && $target.hasClass('filled')){\r\n                targetSerial = $target.data('serial');\r\n\r\n                $activeChoice = $target;\r\n                $activeChoice.addClass('active');\r\n\r\n                $flowContainer.find('>li>div').filter(function(){\r\n                    return $target.data('serial') !== targetSerial;\r\n                }).addClass('empty');\r\n\r\n                $choiceArea.find('>li:not(.deactivated)').filter(function(){\r\n                    return $target.data('serial') !== targetSerial;\r\n                }).addClass('empty');\r\n\r\n                //append trash bin:\r\n                $target.append($bin);\r\n            }\r\n        }\r\n    };\r\n\r\n    var resetResponse = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        $('.gapmatch-content.active', $container).removeClass('active');\r\n        $('.gapmatch-content', $container).each(function(){\r\n            unsetChoice(interaction, $(this));\r\n        });\r\n    };\r\n\r\n    var _setPairs = function(interaction, pairs){\r\n\r\n        _.each(pairs, function(pair){\r\n            if(pair){\r\n                setChoice(interaction, getChoice(interaction, pair[0]), getGap(interaction, pair[1]).find('.gapmatch-content'));\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10291\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n        resetResponse(interaction);\r\n        _setPairs(interaction, pciResponse.unserialize(response, interaction));\r\n    };\r\n\r\n    var _getRawResponse = function(interaction){\r\n\r\n        var response = [];\r\n        var $container = containerHelper.get(interaction);\r\n        $('.gapmatch-content', $container).each(function(){\r\n            var choiceSerial = $(this).data('serial'),\r\n                pair = [];\r\n\r\n            if(choiceSerial){\r\n                pair.push(interaction.getChoice(choiceSerial).attr('identifier'));\r\n            }\r\n            pair.push($(this).data('identifier'));\r\n\r\n            if(pair.length === 2){\r\n                response.push(pair);\r\n            }\r\n        });\r\n        return response;\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10307\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n\r\n        return pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    var destroy = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //remove event\r\n        interact($container.selector).unset();\r\n        interact($container.find('.choice-area').selector + \" .qti-choice\").unset();\r\n        interact($container.find('.qti-flow-container').selector + \" .gapmatch-content\").unset();\r\n        interact($container.find('.remove-choice').selector).unset();\r\n\r\n        //restore selection\r\n        $container.find('.gapmatch-content').empty();\r\n        $container.find('.active').removeClass('active');\r\n        $container.find('.remove-choice').remove();\r\n        $container.find('.empty').removeClass('empty');\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        var $container;\r\n\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n\r\n            //restore order of previously shuffled choices\r\n            if(_.isArray(state.order) && state.order.length === _.size(interaction.getChoices())){\r\n\r\n                $container = containerHelper.get(interaction);\r\n\r\n                $('.choice-area .qti-choice', $container)\r\n                    .sort(function(a, b){\r\n                        var aIndex = _.indexOf(state.order, $(a).data('identifier'));\r\n                        var bIndex = _.indexOf(state.order, $(b).data('identifier'));\r\n                        if(aIndex > bIndex) {\r\n                            return 1;\r\n                        }\r\n                        if(aIndex < bIndex) {\r\n                            return -1;\r\n                        }\r\n                        return 0;\r\n                    })\r\n                    .detach()\r\n                    .appendTo($('.choice-area', $container));\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n\r\n        //we store also the choice order if shuffled\r\n        if(interaction.attr('shuffle') === true){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            state.order = [];\r\n            $('.choice-area .qti-choice', $container).each(function(){\r\n               state.order.push($(this).data('identifier'));\r\n            });\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the gapmatch interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/GapMatchInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'gapMatchInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/selectionWrapper',['jquery'], function($) {\r\n    'use strict';\r\n\r\n    /**\r\n     * @param {Object} options\r\n     * @param {jQuery} options.$container - the element in which the selection is allowed\r\n     * @param {jQuery} options.allowQtiElements - if qtiElements can be wrapped\r\n     */\r\n    return function(options) {\r\n        var $container = options.$container;\r\n        var allowQtiElements = options.allowQtiElements;\r\n\r\n        var selection = window.getSelection();\r\n        var containQtiElement;\r\n\r\n        /**\r\n         * traverse a DOM tree to check if it contains a QTI element\r\n         * @param {Node} rootNode\r\n         */\r\n        function searchQtiElement(rootNode) {\r\n            var childNodes = rootNode.childNodes,\r\n                currentNode, i;\r\n            for (i = 0; i < childNodes.length; i++) {\r\n                currentNode = childNodes[i];\r\n                if (!containQtiElement && isElement(currentNode)) {\r\n                    if(isQtiElement(currentNode)) {\r\n                        containQtiElement = true;\r\n                    } else {\r\n                        searchQtiElement(currentNode);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Check if the given node is an element\r\n         * @param {Node} node\r\n         * @returns {boolean}\r\n         */\r\n        function isElement(node) {\r\n            return node.nodeType === window.Node.ELEMENT_NODE;\r\n        }\r\n\r\n        /**\r\n         * Check if the given node represent a QTI Element\r\n         * @param {Node} node\r\n         * @returns {boolean}\r\n         */\r\n        function isQtiElement(node) {\r\n            return node.className && node.className.indexOf('qti-choice') > -1;\r\n        }\r\n\r\n        /**\r\n         * Check that the given range is in the allowed container\r\n         * @param {Range} range\r\n         * @returns {boolean}\r\n         */\r\n        function isRangeValid(range) {\r\n            return $.contains($container.get(0), range.commonAncestorContainer)\r\n                || $container.get(0).isSameNode(range.commonAncestorContainer);\r\n        }\r\n\r\n        /**\r\n         * The selection wrapper helper\r\n         */\r\n        return {\r\n            /**\r\n             * Can the content of the active selection be wrapped?\r\n             * @returns {boolean|*}\r\n             */\r\n            canWrap: function canWrap() {\r\n                var range = !selection.isCollapsed && selection.getRangeAt(0);\r\n\r\n                if (range) {\r\n                    containQtiElement = false;\r\n                    if (! allowQtiElements) {\r\n                        searchQtiElement(range.cloneContents());\r\n                    }\r\n\r\n                    return range.toString().trim() !== ''\r\n                        && isRangeValid(range)\r\n                        && !containQtiElement;\r\n                }\r\n                return false;\r\n            },\r\n\r\n            /**\r\n             * Wraps the current active selection inside the given element\r\n             * Warning: will lose any event handlers attached to the wrapped nodes!\r\n             *\r\n             * @param {jQuery} $wrapper - the element that will wrap the selection\r\n             * @returns {boolean}\r\n             */\r\n            wrapWith: function wrapWith($wrapper) {\r\n                var range = selection.getRangeAt(0);\r\n\r\n                if (this.canWrap()) {\r\n                    try {\r\n                        range.surroundContents($wrapper[0]);\r\n                        selection.removeAllRanges();\r\n                        return true;\r\n                    } catch (err) {\r\n                        // this happens when wrapping of partially selected nodes is attempted, which would result in an invalid markup\r\n                        // we return false to feedback the wrapping failure\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n        };\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/gapMatch', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, self=this, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"shuffle\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.shuffle), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shuffle choices\", options) : helperMissing.call(depth0, \"__\", \"Shuffle choices\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be \\\"shuffled\\\" of \\\"fixed\\\" individually.\", options) : helperMissing.call(depth0, \"__\", \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be \\\"shuffled\\\" of \\\"fixed\\\" individually.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/gap-create', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"rgt tlb-button\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Create gap\", options) : helperMissing.call(depth0, \"__\", \"Create gap\", options)))\n    + \"\\\" data-role=\\\"create-gap\\\">\\r\\n    <span class=\\\"icon-magicwand\\\"></span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'ui/feedback',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/content',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/selectionWrapper',\r\n    'taoQtiItem/qtiCreator/model/choices/GapText',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/gapMatch',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/gap-create',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/htmlEditorTrigger'\r\n], function(\r\n    $,\r\n    _,\r\n    __,\r\n    feedback,\r\n    stateFactory,\r\n    Question,\r\n    htmlEditor,\r\n    gridContentHelper,\r\n    formElement,\r\n    htmlContentHelper,\r\n    selectionWrapper,\r\n    Choice,\r\n    formTpl,\r\n    newGapTpl,\r\n    toolbarTpl\r\n){\r\n    'use strict';\r\n\r\n    var GapMatchInteractionStateQuestion = stateFactory.extend(Question, function(){\r\n        this.buildEditor();\r\n        //ensure that the cardinality of the interaction response is consistent with thte number of gaps\r\n        this.syncCardinality();\r\n        this.preventSingleChoiceDeletion();\r\n\r\n    }, function(){\r\n        this.destroyEditor();\r\n        this.widget.offEvents('question');\r\n    });\r\n\r\n    GapMatchInteractionStateQuestion.prototype.buildEditor = function buildEditor(){\r\n\r\n        var self = this,\r\n            _widget = this.widget,\r\n            container = _widget.element.getBody(),\r\n            $container = _widget.$container,\r\n            $editableContainer = $container.find('.qti-flow-container'),\r\n            $bodyTlb;\r\n\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n            $bodyTlb = $(toolbarTpl({\r\n                serial : _widget.serial,\r\n                state : 'question'\r\n            }));\r\n\r\n            //add toolbar once only:\r\n            $editableContainer.append($bodyTlb);\r\n            $bodyTlb.show();\r\n\r\n            //init text wrapper\r\n            self.initGapCreator();\r\n\r\n            //hack : prevent ckeditor from removing empty spans\r\n            $container.find('.gapmatch-content').html('...');\r\n\r\n            //create editor\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                shieldInnerContent : false,\r\n                change : gridContentHelper.getChangeCallbackForBlockStatic(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _widget\r\n                }\r\n            });\r\n\r\n            //restore gaps\r\n            $container.find('.gapmatch-content').empty();\r\n        }\r\n    };\r\n\r\n    GapMatchInteractionStateQuestion.prototype.destroyEditor = function destroyEditor(){\r\n\r\n        var $container = this.widget.$container,\r\n            $flowContainer = $container.find('.qti-flow-container'),\r\n            $editable = $container.find('.qti-flow-container [data-html-editable]');\r\n\r\n        //hack : prevent ckeditor from removing empty spans\r\n        $container.find('.gapmatch-content').html('...');\r\n\r\n        //search and destroy the editor\r\n        htmlEditor.destroyEditor($flowContainer);\r\n\r\n        //restore gaps\r\n        $container.find('.gapmatch-content').empty();\r\n\r\n        //remove toolbar\r\n        $flowContainer.find('.mini-tlb[data-role=cke-launcher-tlb]').remove();\r\n\r\n        //remove listeners\r\n        $editable.off('gapcreator');\r\n    };\r\n\r\n    GapMatchInteractionStateQuestion.prototype.initGapCreator = function initGapCreator(){\r\n\r\n        var self = this,\r\n            interactionWidget   = this.widget,\r\n\r\n            $editable           = interactionWidget.$container.find('.qti-flow-container [data-html-editable]'),\r\n            $flowContainer      = interactionWidget.$container.find('.qti-flow-container'),\r\n            $toolbar            = $flowContainer.find('.mini-tlb[data-role=cke-launcher-tlb]'),\r\n            $newGapBtn          = $(newGapTpl()),\r\n            $newGap             = $('<span>', {\r\n                class: 'widget-box',\r\n                'data-new': true,\r\n                'data-qti-class': 'gap'\r\n            }),\r\n\r\n            wrapper = selectionWrapper({\r\n                $container: $editable,\r\n                allowQtiElements: false\r\n            });\r\n\r\n        $toolbar.append($newGapBtn);\r\n        $newGapBtn.hide();\r\n\r\n        $editable\r\n            .on('mouseup.gapcreator', function() {\r\n                if (wrapper.canWrap()) {\r\n                    $newGapBtn.show();\r\n                } else {\r\n                    $newGapBtn.hide();\r\n                }\r\n            })\r\n            .on('blur.gapcreator', function() {\r\n                $newGapBtn.hide();\r\n            });\r\n\r\n        $newGapBtn.on('mousedown.gapcreator', function() {\r\n            $newGapBtn.hide();\r\n            if (wrapper.wrapWith($newGap)) {\r\n                self.createChoiceFromSelection($newGap);\r\n                self.replaceSelectionWithGap();\r\n            } else {\r\n                feedback().error(__('Cannot create gap from this selection. Please check that you do not have partially selected elements.'));\r\n            }\r\n        });\r\n    };\r\n\r\n    GapMatchInteractionStateQuestion.prototype.createChoiceFromSelection = function createChoiceFromSelection($newChoiceContent) {\r\n        var interactionWidget = this.widget,\r\n            interaction = interactionWidget.element,\r\n\r\n            $addChoiceBtn = interactionWidget.$container.find('.choice-area .add-option'),\r\n\r\n            $nestedWidgets,\r\n            nestedElts,\r\n\r\n            newChoiceElt,\r\n            newChoiceBody,\r\n            newChoiceWidget,\r\n\r\n            serial,\r\n\r\n            qtiEltsRegexp = /{{(\\w+?)}}/gm;\r\n\r\n        // look for nested elements by searching for their widgets in the markup\r\n        $nestedWidgets = $newChoiceContent.find('[class^=\"widget-\"],[class*=\" widget-\"]');\r\n\r\n        // Create the new choice body: we replace any widget in the markup by its element placeholder\r\n        if($nestedWidgets && $nestedWidgets.length > 0) {\r\n            $nestedWidgets.each(function() {\r\n                var eltSerial = $(this).data('serial'),\r\n                    elt = interaction.getElement(eltSerial),\r\n                    eltWidget = elt.data('widget');\r\n\r\n                $(this).replaceWith(elt.placeholder());\r\n                eltWidget.destroy();\r\n            });\r\n        }\r\n\r\n        newChoiceBody = $newChoiceContent.html();\r\n        newChoiceElt = interaction.createChoice(newChoiceBody);\r\n\r\n        // update interaction model:\r\n        // the nested elements are moved from the interaction body to the new choice body\r\n        while ((nestedElts = qtiEltsRegexp.exec(newChoiceBody)) !== null) {\r\n            serial = nestedElts[1];\r\n            newChoiceElt.setElement(interaction.getElement(serial));\r\n            interaction.removeElement(serial);\r\n        }\r\n\r\n        // Finally we render the new choice as the last choice in the list and rebuild its widget in the correct state\r\n        $addChoiceBtn.before(newChoiceElt.render());\r\n\r\n        newChoiceElt.postRender();\r\n        newChoiceWidget = newChoiceElt.data('widget');\r\n        newChoiceWidget.changeState('choice');\r\n\r\n    };\r\n\r\n    GapMatchInteractionStateQuestion.prototype.replaceSelectionWithGap = function replaceSelectionWithGap() {\r\n        var interactionWidget = this.widget,\r\n            interaction = interactionWidget.element,\r\n\r\n            $editable = interactionWidget.$container.find('.qti-flow-container [data-html-editable]'),\r\n            newGapElt;\r\n\r\n        htmlContentHelper.createElements(interaction.getBody(), $editable, htmlEditor.getData($editable), function (newGapWidget) {\r\n\r\n            // update model and render it inline\r\n            newGapElt = newGapWidget.element;\r\n            newGapElt.render(newGapElt.getContainer());\r\n            newGapElt.postRender();\r\n\r\n            interaction.setElement(newGapElt);\r\n\r\n            // recreate editing widget\r\n            newGapWidget.destroy();\r\n            newGapWidget = newGapElt.data('widget');\r\n            newGapWidget.changeState('choice');\r\n        });\r\n    };\r\n\r\n    GapMatchInteractionStateQuestion.prototype.syncCardinality = function(){\r\n\r\n        var interaction = this.widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        var updateCardinality = function(data){\r\n\r\n            var cardinality,\r\n                choice = data.element || data.choice;\r\n\r\n            if(choice.qtiClass === 'gap'){\r\n                cardinality = _.size(interaction.getGaps()) === 1 ? 'single' : 'multiple';\r\n                response.attr('cardinality', cardinality);\r\n            }\r\n        };\r\n\r\n        this.widget\r\n            .on('elementCreated', updateCardinality)\r\n            .on('deleted', updateCardinality);\r\n    };\r\n\r\n    GapMatchInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            interaction = _widget.element;\r\n\r\n        $form.html(formTpl({\r\n            shuffle : !!interaction.attr('shuffle')\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        formElement.setChangeCallbacks($form, interaction, {\r\n            shuffle : formElement.getAttributeChangeCallback()\r\n        });\r\n\r\n    };\r\n\r\n    GapMatchInteractionStateQuestion.prototype.preventSingleChoiceDeletion = function(){\r\n\r\n        var interaction = this.widget.element,\r\n            $container = this.widget.$container;\r\n\r\n        var _toggleDeleteButtonVisibility = function(){\r\n\r\n            var choiceCount = 0,\r\n                $deleteButtons = $container.find('.choice-area .qti-choice [data-role=delete]');\r\n\r\n            _.each(interaction.getChoices(), function(choice){\r\n                if(!choice.data('deleting')){\r\n                    choiceCount++;\r\n                }\r\n            });\r\n\r\n            if(choiceCount <= 1){\r\n                $deleteButtons.hide();\r\n            }else{\r\n                $deleteButtons.show();\r\n            }\r\n        };\r\n\r\n        _toggleDeleteButtonVisibility();\r\n\r\n        this.widget\r\n            .on('deleted', _toggleDeleteButtonVisibility)\r\n            .on('choiceCreated', _toggleDeleteButtonVisibility);\r\n\r\n        this.widget.afterStateInit(function(e, element, state){\r\n            if(state.name === 'deleting' && element.is('gapText')){\r\n                _toggleDeleteButtonVisibility();\r\n            }\r\n        }, 'question');\r\n\r\n        this.widget.afterStateExit(function(e, element, state){\r\n            if(state.name === 'deleting' && element.is('gapText')){\r\n                _toggleDeleteButtonVisibility();\r\n            }\r\n        }, 'question');\r\n\r\n    };\r\n\r\n    return GapMatchInteractionStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/Correct',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function(_, __,stateFactory, Correct, commonRenderer, instructionMgr, PciResponse){\r\n\r\n    var GapMatchInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n\r\n        var corrects  = _.values(response.getCorrect());\r\n       \r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction);\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please fill the gap with the correct choices.'));\r\n       \r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n   \r\n        commonRenderer.setResponse(\r\n            interaction, \r\n            PciResponse.serialize(_.invoke(corrects, String.prototype.split, ' '), interaction)\r\n        );\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n           var type = response.attr('cardinality') === 'single' ? 'base' : 'list';\r\n           if(data.response && data.response[type]){\r\n                if(type === 'base'){\r\n                    response.setCorrect(data.response.base.directedPair.join(' '));\r\n                } else {\r\n                    response.setCorrect(   \r\n                        _.map(data.response.list.directedPair, function(pair){\r\n                            return pair.join(' ');\r\n                        })\r\n                    ); \r\n                }\r\n           }\r\n        });\r\n\r\n    }, function(){\r\n        var widget = this.widget;\r\n        var interaction = this.widget.element;\r\n        \r\n        //stop listening responses changes\r\n        widget.$container.off('responseChange.qti-widget');\r\n\r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction);\r\n\r\n        instructionMgr.removeInstructions(interaction);\r\n    });\r\n\r\n    return GapMatchInteractionStateCorrect;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/response/pairScoreMappingForm', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n                    <option value=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</option> \\r\\n                    \";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"style=\\\"display:block\\\"\";\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            \";\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  return buffer;\n  }\n\n  buffer += \"    <div class=\\\"form-container\\\">\\r\\n        <h1>\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h1>\\r\\n\\r\\n        <hr />\\r\\n        <div class=\\\"panel grid-row\\\">\\r\\n            <h2>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add new pairs\", options) : helperMissing.call(depth0, \"__\", \"Add new pairs\", options)))\n    + \":</h2>\\r\\n        </div> \\r\\n        <div class=\\\"panel grid-row\\\">\\r\\n            <div class=\\\"col-4\\\">\\r\\n                <select class=\\\"select2 new-pair-left\\\" data-placeholder=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select a \", options) : helperMissing.call(depth0, \"__\", \"Select a \", options)));\n  if (helper = helpers.leftTitle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.leftTitle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n                    <option></option>\\r\\n                    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.pairLeft), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                </select>\\r\\n             </div>\\r\\n             <div class=\\\"col-4\\\">\\r\\n                <select class=\\\"select2 new-pair-right\\\"  data-placeholder=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select a \", options) : helperMissing.call(depth0, \"__\", \"Select a \", options)));\n  if (helper = helpers.rightTitle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.rightTitle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n                    <option></option>\\r\\n                    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.pairRight), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                </select>\\r\\n             </div>\\r\\n             <div class=\\\"col-1\\\">\\r\\n                &nbsp;\\r\\n            </div>\\r\\n             <div class=\\\"col-2\\\">\\r\\n                <button class=\\\"pair-adder btn-info small\\\"><span class=\\\"icon-add\\\"></span>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add\", options) : helperMissing.call(depth0, \"__\", \"Add\", options)))\n    + \"</button>\\r\\n            </div> \\r\\n        </div>\\r\\n        <hr />\\r\\n        <div class=\\\"panel grid-row heading\\\">\\r\\n             <div class=\\\"col-4\\\">\";\n  if (helper = helpers.leftTitle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.leftTitle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</div>\\r\\n             <div class=\\\"col-3\\\">\";\n  if (helper = helpers.rightTitle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.rightTitle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</div>\\r\\n            \\r\\n            <div class=\\\"col-2\\\" data-edit=\\\"correct\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.defineCorrect), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n                <span>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Correct\", options) : helperMissing.call(depth0, \"__\", \"Correct\", options)))\n    + \"</span>\\r\\n                <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n                <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Is this pair the correct response?\", options) : helperMissing.call(depth0, \"__\", \"Is this pair the correct response?\", options)))\n    + \"</span>\\r\\n            </div>\\r\\n\\r\\n            <div class=\\\"col-2\\\">\\r\\n                <span>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Score\", options) : helperMissing.call(depth0, \"__\", \"Score\", options)))\n    + \"</span>\\r\\n                <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n                <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Set the score for this response\", options) : helperMissing.call(depth0, \"__\", \"Set the score for this response\", options)))\n    + \"</span>\\r\\n            </div>\\r\\n            <div class=\\\"col-1\\\"></div>\\r\\n        </div>\\r\\n\\r\\n        <div class=\\\"panel pairs\\\">\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.pairs), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </div>\\r\\n\\r\\n        <hr />\\r\\n\\r\\n        <span class=\\\"arrow\\\"></span>\\r\\n        <span class=\\\"arrow-cover\\\"></span>\\r\\n    </div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/response/pairScoreForm', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", self=this, escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"style=\\\"display:block\\\"\";\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \" checked=\\\"checked\\\"\";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"data-default=\\\"true\\\"\";\n  }\n\n  buffer += \"<div class=\\\"grid-row\\\">\\r\\n    <div class=\\\"col-4\\\">\\r\\n       \";\n  if (helper = helpers.left) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.left); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </div>\\r\\n    <div class=\\\"col-3\\\">\\r\\n       \";\n  if (helper = helpers.right) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.right); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </div>\\r\\n    \\r\\n    <div class=\\\"col-2\\\" data-edit=\\\"correct\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.defineCorrect), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n        <label>\\r\\n            <input name=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"-correct\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.correct), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n            <span class=\\\"icon-checkbox\\\"></span>\\r\\n        </label>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"col-2\\\">\\r\\n        <input type=\\\"text\\\" \\r\\n               value=\\\"\";\n  if (helper = helpers.score) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.score); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n               name=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"-score\\\" \\r\\n               class=\\\"score\\\" \\r\\n               \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.defaultScore), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"  \\r\\n               data-validate=\\\"$numeric\\\" \\r\\n               data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\" \\r\\n        />\\r\\n    </div>\\r\\n    <div class=\\\"col-1\\\">\\r\\n        <a href=\\\"#\\\" class=\\\"pair-deleter\\\" id=\\\"\";\n  if (helper = helpers.id) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.id); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"-delete\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove pair\", options) : helperMissing.call(depth0, \"__\", \"Remove pair\", options)))\n    + \"\\\"><span class=\\\"icon-bin\\\"></span></a>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/pairScoringForm',[\r\n    'jquery',\r\n    'lodash' ,\r\n    'i18n',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/response/pairScoreMappingForm',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/response/pairScoreForm',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'ui/tooltipster',\r\n    'ui/selecter'\r\n], function($, _, __, formTpl, pairTpl, answerStateHelper, formElementHelper, tooltipster, selecter){\r\n    'use strict';\r\n\r\n    //to bind html element to a pair, we use this separator to replace spaces in the pair name.\r\n    //The colons char isn't allowed by QTI but it is in HTML, so no change to encounter this separator into the pairs id.\r\n    var separator = {\r\n        html : '::',\r\n        qti  : ' '\r\n    };\r\n\r\n    /**\r\n     * Create a new instance of PairScoringForm\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/helpers/pairScoringForm\r\n     * @param {Object} widget - the interaction widget\r\n     * @param {Object} [options]\r\n     * @returns {PairScoringForm} the form compoenent, loaded by default.\r\n     */\r\n    return function formFactory(widget, options){\r\n\r\n        var $container  = widget.$container;\r\n        var interaction = widget.element;\r\n        var response    = interaction.getResponseDeclaration();\r\n        var $popup      = [];\r\n        var pairs       = [];\r\n        var $form;\r\n\r\n        /**\r\n         * The form compoenent\r\n         * @typedef PairScoringForm\r\n         */\r\n        var pairScoringForm = {\r\n\r\n            /**\r\n             * Load / reload the compoenent\r\n             * @memberof PairScoringForm\r\n             * @returns {PairScoringForm} for chaining\r\n             */\r\n            load : function load(){\r\n                var mapEntries      = response.getMapEntries();\r\n\r\n                //create / update the HTML element\r\n                if(!$popup.length){\r\n                    $popup = createPopup($container);\r\n                } else {\r\n                    $popup.empty();\r\n                }\r\n\r\n                if(options){\r\n\r\n                    //prepare content for the form, using either current map entries or data given in options.\r\n                    if(options.entries){\r\n                        pairs = preparePairs(options.entries);\r\n\r\n                        //update the current map entries according to what we got in entry\r\n                        response.removeMapEntries();\r\n                        _.forEach(pairs , function(pair){\r\n                            if(typeof pair.score === 'undefined' || pair.score === null){\r\n                                pair.score = response.mappingAttributes.defaultValue || 0;\r\n                            }\r\n                            response.setMapEntry(pair.id.replace(separator.html, separator.qti), pair.score);\r\n                        });\r\n                    } else {\r\n                        pairs = preparePairs(mapEntries);\r\n                    }\r\n\r\n                    //run the template with the data\r\n                    $form = $(formTpl({\r\n                        'title'             : options.title      || __('Pair scoring'),\r\n                        'leftTitle'         : options.leftTitle || __('Choices'),\r\n                        'rightTitle'        : options.rightTitle  || __('Gap'),\r\n                        'defineCorrect'     : answerStateHelper.defineCorrect(response),\r\n                        'scoreMin'          : response.getMappingAttribute('lowerBound'),\r\n                        'scoreMax'          : response.getMappingAttribute('upperBound'),\r\n                        'pairs'             : _.map(pairs, pairTpl),\r\n                        'pairLeft'          : _.isFunction(options.pairLeft) ? options.pairLeft() : _.values(interaction.getChoices()),\r\n                        'pairRight'         : _.isFunction(options.pairRight) ? options.pairRight() : _.values(interaction.getGapImgs())\r\n                    }));\r\n\r\n                    updateFormBindings();\r\n\r\n                    $popup.append($form);\r\n\r\n                    //initialize UI componenets manually\r\n                    selecter($popup);\r\n                    tooltipster($popup);\r\n                    deleter($popup);\r\n                    adder($popup);\r\n                }\r\n\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Add a new pair\r\n             * @memberof PairScoringForm\r\n             * @param {String} key - the pair key\r\n             * @returns {PairScoringForm} for chaining\r\n             */\r\n            addPair : function addPair(key){\r\n\r\n                var score = response.mappingAttributes.defaultValue;\r\n                var pair  = formatPair(score, key, true);\r\n\r\n                //update internal model\r\n                pairs.push(pair);\r\n\r\n                //update the response\r\n                response.setMapEntry(key, score);\r\n\r\n                $('.pairs', $popup).append(pairTpl(pair));\r\n\r\n                updateFormBindings();\r\n\r\n                if(_.isFunction(options.add)){\r\n                    options.add(key);\r\n                }\r\n\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Remove a pair\r\n             * @memberof PairScoringForm\r\n             * @param {String} key - the pair key to remove\r\n             * @returns {PairScoringForm} for chaining\r\n             */\r\n            removePair : function removePair(key){\r\n\r\n                //update internal model\r\n                _.remove(pairs, {id : key.replace(separator.qti, separator.html)});\r\n\r\n                //update the response\r\n                response.removeMapEntry(key);\r\n\r\n                if(_.isFunction(options.remove)){\r\n                    options.remove(key);\r\n                }\r\n\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Destroy the compoenent\r\n             * @memberof PairScoringForm\r\n             */\r\n            destroy : function(){\r\n                if($popup.length){\r\n                    $popup.remove();\r\n                }\r\n\r\n                //reset overflow\r\n                $('#item-editor-panel').css('overflow', '');\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Set up the pair adder.\r\n         * Disable list options according to the current values.\r\n         *\r\n         * @private\r\n         * @param {jQueryElement} $container - to scope element finding\r\n         */\r\n        function adder($container){\r\n            var $adder   = $('.pair-adder', $container);\r\n            var $left    = $('.new-pair-left', $container);\r\n            var $right   = $('.new-pair-right', $container);\r\n            var $options = $('.select2 > option', $container);\r\n\r\n            //disable options based on existing pairs\r\n            $left.on('change', function(){\r\n                var currentLeft = $left.select2('val'),\r\n                    currentRight = $right.select2('val');\r\n\r\n                $options.removeProp('disabled');\r\n\r\n                _(pairs).where({leftId : currentLeft}).forEach(function(pair){\r\n                    $right.find('option[value=\"' + pair.rightId+ '\"]').prop('disabled', true);\r\n                });\r\n                _(pairs).where({rightId : currentRight}).forEach(function(pair){\r\n                    $left.find('option[value=\"' + pair.leftId+ '\"]').prop('disabled', true);\r\n                });\r\n                if(options.type === 'pair'){\r\n                    _(pairs).where({rightId : currentLeft}).forEach(function(pair){\r\n                        $right.find('option[value=\"' + pair.leftId+ '\"]').prop('disabled', true);\r\n                    });\r\n                }\r\n            });\r\n            $right.on('change', function(){\r\n                var currentRight = $right.select2('val'),\r\n                    currentLeft = $left.select2('val');\r\n\r\n                $options.removeProp('disabled');\r\n\r\n                _(pairs).where({rightId : currentRight}).forEach(function(pair){\r\n                    $left.find('option[value=\"' + pair.leftId+ '\"]').prop('disabled', true);\r\n                });\r\n                _(pairs).where({leftId : currentLeft}).forEach(function(pair){\r\n                    $right.find('option[value=\"' + pair.rightId+ '\"]').prop('disabled', true);\r\n                });\r\n                if(options.type === 'pair'){\r\n                    _(pairs).where({leftId : currentRight}).forEach(function(pair){\r\n                        $left.find('option[value=\"' + pair.rightId+ '\"]').prop('disabled', true);\r\n                    });\r\n                }\r\n            });\r\n\r\n            //create a new pair\r\n            $adder.on('click', function(e){\r\n                var key;\r\n                var lval = $left.select2('val');\r\n                var rval = $right.select2('val');\r\n\r\n                $options.removeProp('disabled');\r\n                e.preventDefault();\r\n\r\n                if(lval && rval){\r\n                    //update the form component\r\n                    if(options.isDirectedPairFlipped){\r\n                        key  = rval + separator.qti + lval;\r\n                    } else {\r\n                        key  = lval + separator.qti + rval;\r\n                    }\r\n                    pairScoringForm.addPair(key);\r\n\r\n                    //reset the select lists\r\n                    $left.select2('val', '');\r\n                    $right.select2('val', '');\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Set up the pair remover.\r\n         * @private\r\n         * @param {jQueryElement} $container - to scope element finding\r\n         */\r\n        function deleter($container){\r\n            $container\r\n              .off('click', '.pair-deleter')\r\n              .on('click', '.pair-deleter', function(e){\r\n                  var $elt, key;\r\n\r\n                  e.preventDefault();\r\n\r\n                  $elt = $(this);\r\n                  key = $elt.attr('id')\r\n                            .replace(/-delete$/, '')\r\n                            .replace(separator.html, separator.qti);\r\n\r\n                  pairScoringForm.removePair(key);\r\n\r\n                  $elt.closest('.grid-row').remove();\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Transform entries to pair object that contains the property required by the template.\r\n         * @private\r\n         * @param {Array} entries - using the response.mapEntries format pair:score, ie.  <pre>{ \"choice1 choice2\" : 3  }</pre>\r\n         * @returns {Array} the pairs as a collection of objects.\r\n         */\r\n        function preparePairs(entries){\r\n            var defaultScore = parseFloat(response.mappingAttributes.defaultValue);\r\n            return _.map(entries, function(value, key){\r\n                return formatPair(value, key, parseFloat(value) === defaultScore);\r\n            });\r\n        }\r\n\r\n\r\n        /**\r\n         * Format a key/score mapping to a pair object used by the template and by this scoring component.\r\n         * @private\r\n         * @param {Number} score - the value mapped to the pair\r\n         * @param {String} key - the pair key\r\n         * @param {Boolean} [defaultScore = false] - is the score the default value\r\n         * @returns {Object} the pair\r\n         */\r\n        function formatPair(score, key, defaultScore){\r\n            var pair   = key.split(separator.qti);\r\n            var choice = options.isDirectedPairFlipped ? pair[0]  : pair[1];\r\n            var gap    = options.isDirectedPairFlipped ? pair[1]  : pair[0];\r\n\r\n            return {\r\n                id              : key.replace(separator.qti, separator.html),\r\n                score           : score,\r\n                defaultScore    : !!defaultScore,\r\n                leftId          : gap,\r\n                rightId         : choice,\r\n                left            : _.isFunction(options.formatLeft) ? options.formatLeft(gap) : gap,\r\n                right           : _.isFunction(options.formatRight) ? options.formatRight(choice) : choice,\r\n                defineCorrect   : answerStateHelper.defineCorrect(response),\r\n                correct         : _.contains(_.values(response.getCorrect()), key)\r\n            };\r\n        }\r\n\r\n        /**\r\n         * Update the form bindings callbacks.\r\n         * @private\r\n         */\r\n        function updateFormBindings(){\r\n            var callbacks = {};\r\n            var corrects  = _.values(response.getCorrect());\r\n\r\n            if($form.length){\r\n\r\n               //the default value changes\r\n                widget.on('mappingAttributeChange', function(data){\r\n                    if(data.key === 'defaultValue'){\r\n                        _.forEach(pairs, function(pair){\r\n                            var $score = $('[name=\"' +  pair.id + '-score\"]', $form);\r\n                            if($score.data('default')){\r\n                                $score.val(data.value);\r\n                                response.setMapEntry( pair.id.replace(separator.html, separator.qti), data.value);\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n\r\n                //creates callbacls for score and correct, for each pair\r\n                _.forEach(pairs, function(pair){\r\n                    var id = pair.id.replace(separator.html, separator.qti);\r\n                    callbacks[pair.id + '-score'] = function(response, value){\r\n                        $('[name=\"' +  pair.id + '-score\"]', $form).removeAttr('data-default').removeData('default');\r\n                        response.setMapEntry(id, value);\r\n                    };\r\n                    callbacks[pair.id + '-correct'] = function(response, value){\r\n                        if(value === true){\r\n                            if(!_.contains(corrects, id)){\r\n                                corrects.push(id);\r\n                            }\r\n                        } else {\r\n                            corrects = _.without(corrects, id);\r\n                        }\r\n                        response.setCorrect(corrects);\r\n                    };\r\n                });\r\n\r\n                //set up the form data binding\r\n                formElementHelper.setChangeCallbacks($form, response, callbacks);\r\n            }\r\n        }\r\n\r\n        return pairScoringForm.load();\r\n    };\r\n\r\n    /**\r\n     * Creates a popup relative to container\r\n     * @private\r\n     * @returns {jQueryElement} the popup\r\n     */\r\n    function createPopup($container){\r\n        var $element    = $('<div class=\"mapping-editor arrow-top-left\"></div>');\r\n        var width       = $container.innerWidth();\r\n        var height      = $container.innerHeight();\r\n\r\n        //only one\r\n        $('.mapping-editor', $container).remove();\r\n\r\n        //style and attach the form\r\n        $element.css({\r\n            'top'       : height - 30,\r\n            'width'     : width - 100\r\n        }).appendTo($container);\r\n\r\n        return $element;\r\n    }\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/Map',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/pairScoringForm' \r\n], function($, _, __, stateFactory, Map, commonRenderer, instructionMgr, PciResponse, scoringFormFactory){\r\n\r\n    /**\r\n     * Initialize the state.\r\n     */\r\n    function initMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var corrects  = _.values(response.getCorrect());\r\n        var currentResponses =  _.size(response.getMapEntries()) === 0 ? corrects : _.keys(response.getMapEntries());\r\n\r\n        \r\n        //really need to destroy before ? \r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction);\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please fill the gap with the texts below, then edit the score for each pair.'));\r\n        \r\n        //set the current mapping mode, needed by the common renderer\r\n        interaction.responseMappingMode = true;\r\n \r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n    \r\n        //change the display of the gaps\r\n        displayGaps(widget.$container);\r\n\r\n        //and initialize the scoring form\r\n        if(_.size(response.getMapEntries()) === 0){\r\n            updateForm(widget, corrects);\r\n        } else {\r\n            updateForm(widget);\r\n        }\r\n        \r\n        //each response change leads to an update of the scoring form\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            var type  = response.attr('cardinality') === 'single' ? 'base' : 'list';\r\n            var pairs, entries;\r\n            if(data && data.response &&  data.response[type]){\r\n               pairs = _.invoke(data.response[type].directedPair, Array.prototype.join, ' ');\r\n               entries = _.keys(response.getMapEntries());\r\n                \r\n               //add new pairs from  the difference between the current entries and the given data\r\n               _(pairs).difference(entries).forEach(interaction.pairScoringForm.addPair, interaction.pairScoringForm);\r\n            }\r\n\r\n            displayGaps(widget.$container);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Exit the map state\r\n     */\r\n    function exitMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        \r\n        widget.$container.off('responseChange.qti-widget');\r\n\r\n        if(interaction.pairScoringForm){\r\n            interaction.pairScoringForm.destroy();\r\n        }\r\n\r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction);\r\n\r\n        instructionMgr.removeInstructions(interaction);\r\n    }\r\n\r\n    /**\r\n     * The gap in this states show their identifier, to visually identify them.\r\n     * @param {jQueryElement} $container - the interaction container\r\n     */\r\n    function displayGaps($container){\r\n        $('.gapmatch-content', $container)\r\n          .removeClass('filled')            //this disable gap selection\r\n          .addClass('gap-info')\r\n          .each(function(){\r\n            var $elt = $(this);\r\n            $elt.text($elt.data('identifier'));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Update the scoring form\r\n     * @param {Object} widget - the current widget\r\n     * @param {Array} [entries] - to force the use of this collection instead of the mapEntries\r\n     */\r\n    function updateForm(widget, entries){\r\n\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var mapEntries = response.getMapEntries();\r\n\r\n        //keep a map of choices descriptions for the formatLeft callback\r\n        var formatedChoices = _.transform(interaction.getChoices(), function(acc, choice){\r\n            acc[choice.id()] = choice.val();\r\n        }, {});\r\n\r\n        var mappingChange = function mappingChange(){\r\n            //set the current responses, either the mapEntries or the corrects if nothing else\r\n            commonRenderer.setResponse(\r\n                interaction, \r\n                PciResponse.serialize(_.invoke(_.keys(response.getMapEntries()), String.prototype.split, ' '), interaction)\r\n            );\r\n        };\r\n\r\n        //set up the scoring form options\r\n        var options = {\r\n            leftTitle : __('Choice'),\r\n            rightTitle : __('Gap'),\r\n            type : 'directedPair',\r\n            pairLeft : function(){\r\n                return _.map(interaction.getChoices(), function(choice){\r\n                    return {\r\n                        id : choice.id(),\r\n                        value : choice.val()\r\n                    };\r\n                });\r\n            },\r\n            pairRight : function(){\r\n                return _.map(interaction.getGaps(), function(gap){\r\n                    return {\r\n                        id : gap.id(),\r\n                        value : gap.id()\r\n                    };\r\n                });\r\n            },\r\n            formatLeft : function(value){\r\n                return formatedChoices[value] || value;\r\n            }\r\n        };\r\n\r\n        //format the entries to match the needs of the scoring form\r\n        if(entries){\r\n            options.entries = _.transform(entries, function(result, value){\r\n                result[value] = mapEntries[value] !== undefined ? mapEntries[value] : response.mappingAttributes.defaultValue;\r\n            }, {}); \r\n        }\r\n\r\n        //initialize the scoring form \r\n        interaction.pairScoringForm = scoringFormFactory(widget, options);\r\n    }\r\n\r\n    /**\r\n     * The map answer state for the graphicGapMatch interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Map\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Map\r\n     */\r\n    return  stateFactory.create(Map, initMapState, exitMapState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/Map'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/states'\r\n], function(Widget, states){\r\n\r\n    var GapMatchInteractionWidget = Widget.clone();\r\n\r\n    GapMatchInteractionWidget.initCreator = function(){\r\n        \r\n        this.registerStates(states);\r\n        \r\n        Widget.initCreator.call(this);\r\n    };\r\n    \r\n    return GapMatchInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/GapMatchInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GapMatchInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/Widget'\r\n], function(_, GapMatchInteraction, GapMatchInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorGapMatchInteraction = _.clone(GapMatchInteraction);\r\n\r\n    CreatorGapMatchInteraction.render = function(interaction, options){\r\n\r\n        GapMatchInteractionWidget.build(\r\n            interaction,\r\n            GapMatchInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorGapMatchInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/graphicAssociateInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-graphicInteraction qti-graphicAssociateInteraction clearfix\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"image-editor solid\\\">\\r\\n        <div id='graphic-paper-\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' class=\\\"main-image-box\\\"></div>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine(\"json!taoQtiItem/qtiCommonRenderer/renderers/graphic-style.json\", function(){ return {    \r\n    \"basic\" : {\r\n        \"stroke\" : \"#8D949E\",\r\n        \"stroke-width\" : 2,\r\n        \"stroke-dasharray\": \"\",\r\n        \"stroke-linejoin\" : \"round\",\r\n        \"fill\" : \"#cccccc\",\r\n        \"fill-opacity\" : 0.5,\r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"hover\"  : {\r\n        \"stroke\" : \"#3E7DA7\",\r\n        \"fill\" :  \"#0E5D91\", \r\n        \"fill-opacity\" : 0.3\r\n    },\r\n    \"selectable\"  : {\r\n        \"stroke-dasharray\": \"-\",\r\n        \"stroke\" : \"#3E7DA7\",\r\n        \"fill\" : \"#cccccc\",\r\n        \"fill-opacity\" : 0.5\r\n    },\r\n    \"active\" : {\r\n        \"stroke\" : \"#3E7DA7\",\r\n        \"stroke-dasharray\": \"\",\r\n        \"fill\" :  \"#0E5D91\",\r\n        \"fill-opacity\" : 0.5\r\n    },\r\n    \"error\" : {\r\n        \"stroke\" : \"#C74155\",\r\n        \"stroke-dasharray\": \"\",\r\n        \"fill-opacity\" : 0.5,\r\n        \"fill\" :  \"#661728\"  \r\n    },\r\n    \"success\" : {\r\n        \"stroke\" : \"#C74155\",\r\n        \"stroke-dasharray\": \"\",\r\n        \"fill\" :  \"#0E914B\",\r\n        \"fill-opacity\" : 0.5\r\n    },\r\n    \"layer\" : {\r\n        \"fill\" :  \"#ffffff\", \r\n        \"opacity\" : 0, \r\n        \"cursor\": \"pointer\"\r\n    },\r\n    \"creator\" : {\r\n        \"fill-opacity\" : 0.5,\r\n        \"stroke\" : \"#3E7DA7\",\r\n        \"stroke-dasharray\": \"\",\r\n        \"fill\" :  \"#0E5D91\", \r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"imageset-rect-stroke\" : {\r\n            \"fill\" : \"#ffffff\",\r\n            \"stroke\" : \"#666666\",\r\n            \"stroke-width\" : 1,\r\n            \"stroke-linejoin\" : \"round\",\r\n            \"cursor\" : \"pointer\"\r\n    },\r\n    \"imageset-rect-no-stroke\" : {\r\n            \"fill\" : \"#ffffff\",\r\n            \"stroke\" : \"#ffffff\",\r\n            \"stroke-width\" : 2,\r\n            \"stroke-linejoin\" : \"round\",\r\n            \"cursor\" : \"pointer\"\r\n    },\r\n    \"imageset-img\" : {\r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"order-text\" : {\r\n        \"fill\" : \"#ffffff\",\r\n        \"stroke\": \"#000000\",\r\n        \"stroke-width\" : 0.7,\r\n        \"font-family\" : \"sans-serif\",\r\n        \"font-weight\": \"bold\", \r\n        \"font-size\" : 22,\r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"score-text-default\" : {\r\n        \"stroke\": \"#444444\",\r\n        \"stroke-width\" : 0.5,\r\n        \"font-family\" : \"sans-serif\",\r\n        \"font-weight\": \"normal\", \r\n        \"font-size\" : 20,\r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"score-text\" : {\r\n        \"stroke\": \"#000000\",\r\n        \"stroke-width\" : 0.5,\r\n        \"font-family\" : \"sans-serif\",\r\n        \"font-weight\": \"normal\", \r\n        \"font-size\" : 20,\r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"small-text\" : {\r\n        \"stroke\": \"#000000\",\r\n        \"stroke-width\" : 0.5,\r\n        \"font-family\" : \"sans-serif\",\r\n        \"font-weight\": \"normal\", \r\n        \"font-size\" : 16,\r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"layer-pos-text\" : {\r\n        \"stroke\": \"#333\",\r\n        \"stroke-width\" : 0.5,\r\n        \"font-family\" : \"sans-serif\",\r\n        \"font-weight\": \"normal\", \r\n        \"font-size\" : 14\r\n    },\r\n    \"target\" : {\r\n        \"path\" : \"m 18,8.4143672 -1.882582,0 C 15.801891,4.9747852 13.071059,2.2344961 9.63508,1.9026738 L 9.63508,0 8.2305176,0 l 0,1.9026387 C 4.7947148,2.2343027 2.0637246,4.9746621 1.7481973,8.4143672 l -1.7481973,0 0,1.4045625 1.754877,0 c 0.3460429,3.4066753 3.0632871,6.1119843 6.4756406,6.4413813 l 0,1.739689 1.4045624,0 0,-1.739725 c 3.412547,-0.329537 6.129633,-3.034793 6.475641,-6.4413453 l 1.889279,0 z m -8.36492,6.5188648 0,-4.064673 -1.4045624,0 0,4.063882 C 5.5511016,14.612555 3.4232695,12.494619 3.0864551,9.8189297 l 4.0449512,0 0,-1.4045625 -4.0546368,0 C 3.3788672,5.6984941 5.5228887,3.5393379 8.2305176,3.2161113 l 0,3.9153125 1.4045624,0 0,-3.9160859 c 2.711162,0.3203965 4.858576,2.4808887 5.160955,5.1990293 l -3.927441,0 0,1.4045625 3.917773,0 C 14.449289,12.496957 12.318363,14.616158 9.63508,14.933232 z\",\r\n        \"fill\" : \"#0E914B\",\r\n        \"width\" : 1,\r\n        \"stroke-width\" : 0,\r\n        \"cursor\" : \"pointer\"\r\n    },\r\n    \"target-hover\" : {\r\n        \"fill\" : \"#3E7DA7\", \r\n        \"fill-opacity\" : 1\r\n    },\r\n    \"target-success\" : {\r\n        \"fill\" : \"#0E914B\", \r\n        \"fill-opacity\" : 1\r\n   },\r\n   \"assoc\" : {\r\n        \"stroke-width\" : 2, \r\n        \"stroke-linecap\" : \"round\", \r\n        \"cursor\" : \"pointer\"\r\n   },\r\n   \"assoc-layer\" : {\r\n        \"stroke-width\" : 12, \r\n        \"cursor\" : \"pointer\", \r\n        \"stroke-opacity\" : 0\r\n   },\r\n   \"assoc-bullet\" : {\r\n        \"fill\": \"#000000\"\r\n   },\r\n    \"close\" : {\r\n        \"path\" : \"m 8.9997236,18.000001 c -4.9703918,0 -8.99972284217367,-4.02901 -8.99972284217367,-9 C 7.5782633e-7,4.029011 4.0293108,9.8531742e-7 8.9997236,9.8531742e-7 13.970691,9.8531742e-7 18.000001,4.029011 18.000001,9.000001 c 0,4.97099 -4.02931,9 -9.0002774,9 z m 0.0045,-16.37151 c -4.06191,0 -7.35492,3.29635 -7.35492,7.36251 0,4.06562 3.292989,7.36255 7.35492,7.36255 4.0630384,0 7.3554334,-3.29693 7.3554334,-7.36255 0,-4.06614 -3.292969,-7.36251 -7.3554334,-7.36251 v 0 z m 3.1314894,9.31167 -1.953823,-1.94014 1.953843,-1.94018 c 0.08964,-0.089 0.134622,-0.19099 0.135073,-0.30584 4.31e-4,-0.11488 -0.04383,-0.21712 -0.132838,-0.30681 l -0.54267,-0.54685 c -0.08898,-0.0897 -0.190903,-0.13473 -0.305719,-0.13514 -0.114837,-4.4e-4 -0.217064,0.0439 -0.306703,0.1329 l -1.9623724,1.94865 -1.962395,-1.94865 c -0.08964,-0.089 -0.191845,-0.13336 -0.306702,-0.1329 -0.114837,4.3e-4 -0.216736,0.0455 -0.305719,0.13514 l -0.54265,0.54685 c -0.08902,0.0897 -0.133269,0.19193 -0.132838,0.30681 4.3e-4,0.11485 0.04543,0.21681 0.135073,0.30584 l 1.953823,1.94018 -1.953782,1.94014 c -0.0896,0.089 -0.134684,0.19094 -0.135114,0.3058 -4.31e-4,0.11486 0.04386,0.21716 0.132838,0.30681 l 0.542671,0.54687 c 0.08896,0.0897 0.190923,0.13467 0.305718,0.13516 0.114857,3.9e-4 0.217105,-0.0439 0.306724,-0.13288 l 1.962332,-1.94863 1.9623324,1.94863 c 0.08962,0.089 0.191886,0.13323 0.306744,0.13288 0.114836,-4.5e-4 0.216736,-0.0455 0.305698,-0.13516 l 0.542691,-0.54687 c 0.089,-0.0897 0.133227,-0.19193 0.132838,-0.30681 -3.9e-4,-0.1149 -0.0455,-0.21683 -0.135073,-0.3058 z\",\r\n        \"fill\" : \"#0E5D91\",\r\n        \"width\" : 1,\r\n        \"opacity\" : 0,\r\n        \"stroke-width\" : 0,\r\n        \"cursor\" : \"pointer\"\r\n   },\r\n   \"close-bg\" : {\r\n        \"fill\" : \"#ffffff\",\r\n        \"stroke\" : \"none\",\r\n        \"cursor\" : \"pointer\",\r\n        \"opacity\" : 0  \r\n    },\r\n    \"touch-circle\" : {\r\n        \"fill\" : \"none\", \r\n        \"stroke\" : \"#3E7DA7\",\r\n        \"stroke-width\" : 2\r\n    }\r\n}\r\n;});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\n\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/Graphic',[\r\n    'jquery',\r\n    'lodash',\r\n    'raphael',\r\n    'scale.raphael',\r\n    'json!taoQtiItem/qtiCommonRenderer/renderers/graphic-style.json'\r\n], function($, _, raphael, scaleRaphael, gstyle) {\r\n    'use strict';\r\n\r\n\r\n    //maps the QTI shapes to Raphael shapes\r\n    var shapeMap = {\r\n        'default' : 'rect',\r\n        'poly'    : 'path'\r\n    };\r\n\r\n\r\n    //length constraints to validate coords\r\n    var coordsValidator = {\r\n        'rect'    : 4,\r\n        'ellipse' : 4,\r\n        'circle'  : 3,\r\n        'poly'    : 6,\r\n        'default' : 0\r\n    };\r\n\r\n\r\n    //transform the coords from the QTI system to Raphael system\r\n    var qti2raphCoordsMapper = {\r\n\r\n        /**\r\n         * Rectangle coordinate mapper:  from left-x,top-y,right-x-bottom-y to x,y,w,h\r\n         * @param {Array} coords - QTI coords\r\n         * @returns {Array} raphael coords\r\n         */\r\n        'rect' : function(coords) {\r\n            return [\r\n                coords[0],\r\n                coords[1],\r\n                coords[2] - coords[0],\r\n                coords[3] - coords[1]\r\n            ];\r\n        },\r\n\r\n\r\n        /**\r\n         * Creates the coords for a default shape (a rectangle that covers all the paper)\r\n         * @param {Raphael.Paper} paper - the paper\r\n         * @returns {Array} raphael coords\r\n         */\r\n        'default' : function(paper) {\r\n            return [ 0, 0, paper.width, paper.height ];\r\n        },\r\n\r\n\r\n        /**\r\n         * polygone coordinate mapper:  from x1,y1,...,xn,yn to SVG path format\r\n         * @param {Array} coords - QTI coords\r\n         * @returns {Array} path desc\r\n         */\r\n        'poly' : function(coords) {\r\n            var a;\r\n            var size = coords.length;\r\n\r\n            // autoClose if needed\r\n            if ((coords[0] !== coords[size - 2]) && (coords[1] !== coords[size - 1])) {\r\n                coords.push(coords[0]);\r\n                coords.push(coords[1]);\r\n            }\r\n\r\n            // move to first point\r\n            coords[0] = \"M\" + coords[0];\r\n\r\n            for(a = 1; a < size; a++) {\r\n                if (a % 2 === 0) {\r\n                    coords[a] = \"L\" + coords[a];\r\n                }\r\n            }\r\n\r\n            return [coords.join(\" \")];\r\n        }\r\n    };\r\n\r\n    //transform the coords from a raphael shape to the QTI system\r\n    var raph2qtiCoordsMapper = {\r\n\r\n        /**\r\n         * Rectangle coordinate mapper: from x,y,w,h to left-x,top-y,right-x-bottom-y\r\n         * @param {Object} attr - Raphael Element's attributes\r\n         * @returns {Array} qti based coords\r\n         */\r\n        'rect' : function(attr) {\r\n            return [\r\n                attr.x,\r\n                attr.y,\r\n                attr.x + attr.width,\r\n                attr.y + attr.height\r\n            ];\r\n        },\r\n\r\n\r\n        /**\r\n         * Circle coordinate mapper\r\n         * @param {Object} attr - Raphael Element's attributes\r\n         * @returns {Array} qti based coords\r\n         */\r\n        'circle' : function(attr) {\r\n            return [\r\n                attr.cx,\r\n                attr.cy,\r\n                attr.r\r\n            ];\r\n        },\r\n\r\n\r\n        /**\r\n         * Ellispe coordinate mapper\r\n         * @param {Object} attr - Raphael Element's attributes\r\n         * @returns {Array} qti based coords\r\n         */\r\n        'ellipse' : function(attr) {\r\n            return [\r\n                attr.cx,\r\n                attr.cy,\r\n                attr.rx,\r\n                attr.ry\r\n            ];\r\n        },\r\n\r\n\r\n        /**\r\n         * Get the coords for a default shape (a rectangle that covers all the paper)\r\n         * @param {Object} attr - Raphael Element's attributes\r\n         * @returns {Array} qti based coords\r\n         */\r\n        'default' : function(attr) {\r\n            return this.rect(attr);\r\n        },\r\n\r\n\r\n        /**\r\n         * polygone coordinate mapper:  from SVG path (available as segments) to x1,y1,...,xn,yn format\r\n         * @param {Raphael.Paper} paper - the paper\r\n         * @returns {Array} raphael coords\r\n         */\r\n        'path' : function(attr) {\r\n            var poly = [];\r\n            var i;\r\n\r\n            if (_.isArray(attr.path)) {\r\n                for(i = 1; i < attr.path.length; i++) {\r\n                    if (attr.path[i].length === 3) {\r\n                        poly.push(attr.path[i][1]);\r\n                        poly.push(attr.path[i][2]);\r\n                    }\r\n                }\r\n            }\r\n\r\n            return poly;\r\n        }\r\n    };\r\n\r\n\r\n    /**\r\n     * Graphic interaction helper\r\n     * @exports qtiCommonRenderer/helpers/Graphic\r\n     */\r\n    var GraphicHelper = {\r\n\r\n        /**\r\n         * Raw access to the styles\r\n         * @type {Object}\r\n         */\r\n        _style : gstyle,\r\n\r\n\r\n        /**\r\n         * Apply the style defined by name to the element\r\n         * @param {Raphael.Element} element - the element to change the state\r\n         * @param {String} state - the name of the state (from states) to switch to\r\n         */\r\n        setStyle : function(element, name) {\r\n            if (element && gstyle[name]) {\r\n                element.attr(gstyle[name]);\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * Create a Raphael paper with a bg image, that is width responsive\r\n         * @param {String} id - the id of the DOM element that will contain the paper\r\n         * @param {String} serial - the interaction unique indentifier\r\n         * @param {Object} options - the paper parameters\r\n         * @param {String} options.img - the url of the background image\r\n         * @param {jQueryElement} [options.container] - the parent of the paper element (got the closest parent by default)\r\n         * @param {Number} [options.width] - the paper width\r\n         * @param {Number} [options.height] - the paper height\r\n         * @param {String} [options.imgId] - an identifier for the image element\r\n         * @param {Function} [options.done] - executed once the image is loaded\r\n         * @returns {Raphael.Paper} the paper\r\n         */\r\n        responsivePaper : function(id, serial, options) {\r\n\r\n            var paper, image;\r\n\r\n            var $container = options.container || $('#' + id).parent();\r\n            var $editor    = $('.image-editor', $container);\r\n            var $body      = $container.closest('.qti-itemBody');\r\n            var resizer    = _.throttle(resizePaper, 10);\r\n\r\n            var imgWidth  = options.width  || $container.innerWidth();\r\n            var imgHeight = options.height || $container.innerHeight();\r\n\r\n            paper    = scaleRaphael(id, imgWidth, imgHeight);\r\n            image    = paper.image(options.img, 0, 0, imgWidth, imgHeight);\r\n            image.id = options.imgId || image.id;\r\n            paper.setViewBox(0, 0, imgWidth, imgHeight);\r\n\r\n            resizer();\r\n\r\n            //retry to resize once the SVG is loaded\r\n            $(image.node)\r\n                .attr('externalResourcesRequired', 'true')\r\n                .on('load', resizer);\r\n\r\n            if (raphael.type === 'SVG') {\r\n                // TODO: move listeners somewhere they can be easily turned off\r\n                $(window).on('resize.qti-widget.'  + serial, resizer);\r\n                // TODO: favor window resize event and deprecate $container resive event (or don't allow $container to be destroyed and rebuilt\r\n                $container.on('resize.qti-widget.' + serial, resizer);\r\n                $(document).on('customcssloaded.styleeditor', resizer);\r\n            } else {\r\n                $container.find('.main-image-box').width(imgWidth);\r\n                if (typeof options.resize === 'function') {\r\n                    options.resize(imgWidth, 1);\r\n                }\r\n            }\r\n\r\n            /**\r\n             * scale the raphael paper\r\n             * @private\r\n             */\r\n            function resizePaper(e, givenWidth) {\r\n                var diff, maxWidth, containerWidth, containerHeight, factor;\r\n\r\n                if (e) {\r\n                    e.stopPropagation();\r\n                }\r\n\r\n                diff           = ($editor.outerWidth() - $editor.width()) + ($container.outerWidth() - $container.width()) + 1;\r\n                maxWidth       = $body.width();\r\n                containerWidth = $container.innerWidth();\r\n\r\n                if (containerWidth > 0 || givenWidth > 0) {\r\n\r\n                    if (givenWidth < containerWidth && givenWidth < maxWidth) {\r\n                        containerWidth = givenWidth - diff;\r\n                    } else if (containerWidth > maxWidth) {\r\n                        containerWidth = maxWidth - diff;\r\n                    } else {\r\n                        containerWidth -= diff;\r\n                    }\r\n\r\n                    factor          = containerWidth / imgWidth;\r\n                    containerHeight = imgHeight * factor;\r\n\r\n                    if (containerWidth > 0) {\r\n                        paper.changeSize(containerWidth, containerHeight, false, false);\r\n                    }\r\n\r\n                    if (typeof options.resize === 'function') {\r\n                        options.resize(containerWidth, factor);\r\n                    }\r\n\r\n                    $container.trigger('resized.qti-widget');\r\n                }\r\n            }\r\n\r\n            return paper;\r\n        },\r\n\r\n\r\n        /**\r\n         * Create a new Element into a raphael paper\r\n         * @param {Raphael.Paper} paper - the interaction paper\r\n         * @param {String} type - the shape type\r\n         * @param {String|Array.<Number>} coords - qti coords as a string or an array of number\r\n         * @param {Object} [options] - additional creation options\r\n         * @param {String} [options.id] - to set the new element id\r\n         * @param {String} [options.title] - to set the new element title\r\n         * @param {String} [options.style = basic] - to default style\r\n         * @param {Boolean} [options.hover = true] - to disable the default hover state\r\n         * @param {Boolean} [options.touchEffect = true] - a circle appears on touch\r\n         * @param {Boolean} [options.qtiCoords = true] - if the coords are in QTI format\r\n         * @returns {Raphael.Element} the created element\r\n         */\r\n        createElement : function(paper, type, coords, options) {\r\n            var self = this;\r\n            var element;\r\n            var shaper = shapeMap[type] ? paper[shapeMap[type]] : paper[type];\r\n            var shapeCoords = options.qtiCoords !== false ? self.raphaelCoords(paper, type, coords) : coords;\r\n\r\n            if (typeof shaper === 'function') {\r\n                element = shaper.apply(paper, shapeCoords);\r\n                if (element) {\r\n                    if (options.id) {\r\n                        element.id = options.id;\r\n                    }\r\n\r\n                    if (options.title) {\r\n                        element.attr('title', options.title);\r\n                    }\r\n\r\n                    element.attr(gstyle[options.style || 'basic']).toFront();\r\n\r\n                    //prevent issue in firefox 37\r\n                    $(element.node).removeAttr('stroke-dasharray');\r\n\r\n                    if (options.hover !== false) {\r\n                        element.hover(function() {\r\n                            if (!element.flashing) {\r\n                                self.updateElementState(this, 'hover');\r\n                            }\r\n                        }, function() {\r\n                            if (!element.flashing) {\r\n                                self.updateElementState(this, this.active ? 'active' : this.selectable ? 'selectable' : 'basic');\r\n                            }\r\n                        });\r\n                    }\r\n\r\n                    if (options.touchEffect !== false) {\r\n                        element.touchstart(function() {\r\n                            self.createTouchCircle(paper, element.getBBox());\r\n                        });\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                throw new Error('Unable to find method ' + type + ' on paper');\r\n            }\r\n\r\n            return element;\r\n        },\r\n\r\n\r\n        /**\r\n         * Create target point\r\n         * @param {Raphael.Paper} paper - the paper\r\n         * @param {Object} [options]\r\n         * @param {Object} [options.id] - and id to identify the target\r\n         * @param {Object} [options.point] - the point to add to the paper\r\n         * @param {Number} [options.point.x = 0] - point's x coord\r\n         * @param {Number} [options.point.y = 0] - point's y coord\r\n         * @param {Boolean} [options.hover] = true - the target has an hover effect\r\n         * @param {Function} [options.create] - call once created\r\n         * @param {Function} [options.remove] - call once removed\r\n         */\r\n        createTarget : function createTarget(paper, options) {\r\n            var baseSize,\r\n                count,\r\n                factor,\r\n                half,\r\n                hover,\r\n                layer,\r\n                point,\r\n                self,\r\n                tBBox,\r\n                targetSize,\r\n                x,\r\n                y,\r\n                target;\r\n\r\n            options = options || {};\r\n\r\n            self   = this;\r\n            point  = options.point || {x : 0, y : 0};\r\n            factor = paper.w !== 0 ? paper.width / paper.w : 1;\r\n            hover  = typeof options.hover === 'undefined' ? true : !!options.hover;\r\n\r\n            baseSize   = 18; // this is the base size of the path element to be placed on svg (i.e. the path element crosshair is created to have a size of 18)\r\n            half       = baseSize / 2;\r\n            x          = point.x - half;\r\n            y          = point.y - half;\r\n            targetSize = factor !== 0 ? 2 / factor : 2;\r\n\r\n            //create the target from a path\r\n            target = paper\r\n                .path(gstyle.target.path)\r\n                .transform('t' + x + ',' + y + 's' + targetSize)\r\n                .attr(gstyle.target)\r\n                .attr('title', _('Click again to remove'));\r\n\r\n            //generate an id if not set in options\r\n            if (options.id) {\r\n                target.id = options.id;\r\n            } else {\r\n                count = 0;\r\n                paper.forEach(function(element) {\r\n                    if (element.data('target')) {\r\n                        count++;\r\n                    }\r\n                });\r\n                target.id = 'target-' + count;\r\n            }\r\n\r\n            tBBox = target.getBBox();\r\n\r\n            //create an invisible rect over the target to ensure path selection\r\n            layer = paper\r\n                .rect(tBBox.x, tBBox.y, tBBox.width, tBBox.height)\r\n                .attr(gstyle.layer)\r\n                .click(function() {\r\n                    var id = target.id;\r\n                    var p  = this.data('point');\r\n\r\n                    if (_.isFunction(options.select)) {\r\n                        options.select(target, p, this);\r\n                    }\r\n\r\n                    if (_.isFunction(options.remove)) {\r\n                        this.remove();\r\n                        target.remove();\r\n                        options.remove(id, p);\r\n                    }\r\n                });\r\n\r\n            if (hover) {\r\n                layer.hover(function() {\r\n                    if (!target.flashing) {\r\n                        self.setStyle(target, 'target-hover');\r\n                    }\r\n                }, function() {\r\n                    if (!target.flashing) {\r\n                        self.setStyle(target, 'target-success');\r\n                    }\r\n                });\r\n            }\r\n\r\n            layer.id = 'layer-' + target.id;\r\n            layer.data('point', point);\r\n            target.data('target', point);\r\n\r\n            if (_.isFunction(options.create)) {\r\n                options.create(target);\r\n            }\r\n\r\n            return target;\r\n        },\r\n\r\n\r\n        /**\r\n         * Get the Raphael coordinate from QTI coordinate\r\n         * @param {Raphael.Paper} paper - the interaction paper\r\n         * @param {String} type - the shape type\r\n         * @param {String|Array.<Number>} coords - qti coords as a string or an array of number\r\n         * @returns {Array} the arguments array of coordinate to give to the approriate raphael shapre creator\r\n         */\r\n        raphaelCoords :  function raphaelCoords(paper, type, coords) {\r\n            var shapeCoords;\r\n\r\n            if (_.isString(coords)) {\r\n                coords = _.map(coords.split(','), function(coord) {\r\n                    return parseInt(coord, 10);\r\n                });\r\n            }\r\n\r\n            if (!_.isArray(coords) || coords.length < coordsValidator[type]) {\r\n                throw new Error('Invalid coords ' + JSON.stringify(coords) + '  for type ' + type);\r\n            }\r\n\r\n            switch(type) {\r\n                case 'rect'    : shapeCoords = qti2raphCoordsMapper.rect(coords); break;\r\n                case 'default' : shapeCoords = qti2raphCoordsMapper['default'].call(null, paper); break;\r\n                case 'poly'    : shapeCoords = qti2raphCoordsMapper.poly(coords); break;\r\n                default        : shapeCoords = coords; break;\r\n            }\r\n\r\n            return shapeCoords;\r\n        },\r\n\r\n\r\n        /**\r\n         * Get the QTI coordinates from a Raphael Element\r\n         * @param {Raphael.Element} element - the shape to get the coords from\r\n         * @returns {String} the QTI coords\r\n         */\r\n        qtiCoords : function qtiCoords(element) {\r\n            var mapper = raph2qtiCoordsMapper[element.type];\r\n            var result = '';\r\n\r\n            if (_.isFunction(mapper)) {\r\n                result = _.map(mapper.call(raph2qtiCoordsMapper, element.attr()), function(coord) {\r\n                    return _.parseInt(coord);\r\n                }).join(',');\r\n            }\r\n\r\n            return result;\r\n        },\r\n\r\n\r\n        /**\r\n         * Create a circle that animate and disapear from a shape.\r\n         *\r\n         * @param {Raphael.Paper} paper - the paper\r\n         * @param {Raphael.Element} element - used to get the bbox from\r\n         */\r\n        createTouchCircle : function(paper, bbox) {\r\n            var radius  = bbox.width > bbox.height ? bbox.width : bbox.height;\r\n            var tCircle = paper.circle( (bbox.x + (bbox.width / 2)),  (bbox.y + (bbox.height / 2)), radius);\r\n\r\n            tCircle.attr(gstyle['touch-circle']);\r\n\r\n            _.defer(function() {\r\n                tCircle.animate({ 'r' : radius + 5, opacity: 0.7 }, 300, function() {\r\n                    tCircle.remove();\r\n                });\r\n            });\r\n        },\r\n\r\n\r\n        /**\r\n         * Create a text, that scales.\r\n         *\r\n         * @param {Raphael.Paper} paper - the paper\r\n         * @param {Object} options - the text options\r\n         * @param {Number} options.left - x coord\r\n         * @param {Number} options.top - y coord\r\n         * @param {String} [options.content] - the text content\r\n         * @param {String} [options.id] - the element identifier\r\n         * @param {String} [options.style = 'small-text'] - the style name according to the graphic-style.json keys\r\n         * @param {String} [options.title] - the text tooltip content\r\n         * @param {Boolean} [options.hide = false] - if the text starts hidden\r\n         * @returns {Raphael.Element} the created text\r\n         */\r\n        createText : function(paper, options) {\r\n            var fontSize, scaledFontSize, text;\r\n            var top     = options.top || 0;\r\n            var left    = options.left || 0;\r\n            var content = options.content || '';\r\n            var style   = options.style || 'small-text';\r\n            var title   = options.title || '';\r\n            var factor  = 1;\r\n\r\n            if (paper.width && paper.w) {\r\n                factor = paper.width / paper.w;\r\n            }\r\n\r\n            text = paper.text(left , top, content).toFront();\r\n            if (options.id) {\r\n                text.id = options.id;\r\n            }\r\n\r\n            if (options.hide) {\r\n                text.hide();\r\n            }\r\n\r\n            text.attr(gstyle[style]);\r\n\r\n            if (typeof factor !== 'undefined' && factor !== 1) {\r\n                fontSize = parseInt(text.attr('font-size'), 10);\r\n                scaledFontSize   = Math.floor(fontSize / factor) + 1;\r\n\r\n                text.attr('font-size', scaledFontSize);\r\n            }\r\n\r\n            if (title) {\r\n                this.updateTitle(text, title);\r\n            }\r\n\r\n            return text;\r\n        },\r\n\r\n\r\n        /**\r\n         * Create a text in the middle of the related shape.\r\n         *\r\n         * @param {Raphael.Paper} paper - the paper\r\n         * @param {Raphael.Element} shape - the shape to add the text to\r\n         * @param {Object} options - the text options\r\n         * @param {String} [options.content] - the text content\r\n         * @param {String} [options.id] - the element identifier\r\n         * @param {String} [options.style = 'small-text'] - the style name according to the graphic-style.json keys\r\n         * @param {String} [options.title] - the text tooltip content\r\n         * @param {Boolean} [options.hide = false] - if the text starts hidden\r\n         * @param {Boolean} [options.shapeClick = false] - clicking the text delegates to the shape\r\n         * @returns {Raphael.Element} the created text\r\n         */\r\n        createShapeText : function(paper, shape, options) {\r\n            var self = this;\r\n            var bbox = shape.getBBox();\r\n\r\n            var text = this.createText(paper, _.merge({\r\n                left : bbox.x + (bbox.width / 2),\r\n                top  : bbox.y + (bbox.height / 2)\r\n            }, options));\r\n\r\n            if (options.shapeClick) {\r\n                text.click(function() {\r\n                    self.trigger(shape, 'click');\r\n                });\r\n            }\r\n\r\n            return text;\r\n        },\r\n\r\n\r\n        /**\r\n         * Create an image with a padding and a border, using a set.\r\n         *\r\n         * @param {Raphael.Paper} paper - the paper\r\n         * @param {Object} options - image options\r\n         * @param {Number} options.left - x coord\r\n         * @param {Number} options.top - y coord\r\n         * @param {Number} options.width - image width\r\n         * @param {Number} options.height - image height\r\n         * @param {Number} options.url - image ulr\r\n         * @param {Number} [options.padding = 6] - a multiple of 2 is welcomed\r\n         * @param {Boolean} [options.border = false] - add a border around the image\r\n         * @param {Boolean} [options.shadow = false] - add a shadow back the image\r\n         * @returns {Raphael.Element} the created set, augmented of a move(x,y) method\r\n         */\r\n        createBorderedImage : function(paper, options) {\r\n            var padding = options.padding >= 0 ? options.padding : 6;\r\n            var halfPad = padding / 2;\r\n\r\n            var rx = options.left,\r\n                ry = options.top,\r\n                rw = options.width + padding,\r\n                rh = options.height + padding;\r\n\r\n            var ix = options.left + halfPad,\r\n                iy = options.top + halfPad,\r\n                iw = options.width,\r\n                ih = options.height;\r\n\r\n            var set = paper.set();\r\n\r\n            //create a rectangle with a padding and a border.\r\n            var rect = paper\r\n                .rect(rx, ry, rw, rh)\r\n                .attr(options.border ? gstyle['imageset-rect-stroke'] : gstyle['imageset-rect-no-stroke']);\r\n\r\n            //and an image centered into the rectangle.\r\n            var image = paper\r\n                .image(options.url, ix, iy, iw, ih)\r\n                .attr(gstyle['imageset-img']);\r\n\r\n            if (options.shadow) {\r\n                set.push(rect.glow({\r\n                    width   : 2,\r\n                    offsetx : 1,\r\n                    offsety : 1\r\n                }));\r\n            }\r\n\r\n            set.push(rect, image);\r\n\r\n            /**\r\n             * Add a move method to set that keep the given coords during an animation\r\n             * @private\r\n             * @param {Number} x - destination\r\n             * @param {Number} y - destination\r\n             * @param {Number} [duration = 400] - the animation duration\r\n             * @returns {Raphael.Element} the set for chaining\r\n             */\r\n            set.move = function move(x, y, duration) {\r\n                var animation = raphael.animation({x: x, y : y}, duration || 400);\r\n                var elt = rect.animate(animation);\r\n                image.animateWith(elt, animation, {x : x + halfPad, y : y + halfPad}, duration || 400);\r\n                return set;\r\n            };\r\n\r\n            return set;\r\n        },\r\n\r\n\r\n        /**\r\n         * Update the visual state of an Element\r\n         * @param {Raphael.Element} element - the element to change the state\r\n         * @param {String} state - the name of the state (from states) to switch to\r\n         * @param {String} [title] - a title linked to this step\r\n         */\r\n        updateElementState : function(element, state, title) {\r\n            if (element && element.animate) {\r\n                element.animate(gstyle[state], 200, 'linear', function() {\r\n                    element.attr(gstyle[state]); //for attr that don't animate\r\n\r\n                    //preven issue in firefox 37\r\n                    $(element.node).removeAttr('stroke-dasharray');\r\n                });\r\n\r\n                if (title) {\r\n                    this.updateTitle(element, title);\r\n                }\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * Update the title of an element (the attr method of Raphael adds only new node instead of updating exisitings).\r\n         * @param {Raphael.Element} element - the element to update the title\r\n         * @param {String} [title] - the new title\r\n         */\r\n        updateTitle : function(element, title) {\r\n            if (element && element.node) {\r\n                //removes all remaining titles nodes\r\n                _.forEach(element.node.children, function(child) {\r\n                    if (child.nodeName.toLowerCase() === 'title') {\r\n                        element.node.removeChild(child);\r\n                    }\r\n                });\r\n\r\n                //then set the new title\r\n                element.attr('title', title);\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * Highlight an element with the error style\r\n         * @param {Raphael.Element} element - the element to hightlight\r\n         * @param {String} [restorState = 'basic'] - the state to restore the elt into after flash\r\n         */\r\n        highlightError : function(element, restoredState) {\r\n            var self = this;\r\n            if (element) {\r\n                element.flashing = true;\r\n                self.updateElementState(element, 'error');\r\n                _.delay(function() {\r\n                    self.updateElementState(element, restoredState || 'basic');\r\n                    element.flashing = false;\r\n                }, 800);\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * Trigger an event already bound to a raphael element\r\n         * @param {Raphael.Element} element\r\n         * @param {String} event - the event name\r\n         *\r\n         */\r\n        trigger : function(element, event) {\r\n            var evt = _.where(element.events, { name : event});\r\n            if (evt.length && evt[0] && typeof evt[0].f === 'function') {\r\n                evt[0].f.apply(element, Array.prototype.slice.call(arguments, 2));\r\n            }\r\n        },\r\n\r\n\r\n        /**\r\n         * Get an x/y point from a MouseEvent\r\n         * @param {MouseEvent} event - the source event\r\n         * @param {Raphael.Paper} paper - the interaction paper\r\n         * @param {jQueryElement} $container - the paper container\r\n         * @param {Boolean} isResponsive - if the paper is scaling\r\n         * @returns {Object} x,y point\r\n         */\r\n        getPoint : function getPoint(event, paper, $container) {\r\n            var point  = this.clickPoint($container, event);\r\n            var rect   = $container.get(0).getBoundingClientRect();\r\n            var factor = paper.w / rect.width;\r\n\r\n            point.x = Math.round(point.x * factor);\r\n            point.y = Math.round(point.y * factor);\r\n\r\n            return point;\r\n        },\r\n\r\n\r\n        /**\r\n         * Get paper position relative to the container\r\n         * @param {jQueryElement} $container - the paper container\r\n         * @param {Raphael.Paper} paper - the interaction paper\r\n         * @returns {Object} position with top and left\r\n         */\r\n        position : function($container, paper) {\r\n            var pw = parseInt(paper.w || paper.width, 10);\r\n            var cw = parseInt($container.width(), 10);\r\n            var ph = parseInt(paper.w || paper.width, 10);\r\n            var ch = parseInt($container.height(), 10);\r\n\r\n            return {\r\n                left : ((cw - pw) / 2),\r\n                top : ((ch - ph) / 2)\r\n            };\r\n        },\r\n\r\n\r\n        /**\r\n         * Get a point from a click event\r\n         * @param {jQueryElement} $container - the element that contains the paper\r\n         * @param {MouseEvent} event - the event triggered by the click\r\n         * @returns {Object} the x,y point\r\n         */\r\n        clickPoint : function($container, event) {\r\n            var x, y;\r\n            var offset = $container.offset();\r\n\r\n            if (event.pageX || event.pageY) {\r\n                x = event.pageX - offset.left;\r\n                y = event.pageY - offset.top;\r\n            } else if (event.clientX || event.clientY) {\r\n                x = event.clientX + document.body.scrollLeft + document.documentElement.scrollLeft - offset.left;\r\n                y = event.clientY + document.body.scrollTop + document.documentElement.scrollTop - offset.top;\r\n            }\r\n\r\n            return { x : x, y : y };\r\n        }\r\n    };\r\n\r\n    return GraphicHelper;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/graphicAssociateInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager'\r\n], function($, _, __, Promise, tpl, graphic,  pciResponse, containerHelper, instructionMgr){\r\n    'use strict';\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function render(interaction){\r\n        var self = this;\r\n\r\n        return new Promise(function(resolve, reject){\r\n\r\n            var $container = containerHelper.get(interaction);\r\n            var background = interaction.object.attributes;\r\n            var $imageBox  = $('.main-image-box', $container);\r\n            interaction._vsets = [];\r\n\r\n            $container\r\n                .off('resized.qti-widget.resolve')\r\n                .one('resized.qti-widget.resolve', resolve);\r\n\r\n            interaction.paper = graphic.responsivePaper( 'graphic-paper-' + interaction.serial, interaction.serial, {\r\n                width       : background.width,\r\n                height      : background.height,\r\n                img         : self.resolveUrl(background.data),\r\n                imgId       : 'bg-image-' + interaction.serial,\r\n                container   : $container\r\n            });\r\n\r\n            //call render choice for each interaction's choices\r\n            _.forEach(interaction.getChoices(), _.partial(_renderChoice, interaction));\r\n\r\n            //make the paper clear the selection by clicking it\r\n            _paperUnSelect(interaction);\r\n\r\n            //set up the constraints instructions\r\n            instructionMgr.minMaxChoiceInstructions(interaction, {\r\n                min: interaction.attr('minAssociations'),\r\n                max: interaction.attr('maxAssociations'),\r\n                getResponse : _getRawResponse,\r\n                onError : function(data){\r\n                    if(data && data.target){\r\n                        graphic.highlightError(data.target);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n\r\n    /**\r\n     * Render a choice inside the paper.\r\n     * Please note that the choice renderer isn't implemented separately because it relies on the Raphael paper instead of the DOM.\r\n     * @param {Paper} paper - the raphael paper to add the choices to\r\n     * @param {Object} interaction\r\n     * @param {Object} choice - the hotspot choice to add to the interaction\r\n     */\r\n    var _renderChoice  =  function _renderChoice(interaction, choice){\r\n        var shape = choice.attr('shape');\r\n        var coords = choice.attr('coords');\r\n        var maxAssociations = interaction.attr('maxAssociations');\r\n\r\n        var rElement = graphic.createElement(interaction.paper, shape, coords, {\r\n            id : choice.serial,\r\n            title : __('Select this area to start an association')\r\n        })\r\n        .data('max', choice.attr('matchMax'))\r\n        .data('matching', 0)\r\n        .removeData('assocs')\r\n        .click(function(){\r\n            var self = this;\r\n            var active, assocs;\r\n\r\n            //can't create more associations than the maxAssociations attr\r\n            if(maxAssociations > 0 && _getRawResponse(interaction).length >= maxAssociations){\r\n                _shapesUnSelectable(interaction);\r\n                instructionMgr.validateInstructions(interaction, { choice : choice, target : this });\r\n                return;\r\n            }\r\n\r\n            if(this.selectable) {\r\n                active = _getActiveElement(interaction);\r\n                if(active){\r\n\r\n                    //increment the matching counter\r\n                    active.data('matching', active.data('matching') + 1);\r\n                    this.data('matching', this.data('matching') + 1);\r\n\r\n                    //attach the response to the active (not the dest)\r\n                    assocs = active.data('assocs') || [];\r\n                    assocs.push(choice.id());\r\n                    active.data('assocs', assocs);\r\n\r\n                    //and create the path\r\n                    _createPath(interaction, active, this, function onRemove(){\r\n\r\n                        //decrement the matching counter\r\n                        active.data('matching', active.data('matching') - 1);\r\n                        self.data('matching', self.data('matching') - 1);\r\n\r\n                        //detach the response from the active\r\n                        active.data('assocs', _.remove(active.data('assocs') || [], choice.id()));\r\n\r\n                        containerHelper.triggerResponseChangeEvent(interaction);\r\n                        instructionMgr.validateInstructions(interaction, { choice : choice, target : self });\r\n                    });\r\n                }\r\n                _shapesUnSelectable(interaction);\r\n\r\n            } else if(this.active) {\r\n                graphic.updateElementState(this, 'basic', __('Select another area to complete the association'));\r\n                this.active = false;\r\n                _shapesUnSelectable(interaction);\r\n            } else if(_isMatchable(this)){\r\n                graphic.updateElementState(this, 'active', __('Select this area to start an association'));\r\n                this.active = true;\r\n                _shapesSelectable(interaction, this);\r\n            }\r\n\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n            instructionMgr.validateInstructions(interaction, { choice : choice, target : this });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * By clicking the paper image the shapes are restored to their default state\r\n     * @private\r\n     * @param {Object} interaction\r\n     */\r\n    var _paperUnSelect = function _paperUnSelect(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var image = interaction.paper.getById('bg-image-' + interaction.serial);\r\n        if(image){\r\n            image.click(function(){\r\n                _shapesUnSelectable(interaction);\r\n                $container.trigger('unselect.graphicassociate');\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the element that has the active state\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @returns {Raphael.Element} the active element\r\n     */\r\n    var _getActiveElement = function _getActiveElement(interaction){\r\n        var active;\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element && element.active === true){\r\n                active = element;\r\n                return false;\r\n            }\r\n        });\r\n        return active;\r\n    };\r\n\r\n    /**\r\n     * Create a path from a src element to a destination.\r\n     * The path is selectable and can be removed by itself\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {Raphael.Element} srcElement - the path starts from this shape\r\n     * @param {Raphael.Element} destElement - the path ends to this shape\r\n     * @param {Function} onRemove - called back on path remove\r\n     */\r\n    var _createPath = function _createPath(interaction, srcElement, destElement, onRemove){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //virtual set, not a raphael one, just to group the elements\r\n        var vset = [];\r\n\r\n        //get the middle point of the source shape\r\n        var src = srcElement.getBBox();\r\n        var sx = src.x + (src.width / 2);\r\n        var sy = src.y + (src.height / 2);\r\n\r\n        //get the middle point of the source shape\r\n        var dest = destElement.getBBox();\r\n        var dx = dest.x + (dest.width / 2);\r\n        var dy = dest.y + (dest.height / 2);\r\n\r\n        //create a path with bullets at the beginning and the end\r\n        var srcBullet = interaction.paper.circle(sx, sy, 3)\r\n            .attr(graphic._style['assoc-bullet']);\r\n\r\n        var destBullet = interaction.paper.circle(dx, dy, 3)\r\n            .attr(graphic._style['assoc-bullet']);\r\n\r\n        var path = interaction.paper.path('M' + sx + ',' + sy + 'L' + sx + ',' + sy)\r\n            .attr(graphic._style.assoc)\r\n            .animate({path : 'M' + sx + ',' + sy + 'L' + dx + ',' + dy}, 300);\r\n\r\n        //create an overall layer that make easier the path selection\r\n        var layer = interaction.paper.path('M' + sx + ',' + sy + 'L' + dx + ',' + dy)\r\n            .attr(graphic._style['assoc-layer']);\r\n\r\n        //get the middle of the path\r\n        var midPath = layer.getPointAtLength(layer.getTotalLength() / 2);\r\n\r\n        //create an hidden background for the closer\r\n        var closerBg = interaction.paper.circle(midPath.x, midPath.y, 9)\r\n            .attr(graphic._style['close-bg'])\r\n            .toBack();\r\n\r\n        //create an hidden closer\r\n        var closer = interaction.paper.path(graphic._style.close.path)\r\n            .attr(graphic._style.close)\r\n            .transform('T' + (midPath.x - 9 ) + ',' + (midPath.y - 9))\r\n            .attr('title', _('Click again to remove'))\r\n            .toBack();\r\n\r\n        //the path is below the shapes\r\n        srcElement.toFront();\r\n        destElement.toFront();\r\n\r\n        //add the path into a set\r\n        vset = [srcBullet, path, destBullet, layer, closerBg, closer];\r\n        interaction._vsets.push(vset);\r\n\r\n        //to identify the element of the set outside the context\r\n        _.invoke(vset, 'data', 'assoc-path', true);\r\n\r\n        //enable to select the path by clicking the invisible layer\r\n        layer.click(function selectLigne (){\r\n            if(closer.attrs.opacity === 0){\r\n                showCloser();\r\n            } else {\r\n                hideCloser();\r\n            }\r\n        });\r\n\r\n        $container.on('unselect.graphicassociate', function(){\r\n            hideCloser();\r\n        });\r\n\r\n        function showCloser(){\r\n            closerBg\r\n                .toFront()\r\n                .animate({opacity: 0.8}, 300)\r\n                .click(removeSet);\r\n            closer\r\n                .toFront()\r\n                .animate({opacity: 1}, 300)\r\n                .click(removeSet);\r\n        }\r\n\r\n        function hideCloser(){\r\n           if(closerBg && closerBg.type){\r\n                closerBg\r\n                    .animate({opacity: 0}, 300, function(){\r\n                        closerBg.toBack();\r\n                    })\r\n                    .unclick();\r\n                closer\r\n                    .animate({opacity: 0}, 300, function(){\r\n                        closer.toBack();\r\n                    })\r\n                    .unclick();\r\n            }\r\n        }\r\n\r\n        //remove set handler\r\n        function removeSet(){\r\n            _.invoke(vset, 'remove');\r\n            interaction._vsets = _.without(interaction._vsets, vset);\r\n            if(typeof onRemove === 'function'){\r\n                onRemove();\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Makes the shapes selectable\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {Raphael.Element} active - the active shape\r\n     */\r\n    var _shapesSelectable = function _shapesSelectable(interaction, active){\r\n\r\n        var assocs = active.data('assocs') || [];\r\n\r\n        //update the shape state\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element;\r\n            if(!_.contains(assocs, choice.id())){\r\n                element = interaction.paper.getById(choice.serial);\r\n                if(!element.active && element.id !== active.id &&  _isMatchable(element, active)){\r\n                    element.selectable = true;\r\n                    graphic.updateElementState(element, 'selectable');\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Makes all the shapes UNselectable\r\n     * @private\r\n     * @param {Object} interaction\r\n     */\r\n    var _shapesUnSelectable = function _shapesUnSelectable(interaction){\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element){\r\n                element.selectable = false;\r\n                element.active = false;\r\n                graphic.updateElementState(element, 'basic');\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Check if a shape can accept matches\r\n     * @private\r\n     * @param {Raphael.Element} element - the shape\r\n     * @returns {Boolean} true if the element is matchable\r\n     */\r\n    var _isMatchable = function(element){\r\n        var matchable = false;\r\n        var matching, matchMax;\r\n        if(element){\r\n            matchMax = element.data('max') || 0;\r\n            matching = element.data('matching') || 0;\r\n            matchable = (matchMax === 0 || matchMax > matching);\r\n        }\r\n        return matchable;\r\n    };\r\n\r\n    /**\r\n     * Get the response from the interaction\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @returns {Array} the response in raw format\r\n     */\r\n    var _getRawResponse = function _getRawResponse(interaction){\r\n        var responses = [];\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            var assocs = element.data('assocs');\r\n            if(element && assocs){\r\n               responses = responses.concat(_.map(assocs, function(id){\r\n                    return [choice.id(), id];\r\n               }));\r\n            }\r\n        });\r\n        return responses;\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n\r\n        var responseValues;\r\n        if(response && interaction.paper){\r\n\r\n            try{\r\n                responseValues = pciResponse.unserialize(response, interaction);\r\n            } catch(e){}\r\n\r\n            if(_.isArray(responseValues)){\r\n                //create an object with choiceId => shapeElement\r\n                var map =  _.transform(interaction.getChoices(), function(res, choice){\r\n                    res[choice.id()] = interaction.paper.getById(choice.serial);\r\n                });\r\n               _.forEach(responseValues, function(responseValue){\r\n                    var el1, el2;\r\n                    if(_.isArray(responseValue) && responseValue.length === 2){\r\n                        el1 = map[responseValue[0]];\r\n                        el2 = map[responseValue[1]];\r\n                        if(el1 && el2){\r\n                           graphic.trigger(el1, 'click');\r\n                           graphic.trigger(el2, 'click');\r\n                        }\r\n                    }\r\n               });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset the current responses of the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var resetResponse = function resetResponse(interaction){\r\n        var toRemove = [];\r\n\r\n        //reset response and state bound to shapes\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element){\r\n                element.data({\r\n                    'max' : choice.attr('matchMax'),\r\n                    'matching' : 0,\r\n                    'assocs' : []\r\n                });\r\n            }\r\n        });\r\n\r\n        //remove the paths, but outside the forEach as it is implemented as a linked list\r\n        interaction.paper.forEach(function(elt){\r\n            if(elt.data('assoc-path')){\r\n                toRemove.push(elt);\r\n            }\r\n        });\r\n        _.invoke(toRemove, 'remove');\r\n    };\r\n\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        var raw = _getRawResponse(interaction);\r\n        var response =  pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n        return response;\r\n    };\r\n\r\n    /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n        var $container;\r\n        if(interaction.paper){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            $(window).off('resize.qti-widget.' + interaction.serial);\r\n            $container.off('resize.qti-widget.' + interaction.serial);\r\n\r\n            interaction.paper.clear();\r\n            instructionMgr.removeInstructions(interaction);\r\n\r\n            $container.off('.graphicassociate');\r\n\r\n            $('.main-image-box', $container).empty().removeAttr('style');\r\n            $('.image-editor', $container).removeAttr('style');\r\n            $('ul', $container).empty();\r\n        }\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the hotspot interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'graphicAssociateInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicInteraction/Widget',[\r\n    'jquery', 'lodash', 'i18n',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/helper/dummyElement'\r\n], function($, _, __, graphic, dummyElement){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * The Widget that provides components used by the QTI Creator for the Hotspot Interaction\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/Widget\r\n     */\r\n    var GraphicInteractionWidget = {\r\n\r\n        /**\r\n         * Create a basic Raphael paper or a placeholder of no bg is defined.\r\n         * @param {Function} resize - called back on resize with the width and factor\r\n         * @returns {Raphael.Paper} the raphael paper if initialized?\r\n         */\r\n        createPaper : function(resize){\r\n            var paper;\r\n            var $container  = this.$original;\r\n            var $item       = $container.parents('.qti-item');\r\n            var background  = this.element.object.attributes;\r\n            var serial      = this.element.serial;\r\n\r\n            if(!background.data){\r\n                this._createPlaceholder();\r\n            } else {\r\n                paper = graphic.responsivePaper( 'graphic-paper-' + serial, serial, {\r\n                    width       : background.width,\r\n                    height      : background.height,\r\n                    img         : this.options.assetManager.resolve(background.data),\r\n                    imgId       : 'bg-image-' + serial,\r\n                    container   : $container,\r\n                    resize      : function() {\r\n                        if(typeof resize === 'function') {\r\n                            resize.apply(this, arguments);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                //listen for internal size change\r\n                $item.on('resize.gridEdit.' + serial, function(){\r\n                    $container.trigger('resize.qti-widget.' + serial);\r\n                });\r\n\r\n            }\r\n\r\n            return paper;\r\n        },\r\n\r\n        /**\r\n         * Creates a dummy placeholder for background.\r\n         * @private\r\n         */\r\n        _createPlaceholder : function(){\r\n            var self       = this;\r\n            var $container = this.$original;\r\n            var $imageBox  = $container.find('.main-image-box');\r\n            var $editor    = $container.find('.image-editor');\r\n            var diff       = ($editor.outerWidth() - $editor.width()) + ($container.outerWidth() - $container.width()) + 1;\r\n            dummyElement.get({\r\n                icon: 'image',\r\n                css: {\r\n                    width  : $container.innerWidth() - diff,\r\n                    height : 200\r\n                },\r\n                title : __('Select an image first.')\r\n            })\r\n            .click(function(){\r\n                var $upload  = $('[data-role=\"upload-trigger\"]', self.$form);\r\n                if($upload.length){\r\n                    $upload.trigger('click');\r\n                }\r\n            })\r\n            .appendTo($imageBox);\r\n        },\r\n\r\n        /**\r\n         * call render choice for each interaction's choices\r\n         */\r\n        createChoices : function(){\r\n            _.forEach(this.element.getChoices(), this._currentChoices, this);\r\n        },\r\n\r\n        /**\r\n         * Add shape to the Raphael paper for a QTI choice\r\n         * @private\r\n         * @param {Object} choice - the QTI choice\r\n         */\r\n        _currentChoices : function(choice){\r\n            graphic.createElement(this.element.paper, choice.attr('shape'), choice.attr('coords'), {\r\n                id          : choice.serial,\r\n                touchEffect : false\r\n            });\r\n        }\r\n    };\r\n\r\n    return GraphicInteractionWidget;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Sleep',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep'\r\n], function(stateFactory, SleepState){\r\n\r\n    'use strict';\r\n   \r\n    var initSleepState = function initSleepState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        widget.on('metaChange', function(data){\r\n            if(data.key === 'responsive'){\r\n                if(data.value === true){\r\n                    interaction.addClass('responsive');\r\n                } else {\r\n                    interaction.removeClass('responsive');\r\n                }\r\n                widget.rebuild();\r\n            }\r\n        });\r\n    };\r\n\r\n    var exitSleepState = function exitSleepState(){\r\n        $('.image-editor.solid, .block-listing.source', this.widget.$container).css('min-width', 0);\r\n    };\r\n \r\n    return stateFactory.extend(SleepState, initSleepState, exitSleepState); \r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/graphicInteraction/sidebar', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\r\\n        <li class=\\\"separator\\\"></li>\\r\\n        <li data-type=\\\"target\\\"><span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Drop the target to select a point\", options) : helperMissing.call(depth0, \"__\", \"Drop the target to select a point\", options)))\n    + \"\\\" class=\\\"icon-target\\\"></span></li>\\r\\n        \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"image-sidebar\\\">\\r\\n    <ul class=\\\"none forms\\\">\\r\\n        <li data-type=\\\"rect\\\"><span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Draw a rectangle on the image\", options) : helperMissing.call(depth0, \"__\", \"Draw a rectangle on the image\", options)))\n    + \"\\\" class=\\\"icon-rectangle\\\"></span></li>\\r\\n        <li data-type=\\\"circle\\\"><span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Draw a circle on the image\", options) : helperMissing.call(depth0, \"__\", \"Draw a circle on the image\", options)))\n    + \"\\\" class=\\\"icon-circle\\\"></span></li>\\r\\n        <li data-type=\\\"ellipse\\\"><span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Draw an ellipsis on the image\", options) : helperMissing.call(depth0, \"__\", \"Draw an ellipsis on the image\", options)))\n    + \"\\\" class=\\\"icon-ellipsis\\\"></span></li>\\r\\n        <li data-type=\\\"path\\\"><span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Draw a free form on the image\", options) : helperMissing.call(depth0, \"__\", \"Draw a free form on the image\", options)))\n    + \"\\\" class=\\\"icon-free-form\\\"></span></li>\\r\\n    \\r\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.showTarget), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\\r\\n        <li class=\\\"separator\\\"></li>\\r\\n        <li class=\\\"bin disabled\\\"><span title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Remove the selected shape\", options) : helperMissing.call(depth0, \"__\", \"Remove the selected shape\", options)))\n    + \"\\\" class=\\\"icon-bin\\\"></span></li>\\r\\n    </ul>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeSideBar',[\r\n    'jquery', 'lodash', \r\n    'tpl!taoQtiItem/qtiCreator/tpl/graphicInteraction/sidebar'\r\n], function($, _, sidebarTmpl){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Helps you to create the side bar used to select shapes to draw in the QTI Create\r\n     * @exports qtiCreator/widgets/interaction/helpers/shapeSideBar\r\n     */\r\n    var shapeSideBar  = {\r\n\r\n        /**\r\n         * Create the side bar and add it the container.\r\n         * It will resize the container accordingly.\r\n         * @param {jQueryElement} $container - a graphic interaction container\r\n         * @param {Boolean} [showTarget = false] - if the target data type has to be shown\r\n         * @returns {jQueryElement} the side bar element\r\n         * @fires shapeSideBar#shapeactive.qti-widget \r\n         * @fires shapeSideBar#shapedeactive.qti-widget \r\n         * @fires resize.qti-widget\r\n         */\r\n        create : function create($container, showTarget){\r\n\r\n            var $imageEditor = $container.find('.image-editor');\r\n            var serial = $container.data('serial');\r\n            var $sideBar = $(sidebarTmpl({\r\n                    showTarget : !!showTarget \r\n                 }));\r\n            $imageEditor.prepend($sideBar);\r\n            var $forms = $('li[data-type]', $sideBar);\r\n            var $bin = $('li.bin', $sideBar);\r\n\r\n           \r\n            /**\r\n             * Set a form/shape into an active state\r\n             * @param {jQueryElement} $form - the form/shape button\r\n             */ \r\n            var activate = function activate($form){\r\n                $forms.filter('.active').each(function(){\r\n                    deactivate($(this));\r\n                });\r\n                $form.addClass('active');\r\n\r\n                /**\r\n                 * When a shape is activated \r\n                 * @event shapeSideBar#shapeactive.qti-widget\r\n                 * @param {jQueryElement} $form - the shape element\r\n                 * @param {String} type - the shape type\r\n                 */\r\n                $sideBar.trigger('shapeactive.qti-widget', [$form, $form.data('type')]);\r\n            }; \r\n            \r\n            /**\r\n             * Set a form/shape into an inactive state\r\n             * @param {jQueryElement} $form - the form/shape button \r\n             */ \r\n            var deactivate = function deactivate($form){\r\n                $form.removeClass('active');\r\n                \r\n                /**\r\n                 * A shape is deactivated \r\n                 * @event shapeSideBar#shapedeactive.qti-widget \r\n                 * @param {jQueryElement} $form - the shape element\r\n                 * @param {String} type - the shape type\r\n                 */\r\n                $sideBar.trigger('shapedeactive.qti-widget', [$form, $form.data('type')]);\r\n            }; \r\n\r\n            /**\r\n             * To enable the bin \r\n             * @event shapeSideBar#enabalebin.qti-widget \r\n             */\r\n            $sideBar.on('enablebin.qti-widget', function(){\r\n               $bin.removeClass('disabled')\r\n                    .on('click', function(e){\r\n                        e.preventDefault();\r\n                        $sideBar.trigger('bin.qti-widget');\r\n                    });\r\n            });\r\n            \r\n            /**\r\n             * To disable the bin \r\n             * @event shapeSideBar#disabalebin.qti-widget \r\n             */\r\n            $sideBar.on('disablebin.qti-widget', function(){\r\n               $bin.addClass('disabled')\r\n                   .off('click'); \r\n            });\r\n\r\n            $forms.click(function(e){\r\n                e.preventDefault();\r\n                var $form = $(this);\r\n                if(!$form.hasClass('active')){\r\n                    activate($form);\r\n                } else {\r\n                    deactivate($form);\r\n                }\r\n            }); \r\n             \r\n\r\n            return $sideBar;\r\n        },\r\n\r\n        remove : function remove($container){\r\n            var $sideBar = $('.image-sidebar', $container);\r\n            if($sideBar.length){\r\n                $sideBar.remove();\r\n                $container.off('resize.qti-widget.sidebar');\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    return shapeSideBar;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeHandlers',[\r\n    'jquery', 'lodash', 'raphael'\r\n], function($, _, Raphael){\r\n\r\n    /**\r\n     * Creates handlers around a shape\r\n     * @exports qtiCreator/widgets/interaction/helpers/shapeHandlers\r\n     * @param {Raphael.Paper} paper - the raphael paper\r\n     * @param {Raphael.Element} element - the shape\r\n     * @returns {Array<Raphael.Element>} the handlers \r\n     */\r\n    var shapeHandlers = function (paper, element){\r\n\r\n        var getCoords = function getHandlingCoords(element){\r\n            var coords;\r\n            var scaleFactor = paper.w < paper.width ? 1 : paper.w / paper.width;\r\n            var bbox        = element.getBBox();\r\n            var size        = (bbox.width > 25 ? 6 : 4) * scaleFactor;\r\n            var half        = size / 2;\r\n            var halfWidth   = bbox.width / 2;\r\n            var halfHeight  = bbox.height / 2;\r\n            \r\n            switch(element.type){\r\n                case 'circle' :\r\n                    coords = {\r\n                        midTop      : [bbox.x + halfWidth - half, bbox.y - size, size, size],\r\n                        midRight    : [bbox.x + bbox.width, bbox.y + halfHeight - half, size, size],\r\n                        midBot      : [bbox.x + halfWidth - half, bbox.y + bbox.height, size, size],\r\n                        midLeft     : [bbox.x - size, bbox.y + halfHeight - half, size, size]\r\n                    };\r\n                    break;\r\n                case 'path' :\r\n                    coords =  {};\r\n                    _.forEach(Raphael.parsePathString(element.attr('path')), function(segment, index){\r\n                        if(segment.length === 3){\r\n                            coords['point' + index] = segment.slice(1).concat(half);\r\n                        }\r\n                    });\r\n                    break;\r\n                case 'rect' :\r\n                case 'ellipse' :\r\n                    coords = {\r\n                        topLeft     : [bbox.x - size, bbox.y - size, size, size],\r\n                        midTop      : [bbox.x + halfWidth - half, bbox.y - size, size, size],\r\n                        topRight    : [bbox.x + bbox.width, bbox.y - size, size, size],\r\n                        midRight    : [bbox.x + bbox.width, bbox.y + halfHeight - half, size, size],\r\n                        botRight    : [bbox.x + bbox.width, bbox.y + bbox.height, size, size],\r\n                        midBot      : [bbox.x + halfWidth - half, bbox.y + bbox.height, size, size],\r\n                        botLeft     : [bbox.x - size, bbox.y + bbox.height, size, size],\r\n                        midLeft     : [bbox.x - size, bbox.y + halfHeight - half, size, size]\r\n                    };\r\n                    break;\r\n            }\r\n            return coords;\r\n        };\r\n\r\n        return _.map(getCoords(element), function(handlerCoords, name){\r\n            var handler, cursor, constraints, hshape;\r\n            if(element.type === 'path'){\r\n                cursor = 'move';\r\n                hshape = 'circle'; \r\n            } else {\r\n                hshape = 'rect'; \r\n                switch(name){\r\n                    case 'topLeft' :\r\n                        cursor = 'nw-resize';\r\n                        constraints = { ix : true, iy : true };\r\n                        break;\r\n                    case 'midTop' :\r\n                        cursor = 'ns-resize';\r\n                        constraints = { iy : true };\r\n                        break;\r\n                    case 'topRight' :\r\n                        cursor = 'ne-resize';\r\n                        constraints = { x : true, iy : true };\r\n                        break;\r\n                    case 'midRight' :\r\n                        cursor = 'ew-resize';\r\n                        constraints = { x : true };\r\n                        break;\r\n                    case 'botRight' :\r\n                        cursor = 'se-resize';\r\n                        break;\r\n                    case 'midBot' :\r\n                        cursor = 'ns-resize';\r\n                        constraints = { y : true };\r\n                        break;\r\n                    case 'botLeft' :\r\n                        cursor = 'sw-resize';\r\n                        constraints = { ix : true, y : true };\r\n                        break;\r\n                    case 'midLeft' :\r\n                        cursor = 'ew-resize';\r\n                        constraints = { ix : true };\r\n                        break;\r\n                }\r\n            }\r\n            return paper[hshape].apply(paper, handlerCoords)\r\n                        .attr({\r\n                            'fill' : '#eeeeee',\r\n                            'cursor' : cursor\r\n                        })\r\n                        .data('constraints', constraints);\r\n        });\r\n    };\r\n\r\n    return shapeHandlers;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeResizer',[\r\n    'jquery', 'lodash', \r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic'\r\n], function($, _, commonGraphicHelper){\r\n\r\n\r\n    /**\r\n     * Resize a Raphael shape.\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeResizer\r\n     * @param {Raphael.Element} element - the element to resize\r\n     * @param {Object} options - the sizing options\r\n     * @param {Object} [options.start] - the x,y starting point of the shape (prior to the resize)\r\n     * @param {Object} options.stop - the x,y stop point of the shape (the size is the difference between start and stop)\r\n     * @param {Object} [options.constraints] - define sizing constraints, ie. {x : true} for horizontal only sizing\r\n     * @param {Number} [options.pointIndex] - for a path, this is the index of the point into the path\r\n     * @param {Function} [options.resized] - called back on resized\r\n     */\r\n    var resize =  function resize (element, options){\r\n        var resizer;\r\n        \r\n        if(element && element.type && options.stop){\r\n            resizer = _.bind(shapeResizer[element.type], shapeResizer);\r\n            \r\n            if(!options.start){\r\n                options.start = getStartPoint(element);\r\n            }\r\n            \r\n            if(_.isFunction(resizer)){\r\n                element.attr(resizer(options));\r\n                if (_.isFunction(options.resized)) {\r\n                    options.resized.call(element);\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Get the start point of a shape\r\n         * @returns {Object} the start point\r\n         */\r\n        function getStartPoint(){\r\n            var startPoint;\r\n            switch(element.type){\r\n                case 'circle'   : startPoint = { x : element.attrs.cx, y : element.attrs.cy }; break;\r\n                case 'ellipse'  : \r\n                case 'rect'     : startPoint = element.getBBox(); break;\r\n            }\r\n            return startPoint;\r\n        }        \r\n    };\r\n    \r\n    /**\r\n     * Provides resizing implementation based on the shape type\r\n     */ \r\n    var shapeResizer = {\r\n        \r\n        /**\r\n         * Resize a rectangle\r\n         * @param {Object} options - see resize\r\n         * @returns {Object} attributes with the new size the Raphael.Element accepts\r\n         */\r\n        rect : function resizeRectangle(options){\r\n            var start = options.start;\r\n            var stop = options.stop;\r\n            var constraints = options.constraints;\r\n            var dest = {};\r\n            \r\n            if(!constraints || constraints.x){\r\n                dest.width = stop.x - start.x;\r\n                if(dest.width < 0){\r\n                    dest.x = stop.x;\r\n                    dest.width = dest.width * -1;\r\n                } \r\n            }\r\n\r\n            if(!constraints || constraints.y){\r\n                dest.height = stop.y - start.y;\r\n                if(dest.height < 0){\r\n                    dest.y = stop.y;\r\n                    dest.height = dest.height * -1;\r\n                }\r\n            }\r\n            if(constraints && constraints.ix){\r\n                dest.x = stop.x;\r\n                dest.width = start.width - (stop.x - start.x);\r\n                if(dest.width < 0){\r\n                    dest.x = stop.x;\r\n                    dest.width = dest.width * -1;\r\n                } \r\n            }\r\n\r\n            if(constraints && constraints.iy){\r\n                dest.y = stop.y;\r\n                dest.height = start.height - (stop.y - start.y);\r\n                if(dest.height < 0){\r\n                    dest.y = stop.y;\r\n                    dest.height = dest.height * -1;\r\n                }\r\n            }\r\n            \r\n            //we keep a minimal size\r\n            if(dest.width < 10){\r\n                dest.width = 10;\r\n            }\r\n            if(dest.height < 10){\r\n                dest.height = 10;\r\n            }\r\n            return dest;\r\n        },\r\n        \r\n        /**\r\n         * Resize a circle\r\n         * @param {Object} options - see resize\r\n         * @returns {Object} attributes with the new size the Raphael.Element accepts\r\n         */\r\n        circle : function resizeCircle(options){\r\n            var start = options.start;\r\n            var stop = options.stop;\r\n            var rw = (stop.x > start.x) ? stop.x - start.x  : start.x - stop.x;\r\n            var rh = (stop.y > start.y) ? stop.y - start.y  : start.y - stop.y;\r\n            //thanks pythagore \r\n            var r =  Math.floor( Math.sqrt(Math.pow(rw, 2) + Math.pow(rh, 2)));\r\n\r\n            return {\r\n                r : r < 5 ? 5 : r\r\n            };\r\n        },\r\n\r\n        /**\r\n         * Resize an ellispe\r\n         * @param {Object} options - see resize\r\n         * @returns {Object} attributes with the new size the Raphael.Element accepts\r\n         */\r\n        ellipse : function resizeEllipse(options){\r\n            var dest = {};\r\n            var boxDest = this.rect(options); \r\n\r\n            if(boxDest.x){\r\n                dest.x = boxDest.x;\r\n            }\r\n\r\n            if(boxDest.y){\r\n                dest.y = boxDest.y;\r\n            }\r\n            \r\n            if(boxDest.width){\r\n                dest.rx = boxDest.width / 2;\r\n            }\r\n            \r\n            if(boxDest.height){\r\n                dest.ry = boxDest.height / 2;\r\n            }\r\n            return dest;\r\n        },\r\n\r\n        /**\r\n         * Resize a path\r\n         * @param {Object} options - see resize (pointIndex is required here)\r\n         * @returns {Object} attributes with the new size the Raphael.Element accepts\r\n         */\r\n        path : function resizePath(options){\r\n            var dest = {};\r\n            if(options.path && options.start){\r\n                dest.path = '';\r\n               _.forEach(options.path, function(point, index){\r\n                   dest.path += point[0];\r\n                   if(point.length === 3){\r\n                       if (index === options.pointIndex || options.pointIndex === 0 && index === 1){\r\n                            dest.path += options.stop.x + ' ' + options.stop.y;\r\n                       } else {\r\n                            dest.path += point[1] + ' ' + point[2];\r\n                       }\r\n                   }                 \r\n               }); \r\n            }\r\n            return dest;\r\n        }\r\n    };\r\n    \r\n    return resize;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeMover',['jquery', 'lodash'], function($, _){\r\n\r\n    /**\r\n     * Move a Raphael shape.\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeMover\r\n     * @param {Raphael.Element} element - the element to move\r\n     * @param {Object} start - the original position\r\n     * @param {Object} stop - the destination position\r\n     */\r\n    var move =  function move (element, start, stop){\r\n        var mover;\r\n        if(element && element.type){\r\n            mover = _.bind(shapeMover[element.type], shapeMover);\r\n          \r\n            if(_.isFunction(mover)){\r\n                element.animate(\r\n                    mover(start, stop)\r\n                );\r\n            }\r\n        }\r\n    };\r\n    \r\n    /**\r\n     * Provides moving implementation based on the shape type\r\n     */ \r\n    var shapeMover = {\r\n        \r\n        /**\r\n         * Move a rectangle;\r\n         * @param {Raphael.Element} element - the element to move\r\n         * @param {Object} start - the original position\r\n         * @param {Object} stop - the destination position\r\n         * @returns {Object} attributes with the new position, that the Raphael.Element accepts\r\n         */\r\n        rect : function moveRectangle(start, stop){\r\n            return {\r\n                x : stop.x - start.x,\r\n                y : stop.y - start.y\r\n            };\r\n        },\r\n        \r\n        /**\r\n         * Move a circle.\r\n         * @param {Raphael.Element} element - the element to move\r\n         * @param {Object} start - the original position\r\n         * @param {Object} stop - the destination position\r\n         * @returns {Object} attributes with the new position, that the Raphael.Element accepts\r\n         */\r\n        circle : function moveCircle(start, stop){\r\n            return  {\r\n                cx : stop.x,\r\n                cy : stop.y\r\n            };\r\n        },\r\n\r\n        /**\r\n         * Move an ellipse.\r\n         * @param {Raphael.Element} element - the element to move\r\n         * @param {Object} start - the original position\r\n         * @param {Object} stop - the destination position\r\n         * @returns {Object} attributes with the new position, that the Raphael.Element accepts\r\n         */\r\n        ellipse : function moveEllipse(start, stop){\r\n            return {\r\n                cx : stop.x,\r\n                cy : stop.y\r\n            };\r\n        },\r\n\r\n        /**\r\n         * Move a path.\r\n         * @param {Raphael.Element} element - the element to move\r\n         * @param {Object} start - the original position\r\n         * @param {Object} stop - the destination position\r\n         * @returns {Object} attributes with the new position, that the Raphael.Element accepts\r\n         */\r\n        path : function movePath(start, stop){\r\n                \r\n            //do not use Raphael.transformPath to prevent using Curves for translation\r\n            var dest = { \r\n                path :  '' \r\n            };\r\n            _.forEach(start.path, function(point){\r\n                dest.path += point[0];\r\n                if(point.length === 3){\r\n                    dest.path += (point[1] + stop.x - start.x) + ',' + (point[2] + stop.y - start.y);\r\n                }                 \r\n            });\r\n            return dest;\r\n        }\r\n    };\r\n    \r\n    return move;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/helpers/pathBuilder',[\r\n    'jquery', 'lodash', \r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic'\r\n], function($, _, graphicHelper){\r\n\r\n\r\n    var pathBuilder = function(paper){\r\n\r\n        var path = {\r\n\r\n            _path : null,\r\n\r\n            closed : false,\r\n\r\n            set : null,\r\n\r\n            points : [],\r\n\r\n            getPath : function(){\r\n                return this._path;\r\n            },\r\n\r\n            start : function(point){\r\n                this.points = [];\r\n                return this.add(point);\r\n            },\r\n\r\n            add : function(point){\r\n                var self = this;\r\n                var stop; \r\n                var closeMe = false;\r\n                var scaleFactor = paper.w < paper.width ? 1 : paper.w / paper.width;\r\n                var pointSize = 3 * scaleFactor;\r\n                \r\n                stop = paper.circle(point.x, point.y, pointSize)\r\n                            .attr({'stroke' : 'black', 'stroke-width': 1, 'fill' : 'white', 'opacity' : 0.7, 'cursor' : 'pointer'})\r\n                            .click(function(e){\r\n                                e.preventDefault();\r\n                                e.stopPropagation();             \r\n                                if(self.points.length > 2){\r\n                                    this.attr('fill', 'green');\r\n                                    self.close();\r\n                                }\r\n                            });\r\n                \r\n                if(this.points.length === 0){\r\n\r\n                    stop.attr('fill', 'red');\r\n\r\n                    this.set = paper.set();\r\n\r\n                    this._path = paper.path('M' + point.x + ',' + point.y).attr(graphicHelper._style.active).attr('opacity', 0.3); \r\n                    this.set.push(this._path);\r\n                }\r\n\r\n                this.points.push(point);\r\n                this.set.push(stop);\r\n                this._path.animate({ path : this._path.attr('path') + 'L' +  point.x + ',' + point.y});\r\n     \r\n                return this;\r\n            },\r\n\r\n            close : function(){\r\n                this._path.attr({ path : this._path.attr('path') + 'Z'}).attr(graphicHelper._style.active).attr('opacity', 1); \r\n                this.set.forEach(function(elt){\r\n                    if(elt.type === 'circle'){\r\n                        elt.remove();         \r\n                    }\r\n                });\r\n                this.closed = true;\r\n                if(_.isFunction(this.closeCb)){\r\n                    this.closeCb();\r\n                }\r\n                \r\n                return this;\r\n            },\r\n\r\n            onClose : function(closeCb){\r\n                this.closeCb = closeCb;\r\n                return this;\r\n            }\r\n        };\r\n        return path;\r\n    };\r\n\r\n    return pathBuilder;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeFactory',[\r\n    'jquery', 'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeHandlers',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeResizer',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeMover',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/pathBuilder'\r\n], function($, _, graphicHelper, shapeHandlers, shapeResizer, shapeMover, pathBuilder){\r\n\r\n    var shapeFactory = function shapeFactory(options){\r\n        var paper = options.paper;\r\n        var background = options.background;\r\n        var $container = options.$container;\r\n        var isResponsive = options.isResponsive || false;\r\n        var type = options.type || 'rect';\r\n\r\n        var creator = {\r\n            \r\n            states : {\r\n                drawing : false\r\n            },\r\n\r\n            _events : {},\r\n\r\n            on : function on(eventName, cb){\r\n                if(_.isFunction(cb)){\r\n                    this._events[eventName] = cb;\r\n                }\r\n            },\r\n\r\n            is : function is(state){\r\n                return this.states[state] === true;\r\n            },\r\n            \r\n            setState : function setState(state, value){\r\n                this.states[state] = value;\r\n            },\r\n\r\n            /**\r\n             * Start the shape creation\r\n             */ \r\n            start : function(){\r\n                switch(type){\r\n                    case 'path'     : this.startDrawingPath(); break;\r\n                    case 'target'   : this.startPositionTarget(); break;\r\n                    default         : this.startWithMouse(); break;\r\n                }\r\n            },\r\n\r\n            startPositionTarget : function startPositionTarget(){\r\n                var self = this;\r\n                self.setState('drawing', true);\r\n\r\n                background.click(function(e){\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n \r\n                    //get the current mouse point, even on a responsive paper\r\n                    var point = graphicHelper.getPoint(e, paper, $container, isResponsive);\r\n                    \r\n                    //add the point to the paper\r\n                    graphicHelper.createTarget(paper, {\r\n                        point : point, \r\n                        create : function created(target){\r\n                            self.setState('drawing', false);\r\n                            background.unclick();\r\n                            if(self._events['created.qti-widget']){\r\n                               self._events['created.qti-widget'].call(this, target); \r\n                            }\r\n                        },\r\n                        remove : false,\r\n                        hover  : false\r\n                    });\r\n                });\r\n            },\r\n\r\n            startDrawingPath : function startDrawingPath(){\r\n                var self = this;\r\n                var builder = pathBuilder(paper);\r\n                \r\n                self.setState('drawing', true);\r\n                \r\n                builder.onClose(created);\r\n                background.click(function(e){\r\n                    e.preventDefault();\r\n                    e.stopPropagation();             \r\n                    if(self.is('drawing')){\r\n                        builder.add(\r\n                            graphicHelper.getPoint(e, paper, $container, isResponsive)\r\n                        );\r\n                    }\r\n                });\r\n\r\n                function created(){\r\n                    self.setState('drawing', false);\r\n                    background.unclick();\r\n                    if(self._events['created.qti-widget']){\r\n                       self._events['created.qti-widget'].call(this, builder.getPath()); \r\n                    }\r\n                }\r\n            },\r\n          \r\n            startWithMouse : function startWithMouse(){            \r\n                var self = this;\r\n                var smoothResize = _.throttle(resize, 10);\r\n                var startPoint;\r\n                var shape;\r\n                \r\n                background.mousedown( function startDrawing(event){\r\n                    event.preventDefault();\r\n\r\n                    if(!self.is('drawing')){\r\n                        self.setState('drawing', true);\r\n\r\n                        startPoint = graphicHelper.getPoint(event, paper, $container, isResponsive);\r\n\r\n                        //create a base shape\r\n                        shape = graphicHelper.createElement(paper, type, [startPoint.x, startPoint.y, 25, 25], { \r\n                                style       : 'creator',\r\n                                hover       : false, \r\n                                touchEffect : false, \r\n                                qtiCoords   : false\r\n                            });\r\n    \r\n                        shape.mouseup(created);\r\n                        background.mouseup(created);\r\n                        \r\n                        //resize it now\r\n                        shape.mousemove(smoothResize);\r\n                        background.mousemove(smoothResize);    \r\n                    }\r\n                });\r\n\r\n                function created(){\r\n                    self.setState('drawing', false);\r\n                    background\r\n                        .unmousedown()\r\n                        .unmousemove()\r\n                        .unmouseup();\r\n                    shape\r\n                        .unmousedown()\r\n                        .unmouseup()\r\n                        .unmousemove();\r\n                    if(self._events['created.qti-widget']){\r\n                       self._events['created.qti-widget'].call(this, shape); \r\n                    }\r\n                }\r\n\r\n                function resize(event){\r\n                    if(self.is('drawing')){\r\n                        shapeResizer(shape, {\r\n                            start   : startPoint,\r\n                            stop    : graphicHelper.getPoint(event, paper, $container, isResponsive)\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n\r\n            stop : function(){\r\n\r\n                    background\r\n                        .unmousedown()\r\n                        .unmousemove()\r\n                        .unmouseup()\r\n                        .unclick();\r\n            }\r\n        };\r\n\r\n        return creator;\r\n    };\r\n\r\n    return shapeFactory;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeEditor',[\r\n    'jquery', 'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeHandlers',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeResizer',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeMover',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/pathBuilder'\r\n], function($, _, graphicHelper, shapeHandlers, shapeResizer, shapeMover, pathBuilder){\r\n\r\n    /**\r\n     * Enables you to edit a shape: handling, resizing, moving.\r\n     * This function is a factory that gives you a new instance of editor.\r\n     * \r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeEditor\r\n     *\r\n     * @param {Raphael.Element} shape - the shape to edit\r\n     * @param {Object} options - the contextual options\r\n     * @param {Raphael.Paper} options.paper - the raphael paper\r\n     * @param {Raphael.Element} options.background - the paper's background image element\r\n     * @param {jQueryElement} options.$container - the paper container\r\n     * @param {Boolean} [options.isResponsive = false] - if we are in responsive mode (auto scalling)\r\n     * @returns {shapeEditor.editor} the shape editor instance\r\n     */\r\n    var shapeEditor = function(shape, options){\r\n\r\n        var paper = options.paper;\r\n        var background = options.background;\r\n        var $container = options.$container;\r\n        var isResponsive = options.isResponsive || false;\r\n\r\n        /**\r\n         * The editor linked to a shape \r\n         * @type shapeEditor.editor\r\n         */\r\n        var editor = {\r\n\r\n            shape : null,\r\n\r\n            handlers : [],\r\n\r\n            states : {\r\n                drawing : false,\r\n                handling : false,\r\n                resizing : false,\r\n                moving : false\r\n            },\r\n\r\n            _events : {},\r\n\r\n            /**\r\n             * Listen for an event bound to the editor\r\n             * @param {String} eventName - the name of the event to listen\r\n             * @param {Function} cb - event callback \r\n             * @returns {shapeEditor.editor} for chaining\r\n             */\r\n            on : function on(eventName, cb){\r\n                if(_.isFunction(cb)){\r\n                    this._events[eventName] = cb;\r\n                }\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Trigger an event on the editor\r\n             * @param {String} eventName - the name of the event to trigger\r\n             * @param {...*} args - additional args to pass to the bound callbacks\r\n             * @returns {shapeEditor.editor} for chaining\r\n             */\r\n            trigger : function(eventName){\r\n                if(_.isFunction(this._events[eventName])){\r\n                    this._events[eventName].apply(this, Array.prototype.slice.call(arguments, 1));\r\n                }\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Check if the editor is in the given state\r\n             * @param {String} state - the state name\r\n             * @returns {Boolean} is in the state or not \r\n             */\r\n            is : function is(state){\r\n                return this.states[state] === true;\r\n            },\r\n            \r\n            /**\r\n             * Set the editor in a particular state\r\n             * @param {String} state - the state name\r\n             * @param {Boolean} value -\r\n             * @returns {shapeEditor.editor} for chaining\r\n             */\r\n            setState : function setState(state, value){\r\n                this.states[state] = value;\r\n                return this;\r\n            },\r\n\r\n\r\n            /**\r\n             * Set up the editor \r\n             * @constructor\r\n             * @private \r\n             * @param {Raphael.Element} shape - the shape to edit\r\n             * @returns {shapeEditor.editor} the shape editor instance\r\n             */ \r\n            _init : function(shape){\r\n                var self = this;\r\n                if(shape && shape.type){\r\n                    self.shape = shape;\r\n                    background.click(function(){\r\n                         if(!self.is('resizing') && self.is('handling')){\r\n                            self.quitHandling();  \r\n                         }\r\n                    });\r\n                    self.shape.click(function(){\r\n                         if(!self.is('resizing')){\r\n                            if(!self.is('handling')){\r\n                                self.enterHandling();  \r\n                            } else {\r\n                                self.quitHandling();  \r\n                            }    \r\n                        }\r\n                    });\r\n                }\r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Start the shape handling \r\n             * @returns {shapeEditor.editor} the shape editor instance\r\n             */ \r\n            enterHandling : function enterHandling(){\r\n                var self = this;\r\n                \r\n                //enter handling\r\n                self.setState('handling', true)\r\n                    .trigger('enterhandling.qti-widget');\r\n    \r\n                //do not move set\r\n                if(self.shape.type === 'set'){\r\n                    return;\r\n                }                   \r\n\r\n                //create handlers to resize the shape\r\n                self.handlers = shapeHandlers(paper, self.shape);\r\n                _.forEach(self.handlers, function(handler){\r\n                    //drag the handlers to resize the shape\r\n                    handler.drag(resize, startResize, resized);\r\n                });\r\n\r\n                //drag the shape to move it\r\n                self.shape.drag(move, startMove, moved);\r\n\r\n                var keyResizer = _.throttle(keyResize, 20);\r\n  \r\n                //bind keys \r\n                $(document).on('keydown.qti-widget', function(e){\r\n                    var code = e.which;\r\n                    //arrows\r\n                    if(code >= 37 && code <= 40){\r\n                        e.preventDefault();\r\n                        keyResizer(code);\r\n                    }\r\n                    //delete and backspace\r\n                    //if(e.which === 8 || e.which === 46){\r\n                        //e.preventDefault();\r\n                        //self.quitHandling();\r\n                        //self.removeShape();\r\n                    //}\r\n                });\r\n\r\n                /**\r\n                 * Start the resizing from an handler, create the layer, the start point, etc.\r\n                 * Used as handler dragstart callback\r\n                 * @private\r\n                 */ \r\n                function startResize (){ \r\n                    var handler  = this; \r\n                    var bbox;\r\n                    self.setState('resizing', true)\r\n                        .trigger('shapechanging.qti-widget');\r\n                    \r\n                    //create a layer to be reiszed\r\n                    self.layer = self.shape.clone();\r\n                    self.layer.attr(graphicHelper._style.basic);\r\n                    self.layer.attr('cursor', handler.attrs.cursor);\r\n\r\n                    bbox = self.layer.getBBox();\r\n                    self.layerTxt = graphicHelper.createShapeText(paper, self.layer, { \r\n                        style   : 'layer-pos-text',\r\n                        content : parseInt(bbox.width, 10) + ' x ' + parseInt(bbox.height, 10) \r\n                    });\r\n\r\n                    if(self.shape.type === 'path'){\r\n                       _.forEach(self.shape.attr('path'), function(point, index){\r\n                           if(point.length === 3 && point[1] === this.attr('cx') && point[2] === this.attr('cy')){\r\n                                this.pointIndex = index;\r\n                                return false; \r\n                           }                 \r\n                       }, handler); \r\n                    }\r\n\r\n                    //hide others\r\n                    _.invoke(_.reject(_.clone(self.handlers), function(elt){\r\n                        return elt === handler;\r\n                    }), 'hide');                              \r\n                }\r\n                 \r\n                /**\r\n                 * Resize a shape (in fact only the layer)\r\n                 * Used as handler drag callback\r\n                 * @private\r\n                 */ \r\n               function resize(dx, dy, x, y, event){\r\n                    var stopPoint, options;\r\n                    if(self.is('resizing')){\r\n\r\n                        stopPoint = graphicHelper.getPoint(event, paper, $container, isResponsive);\r\n                        options =  {\r\n                            stop        : stopPoint,\r\n                            constraints : this.data('constraints'),\r\n                            resized     : _.throttle(function(){\r\n                                var bbox = this.getBBox();\r\n                                self.layerTxt.attr('text',  parseInt(bbox.width, 10) + ' x ' + parseInt(bbox.height, 10) );\r\n                            }, 100)\r\n                        };\r\n\r\n                        if(self.shape.type === 'path'){\r\n                            options.start = _.pick(this.attrs, ['cx', 'cy']); \r\n                            options.path = self.layer.attr('path');\r\n                            options.pointIndex = this.pointIndex;\r\n                        }\r\n\r\n                        shapeResizer(self.layer, options);\r\n                         \r\n\r\n                        \r\n                        if(this.type === 'circle'){\r\n                            this.animate({\r\n                                cx : stopPoint.x,\r\n                                cy : stopPoint.y\r\n                            });\r\n                        } else {\r\n                            this.animate(stopPoint);\r\n                        }\r\n                    }\r\n                }\r\n               \r\n                /**\r\n                 * Finish resize: sync the shape to the resized layer\r\n                 * Used as handler dragend callback\r\n                 * @private\r\n                 */ \r\n                function resized(){\r\n                    self.shape.animate(\r\n                        _.pick(self.layer.attrs, ['x', 'y', 'cx', 'cy', 'r', 'rx', 'ry', 'width', 'height', 'path']),\r\n                        200,\r\n                        function animationEnd(){\r\n                            self.setState('resizing', false)\r\n                                .trigger('shapechange.qti-widget');\r\n                        }\r\n                    );\r\n                    self.layer.remove();\r\n                    self.layerTxt.remove();\r\n                    \r\n                    _.invoke(self.handlers, 'remove');\r\n                    self.handlers = [];\r\n                } \r\n               \r\n                /**\r\n                 * Resize a shape from keyboard\r\n                 * @param {Number} code - the HTMLEvent's key code\r\n                 * @private\r\n                 */ \r\n                function keyResize(code){ \r\n                    var attr, stop, start;\r\n                    if(!self.is('moving')){\r\n                        self.setState('moving', true);\r\n                        _.invoke(self.handlers, 'remove');\r\n                        \r\n                        attr = shape.attr();\r\n\r\n                        switch(self.shape.type){\r\n\r\n                            case 'rect' : \r\n                                start = { x: 0, y: 0 }; \r\n                                stop  = {\r\n                                    x : (code === 39) ? attr.x + 1 : (code === 37) ? attr.x - 1 : attr.x,\r\n                                    y : (code === 40) ? attr.y + 1 : (code === 38) ? attr.y - 1 : attr.y,\r\n                                };\r\n                                break;\r\n                            case 'ellipse' : \r\n                            case 'circle' : \r\n                                start = { x: 0, y: 0 }; \r\n                                stop  = {\r\n                                    x : (code === 39) ? attr.cx + 1 : (code === 37) ? attr.cx - 1 : attr.cx,\r\n                                    y : (code === 40) ? attr.cy + 1 : (code === 38) ? attr.cy - 1 : attr.cy,\r\n                                };\r\n                                break;\r\n                            case 'path' : \r\n                                start = { path : attr.path }; \r\n                                stop  = {\r\n                                };\r\n                                break;\r\n                        }\r\n\r\n                        shapeMover(\r\n                            self.shape, start, stop\r\n                        );\r\n                        self.setState('moving', false)\r\n                            .trigger('shapechange.qti-widget');\r\n                    }\r\n                }\r\n\r\n                /**\r\n                 * Start the moving the shape.\r\n                 * Used as handler dragstart callback\r\n                 * @private\r\n                 */ \r\n                function startMove(x, y , event){\r\n                    self.setState('moving', true)\r\n                        .trigger('shapechanging.qti-widget');\r\n                    \r\n                    var mousePoint = graphicHelper.getPoint(event, paper, $container, isResponsive);\r\n                    this.startPoint = {\r\n                        x : mousePoint.x - this.attr('x'),\r\n                        y : mousePoint.y - this.attr('y')\r\n                    };\r\n                    if(this.type === 'path'){\r\n                        this.startPoint.path = this.attr('path');\r\n                    }\r\n                    self.shape.attr('cursor', 'move');\r\n                    background.attr('cursor', 'move');\r\n                    _.invoke(self.handlers, 'remove');                              \r\n                }        \r\n                \r\n                /**\r\n                 * Move a shape\r\n                 * Used as handler drag callback\r\n                 * @private\r\n                 */ \r\n                function move(dx, dy, x, y, event){\r\n                    var dest;\r\n                    if(self.is('moving')){\r\n                        shapeMover(\r\n                            this, \r\n                            this.startPoint, \r\n                            graphicHelper.getPoint(event, paper, $container, isResponsive)\r\n                        );\r\n                    }\r\n                }\r\n\r\n                /**\r\n                 * Finish moving\r\n                 * Used as shape dragend callback\r\n                 * @private\r\n                 */ \r\n                function moved(){\r\n                    delete this.startPoint;\r\n                    self.shape.attr('cursor', 'pointer');\r\n                    background.attr('cursor', 'default');\r\n\r\n                    self.setState('moving', false)\r\n                        .trigger('shapechange.qti-widget');\r\n                }\r\n\r\n                return this;\r\n            },\r\n            \r\n            /**\r\n             * Stop the shape handling \r\n             * @returns {shapeEditor.editor} the shape editor instance\r\n             */ \r\n            quitHandling : function quitHandling(){\r\n                $(document).off('keydown.qti-widget');\r\n\r\n                this.shape.undrag();\r\n                _.invoke(this.handlers, 'remove');\r\n                this.handlers = [];\r\n\r\n                this.setState('moving', false)\r\n                    .setState('resizing', false)\r\n                    .setState('handling', false)\r\n                    .trigger('quithandling.qti-widget'); \r\n                \r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Removes the editor's shape \r\n             * @returns {shapeEditor.editor} the shape editor instance\r\n             */ \r\n            removeShape : function removeShape(){\r\n                var id, data;\r\n                if(this.shape){\r\n                    this.quitHandling();\r\n                    id = this.shape.id;\r\n                    data = this.shape.data;\r\n                    this.shape.remove();\r\n                    this.trigger('remove.qti-widget', id, data); \r\n                }\r\n                \r\n                return this;\r\n            },\r\n\r\n            /**\r\n             * Clean up editor in case of reference keeping \r\n             * @returns {shapeEditor.editor} the shape editor instance\r\n             */ \r\n            destroy : function destroy(){\r\n                if(this.is('handling')){\r\n                    this.quitHandling();\r\n                }\r\n                if(this.shape){\r\n                    this.shape.unclick();\r\n                    background.unclick();\r\n                }\r\n                this.shape = null;\r\n                this.handlers  = [];\r\n                this._events  = {};\r\n                return this;\r\n            }\r\n        };\r\n        \r\n        return editor._init(shape);\r\n    };\r\n\r\n    return shapeEditor;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeSideBar',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeFactory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/shapeEditor',\r\n], function($, _, GraphicHelper, shapeSideBar, shapeFactory, shapeEditor){\r\n\r\n    /**\r\n     * This factory creates an new shape editor. \r\n     * The editor manages to create the side bar to add, move, resize and delete the interaction shapes.\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor\r\n     * @param {Object} widget - the graphic interaction widget\r\n     * @param {Object} [options]\r\n     * @param {Array<String>} [options.currents] - the list of current shapes ids (use interaction's choices serial by default)\r\n     * @param {Boolean} [options.target = false]  - if the side bar contains a target type (to select a point)\r\n     * @param {shapeCreated} [options.shapeCreated]\r\n     * @param {shapeRemoved} [options.shapeRemoved]\r\n     * @param {shapeChange} [options.shapeChange]\r\n     * @param {shapeChanging} [options.shapeChanging]\r\n     * @param {enterHandling} [options.enterHandling]\r\n     * @param {quitHandling} [options.quitHandling]\r\n     * @returns {InteractionShapeEditor}\r\n     */\r\n    return function factory(widget, options){\r\n\r\n        /**\r\n         * One by interaction, but itthat contains multipe shapeEditor (one by shape).\r\n         * @typedef InteractionShapeEditor\r\n         */\r\n        var interactionShapeEditor = {\r\n\r\n            //keep the ref to the editor to be able to destroy them later\r\n            editors :  [],\r\n\r\n            /**\r\n             * Create the editor\r\n             */\r\n            create : function(){\r\n                var editors     = this.editors;\r\n                var factories   = {};\r\n                var $container  = widget.$container;\r\n                var $original   = widget.$original;\r\n                var interaction = widget.element;\r\n                var paper       = interaction.paper;\r\n                var image       = paper.getById('bg-image-' + interaction.serial);\r\n                var currents    = options.currents || _.pluck(interaction.getChoices(), 'serial');\r\n\r\n                //set up shape cnotextual options\r\n                var shapeOptions = {\r\n                    paper : interaction.paper, \r\n                    background : image, \r\n                    $container : $container.find('.main-image-box'), \r\n                    isResponsive : $original.hasClass('responsive')\r\n                };\r\n            \r\n                //create the side bar \r\n                var $sideBar = shapeSideBar.create($original, !!options.target); \r\n\r\n                //once a shape type is selected\r\n                $sideBar.on('shapeactive.qti-widget', function(e, $form, type){\r\n                \r\n                    //enable to create a shape of the given type\r\n                    createShape(type, function shapeCreated (shape){\r\n                        \r\n                        if(_.isFunction(options.shapeCreated)){\r\n                        \r\n                            /**\r\n                             * Called back when a shape is created\r\n                             * @callback shapeCreated\r\n                             * @param {Raphael.Element} shape - the new shape\r\n                             * @param {String} type - the new shape type \r\n                             */\r\n                            options.shapeCreated(shape, type);\r\n                        }                \r\n                        \r\n                        //deactivate the form in the sidebar\r\n                        $form.removeClass('active');\r\n\r\n                        //start the shape editor (hnadling, resize, move)\r\n                        editCreatedShape(type, shape);\r\n                    });\r\n                });\r\n\r\n                $sideBar.on('shapedeactive.qti-widget', function(e, $form, type){\r\n                       if(factories && factories[type]){\r\n                            factories[type].stop();\r\n                       }\r\n                });\r\n\r\n                //retrieve the current shapes and make them editable\r\n                _.forEach(currents, function(id){\r\n                    var element = paper.getById(id);\r\n                    if(element){\r\n                        element\r\n                            .attr(GraphicHelper._style.creator)\r\n                            .unmouseover()\r\n                            .unmouseout();\r\n                        if(/^target/.test(element.id)){\r\n                            editCreatedShape('target', element);\r\n                        } else {\r\n                            editCreatedShape(element.type, element, false);\r\n                        }\r\n                    }\r\n                });\r\n\r\n                /**\r\n                 * Make a shape editable\r\n                 * @private\r\n                 * @param {Raphael.Element} shape - the shape to make editable\r\n                 * @param {Boolean} [enterHandling = false]  - wether to enter handling directly\r\n                 */\r\n                function editShape(shape, enterHandling){\r\n\r\n                    var editor = shapeEditor(shape, shapeOptions); \r\n                    editor.on('enterhandling.qti-widget', function(){\r\n\r\n                        //only one shape handling at a time\r\n                        _.invoke(_.reject(editors, editor), 'quitHandling');\r\n\r\n                        //enable to bin the shape\r\n                        $sideBar\r\n                            .trigger('enablebin.qti-widget')\r\n                            .on('bin.qti-widget', function(){\r\n                                \r\n                                //remove the shape and the editor\r\n                                editor.removeShape();\r\n                                editor.destroy();\r\n                                editors = _.reject(editors, editor);\r\n                                editor = undefined;\r\n                            });\r\n                         \r\n                        if(_.isFunction(options.enterHandling)){\r\n                            \r\n                            /**\r\n                             * Called back when a shape is being handled\r\n                             * @callback enterHandling\r\n                             * @param {Raphael.Element} shape - the shape\r\n                             */\r\n                            options.enterHandling(shape);\r\n                        }                \r\n                    }).on('shapechanging.qti-widget', function(){\r\n\r\n                        if(_.isFunction(options.shapeChanging)){\r\n                            \r\n                            /**\r\n                             * Called back when a shape is being changed\r\n                             * @callback shapeChanging\r\n                             * @param {Raphael.Element} shape - the shape\r\n                             */\r\n                            options.shapeChanging(shape);\r\n                        }                \r\n\r\n                    }).on('shapechange.qti-widget', function(){\r\n\r\n                        if(_.isFunction(options.shapeChange)){\r\n                            \r\n                            /**\r\n                             * Called back when a shape has changed\r\n                             * @callback shapeChange\r\n                             * @param {Raphael.Element} shape - the shape\r\n                             */\r\n                            options.shapeChange(shape);\r\n                        }                \r\n\r\n                    }).on('quithandling.qti-widget', function(){\r\n\r\n                        if(_.isFunction(options.quitHandling)){\r\n                            \r\n                            /**\r\n                             * Called back when the handling is left on a shape\r\n                             * @callback quitHandling\r\n                             * @param {Raphael.Element} shape - the shape\r\n                             */\r\n                            options.quitHandling(shape);\r\n                        }                \r\n\r\n                        //update the side bar\r\n                        $sideBar\r\n                            .trigger('disablebin.qti-widget')\r\n                            .off('click')\r\n                            .off('bin.qti-widget');\r\n\r\n                    }).on('remove.qti-widget', function(id, data){\r\n                        if(_.isFunction(options.shapeRemoved)){\r\n                            \r\n                            /**\r\n                             * Called back when a shape is removed\r\n                             * @callback shapeRemoved\r\n                             * @param {String} id - the id of the passed away shape\r\n                             */\r\n                            options.shapeRemoved(id, data);\r\n                        }                \r\n                        _.remove(currents, id);\r\n                    });\r\n\r\n                    editors.push(editor);\r\n                    if(enterHandling){\r\n                        editor.enterHandling();\r\n                    }\r\n                }\r\n\r\n                /**\r\n                 * Enables to create a shape of the given type\r\n                 * @private\r\n                 * @param {String} type - the shape type (rect, circle, ellipse or path)\r\n                 * @param {Function} created - call back once a new shape is created\r\n                 */\r\n                function createShape(type, created){\r\n                    var factory = factories[type];\r\n                    if(!factories[type]){\r\n                        factory = shapeFactory(_.merge({type : type}, shapeOptions));\r\n                        factories[type] = factory;\r\n                    } \r\n                    \r\n                    factory.on('created.qti-widget', created); \r\n                    factory.start();\r\n                }\r\n\r\n                /**\r\n                 * Make the created shape editable\r\n                 * @private\r\n                 * @param {String} type - the shape type (rect, circle, ellipse or path)\r\n                 * @param {Raphael.Element} shape - the new shape\r\n                 * @param {Boolean} enterHandling - if the shape start in handling mode\r\n                 */\r\n                function editCreatedShape(type, shape, enterHandling){\r\n                    var layer, set;\r\n                    if(type !== 'target'){\r\n                        editShape(shape, enterHandling);\r\n                    } else {\r\n                        //for the target, we group the elements into a set\r\n                        layer    = paper.getById('layer-' + shape.id);\r\n                        set      = paper.set(shape, layer);\r\n                        set.id   = shape.id;\r\n                        set.data = shape.data(); \r\n                        editShape(set, enterHandling);\r\n                    }\r\n                }\r\n            },\r\n\r\n            /**\r\n             * Destroy the editor\r\n             */\r\n            destroy : function(){\r\n\r\n                var $container  = widget.$original;\r\n                var interaction = widget.element;\r\n                var paper       = interaction.paper;\r\n                var currents    = options.currents || _.pluck(interaction.getChoices(), 'serial');\r\n\r\n                shapeSideBar.remove($container);\r\n                \r\n                _.invoke(this.editors, 'destroy');\r\n\r\n                //reset the shape style\r\n                _.forEach(currents, function(id){\r\n                    var element = paper.getById(id);\r\n                    if(element){\r\n                        element\r\n                            .attr(GraphicHelper._style.basic)\r\n                            .hover(function(){\r\n                                if(!element.flashing){\r\n                                    GraphicHelper.updateElementState(this, 'hover'); \r\n                                }\r\n                          }, function(){\r\n                                if(!element.flashing){\r\n                                    GraphicHelper.updateElementState(this, this.active ? 'active' : this.selectable ? 'selectable' : 'basic');\r\n                                }\r\n                          });\r\n                    }\r\n                });\r\n            }\r\n        };\r\n    \r\n        return interactionShapeEditor;\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n/**\r\n * Pre-configured instance of the resource manager\r\n *\r\n * @author dieter <dieter@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/resourceManager',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'util/image',\r\n    'ui/resourcemgr'\r\n], function ($, _, __, imageUtil) {\r\n    'use strict';\r\n\r\n    var ns = 'upload';\r\n\r\n    /**\r\n     * @exports\r\n     */\r\n    return function($element, options){\r\n        $element.resourcemgr({\r\n            title : options.title,\r\n            appendContainer : options.mediaManager.appendContainer,\r\n            mediaSourcesUrl : options.mediaManager.mediaSourcesUrl,\r\n            browseUrl : options.mediaManager.browseUrl,\r\n            uploadUrl : options.mediaManager.uploadUrl,\r\n            deleteUrl : options.mediaManager.deleteUrl,\r\n            downloadUrl : options.mediaManager.downloadUrl,\r\n            fileExistsUrl : options.mediaManager.fileExistsUrl,\r\n            params : {\r\n                uri : options.uri,\r\n                lang : options.lang,\r\n                filters : 'image/jpeg,image/png,image/gif'\r\n            },\r\n            pathParam : 'path',\r\n            select : function(e, files){\r\n                var selected;\r\n                if(files.length > 0){\r\n                    selected = files[0];\r\n                    imageUtil.getSize(options.baseUrl + encodeURIComponent(files[0].file), function(size){\r\n                        $element.trigger('selected.' + ns, {\r\n                            selected: selected,\r\n                            size: size\r\n                        });\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/imageSelector',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'util/image',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/resourceManager',\r\n    'ui/resourcemgr',\r\n    'ui/tooltip'\r\n], function($, _, __, imageUtil, resourceManager){\r\n\r\n    'use strict';\r\n\r\n    return function($form, options){\r\n\r\n        var _ns = '.imageSelector',\r\n            $upload = $('[data-role=\"upload-trigger\"]', $form),\r\n            $src = $('input[name=data]', $form),\r\n            $width = $('input[name=width]', $form),\r\n            $height = $('input[name=height]', $form),\r\n            $type = $('input[name=type]', $form);\r\n            options.title = options.title ?\r\n                  options.title :\r\n                  __('Please select a background picture for your interaction from the resource manager.\\\r\n                      You can add new files from your computer with the button \"Add file(s)\".');\r\n\r\n        /**\r\n         * Configure and launch the pre-configured instance of the resource manager\r\n         *\r\n         * @private\r\n         */\r\n        var _openResourceMgr = function(){\r\n            $upload.on('selected.upload', function(e, args) {\r\n                if(args.size && args.size.width >= 0){\r\n                    $width.val(args.size.width).trigger('change');\r\n                    $height.val(args.size.height).trigger('change');\r\n                }\r\n                $type.val(args.selected.mime).trigger('change');\r\n                _.defer(function(){\r\n                    $src.val(args.selected.file).trigger('change');\r\n                });\r\n\r\n            })\r\n                .on('open', function(){\r\n                    $src.trigger('open.'+_ns);\r\n                    //hide tooltip if displayed\r\n                    if($src.data('qtip')){\r\n                        $src.blur().qtip('hide');\r\n                    }\r\n                })\r\n                .on('close', function(){\r\n                    $src.trigger('close.'+_ns);\r\n                });\r\n\r\n\r\n            resourceManager($upload, options);\r\n\r\n        };\r\n\r\n        $upload.on('click', _openResourceMgr);\r\n\r\n        //if empty, open file manager immediately\r\n        if(!$src.val()){\r\n            _openResourceMgr();\r\n        }\r\n    };\r\n\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/graphicAssociate', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Interaction Background\", options) : helperMissing.call(depth0, \"__\", \"Interaction Background\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"data\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the image.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the image.\", options)))\n    + \"</div>\\r\\n        <input type=\\\"text\\\" name=\\\"data\\\" value=\\\"\";\n  if (helper = helpers.data) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.data); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n        <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select image\", options) : helperMissing.call(depth0, \"__\", \"Select image\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"panel media-sizer-panel\\\">\\r\\n        <!-- media sizer goes here -->\\r\\n    </div>\\r\\n    <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n    <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n\\r\\n\\r\\n    <input name=\\\"type\\\" value=\\\"\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" readonly />\\r\\n\\r\\n    <hr />\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed associations\", options) : helperMissing.call(depth0, \"__\", \"Allowed associations\", options)))\n    + \"</h3>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of associations that the candidate is required to make to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of associations that the candidate is required to make to form a valid response.\", options)))\n    + \"<br>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of associations that the candidate is allowed to make.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of associations that the candidate is allowed to make.\", options)))\n    + \"\\r\\n        </span>\\r\\n\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <div>\\r\\n            <label for=\\\"minAssociations\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Min\", options) : helperMissing.call(depth0, \"__\", \"Min\", options)))\n    + \"</label>\\r\\n        <input name=\\\"minAssociations\\\" value=\\\"\";\n  if (helper = helpers.minAssociations) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.minAssociations); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n        <div>\\r\\n            <label for=\\\"maxAssociations\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max\", options) : helperMissing.call(depth0, \"__\", \"Max\", options)))\n    + \"</label>\\r\\n        <input name=\\\"maxAssociations\\\" value=\\\"\";\n  if (helper = helpers.maxAssociations) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxAssociations); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/choices/associableHotspot', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"identifier\", options) : helperMissing.call(depth0, \"__\", \"identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"identifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. my-hotspot_1\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\\r\\n\\r\\n<h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed number of matches\", options) : helperMissing.call(depth0, \"__\", \"Allowed number of matches\", options)))\n    + \"\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices this choice must be associated with to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices this choice must be associated with to form a valid response.\", options)))\n    + \"<br>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices this choice may be associated with.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices this choice may be associated with.\", options)))\n    + \"\\r\\n    </span>\\r\\n</h3>\\r\\n\\r\\n<div>\\r\\n    <label for=\\\"matchMin\\\" class=\\\"spinner\\\">Min</label>\\r\\n    <input name=\\\"matchMin\\\" value=\\\"\";\n  if (helper = helpers.matchMin) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.matchMin); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n</div>\\r\\n<div>\\r\\n    <label for=\\\"matchMax\\\" class=\\\"spinner\\\">Max</label>\\r\\n    <input name=\\\"matchMax\\\" value=\\\"\";\n  if (helper = helpers.matchMax) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.matchMax); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n</div>\\r\\n\\r\\n<h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shape position\", options) : helperMissing.call(depth0, \"__\", \"Shape position\", options)))\n    + \"</h3>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"x\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Left\", options) : helperMissing.call(depth0, \"__\", \"Left\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The left position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The left position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"x\\\" value=\\\"\";\n  if (helper = helpers.x) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.x); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"y\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Top\", options) : helperMissing.call(depth0, \"__\", \"Top\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The top position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The top position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"y\\\" value=\\\"\";\n  if (helper = helpers.y) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.y); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Width\", options) : helperMissing.call(depth0, \"__\", \"Width\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The shape width in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The shape width in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"height\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Height\", options) : helperMissing.call(depth0, \"__\", \"Height\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The shape height in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The shape height in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n/**\r\n *\r\n * @author dieter <dieter@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/bgImage',[\r\n    'util/url',\r\n    'util/image',\r\n    'ui/mediasizer'\r\n], function (url, imageUtil) {\r\n    'use strict';\r\n\r\n    /**\r\n     * @exports\r\n     */\r\n\r\n    /**\r\n     * Handle images that are larger than the canvas\r\n     *\r\n     * @param widget\r\n     */\r\n    function handleOversizedImages(widget) {\r\n\r\n        var $svg = widget.$original.find('.svggroup svg');\r\n        var viewBox;\r\n        var $bgImage = $svg.find('image');\r\n        var trueSize = $bgImage[0].getBoundingClientRect();\r\n        var imgWidth = parseInt(trueSize.width, 10);\r\n        var imgHeight = parseInt(trueSize.height, 10);\r\n\r\n        if(imgWidth >= Number(widget.element.object.attr('width'))) {\r\n            return;\r\n        }\r\n\r\n        // update model\r\n        widget.element.object.attr('width', imgWidth);\r\n        widget.element.object.attr('height', imgHeight);\r\n\r\n        // change image attributes\r\n        $bgImage[0].setAttribute('width', imgWidth);\r\n        $bgImage[0].setAttribute('height', imgHeight);\r\n\r\n        // change svg view box\r\n        viewBox = $svg[0].getAttribute('viewBox').split(' ');\r\n        viewBox[2] = imgWidth;\r\n        viewBox[3] = imgHeight;\r\n        $svg[0].setAttribute('viewBox', viewBox.join(' '));\r\n\r\n        $svg[0].setAttribute('width', imgWidth);\r\n        $svg[0].setAttribute('height', imgHeight);\r\n\r\n        $svg.parents('.main-image-box').css({ height: imgHeight, width: imgWidth });\r\n\r\n        widget.$original.trigger('resize.qti-widget.' + widget.serial, [imgWidth, imgHeight]);\r\n    }\r\n\r\n\r\n    /**\r\n     * Setup the background image\r\n     *\r\n     * @param widget\r\n     */\r\n    function setupImage(widget) {\r\n\r\n        var $bgImage = widget.$original.find('.svggroup svg image');\r\n\r\n        if (widget.$original.hasClass('responsive')) {\r\n            return;\r\n        }\r\n\r\n        if (!!$bgImage.length) {\r\n            // TODO: This was removed becaus it is not likely needed after adjusting the svg.\r\n            // It was left just in case an issue arrives and needs to be reinstated.\r\n            // handle images larger than the canvas\r\n            // handleOversizedImages(widget);\r\n\r\n            // setup media sizer\r\n            setupMediaSizer(widget);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Setup media sizer when item has a fixed size\r\n     *\r\n     * @param widget\r\n     * @returns {*}\r\n     */\r\n    function setupMediaSizer(widget) {\r\n\r\n        var $mediaSizer = widget.$form.find('.media-sizer-panel');\r\n\r\n        $mediaSizer.empty().mediasizer({\r\n            target: widget.$original.find('.svggroup svg image'),\r\n            showResponsiveToggle: false,\r\n            showSync: false,\r\n            responsive: false,\r\n            parentSelector: widget.$original.attr('id'),\r\n            applyToMedium: false,\r\n            maxWidth: parseInt(widget.element.object.attr('width'), 10)\r\n        });\r\n\r\n        $mediaSizer.on('sizechange.mediasizer', function (e, params) {\r\n            var width = parseInt(params.width, 10);\r\n            var height = parseInt(params.height, 10);\r\n\r\n            widget.element.object.attr('width', width);\r\n            widget.element.object.attr('height', height);\r\n\r\n            widget.$original.trigger('resize.qti-widget.' + widget.serial, [width, height]);\r\n        });\r\n        return $mediaSizer;\r\n    }\r\n\r\n\r\n    /**\r\n     * Object with callbacks that are common to all graphic interactions\r\n     *\r\n     * @param widget\r\n     * @param formElement\r\n     * @param callbacks, existing callbacks if any\r\n     */\r\n    function setChangeCallbacks(widget, formElement, callbacks) {\r\n\r\n        callbacks = callbacks || {};\r\n        callbacks.data = function (interaction, value) {\r\n            interaction.object.attr('data', url.encodeAsXmlAttr(value));\r\n            imageUtil.getSize(widget.options.assetManager.resolve(value), function (size) {\r\n                if (size) {\r\n                    interaction.object.attr('width', size.width);\r\n                    interaction.object.attr('height', size.height);\r\n                }\r\n                widget.rebuild({\r\n                    ready: function (widgetReady) {\r\n                        widgetReady.changeState('question');\r\n                    }\r\n                });\r\n            });\r\n        };\r\n        callbacks.width = function (interaction, value) {\r\n            interaction.object.attr('width', parseInt(value, 10));\r\n        };\r\n        callbacks.height = function (interaction, value) {\r\n            interaction.object.attr('height', parseInt(value, 10));\r\n        };\r\n        callbacks.type = function (interaction, value) {\r\n            if (!value || value === '') {\r\n                interaction.object.removeAttr('type');\r\n            }\r\n            else {\r\n                interaction.object.attr('type', value);\r\n            }\r\n        };\r\n\r\n        formElement.setChangeCallbacks(widget.$form, widget.element, callbacks, { validateOnInit: false });\r\n    }\r\n\r\n\r\n    return {\r\n        setupImage: setupImage,\r\n        setChangeCallbacks: setChangeCallbacks\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/imageSelector',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/graphicAssociate',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/associableHotspot',\r\n    'taoQtiItem/qtiCreator/helper/dummyElement',\r\n    'taoQtiItem/qtiCreator/helper/panel',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/resourceManager',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/bgImage',\r\n    'ui/mediasizer'\r\n], function($, _, __, GraphicHelper, stateFactory, Question, shapeEditor, imageSelector, formElement, interactionFormElement,  identifierHelper, formTpl, choiceFormTpl, dummyElement, panel, resourceManager, bgImage){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Question State initialization: set up side bar, editors and shae factory\r\n     */\r\n    var initQuestionState = function initQuestionState(){\r\n\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var paper       = interaction.paper;\r\n\r\n        if(!paper){\r\n            return;\r\n        }\r\n\r\n        var $choiceForm  = widget.choiceForm;\r\n        var $formInteractionPanel = $('#item-editor-interaction-property-bar');\r\n        var $formChoicePanel = $('#item-editor-choice-property-bar');\r\n\r\n        var $left, $top, $width, $height;\r\n\r\n        //instantiate the shape editor, attach it to the widget to retrieve it during the exit phase\r\n        widget._editor = shapeEditor(widget, {\r\n            shapeCreated : function(shape, type){\r\n                var newChoice = interaction.createChoice({\r\n                    shape  : type === 'path' ? 'poly' : type,\r\n                    coords : GraphicHelper.qtiCoords(shape)\r\n                });\r\n\r\n                //link the shape to the choice\r\n                shape.id = newChoice.serial;\r\n            },\r\n            shapeRemoved : function(id){\r\n                interaction.removeChoice(id);\r\n            },\r\n            enterHandling : function(shape){\r\n                enterChoiceForm(shape.id);\r\n            },\r\n            quitHandling : function(){\r\n                leaveChoiceForm();\r\n            },\r\n            shapeChange : function(shape){\r\n                var bbox;\r\n                var choice = interaction.getChoice(shape.id);\r\n                if(choice){\r\n                    choice.attr('coords', GraphicHelper.qtiCoords(shape));\r\n\r\n                    if($left && $left.length){\r\n                        bbox = shape.getBBox();\r\n                        $left.val(parseInt(bbox.x, 10));\r\n                        $top.val(parseInt(bbox.y, 10));\r\n                        $width.val(parseInt(bbox.width, 10));\r\n                        $height.val(parseInt(bbox.height, 10));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        //and create an instance\r\n        widget._editor.create();\r\n\r\n        /**\r\n         * Set up the choice form\r\n         * @private\r\n         * @param {String} serial - the choice serial\r\n         */\r\n        function enterChoiceForm(serial){\r\n            var choice = interaction.getChoice(serial);\r\n            var element, bbox;\r\n\r\n            if(choice){\r\n\r\n                //get shape bounding box\r\n                element = interaction.paper.getById(serial);\r\n                bbox = element.getBBox();\r\n\r\n                $choiceForm.empty().html(\r\n                    choiceFormTpl({\r\n                        identifier  : choice.id(),\r\n                        fixed       : choice.attr('fixed'),\r\n                        serial      : serial,\r\n                        matchMin    : choice.attr('matchMin'),\r\n                        matchMax    : choice.attr('matchMax'),\r\n                        choicesCount: _.size(interaction.getChoices()),\r\n                        x           : parseInt(bbox.x, 10),\r\n                        y           : parseInt(bbox.y, 10),\r\n                        width       : parseInt(bbox.width, 10),\r\n                        height      : parseInt(bbox.height, 10)\r\n                    })\r\n                );\r\n\r\n                formElement.initWidget($choiceForm);\r\n\r\n                //init data validation and binding\r\n                var callbacks = formElement.getMinMaxAttributeCallbacks($choiceForm, 'matchMin', 'matchMax');\r\n                callbacks.identifier = identifierHelper.updateChoiceIdentifier;\r\n                callbacks.fixed = formElement.getAttributeChangeCallback();\r\n\r\n                formElement.setChangeCallbacks($choiceForm, choice, callbacks);\r\n\r\n                $formChoicePanel.show();\r\n                panel.openSections($formChoicePanel.children('section'));\r\n                panel.closeSections($formInteractionPanel.children('section'));\r\n\r\n                //change the nodes bound to the position fields\r\n                $left   = $('input[name=x]', $choiceForm);\r\n                $top    = $('input[name=y]', $choiceForm);\r\n                $width  = $('input[name=width]', $choiceForm);\r\n                $height = $('input[name=height]', $choiceForm);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Leave the choice form\r\n         * @private\r\n         */\r\n        function leaveChoiceForm(){\r\n            if($formChoicePanel.css('display') !== 'none'){\r\n                panel.openSections($formInteractionPanel.children('section'));\r\n                $formChoicePanel.hide();\r\n                $choiceForm.empty();\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Exit the question state, leave the room cleaned up\r\n     */\r\n    var exitQuestionState = function exitQuestionState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var paper       = interaction.paper;\r\n        var valid       = !!interaction.object.attr('data') && !_.isEmpty(interaction.choices);\r\n\r\n        widget.isValid('graphicAssociateInteraction', valid);\r\n\r\n        if(!paper){\r\n            return;\r\n        }\r\n\r\n        $(window).off('resize.changestate');\r\n\r\n        if(widget._editor){\r\n            widget._editor.destroy();\r\n        }\r\n        $('.image-editor.solid, .block-listing.source', this.widget.$container).css('min-width', 0);\r\n    };\r\n\r\n    /**\r\n     * The question state for the graphicAssociate interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Question\r\n     */\r\n    var GraphicAssociateInteractionStateQuestion = stateFactory.extend(Question, initQuestionState, exitQuestionState);\r\n\r\n    /**\r\n     * Initialize the form linked to the interaction\r\n     */\r\n    GraphicAssociateInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n        var widget = this.widget;\r\n        var options = widget.options;\r\n        var interaction = widget.element;\r\n        var $form = widget.$form;\r\n\r\n        /**\r\n         * Get the maximum number of pairs regarding the number of choices: f(n) = n(n-1)/2\r\n         * @param {Number} choices - the number of choices\r\n         * @returns {Number} the number of possible pairs\r\n         */\r\n        var getMaxPairs = function getMaxPairs(choices){\r\n            var pairs = 0;\r\n            if(choices > 0){\r\n                return Math.round((choices * (choices - 1)) / 2);\r\n            }\r\n            return pairs;\r\n        };\r\n\r\n        $form.html(formTpl({\r\n            baseUrl         : options.baseUrl,\r\n            maxAssociations : parseInt(interaction.attr('maxAssociations'), 10),\r\n            minAssociations : parseInt(interaction.attr('minAssociations'), 10),\r\n            choicesCount    : getMaxPairs(_.size(interaction.getChoices())),\r\n            data            : interaction.object.attr('data'),\r\n            width           : interaction.object.attr('width'),\r\n            height          : interaction.object.attr('height'),\r\n            type            : interaction.object.attr('type')\r\n        }));\r\n\r\n        imageSelector($form, options);\r\n\r\n        formElement.initWidget($form);\r\n\r\n        bgImage.setupImage(widget);\r\n\r\n        bgImage.setChangeCallbacks(\r\n            widget,\r\n            formElement,\r\n            formElement.getMinMaxAttributeCallbacks($form, 'minAssociations', 'maxAssociations')\r\n        );\r\n\r\n        interactionFormElement.syncMaxChoices(widget, 'minAssociations', 'maxAssociations');\r\n    };\r\n\r\n    return GraphicAssociateInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Correct',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function(_, __, stateFactory, Correct, commonRenderer, instructionMgr, PciResponse){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state: use the common renderer to set the correct response.\r\n     */\r\n    function initCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var corrects  = _.values(response.getCorrect());\r\n\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please set the correct associations by linking the choices.'));\r\n        \r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n\r\n        commonRenderer.setResponse(\r\n            interaction, \r\n            PciResponse.serialize(_.invoke(corrects, String.prototype.split, ' '), interaction)\r\n        );\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n           if(data.response && data.response.list){\r\n                response.setCorrect(\r\n                    _.map(data.response.list.pair, function(pair){\r\n                        return pair.join(' ');\r\n                    })\r\n                ); \r\n           }\r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Exit the correct state\r\n     */\r\n    function exitCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        \r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //stop listening responses changes\r\n        widget.$container.off('responseChange.qti-widget');\r\n        \r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction); \r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = widget.createPaper();\r\n        widget.createChoices();\r\n    }\r\n\r\n    /**\r\n     * The correct answer state for the graphicAssociate interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Correct\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Correct\r\n     */\r\n    return stateFactory.create(Correct, initCorrectState, exitCorrectState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Map',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/pairScoringForm'\r\n], function($, _, __, stateFactory, Map, commonRenderer, instructionMgr, graphicHelper, PciResponse, scoringFormFactory){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state.\r\n     */\r\n    function initMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var corrects  = _.values(response.getCorrect());\r\n        var currentResponses =  _.size(response.getMapEntries()) === 0 ? corrects : _.keys(response.getMapEntries());\r\n\r\n        //really need to destroy before ? \r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction);\r\n        \r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Create assocations and fill the score in the form below'));\r\n        interaction.responseMappingMode = true;\r\n\r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);    \r\n\r\n\t\t//display the choices ids\r\n        showChoicesId(interaction);\r\n\r\n        //and initialize the scoring form\r\n        if(_.size(response.getMapEntries()) === 0){\r\n            updateForm(widget, corrects);\r\n        } else {\r\n            updateForm(widget);\r\n        }\r\n        \r\n        //each response change leads to an update of the scoring form\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            var type  = response.attr('cardinality') === 'single' ? 'base' : 'list';\r\n            var pairs, entries;\r\n            if(data && data.response &&  data.response[type]){\r\n               pairs = _.invoke(data.response[type].pair, Array.prototype.join, ' ');\r\n               entries = _.keys(response.getMapEntries());\r\n                \r\n               //add new pairs from  the difference between the current entries and the given data\r\n               _(pairs).difference(entries).forEach(interaction.pairScoringForm.addPair, interaction.pairScoringForm);\r\n\r\n                \r\n               removePaths(interaction);\r\n            }\r\n        });\r\n    }\r\n\r\n    function removePaths(interaction){\r\n        _.delay(function(){\r\n           _.forEach(interaction._vsets, function(vset){\r\n                _.invoke(vset, 'remove');\r\n            });\r\n            interaction._vsets = [];\r\n        }, 500);\r\n    }\r\n\r\n    /**\r\n     * Exit the map state\r\n     */\r\n    function exitMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        \r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n        \r\n        widget.$container.off('responseChange.qti-widget');\r\n\r\n        if(interaction.pairScoringForm){\r\n            interaction.pairScoringForm.destroy();\r\n        }\r\n\r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction);\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = widget.createPaper();\r\n        widget.createChoices();\r\n    }\r\n\r\n    function showChoicesId(interaction){\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element){\r\n                graphicHelper.createShapeText(interaction.paper, element, {\r\n                    shapeClick: true,\r\n                    content : choice.id()\r\n                }).transform('t0,-10').toFront();\r\n            }\r\n        });\r\n    }\r\n\r\n\t/**\r\n     * Update the scoring form\r\n     * @param {Object} widget - the current widget\r\n     * @param {Array} [entries] - to force the use of this collection instead of the mapEntries\r\n     */\r\n    function updateForm(widget, entries){\r\n\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var mapEntries = response.getMapEntries();\r\n\r\n        var mappingChange = function mappingChange(){\r\n            //set the current responses, either the mapEntries or the corrects if nothing else\r\n            commonRenderer.setResponse(\r\n                interaction, \r\n                PciResponse.serialize(_.invoke(_.keys(response.getMapEntries()), String.prototype.split, ' '), interaction)\r\n            );\r\n        };\r\n\r\n        var getPairValues = function getPairValues(){\r\n            return _.map(interaction.getChoices(), function(choice){\r\n                return {\r\n                    id : choice.id(),\r\n                    value : choice.id()\r\n                };\r\n            });\r\n        };\r\n\r\n        //set up the scoring form options\r\n        var options = {\r\n            leftTitle : __('left'),\r\n            rightTitle : __('right'),\r\n            type : 'pair',\r\n            pairLeft : getPairValues,\r\n            pairRight : getPairValues\r\n        };\r\n\r\n        //format the entries to match the needs of the scoring form\r\n        if(entries){\r\n            options.entries = _.transform(entries, function(result, value){\r\n                result[value] = mapEntries[value] !== undefined ? mapEntries[value] : response.mappingAttributes.defaultValue;\r\n            }, {}); \r\n        }\r\n\r\n        //initialize the scoring form \r\n        interaction.pairScoringForm = scoringFormFactory(widget, options);\r\n    }\r\n\r\n    /**\r\n     * The map answer state for the graphicAssociate interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Map\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Map\r\n     */\r\n    return  stateFactory.create(Map, initMapState, exitMapState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/Map'\r\n], function(factory, states){\r\n\r\n    'use strict';\r\n\r\n    //creates a state bundle for the interaction\r\n    return factory.createBundle(states, arguments);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/Widget',[\r\n    'jquery', 'lodash', 'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/states/states'\r\n], function($, _, __, Widget, GraphicWidget, states){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * The Widget that provides components used by the QTI Creator for the GraphicAssociate Interaction.\r\n     * \r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/Widget\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/GraphicInteraction/Widget\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/Widget\r\n     */      \r\n    var GraphicAssociateInteractionWidget = _.extend(Widget.clone(), GraphicWidget, {\r\n\r\n        /**\r\n         * Set up the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/interactions/Widget#initCreator}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        initCreator : function(options){\r\n            var paper;\r\n            this.baseUrl = options.baseUrl;\r\n            this.choiceForm = options.choiceForm;\r\n            \r\n            this.registerStates(states);\r\n            \r\n            //call parent initCreator\r\n            Widget.initCreator.call(this);\r\n           \r\n            paper = this.createPaper(); \r\n            if(paper){\r\n                this.element.paper = paper;\r\n                this.createChoices();    \r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gracefull destroy the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/Widget#destroy}\r\n         */\r\n        destroy : function(){\r\n\r\n            var $container = this.$original;\r\n            var $item      = $container.parents('.qti-item');\r\n\r\n            //stop listening the resize\r\n            $item.off('resize.gridEdit.' + this.element.serial);\r\n            $(window).off('resize.qti-widget.' + this.element.serial);\r\n            $container.off('resize.qti-widget.' + this.element.serial);\r\n\r\n            //call parent destroy\r\n            Widget.destroy.call(this);\r\n        }\r\n   });\r\n\r\n    return GraphicAssociateInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/GraphicAssociateInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicAssociateInteraction/Widget'\r\n], function(_, GraphicAssociateInteraction, GraphicAssociateInteractionWidget){\r\n    'use strict';\r\n\r\n    /**\r\n     * The CreatorGraphicAssociateInteraction  Renderer\r\n     * @extends taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicAssociateInteraction\r\n     * @exports taoQtiItem/qtiCreator/renderers/interactions/GraphicAssociateInteraction\r\n     */\r\n    var CreatorGraphicAssociateInteraction = _.clone(GraphicAssociateInteraction);\r\n\r\n    /**\r\n     * Render the interaction for authoring.\r\n     * It delegates the rendering to the widget layer.\r\n     * @param {Object} interaction - the model\r\n     * @param {Object} [options] - extra options\r\n     */\r\n    CreatorGraphicAssociateInteraction.render = function(interaction, options){\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.choiceForm = this.getOption('choiceOptionForm');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        GraphicAssociateInteractionWidget.build(\r\n            interaction,\r\n            GraphicAssociateInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorGraphicAssociateInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/graphicGapMatchInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-graphicInteraction qti-graphicGapMatchInteraction clearfix\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"image-editor solid\\\">\\r\\n        <div id='graphic-paper-\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' class=\\\"main-image-box\\\"></div>\\r\\n        <div class=\\\"clearfix\\\"></div>\\r\\n        <ul class=\\\"none block-listing horizontal source\\\">\\r\\n            \";\n  options={hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}\n  if (helper = helpers.gapImgs) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.gapImgs); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.gapImgs) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </ul>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'module',\r\n    'core/promise',\r\n    'core/mouseEvent',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/graphicGapMatchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'interact',\r\n    'ui/interactUtils'\r\n], function($, _, __, module, Promise, triggerMouseEvent, tpl, graphic,  pciResponse, containerHelper, instructionMgr, interact, interactUtils){\r\n    'use strict';\r\n\r\n    var isDragAndDropEnabled;\r\n\r\n    // this represents the state for the active droppable zone\r\n    // we need it only to access the active dropzone in the iFrameFix\r\n    // should be removed when the old test runner is discarded\r\n    var activeDrop = null;\r\n\r\n    /**\r\n     * Global variable to count number of choice usages:\r\n     * @type {object}\r\n     */\r\n    var _choiceUsages = {};\r\n\r\n    /**\r\n     * This options enables to support old items created with the wrong\r\n     * direction in the directedpairs.\r\n     *\r\n     * @deprecated\r\n     */\r\n    var isDirectedPairFlipped = module.config().flipDirectedPair;\r\n\r\n    /**\r\n     * Check if a shape can accept matches\r\n     * @private\r\n     * @param {Raphael.Element} element - the shape\r\n     * @returns {Boolean} true if the element is matchable\r\n     */\r\n    var _isMatchable = function(element){\r\n        var matchable = false;\r\n        var matching, matchMax;\r\n        if(element){\r\n            matchMax = element.data('max') || 0;\r\n            matching = element.data('matching') || [];\r\n            matchable = (matchMax === 0 || matchMax > matching.length);\r\n        }\r\n        return matchable;\r\n    };\r\n\r\n    /**\r\n     * Makes the shapes selectable (at least those who can still accept matches)\r\n     * @private\r\n     * @param {Object} interaction\r\n     */\r\n    var _shapesSelectable = function _shapesSelectable(interaction){\r\n\r\n        var tooltip = __('Select the area to add an image');\r\n\r\n        //update the shape state\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(_isMatchable(element)){\r\n                element.selectable = true;\r\n                graphic.setStyle(element, 'selectable');\r\n                graphic.updateTitle(element, tooltip);\r\n            }\r\n        });\r\n\r\n        //update the gap images tooltip\r\n        _.forEach(interaction.gapFillers, function(gapFiller){\r\n            gapFiller.forEach(function(element){\r\n                graphic.updateTitle(element, tooltip);\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Makes all the shapes UNselectable\r\n     * @private\r\n     * @param {Object} interaction\r\n     */\r\n    var _shapesUnSelectable = function _shapesUnSelectable(interaction){\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element){\r\n                element.selectable = false;\r\n                graphic.setStyle(element, 'basic');\r\n                graphic.updateTitle(element, __('Select an image first'));\r\n            }\r\n        });\r\n\r\n        //update the gap images tooltip\r\n        _.forEach(interaction.gapFillers, function(gapFiller){\r\n            gapFiller.forEach(function(element){\r\n                graphic.updateTitle(element, __('Remove'));\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * By clicking the paper image the shapes are restored to their default state\r\n     * @private\r\n     * @param {Object} interaction\r\n     */\r\n    var _paperUnSelect = function _paperUnSelect(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var $gapImages = $('ul > li', $container);\r\n        var bgImage = interaction.paper.getById('bg-image-' + interaction.serial);\r\n        if(bgImage){\r\n            interact(bgImage.node).on('tap', function() {\r\n                _shapesUnSelectable(interaction);\r\n                $gapImages.removeClass('active');\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Sets a choice and marks as disabled if at max\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {JQuery Element} $choice\r\n     */\r\n    var _setChoice = function _setChoice(interaction, $choice) {\r\n        var choiceSerial = $choice.data('serial');\r\n        var choice = interaction.getGapImg(choiceSerial);\r\n        var matchMax;\r\n        var usages;\r\n\r\n        if (!_choiceUsages[choiceSerial]) {\r\n            _choiceUsages[choiceSerial] = 0;\r\n        }\r\n\r\n        _choiceUsages[choiceSerial]++;\r\n\r\n        // disable choice if maxium usage reached\r\n        if (!interaction.responseMappingMode && choice.attr('matchMax')) {\r\n            matchMax = +choice.attr('matchMax');\r\n            usages = +_choiceUsages[choiceSerial];\r\n\r\n            // note: if matchMax is 0, then test taker is allowed unlimited usage of that choice\r\n            if (matchMax !== 0 && matchMax <= usages) {\r\n                interact($choice.get(0)).draggable(false);\r\n                $choice.addClass('disabled');\r\n                $choice.removeClass('selectable');\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Unset a choice and unmark as disabled\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {JQuery Element} $choice\r\n     */\r\n    var _unsetChoice = function _unsetChoice(interaction, $choice) {\r\n        var choiceSerial = $choice.data('serial');\r\n\r\n        _choiceUsages[choiceSerial]--;\r\n\r\n        $choice.removeClass('disabled');\r\n        $choice.addClass('selectable');\r\n        interact($choice.get(0)).draggable(true);\r\n    };\r\n\r\n    /**\r\n     * Select a shape (= hotspot) (a gap image must be active)\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {Raphael.Element} element - the selected shape\r\n     * @param {Boolean} [trackResponse = true] - if the selection trigger a response chane\r\n     */\r\n    var _selectShape = function _selectShape(interaction, element, trackResponse){\r\n        var $img,\r\n            $clone,\r\n            gapFiller,\r\n            id,\r\n            bbox,\r\n            shapeOffset,\r\n            activeOffset,\r\n            matching,\r\n            currentCount;\r\n\r\n        //lookup for the active element\r\n        var $container = containerHelper.get(interaction);\r\n        var $gapList = $('ul', $container);\r\n        var $active = $gapList.find('.active:first');\r\n        var $imageBox = $('.main-image-box', $container);\r\n        var boxOffset   = $imageBox.offset();\r\n\r\n        if(typeof trackResponse === 'undefined'){\r\n            trackResponse = true;\r\n        }\r\n\r\n        if($active.length){\r\n\r\n            //the macthing elements are linked to the shape\r\n            id = $active.data('identifier');\r\n            matching = element.data('matching') || [];\r\n            matching.push(id);\r\n            element.data('matching', matching);\r\n            currentCount = matching.length;\r\n\r\n            //the image to clone\r\n            $img = $active.find('img');\r\n\r\n            //then reset the state of the shapes and the gap images\r\n            _shapesUnSelectable(interaction);\r\n            $gapList.children().removeClass('active');\r\n\r\n            _setChoice(interaction, $active);\r\n\r\n            $clone = $img.clone();\r\n            shapeOffset  = $(element.node).offset();\r\n            activeOffset   = $active.offset();\r\n\r\n            $clone.css({\r\n                'position' : 'absolute',\r\n                'display'  : 'block',\r\n                'z-index'  : 10000,\r\n                'opacity'  : 0.8,\r\n                'top'      : activeOffset.top - boxOffset.top,\r\n                'left'     : activeOffset.left - boxOffset.left\r\n            });\r\n\r\n            $clone.appendTo($imageBox);\r\n            $clone.animate({\r\n                'top'       : shapeOffset.top - boxOffset.top,\r\n                'left'      : shapeOffset.left - boxOffset.left\r\n            }, 200, function animationEnd(){\r\n                var gapFillerImage;\r\n\r\n                $clone.remove();\r\n\r\n                //extract some coords for positioning\r\n                bbox = element.getBBox();\r\n\r\n                //create an image into the paper and move it to the selected shape\r\n                gapFiller = graphic.createBorderedImage(interaction.paper, {\r\n                    url     :  $img.attr('src'),\r\n                    left    : bbox.x + (8 * (currentCount - 1)),\r\n                    top     : bbox.y + (8 * (currentCount - 1)),\r\n                    width   : parseInt($img.attr('width'), 10),\r\n                    height  : parseInt($img.attr('height'), 10),\r\n                    padding : 0,\r\n                    border  : false,\r\n                    shadow  : true\r\n                })\r\n                .data('identifier', id)\r\n                .toFront();\r\n\r\n                gapFillerImage = gapFiller[2].node;\r\n                interact(gapFillerImage).on('tap', function (e) {\r\n                    var target = e.currentTarget;\r\n                    var rElement = interaction.paper.getById(target.raphaelid);\r\n\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n\r\n                    // adding a new gapfiller on the hotspot by simulating a click on the underlying shape...\r\n                    if($gapList.find('.active').length > 0){\r\n                        interactUtils.tapOn(element.node);\r\n\r\n                    // ... or removing the existing gapfiller\r\n                    } else {\r\n                        //update the element matching array\r\n                        element.data('matching', _.without(element.data('matching') || [], rElement.data('identifier')));\r\n\r\n                        //delete interaction.gapFillers[interaction.gapFillers.indexOf(gapFiller)];\r\n                        interaction.gapFillers = _.without(interaction.gapFillers, gapFiller);\r\n\r\n                        gapFiller.remove();\r\n\r\n                        _unsetChoice(interaction, $active);\r\n\r\n                        containerHelper.triggerResponseChangeEvent(interaction);\r\n                    }\r\n                });\r\n\r\n                interaction.gapFillers.push(gapFiller);\r\n\r\n                containerHelper.triggerResponseChangeEvent(interaction);\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Render a choice (= hotspot) inside the paper.\r\n     * Please note that the choice renderer isn't implemented separately because it relies on the Raphael paper instead of the DOM.\r\n     *\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {Object} choice - the hotspot choice to add to the interaction\r\n     */\r\n    var _renderChoice  =  function _renderChoice(interaction, choice){\r\n\r\n        //create the shape\r\n        var rElement = graphic.createElement(interaction.paper, choice.attr('shape'), choice.attr('coords'), {\r\n            id : choice.serial,\r\n            title : __('Select an image first'),\r\n            hover : false\r\n        })\r\n        .data('max', choice.attr('matchMax') )\r\n        .data('matching', []);\r\n\r\n        interact(rElement.node).on('tap', function onClickShape(){\r\n            handleShapeSelect();\r\n        });\r\n\r\n        if (isDragAndDropEnabled) {\r\n            interact(rElement.node).dropzone({\r\n                overlap: 0.15,\r\n                ondragenter: function() {\r\n                    if (_isMatchable(rElement)) {\r\n                        graphic.setStyle(rElement, 'hover');\r\n                        activeDrop = rElement.node;\r\n                    }\r\n                },\r\n                ondrop: function () {\r\n                    if (_isMatchable(rElement)) {\r\n                        graphic.setStyle(rElement, 'selectable');\r\n                        handleShapeSelect();\r\n                        activeDrop = null;\r\n                    }\r\n                },\r\n                ondragleave: function() {\r\n                    if (_isMatchable(rElement)) {\r\n                        graphic.setStyle(rElement, 'selectable');\r\n                        activeDrop = null;\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        function handleShapeSelect() {\r\n            // check if can make the shape selectable on click\r\n            if(_isMatchable(rElement) && rElement.selectable === true){\r\n                _selectShape(interaction, rElement);\r\n            }\r\n        }\r\n    };\r\n\r\n    var _iFrameDragFix = function _iFrameDragFix(draggableSelector, target) {\r\n        interactUtils.iFrameDragFixOn(function () {\r\n            if (activeDrop) {\r\n                interact(activeDrop).fire({\r\n                    type: 'drop',\r\n                    target: activeDrop,\r\n                    relatedTarget: target\r\n                });\r\n            }\r\n            interact(draggableSelector).fire({\r\n                type: 'dragend',\r\n                target: target\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Render the list of gap fillers\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {jQueryElement} $gapList - the list than contains the orderers\r\n     */\r\n    var _renderGapList = function _renderGapList(interaction, $gapList){\r\n\r\n        var gapFillersSelector = $gapList.selector + ' li';\r\n        var dragOptions;\r\n\r\n        interact(gapFillersSelector).on('tap', function onClickGapImg(e) {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            toggleActiveGapState($(e.currentTarget));\r\n        });\r\n\r\n        if (isDragAndDropEnabled) {\r\n            dragOptions = {\r\n                inertia: false,\r\n                autoScroll: true,\r\n                restrict: {\r\n                    restriction: \".qti-interaction\",\r\n                    endOnly: false,\r\n                    elementRect: {top: 0, left: 0, bottom: 1, right: 1}\r\n                }\r\n            };\r\n\r\n            $(gapFillersSelector).each(function(index, gap) {\r\n                interact(gap)\r\n                .draggable(_.assign({}, dragOptions, {\r\n                    onstart: function (e) {\r\n                        var $target = $(e.target);\r\n                        _setActiveGapState($target);\r\n                        $target.addClass('dragged');\r\n\r\n                        _iFrameDragFix(gapFillersSelector, e.target);\r\n                    },\r\n                    onmove: function (e) {\r\n                        interactUtils.moveElement(e.target, e.dx, e.dy);\r\n                    },\r\n                    onend: function (e) {\r\n                        var $target = $(e.target);\r\n                        _setInactiveGapState($target);\r\n                        $target.removeClass('dragged');\r\n                        interactUtils.restoreOriginalPosition($target);\r\n                        interactUtils.iFrameDragFixOff();\r\n                    }\r\n                }))\r\n                .styleCursor(false);\r\n            });\r\n        }\r\n\r\n        function toggleActiveGapState($target) {\r\n            if(!$target.hasClass('disabled')){\r\n                if($target.hasClass('active')){\r\n                    _setInactiveGapState($target);\r\n                } else {\r\n                    _setActiveGapState($target);\r\n                }\r\n            }\r\n        }\r\n\r\n        function _setActiveGapState($target) {\r\n            $gapList.children('li').removeClass('active');\r\n            $target.addClass('active');\r\n            _shapesSelectable(interaction);\r\n        }\r\n\r\n        function _setInactiveGapState($target) {\r\n            $target.removeClass('active');\r\n            _shapesUnSelectable(interaction);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @return {Promise}\r\n     */\r\n    var render = function render(interaction){\r\n        var self = this;\r\n\r\n        return new Promise(function(resolve){\r\n\r\n            var $container = containerHelper.get(interaction);\r\n            var $gapList = $('ul.source', $container);\r\n            var background = interaction.object.attributes;\r\n\r\n            interaction.gapFillers = [];\r\n\r\n            if (self.getOption && self.getOption(\"enableDragAndDrop\") && self.getOption(\"enableDragAndDrop\").graphicGapMatch) {\r\n                isDragAndDropEnabled = self.getOption(\"enableDragAndDrop\").graphicGapMatch;\r\n            }\r\n\r\n            $container\r\n                .off('resized.qti-widget.resolve')\r\n                .one('resized.qti-widget.resolve', resolve);\r\n\r\n            //create the paper\r\n            interaction.paper = graphic.responsivePaper( 'graphic-paper-' + interaction.serial, interaction.serial, {\r\n                width       : background.width,\r\n                height      : background.height,\r\n                img         : self.resolveUrl(background.data),\r\n                imgId       : 'bg-image-' + interaction.serial,\r\n                container   : $container,\r\n                resize      : function(newSize, factor){\r\n                    $gapList.css('max-width', newSize + 'px');\r\n                    if(factor !== 1){\r\n                        $gapList.find('img').each(function(){\r\n                            var $img = $(this);\r\n                            $img.width( $img.attr('width') * factor );\r\n                            $img.height( $img.attr('height') * factor );\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n\r\n            //call render choice for each interaction's choices\r\n            _.forEach(interaction.getChoices(), _.partial(_renderChoice, interaction));\r\n\r\n            //create the list of gap images\r\n            _renderGapList(interaction, $gapList);\r\n\r\n            //clicking the paper to reset selection\r\n            _paperUnSelect(interaction);\r\n\r\n        });\r\n    };\r\n\r\n\r\n    /**\r\n     * Get the responses from the interaction\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @returns {Array} of matches\r\n     */\r\n    var _getRawResponse = function _getRawResponse(interaction){\r\n        var pairs = [];\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element && _.isArray(element.data('matching'))){\r\n                _.forEach(element.data('matching'), function(match){\r\n\r\n                    //backward support of previous order\r\n                    if(isDirectedPairFlipped){\r\n                        pairs.push([choice.id(), match]);\r\n                    } else {\r\n                        pairs.push([match, choice.id()]);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        return pairs;\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n        var $container = containerHelper.get(interaction);\r\n        var responseValues;\r\n        if(response && interaction.paper){\r\n            try{\r\n                responseValues = pciResponse.unserialize(response, interaction);\r\n            } catch(e){\r\n                responseValues = null;\r\n            }\r\n\r\n            if(_.isArray(responseValues)){\r\n                _.forEach(interaction.getChoices(), function(choice){\r\n                    var element = interaction.paper.getById(choice.serial);\r\n                    if(element){\r\n                        _.forEach(responseValues, function(pair){\r\n                            var responseChoice;\r\n                            var responseGap;\r\n                            if(pair.length === 2){\r\n\r\n                                //backward support of previous order\r\n                                responseChoice = isDirectedPairFlipped ? pair[0] : pair[1];\r\n                                responseGap    = isDirectedPairFlipped ? pair[1] : pair[0];\r\n                                if(responseChoice === choice.id()){\r\n                                    $(\"[data-identifier=\" + responseGap + \"]\", $container).addClass('active');\r\n                                    _selectShape(interaction, element, false);\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset the current responses of the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var resetResponse = function resetResponse(interaction){\r\n        _shapesUnSelectable(interaction);\r\n\r\n        _.forEach(interaction.gapFillers, function(gapFiller){\r\n            interactUtils.tapOn(gapFiller.items[2][0]); // this refers to the gapFiller image\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        var raw = _getRawResponse(interaction);\r\n        return pciResponse.serialize(raw, interaction);\r\n    };\r\n\r\n    /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n        var $container;\r\n        if(interaction.paper){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            $(window).off('resize.qti-widget.' + interaction.serial);\r\n            $container.off('resize.qti-widget.' + interaction.serial);\r\n\r\n            interaction.paper.clear();\r\n            instructionMgr.removeInstructions(interaction);\r\n\r\n            $('.main-image-box', $container).empty().removeAttr('style');\r\n            $('.image-editor', $container).removeAttr('style');\r\n            $('ul', $container).empty();\r\n\r\n            interact($container.find('ul.source li').selector).unset(); // gapfillers\r\n            interact($container.find('.main-image-box rect').selector).unset(); // choices/hotspot\r\n        }\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the hotspot interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/HotspotInteraction\r\n     */\r\n    return {\r\n        qtiClass:              'graphicGapMatchInteraction',\r\n        template:              tpl,\r\n        render:                render,\r\n        getContainer:          containerHelper.get,\r\n        setResponse:           setResponse,\r\n        getResponse:           getResponse,\r\n        resetResponse:         resetResponse,\r\n        destroy:               destroy,\r\n        setState:              setState,\r\n        getState:              getState,\r\n        isDirectedPairFlipped: isDirectedPairFlipped\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Sleep',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep'\r\n], function(stateFactory, SleepState){\r\n\r\n    'use strict';\r\n\r\n    var initSleepState = function initSleepState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        widget.on('metaChange', function(data){\r\n            if(data.key === 'responsive'){\r\n                if(data.value === true){\r\n                    interaction.addClass('responsive');\r\n                } else {\r\n                    interaction.removeClass('responsive');\r\n                }\r\n                widget.rebuild();\r\n            }\r\n        });\r\n    };\r\n\r\n    var exitSleepState = function exitSleepState(){\r\n        var widget      = this.widget;\r\n        $('.image-editor.solid, .block-listing.source', widget.$container).css('min-width', 0);\r\n    };\r\n \r\n    return stateFactory.extend(SleepState, initSleepState, exitSleepState); \r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/graphicGapMatch', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Interaction Background\", options) : helperMissing.call(depth0, \"__\", \"Interaction Background\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"data\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the image.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the image.\", options)))\n    + \"</div>\\r\\n        <input type=\\\"text\\\" name=\\\"data\\\" value=\\\"\";\n  if (helper = helpers.data) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.data); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n        <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select image\", options) : helperMissing.call(depth0, \"__\", \"Select image\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"panel media-sizer-panel\\\">\\r\\n        <!-- media sizer goes here -->\\r\\n    </div>\\r\\n<input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n<input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n\\r\\n    <input type=\\\"hidden\\\" name=\\\"type\\\" value=\\\"\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/choices/gapImg', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"identifier\", options) : helperMissing.call(depth0, \"__\", \"identifier\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n        <input type=\\\"text\\\" \\r\\n               name=\\\"identifier\\\" \\r\\n               value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n               placeholder=\\\"e.g. my-hotspot_1\\\" \\r\\n               data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n    </div>\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Choice Image\", options) : helperMissing.call(depth0, \"__\", \"Choice Image\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"data\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the image.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the image.\", options)))\n    + \"</div>\\r\\n        <input type=\\\"text\\\" name=\\\"data\\\" value=\\\"\";\n  if (helper = helpers.data) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.data); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n        <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select image\", options) : helperMissing.call(depth0, \"__\", \"Select image\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"panel media-sizer-panel\\\">\\r\\n        <!-- media sizer goes here -->\\r\\n    </div>\\r\\n\\r\\n    <input name=\\\"type\\\" type=\\\"hidden\\\" value=\\\"\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n\\r\\n    <hr/>\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max. number of matches\", options) : helperMissing.call(depth0, \"__\", \"Max. number of matches\", options)))\n    + \" </h3>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices this choice may be associated with.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices this choice may be associated with.\", options)))\n    + \"<br>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices this choice must be associated with to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices this choice must be associated with to form a valid response.\", options)))\n    + \"\\r\\n    </span>\\r\\n\\r\\n    <div>\\r\\n        <label for=\\\"matchMin\\\" class=\\\"spinner\\\">Min</label>\\r\\n        <input name=\\\"matchMin\\\" value=\\\"\";\n  if (helper = helpers.matchMin) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.matchMin); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n    <div>\\r\\n        <label for=\\\"matchMax\\\" class=\\\"spinner\\\">Max</label>\\r\\n        <input name=\\\"matchMax\\\" value=\\\"\";\n  if (helper = helpers.matchMax) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.matchMax); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/imageSelector',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier',\r\n\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/graphicGapMatch',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/associableHotspot',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/gapImg',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/media',\r\n\r\n    'taoQtiItem/qtiCreator/helper/dummyElement',\r\n    'taoQtiItem/qtiCreator/helper/panel',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/resourceManager',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/bgImage',\r\n    'ui/mediasizer'\r\n], function ($, _, __, GraphicHelper, stateFactory, Question, shapeEditor, imageSelector, formElement, identifierHelper, formTpl, choiceFormTpl, gapImgFormTpl, mediaTlbTpl, dummyElement, panel, resourceManager, bgImage) {\r\n\r\n    \"use strict\";\r\n\r\n    var GraphicGapMatchInteractionStateQuestion;\r\n\r\n    /**\r\n     * Apply size changes manually to mediasizer's target.\r\n     *\r\n     * @param {Object} params\r\n     * @param {number} factor\r\n     */\r\n    function applyMediasizerValues(params, factor) {\r\n        factor = factor || 1;\r\n\r\n        // The mediasizer target maintains a height and width (i.e. attributes)\r\n        // but is displayed according to a factor (i.e. styles). This matches\r\n        // the behavior of hotspots.\r\n        // This is because resize events utilize factor to adjust images, thus,\r\n        // the target's dimensions need to be maintained.\r\n        params.$target\r\n            .css({\r\n                width: params.width * factor,\r\n                height: params.height * factor\r\n            })\r\n            .attr('width', params.width)\r\n            .attr('height', params.height);\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Question State initialization: set up side bar, editors and shae factory\r\n     */\r\n    function initQuestionState() {\r\n        var $choiceForm, $formChoicePanel, $formInteractionPanel;\r\n        var $left, $top, $width, $height;\r\n\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var options = widget.options;\r\n        var paper = interaction.paper;\r\n\r\n        var gapImgSelectorOptions = _.clone(options);\r\n        gapImgSelectorOptions.title = gapImgSelectorOptions.title\r\n            ? gapImgSelectorOptions.title\r\n            : __('Please select a choice picture for your interaction from the resource manager. \\\r\n                  You can add new files from your computer with the button \"Add file(s)\".');\r\n\r\n        if (!paper) {\r\n            return;\r\n        }\r\n\r\n        $choiceForm = widget.choiceForm;\r\n        $formInteractionPanel = $('#item-editor-interaction-property-bar');\r\n        $formChoicePanel = $('#item-editor-choice-property-bar');\r\n\r\n        //instantiate the shape editor, attach it to the widget to retrieve it during the exit phase\r\n        widget._editor = shapeEditor(widget, {\r\n            shapeCreated: function (shape, type) {\r\n                var newChoice = interaction.createChoice({\r\n                    shape: type === 'path' ? 'poly' : type,\r\n                    coords: GraphicHelper.qtiCoords(shape)\r\n                });\r\n\r\n                //link the shape to the choice\r\n                shape.id = newChoice.serial;\r\n            },\r\n            shapeRemoved: function (id) {\r\n                interaction.removeChoice(id);\r\n            },\r\n            enterHandling: function (shape) {\r\n                enterChoiceForm(shape.id);\r\n            },\r\n            quitHandling: function () {\r\n                leaveChoiceForm();\r\n            },\r\n            shapeChange: function (shape) {\r\n                var bbox;\r\n                var choice = interaction.getChoice(shape.id);\r\n                if (choice) {\r\n                    choice.attr('coords', GraphicHelper.qtiCoords(shape));\r\n\r\n                    if ($left && $left.length) {\r\n                        bbox = shape.getBBox();\r\n                        $left.val(parseInt(bbox.x, 10));\r\n                        $top.val(parseInt(bbox.y, 10));\r\n                        $width.val(parseInt(bbox.width, 10));\r\n                        $height.val(parseInt(bbox.height, 10));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        //and create an instance\r\n        widget._editor.create();\r\n\r\n        _.forEach(interaction.getGapImgs(), setUpGapImg);\r\n\r\n        createGapImgAddOption();\r\n\r\n        // stop the question mode on resize to keep the coordinate system coherent,\r\n        // even in responsive (the side bar behaves weirdly)\r\n        $(window).on('resize.changestate', function () {\r\n            widget.changeState('sleep');\r\n        });\r\n\r\n\r\n\r\n        /**\r\n         * Create the 'add option' button\r\n         */\r\n        function createGapImgAddOption() {\r\n            var $gapList = $('ul.source', widget.$original);\r\n            var $addOption =\r\n                $('<li class=\"empty add-option\">' +\r\n                    '<div><span class=\"icon-add\"></span></div>' +\r\n                    '</li>');\r\n\r\n            $addOption.on('click', function () {\r\n                var gapImgObj = interaction.createGapImg({});\r\n                gapImgObj.object.removeAttr('type');\r\n\r\n                // on successful upload\r\n                $addOption.on('selected.upload', function (e, args) {\r\n\r\n                    $addOption.off('selected.upload');\r\n\r\n                    gapImgObj.object.attr('data', args.selected.file);\r\n                    gapImgObj.object.attr('type', args.selected.mime);\r\n                    gapImgObj.object.attr('width', args.size.width);\r\n                    gapImgObj.object.attr('height', args.size.height);\r\n                    setUpGapImg(gapImgObj);\r\n                });\r\n                resourceManager($addOption, gapImgSelectorOptions);\r\n\r\n            });\r\n            $addOption.appendTo($gapList);\r\n        }\r\n\r\n\r\n        /**\r\n         * Insert and setup the gap image\r\n         *\r\n         * @param gapImgObj\r\n         */\r\n        function setUpGapImg(gapImgObj) {\r\n\r\n            var $gapList = $('ul.source', widget.$original);\r\n            var $addOption = $('.empty', $gapList);\r\n            var $gapImgBox = $('[data-serial=\"' + gapImgObj.serial + '\"]', $gapList);\r\n            var $deleteBtn = $(mediaTlbTpl());\r\n\r\n            if (!$gapImgBox.length) {\r\n                $gapImgBox = $(gapImgObj.render()).insertBefore($addOption);\r\n            }\r\n\r\n            //manage gap deletion\r\n            $deleteBtn\r\n                .appendTo($gapImgBox)\r\n                .show()\r\n                .click(function (e) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    $gapImgBox.remove();\r\n                    interaction.removeGapImg(gapImgObj);\r\n                });\r\n\r\n            enterGapImgForm(gapImgObj.serial);\r\n\r\n            $gapImgBox.off('click').on('click', function () {\r\n                if ($gapImgBox.hasClass('active')) {\r\n                    $gapImgBox.removeClass('active');\r\n                    leaveChoiceForm();\r\n                }\r\n                else {\r\n                    $('.active', $gapList).removeClass('active');\r\n                    $gapImgBox.addClass('active');\r\n                    enterGapImgForm(gapImgObj.serial);\r\n                }\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Set up the choice form\r\n         *\r\n         * @private\r\n         * @param {String} serial - the choice serial\r\n         */\r\n        function enterChoiceForm(serial) {\r\n            var choice = interaction.getChoice(serial);\r\n            var element, bbox, callbacks;\r\n\r\n            if (choice) {\r\n\r\n                //get shape bounding box\r\n                element = interaction.paper.getById(serial);\r\n                bbox = element.getBBox();\r\n\r\n                $choiceForm.empty().html(\r\n                    choiceFormTpl({\r\n                        identifier: choice.id(),\r\n                        fixed: choice.attr('fixed'),\r\n                        serial: serial,\r\n                        matchMin: choice.attr('matchMin'),\r\n                        matchMax: choice.attr('matchMax'),\r\n                        choicesCount: _.size(interaction.getChoices()),\r\n                        x: parseInt(bbox.x, 10),\r\n                        y: parseInt(bbox.y, 10),\r\n                        width: parseInt(bbox.width, 10),\r\n                        height: parseInt(bbox.height, 10)\r\n                    })\r\n                );\r\n\r\n                formElement.initWidget($choiceForm);\r\n\r\n                //init data validation and binding\r\n                callbacks = formElement.getMinMaxAttributeCallbacks($choiceForm, 'matchMin', 'matchMax');\r\n                callbacks.identifier = identifierHelper.updateChoiceIdentifier;\r\n                callbacks.fixed = formElement.getAttributeChangeCallback();\r\n\r\n                formElement.setChangeCallbacks($choiceForm, choice, callbacks);\r\n\r\n                $formChoicePanel.show();\r\n                panel.openSections($formChoicePanel.children('section'));\r\n                panel.closeSections($formInteractionPanel.children('section'));\r\n\r\n                //change the nodes bound to the position fields\r\n                $left = $('input[name=x]', $choiceForm);\r\n                $top = $('input[name=y]', $choiceForm);\r\n                $width = $('input[name=width]', $choiceForm);\r\n                $height = $('input[name=height]', $choiceForm);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Leave the choice form\r\n         * @private\r\n         */\r\n        function leaveChoiceForm() {\r\n            if ($formChoicePanel.css('display') !== 'none') {\r\n                panel.openSections($formInteractionPanel.children('section'));\r\n                $formChoicePanel.hide();\r\n                $choiceForm.empty();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Set up the gapImg form\r\n         * @private\r\n         * @param {String} serial - the gapImg serial\r\n         */\r\n        function enterGapImgForm(serial) {\r\n\r\n            var callbacks,\r\n                gapImg = interaction.getGapImg(serial),\r\n                initMediasizer,\r\n                $gapImgBox,\r\n                $gapImgElem,\r\n                $mediaSizer;\r\n\r\n            if (gapImg) {\r\n\r\n                $choiceForm.empty().html(gapImgFormTpl({\r\n                    identifier: gapImg.id(),\r\n                    fixed: gapImg.attr('fixed'),\r\n                    serial: serial,\r\n                    matchMin: gapImg.attr('matchMin'),\r\n                    matchMax: gapImg.attr('matchMax'),\r\n                    choicesCount: _.size(interaction.getChoices()),\r\n                    baseUrl: options.baseUrl,\r\n                    data: gapImg.object.attr('data'),\r\n                    width: gapImg.object.attr('width'),\r\n                    height: gapImg.object.attr('height'),\r\n                    type: gapImg.object.attr('type')\r\n                }));\r\n\r\n                // <li/> that will contain the image\r\n                $gapImgBox = $('li[data-serial=\"' + gapImg.serial + '\"]');\r\n\r\n\r\n                $gapImgElem = $gapImgBox.find('img');\r\n\r\n                //init media sizer\r\n                $mediaSizer = $choiceForm.find('.media-sizer-panel')\r\n                    .on('create.mediasizer', function(e, params) {\r\n                        // On creation, mediasizer uses style properties to set\r\n                        // width and height, but our image needs to use the\r\n                        // it's attributes to set and resize properly.\r\n                        params.width = $gapImgElem.attr('width');\r\n                        params.height = $gapImgElem.attr('height');\r\n\r\n                        applyMediasizerValues(params, widget.$original.data('factor'));\r\n                    });\r\n\r\n                initMediasizer = function () {\r\n                    // Hack to manually set mediasizer to use gapImg's height\r\n                    // and width attributes (instead of it's style properties).\r\n                    $gapImgElem.width($gapImgElem.attr('width'));\r\n                    $gapImgElem.height($gapImgElem.attr('height'));\r\n\r\n                    $mediaSizer.empty().mediasizer({\r\n                        target: $gapImgElem,\r\n                        showResponsiveToggle: false,\r\n                        showSync: false,\r\n                        responsive: false,\r\n                        parentSelector: $gapImgBox,\r\n                        // needs to be done on.sizechange.mediasizer to take in account the scale factor\r\n                        applyToMedium: false,\r\n                        maxWidth: interaction.object.attr('width')\r\n                    });\r\n                };\r\n\r\n                // Wait for image to load before initializing mediasizer\r\n                if ($gapImgElem.get(0) && $gapImgElem.get(0).complete) {\r\n                    initMediasizer();\r\n                } else {\r\n                    $gapImgElem.one('load', initMediasizer);\r\n                }\r\n\r\n                imageSelector($choiceForm, gapImgSelectorOptions);\r\n\r\n                formElement.initWidget($choiceForm);\r\n\r\n                // bind callbacks to ms\r\n                // init data validation and binding\r\n                callbacks = formElement.getMinMaxAttributeCallbacks($choiceForm, 'matchMin', 'matchMax');\r\n                callbacks.identifier = identifierHelper.updateChoiceIdentifier;\r\n                callbacks.fixed = formElement.getAttributeChangeCallback();\r\n                callbacks.data = function (element, value) {\r\n                    gapImg.object.attr('data', value);\r\n                    setUpGapImg(gapImg);\r\n                };\r\n\r\n                // callbacks\r\n                $mediaSizer.on('sizechange.mediasizer', function(e, params) {\r\n                    applyMediasizerValues(params, widget.$original.data('factor'));\r\n\r\n                    gapImg.object.attr('width', params.width);\r\n                    gapImg.object.attr('height', params.height);\r\n                });\r\n\r\n                callbacks.type = function (element, value) {\r\n                    if (!value || value === '') {\r\n                        interaction.object.removeAttr('type');\r\n                    }\r\n                    else {\r\n                        gapImg.object.attr('type', value);\r\n                    }\r\n                };\r\n                formElement.setChangeCallbacks($choiceForm, gapImg, callbacks);\r\n\r\n                $formChoicePanel.show();\r\n                panel.openSections($formChoicePanel.children('section'));\r\n                panel.closeSections($formInteractionPanel.children('section'));\r\n\r\n                if (typeof window.scroll === 'function') {\r\n                    window.scroll(0, $choiceForm.offset().top);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Exit the question state, leave the room cleaned up\r\n     */\r\n    function exitQuestionState() {\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var paper = interaction.paper;\r\n        var valid = !!interaction.object.attr('data') && !_.isEmpty(interaction.choices);\r\n\r\n        widget.isValid('graphicGapMatchInteraction', valid);\r\n\r\n        if (!paper) {\r\n            return;\r\n        }\r\n\r\n\r\n        $(window).off('resize.changestate');\r\n\r\n        if (widget._editor) {\r\n            widget._editor.destroy();\r\n        }\r\n\r\n        //remove gapImg placeholder\r\n        $('ul.source .empty', widget.$original).remove();\r\n\r\n        //restore gapImg appearance\r\n        widget.$container.find('.qti-gapImg').removeClass('active')\r\n            .find('.mini-tlb').remove();\r\n        $('.image-editor.solid, .block-listing.source', widget.$container).css('min-width', 0);\r\n    }\r\n\r\n    /**\r\n     * The question state for the graphicGapMatch interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Question\r\n     */\r\n    GraphicGapMatchInteractionStateQuestion = stateFactory.extend(Question, initQuestionState, exitQuestionState);\r\n\r\n    /**\r\n     * Initialize the form linked to the interaction\r\n     */\r\n    GraphicGapMatchInteractionStateQuestion.prototype.initForm = function () {\r\n\r\n        var widget = this.widget;\r\n        var options = widget.options;\r\n        var interaction = widget.element;\r\n        var $form = widget.$form;\r\n\r\n        $form.html(formTpl({\r\n            baseUrl: options.baseUrl,\r\n            data: interaction.object.attr('data'),\r\n            width: interaction.object.attr('width'),\r\n            height: interaction.object.attr('height'),\r\n            type: interaction.object.attr('type')\r\n        }));\r\n\r\n        imageSelector($form, options);\r\n\r\n        formElement.initWidget($form);\r\n\r\n        bgImage.setupImage(widget);\r\n\r\n        bgImage.setChangeCallbacks(\r\n            widget,\r\n            formElement\r\n        );\r\n    };\r\n\r\n    return GraphicGapMatchInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Correct',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function(_, __, stateFactory, Correct, commonRenderer, instructionMgr, PciResponse){\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state: use the common renderer to set the correct response.\r\n     */\r\n    function initCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var corrects  = _.values(response.getCorrect());\r\n\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please fill the gap with the correct choices below.'));\r\n\r\n        widget.createGapImgs();\r\n\r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n\r\n\r\n        commonRenderer.setResponse(\r\n            interaction,\r\n            PciResponse.serialize(_.invoke(corrects, String.prototype.split, ' '), interaction)\r\n        );\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            if(data.response && data.response.list){\r\n                response.setCorrect(\r\n                    _.map(data.response.list.directedPair, function(pair){\r\n                        return pair.join(' ');\r\n                    })\r\n                );\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Exit the correct state\r\n     */\r\n    function exitCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //stop listening responses changes\r\n        widget.$container.off('responseChange.qti-widget');\r\n\r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = widget.createPaper(_.bind(widget.scaleGapList, widget));\r\n        widget.createChoices();\r\n        widget.createGapImgs();\r\n    }\r\n\r\n    /**\r\n     * The correct answer state for the graphicGapMatch interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Correct\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Correct\r\n     */\r\n    return stateFactory.create(Correct, initCorrectState, exitCorrectState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Map',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/pairScoringForm'\r\n], function($, _, __, stateFactory, Map, commonRenderer, instructionMgr, graphicHelper, PciResponse, scoringFormFactory){\r\n    'use strict';\r\n\r\n    var removeGapFillers = function removeGapFillers(interaction){\r\n        _.forEach(interaction.gapFillers, function(gapFiller){\r\n            gapFiller.remove();\r\n        });\r\n        interaction.gapFillers = [];\r\n    };\r\n\r\n    var showChoicesId = function showChoicesId(interaction){\r\n\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element){\r\n                graphicHelper.createShapeText(interaction.paper, element, {\r\n                    shapeClick: true,\r\n                    content : choice.id()\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n     /**\r\n     * Update the scoring form\r\n     * @param {Object} widget - the current widget\r\n     * @param {Array} [entries] - to force the use of this collection instead of the mapEntries\r\n     */\r\n    var updateForm = function updateForm(widget, entries){\r\n\r\n        var interaction = widget.element;\r\n        var response    = interaction.getResponseDeclaration();\r\n        var mapEntries  = response.getMapEntries();\r\n\r\n        var gapSrcs  = _.transform(interaction.getGapImgs(), function(acc, gapImg){\r\n            if(gapImg.object && gapImg.object.attr('data')){\r\n                acc[gapImg.id()] = widget.options.baseUrl + gapImg.object.attr('data');\r\n            }\r\n        }, {});\r\n\r\n        //set up the scoring form options\r\n        var options = {\r\n            leftTitle : __('Gap'),\r\n            rightTitle : __('Choice'),\r\n            type : 'directedPair',\r\n            pairLeft : function(){\r\n                return _.map(interaction.getGapImgs(), function(gap){\r\n                    return {\r\n                        id : gap.id(),\r\n                        value : gap.id()\r\n                    };\r\n                });\r\n            },\r\n            formatLeft : function(id){\r\n                var formated = '';\r\n                if(gapSrcs[id]){\r\n                    formated += \"<img height='1em' src='\" + gapSrcs[id] + \"' /> \";\r\n                }\r\n                formated += id;\r\n                return formated;\r\n            },\r\n            pairRight : function(){\r\n                return _.map(interaction.getChoices(), function(choice){\r\n                    return {\r\n                        id : choice.id(),\r\n                        value : choice.id()\r\n                    };\r\n                });\r\n            },\r\n            isDirectedPairFlipped : commonRenderer.isDirectedPairFlipped\r\n        };\r\n\r\n        //format the entries to match the needs of the scoring form\r\n        if(entries){\r\n            options.entries = _.transform(entries, function(result, value){\r\n                result[value] = typeof mapEntries[value] !== 'undefined' ? mapEntries[value] : response.mappingAttributes.defaultValue;\r\n            }, {});\r\n        }\r\n\r\n        //initialize the scoring form\r\n        interaction.pairScoringForm = scoringFormFactory(widget, options);\r\n    };\r\n\r\n    /**\r\n     * Initialize the state.\r\n     */\r\n    var initMapState = function initMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var corrects  = _.values(response.getCorrect());\r\n\r\n        //really need to destroy before ?\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please fill the gap with the images below, then edit the score for each gap/image pair.'));\r\n        interaction.responseMappingMode = true;\r\n\r\n        widget.createGapImgs();\r\n\r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n\r\n        //change the display of the gaps\r\n        showChoicesId(interaction);\r\n\r\n        //and initialize the scoring form\r\n        if(_.size(response.getMapEntries()) === 0){\r\n            updateForm(widget, corrects);\r\n        } else {\r\n            updateForm(widget);\r\n        }\r\n\r\n        //each response change leads to an update of the scoring form\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            var type  = response.attr('cardinality') === 'single' ? 'base' : 'list';\r\n            var pairs, entries;\r\n            if(data && data.response &&  data.response[type]){\r\n                pairs = _.map(data.response[type].directedPair, function(pair){\r\n                    if(commonRenderer.isDirectedPairFlipped){\r\n                        return pair.reverse().join(' ');\r\n                    } else {\r\n                        return pair.join(' ');\r\n                    }\r\n                });\r\n                entries = _.keys(response.getMapEntries());\r\n\r\n                //add new pairs from  the difference between the current entries and the given data\r\n                _(pairs).difference(entries).forEach(interaction.pairScoringForm.addPair, interaction.pairScoringForm);\r\n            }\r\n            removeGapFillers(interaction);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Exit the map state\r\n     */\r\n    var exitMapState = function exitMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        widget.$container.off('responseChange.qti-widget');\r\n\r\n        if(interaction.pairScoringForm){\r\n            interaction.pairScoringForm.destroy();\r\n        }\r\n\r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = widget.createPaper(_.bind(widget.scaleGapList, widget));\r\n        widget.createChoices();\r\n        widget.createGapImgs();\r\n    };\r\n\r\n    /**\r\n     * The map answer state for the graphicGapMatch interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Map\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Map\r\n     */\r\n    return  stateFactory.create(Map, initMapState, exitMapState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/Map'\r\n], function(factory, states){\r\n\r\n    'use strict';\r\n\r\n    //creates a state bundle for the interaction\r\n    return factory.createBundle(states, arguments);\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/gapImg', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"alt=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.objetLabel)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \";\n  return buffer;\n  }\n\n  buffer += \"<li class=\\\"qti-choice qti-gapImg selectable\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <img src=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.object)),stack1 == null || stack1 === false ? stack1 : stack1.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.data)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \\r\\n         width=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.object)),stack1 == null || stack1 === false ? stack1 : stack1.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.width)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\\r\\n         height=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.object)),stack1 == null || stack1 === false ? stack1 : stack1.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.height)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\\r\\n         \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.objectLabel), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    />\\r\\n</li>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/Widget',[\r\n    'jquery', 'lodash', 'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/states/states',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/choices/gapImg'\r\n], function($, _, __, Widget, GraphicWidget, states, gapImgTpl){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * The Widget that provides components used by the QTI Creator for the GraphicGapMatch Interaction\r\n     *\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/Widget\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/GraphicInteraction/Widget\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/Widget\r\n     */      \r\n    var GraphicGapMatchInteractionWidget = _.extend(Widget.clone(), GraphicWidget, {\r\n\r\n        /**\r\n         * Initialize the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/interactions/Widget#initCreator}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        initCreator : function(options){\r\n            var paper;\r\n            this.baseUrl = options.baseUrl;\r\n            this.choiceForm = options.choiceForm;\r\n            \r\n            this.registerStates(states);\r\n            \r\n            //call parent initCreator\r\n            Widget.initCreator.call(this);\r\n          \r\n            paper = this.createPaper(_.bind(this.scaleGapList, this)); \r\n            if(paper){\r\n                this.element.paper = paper;\r\n                this.createChoices();\r\n                this.createGapImgs();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gracefully destroy the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/Widget#destroy}\r\n         */\r\n        destroy : function(){\r\n\r\n            var $container = this.$original;\r\n            var $item      = $container.parents('.qti-item');\r\n\r\n            //stop listening the resize\r\n            $item.off('resize.gridEdit.' + this.element.serial);\r\n            $(window).off('resize.qti-widget.' + this.element.serial);\r\n            $container.off('resize.qti-widget.' + this.element.serial);\r\n\r\n            //call parent destroy\r\n            Widget.destroy.call(this);\r\n        },\r\n\r\n        /**\r\n         * Called back on paper resize to scale the gap list\r\n         * @param {Number} newSize - the interaction size\r\n         * @param {Number} [factor = 1] - scaling factor\r\n         */\r\n        scaleGapList : function(newSize, factor){\r\n\r\n           var $container = this.$original;\r\n           var $gapList   = $('ul.source', $container);\r\n           $gapList.css('max-width', newSize + 'px'); \r\n           if(factor && factor !== 1){\r\n                $gapList.find('img').each(function(){\r\n                    var $img = $(this);\r\n                    $img.width( $img.attr('width') * factor );\r\n                    $img.height( $img.attr('height') * factor );\r\n                });\r\n               $container.data('factor', factor);\r\n           } \r\n        },\r\n\r\n        /**\r\n         * Create the gap images\r\n         */\r\n        createGapImgs : function(){\r\n            var interaction = this.element;\r\n            var $container  = this.$original;\r\n            var $gapList    = $('ul.source', $container);\r\n    \r\n            $gapList.empty();\r\n            _.forEach(interaction.gapImgs, function(gapImg){\r\n                $gapList.append(gapImg.render());            \r\n            });\r\n        }\r\n   });\r\n\r\n    return GraphicGapMatchInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/GraphicGapMatchInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicGapMatchInteraction/Widget'\r\n], function(_, GraphicGapMatchInteraction, GraphicGapMatchInteractionWidget){\r\n    'use strict';\r\n\r\n    /**\r\n     * The CreatorGraphicGapMatchInteraction  Renderer\r\n     * @extends taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicGapMatchInteraction\r\n     * @exports taoQtiItem/qtiCreator/renderers/interactions/GraphicGapMatchInteraction\r\n     */\r\n    var CreatorGraphicGapMatchInteraction = _.clone(GraphicGapMatchInteraction);\r\n\r\n    /**\r\n     * Render the interaction for authoring.\r\n     * It delegates the rendering to the widget layer.\r\n     * @param {Object} interaction - the model\r\n     * @param {Object} [options] - extra options\r\n     */\r\n    CreatorGraphicGapMatchInteraction.render = function(interaction, options){\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.choiceForm = this.getOption('choiceOptionForm');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        GraphicGapMatchInteractionWidget.build(\r\n            interaction,\r\n            GraphicGapMatchInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorGraphicGapMatchInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/graphicOrderInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-graphicInteraction qti-graphicOrderInteraction clearfix\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"image-editor solid\\\">\\r\\n        <div id='graphic-paper-\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' class=\\\"main-image-box\\\"></div>\\r\\n        <div class=\\\"clearfix\\\"></div>\\r\\n        <ul class=\\\"none block-listing horizontal ordinals\\\"></ul>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/graphicOrderInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager'\r\n], function($, _, __, Promise, tpl, graphic,  pciResponse, containerHelper, instructionMgr){\r\n    'use strict';\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function render(interaction){\r\n        var self = this;\r\n\r\n        return new Promise(function(resolve, reject){\r\n            var $container = containerHelper.get(interaction);\r\n            var $orderList = $('ul', $container);\r\n            var background = interaction.object.attributes;\r\n\r\n            $container\r\n                .off('resized.qti-widget.resolve')\r\n                .one('resized.qti-widget.resolve', resolve);\r\n\r\n            //create the paper\r\n            interaction.paper = graphic.responsivePaper( 'graphic-paper-' + interaction.serial, interaction.serial, {\r\n                width       : background.width,\r\n                height      : background.height,\r\n                img         : self.resolveUrl(background.data),\r\n                imgId       : 'bg-image-' + interaction.serial,\r\n                container   : $container\r\n            });\r\n\r\n            //create the list of number to order\r\n            _renderOrderList(interaction, $orderList);\r\n\r\n            //call render choice for each interaction's choices\r\n            _.forEach(interaction.getChoices(), _.partial(_renderChoice, interaction, $orderList));\r\n\r\n            //set up the constraints instructions\r\n            instructionMgr.minMaxChoiceInstructions(interaction, {\r\n                min: interaction.attr('minChoices'),\r\n                max: interaction.attr('maxChoices'),\r\n                getResponse : _getRawResponse,\r\n                onError : function(data){\r\n                    graphic.highlightError(data.target);\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Render a choice inside the paper.\r\n     * Please note that the choice renderer isn't implemented separately because it relies on the Raphael paper instead of the DOM.\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {jQueryElement} $orderList - the list than contains the orderers\r\n     * @param {Object} choice - the hotspot choice to add to the interaction\r\n     */\r\n    var _renderChoice  =  function _renderChoice(interaction, $orderList, choice){\r\n\r\n        var rElement = graphic.createElement(interaction.paper, choice.attr('shape'), choice.attr('coords'), {\r\n            id : choice.serial,\r\n            title : __('Select this area')\r\n        })\r\n        .click(function(){\r\n            if(this.active){\r\n                _unselectShape(interaction.paper, this, $orderList);\r\n            } else {\r\n                _selectShape(interaction.paper, this, $orderList);\r\n            }\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n            instructionMgr.validateInstructions(interaction, { choice : choice });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Render the list of numbers\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @param {jQueryElement} $orderList - the list than contains the orderers\r\n     */\r\n    var _renderOrderList = function _renderOrderList(interaction, $orderList){\r\n        var $orderers;\r\n        var size = _.size(interaction.getChoices());\r\n        var min = interaction.attr('minChoices');\r\n        var max = interaction.attr('maxChoices');\r\n\r\n        //calculate the number of orderer to display\r\n        if(max > 0 && max < size){\r\n            size = max;\r\n        } else if(min > 0 && min < size){\r\n           size = min;\r\n        }\r\n\r\n        //add them to the list\r\n        _.times(size, function(index){\r\n            var position = index + 1;\r\n            var $orderer = $('<li class=\"selectable\" data-number=\"' + position + '\">' + position +  '</li>');\r\n            if(index === 0){\r\n                $orderer.addClass('active');\r\n            }\r\n            $orderList.append($orderer);\r\n        });\r\n\r\n        //create related svg texts\r\n        _createTexts(interaction.paper, size, $orderList);\r\n\r\n        //bind the activation event\r\n        $orderers = $orderList.children('li');\r\n        $orderers.click(function(e){\r\n            e.preventDefault();\r\n            var $orderer = $(this);\r\n\r\n            if(!$orderer.hasClass('active') && !$orderer.hasClass('disabled')){\r\n                $orderers.removeClass('active');\r\n                $orderer.addClass('active');\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Select a shape to position an order\r\n     * @private\r\n     * @param {Raphael.Paper} paper - the interaction paper\r\n     * @param {Raphael.element} element - the selected shape\r\n     * @param {jQueryElement} $orderList - the list than contains the orderers\r\n     */\r\n    var _selectShape = function _selectShape(paper, element, $orderList){\r\n\r\n        //lookup for the active number\r\n        var $active = $orderList.find('.active:first');\r\n        if($active.length && $active.data('number') > 0){\r\n\r\n            //associate the current number directly to the element\r\n            element.data('number', $active.data('number'));\r\n            element.active  = true;\r\n            _showText(paper, element);\r\n            graphic.updateElementState(element, 'active');\r\n\r\n            //update the state of the order list\r\n            $active.toggleClass('active disabled').siblings(':not(.disabled)').first().toggleClass('active');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Unselect a shape to free the position\r\n     * @private\r\n     * @param {Raphael.Paper} paper - the interaction paper\r\n     * @param {Raphael.element} element - the unselected shape\r\n     * @param {jQueryElement} $orderList - the list than contains the orderers\r\n     */\r\n    var _unselectShape = function _unselectShape(paper, element, $orderList){\r\n        var number = element.data('number');\r\n\r\n        //update element state\r\n        element.active  = false;\r\n        _hideText(paper, element);\r\n        element.removeData('number');\r\n        graphic.updateElementState(element, 'basic');\r\n\r\n        //reset order list state and activate the removed number\r\n        $orderList\r\n            .children().removeClass('active')\r\n            .filter('[data-number='+number+']').removeClass('disabled').addClass('active');\r\n    };\r\n\r\n    /**\r\n     * Creates ALL the texts (the numbers to display in the shapes). They are created styled but hidden.\r\n     *\r\n     * @private\r\n     * @param {Raphael.Paper} paper - the interaction paper\r\n     * @param {Number} size - the number of numbers to create...\r\n     * @param {jQueryElement} $orderList - the list than contains the orderers\r\n     * @return {Array} the creates text element\r\n     */\r\n    var _createTexts = function _createTexts(paper, size){\r\n        var texts = [];\r\n        _.times(size, function(index){\r\n\r\n            var number = index + 1;\r\n            var text = graphic.createText(paper, {\r\n                id          : 'text-' + number,\r\n                content     : number,\r\n                title       : __('Remove'),\r\n                style       : 'order-text',\r\n                hide        : true\r\n            });\r\n\r\n            //clicking the text will has the same effect that clicking the shape: unselect.\r\n            text.click(function(){\r\n                paper.forEach(function(element){\r\n                    if(element.data('number') === number && element.events){  //we just need to retrieve the right element\r\n                        //call the click event\r\n                        var evt = _.where(element.events, { name : 'click'});\r\n                        if(evt.length && evt[0] && typeof evt[0].f === 'function'){\r\n                            evt[0].f.call(element);\r\n                        }\r\n                    }\r\n                });\r\n            });\r\n            texts.push(text);\r\n        });\r\n        return texts;\r\n    };\r\n\r\n    /**\r\n     * Show the text that match the element's number.\r\n     * We need to display it at the center of the shape.\r\n     * @private\r\n     * @param {Raphael.Paper} paper - the interaction paper\r\n     * @param {Raphael.Element} element - the element to show the text for\r\n     */\r\n    var _showText =  function _showText(paper, element){\r\n        var bbox = element.getBBox();\r\n        var transf;\r\n\r\n        //we retrieve the good text from it's id\r\n        var text = paper.getById('text-' + element.data('number'));\r\n        if(text){\r\n\r\n            //move it to the center of the shape (using absolute transform), and than display it\r\n            transf = 'T' + (bbox.x + (bbox.width / 2)) + ',' +\r\n                           (bbox.y + (bbox.height / 2));\r\n            text.transform(transf)\r\n                .show()\r\n                .toFront();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Hide an element text.\r\n     * @private\r\n     * @param {Raphael.Paper} paper - the interaction paper\r\n     * @param {Raphael.Element} element - the element to hide the text for\r\n     */\r\n    var _hideText =  function _hideText (paper, element){\r\n        var text = paper.getById('text-' + element.data('number'));\r\n        if(text){\r\n            text.hide();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the responses from the interaction\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @returns {Array} of points\r\n     */\r\n    var _getRawResponse = function _getRawResponse(interaction){\r\n        var response = [];\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var elt = interaction.paper.getById(choice.serial);\r\n            if(elt && elt.data('number')){\r\n                response.push({\r\n                    index : elt.data('number'),\r\n                    id : choice.id()\r\n                });\r\n            }\r\n        });\r\n        return _(response).sortBy('index').map('id').value();\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n        var responseValues;\r\n        var $container = containerHelper.get(interaction);\r\n        var $orderList = $('ul', $container);\r\n        if(response && interaction.paper){\r\n\r\n            try {\r\n                //try to unserualize tthe pci response\r\n                responseValues = pciResponse.unserialize(response, interaction);\r\n            } catch(e){}\r\n\r\n            if(_.isArray(responseValues)){\r\n                _.forEach(responseValues, function(responseValue, index){\r\n                    var element;\r\n                    var number = index + 1;\r\n\r\n                    //get the choice that match the response\r\n                    var choice = _(interaction.getChoices()).where({'attributes' : { 'identifier' : responseValue}}).first();\r\n                    if(choice){\r\n                       element = interaction.paper.getById(choice.serial);\r\n                       if(element){\r\n                            //activate the orderer to be consistant\r\n                            $orderList.children('[data-number='+number+']').addClass('active');\r\n\r\n                            //select the related shape\r\n                            _selectShape(interaction.paper, element, $orderList);\r\n                       }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset the current responses of the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var resetResponse = function resetResponse(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var $orderList = $('ul', $container);\r\n\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element){\r\n                _unselectShape(interaction.paper, element, $orderList);\r\n            }\r\n        });\r\n\r\n        $orderList.children('li').removeClass('active disabled').first().addClass('active');\r\n    };\r\n\r\n\r\n    /**\r\n     i* Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        return  pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n        var $container;\r\n        if(interaction.paper){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            $(window).off('resize.qti-widget.' + interaction.serial);\r\n            $container.off('resize.qti-widget.' + interaction.serial);\r\n\r\n            interaction.paper.clear();\r\n            instructionMgr.removeInstructions(interaction);\r\n\r\n            $('.main-image-box', $container).empty().removeAttr('style');\r\n            $('.image-editor', $container).removeAttr('style');\r\n            $('ul', $container).empty();\r\n        }\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n\r\n    /**\r\n     * Expose the common renderer for the interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/SelectPointInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'graphicOrderInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Sleep',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep'\r\n], function($, stateFactory, SleepState){\r\n\r\n    'use strict';\r\n\r\n    var initSleepState = function initSleepState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        widget.on('metaChange', function(data){\r\n            if(data.key === 'responsive'){\r\n                if(data.value === true){\r\n                    interaction.addClass('responsive');\r\n                } else {\r\n                    interaction.removeClass('responsive');\r\n                }\r\n                widget.rebuild();\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n    var exitSleepState = function exitSleepState(){\r\n        $('.image-editor.solid, .block-listing.source', this.widget.$container).css('min-width', 0);\r\n    };\r\n \r\n    return stateFactory.extend(SleepState, initSleepState, exitSleepState); \r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/graphicOrder', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Interaction Background\", options) : helperMissing.call(depth0, \"__\", \"Interaction Background\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"data\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the image.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the image.\", options)))\n    + \"</div>\\r\\n        <input type=\\\"text\\\" name=\\\"data\\\" value=\\\"\";\n  if (helper = helpers.data) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.data); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n        <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select image\", options) : helperMissing.call(depth0, \"__\", \"Select image\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"panel media-sizer-panel\\\">\\r\\n        <!-- media sizer goes here -->\\r\\n    </div>\\r\\n    <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n    <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n\\r\\n\\r\\n    <input name=\\\"type\\\" value=\\\"\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" readonly />\\r\\n\\r\\n    <hr>\\r\\n\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed choices\", options) : helperMissing.call(depth0, \"__\", \"Allowed choices\", options)))\n    + \"</h3>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices that the candidate is required to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices that the candidate is required to select to form a valid response.\", options)))\n    + \"<br>\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices that the candidate is allowed to select.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices that the candidate is allowed to select.\", options)))\n    + \"\\r\\n        </span>\\r\\n\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <div>\\r\\n            <label for=\\\"minChoices\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Min\", options) : helperMissing.call(depth0, \"__\", \"Min\", options)))\n    + \"</label>\\r\\n        <input name=\\\"minChoices\\\" value=\\\"\";\n  if (helper = helpers.minChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.minChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n        <div>\\r\\n            <label for=\\\"maxChoices\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max\", options) : helperMissing.call(depth0, \"__\", \"Max\", options)))\n    + \"</label>\\r\\n        <input name=\\\"maxChoices\\\" value=\\\"\";\n  if (helper = helpers.maxChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n        </div>\\r\\n    </div>\\r\\n\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/choices/hotspot', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"identifier\", options) : helperMissing.call(depth0, \"__\", \"identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the choice. This identifier must not be used by any other choice or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"identifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. my-hotspot_1\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\\r\\n\\r\\n<h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shape position\", options) : helperMissing.call(depth0, \"__\", \"Shape position\", options)))\n    + \"</h3>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"x\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Left\", options) : helperMissing.call(depth0, \"__\", \"Left\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The left position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The left position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"x\\\" value=\\\"\";\n  if (helper = helpers.x) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.x); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"y\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Top\", options) : helperMissing.call(depth0, \"__\", \"Top\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The top position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The top position of the shape relative to the top left corner of the background in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"y\\\" value=\\\"\";\n  if (helper = helpers.y) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.y); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Width\", options) : helperMissing.call(depth0, \"__\", \"Width\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The shape width in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The shape width in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"height\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Height\", options) : helperMissing.call(depth0, \"__\", \"Height\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The shape height in pixels. This value may be scaled when the background image size is adapted to it's container\", options) : helperMissing.call(depth0, \"__\", \"The shape height in pixels. This value may be scaled when the background image size is adapted to it's container\", options)))\n    + \"</div>\\r\\n    <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" readonly />\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/imageSelector',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/graphicOrder',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/hotspot',\r\n    'taoQtiItem/qtiCreator/helper/panel',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/resourceManager',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/bgImage',\r\n    'ui/mediasizer'\r\n], function($, _, GraphicHelper, stateFactory, Question, shapeEditor, imageSelector, formElement, interactionFormElement, identifierHelper, formTpl, choiceFormTpl, panel, resourceManager, bgImage){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Question State initialization: set up side bar, editors and shae factory\r\n     */\r\n    var initQuestionState = function initQuestionState(){\r\n\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var paper       = interaction.paper;\r\n\r\n        if(!paper){\r\n            return;\r\n        }\r\n\r\n        var $choiceForm  = widget.choiceForm;\r\n        var $formInteractionPanel = $('#item-editor-interaction-property-bar');\r\n        var $formChoicePanel = $('#item-editor-choice-property-bar');\r\n\r\n        var $left, $top, $width, $height;\r\n\r\n        //instantiate the shape editor, attach it to the widget to retrieve it during the exit phase\r\n        widget._editor = shapeEditor(widget, {\r\n            shapeCreated : function(shape, type){\r\n                var newChoice = interaction.createChoice({\r\n                    shape  : type === 'path' ? 'poly' : type,\r\n                    coords : GraphicHelper.qtiCoords(shape)\r\n                });\r\n\r\n                //link the shape to the choice\r\n                shape.id = newChoice.serial;\r\n            },\r\n            shapeRemoved : function(id){\r\n                interaction.removeChoice(id);\r\n            },\r\n            enterHandling : function(shape){\r\n                enterChoiceForm(shape.id);\r\n            },\r\n            quitHandling : function(){\r\n                leaveChoiceForm();\r\n            },\r\n            shapeChange : function(shape){\r\n                var bbox;\r\n                var choice = interaction.getChoice(shape.id);\r\n                if(choice){\r\n                    choice.attr('coords', GraphicHelper.qtiCoords(shape));\r\n\r\n                    if($left && $left.length){\r\n                        bbox = shape.getBBox();\r\n                        $left.val(parseInt(bbox.x, 10));\r\n                        $top.val(parseInt(bbox.y, 10));\r\n                        $width.val(parseInt(bbox.width, 10));\r\n                        $height.val(parseInt(bbox.height, 10));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        //and create an instance\r\n        widget._editor.create();\r\n\r\n        //we need to stop the question mode on resize, to keep the coordinate system coherent,\r\n        //even in responsive (the side bar introduce a biais)\r\n        $(window).on('resize.changestate', function(){\r\n            widget.changeState('sleep');\r\n        });\r\n\r\n\r\n        widget.on('attributeChange', function(data){\r\n            if(data.key === 'maxChoices'){\r\n                widget.renderOrderList();\r\n            }\r\n        });\r\n        /**\r\n         * Set up the choice form\r\n         * @private\r\n         * @param {String} serial - the choice serial\r\n         */\r\n        function enterChoiceForm(serial){\r\n            var choice = interaction.getChoice(serial);\r\n            var element, bbox;\r\n            if(choice){\r\n\r\n                //get shape bounding box\r\n                element = interaction.paper.getById(serial);\r\n                bbox = element.getBBox();\r\n\r\n                $choiceForm.empty().html(\r\n                    choiceFormTpl({\r\n                        identifier  : choice.id(),\r\n                        fixed       : choice.attr('fixed'),\r\n                        serial      : serial,\r\n                        x           : parseInt(bbox.x, 10),\r\n                        y           : parseInt(bbox.y, 10),\r\n                        width       : parseInt(bbox.width, 10),\r\n                        height      : parseInt(bbox.height, 10)\r\n                    })\r\n                );\r\n\r\n                formElement.initWidget($choiceForm);\r\n\r\n                //init data validation and binding\r\n                formElement.setChangeCallbacks($choiceForm, choice, {\r\n                    identifier  : identifierHelper.updateChoiceIdentifier,\r\n                    fixed       : formElement.getAttributeChangeCallback()\r\n                });\r\n\r\n                $formChoicePanel.show();\r\n                panel.openSections($formChoicePanel.children('section'));\r\n                panel.closeSections($formInteractionPanel.children('section'));\r\n\r\n                //change the nodes bound to the position fields\r\n                $left   = $('input[name=x]', $choiceForm);\r\n                $top    = $('input[name=y]', $choiceForm);\r\n                $width  = $('input[name=width]', $choiceForm);\r\n                $height = $('input[name=height]', $choiceForm);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Leave the choice form\r\n         * @private\r\n         */\r\n        function leaveChoiceForm(){\r\n            if($formChoicePanel.css('display') !== 'none'){\r\n                panel.openSections($formInteractionPanel.children('section'));\r\n                $formChoicePanel.hide();\r\n                $choiceForm.empty();\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Exit the question state, leave the room cleaned up\r\n     */\r\n    var exitQuestionState = function initQuestionState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var paper       = interaction.paper;\r\n        var valid       = !!interaction.object.attr('data') && !_.isEmpty(interaction.choices);\r\n\r\n        widget.isValid('graphicOrderInteraction', valid);\r\n\r\n        if(!paper){\r\n            return;\r\n        }\r\n\r\n        $(window).off('resize.changestate');\r\n\r\n        if(widget._editor){\r\n            widget._editor.destroy();\r\n        }\r\n        $('.image-editor.solid, .block-listing.source', this.widget.$container).css('min-width', 0);\r\n    };\r\n\r\n    /**\r\n     * The question state for the graphicOrder interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Question\r\n     */\r\n    var GraphicOrderInteractionStateQuestion = stateFactory.extend(Question, initQuestionState, exitQuestionState);\r\n\r\n    /**\r\n     * Initialize the form linked to the interaction\r\n     */\r\n    GraphicOrderInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n        var widget = this.widget;\r\n        var options = widget.options;\r\n        var interaction = widget.element;\r\n        var $form = widget.$form;\r\n\r\n        $form.html(formTpl({\r\n            baseUrl         : options.baseUrl,\r\n            maxChoices      : parseInt(interaction.attr('maxChoices')),\r\n            minChoices      : parseInt(interaction.attr('minChoices')),\r\n            choicesCount    : _.size(interaction.getChoices()),\r\n            data            : interaction.object.attr('data'),\r\n            width           : interaction.object.attr('width'),\r\n            height          : interaction.object.attr('height'),\r\n            type            : interaction.object.attr('type')\r\n        }));\r\n\r\n        imageSelector($form, options);\r\n\r\n        formElement.initWidget($form);\r\n\r\n        bgImage.setupImage(widget);\r\n\r\n        //init data change callbacks\r\n        bgImage.setChangeCallbacks(\r\n            widget,\r\n            formElement,\r\n            formElement.getMinMaxAttributeCallbacks($form, 'minChoices', 'maxChoices', {updateCardinality:false})\r\n        );\r\n\r\n        interactionFormElement.syncMaxChoices(widget);\r\n    };\r\n\r\n    return GraphicOrderInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Correct',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function(_, __, stateFactory, Correct, commonRenderer, instructionMgr, PciResponse){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state: use the common renderer to set the correct response.\r\n     */\r\n    function initCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n       \r\n        //really need to destroy before ? \r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please order the choices below to set the correct answer'));\r\n        \r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n\r\n        commonRenderer.setResponse(interaction, PciResponse.serialize(_.values(response.getCorrect()), interaction));\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            response.setCorrect(PciResponse.unserialize(data.response, interaction)); \r\n        });\r\n\r\n    }\r\n\r\n    /**\r\n     * Exit the correct state\r\n     */\r\n    function exitCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        \r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //stop listening responses changes\r\n        widget.$container.off('responseChange.qti-widget');\r\n        \r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction); \r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = widget.createPaper(_.bind(widget.scaleOrderList, widget)); \r\n        widget.createChoices();\r\n        widget.renderOrderList();\r\n    }\r\n\r\n    /**\r\n     * The correct answer state for the graphicOrder interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Correct\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Correct\r\n     */\r\n    return stateFactory.create(Correct, initCorrectState, exitCorrectState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n\t'taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/Correct'\r\n], function(factory, states){\r\n\r\n    'use strict';\r\n\r\n    //creates a state bundle for the interaction\r\n    return factory.createBundle(states, arguments);\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/Widget',[\r\n    'jquery', 'lodash', 'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/states/states'\r\n], function($, _, __, Widget, GraphicWidget, states){\r\n\r\n    /**\r\n     * The Widget that provides components used by the QTI Creator for the GraphicOrder Interaction\r\n     *\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/Widget\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/GraphicInteraction/Widget\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/Widget\r\n     */      \r\n    var GraphicOrderInteractionWidget = _.extend(Widget.clone(), GraphicWidget, {\r\n\r\n        /**\r\n         * Initialize the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/interactions/Widget#initCreator}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        initCreator : function(options){\r\n            var paper;\r\n            this.baseUrl = options.baseUrl;\r\n            this.choiceForm = options.choiceForm;\r\n            \r\n            this.registerStates(states);\r\n            \r\n            //call parent initCreator\r\n            Widget.initCreator.call(this);\r\n           \r\n            paper = this.createPaper(_.bind(this.scaleOrderList, this)); \r\n            if(paper){\r\n                this.element.paper = paper;\r\n                this.createChoices();\r\n                this.renderOrderList();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gracefull destroy the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/Widget#destroy}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        destroy : function(){\r\n\r\n            var $container = this.$original;\r\n            var $item      = $container.parents('.qti-item');\r\n\r\n            //stop listening the resize\r\n            $item.off('resize.gridEdit.' + this.element.serial);\r\n            $(window).off('resize.qti-widget.' + this.element.serial);\r\n            $container.off('resize.qti-widget.' + this.element.serial);\r\n\r\n            //call parent destroy\r\n            Widget.destroy.call(this);\r\n        },\r\n\r\n        /**\r\n         * Called back on paper resize to scale the order list\r\n         * @param {Number} newSize - the interaction size\r\n         */\r\n        scaleOrderList : function(newSize){\r\n            $('ul.block-listing', this.$original).css('max-width', newSize + 'px');\r\n        }, \r\n\r\n        /**\r\n         * Render the list of numbers\r\n         */\r\n         renderOrderList : function renderOrderList(){\r\n            var interaction = this.element;\r\n            var size        = _.size(interaction.getChoices());\r\n            var min         = interaction.attr('minChoices');\r\n            var max         = interaction.attr('maxChoices');\r\n            var $orderList  = $('ul.block-listing', this.$original);\r\n\r\n            //calculate the number of orderer to display\r\n            if(max > 0 && max < size){\r\n                size = max;\r\n            } else if(min > 0 && min < size){\r\n               size = min;\r\n            }\r\n    \r\n            $orderList.empty();\r\n\r\n            //add them to the list\r\n            _.times(size, function(index){\r\n                var position = index + 1;\r\n                var $orderer = $('<li class=\"selectable\" data-number=\"' + position + '\">' + position +  '</li>');\r\n                if(index === 0){\r\n                    $orderer.addClass('active');\r\n                }\r\n                $orderList.append($orderer);\r\n            });\r\n        }\r\n   });\r\n\r\n    return GraphicOrderInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/GraphicOrderInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicOrderInteraction/Widget'\r\n], function(_, GraphicOrderInteraction, GraphicOrderInteractionWidget){\r\n    'use strict';\r\n\r\n    /**\r\n     * The CreatorGraphicOrderInteraction  Renderer\r\n     * @extends taoQtiItem/qtiCommonRenderer/renderers/interactions/GraphicOrderInteraction\r\n     * @exports taoQtiItem/qtiCreator/renderers/interactions/GraphicOrderInteraction\r\n     */\r\n    var CreatorGraphicOrderInteraction = _.clone(GraphicOrderInteraction);\r\n\r\n    /**\r\n     * Render the interaction for authoring.\r\n     * It delegates the rendering to the widget layer.\r\n     * @param {Object} interaction - the model\r\n     * @param {Object} [options] - extra options\r\n     */\r\n    CreatorGraphicOrderInteraction.render = function(interaction, options){\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.choiceForm = this.getOption('choiceOptionForm');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        GraphicOrderInteractionWidget.build(\r\n            interaction,\r\n            GraphicOrderInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorGraphicOrderInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/hotspotInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-graphicInteraction qti-hotspotInteraction clearfix\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"image-editor solid\\\">\\r\\n        <div id='graphic-paper-\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' class=\\\"main-image-box\\\"></div>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/hotspotInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager'\r\n], function($, _, __, Promise, tpl, graphic,  pciResponse, containerHelper, instructionMgr){\r\n    'use strict';\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function render(interaction){\r\n        var self = this;\r\n\r\n        return new Promise(function(resolve, reject){\r\n            var $container = containerHelper.get(interaction);\r\n            var background = interaction.object.attributes;\r\n\r\n            $container\r\n                .off('resized.qti-widget.resolve')\r\n                .one('resized.qti-widget.resolve', resolve);\r\n\r\n            interaction.paper = graphic.responsivePaper( 'graphic-paper-' + interaction.serial, interaction.serial, {\r\n                width     : background.width,\r\n                height    : background.height,\r\n                img       : self.resolveUrl(background.data),\r\n                container : $container\r\n            });\r\n\r\n            //call render choice for each interaction's choices\r\n            _.forEach(interaction.getChoices(), _.partial(_renderChoice, interaction));\r\n\r\n            //set up the constraints instructions\r\n            instructionMgr.minMaxChoiceInstructions(interaction, {\r\n                min: interaction.attr('minChoices'),\r\n                max: interaction.attr('maxChoices'),\r\n                getResponse : _getRawResponse,\r\n                onError : function(data){\r\n                    if(data.target.active){\r\n                        data.target.active = false;\r\n                        graphic.updateElementState(this, 'basic', __('Select this area'));\r\n                        graphic.highlightError(data.target);\r\n                        containerHelper.triggerResponseChangeEvent(interaction);\r\n                        $container.trigger('inactiveChoice.qti-widget', [data.choice, data.target]);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Render a choice inside the paper.\r\n     * Please note that the choice renderer isn't implemented separately because it relies on the Raphael paper instead of the DOM.\r\n     * @param {Paper} paper - the raphael paper to add the choices to\r\n     * @param {Object} interaction\r\n     * @param {Object} choice - the hotspot choice to add to the interaction\r\n     */\r\n    var _renderChoice  =  function _renderChoice(interaction, choice){\r\n        var $container = containerHelper.get(interaction);\r\n        var rElement = graphic.createElement(interaction.paper, choice.attr('shape'), choice.attr('coords'), {\r\n            id : choice.serial,\r\n            title : __('Select this area')\r\n        })\r\n        .click(function(){\r\n            if(this.active){\r\n                graphic.updateElementState(this, 'basic', __('Select this area'));\r\n                this.active = false;\r\n                $container.trigger('inactiveChoice.qti-widget', [choice, this]);\r\n            } else {\r\n                graphic.updateElementState(this, 'active', __('Click again to remove'));\r\n                this.active = true;\r\n                $container.trigger('activeChoice.qti-widget', [choice, this]);\r\n            }\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n            instructionMgr.validateInstructions(interaction, { choice : choice, target : this });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Get the response from the interaction\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @returns {Array} the response in raw format\r\n     */\r\n    var _getRawResponse = function _getRawResponse(interaction){\r\n\r\n       return _(interaction.getChoices())\r\n        .map(function(choice){\r\n            var rElement = interaction.paper.getById(choice.serial);\r\n            return (rElement && rElement.active === true) ? choice.id() : false;\r\n       })\r\n        .filter(_.isString)\r\n        .value();\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n\r\n        var responseValues;\r\n        if(response && interaction.paper){\r\n\r\n            try{\r\n                responseValues = pciResponse.unserialize(response, interaction);\r\n\r\n            } catch(e){ }\r\n\r\n            if(_.isArray(responseValues)){\r\n\r\n                _.forEach(interaction.getChoices(), function(choice){\r\n                    var rElement;\r\n                    if(_.contains(responseValues, choice.attributes.identifier)){\r\n                        rElement = interaction.paper.getById(choice.serial);\r\n                        if(rElement){\r\n                            rElement.active = true;\r\n                            graphic.updateElementState(rElement, 'active', __('Click again to remove'));\r\n                            instructionMgr.validateInstructions(interaction, { choice : choice, target : rElement });\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset the current responses of the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var resetResponse = function resetResponse(interaction){\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var element = interaction.paper.getById(choice.serial);\r\n            if(element){\r\n                element.active = false;\r\n                graphic.updateElementState(element, 'basic');\r\n            }\r\n        });\r\n        instructionMgr.resetInstructions(interaction);\r\n    };\r\n\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        var raw = _getRawResponse(interaction);\r\n        var response =  pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n        return response;\r\n    };\r\n\r\n    /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n        var $container;\r\n        if(interaction.paper){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            $(window).off('resize.qti-widget.' + interaction.serial);\r\n            $container.off('resize.qti-widget.' + interaction.serial);\r\n\r\n            interaction.paper.clear();\r\n            instructionMgr.removeInstructions(interaction);\r\n\r\n            $('.main-image-box', $container).empty().removeAttr('style');\r\n            $('.image-editor', $container).removeAttr('style');\r\n        }\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the hotspot interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/HotspotInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'hotspotInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Sleep',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep'\r\n], function($, stateFactory, SleepState){\r\n\r\n    'use strict';\r\n\r\n    var initSleepState = function initSleepState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        widget.on('metaChange', function(data){\r\n            if(data.key === 'responsive'){\r\n                if(data.value === true){\r\n                    interaction.addClass('responsive');\r\n                } else {\r\n                    interaction.removeClass('responsive');\r\n                }\r\n                widget.rebuild();\r\n            }\r\n        });\r\n    };\r\n\r\n    var exitSleepState = function exitSleepState(){\r\n        $('.image-editor.solid, .block-listing.source', this.widget.$container).css('min-width', 0);\r\n    };\r\n \r\n    return stateFactory.extend(SleepState, initSleepState, exitSleepState); \r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/hotspot', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Interaction Background\", options) : helperMissing.call(depth0, \"__\", \"Interaction Background\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"data\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the image.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the image.\", options)))\n    + \"</div>\\r\\n        <input type=\\\"text\\\" name=\\\"data\\\" value=\\\"\";\n  if (helper = helpers.data) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.data); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n        <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select image\", options) : helperMissing.call(depth0, \"__\", \"Select image\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"panel media-sizer-panel\\\">\\r\\n        <!-- media sizer goes here -->\\r\\n    </div>\\r\\n    <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n    <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n\\r\\n\\r\\n        <input name=\\\"type\\\" value=\\\"\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" readonly />\\r\\n\\r\\n    <hr>\\r\\n\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed choices\", options) : helperMissing.call(depth0, \"__\", \"Allowed choices\", options)))\n    + \"</h3>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices that the candidate is required to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices that the candidate is required to select to form a valid response.\", options)))\n    + \"<br>\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices that the candidate is allowed to select.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices that the candidate is allowed to select.\", options)))\n    + \"\\r\\n        </span>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <div>\\r\\n            <label for=\\\"minChoices\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Min\", options) : helperMissing.call(depth0, \"__\", \"Min\", options)))\n    + \"</label>\\r\\n        <input name=\\\"minChoices\\\" value=\\\"\";\n  if (helper = helpers.minChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.minChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n        <div>\\r\\n            <label for=\\\"maxChoices\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max\", options) : helperMissing.call(depth0, \"__\", \"Max\", options)))\n    + \"</label>\\r\\n        <input name=\\\"maxChoices\\\" value=\\\"\";\n  if (helper = helpers.maxChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n    </div>\\r\\n\\r\\n\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/imageSelector',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/hotspot',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/hotspot',\r\n    'taoQtiItem/qtiCreator/helper/panel',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/resourceManager',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/bgImage',\r\n    'ui/mediasizer'\r\n], function($, _, GraphicHelper, stateFactory, Question, shapeEditor, imageSelector, formElement, interactionFormElement,  identifierHelper, formTpl, choiceFormTpl, panel, resourceManager, bgImage){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Question State initialization: set up side bar, editors and shae factory\r\n     */\r\n    var initQuestionState = function initQuestionState(){\r\n\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var paper       = interaction.paper;\r\n\r\n        if(!paper){\r\n            return;\r\n        }\r\n\r\n        var $choiceForm  = widget.choiceForm;\r\n        var $formInteractionPanel = $('#item-editor-interaction-property-bar');\r\n        var $formChoicePanel = $('#item-editor-choice-property-bar');\r\n\r\n        var $left, $top, $width, $height;\r\n\r\n        //instantiate the shape editor, attach it to the widget to retrieve it during the exit phase\r\n        widget._editor = shapeEditor(widget, {\r\n            shapeCreated : function(shape, type){\r\n                var newChoice = interaction.createChoice({\r\n                    shape  : type === 'path' ? 'poly' : type,\r\n                    coords : GraphicHelper.qtiCoords(shape)\r\n                });\r\n\r\n                //link the shape to the choice\r\n                shape.id = newChoice.serial;\r\n            },\r\n            shapeRemoved : function(id){\r\n                interaction.removeChoice(id);\r\n            },\r\n            enterHandling : function(shape){\r\n                enterChoiceForm(shape.id);\r\n            },\r\n            quitHandling : function(){\r\n                leaveChoiceForm();\r\n            },\r\n            shapeChange : function(shape){\r\n                var bbox;\r\n                var choice = interaction.getChoice(shape.id);\r\n                if(choice){\r\n                    choice.attr('coords', GraphicHelper.qtiCoords(shape));\r\n\r\n                    if($left && $left.length){\r\n                        bbox = shape.getBBox();\r\n                        $left.val(parseInt(bbox.x, 10));\r\n                        $top.val(parseInt(bbox.y, 10));\r\n                        $width.val(parseInt(bbox.width, 10));\r\n                        $height.val(parseInt(bbox.height, 10));\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        //and create an instance\r\n        widget._editor.create();\r\n\r\n        //we need to stop the question mode on resize, to keep the coordinate system coherent,\r\n        //even in responsive (the side bar introduce a biais)\r\n        $(window).on('resize.changestate', function(){\r\n            widget.changeState('sleep');\r\n        });\r\n\r\n        /**\r\n         * Set up the choice form\r\n         * @private\r\n         * @param {String} serial - the choice serial\r\n         */\r\n        function enterChoiceForm(serial){\r\n            var choice = interaction.getChoice(serial);\r\n            var element, bbox;\r\n\r\n            if(choice){\r\n\r\n                //get shape bounding box\r\n                element = interaction.paper.getById(serial);\r\n                bbox = element.getBBox();\r\n\r\n                $choiceForm.empty().html(\r\n                    choiceFormTpl({\r\n                        identifier  : choice.id(),\r\n                        fixed       : choice.attr('fixed'),\r\n                        serial      : serial,\r\n                        x           : parseInt(bbox.x, 10),\r\n                        y           : parseInt(bbox.y, 10),\r\n                        width       : parseInt(bbox.width, 10),\r\n                        height      : parseInt(bbox.height, 10)\r\n                    })\r\n                );\r\n\r\n                formElement.initWidget($choiceForm);\r\n\r\n                //init data validation and binding\r\n                formElement.setChangeCallbacks($choiceForm, choice, {\r\n                    identifier  : identifierHelper.updateChoiceIdentifier,\r\n                    fixed       : formElement.getAttributeChangeCallback()\r\n                });\r\n\r\n                $formChoicePanel.show();\r\n                panel.openSections($formChoicePanel.children('section'));\r\n                panel.closeSections($formInteractionPanel.children('section'));\r\n\r\n                //change the nodes bound to the position fields\r\n                $left   = $('input[name=x]', $choiceForm);\r\n                $top    = $('input[name=y]', $choiceForm);\r\n                $width  = $('input[name=width]', $choiceForm);\r\n                $height = $('input[name=height]', $choiceForm);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Leave the choice form\r\n         * @private\r\n         */\r\n        function leaveChoiceForm(){\r\n            if($formChoicePanel.css('display') !== 'none'){\r\n                panel.openSections($formInteractionPanel.children('section'));\r\n                $formChoicePanel.hide();\r\n                $choiceForm.empty();\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Exit the question state, leave the room cleaned up\r\n     */\r\n    var exitQuestionState = function initQuestionState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var paper       = interaction.paper;\r\n        var valid       = !!interaction.object.attr('data') && !_.isEmpty(interaction.choices);\r\n\r\n        widget.isValid('hotspotInteraction', valid);\r\n\r\n        if(!paper){\r\n            return;\r\n        }\r\n\r\n        $(window).off('resize.changestate');\r\n\r\n        if(widget._editor){\r\n            widget._editor.destroy();\r\n        }\r\n        $('.image-editor.solid, .block-listing.source', widget.$container).css('min-width', 0);\r\n    };\r\n\r\n    /**\r\n     * The question state for the hotspot interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Question\r\n     */\r\n    var HotspotInteractionStateQuestion = stateFactory.extend(Question, initQuestionState, exitQuestionState);\r\n\r\n    /**\r\n     * Initialize the form linked to the interaction\r\n     */\r\n    HotspotInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n        var widget = this.widget;\r\n        var options = widget.options;\r\n        var interaction = widget.element;\r\n        var $form = widget.$form;\r\n\r\n        $form.html(formTpl({\r\n            baseUrl         : options.baseUrl,\r\n            maxChoices      : parseInt(interaction.attr('maxChoices')),\r\n            minChoices      : parseInt(interaction.attr('minChoices')),\r\n            choicesCount    : _.size(interaction.getChoices()),\r\n            data            : interaction.object.attr('data'),\r\n            width           : interaction.object.attr('width'),\r\n            height          : interaction.object.attr('height'),\r\n            type            : interaction.object.attr('type')\r\n        }));\r\n\r\n        imageSelector($form, options);\r\n\r\n        formElement.initWidget($form);\r\n\r\n        bgImage.setupImage(widget);\r\n\r\n        bgImage.setChangeCallbacks(\r\n            widget,\r\n            formElement,\r\n            formElement.getMinMaxAttributeCallbacks(this.widget.$form, 'minChoices', 'maxChoices')\r\n        );\r\n\r\n        interactionFormElement.syncMaxChoices(widget);\r\n    };\r\n\r\n    return HotspotInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Correct',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function(_, __, stateFactory, Correct, commonRenderer, instructionMgr, PciResponse){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state: use the common renderer to set the correct response.\r\n     */\r\n    var initCorrectState = function initCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        \r\n        //really need to destroy before ? \r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please select the correct hotspot choices below.'));\r\n        \r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n\r\n        commonRenderer.setResponse(interaction, PciResponse.serialize(_.values(response.getCorrect()), interaction));\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            response.setCorrect(PciResponse.unserialize(data.response, interaction));\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Exit the correct state\r\n     */\r\n    var exitCorrectState = function exitCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        \r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //stop listening responses changes\r\n        widget.$container.off('responseChange.qti-widget');\r\n        \r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction); \r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = widget.createPaper();\r\n        widget.createChoices(); \r\n    };\r\n\r\n    /**\r\n     * The correct answer state for the hotspot interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Correct\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Correct\r\n     */\r\n    return stateFactory.create(Correct, initCorrectState, exitCorrectState);\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicScorePopup',[\r\n    'jquery', \r\n    'lodash' \r\n], function($, _){\r\n\r\n\r\n    /**\r\n     * Creates a popup relative to shape in a paper\r\n     * @param {Raphael.Element} shape - the relative shape\r\n     * @param {jQueryElement} $container - the svg container\r\n     * @returns {jQueryElement} the popup\r\n     */\r\n    return function createShapePopups(paper, shape, $container, isResponsive){\r\n        var wfactor;\r\n        var margin      = 10;\r\n        var $shape      = $(shape.node);\r\n        var $element    = $('<div class=\"mapping-editor arrow-left-top\"></div>'); \r\n        var boxOffset   = $container.offset();\r\n        var offset      = $shape.offset();\r\n        var bbox        = shape.getBBox();\r\n        var width       = bbox.width; \r\n           \r\n        if(isResponsive){\r\n            wfactor = paper.w / paper.width;\r\n            width   = Math.round(width * (2 - wfactor));\r\n        }\r\n \r\n        //style and attach the form\r\n        $element.css({\r\n            'top'       : offset.top - boxOffset.top - margin,\r\n            'left'      : offset.left - boxOffset.left + width + margin\r\n        }).appendTo($container);\r\n\r\n        return $element;\r\n    };  \r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/response/graphicScoreMappingForm', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, self=this, functionType=\"function\";\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n        <div class=\\\"panel\\\" data-edit=\\\"correct\\\">\\r\\n            <label>\\r\\n                \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Correct\", options) : helperMissing.call(depth0, \"__\", \"Correct\", options)))\n    + \"\\r\\n                <input name=\\\"correct\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.correct), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n                <span class=\\\"icon-checkbox\\\"></span>\\r\\n            </label>\\r\\n            <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Is this choice the correct response?\", options) : helperMissing.call(depth0, \"__\", \"Is this choice the correct response?\", options)))\n    + \"</span>\\r\\n        </div>\\r\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \" checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"    <a class=\\\"closer\\\" href=\\\"#\\\" data-close=\\\":parent .mapping-editor\\\"></a>\\r\\n    <div class=\\\"form-container\\\">\\r\\n        <h2>\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</h2>\\r\\n\\r\\n\";\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.noCorrect), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        <div class=\\\"panel\\\">\\r\\n            <label for=\\\"score\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Score\", options) : helperMissing.call(depth0, \"__\", \"Score\", options)))\n    + \"</label>\\r\\n            <input value=\\\"\";\n  if (helper = helpers.score) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.score); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" data-for=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" name=\\\"score\\\" class=\\\"score\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\" />\\r\\n            <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Set the score for this response\", options) : helperMissing.call(depth0, \"__\", \"Set the score for this response\", options)))\n    + \"</span>\\r\\n        </div>\\r\\n        <span class=\\\"arrow\\\"></span>\\r\\n        <span class=\\\"arrow-cover\\\"></span>\\r\\n    </div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Map',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicScorePopup',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/response/graphicScoreMappingForm',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'ui/deleter',\r\n    'ui/tooltipster'\r\n], function($, _, __, stateFactory, Map, commonRenderer, instructionMgr, graphicHelper, PciResponse, answerStateHelper, grahicScorePopup, mappingFormTpl, formElement, deleter, tooltipster){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state.\r\n     */\r\n    var initMapState = function initMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n\r\n        //really need to destroy before ? \r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n        \r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please the score of each hotspot choice.'));\r\n        interaction.responseMappingMode = true;\r\n\r\n        //here we do not use the common renderer but the creator's widget to get only a basic paper with the choices\r\n        interaction.paper = widget.createPaper();     \r\n        widget.createChoices(); \r\n\r\n        initResponseMapping(widget);           \r\n\r\n        //set the current corrects responses on the paper\r\n        commonRenderer.setResponse(interaction, PciResponse.serialize(_.values(response.getCorrect()), interaction));   \r\n    };\r\n\r\n    /**\r\n     * Exit the map state\r\n     */\r\n    var exitMapState = function exitMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        \r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction); \r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = widget.createPaper();\r\n        widget.createChoices(); \r\n    };\r\n\r\n\r\n    /**\r\n     * Set up all elements to set the response mapping.\r\n     * TODO this method needs to be split\r\n     * @param {Oject} widget - the current widget\r\n     */\r\n    function initResponseMapping(widget){\r\n        var scoreTexts      = {};\r\n        var interaction     = widget.element;\r\n        var $container      = widget.$original; \r\n        var isResponsive    = $container.hasClass('responsive');\r\n        var $imageBox       = $('.main-image-box', $container);\r\n        var response        = interaction.getResponseDeclaration();\r\n        var mapEntries      = response.getMapEntries(); \r\n        var corrects        = _.values(response.getCorrect());\r\n\r\n        //get the shape of each choice\r\n        _.forEach(interaction.getChoices(), function(choice){    \r\n            var shape = interaction.paper.getById(choice.serial);\r\n            var $popup = grahicScorePopup(interaction.paper, shape, $imageBox, isResponsive);\r\n            var score = mapEntries[choice.id()] || response.mappingAttributes.defaultValue || '0'; \r\n\r\n            //create an SVG  text from the default mapping value\r\n            scoreTexts[choice.serial] = graphicHelper.createShapeText(interaction.paper, shape, {\r\n                id          : 'score-' + choice.serial,\r\n                content     : score,\r\n                style       : 'score-text-default',\r\n                shapeClick  : true\r\n            }).data('default', true); \r\n          \r\n            //create manually the mapping form (detached)\r\n            var $form = $(mappingFormTpl({\r\n                identifier          : choice.id(),\r\n                correctDefined      : answerStateHelper.isCorrectDefined(widget),\r\n                correct             : _.contains(response.getCorrect(), choice.id()),\r\n                score               : score,\r\n                scoreMin            : response.getMappingAttribute('lowerBound'),\r\n                scoreMax            : response.getMappingAttribute('upperBound')\r\n            }));\r\n\r\n            //set up the form data binding\r\n            formElement.setChangeCallbacks($form, response, {\r\n                score : function(response, value){\r\n                    var scoreText = scoreTexts[choice.serial];\r\n                    if(value === ''){\r\n                        response.removeMapEntry(choice.id());\r\n                        scoreText.attr({text : response.mappingAttributes.defaultValue})\r\n                                 .data('default', true);\r\n                    } else {\r\n                        response.setMapEntry(choice.id(), value, true);\r\n                        scoreText.attr({text : value})\r\n                                 .data('default', false);\r\n                    }\r\n                }, \r\n                correct : function(response, value){\r\n                    if(value === true){\r\n                        if(!_.contains(corrects, choice.id())){\r\n                            corrects.push(choice.id());\r\n                            shape.active = true;\r\n                            graphicHelper.updateElementState(shape, 'active');\r\n                        }\r\n                    } else {\r\n                        corrects = _.without(corrects, choice.id());\r\n                        shape.active = false;\r\n                        graphicHelper.updateElementState(shape, 'basic');\r\n                    }\r\n                    response.setCorrect(corrects);\r\n                }\r\n            });\r\n\r\n            shape.click(function(){\r\n                $('.mapping-editor', $container).hide();\r\n                $popup.show();\r\n            });\r\n\r\n            $popup.append($form);\r\n        });\r\n\r\n        //set up ui components used by the form\r\n        deleter($container);\r\n        tooltipster($container);\r\n        \r\n        interaction.paper.getById('bg-image-' + interaction.serial).click(function(){\r\n            $('.mapping-editor', $container).hide();\r\n        });\r\n        \r\n        //the click on the cross hides the popup\r\n        $('.mapping-editor', $container).on('click', '.closer', function(){\r\n            $(this).parent('.mapping-editor').hide();\r\n        });\r\n\r\n        //update the elements on attribute changes\r\n        widget.on('mappingAttributeChange', function(data){\r\n            if(data.key === 'defaultValue'){\r\n                _.forEach(scoreTexts, function(scoreText){\r\n                    if(scoreText.data('default') === true){\r\n                        scoreText.attr({text : data.value });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * The map answer state for the hotspot interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Map\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Map\r\n     */\r\n    return  stateFactory.create(Map, initMapState, exitMapState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/Map'\r\n], function(factory, states){\r\n\r\n    'use strict';\r\n\r\n    //creates a state bundle for the interaction\r\n    return factory.createBundle(states, arguments);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/Widget',[\r\n    'jquery', 'lodash', 'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/states/states'\r\n], function($, _, __, Widget, GraphicWidget, states){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * The Widget that provides components used by the QTI Creator for the Hotspot Interaction\r\n     *\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/Widget\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/GraphicInteraction/Widget\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/Widget\r\n     */      \r\n    var HotspotInteractionWidget = _.extend(Widget.clone(), GraphicWidget, {\r\n\r\n        /**\r\n         * Initialize the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/interactions/Widget#initCreator}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        initCreator : function(options){\r\n            var paper;\r\n            this.baseUrl = options.baseUrl;\r\n            this.choiceForm = options.choiceForm;\r\n            \r\n            this.registerStates(states);\r\n            \r\n            //call parent initCreator\r\n            Widget.initCreator.call(this);\r\n          \r\n            paper = this.createPaper(); \r\n            if(paper){\r\n                this.element.paper = paper;\r\n                this.createChoices();    \r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gracefull destroy the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/Widget#destroy}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        destroy : function(){\r\n\r\n            var $container = this.$original;\r\n            var $item      = $container.parents('.qti-item');\r\n\r\n            //stop listening the resize\r\n            $item.off('resize.gridEdit.' + this.element.serial);\r\n            $(window).off('resize.qti-widget.' + this.element.serial);\r\n            $container.off('resize.qti-widget.' + this.element.serial);\r\n\r\n            //call parent destroy\r\n            Widget.destroy.call(this);\r\n        }\r\n\r\n   });\r\n\r\n    return HotspotInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/HotspotInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hotspotInteraction/Widget'\r\n], function(_, HotspotInteraction, HotspotInteractionWidget){\r\n    'use strict';\r\n\r\n    /**\r\n     * The CreatorHotspotInteraction  Renderer\r\n     * @extends taoQtiItem/qtiCommonRenderer/renderers/interactions/HotspotInteraction\r\n     * @exports taoQtiItem/qtiCreator/renderers/interactions/HotspotInteraction\r\n     */\r\n    var CreatorHotspotInteraction = _.clone(HotspotInteraction);\r\n\r\n    /**\r\n     * Render the interaction for authoring.\r\n     * It delegates the rendering to the widget layer.\r\n     * @param {Object} interaction - the model\r\n     * @param {Object} [options] - extra options\r\n     */\r\n    CreatorHotspotInteraction.render = function(interaction, options){\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.choiceForm = this.getOption('choiceOptionForm');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        HotspotInteractionWidget.build(\r\n            interaction,\r\n            HotspotInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorHotspotInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/hottextInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-hottextInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"hottextInteraction\\\">\\r\\n  \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n  <div class=\\\"instruction-container\\\"></div>\\r\\n  <div class=\\\"qti-flow-container\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/hottextInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function($, _, __, tpl, containerHelper, instructionMgr, pciResponse){\r\n    'use strict';\r\n\r\n    /**\r\n     * 'pseudo-label' is technically a div that behaves like a label.\r\n     * This allows the usage of block elements inside the fake label\r\n     */\r\n    var pseudoLabel = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        var setChoice = function($choice, interaction){\r\n            var $inupt = $choice.find('input');\r\n\r\n            if($inupt.prop('checked') || $inupt.hasClass('disabled')){\r\n                $inupt.prop('checked', false);\r\n            }else{\r\n                var maxChoices = parseInt(interaction.attr('maxChoices'));\r\n                var currentChoices = _.values(_getRawResponse(interaction)).length;\r\n\r\n                if(currentChoices < maxChoices || maxChoices === 0){\r\n                    $inupt.prop('checked', true);\r\n                }\r\n            }\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n            instructionMgr.validateInstructions(interaction, {choice : $choice});\r\n        };\r\n\r\n        $('.hottext', $container).on('click', function(e){\r\n            e.preventDefault();\r\n            setChoice($(this), interaction);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10278\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function(interaction){\r\n        pseudoLabel(interaction);\r\n\r\n        //set up the constraints instructions\r\n        instructionMgr.minMaxChoiceInstructions(interaction, {\r\n            min: interaction.attr('minChoices'),\r\n            max: interaction.attr('maxChoices'),\r\n            getResponse : _getRawResponse,\r\n            onError : function(data){\r\n                var $input, $choice, $icon;\r\n                if(data.choice && data.choice.length){\r\n                    $choice = data.choice.addClass('error');\r\n                    $input  = $choice.find('input');\r\n                    $icon   = $choice.find(' > label > span').addClass('error cross');\r\n\r\n\r\n                    setTimeout(function(){\r\n                        $input.prop('checked', false);\r\n                        $choice.removeClass('error');\r\n                        $icon.removeClass('error cross');\r\n                    }, 350);\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    var resetResponse = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        $('input', $container).prop('checked', false);\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        try{\r\n            _.each(pciResponse.unserialize(response, interaction), function(identifier){\r\n                $container.find('input[value=' + identifier + ']').prop('checked', true);\r\n            });\r\n            instructionMgr.validateInstructions(interaction);\r\n        }catch(e){\r\n            throw new Error('wrong response format in argument : ' + e);\r\n        }\r\n    };\r\n\r\n    var _getRawResponse = function(interaction){\r\n        var values = [];\r\n        var $container = containerHelper.get(interaction);\r\n        $('input:checked', $container).each(function(){\r\n            values.push($(this).val());\r\n        });\r\n        return values;\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        return pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //restore selected choices:\r\n        $container.find('.hottext').off('click');\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n\r\n    return {\r\n        qtiClass : 'hottextInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/hottext', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed choices\", options) : helperMissing.call(depth0, \"__\", \"Allowed choices\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div>\\r\\n        <label for=\\\"minChoices\\\" class=\\\"spinner\\\">Min</label>\\r\\n        <input name=\\\"minChoices\\\" value=\\\"\";\n  if (helper = helpers.minChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.minChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices that the candidate is required to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices that the candidate is required to select to form a valid response.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n    <div>\\r\\n        <label for=\\\"maxChoices\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max\", options) : helperMissing.call(depth0, \"__\", \"Max\", options)))\n    + \"</label>\\r\\n        <input name=\\\"maxChoices\\\" value=\\\"\";\n  if (helper = helpers.maxChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.choicesCount) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choicesCount); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n            <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices that the candidate is allowed to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices that the candidate is allowed to select to form a valid response.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/hottext-create', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"rgt tlb-button\\\" title=\\\"\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Create hottext\", options) : helperMissing.call(depth0, \"__\", \"Create hottext\", options)))\n    + \"\\\" data-role=\\\"create-hottext\\\">\\r\\n    <span class=\\\"icon-magicwand\\\"></span>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/content',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/selectionWrapper',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/hottext',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/htmlEditorTrigger',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/hottext-create'\r\n], function(\r\n    $,\r\n    _,\r\n    stateFactory,\r\n    Question,\r\n    htmlEditor,\r\n    gridContentHelper,\r\n    htmlContentHelper,\r\n    formElement,\r\n    interactionFormElement,\r\n    selectionWrapper,\r\n    formTpl,\r\n    toolbarTpl,\r\n    newHottextBtnTpl\r\n){\r\n    'use strict';\r\n\r\n    var HottextInteractionStateQuestion = stateFactory.extend(Question, function(){\r\n        this.buildEditor();\r\n    }, function(){\r\n        this.destroyEditor();\r\n    });\r\n\r\n    HottextInteractionStateQuestion.prototype.buildEditor = function buildEditor(){\r\n\r\n        var self = this,\r\n            _widget = this.widget,\r\n            container = _widget.element.getBody(),\r\n            $container = _widget.$container,\r\n            $editableContainer = $container.find('.qti-flow-container'),\r\n            $bodyTlb;\r\n\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n            $bodyTlb = $(toolbarTpl({\r\n                serial : _widget.serial,\r\n                state : 'question'\r\n            }));\r\n\r\n            //add toolbar once only:\r\n            $editableContainer.append($bodyTlb);\r\n            $bodyTlb.show();\r\n\r\n            //init hot text creator\r\n            self.initHottextCreator();\r\n\r\n            //create editor\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                shieldInnerContent : false,\r\n                change : gridContentHelper.getChangeCallbackForBlockStatic(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _widget\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    HottextInteractionStateQuestion.prototype.destroyEditor = function destroyEditor(){\r\n        var $container = this.widget.$container,\r\n            $flowContainer = $container.find('.qti-flow-container'),\r\n            $editable      = $container.find('.qti-flow-container [data-html-editable]');\r\n\r\n        $editable.off('hottextcreator');\r\n\r\n        //search and destroy the editor\r\n        htmlEditor.destroyEditor($flowContainer);\r\n\r\n        //remove toolbar\r\n        $flowContainer.find('.mini-tlb[data-role=cke-launcher-tlb]').remove();\r\n    };\r\n\r\n    HottextInteractionStateQuestion.prototype.initForm = function initForm(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            interaction = _widget.element,\r\n            callbacks;\r\n\r\n        $form.html(formTpl({\r\n            maxChoices : interaction.attr('maxChoices'),\r\n            minChoices : interaction.attr('minChoices'),\r\n            choicesCount : _.size(interaction.getChoices())\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        callbacks = formElement.getMinMaxAttributeCallbacks($form, 'minChoices', 'maxChoices');\r\n        formElement.setChangeCallbacks($form, interaction, callbacks);\r\n        interactionFormElement.syncMaxChoices(_widget);\r\n    };\r\n\r\n    /**\r\n     * Add the button that allow to create hottext when a selection is made\r\n     */\r\n    HottextInteractionStateQuestion.prototype.initHottextCreator = function initHottextCreator(){\r\n        var self = this,\r\n            interactionWidget = this.widget,\r\n\r\n            $editable       = interactionWidget.$container.find('.qti-flow-container [data-html-editable]'),\r\n            $flowContainer  = interactionWidget.$container.find('.qti-flow-container'),\r\n            $toolbar        = $flowContainer.find('.mini-tlb[data-role=cke-launcher-tlb]'),\r\n            $newHottextBtn  = $(newHottextBtnTpl()),\r\n            $newHottext     = $('<span>', {\r\n                class: 'widget-box',\r\n                'data-new': true,\r\n                'data-qti-class': 'hottext'\r\n            }),\r\n\r\n            wrapper = selectionWrapper({\r\n                $container: $editable,\r\n                allowQtiElements: false\r\n            });\r\n\r\n        $toolbar.append($newHottextBtn);\r\n        $newHottextBtn.hide();\r\n\r\n        $editable\r\n            .on('mouseup.hottextcreator', function() {\r\n                if (wrapper.canWrap()) {\r\n                    $newHottextBtn.show();\r\n                } else {\r\n                    $newHottextBtn.hide();\r\n                }\r\n            })\r\n            .on('blur.hottextcreator', function() {\r\n                $newHottextBtn.hide();\r\n            });\r\n\r\n        $newHottextBtn.on('mousedown.hottextcreator', function() {\r\n            $newHottextBtn.hide();\r\n            if (wrapper.wrapWith($newHottext)) {\r\n                self.createNewHottext($newHottext.clone());\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Create a new hottext\r\n     * @param $hottextContent - content of the hottext. May contain plain text or qti inline static elements\r\n     */\r\n    HottextInteractionStateQuestion.prototype.createNewHottext = function createNewHottext($hottextContent) {\r\n        var interactionWidget = this.widget,\r\n            interaction = interactionWidget.element,\r\n\r\n            $editable = interactionWidget.$container.find('.qti-flow-container [data-html-editable]'),\r\n\r\n            $inlineStaticWidgets,\r\n            allowedInlineStaticElts = ['math'], // support for more inline static elements (img...) can be added here\r\n            newHottextElt,\r\n            newHottextBody;\r\n\r\n        htmlContentHelper.createElements(interaction.getBody(), $editable, htmlEditor.getData($editable), function (newHottextWidget) {\r\n\r\n            newHottextElt = newHottextWidget.element;\r\n\r\n            // look for nested inlineStatic elements\r\n            $inlineStaticWidgets = $hottextContent.find(\r\n                allowedInlineStaticElts\r\n                    .map(function(qtiClass) {\r\n                        return '.widget-' + qtiClass;\r\n                    })\r\n                    .join(',')\r\n            );\r\n\r\n            // update elements hierarchy\r\n            if($inlineStaticWidgets && $inlineStaticWidgets.length > 0) {\r\n                $inlineStaticWidgets.each(function() {\r\n                    var serial = $(this).data('serial'),\r\n                        elt = interaction.getElement(serial),\r\n                        eltWidget = elt.data('widget');\r\n\r\n                    // move element from interaction to hottext element\r\n                    interaction.removeElement(elt);\r\n                    newHottextElt.setElement(elt);\r\n\r\n                    // destroy the widget and replace it with a placeholder that will be used for rendering\r\n                    $(this).replaceWith(elt.placeholder());\r\n                    eltWidget.destroy();\r\n                });\r\n            }\r\n            // strip everything that hasn't been replaced and that is not pure text\r\n            newHottextBody = _.escape($hottextContent.text());\r\n\r\n            if (newHottextBody.trim() !== '') {\r\n                // update model and render it inline\r\n                newHottextElt.body(newHottextBody);\r\n                newHottextElt.render(newHottextElt.getContainer());\r\n                newHottextElt.postRender();\r\n\r\n                // recreate editing widget\r\n                newHottextWidget.destroy();\r\n                newHottextWidget = newHottextElt.data('widget');\r\n                newHottextWidget.changeState('choice');\r\n            }\r\n        });\r\n    };\r\n\r\n    return HottextInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Correct',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function(_, __, stateFactory, Correct, commonRenderer, instructionMgr, PciResponse){\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state: use the common renderer to set the correct response.\r\n     */\r\n    function initCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n\r\n        //enable the checkbox to enable user selection\r\n        this.widget.$original.find('.hottext-checkmark > input').removeProp('disabled');\r\n\r\n        //really need to destroy before ?\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please select the correct hottext choices below.'));\r\n        \r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n\r\n        commonRenderer.setResponse(interaction, PciResponse.serialize(_.values(response.getCorrect()), interaction));\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            response.setCorrect(PciResponse.unserialize(data.response, interaction));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Exit the correct state\r\n     */\r\n    function exitCorrectState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n\r\n        //always restore the checkbox to readonly before leaving the state\r\n        this.widget.$original.find('.hottext-checkmark > input').prop('disabled', 'disabled');\r\n\r\n        //stop listening responses changes\r\n        widget.$container.off('responseChange.qti-widget');\r\n\r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n        instructionMgr.removeInstructions(interaction);\r\n    }\r\n\r\n    /**\r\n     * The correct answer state for the hottext interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Correct\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Correct\r\n     */\r\n    return stateFactory.create(Correct, initCorrectState, exitCorrectState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Map',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function($, _, __, stateFactory, Map, commonRenderer, answerStateHelper, instructionMgr, formElement, PciResponse){\r\n    'use strict';\r\n\r\n    /**\r\n     * Initialize the state.\r\n     */\r\n    function initMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var corrects  = _.values(response.getCorrect());\r\n        \r\n        //really need to destroy before ?\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please enter the score for the given hottexts.'));\r\n        \r\n        //set the current mapping mode, needed by the common renderer\r\n        interaction.responseMappingMode = true;\r\n \r\n        //must be done prior to the render to override clicks\r\n        createScoreForm(interaction, widget.$container);\r\n\r\n        //use the common Renderer\r\n        commonRenderer.render.call(interaction.getRenderer(), interaction);\r\n\r\n        commonRenderer.setResponse(interaction, PciResponse.serialize(corrects, interaction));\r\n\r\n        //each response change leads to an update of the scoring form\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            var type  = response.attr('cardinality') === 'single' ? 'base' : 'list';\r\n            if(data && data.response &&  data.response[type]){\r\n                response.setCorrect(data.response[type].identifier);\r\n            }\r\n        });\r\n\r\n       //change the correct state \r\n       widget.on('metaChange', function(meta){\r\n            if(meta.key === 'defineCorrect'){\r\n                toggleCorrectState(widget.$container, meta.value);\r\n                if(meta.value === false){\r\n                    response.setCorrect([]);\r\n                }\r\n            }\r\n        });\r\n        toggleCorrectState(widget.$container, answerStateHelper.defineCorrect(response));\r\n    }\r\n\r\n    /**\r\n     * Exit the map state\r\n     */\r\n    function exitMapState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var $container  = widget.$container;\r\n\r\n        $container.off('responseChange.qti-widget');\r\n\r\n        $('.score', $container).remove();\r\n\r\n        toggleCorrectState($container, true);\r\n\r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction);\r\n        commonRenderer.destroy(interaction);\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //always restore the checkbox to readonly before leaving the state\r\n        this.widget.$original.find('.hottext-checkmark > input').prop('disabled', 'disabled');\r\n    }\r\n\r\n    function toggleCorrectState($container, enable){\r\n        if(enable){\r\n            $('.hottext-checkmark > input', $container)\r\n                .removeProp('disabled')\r\n                .removeClass('disabled');\r\n        } else {\r\n            $('.hottext-checkmark > input', $container)\r\n                .prop('disabled', true)\r\n                .prop('checked', false)\r\n                .addClass('disabled');\r\n        }\r\n    }\r\n\r\n    function createScoreForm(interaction, $container){\r\n        var callbacks = {};\r\n        var response = interaction.getResponseDeclaration();\r\n        var mapEntries = response.getMapEntries();\r\n\r\n        //do not trigger the responseChange in the score field\r\n        $('.hottext', $container).on('click', function(e){\r\n            if($(e.target).hasClass('score') || answerStateHelper.defineCorrect(response) === false){\r\n                e.preventDefault();\r\n                e.stopImmediatePropagation();\r\n            }\r\n        });\r\n\r\n        _.forEach(interaction.getChoices(), function(choice){\r\n            var $score;\r\n            var id = choice.serial + '-score';\r\n            var $hottext = $('[data-serial=\"' + choice.serial + '\"]', $container);\r\n            if($hottext.length){\r\n    \r\n                $score = $(\"<input type='text' name='\" + id + \"' class='score' title='\" + __('Score value') + \"' data-validate='$numeric' data-validate-option='$allowEmpty; $event(type=keyup)' />\"); \r\n                $score.val(mapEntries[choice.id()] !== undefined ? mapEntries[choice.id()] : response.mappingAttributes.defaultValue);\r\n                $hottext.append($score);\r\n                \r\n\r\n                callbacks[id] = function(res, value){\r\n                    if(value === ''){\r\n                        res.removeMapEntry(choice.id());\r\n                    } else {\r\n                        res.setMapEntry(choice.id(), value, true);\r\n                    }\r\n                };\r\n            }\r\n        });\r\n        formElement.setChangeCallbacks($container, response, callbacks);\r\n    }\r\n\r\n\r\n    /**\r\n     * The map answer state for the HottextInteraction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Map\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Map\r\n     */\r\n    return  stateFactory.create(Map, initMapState, exitMapState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/Map'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/states/states'\r\n], function(Widget, states){\r\n\r\n    var HottextInteractionWidget = Widget.clone();\r\n\r\n    HottextInteractionWidget.initCreator = function(){\r\n        \r\n        this.registerStates(states);\r\n        \r\n        Widget.initCreator.call(this);\r\n    };\r\n    \r\n    return HottextInteractionWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/HottextInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/HottextInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/hottextInteraction/Widget'\r\n], function(_, HottextInteraction, HottextInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorHottextInteraction = _.clone(HottextInteraction);\r\n\r\n    CreatorHottextInteraction.render = function(interaction, options){\r\n\r\n        HottextInteractionWidget.build(\r\n            interaction,\r\n            HottextInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorHottextInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/inlineChoiceInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<select \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-inlineInteraction qti-inlineChoiceInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"\\r\\n        data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n        data-qti-class=\\\"inlineChoiceInteraction\\\"\\r\\n        data-has-search=\\\"false\\\">\\r\\n    <option></option>                \\r\\n    <option value=\\\"empty\\\"></option>\\r\\n    \";\n  options={hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</select>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/inlineChoiceInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'select2',\r\n    'ui/tooltip'\r\n], function($, _, __, tpl, containerHelper, instructionMgr, pciResponse){\r\n    'use strict';\r\n\r\n    /**\r\n     * The value of the \"empty\" option\r\n     * @type String\r\n     */\r\n    var _emptyValue = 'empty';\r\n\r\n    var _defaultOptions = {\r\n        allowEmpty:true,\r\n        placeholderText:__('select a choice')\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function(interaction, options){\r\n\r\n        var opts = _.clone(_defaultOptions),\r\n            required = !!interaction.attr('required');\r\n        _.extend(opts, options);\r\n\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        if(opts.allowEmpty && !required){\r\n            $container.find('option[value=' + _emptyValue + ']').text('--- ' + __('leave empty') + ' ---');\r\n        }else{\r\n            $container.find('option[value=' + _emptyValue + ']').remove();\r\n        }\r\n\r\n        $container.select2({\r\n            width : 'element',\r\n            placeholder : opts.placeholderText,\r\n            minimumResultsForSearch : -1,\r\n            dropdownCssClass  : 'qti-inlineChoiceInteraction-dropdown'\r\n        });\r\n\r\n        var $el = $container.select2('container');\r\n\r\n        _setInstructions(interaction);\r\n\r\n        $container.on('change', function(){\r\n\r\n            if(required && $container.val() !== \"\") {\r\n                $el.qtip('hide');\r\n            }\r\n\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n\r\n        }).on('select2-open', function(){\r\n            if(required){\r\n                $el.qtip('hide');\r\n            }\r\n        }).on('select2-close', function(){\r\n            if(required && $container.val() === \"\") {\r\n                $el.qtip('show');\r\n            }\r\n        });\r\n    };\r\n\r\n    var _setInstructions = function(interaction){\r\n\r\n        var required = !!interaction.attr('required'),\r\n            $container = interaction.getContainer(),\r\n            $el = $container.select2('container');\r\n\r\n        if(required){\r\n            //set up the tooltip plugin for the input\r\n            $el.qtip({\r\n                theme : 'warning',\r\n                content: {\r\n                    text: __('A choice must be selected')\r\n                }\r\n            });\r\n\r\n            if($container.val() === \"\") {\r\n                $el.qtip('show');\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    var resetResponse = function(interaction){\r\n        _setVal(interaction, _emptyValue);\r\n    };\r\n\r\n    var _setVal = function(interaction, choiceIdentifier){\r\n\r\n        containerHelper.get(interaction)\r\n            .val(choiceIdentifier)\r\n            .select2('val', choiceIdentifier);\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n\r\n         _setVal(interaction, pciResponse.unserialize(response, interaction)[0]);\r\n    };\r\n\r\n    var _getRawResponse = function(interaction){\r\n        var value = containerHelper.get(interaction).val();\r\n        return (value && value !== _emptyValue) ? [value] : [];\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        return pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n     /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //remove event\r\n        $(document).off('.commonRenderer');\r\n\r\n        $container.select2('destroy');\r\n\r\n        //remove instructions\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        var $container;\r\n\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n\r\n            //restore order of previously shuffled choices\r\n            if(_.isArray(state.order) && state.order.length === _.size(interaction.getChoices())){\r\n\r\n                $container = containerHelper.get(interaction);\r\n\r\n                //just in case the dropdown is opened\r\n                $container.select2('disable')\r\n                          .select2('close');\r\n\r\n                $('option[data-identifier]', $container)\r\n                    .sort(function(a, b){\r\n                        var aIndex = _.indexOf(state.order, $(a).data('identifier'));\r\n                        var bIndex = _.indexOf(state.order, $(b).data('identifier'));\r\n                        if(aIndex > bIndex) {\r\n                            return 1;\r\n                        }\r\n                        if(aIndex < bIndex) {\r\n                            return -1;\r\n                        }\r\n                        return 0;\r\n                    })\r\n                    .detach()\r\n                    .appendTo($container);\r\n\r\n                $container.select2('enable');\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n\r\n        //we store also the choice order if shuffled\r\n        if(interaction.attr('shuffle') === true){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            state.order = [];\r\n            $('option[data-identifier]', $container).each(function(){\r\n               state.order.push($(this).data('identifier'));\r\n            });\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the inline choice interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'inlineChoiceInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/inlineChoice/states/Question',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/choices/helpers/formElement',\r\n    'lodash'\r\n], function($, stateFactory, QuestionState, formElement, _){\r\n    'use strict';\r\n\r\n    var ChoiceStateQuestion = stateFactory.extend(QuestionState, function initStateQuestion(){\r\n        this.buildEditor();\r\n    }, function exitStateQuestion(){\r\n        this.destroyEditor();\r\n    });\r\n\r\n    ChoiceStateQuestion.prototype.createToolbar = function(){\r\n\r\n        var _widget = this.widget,\r\n            $toolbar = _widget.$container.find('td:last');\r\n\r\n        //set toolbar button behaviour:\r\n        formElement.initShufflePinToggle(_widget);\r\n        formElement.initDelete(_widget);\r\n\r\n        return $toolbar;\r\n    };\r\n\r\n    ChoiceStateQuestion.prototype.buildEditor = function(){\r\n\r\n        var _widget = this.widget;\r\n\r\n        _widget.$container.find('.editable-content')\r\n            .attr('contentEditable', true)\r\n            .on('keyup.qti-widget', _.throttle(function(){\r\n\r\n                //update model\r\n                _widget.element.val(_.escape($(this).text()));\r\n\r\n                //update placeholder\r\n                _widget.$original.width($(this).width());\r\n\r\n            }, 200)).on('focus.qti-widget', function(){\r\n\r\n                _widget.changeState('choice');\r\n\r\n            }).on('keypress.qti-widget', function(e){\r\n\r\n                if(e.which === 13){\r\n                    e.preventDefault();\r\n                    $(this).blur();\r\n                    _widget.changeState('question');\r\n                }\r\n\r\n            });\r\n    };\r\n\r\n    ChoiceStateQuestion.prototype.destroyEditor = function(){\r\n\r\n        this.widget.$container.find('.editable-content')\r\n            .removeAttr('contentEditable')\r\n            .off('keyup.qti-widget');\r\n    };\r\n\r\n    return ChoiceStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/choices/inlineChoice/states/Choice',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/Choice',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/choices/choice',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/identifier'\r\n], function(stateFactory, Choice, formTpl, formElement, identifierHelper){\r\n    \r\n    var InlineChoiceStateChoice = stateFactory.extend(Choice);\r\n\r\n    InlineChoiceStateChoice.prototype.initForm = function(){\r\n        \r\n        var _widget = this.widget;\r\n        \r\n        //build form:\r\n        _widget.$form.html(formTpl({\r\n            serial:_widget.element.getSerial(),\r\n            identifier:_widget.element.id()\r\n        }));\r\n        \r\n        //init data validation and binding\r\n        formElement.setChangeCallbacks(_widget.$form, _widget.element, {\r\n            identifier : identifierHelper.updateChoiceIdentifier\r\n        });\r\n    };\r\n    \r\n    return InlineChoiceStateChoice;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/inlineChoice/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/choices/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/choices/inlineChoice/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/choices/inlineChoice/states/Choice'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/choices/inlineChoice/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/choices/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/choices/inlineChoice/states/states'\r\n], function(Widget, states){\r\n\r\n    var InlineChoiceWidget = Widget.clone();\r\n\r\n    InlineChoiceWidget.initCreator = function(){\r\n        \r\n        Widget.initCreator.call(this);\r\n\r\n        this.registerStates(states);\r\n    };\r\n\r\n    return InlineChoiceWidget;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/inlineChoice', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, self=this, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"shuffle\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.shuffle), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Shuffle choices\", options) : helperMissing.call(depth0, \"__\", \"Shuffle choices\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be “shuffled” of “fixed” individually.\", options) : helperMissing.call(depth0, \"__\", \"If the shuffle attribute is true then the delivery engine will randomize the order in which the choices are initially presented.\\r\\n        However each choice may be “shuffled” of “fixed” individually.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"required\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.required), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"required\", options) : helperMissing.call(depth0, \"__\", \"required\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Define whether a choice must be selected by the candidate in order to form a valid response to the interaction.\", options) : helperMissing.call(depth0, \"__\", \"Define whether a choice must be selected by the candidate in order to form a valid response to the interaction.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Question',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/inlineChoice'\r\n], function($, stateFactory, Question, formElement, formTpl){\r\n\r\n    var InlineChoiceInteractionStateQuestion = stateFactory.extend(Question, function(){\r\n\r\n        var $mainOption = this.widget.$container.find('.main-option'),\r\n            $original = this.widget.$original;\r\n        \r\n        //listener to children choice widget change and update the original interaction placeholder\r\n        $(document).on('choiceTextChange.qti-widget.question', function(){\r\n            $original.width($mainOption.width());\r\n        });\r\n\r\n    }, function(){\r\n        \r\n        $(document).off('.qti-widget.question');\r\n    });\r\n\r\n    InlineChoiceInteractionStateQuestion.prototype.addNewChoiceButton = function(){\r\n\r\n        var _widget = this.widget,\r\n            $addChoice = _widget.$container.find('.add-option'),\r\n            interaction = _widget.element;\r\n\r\n        //init add choice button once only\r\n        if(!$addChoice.data('initialized')){\r\n\r\n            $addChoice.on('click.qti-widget', function(e){\r\n\r\n                e.stopPropagation();\r\n\r\n                //add a new choice\r\n                var choice = interaction.createChoice();\r\n\r\n                //append render choice:\r\n                $(this).closest('tr').before(_widget.renderChoice(choice));\r\n                _widget.buildChoice(choice, {\r\n                    ready : function(widget){\r\n                        //transition state directly back to \"question\"\r\n                        widget.changeState('question');\r\n                    }\r\n                });\r\n            });\r\n\r\n            //set button as initialized\r\n            $addChoice.data('initialized', true);\r\n        }\r\n    };\r\n\r\n    InlineChoiceInteractionStateQuestion.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            interaction = _widget.element;\r\n\r\n        $form.html(formTpl({\r\n            shuffle : !!interaction.attr('shuffle'),\r\n            required : !!interaction.attr('required')\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        formElement.setChangeCallbacks($form, interaction, {\r\n            shuffle : formElement.getAttributeChangeCallback(),\r\n            required : formElement.getAttributeChangeCallback()\r\n        });\r\n    };\r\n\r\n    return InlineChoiceInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/ResponseWidget',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Renderer',\r\n], function($, _, __, CommonRenderer){\r\n    'use strict';\r\n\r\n    var ResponseWidget = {\r\n        create : function(widget, callback){\r\n\r\n            var self = this;\r\n            var interaction = widget.element;\r\n            var $placeholder = $('<select>');\r\n            var $responseWidget = widget.$container.find('.widget-response').append($placeholder);\r\n\r\n            //the common renderer is tweaked to render the response selection\r\n            this.commonRenderer = new CommonRenderer({\r\n                shuffleChoices : false,\r\n                themes : false\r\n            });\r\n\r\n            this.commonRenderer.load(function(){\r\n\r\n                interaction.render({}, $placeholder, '', this);\r\n                interaction.postRender({\r\n                    allowEmpty : false,\r\n                    placeholderText : __('select correct choice')\r\n                }, '', this);\r\n\r\n                callback.call(self, this);\r\n\r\n                $responseWidget.siblings('.padding').width($responseWidget.width() + 50);//plus icons width\r\n\r\n            }, ['inlineChoice', 'inlineChoiceInteraction']);\r\n\r\n        },\r\n        setResponse : function(widget, response){\r\n            this.commonRenderer.setResponse(widget.element, this.formatResponse(response));\r\n        },\r\n        destroy : function(widget){\r\n            widget.$container.find('.widget-response').empty();\r\n            widget.$container.find('.padding').removeAttr('style');\r\n        },\r\n        formatResponse : function(response){\r\n            if(!_.isString(response)){\r\n                response = _.values(response);\r\n                if(response && response.length){\r\n                    response = response[0];\r\n                }\r\n            }\r\n            return {base : {identifier : response}};\r\n        },\r\n        unformatResponse : function(formatedResponse){\r\n\r\n            var response = [];\r\n\r\n            if(formatedResponse.base && formatedResponse.base.identifier){\r\n                response.push(formatedResponse.base.identifier);\r\n            }\r\n            return response;\r\n        }\r\n    };\r\n\r\n    return ResponseWidget;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Correct',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/ResponseWidget',\r\n    'lodash'\r\n], function(stateFactory, Correct, responseWidget, _){\r\n\r\n    var InlineChoiceInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n        \r\n        var _widget = this.widget,\r\n            response = this.widget.element.getResponseDeclaration();\r\n            \r\n            _widget.$container.find('table').hide();\r\n            \r\n            //render commonRenderer.render()\r\n            responseWidget.create(_widget, function(){\r\n               \r\n                //set response\r\n                responseWidget.setResponse(_widget, _.values(response.getCorrect()));\r\n\r\n                //save correct response on change\r\n                _widget.$container.on('responseChange.qti-widget', function(e, data){\r\n                    response.setCorrect(responseWidget.unformatResponse(data.response));\r\n                });\r\n            });\r\n\r\n    }, function(){\r\n        \r\n        var $container = this.widget.$container;\r\n        $container.find('table').show();\r\n        $container.off('responseChange.qti-widget');\r\n        \r\n        responseWidget.destroy(this.widget);\r\n    });\r\n\r\n    return InlineChoiceInteractionStateCorrect;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Map',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiItem/helper/interactionHelper',\r\n    'lodash',\r\n], function($, stateFactory, Map, formElement, interactionHelper, _){\r\n\r\n    var AssociateInteractionStateCorrect = stateFactory.create(Map, function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = _widget.$container,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        $container.find('[data-edit=map]').show();\r\n\r\n        //init correct response radio group:\r\n        var correct = _.values(response.getCorrect());\r\n        if(correct.length){\r\n            var selectedChoice = interaction.getChoiceByIdentifier(correct.pop());\r\n            if(selectedChoice){\r\n                $container.find('input[name=correct][value=\"' + selectedChoice.serial + '\"]').prop('checked', true);\r\n            }\r\n        }\r\n\r\n        formElement.setChangeCallbacks($container, response, {\r\n            correct : function(response, value){\r\n                response.setCorrect(interactionHelper.serialToIdentifier(interaction, value));\r\n            },\r\n            score : function(response, value){\r\n                var score = parseFloat(value);\r\n                if(!isNaN(score)){\r\n                    response.setMapEntry(interactionHelper.serialToIdentifier(interaction, $(this).data('for')), score);\r\n                }\r\n            }\r\n        });\r\n\r\n    }, function(){\r\n\r\n    });\r\n\r\n\r\n    return AssociateInteractionStateCorrect;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/NoRp',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/NoRp'\r\n], function(stateFactory, NoRp){\r\n    'use strict';\r\n\r\n    return stateFactory.extend(NoRp, function initStateNoRp(){\r\n\r\n        this.widget.$container.find('.qti-choice').hide();\r\n\r\n    }, function exitStateNoRp(){\r\n\r\n        this.widget.$container.find('.qti-choice').show();\r\n    });\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/NoRp'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/inlineChoiceInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div class=\\\"widget-box widget-inline widget-inlineChoiceInteraction\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-edit=\\\"active\\\">\\r\\n    <div class=\\\"qti-interaction qti-inlineChoiceInteraction\\\">\\r\\n        <table>\\r\\n            <colgroup>\\r\\n                <col class=\\\"text\\\">\\r\\n                <col class=\\\"icon\\\">\\r\\n                <col class=\\\"icon\\\">\\r\\n            </colgroup>\\r\\n            <tbody>\\r\\n                <tr>\\r\\n                    <td class=\\\"main-option\\\"><div>-- \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"edit choices\", options) : helperMissing.call(depth0, \"__\", \"edit choices\", options)))\n    + \" --<span class=\\\"icon-down\\\"></span></div></td>\\r\\n                    <td class=\\\"icon-title\\\" data-edit=\\\"map\\\">correct</td>\\r\\n                    <td class=\\\"icon-title\\\" data-edit=\\\"map\\\">score</td>\\r\\n                </tr>\\r\\n                \";\n  options={hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n                <tr data-edit=\\\"question\\\">\\r\\n                    <td>\\r\\n                        <div class=\\\"add-option\\\">\\r\\n                            <span class=\\\"icon-add\\\"></span>\\r\\n                            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add choice\", options) : helperMissing.call(depth0, \"__\", \"Add choice\", options)))\n    + \"\\r\\n                        </div>\\r\\n                    </td>\\r\\n                    <td colspan=\\\"2\\\"></td>\\r\\n                </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n        <div>\\r\\n            <div class=\\\"widget-response\\\" data-edit=\\\"correct\\\"></div>\\r\\n            <div class=\\\"padding\\\"></div>\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/inlineChoice', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"pin\";\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"shuffle\";\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  \n  return \"display:none;\";\n  }\n\n  buffer += \"<tr class=\\\"widget-box widget-inlineChoice qti-choice\\\" data-edit=\\\"active\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <td class=\\\"option\\\"><div class=\\\"editable-content\\\" contenteditable=\\\"true\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</div></td>\\r\\n    <td class=\\\"mini-tlb\\\">\\r\\n        <span data-edit=\\\"question\\\" class=\\\"tlb-button\\\">\\r\\n            <span  class=\\\"icon-\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.fixed), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-role=\\\"shuffle-pin\\\" style=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.interactionShuffle), {hash:{},inverse:self.program(7, program7, data),fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"></span>\\r\\n        </span>\\r\\n        <label data-edit=\\\"map\\\">\\r\\n            <input name=\\\"correct\\\" type=\\\"radio\\\" value=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n            <span class=\\\"icon-radio\\\"></span>\\r\\n        </label>\\r\\n    </td>\\r\\n    <td class=\\\"mini-tlb\\\">\\r\\n        <span data-edit=\\\"question\\\" class=\\\"icon-bin\\\" data-role=\\\"delete\\\"></span>\\r\\n        <input class=\\\"score\\\" name=\\\"score\\\" data-edit=\\\"map\\\" value=\\\"\";\n  if (helper = helpers.score) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.score); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\"/>\\r\\n    </td>\\r\\n</tr>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/Widget',[\r\n    'lodash',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/choices/inlineChoice/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/states/states',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/inlineChoiceInteraction',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/inlineChoice'\r\n], function(_, Element, InteractionWidget, ChoiceWidget, states, inlineChoiceInteractionTpl, inlineChoiceTpl){\r\n\r\n    var InlineChoiceInteractionWidget = InteractionWidget.clone();\r\n\r\n    InlineChoiceInteractionWidget.initCreator = function(options){\r\n\r\n        var _this = this;\r\n\r\n        this.registerStates(states);\r\n\r\n        InteractionWidget.initCreator.call(this);\r\n\r\n        this.$choiceOptionForm = options.choiceOptionForm;\r\n        _.each(this.element.getChoices(), function(choice){\r\n            _this.buildChoice(choice);\r\n        });\r\n\r\n       //remove toolbar title, because it is too large\r\n       this.$container.find('.tlb-title').remove();\r\n    };\r\n\r\n    InlineChoiceInteractionWidget.renderChoice = function(choice, shuffleChoice){\r\n\r\n        var tplData = {\r\n            tag : choice.qtiClass,\r\n            serial : choice.serial,\r\n            attributes : choice.attributes,\r\n            body : _.unescape(choice.text),\r\n            interactionShuffle:shuffleChoice\r\n        };\r\n\r\n        return inlineChoiceTpl(tplData);\r\n    };\r\n\r\n\r\n    InlineChoiceInteractionWidget.renderInteraction = function(){\r\n\r\n        var _this = this,\r\n            interaction = this.element,\r\n            shuffleChoice = interaction.attr('shuffle'),\r\n            tplData = {\r\n                tag : interaction.qtiClass,\r\n                serial : interaction.serial,\r\n                attributes : interaction.attributes,\r\n                choices : []\r\n            };\r\n\r\n        _.each(interaction.getChoices(), function(choice){\r\n            if(Element.isA(choice, 'choice')){\r\n                tplData.choices.push(_this.renderChoice(choice, shuffleChoice));\r\n            }\r\n        });\r\n\r\n        return inlineChoiceInteractionTpl(tplData);\r\n    };\r\n\r\n\r\n    InlineChoiceInteractionWidget.buildChoice = function(choice, options){\r\n\r\n        ChoiceWidget.build(\r\n            choice,\r\n            this.$container.find('.widget-inlineChoice[data-serial=\"' + choice.serial + '\"]'),\r\n            this.$choiceOptionForm,\r\n            options\r\n            );\r\n    };\r\n\r\n    InlineChoiceInteractionWidget.buildContainer = function(){\r\n        var previous, next;\r\n        //add a space to be able to place the cursor before and after it.\r\n        if(this.$original.length){\r\n            previous = this.$original[0].previousSibling;\r\n            next = this.$original[0].nextSibling;\r\n\r\n            if(!previous || (previous.nodeType === 3 && previous.nodeValue === '') || previous.nodeType !== 3){\r\n                this.$original.before('&nbsp;');\r\n            }\r\n            if(!next || (next.nodeType === 3 && next.nodeValue === '') || next.nodeType !== 3){\r\n                this.$original.after('&nbsp;');\r\n            }\r\n        }\r\n\r\n        //set the itemContainer where the actual widget should be append and be positioned absolutely\r\n        this.$itemContainer = this.$original.parents('.item-editor-item');\r\n\r\n        //prepare html: interaction & choices:\r\n        this.$itemContainer.append(this.renderInteraction());\r\n\r\n        this.$container = this.$itemContainer.find('.widget-inlineChoiceInteraction[data-serial=' + this.element.getSerial() + ']');\r\n    };\r\n\r\n    return InlineChoiceInteractionWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/inlineChoiceInteraction.placeholder', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<span class=\\\"widget-box inlineChoiceInteraction-placeholder\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"inlineChoiceInteraction\\\">\\r\\n    <label>-- \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"edit choices\", options) : helperMissing.call(depth0, \"__\", \"edit choices\", options)))\n    + \" --</label>\\r\\n    <span class=\\\"icon-down\\\"></span>\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/InlineChoiceInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/InlineChoiceInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineChoiceInteraction/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/inlineChoiceInteraction.placeholder'\r\n], function($, _, InlineChoiceInteraction, InlineChoiceInteractionWidget, tpl){\r\n    'use strict';\r\n\r\n    var CreatorInlineChoiceInteraction = _.clone(InlineChoiceInteraction);\r\n\r\n    CreatorInlineChoiceInteraction.template = tpl;\r\n\r\n    CreatorInlineChoiceInteraction.render = function(interaction, options){\r\n\r\n        //need to pass choice option form to the interaction widget because it will manage everything\r\n        options = options || {};\r\n        options.choiceOptionForm = this.getOption('choiceOptionForm');\r\n\r\n        InlineChoiceInteractionWidget.build(\r\n            interaction,\r\n            $('.inlineChoiceInteraction-placeholder[data-serial=\"' + interaction.serial + '\"]'),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorInlineChoiceInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/matchInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program9(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n      <tr>\\r\\n        \";\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth1 && depth1.matchSet1), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n      </tr>\\r\\n      \";\n  return buffer;\n  }\nfunction program10(depth0,data) {\n  \n  \n  return \"\\r\\n        <td>\\r\\n          <label>\\r\\n            <input type=\\\"checkbox\\\" >\\r\\n            <span class=\\\"icon-checkbox cross\\\"></span>\\r\\n          </label>\\r\\n        </td>\\r\\n        \";\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-matchInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"matchInteraction\\\">\\r\\n  \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n  <div class=\\\"instruction-container\\\"></div>\\r\\n  <div class=\\\"match-interaction-area\\\">\\r\\n    <table class=\\\"matrix\\\">\\r\\n      <thead>\\r\\n      <tr>\\r\\n        <th> </th>\\r\\n        \";\n  options={hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}\n  if (helper = helpers.matchSet1) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.matchSet1); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.matchSet1) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n      </tr>\\r\\n      </thead>\\r\\n      <tbody>\\r\\n      \";\n  options={hash:{},inverse:self.noop,fn:self.programWithDepth(9, program9, data, depth0),data:data}\n  if (helper = helpers.matchSet2) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.matchSet2); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.matchSet2) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.programWithDepth(9, program9, data, depth0),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n      </tbody>\\r\\n    </table>\\r\\n  </div>\\r\\n  <div class=\\\"notification-container\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/matchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse'\r\n], function($, _,  __,tpl, containerHelper, instructionMgr, pciResponse){\r\n    'use strict';\r\n\r\n    /**\r\n     * TODO do not use global context var, it's value is shared between interaction instances\r\n     *\r\n     * Flag to not throw warning instruction if already\r\n     * displaying the warning. If such a flag is not used,\r\n     * disturbances can be seen by the candidate if he clicks\r\n     * like hell on choices.\r\n     */\r\n    var inWarning = false;\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10296\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        // Initialize instructions system.\r\n        _setInstructions(interaction);\r\n\r\n        $container.on('click.commonRenderer', 'input[type=checkbox]', function(e){\r\n            _onCheckboxSelected(interaction, e);\r\n        });\r\n\r\n        instructionMgr.validateInstructions(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10296\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n\r\n        response = _filterResponse(response);\r\n\r\n        if(typeof response.list !== 'undefined' && typeof response.list.directedPair !== 'undefined'){\r\n            _(response.list.directedPair).forEach(function(directedPair){\r\n                var x = $('th[data-identifier=' + directedPair[0] + ']').index() - 1;\r\n                var y = $('th[data-identifier=' + directedPair[1] + ']').parent().index();\r\n\r\n                $('.matrix > tbody tr').eq(y).find('input[type=checkbox]').eq(x).attr('checked', true);\r\n            });\r\n        }\r\n\r\n        instructionMgr.validateInstructions(interaction);\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10296\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        var response = pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n        return response;\r\n    };\r\n\r\n    var resetResponse = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        $('input[type=checkbox]:checked', $container).each(function(){\r\n            $(this).prop('checked', false);\r\n        });\r\n\r\n        instructionMgr.validateInstructions(interaction);\r\n    };\r\n\r\n    var _filterResponse = function(response){\r\n        if(typeof response.list === 'undefined'){\r\n            // Maybe it's a base?\r\n            if(typeof response.base === 'undefined'){\r\n                // Oops, it is even not a base.\r\n                throw 'The given response is not compliant with PCI JSON representation.';\r\n            }\r\n            else{\r\n                // It's a base, Is it a directedPair? Null?\r\n                if (response.base === null) {\r\n                    return {\"list\" : {\"directedPair\" : []}};\r\n                }\r\n                else if (typeof response.base.directedPair === 'undefined'){\r\n                    // Oops again, it is not a directedPair.\r\n                    throw 'The matchInteraction only accepts directedPair values as responses.';\r\n                }\r\n                else{\r\n                    return {\"list\" : {\"directedPair\" : [response.base.directedPair]}};\r\n                }\r\n            }\r\n        }\r\n        else if(typeof response.list.directedPair === 'undefined'){\r\n            // Oops, not a directedPair.\r\n            throw 'The matchInteraction only accept directedPair values as responses.';\r\n        }\r\n        else{\r\n            return response;\r\n        }\r\n    };\r\n\r\n    var _getRawResponse = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var values = [];\r\n\r\n        $container.find('input[type=checkbox]:checked').each(function(){\r\n            values.push(_inferValue(this));\r\n        });\r\n\r\n        return values;\r\n    };\r\n\r\n    var _inferValue = function(element){\r\n        var $element = $(element);\r\n        var y = $element.closest('tr').index();\r\n        var x = $element.closest('td').index();\r\n        var firstId = $('.matrix > thead th').eq(x).data('identifier');\r\n        var secondId = $('.matrix > tbody th').eq(y).data('identifier');\r\n        return [firstId, secondId];\r\n    };\r\n\r\n    var _onCheckboxSelected = function(interaction, e){\r\n\r\n        var choice;\r\n        var currentResponse = _getRawResponse(interaction);\r\n        var minAssociations = interaction.attr('minAssociations');\r\n        var maxAssociations = interaction.attr('maxAssociations');\r\n\r\n        if(maxAssociations === 0){\r\n            maxAssociations = _countChoices(interaction);\r\n        }\r\n\r\n        if(_.size(currentResponse) > maxAssociations){\r\n            // No more associations possible.\r\n            e.preventDefault();\r\n            instructionMgr.validateInstructions(interaction);\r\n\r\n        }else if((choice = _maxMatchReached(interaction, e.target)) !== false){\r\n\r\n            // Check if matchmax is respected for both choices\r\n            // involved in the selection.\r\n            e.preventDefault();\r\n            instructionMgr.validateInstructions(interaction, choice);\r\n\r\n        }else{\r\n\r\n            containerHelper.triggerResponseChangeEvent(interaction, {});\r\n            instructionMgr.validateInstructions(interaction);\r\n        }\r\n\r\n    };\r\n\r\n    var _maxMatchReached = function(interaction, input){\r\n\r\n        var association = _inferValue(input);\r\n        var overflow = false;\r\n\r\n        _(association).forEach(function(identifier){\r\n            var choice = _getChoiceDefinitionByIdentifier(interaction, identifier);\r\n            var matchMin = choice.attributes.matchMin;\r\n            var matchMax = choice.attributes.matchMax;\r\n            var assoc = _countAssociations(interaction, choice);\r\n\r\n            if(matchMax > 0 && assoc > matchMax){\r\n                overflow = choice;\r\n            }\r\n        });\r\n\r\n        return overflow;\r\n    };\r\n\r\n    var _countAssociations = function(interaction, choice){\r\n\r\n        var rawResponse = _getRawResponse(interaction);\r\n        var count = 0;\r\n\r\n        // How much time can we find rawChoice in rawResponses?\r\n        _(rawResponse).forEach(function(response){\r\n            if((response[0] === choice.attributes.identifier || response[1] === choice.attributes.identifier)){\r\n                count++;\r\n            }\r\n        });\r\n\r\n        return count;\r\n    };\r\n\r\n    var _countChoices = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        return $container.find('input[type=checkbox]').length;\r\n    };\r\n\r\n    var _getChoiceDefinitionByIdentifier = function(interaction, identifier){\r\n        var rawChoices = _getRawChoices(interaction);\r\n        return rawChoices[identifier];\r\n    };\r\n\r\n    var _getRawChoices = function(interaction){\r\n        var rawChoices = {};\r\n\r\n        _(interaction.choices).forEach(function(matchset){\r\n            _(matchset).forEach(function(choice){\r\n                rawChoices[choice.attributes.identifier] = choice;\r\n            });\r\n        });\r\n\r\n        return rawChoices;\r\n    };\r\n\r\n    var _setInstructions = function(interaction){\r\n\r\n        var msg;\r\n        var minAssociations = interaction.attr('minAssociations');\r\n        var maxAssociations = interaction.attr('maxAssociations');\r\n        var choiceCount = _countChoices(interaction);\r\n\r\n        // Super closure is here again to save our souls! Houray!\r\n        // ~~~~~~~ |==||||0__\r\n\r\n        var superClosure = function(){\r\n\r\n            var onMaxChoicesReached = function(report, msg){\r\n                if(inWarning === false){\r\n                    inWarning = true;\r\n\r\n                    report.update({\r\n                        level : 'warning',\r\n                        message : __('Maximum number of choices reached.'),\r\n                        timeout : 2000,\r\n                        stop : function(){\r\n                            report.update({level : 'success', message : msg});\r\n                            inWarning = false;\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n\r\n            var onMatchMaxReached = function(interaction, choice, report, msg, level){\r\n\r\n                var $container = containerHelper.get(interaction);\r\n\r\n                if(inWarning === false){\r\n                    inWarning = true;\r\n\r\n                    var $choice = $container.find('.qti-simpleAssociableChoice[data-identifier=\"' + choice.attributes.identifier + '\"]');\r\n                    var originalBackgroundColor = $choice.css('background-color');\r\n                    var originalColor = $choice.css('color');\r\n\r\n                    report.update({\r\n                        level : 'warning',\r\n                        message : __('The highlighted choice cannot be associated more than %d time(s).').replace('%d', choice.attributes.matchMax),\r\n                        timeout : 3000,\r\n                        start : function(){\r\n                            $choice.animate({\r\n                                backgroundColor : '#fff',\r\n                                color : '#ba122b'\r\n                            }, 250, function(){\r\n                                $choice.animate({\r\n                                    backgroundColor : '#ba122b',\r\n                                    color : '#fff'\r\n                                }, 250);\r\n                            });\r\n                        },\r\n                        stop : function(){\r\n                            $choice.animate({\r\n                                backgroundColor : originalBackgroundColor,\r\n                                color : originalColor\r\n                            }, 500);\r\n                            report.update({level : level, message : msg});\r\n                            inWarning = false;\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n\r\n            if(minAssociations === 0 && maxAssociations > 0){\r\n                // No minimum but maximum.\r\n                msg = __('You must select 0 to %d choices.').replace('%d', maxAssociations);\r\n\r\n                instructionMgr.appendInstruction(interaction, msg, function(choice){\r\n                    var responseCount = _.size(_getRawResponse(interaction));\r\n\r\n                    if(choice && choice.attributes && choice.attributes.matchMax > 0 && _countAssociations(interaction, choice) > choice.attributes.matchMax){\r\n                        onMatchMaxReached(interaction, choice, this, msg, this.getLevel());\r\n                    }\r\n                    else if(responseCount <= maxAssociations){\r\n                        this.setLevel('success');\r\n                    }\r\n                    else if(responseCount > maxAssociations){\r\n                        onMaxChoicesReached(this, msg);\r\n                    }\r\n                    else{\r\n                        this.reset();\r\n                    }\r\n                });\r\n            }\r\n            else if(minAssociations === 0 && maxAssociations === 0){\r\n                // No minimum, no maximum.\r\n                msg = __('You must select 0 to %d choices.').replace('%d', choiceCount);\r\n\r\n                instructionMgr.appendInstruction(interaction, msg, function(choice){\r\n\r\n                    if(choice && choice.attributes && choice.attributes.matchMax > 0 && _countAssociations(interaction, choice) > choice.attributes.matchMax){\r\n                        onMatchMaxReached(interaction, choice, this, msg, this.getLevel());\r\n                    }\r\n                    else{\r\n                        this.setLevel('success');\r\n                    }\r\n                });\r\n            }\r\n            else if(minAssociations > 0 && maxAssociations === 0){\r\n                // minimum but no maximum.\r\n                msg = __('You must select %1$d to %2$d choices.');\r\n                msg = msg.replace('%1$d', minAssociations);\r\n                msg = msg.replace('%2$d', choiceCount);\r\n\r\n                instructionMgr.appendInstruction(interaction, msg, function(choice){\r\n                    var responseCount = _.size(_getRawResponse(interaction));\r\n\r\n                    if(choice && choice.attributes && choice.attributes.matchMax > 0 && _countAssociations(interaction, choice) > choice.attributes.matchMax){\r\n                        onMatchMaxReached(interaction, choice, this, msg, this.getLevel());\r\n                    }\r\n                    else if(responseCount < minAssociations){\r\n                        this.setLevel('info');\r\n                    }\r\n                    else if(responseCount > choiceCount){\r\n                        onMaxChoicesReached(this, msg);\r\n                    }\r\n                    else{\r\n                        this.setLevel('success');\r\n                    }\r\n                });\r\n            }\r\n            else if(minAssociations > 0 && maxAssociations > 0){\r\n                // minimum and maximum.\r\n                if(minAssociations !== maxAssociations){\r\n                    msg = __('You must select %1$d to %2$d choices.');\r\n                    msg = msg.replace('%1$d', minAssociations);\r\n                    msg = msg.replace('%2$d', maxAssociations);\r\n                }\r\n                else{\r\n                    msg = __('You must select exactly %d choice(s).');\r\n                    msg = msg.replace('%d', minAssociations);\r\n                }\r\n\r\n                instructionMgr.appendInstruction(interaction, msg, function(choice){\r\n                    var responseCount = _.size(_getRawResponse(interaction));\r\n\r\n                    if(choice && choice.attributes && choice.attributes.matchMax > 0 && _countAssociations(interaction, choice) > choice.attributes.matchMax){\r\n                        onMatchMaxReached(interaction, choice, this, msg, this.getLevel());\r\n                    }\r\n                    else if(responseCount < minAssociations){\r\n                        this.setLevel('info');\r\n                    }\r\n                    else if(responseCount > maxAssociations){\r\n                        onMaxChoicesReached(this, msg);\r\n                    }\r\n                    else if(responseCount >= minAssociations && responseCount <= maxAssociations){\r\n                        this.setLevel('success');\r\n                    }\r\n                });\r\n            }\r\n        };\r\n\r\n        superClosure();\r\n    };\r\n\r\n    var destroy = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        $container.off('.commonRenderer');\r\n\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        var $container;\r\n\r\n        if(_.isObject(state)){\r\n\r\n            //restore order of previously shuffled choices\r\n            if(_.isArray(state.order) && state.order.length === 2){\r\n\r\n                $container = containerHelper.get(interaction);\r\n\r\n                $('thead .qti-choice', $container)\r\n                    .sort(function(a, b){\r\n                        var aIndex = _.indexOf(state.order[0], $(a).data('identifier'));\r\n                        var bIndex = _.indexOf(state.order[0], $(b).data('identifier'));\r\n                        if(aIndex > bIndex) {\r\n                            return 1;\r\n                        }\r\n                        if(aIndex < bIndex) {\r\n                            return -1;\r\n                        }\r\n                        return 0;\r\n                    })\r\n                    .detach()\r\n                    .appendTo($('thead tr', $container));\r\n\r\n                $('tbody .qti-choice', $container)\r\n                    .sort(function(a, b){\r\n                        var aIndex = _.indexOf(state.order[1], $(a).data('identifier'));\r\n                        var bIndex = _.indexOf(state.order[1], $(b).data('identifier'));\r\n                        if(aIndex > bIndex) {\r\n                            return 1;\r\n                        }\r\n                        if(aIndex < bIndex) {\r\n                            return -1;\r\n                        }\r\n                        return 0;\r\n                    })\r\n                    .detach()\r\n                    .each(function(index, elt){\r\n                        $(elt).prependTo($('tbody tr', $container).eq(index));\r\n                    });\r\n            }\r\n\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n\r\n        //we store also the choice order if shuffled\r\n        if(interaction.attr('shuffle') === true){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            state.order = [[], []];\r\n            $('thead .qti-choice', $container).each(function(){\r\n               state.order[0].push($(this).data('identifier'));\r\n            });\r\n            $('tbody .qti-choice', $container).each(function(){\r\n               state.order[1].push($(this).data('identifier'));\r\n            });\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the match interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/MatchInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'matchInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState,\r\n        inferValue : _inferValue\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/matchInteraction.adder', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  \n\n\n  return \"<div class=\\\"clearfix add-options\\\" data-edit=\\\"question\\\">\\r\\n    <div class=\\\"rgt\\\">\\r\\n        <span class=\\\"add-option\\\" data-role=\\\"add-row\\\"><span class=\\\"icon-add\\\"></span>Add new row</span>\\r\\n        <span class=\\\"add-option\\\" data-role=\\\"add-col\\\"><span class=\\\"icon-add\\\"></span>Add new column</span>\\r\\n    </div>\\r\\n</div>\";\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/interactions/matchInteraction.row', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"\\r\\n    <td>\\r\\n        <label>\\r\\n            <input type=\\\"checkbox\\\" >\\r\\n            <span class=\\\"icon-checkbox cross\\\"></span>\\r\\n        </label>\\r\\n    </td>\\r\\n    \";\n  }\n\n  buffer += \"<tr>\\r\\n    \";\n  if (helper = helpers.choice) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choice); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  stack1 = (helper = helpers['for'] || (depth0 && depth0['for']),options={hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data},helper ? helper.call(depth0, 0, (depth0 && depth0.otherMatchSetCount), 1, options) : helperMissing.call(depth0, \"for\", 0, (depth0 && depth0.otherMatchSetCount), 1, options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</tr>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/interactions/matchInteraction.cell', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  \n\n\n  return \"<td>\\r\\n    <label>\\r\\n        <input type=\\\"checkbox\\\" >\\r\\n        <span class=\\\"icon-checkbox cross\\\"></span>\\r\\n    </label>\\r\\n</td>\";\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/associateInteraction/states/Question',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/matchInteraction.adder',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/interactions/matchInteraction.row',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/interactions/matchInteraction.cell',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/sizeAdapter'\r\n], function($, _, stateFactory, Question, AssociateInteractionQuestionState, adderTpl, rowTpl, cellTpl, sizeAdapter){\r\n\r\n    'use strict';\r\n\r\n    var MatchInteractionStateQuestion = stateFactory.extend(Question);\r\n\r\n    MatchInteractionStateQuestion.prototype.initForm = AssociateInteractionQuestionState.prototype.initForm;\r\n\r\n    MatchInteractionStateQuestion.prototype.addNewChoiceButton = function(){\r\n\r\n        var widget = this.widget,\r\n            interaction = widget.element,\r\n            $matchArea = widget.$container.find('.match-interaction-area'),\r\n            qtiChoiceClassName = 'simpleAssociableChoice.matchInteraction';\r\n\r\n        var _postRender = function(choice){\r\n            \r\n            choice.postRender({\r\n                ready : function(widget){\r\n                    //transition state directly back to \"question\"\r\n                    widget.changeState('question');\r\n                }\r\n            }, qtiChoiceClassName);\r\n        };\r\n\r\n        if(!$matchArea.find('.add-option').length){\r\n            \r\n            $matchArea.append(adderTpl());\r\n            \r\n            $matchArea.find('.add-options').show();\r\n            \r\n            $matchArea.find('.add-option[data-role=add-col]').on('click', function(){\r\n                \r\n                //match set 0\r\n                var choice = interaction.createChoice(0);\r\n                \r\n                $matchArea.find('thead > tr').append(choice.render(qtiChoiceClassName));\r\n                $matchArea.find('tbody > tr').append(cellTpl({}));\r\n                \r\n                _postRender(choice);\r\n            });\r\n\r\n            $matchArea.find('.add-option[data-role=add-row]').on('click', function(){\r\n                \r\n                //match set 1\r\n                var choice = interaction.createChoice(1);\r\n                \r\n                $matchArea.find('tbody').append(rowTpl({\r\n                    choice : choice.render(qtiChoiceClassName),\r\n                    otherMatchSetCount : _.size(interaction.choices[0])\r\n                }));\r\n                \r\n                _postRender(choice);\r\n            });\r\n        }\r\n\r\n        $('.qti-item').on('toolbarchange', function() {\r\n            $matchArea.find('tbody .mini-tlb').each(function() {\r\n                var $toolbar = $(this);\r\n                // (string) false is _not_ a mistake\r\n                // this prevents images etc inside a choice from having funny toolbars\r\n                if($toolbar.parent().attr('contenteditable') !== 'false') {\r\n                    $toolbar.css({ left: ($toolbar.width() + 10) * -1, top: -1} );\r\n                }\r\n            });\r\n        });\r\n\r\n        //listen for height changes\r\n        $matchArea.find('tr ').each(function() {\r\n            var $elements = $(this).find('[data-html-editable=\"true\"]');\r\n            widget.on('containerBodyChange', function(){\r\n                sizeAdapter.adaptSize($elements);\r\n            });\r\n        });\r\n\r\n    };\r\n\r\n    return MatchInteractionStateQuestion;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/matchInteraction.score', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<input value=\\\"\";\n  if (helper = helpers.score) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.score); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n       title=\\\"Score of this answer\\\" \\r\\n       type=\\\"text\\\" \\r\\n       data-for=\\\"\";\n  if (helper = helpers.choiceIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choiceIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n       name=\\\"score\\\" \\r\\n       class=\\\"score\\\" \\r\\n       placeholder = \\\"\";\n  if (helper = helpers.placeholder) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.placeholder); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n       data-validate=\\\"$numeric\\\" \\r\\n       data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\" />\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/ResponseWidget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/matchInteraction.score',\r\n    'lodash',\r\n    'i18n',\r\n    'polyfill/placeholders'\r\n], function($, commonRenderer, instructionMgr, formElement, scoreTpl, _, __){\r\n\r\n    var ResponseWidget = {\r\n        create : function(widget, responseMappingMode){\r\n\r\n            var interaction = widget.element;\r\n\r\n            commonRenderer.resetResponse(interaction);\r\n            commonRenderer.destroy(interaction);\r\n\r\n            if(responseMappingMode){\r\n                instructionMgr.appendInstruction(widget.element, __('Please define the correct response and the score below.'));\r\n                interaction.data('responseMappingMode', true);\r\n                ResponseWidget.createScoreWidgets(widget);\r\n                ResponseWidget.createCorrectWidgets(widget);\r\n            }else{\r\n                instructionMgr.appendInstruction(widget.element, __('Please define the correct response below.'));\r\n                ResponseWidget.createCorrectWidgets(widget);\r\n            }\r\n\r\n            commonRenderer.render(interaction);\r\n\r\n            widget.$container.find('table.matrix input[type=checkbox]')\r\n                .removeProp('disabled')\r\n                .attr('data-edit', 'correct')\r\n                .attr('data-role', 'correct');\r\n        },\r\n        setResponse : function(interaction, response){\r\n\r\n            commonRenderer.setResponse(interaction, ResponseWidget.formatResponse(response));\r\n        },\r\n        destroy : function(widget){\r\n\r\n            var interaction = widget.element;\r\n\r\n            interaction.removeData('responseMappingMode');\r\n\r\n            widget.$container.find('table.matrix input[type=checkbox]').prop('disabled', 'disabled');\r\n            widget.$container.find('table.matrix .score').remove();\r\n            widget.$container.off('responseChange.qti-widget');\r\n\r\n            commonRenderer.resetResponse(interaction);\r\n            commonRenderer.destroy(interaction);\r\n        },\r\n        createScoreWidgets : function(widget){\r\n\r\n            var $container = widget.$container,\r\n                interaction = widget.element,\r\n                response = interaction.getResponseDeclaration(),\r\n                mapEntries = response.getMapEntries(),\r\n                defaultValue = response.getMappingAttribute('defaultValue');\r\n\r\n            $container.find('table.matrix td>label').each(function(){\r\n\r\n                var pairId = commonRenderer.inferValue(this).join(' ');\r\n\r\n                $(this).append(scoreTpl({\r\n                    serial : interaction.getSerial(),\r\n                    choiceIdentifier : pairId,\r\n                    score : mapEntries[pairId] ? mapEntries[pairId] : '',\r\n                    placeholder : defaultValue\r\n                }));\r\n            });\r\n\r\n            //add placeholder text to show the default value\r\n            var $scores = $container.find('table.matrix .score');\r\n            $scores.on('click', function(e){\r\n                e.stopPropagation();\r\n                e.preventDefault();\r\n            });\r\n\r\n            widget.on('mappingAttributeChange', function(data){\r\n                if(data.key === 'defaultValue'){\r\n                    $scores.attr('placeholder', data.value);\r\n                }\r\n            });\r\n\r\n            formElement.setChangeCallbacks($container, response, {\r\n                score : function(response, value){\r\n\r\n                    var key = $(this).data('for');\r\n\r\n                    if(value === ''){\r\n                        response.removeMapEntry(key);\r\n                    }else{\r\n                        response.setMapEntry(key, value, true);\r\n                    }\r\n\r\n                }\r\n            });\r\n\r\n        },\r\n        createCorrectWidgets : function(widget){\r\n\r\n            var interaction = widget.element,\r\n                response = interaction.getResponseDeclaration();\r\n\r\n            widget.$container.on('responseChange.qti-widget', function(e, data){\r\n                response.setCorrect(ResponseWidget.unformatResponse(data.response));\r\n            });\r\n\r\n        },\r\n        formatResponse : function(response){\r\n\r\n            var formatedRes = {list : {directedPair : []}};\r\n            if(_.size(response) === 1){\r\n                var pair = _.values(response).pop().split(' ');\r\n                formatedRes = {base : {directedPair : pair}};\r\n            }else{\r\n                formatedRes = {list : {directedPair : []}};\r\n                _.each(response, function(pairString){\r\n                    var pair = pairString.split(' ');\r\n                    formatedRes.list.directedPair.push(pair);\r\n                });\r\n            }\r\n            return formatedRes;\r\n        },\r\n        unformatResponse : function(formatedResponse){\r\n\r\n            var res = [];\r\n\r\n            if(formatedResponse.list && formatedResponse.list.directedPair){\r\n                _.each(formatedResponse.list.directedPair, function(pair){\r\n                    res.push(pair.join(' '));\r\n                });\r\n            }else if(formatedResponse.base && formatedResponse.base.directedPair){\r\n                res.push(formatedResponse.base.directedPair.join(' '));\r\n            }\r\n            return res;\r\n        }\r\n    };\r\n\r\n    return ResponseWidget;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/Correct',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/ResponseWidget',\r\n    'lodash'\r\n], function(stateFactory, Correct, responseWidget, _){\r\n\r\n    var MatchInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n\r\n        var _widget = this.widget,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        //init response widget in responseMapping mode:\r\n        responseWidget.create(_widget);\r\n\r\n        //finally, apply defined correct response and response mapping:\r\n        responseWidget.setResponse(interaction, _.values(response.getCorrect()));\r\n\r\n    }, function(){\r\n\r\n        responseWidget.destroy(this.widget);\r\n\r\n    });\r\n\r\n    return MatchInteractionStateCorrect;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/Map',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/ResponseWidget',\r\n    'lodash'\r\n], function($, stateFactory, Map, responseWidget, _){\r\n\r\n    var MatchInteractionStateMap = stateFactory.create(Map, function(){\r\n\r\n        var _widget = this.widget,\r\n            interaction = _widget.element,\r\n            response = interaction.getResponseDeclaration();\r\n\r\n        //init response widget in responseMapping mode:\r\n        responseWidget.create(_widget, true);\r\n\r\n        //finally, apply defined correct response and response mapping:\r\n        responseWidget.setResponse(interaction, _.values(response.getCorrect()));\r\n        \r\n       //change the correct state \r\n       _widget.on('metaChange', function(meta){\r\n            if(meta.key === 'defineCorrect'){\r\n                if(meta.value){\r\n                    $('.match-interaction-area input[type=\"checkbox\"]', _widget.$container)\r\n                        .removeProp('disabled') \r\n                        .removeClass('disabled');\r\n                } else {\r\n                    $('.match-interaction-area input[type=\"checkbox\"]', _widget.$container)\r\n                        .prop('disabled', true)\r\n                        .prop('checked', false)\r\n                        .addClass('disabled');\r\n                }\r\n                if(meta.value === false){\r\n                    response.setCorrect([]);\r\n                }\r\n            }\r\n        });\r\n\r\n    }, function(){\r\n\r\n        responseWidget.destroy(this.widget);\r\n\r\n    });\r\n\r\n    return MatchInteractionStateMap;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/Map'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/states/states'\r\n], function(Widget, states){\r\n\r\n    var MatchInteractionWidget = Widget.clone();\r\n\r\n    MatchInteractionWidget.initCreator = function(){\r\n        this.registerStates(states);\r\n        Widget.initCreator.call(this);\r\n    };\r\n    \r\n    return MatchInteractionWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/MatchInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/MatchInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/matchInteraction/Widget'\r\n], function(_, MatchInteraction,MatchInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorMatchInteraction = _.clone(MatchInteraction);\r\n\r\n    CreatorMatchInteraction.render = function(interaction, options){\r\n\r\n        MatchInteractionWidget.build(\r\n            interaction,\r\n            MatchInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorMatchInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/mediaInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-mediaInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"media-container\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Martin for OAT S.A. <code@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/mediaInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'ui/mediaplayer'\r\n], function($, _, __, Promise, tpl, pciResponse, containerHelper, mediaplayer) {\r\n    'use strict';\r\n\r\n\r\n    //some default values\r\n    var defaults = {\r\n        type   : 'video/mp4',\r\n        video : {\r\n            width: 480,\r\n            height: 270\r\n        },\r\n        audio : {\r\n            width: 400,\r\n            height: 30\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10391\r\n     *\r\n     * @param {object} interaction\r\n     * @fires playerready when the player is sucessfully loaded and configured\r\n     */\r\n    var render = function render(interaction) {\r\n        var self = this;\r\n        return new Promise(function(resolve) {\r\n\r\n            var $container = containerHelper.get(interaction);\r\n            var media      = interaction.object;\r\n            var $item      = $container.parents('.qti-item');\r\n            var maxPlays   = parseInt(interaction.attr('maxPlays'), 10) || 0;\r\n            var url        = media.attr('data') || '';\r\n\r\n\r\n            //check if the media can be played (using timesPlayed and maxPlays)\r\n            var canBePlayed = function canBePlayed(){\r\n                var current = parseInt($container.data('timesPlayed'), 10);\r\n                return maxPlays === 0 || maxPlays > current;\r\n            };\r\n\r\n\r\n            /**\r\n            * Resize video player elements to fit container size\r\n            * @param {Object} mediaElement - player instance\r\n            * @param {jQueryElement} $container   - container element to adapt\r\n            */\r\n            var resize = _.debounce(function resize () {\r\n                var width, height;\r\n                if (interaction.mediaElement){\r\n\r\n                    height = $container.find('.media-container').height();\r\n                    width =  $container.find('.media-container').width();\r\n\r\n                    interaction.mediaElement.resize(width, height);\r\n                }\r\n            }, 200);\r\n\r\n\r\n            //intialize the player if not yet done\r\n            var initMediaPlayer = function initMediaPlayer(){\r\n                if (!interaction.mediaElement) {\r\n                    interaction.mediaElement = mediaplayer({\r\n                        url: url && self.resolveUrl(url),\r\n                        type: media.attr('type') || defaults.type,\r\n                        canPause: $container.hasClass('pause'),\r\n                        maxPlays: maxPlays,\r\n                        canSeek: !maxPlays,\r\n                        width: media.attr('width'),\r\n                        height: media.attr('height'),\r\n                        volume: 100,\r\n                        autoStart: !!interaction.attr('autostart') && canBePlayed(),\r\n                        loop: !!interaction.attr('loop'),\r\n                        renderTo: $('.media-container', $container)\r\n                    })\r\n                    .on('render', function() {\r\n\r\n                        resize();\r\n\r\n                        $(window).off('resize.mediaInteraction')\r\n                            .on('resize.mediaInteraction', resize);\r\n\r\n                        $item.off('resize.gridEdit')\r\n                            .on('resize.gridEdit', resize);\r\n\r\n                        resolve();\r\n                    })\r\n                    .on('ready', function() {\r\n                       /**\r\n                        * @event playerready\r\n                        */\r\n                        $container.trigger('playerready');\r\n                    })\r\n                    .on('ended', function() {\r\n                        $container.data('timesPlayed', $container.data('timesPlayed') + 1);\r\n                        containerHelper.triggerResponseChangeEvent(interaction);\r\n\r\n                        if (!canBePlayed() ) {\r\n                            this.disable();\r\n                        }\r\n                    });\r\n                }\r\n            };\r\n\r\n\r\n\r\n            if(_.size(media.attributes) === 0){\r\n                //TODO move to afterCreate\r\n                media.attr('type', defaults.type);\r\n                media.attr('width', $container.innerWidth());\r\n\r\n                media.attr('height', defaults.video.height);\r\n                media.attr('data', '');\r\n            }\r\n\r\n            //set up the number of times played\r\n            if (!$container.data('timesPlayed')) {\r\n                $container.data('timesPlayed', 0);\r\n            }\r\n\r\n            //initialize the component\r\n            $container.on('responseSet', function() {\r\n                initMediaPlayer();\r\n            });\r\n\r\n            //gives a small chance to the responseSet event before initializing the player\r\n            initMediaPlayer();\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Destroy the current interaction\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function(interaction) {\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        if (interaction.mediaElement) {\r\n            interaction.mediaElement.destroy();\r\n            interaction.mediaElement = null;\r\n        }\r\n\r\n        $('.instruction-container', $container).empty();\r\n        $('.media-container', $container).empty();\r\n\r\n        $container.removeData('timesPlayed');\r\n\r\n        $(window).off('resize.video');\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Get the responses from the interaction\r\n     * @private\r\n     * @param {Object} interaction\r\n     * @returns {Array} of points\r\n     */\r\n    var _getRawResponse = function _getRawResponse(interaction) {\r\n        return [containerHelper.get(interaction).data('timesPlayed') || 0];\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response) {\r\n        var responseValues;\r\n        if (response) {\r\n            try {\r\n                //try to unserialize the pci response\r\n                responseValues = pciResponse.unserialize(response, interaction);\r\n                containerHelper.get(interaction).data('timesPlayed', responseValues[0]);\r\n            } catch (e) {\r\n                // something went wrong\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset the current responses of the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var resetResponse = function resetResponse(interaction) {\r\n        containerHelper.get(interaction).data('timesPlayed', 0);\r\n    };\r\n\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction) {\r\n        return  pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n\r\n    /**\r\n     * Expose the common renderer for the interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/MediaInteraction\r\n     */\r\n    return {\r\n        qtiClass        : 'mediaInteraction',\r\n        template        : tpl,\r\n        render          : render,\r\n        getContainer    : containerHelper.get,\r\n        setResponse     : setResponse,\r\n        getResponse     : getResponse,\r\n        resetResponse   : resetResponse,\r\n        destroy         : destroy,\r\n        setState        : setState,\r\n        getState        : getState\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/media', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n\\r\\n    <div>\\r\\n        <label>\\r\\n            <div>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Media file path or YouTube video address\", options) : helperMissing.call(depth0, \"__\", \"Media file path or YouTube video address\", options)))\n    + \"</div>\\r\\n            <input type=\\\"text\\\" name=\\\"data\\\" placeholder=\\\"Please select media file\\\" value=\\\"\";\n  if (helper = helpers.data) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.data); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty;\\\"/>\\r\\n            <div><button class='selectMediaFile btn-info small block'>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select media file\", options) : helperMissing.call(depth0, \"__\", \"Select media file\", options)))\n    + \"</button></div>\\r\\n        </label>\\r\\n    </div>\\r\\n\\r\\n    <div>\\r\\n        <label for=\\\"width\\\" class=\\\"spinner\\\">Width</label>\\r\\n        <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" class=\\\"large\\\" data-increment=\\\"1\\\" data-min=\\\"50\\\" data-max=\\\"1920\\\" />\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"height-container\\\">\\r\\n        <label for=\\\"height\\\" class=\\\"spinner\\\">Height</label>\\r\\n        <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" class=\\\"large\\\" data-increment=\\\"1\\\" data-min=\\\"30\\\" data-max=\\\"1080\\\" />\\r\\n    </div>\\r\\n\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"autostart\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.autostart), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Autostart\", options) : helperMissing.call(depth0, \"__\", \"Autostart\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The autostart attribute determines if the media object should begin as soon as the candidate starts the attempt (checked) or if the media object should be started under the control of the candidate (unchecked).\", options) : helperMissing.call(depth0, \"__\", \"The autostart attribute determines if the media object should begin as soon as the candidate starts the attempt (checked) or if the media object should be started under the control of the candidate (unchecked).\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"loop\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.loop), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Loop\", options) : helperMissing.call(depth0, \"__\", \"Loop\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n       \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The loop attribute is used to set continuous play mode. In continuous play mode, once the media object has started to play it should play continuously (subject to maxPlays).\", options) : helperMissing.call(depth0, \"__\", \"The loop attribute is used to set continuous play mode. In continuous play mode, once the media object has started to play it should play continuously (subject to maxPlays).\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"pause\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.pause), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Pause\", options) : helperMissing.call(depth0, \"__\", \"Pause\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n       \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Enable the test taker to pause and restart the playing.\", options) : helperMissing.call(depth0, \"__\", \"Enable the test taker to pause and restart the playing.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <div>\\r\\n        <label for=\\\"maxPlays\\\" class=\\\"spinner\\\">Max plays count</label>\\r\\n        <input name=\\\"maxPlays\\\" value=\\\"\";\n  if (helper = helpers.maxPlays) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxPlays); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"large\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"1000\\\" type=\\\"text\\\" />\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maxPlays attribute indicates that the media object can be played at most maxPlays times - it must not be possible for the candidate to play the media object more than maxPlay times. A value of 0 (the default) indicates that there is no limit.\", options) : helperMissing.call(depth0, \"__\", \"The maxPlays attribute indicates that the media object can be played at most maxPlays times - it must not be possible for the candidate to play the media object more than maxPlay times. A value of 0 (the default) indicates that there is no limit.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technlogies SA\r\n *\r\n */\r\n\r\n/**\r\n * The Question state of the media interaction\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/media',\r\n    'ui/resourcemgr',\r\n    'ui/tooltip'\r\n], function($, _, __, stateFactory, Question, formElement, formTpl){\r\n    'use strict';\r\n\r\n    var initQuestionState = function initQuestionState(){\r\n        this.widget.renderInteraction();\r\n    };\r\n\r\n    var exitQuestionState = function exitQuestionState(){\r\n        this.widget.destroyInteraction();\r\n    };\r\n\r\n    var MediaInteractionStateQuestion = stateFactory.extend(Question, initQuestionState, exitQuestionState);\r\n\r\n    /**\r\n     * Initialize the attribute form : file, type, size, etc.\r\n     */\r\n    MediaInteractionStateQuestion.prototype.initForm = function initForm(){\r\n\r\n        var widget             = this.widget;\r\n        var $form              = widget.$form;\r\n        var $container         = widget.$original;\r\n        var options            = widget.options;\r\n        var interaction        = widget.element;\r\n        var isAudio            = false;\r\n        var defaultVideoHeight = 270;\r\n        var defaultAudioHeight = 30;\r\n        var callbacks;\r\n        var $heightContainer;\r\n\r\n        /**\r\n         * Each change triggers an re rendering of the interaction\r\n         */\r\n        var reRender = _.debounce(function reRender(){\r\n            interaction.attr('responseIdentifier', interaction.attr('responseIdentifier'));\r\n\r\n            widget.destroyInteraction();\r\n            widget.renderInteraction();\r\n        }, 1000);\r\n\r\n        /**\r\n         * Switch to audio mode:\r\n         * update height and disable the field\r\n         */\r\n        var switchToAudio = function switchToAudio(){\r\n            isAudio = true;\r\n\r\n            $heightContainer.hide();\r\n            interaction.object.attr('height', defaultAudioHeight);\r\n        };\r\n\r\n        /**\r\n         * Switch to video mode:\r\n         * update height and enable the field\r\n         */\r\n        var switchToVideo = function switchToVideo(){\r\n            if(isAudio){\r\n                isAudio = false;\r\n                interaction.object.attr('height', defaultVideoHeight);\r\n                $heightContainer.show();\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Switch mode based on file type\r\n         */\r\n        var switchMode = function switchMode(){\r\n            if (/audio/.test(interaction.object.attr('type'))) {\r\n                switchToAudio();\r\n            } else {\r\n                switchToVideo();\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Set up the file upload component\r\n         */\r\n        var setUpUploader = function setUpUploader() {\r\n\r\n            var $src = $form.find('input[name=data]');\r\n            var $uploadTrigger = $form.find('.selectMediaFile');\r\n            var openResourceMgr = function openResourceMgr(){\r\n                $uploadTrigger.resourcemgr({\r\n                    title : __('Please select a media file (video or audio) from the resource manager. You can add files from your computer with the button \"Add file(s)\".'),\r\n                    appendContainer: options.mediaManager.appendContainer,\r\n                    mediaSourcesUrl: options.mediaManager.mediaSourcesUrl,\r\n                    browseUrl:       options.mediaManager.browseUrl,\r\n                    uploadUrl:       options.mediaManager.uploadUrl,\r\n                    deleteUrl:       options.mediaManager.deleteUrl,\r\n                    downloadUrl:     options.mediaManager.downloadUrl,\r\n                    fileExistsUrl:   options.mediaManager.fileExistsUrl,\r\n                    params : {\r\n                        uri : options.uri,\r\n                        lang : options.lang,\r\n                        filters : 'video/mp4,video/avi,video/ogv,video/mpeg,video/ogg,video/quicktime,video/webm,video/x-ms-wmv,video/x-flv,audio/mp3,audio/vnd.wav,audio/ogg,audio/vorbis,audio/webm,audio/mpeg,application/ogg,audio/aac,audio/wav,audio/flac'\r\n                    },\r\n                    pathParam : 'path',\r\n                    select : function(e, files){\r\n                        if(files && files.length){\r\n                            // set data field content and maybe detect and set media type here\r\n                            interaction.object.attr('type', files[0].mime);\r\n                            $src.val(files[0].file).trigger('change');\r\n                        }else{\r\n                            $src.trigger('noselection');\r\n                        }\r\n                    },\r\n                    open : function(){\r\n                        //hide tooltip if displayed\r\n                        if($src.data('qtip')){\r\n                            $src.blur().qtip('hide');\r\n                        }\r\n                    },\r\n                    close : function(){\r\n                        //triggers validation :\r\n                        $src.blur();\r\n                    }\r\n                });\r\n\r\n            };\r\n\r\n            $uploadTrigger.on('click', openResourceMgr);\r\n\r\n            //if empty, open file manager immediately\r\n            if(!$src.val()){\r\n                openResourceMgr();\r\n            }\r\n        };\r\n\r\n        //initialization binding\r\n        //initialize your form here, you certainly gonna need to modify it:\r\n        //append the form to the dom (this part should be almost ok)\r\n        $form.html(formTpl({\r\n            //tpl data for the interaction\r\n            autostart: !!interaction.attr('autostart'),\r\n            loop:      !!interaction.attr('loop'),\r\n            maxPlays:  parseInt(interaction.attr('maxPlays'), 10),\r\n            pause:     interaction.hasClass('pause'),\r\n            //tpl data for the \"object\", this part is going to be reused by the \"objectWidget\", http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10173\r\n            data:      interaction.object.attr('data'),\r\n            type:      interaction.object.attr('type'), //use the same as the uploadInteraction, contact jerome@taotesting.com for this\r\n            width:     interaction.object.attr('width'),\r\n            height:    interaction.object.attr('height')\r\n\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        $heightContainer = $('.height-container', $form);\r\n\r\n        switchMode();\r\n\r\n        //init data change callbacks\r\n        callbacks = {\r\n            autostart : function autostart(boundInteraction, attrValue, attrName){\r\n                interaction.attr(attrName, attrValue);\r\n                reRender();\r\n            },\r\n\r\n            loop : function loop(boundInteraction, attrValue, attrName){\r\n                interaction.attr(attrName, attrValue);\r\n                reRender();\r\n            },\r\n\r\n            maxPlays : function maxPlays(boundInteraction, attrValue, attrName){\r\n                interaction.attr(attrName, attrValue);\r\n                reRender();\r\n            },\r\n\r\n            pause : function pause(boundInteraction, attrValue){\r\n                if(attrValue){\r\n                    if(!$container.hasClass('pause')){\r\n                        $container.addClass('pause');\r\n                        interaction.addClass('pause');\r\n                    }\r\n                } else {\r\n                    $container.removeClass('pause');\r\n                    interaction.removeClass('pause');\r\n                }\r\n            },\r\n\r\n            width : function width(boundInteraction, attrValue, attrName){\r\n                interaction.object.attr(attrName, attrValue);\r\n                reRender();\r\n            },\r\n\r\n            height : function height(boundInteraction, attrValue, attrName){\r\n                if(!isAudio){\r\n                    interaction.object.attr(attrName, attrValue);\r\n                    reRender();\r\n                }\r\n            },\r\n\r\n            data : function data(boundInteraction, attrValue, attrName){\r\n                var value;\r\n                if(interaction.object.attr(attrName) !== attrValue){\r\n                    interaction.object.attr(attrName, attrValue);\r\n\r\n                    value = $.trim(attrValue).toLowerCase();\r\n\r\n                    if (/^http(s)?:\\/\\/(www\\.)?youtu/.test(value)) {\r\n                        interaction.object.attr('type', 'video/youtube');\r\n                        switchToVideo();\r\n                    } else if (/audio/.test(interaction.object.attr('type'))) {\r\n                        switchToAudio();\r\n                    } else {\r\n                        switchToVideo();\r\n                    }\r\n\r\n                    if(interaction.object && (!interaction.object.attr('width') || parseInt(interaction.object.attr('width'), 10) <= 0)){\r\n                        interaction.object.attr('width', widget.$original.innerWidth());\r\n                    }\r\n\r\n                    reRender();\r\n                }\r\n            }\r\n        };\r\n\r\n        formElement.setChangeCallbacks($form, interaction, callbacks, {invalidate : true});\r\n\r\n        setUpUploader();\r\n    };\r\n\r\n    return MediaInteractionStateQuestion;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA\r\n */\r\n\r\n/**\r\n * The Answer state of the media interaction\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/Answer',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Answer'\r\n], function($, _, __, stateFactory, Answer){\r\n    'use strict';\r\n    return stateFactory.extend(Answer, function initAnswerState(){\r\n        this.widget.renderInteraction();\r\n    }, function exitAnswerState(){\r\n        this.widget.destroyInteraction();\r\n    });\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/Sleep',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep'\r\n], function(_, stateFactory, SleepState) {\r\n\r\n    var initSleepState = function initSleepState() {\r\n        this.widget.renderInteraction();\r\n        this.widget.$original.append('<div class=\"overlay\"></div>');\r\n    };\r\n\r\n    var exitSleepState = function exitSleepState(){\r\n        this.widget.destroyInteraction();\r\n        this.widget.$original.children('.overlay').remove();\r\n    };\r\n\r\n    return stateFactory.extend(SleepState, initSleepState, exitSleepState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/Answer',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/Sleep'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments, ['map']);\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/Widget',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/states/states',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction'\r\n], function($, _, Widget, states, commonRenderer){\r\n    \r\n    var MediaInteractionWidget = _.extend(Widget.clone(), {\r\n\r\n        initCreator : function(){\r\n            var self        = this; \r\n            var $container  = this.$original;\r\n            var $item       = $container.parents('.qti-item');\r\n\r\n            this.registerStates(states);            \r\n            Widget.initCreator.call(this);\r\n            \r\n            $item\r\n              .off('.' + this.element.serial)\r\n              .on('resize.'+ this.element.serial, _.throttle(function(e){\r\n                    var width = $container.innerWidth();\r\n                    if(width > 0){\r\n                        self.element.object.attr('width', $container.innerWidth());\r\n                        self.destroyInteraction();\r\n                        self.renderInteraction();\r\n                    }\r\n            }, 100));\r\n        },\r\n    \r\n        destroy : function(){\r\n\r\n            var $container = this.$original;\r\n            var $item      = $container.parents('.qti-item');\r\n\r\n            //stop listening the resize\r\n            $item.off('resize.' + this.element.serial);\r\n\r\n            //call parent destroy\r\n            Widget.destroy.call(this);\r\n        },\r\n\r\n        renderInteraction : function(){\r\n            var $container  = this.$original; \r\n            var interaction = this.element;\r\n            commonRenderer.render.call(interaction.getRenderer(), interaction, {\r\n                features : 'full',\r\n                controlPlaying : false\r\n            });\r\n        },\r\n\r\n        destroyInteraction : function(){\r\n            var interaction = this.element;\r\n            commonRenderer.resetResponse.call(interaction.getRenderer(), interaction);    \r\n            commonRenderer.destroy.call(interaction.getRenderer(), interaction);    \r\n        }\r\n    });\r\n\r\n    return MediaInteractionWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/interactions/mediaInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div class=\\\"qti-interaction qti-blockInteraction qti-mediaInteraction\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n\t\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\t<div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"media-container\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/MediaInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/MediaInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/mediaInteraction/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/interactions/mediaInteraction'\r\n], function(_, MediaInteraction, MediaInteractionWidget, tpl){\r\n    'use strict';\r\n\r\n    MediaInteraction = _.clone(MediaInteraction);\r\n\r\n    MediaInteraction.template = tpl;\r\n\r\n    MediaInteraction.render = function(interaction, options){\r\n\r\n\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        //options.choiceForm = this.getOption('choiceOptionForm');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        MediaInteractionWidget.build(\r\n            interaction,\r\n            MediaInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),//note : no response required...\r\n            options\r\n        );\r\n    };\r\n\r\n    return MediaInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/orderInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \" qti-horizontal\";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \" qti-vertical\";\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program9(depth0,data) {\n  \n  \n  return \"horizontal\";\n  }\n\nfunction program11(depth0,data) {\n  \n  \n  return \"vertical\";\n  }\n\nfunction program13(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program15(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program17(depth0,data) {\n  \n  \n  return \"icon-down\";\n  }\n\nfunction program19(depth0,data) {\n  \n  \n  return \"icon-right\";\n  }\n\nfunction program21(depth0,data) {\n  \n  \n  return \"icon-up\";\n  }\n\nfunction program23(depth0,data) {\n  \n  \n  return \"icon-left\";\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-orderInteraction\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"\\r\\n     data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n     data-qti-class=\\\"orderInteraction\\\"\\r\\n     data-orientation=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.program(11, program11, data),fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(13, program13, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"order-interaction-area\\\">\\r\\n        <ul class=\\\"choice-area square source solid block-listing \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n            \";\n  options={hash:{},inverse:self.noop,fn:self.program(15, program15, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(15, program15, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </ul>\\r\\n        <div class=\\\"arrow-bar middle\\\">\\r\\n            <span class=\\\"icon-add-to-selection \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.program(19, program19, data),fn:self.program(17, program17, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"></span>\\r\\n            <span class=\\\"icon-remove-from-selection \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.program(23, program23, data),fn:self.program(21, program21, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" inactive\\\"></span>\\r\\n        </div>\\r\\n        <ul class=\\\"drag-container block-listing\\\"></ul>\\r\\n        <ul class=\\\"result-area decimal target solid block-listing \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n        </ul>\\r\\n        <div class=\\\"arrow-bar\\\">\\r\\n            <span class=\\\"icon-move-before \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.program(21, program21, data),fn:self.program(23, program23, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" inactive\\\"></span>\\r\\n            <span class=\\\"icon-move-after \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.horizontal), {hash:{},inverse:self.program(17, program17, data),fn:self.program(19, program19, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" inactive\\\"></span>\\r\\n        </div>\\r\\n    </div>\\r\\n    <div class=\\\"notification-container\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction',[\r\n    'lodash',\r\n    'jquery',\r\n    'i18n',\r\n    'core/mouseEvent',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/orderInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'interact',\r\n    'ui/interactUtils'\r\n], function(_, $, __, triggerMouseEvent, tpl, containerHelper, instructionMgr, pciResponse, interact, interactUtils){\r\n    'use strict';\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10283\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     */\r\n    var render = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction),\r\n            $choiceArea = $container.find('.choice-area'),\r\n            $resultArea = $container.find('.result-area'),\r\n            $iconAdd = $container.find('.icon-add-to-selection'),\r\n            $iconRemove = $container.find('.icon-remove-from-selection'),\r\n            $iconBefore = $container.find('.icon-move-before'),\r\n            $iconAfter = $container.find('.icon-move-after'),\r\n            $activeChoice = null,\r\n\r\n            choiceSelector = $choiceArea.selector + ' >li:not(.deactivated)',\r\n            resultSelector = $resultArea.selector + ' >li',\r\n\r\n            isDragAndDropEnabled,\r\n            dragOptions,\r\n            $dropzoneElement,\r\n            $dragContainer = $container.find('.drag-container'),\r\n\r\n            orientation = (interaction.attr('orientation')) ? interaction.attr('orientation') : 'vertical';\r\n\r\n        var _activeControls = function _activeControls(){\r\n            $iconAdd.addClass('inactive');\r\n            $iconRemove.removeClass('inactive').addClass('active');\r\n            $iconBefore.removeClass('inactive').addClass('active');\r\n            $iconAfter.removeClass('inactive').addClass('active');\r\n        };\r\n\r\n        var _resetControls = function _resetControls(){\r\n            $iconAdd.removeClass('inactive');\r\n            $iconRemove.removeClass('active').addClass('inactive');\r\n            $iconBefore.removeClass('active').addClass('inactive');\r\n            $iconAfter.removeClass('active').addClass('inactive');\r\n        };\r\n\r\n        var _setSelection = function _setSelection($choice){\r\n            if($activeChoice){\r\n                $activeChoice.removeClass('active');\r\n            }\r\n            $activeChoice = $choice;\r\n            $activeChoice.addClass('active');\r\n        };\r\n\r\n        var _resetSelection = function _resetSelection(){\r\n            if($activeChoice){\r\n                $activeChoice.removeClass('active');\r\n                $activeChoice = null;\r\n            }\r\n            _resetControls();\r\n        };\r\n\r\n        var _addChoiceToSelection = function _addChoiceToSelection($target, position) {\r\n            var $results = $(resultSelector);\r\n            _resetSelection();\r\n\r\n            //move choice to the result list:\r\n            if (typeof(position) !== 'undefined' && position < $results.length) {\r\n                $results.eq(position).before($target);\r\n            } else {\r\n                $resultArea.append($target);\r\n            }\r\n\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n\r\n            //update constraints :\r\n            instructionMgr.validateInstructions(interaction);\r\n        };\r\n\r\n        var _toggleResultSelection = function _toggleResultSelection($target) {\r\n            if($target.hasClass('active')){\r\n                _resetSelection();\r\n            }else{\r\n                _setSelection($target);\r\n                _activeControls();\r\n            }\r\n        };\r\n\r\n        var _removeChoice = function _removeChoice() {\r\n            if($activeChoice){\r\n\r\n                //restore choice back to choice list\r\n                $choiceArea.append($activeChoice);\r\n                containerHelper.triggerResponseChangeEvent(interaction);\r\n\r\n                //update constraints :\r\n                instructionMgr.validateInstructions(interaction);\r\n            }\r\n\r\n            _resetSelection();\r\n        };\r\n\r\n        var _moveResultBefore = function _moveResultBefore() {\r\n            var $prev = $activeChoice.prev();\r\n\r\n            if($prev.length){\r\n                $prev.before($activeChoice);\r\n                containerHelper.triggerResponseChangeEvent(interaction);\r\n            }\r\n        };\r\n\r\n        var _moveResultAfter = function _moveResultAfter() {\r\n            var $next = $activeChoice.next();\r\n\r\n            if($next.length){\r\n                $next.after($activeChoice);\r\n                containerHelper.triggerResponseChangeEvent(interaction);\r\n            }\r\n        };\r\n\r\n\r\n        // Point & click handlers\r\n\r\n        interact($container.selector).on('tap', function () {\r\n            _resetSelection();\r\n        });\r\n\r\n        interact(choiceSelector).on('tap', function (e) {\r\n            var $target = $(e.currentTarget);\r\n            e.stopPropagation();\r\n\r\n            $iconAdd.addClass('triggered');\r\n            setTimeout(function(){\r\n                $iconAdd.removeClass('triggered');\r\n            }, 150);\r\n\r\n            _addChoiceToSelection($target);\r\n        });\r\n\r\n        interact(resultSelector).on('tap', function (e) {\r\n            var $target = $(e.currentTarget);\r\n            e.stopPropagation();\r\n            _toggleResultSelection($target);\r\n        });\r\n\r\n        interact($iconRemove.selector).on('tap', function (e) {\r\n            e.stopPropagation();\r\n            _removeChoice();\r\n        });\r\n\r\n        interact($iconBefore.selector).on('tap', function (e) {\r\n            e.stopPropagation();\r\n            _moveResultBefore();\r\n        });\r\n\r\n        interact($iconAfter.selector).on('tap', function (e) {\r\n            e.stopPropagation();\r\n            _moveResultAfter();\r\n        });\r\n\r\n\r\n        // Drag & drop handlers\r\n\r\n        if (this.getOption && this.getOption(\"enableDragAndDrop\") && this.getOption(\"enableDragAndDrop\").order) {\r\n            isDragAndDropEnabled = this.getOption(\"enableDragAndDrop\").order;\r\n        }\r\n\r\n        function _iFrameDragFix(draggableSelector, target) {\r\n            interactUtils.iFrameDragFixOn(function () {\r\n                if (_isDropzoneVisible()) {\r\n                    interact($resultArea.selector).fire({\r\n                        type: 'drop',\r\n                        target: $dropzoneElement.eq(0),\r\n                        relatedTarget: target\r\n                    });\r\n                }\r\n                interact(draggableSelector).fire({\r\n                    type: 'dragend',\r\n                    target: target\r\n                });\r\n            });\r\n        }\r\n\r\n        if (isDragAndDropEnabled) {\r\n            $dropzoneElement = $('<li>', {'class' : 'dropzone qti-choice'});\r\n            $('<div>', {'class': 'qti-block'}).appendTo($dropzoneElement);\r\n\r\n            dragOptions = {\r\n                inertia: false,\r\n                autoScroll: true,\r\n                restrict: {\r\n                    restriction: \".qti-interaction\",\r\n                    endOnly: false,\r\n                    elementRect: {top: 0, left: 0, bottom: 1, right: 1}\r\n                }\r\n            };\r\n\r\n            // makes choices draggables\r\n            interact(choiceSelector).draggable(_.assign({}, dragOptions, {\r\n                onstart: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.addClass(\"dragged\");\r\n\r\n                    _iFrameDragFix(choiceSelector, e.target);\r\n                },\r\n                onmove: function (e) {\r\n                    var $target = $(e.target);\r\n                    interactUtils.moveElement(e.target, e.dx, e.dy);\r\n                    if (_isDropzoneVisible()) {\r\n                        _adjustDropzonePosition($target);\r\n                    }\r\n                },\r\n                onend: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.removeClass(\"dragged\");\r\n\r\n                    interactUtils.restoreOriginalPosition($target);\r\n                    interactUtils.iFrameDragFixOff();\r\n                }\r\n            })).styleCursor(false);\r\n\r\n            // makes result draggables\r\n            interact(resultSelector).draggable(_.assign({}, dragOptions, {\r\n                onstart: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.addClass(\"dragged\");\r\n\r\n                    _setSelection($target);\r\n\r\n                    // move dragged result to drag container\r\n                    $dragContainer.show();\r\n                    $dragContainer.offset($target.offset());\r\n                    if (orientation === 'horizontal') {\r\n                        $dragContainer.width($(e.currentTarget).width());\r\n                    } else {\r\n                        $dragContainer.width($target.parent().width());\r\n                    }\r\n                    $dragContainer.append($target);\r\n\r\n                    _iFrameDragFix(resultSelector, e.target);\r\n                },\r\n                onmove: function (e) {\r\n                    var $target = $(e.target);\r\n                    interactUtils.moveElement(e.target, e.dx, e.dy);\r\n                    if (_isDropzoneVisible()) {\r\n                        _adjustDropzonePosition($target);\r\n                    }\r\n                },\r\n                onend: function (e) {\r\n                    var $target = $(e.target),\r\n                        hasBeenDroppedInResultArea = ($target.parent === $resultArea);\r\n\r\n                    $target.removeClass(\"dragged\");\r\n                    $dragContainer.hide();\r\n\r\n                    if (! hasBeenDroppedInResultArea) {\r\n                        _removeChoice();\r\n                    }\r\n\r\n                    interactUtils.restoreOriginalPosition($target);\r\n                    interactUtils.iFrameDragFixOff();\r\n                }\r\n            })).styleCursor(false);\r\n\r\n            // makes result area droppable\r\n            interact($resultArea.selector).dropzone({\r\n                overlap: 0.5,\r\n                ondragenter: function (e) {\r\n                    var $dragged = $(e.relatedTarget);\r\n                    _insertDropzone($dragged);\r\n                    $dragged.addClass('droppable');\r\n                },\r\n                ondrop: function (e) {\r\n                    var $dragged = $(e.relatedTarget),\r\n                        dropzoneIndex = $(resultSelector).index($dropzoneElement);\r\n\r\n                    this.ondragleave(e);\r\n\r\n                    _addChoiceToSelection($dragged, dropzoneIndex);\r\n                    interactUtils.restoreOriginalPosition($dragged);\r\n                },\r\n                ondragleave: function (e) {\r\n                    var $dragged = $(e.relatedTarget);\r\n                    $dropzoneElement.remove();\r\n                    $dragged.removeClass('droppable');\r\n                }\r\n            });\r\n        }\r\n\r\n        function _isDropzoneVisible() {\r\n            return $.contains($container.get(0), $dropzoneElement.get(0));\r\n        }\r\n\r\n        function _insertDropzone($dragged) {\r\n            var draggedMiddle = _getMiddleOf($dragged),\r\n                previousMiddle = {\r\n                    x: 0,\r\n                    y: 0\r\n                },\r\n                insertPosition,\r\n                $dropzone;\r\n\r\n            // look for position where to insert dropzone\r\n            $(resultSelector).each(function(index) {\r\n                var currentMiddle = _getMiddleOf($(this));\r\n\r\n                if (orientation !== 'horizontal') {\r\n                    if (draggedMiddle.y > previousMiddle.y && draggedMiddle.y < currentMiddle.y) {\r\n                        insertPosition = index;\r\n                        return false;\r\n                    }\r\n                    previousMiddle.y = currentMiddle.y;\r\n                } else {\r\n                    if (draggedMiddle.x > previousMiddle.x && draggedMiddle.x < currentMiddle.x) {\r\n                        insertPosition = index;\r\n                        return false;\r\n                    }\r\n                    previousMiddle.x = currentMiddle.x;\r\n                }\r\n            });\r\n            // append dropzone to DOM\r\n            if (typeof(insertPosition) !== 'undefined') {\r\n                $(resultSelector).eq(insertPosition).before($dropzoneElement);\r\n            } else {\r\n                // no index found, we just append to the end\r\n                $resultArea.append($dropzoneElement);\r\n            }\r\n\r\n            // style dropzone\r\n            $dropzoneElement.height($dragged.height());\r\n            $dropzoneElement.find('div').text($dragged.text());\r\n        }\r\n\r\n        function _adjustDropzonePosition($dragged) {\r\n            var draggedBox = $dragged.get(0).getBoundingClientRect(),\r\n                $prevResult = $dropzoneElement.prev('.qti-choice'),\r\n                $nextResult = $dropzoneElement.next('.qti-choice'),\r\n                prevMiddle = ($prevResult.length > 0) ? _getMiddleOf($prevResult) : false,\r\n                nextMiddle = ($nextResult.length > 0) ? _getMiddleOf($nextResult) : false;\r\n\r\n            if (orientation !== 'horizontal') {\r\n                if (prevMiddle && (draggedBox.top < prevMiddle.y)) {\r\n                    $prevResult.before($dropzoneElement);\r\n                }\r\n                if (nextMiddle && (draggedBox.bottom > nextMiddle.y)) {\r\n                    $nextResult.after($dropzoneElement);\r\n                }\r\n            } else {\r\n                if (prevMiddle && (draggedBox.left < prevMiddle.x)) {\r\n                    $prevResult.before($dropzoneElement);\r\n                }\r\n                if (nextMiddle && (draggedBox.right > nextMiddle.x)) {\r\n                    $nextResult.after($dropzoneElement);\r\n                }\r\n            }\r\n        }\r\n\r\n        function _getMiddleOf($element) {\r\n            var elementBox = $element.get(0).getBoundingClientRect();\r\n            return {\r\n                x: elementBox.left + elementBox.width / 2,\r\n                y: elementBox.top + elementBox.height / 2\r\n            };\r\n        }\r\n\r\n        // rendering init\r\n\r\n        _setInstructions(interaction);\r\n\r\n        //bind event listener in case the attributes change dynamically on runtime\r\n        $(document).on('attributeChange.qti-widget.commonRenderer', function(e, data){\r\n            if(data.element.getSerial() === interaction.getSerial()){\r\n                if(data.key === 'maxChoices' || data.key === 'minChoices'){\r\n                    instructionMgr.removeInstructions(interaction);\r\n                    _setInstructions(interaction);\r\n                    instructionMgr.validateInstructions(interaction);\r\n                }\r\n            }\r\n        });\r\n\r\n        _freezeSize($container);\r\n    };\r\n\r\n    var _freezeSize = function($container){\r\n        var $orderArea = $container.find('.order-interaction-area');\r\n        $orderArea.height($orderArea.height());\r\n    };\r\n\r\n    var _setInstructions = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var $choiceArea = $('.choice-area', $container),\r\n            $resultArea = $('.result-area', $container),\r\n            min = parseInt(interaction.attr('minChoices'), 10),\r\n            max = parseInt(interaction.attr('maxChoices'), 10);\r\n\r\n        if(min){\r\n            instructionMgr.appendInstruction(interaction, __('You must use at least %d choices', min), function(){\r\n                if($resultArea.find('>li').length >= min){\r\n                    this.setLevel('success');\r\n                }else{\r\n                    this.reset();\r\n                }\r\n            });\r\n        }\r\n\r\n        if(max && max < _.size(interaction.getChoices())){\r\n            var instructionMax = instructionMgr.appendInstruction(interaction, __('You can use maximum %d choices', max), function(){\r\n                if($resultArea.find('>li').length >= max){\r\n                    $choiceArea.find('>li').addClass('deactivated');\r\n                    this.setMessage(__('Maximum choices reached'));\r\n                }else{\r\n                    $choiceArea.find('>li').removeClass('deactivated');\r\n                    this.reset();\r\n                }\r\n            });\r\n\r\n            interact($choiceArea.selector + ' >li.deactivated').on('tap', function(e) {\r\n                var $target = $(e.currentTarget);\r\n                $target.addClass('brd-error');\r\n                instructionMax.setLevel('warning', 2000);\r\n                setTimeout(function(){\r\n                    $target.removeClass('brd-error');\r\n                }, 150);\r\n            });\r\n\r\n            // we don't check for isDragAndDropEnabled on purpose, as this binding is not to allow dragging,\r\n            // but only to provide feedback in case of a drag action on an inactive choice\r\n            interact($choiceArea.selector + ' >li.deactivated').draggable({\r\n                onstart: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.addClass('brd-error');\r\n                    instructionMax.setLevel('warning');\r\n                },\r\n                onend: function (e) {\r\n                    var $target = $(e.target);\r\n                    $target.removeClass('brd-error');\r\n                    instructionMax.setLevel('info');\r\n                }\r\n            }).styleCursor(false);\r\n        }\r\n    };\r\n\r\n    var resetResponse = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var initialOrder = _.keys(interaction.getChoices());\r\n        var $choiceArea = $('.choice-area', $container).append($('.result-area>li', $container));\r\n        var $choices = $choiceArea.children('.qti-choice');\r\n\r\n        $container.find('.qti-choice.active').each(function deactivateChoice() {\r\n            interactUtils.tapOn(this);\r\n        });\r\n\r\n        $choices.detach().sort(function(choice1, choice2){\r\n            return (_.indexOf(initialOrder, $(choice1).data('serial')) > _.indexOf(initialOrder, $(choice2).data('serial')));\r\n        });\r\n        $choiceArea.prepend($choices);\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10283\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n        var $choiceArea = $('.choice-area', $container);\r\n        var $resultArea = $('.result-area', $container);\r\n\r\n        if(response === null || _.isEmpty(response)){\r\n            resetResponse(interaction);\r\n        }else{\r\n            try{\r\n                _.each(pciResponse.unserialize(response, interaction), function(identifier){\r\n                    $resultArea.append($choiceArea.find('[data-identifier=' + identifier + ']'));\r\n                });\r\n            }catch(e){\r\n                throw new Error('wrong response format in argument : ' + e);\r\n            }\r\n        }\r\n\r\n        instructionMgr.validateInstructions(interaction);\r\n    };\r\n\r\n    var _getRawResponse = function(interaction){\r\n        var $container = containerHelper.get(interaction);\r\n        var response = [];\r\n        $('.result-area>li', $container).each(function(){\r\n            response.push($(this).data('identifier'));\r\n        });\r\n        return response;\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10283\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        return pciResponse.serialize(_getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    /**\r\n     * Set additionnal data to the template (data that are not really part of the model).\r\n     * @param {Object} interaction - the interaction\r\n     * @param {Object} [data] - interaction custom data\r\n     * @returns {Object} custom data\r\n     */\r\n    var getCustomData = function(interaction, data){\r\n\r\n        return _.merge(data || {}, {\r\n            horizontal : (interaction.attr('orientation') === 'horizontal')\r\n        });\r\n\r\n    };\r\n\r\n    /**\r\n     * Destroy the interaction by leaving the DOM exactly in the same state it was before loading the interaction.\r\n     * @param {Object} interaction - the interaction\r\n     */\r\n    var destroy = function(interaction){\r\n\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        //first, remove all events\r\n        var selectors = [\r\n            '.choice-area >li:not(.deactivated)',\r\n            '.result-area >li',\r\n            '.icon-add-to-selection',\r\n            '.icon-remove-from-selection',\r\n            '.icon-move-before',\r\n            '.icon-move-after'\r\n        ];\r\n        selectors.forEach(function unbindInteractEvents(selector) {\r\n            interact($container.find(selector).selector).unset();\r\n        });\r\n\r\n        $(document).off('.commonRenderer');\r\n\r\n        $container.find('.order-interaction-area').removeAttr('style');\r\n\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        var $container;\r\n\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n\r\n            //restore order of previously shuffled choices\r\n            if(_.isArray(state.order) && state.order.length === _.size(interaction.getChoices())){\r\n\r\n                $container = containerHelper.get(interaction);\r\n\r\n                $('.choice-area .qti-choice', $container)\r\n                    .sort(function(a, b){\r\n                        var aIndex = _.indexOf(state.order, $(a).data('identifier'));\r\n                        var bIndex = _.indexOf(state.order, $(b).data('identifier'));\r\n                        if(aIndex > bIndex) {\r\n                            return 1;\r\n                        }\r\n                        if(aIndex < bIndex) {\r\n                            return -1;\r\n                        }\r\n                        return 0;\r\n                    })\r\n                    .detach()\r\n                    .appendTo($('.choice-area', $container));\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n\r\n        //we store also the choice order if shuffled\r\n        if(interaction.attr('shuffle') === true){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            state.order = [];\r\n            $('.choice-area .qti-choice', $container).each(function(){\r\n               state.order.push($(this).data('identifier'));\r\n            });\r\n        }\r\n        return state;\r\n    };\r\n\r\n     /**\r\n     * Expose the common renderer for the order interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/OrderInteraction\r\n     */\r\n    return {\r\n        qtiClass : 'orderInteraction',\r\n        getData : getCustomData,\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse: resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/states/Question',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/choiceInteraction/states/Question'\r\n], function(stateFactory, Question, ChoiceInteractionQuestionState){\r\n\r\n    var OrderInteractionStateQuestion = stateFactory.extend(Question);\r\n    \r\n    //reuse the same exact same form as choice interaction\r\n    OrderInteractionStateQuestion.prototype.initForm = function(){\r\n         ChoiceInteractionQuestionState.prototype.initForm.call(this, false);\r\n    };\r\n\r\n    return OrderInteractionStateQuestion;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/states/Correct',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'lodash',\r\n    'i18n'\r\n], function(stateFactory, Correct, commonRenderer, instructionMgr, _, __){\r\n\r\n    var InlineChoiceInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n        \r\n        _createResponseWidget(this.widget);\r\n        \r\n    }, function(){\r\n        \r\n        _destroyResponseWidget(this.widget);\r\n        \r\n    });\r\n    \r\n    var _createResponseWidget = function(widget){\r\n\r\n        var interaction = widget.element,\r\n            response = interaction.getResponseDeclaration(),\r\n            correctResponse = _.values(response.getCorrect());\r\n\r\n        instructionMgr.appendInstruction(widget.element, __('Please define the correct order in the box to the right.'));\r\n\r\n        commonRenderer.render(widget.element);\r\n        commonRenderer.setResponse(interaction, _formatResponse(correctResponse));\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            response.setCorrect(_unformatResponse(data.response));\r\n        });\r\n    };\r\n    \r\n    var _destroyResponseWidget = function(widget){\r\n        \r\n        widget.$container.off('responseChange.qti-widget');\r\n\r\n        commonRenderer.resetResponse(widget.element);\r\n\r\n        commonRenderer.destroy(widget.element);\r\n    };\r\n    \r\n    var _formatResponse = function(response){\r\n        return {list : {identifier : response}};\r\n    };\r\n\r\n    var _unformatResponse = function(formatedResponse){\r\n        var res = [];\r\n        if(formatedResponse.list && formatedResponse.list.identifier){\r\n            res = formatedResponse.list.identifier;\r\n        }\r\n        return res;\r\n    };\r\n    \r\n    return InlineChoiceInteractionStateCorrect;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/states/Correct'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/states/states'\r\n], function(Widget, states){\r\n\r\n    var OrderInteractionWidget = Widget.clone();\r\n\r\n    OrderInteractionWidget.initCreator = function(){\r\n        \r\n        this.registerStates(states);\r\n        \r\n        Widget.initCreator.call(this);\r\n    };\r\n    \r\n    return OrderInteractionWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/OrderInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/OrderInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/orderInteraction/Widget'\r\n], function(_, OrderInteraction, OrderInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorOrderInteraction = _.clone(OrderInteraction);\r\n\r\n    CreatorOrderInteraction.render = function(interaction, options){\r\n\r\n        OrderInteractionWidget.build(\r\n            interaction,\r\n            OrderInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorOrderInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/customInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"qti-interaction qti-customInteraction\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  if (helper = helpers.markup) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.markup); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n\r\n/**\r\n * Portable element helper\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/PortableElement',['jquery'], function($){\r\n    'use strict';\r\n\r\n    var imgSrcPattern = /(<img[^>]*src=[\"'])([^\"']+)([\"'])/ig;\r\n\r\n    /**\r\n     * Replace all identified relative media urls by the absolute one.\r\n     * For now only images are supported.\r\n     *\r\n     * @param {String} html - the html to parse\r\n     * @param {Object} the renderer\r\n     * @returns {String} the html without updated URLs\r\n     */\r\n    function fixMarkupMediaSources(html, renderer){\r\n        html = html || '';\r\n\r\n        return html.replace(imgSrcPattern, function(substr, $1, $2, $3){\r\n            var resolved = renderer.resolveUrl($2) || $2;\r\n            return $1 + resolved + $3;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @exports taoQtiItem/qtiCommonRenderer/helpers/PortableElement\r\n     */\r\n    return {\r\n        fixMarkupMediaSources : fixMarkupMediaSources,\r\n    };\r\n});\r\n\n","define('qtiCustomInteractionContext',[],function(){\r\n\r\n    //need a global reference to have pciHooks shared in two different requirejs context (\"default\" and \"portableCustomInteraction\")\r\n    window._pciHooks = window._pciHooks || {};\r\n\r\n    /**\r\n     * Global object accessible by all PCIs\r\n     * \r\n     * @type Object\r\n     */\r\n    var taoQtiCustomInteractionContext = {\r\n        /**\r\n         * register a custom interaction (its runtime model) in global registery\r\n         * register a renderer\r\n         * \r\n         * @param {Object} pciHook\r\n         * @returns {undefined}\r\n         */\r\n        register : function(pciHook){\r\n            //@todo check pciHook validity\r\n            window._pciHooks[pciHook.getTypeIdentifier()] = pciHook;\r\n        },\r\n        /**\r\n         * notify when a custom interaction is ready for test taker interaction\r\n         * \r\n         * @param {string} pciInstance\r\n         * @fires custominteractionready\r\n         */\r\n        notifyReady : function(pciInstance){\r\n            //@todo add pciIntance as event data and notify event to delivery engine\r\n        },\r\n        /**\r\n         * notify when a custom interaction is completed by test taker\r\n         * \r\n         * @param {string} pciInstance\r\n         * @fires custominteractiondone\r\n         */\r\n        notifyDone : function(pciInstance){\r\n            //@todo add pciIntance as event data and notify event to delivery engine\r\n        },\r\n\r\n        onready : function onready(customInteraction, state){\r\n            //to be implemented in future story\r\n        },\r\n        ondone : function ondone(customInteraction, response, state, status){\r\n            //to be implemented in future story\r\n        },\r\n\r\n\r\n        /**\r\n         * Get a cloned object representing the PCI model\r\n         * \r\n         * @param {string} pciTypeIdentifier\r\n         * @returns {Object} clonedPciModel\r\n         */\r\n        createPciInstance : function(pciTypeIdentifier){\r\n\r\n            if(window._pciHooks[pciTypeIdentifier]){\r\n\r\n                var instance = {},\r\n                    proto = window._pciHooks[pciTypeIdentifier];\r\n\r\n                for(var name in proto){\r\n                    if(typeof proto[name] === 'function'){\r\n                        //@todo : delegate function call for better performance ?\r\n                        instance[name] = proto[name];\r\n                    }else if(proto[name] !== null && typeof proto[name] === 'object'){\r\n                        //a plain object:\r\n                        instance[name] = proto[name].constructor();\r\n                    }else{\r\n                        //not an object (nor a function) : e.g. 0, 123, '123', null, undefined\r\n                        instance[name] = proto[name];\r\n                    }\r\n                }\r\n\r\n                return instance;\r\n\r\n            }else{\r\n                throw 'no portable custom interaction hook found with the id ' + pciTypeIdentifier;\r\n            }\r\n        }\r\n    };\r\n    \r\n    \r\n    return taoQtiCustomInteractionContext;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/PortableCustomInteraction',[\r\n    'lodash',\r\n    'core/promise',\r\n    'core/logger',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/customInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PortableElement',\r\n    'qtiCustomInteractionContext',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/portableElementRegistry/ciRegistry'\r\n], function(_, Promise, loggerFactory, tpl, containerHelper, PortableElement, qtiCustomInteractionContext, util, ciRegistry){\r\n    'use strict';\r\n\r\n    var logger = loggerFactory('taoQtiItem/qtiCommonRenderer/renderers/interactions/PortableCustomInteraction');\r\n\r\n    var pciReadyCallback = function pciReadyCallback(pci, state){\r\n        //standard callback function to be implemented in a future story\r\n        logger.info('pciReadyCallback called on PCI '+pci.typeIdentifier);\r\n    }\r\n\r\n    var pciDoneCallback = function pciDoneCallback(pci, response, state, status){\r\n        //standard callback function to be implemented in a future story\r\n        logger.info('pciDoneCallback called on PCI '+pci.typeIdentifier);\r\n    }\r\n\r\n    /**\r\n     * Get the PCI instance associated to the interaction object\r\n     * If none exists, create a new one based on the PCI typeIdentifier\r\n     *\r\n     * @param {Object} interaction - the js object representing the interaction\r\n     * @returns {Object} PCI instance\r\n     */\r\n    var _getPci = function _getPci(interaction, model){\r\n\r\n        var pciTypeIdentifier,\r\n            pci = interaction.data('pci') || undefined;\r\n\r\n        if(!pci){\r\n\r\n            pciTypeIdentifier = interaction.typeIdentifier;\r\n            pci = qtiCustomInteractionContext.createPciInstance(pciTypeIdentifier);\r\n\r\n            if(pci){\r\n\r\n                //binds the PCI instance to TAO interaction object and vice versa\r\n                interaction.data('pci', pci);\r\n                pci._taoCustomInteraction = interaction;\r\n\r\n                if(model){\r\n                    interaction.data('pci-model', model);\r\n                }\r\n\r\n            }else{\r\n                throw 'no custom interaction hook found for the type ' + pciTypeIdentifier;\r\n            }\r\n        }\r\n\r\n        return pci;\r\n    };\r\n\r\n    var _isPciModel = function _isPciModel(interaction, model){\r\n        return (model && interaction.data('pci-model') === model);\r\n    }\r\n\r\n    /**\r\n     * Execute javascript codes to bring the interaction to life.\r\n     * At this point, the html markup must already be ready in the document.\r\n     *\r\n     * It is done in 5 steps :\r\n     * 1. configure the paths\r\n     * 2. require all required libs\r\n     * 3. create a pci instance based on the interaction model\r\n     * 4. initialize the rendering\r\n     * 5. restore full state if applicable (state and/or response)\r\n     *\r\n     * @param {Object} interaction\r\n     */\r\n    var render = function render(interaction, options){\r\n        var self = this;\r\n\r\n        options = options || {};\r\n        return new Promise(function(resolve, reject){\r\n\r\n            var id                 = interaction.attr('responseIdentifier');\r\n\r\n            var typeIdentifier     = interaction.typeIdentifier;\r\n            var properties         = _.clone(interaction.properties);//clone properties to prevent modification\r\n            var $dom               = containerHelper.get(interaction).children();\r\n            var assetManager       = self.getAssetManager();\r\n\r\n            //restore state and response to renderer here:\r\n            var state;\r\n            var response = {};\r\n\r\n            if(options.state && options.state[id]){\r\n                state = options.state[id];\r\n            }\r\n            response[id] = {base : null};\r\n\r\n            ciRegistry.loadRuntimes().then(function(){\r\n\r\n                var config = {};\r\n                var requireEntries = [];\r\n                var runtime = ciRegistry.getRuntime(typeIdentifier);\r\n\r\n                if(!runtime){\r\n                    return reject('The runtime for the pci cannot be found : ' + typeIdentifier);\r\n                }\r\n\r\n                //load hook if applicable\r\n                if(runtime.hook){\r\n                    requireEntries.push(runtime.hook.replace(/\\.js$/, ''));\r\n                }\r\n\r\n                //load libs\r\n                _.forEach(runtime.libraries, function(lib) {\r\n                    requireEntries.push(lib.replace(/\\.js$/, ''));\r\n                });\r\n\r\n                //load libs\r\n                _.forEach(runtime.libraries, function(lib) {\r\n                    requireEntries.push(lib.replace(/\\.js$/, ''));\r\n                });\r\n\r\n                //load modules\r\n                _.forEach(runtime.modules, function(module, id){\r\n                    requireEntries.push(id);\r\n                });\r\n\r\n                //load stylesheets\r\n                _.forEach(runtime.stylesheets, function(stylesheet){\r\n                    requireEntries.push('css!'+stylesheet.replace(/\\.css$/, ''));\r\n                });\r\n\r\n                //console.log(requireEntries);\r\n\r\n                //load the entrypoint+stylesheets\r\n                require(requireEntries, function(){\r\n\r\n                    var pci = _getPci(interaction, runtime.model);\r\n                    var pciAssetManager = {\r\n                        resolve : function resolve(url){\r\n                            var resolved = assetManager.resolveBy('portableElementLocation', url);\r\n                            if(resolved === url || _.isUndefined(resolved)){\r\n                                return assetManager.resolve(url);\r\n                            }else{\r\n                                return resolved;\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                    if(pci){\r\n\r\n                        if(_isPciModel(interaction, 'IMSPCI')){\r\n                            config = {\r\n                                properties : properties,\r\n                                templateVariables : {},//not supported yet\r\n                                boundTo : response,\r\n                                onready : pciReadyCallback,\r\n                                ondone : pciDoneCallback,\r\n                                status : 'interacting',//only support interacting state currently(TODO: solution, review),\r\n                                assetManager : pciAssetManager\r\n                            };\r\n\r\n                            pci.getInstance($dom[0], config, state);\r\n                        }else{\r\n                            //call pci initialize() to render the pci\r\n                            pci.initialize(id, $dom[0], properties, pciAssetManager);\r\n                        }\r\n\r\n                        //forward internal PCI event responseChange\r\n                        interaction.onPci('responseChange', function(){\r\n                            containerHelper.triggerResponseChangeEvent(interaction);\r\n                        });\r\n\r\n                        return resolve();\r\n                    }\r\n\r\n                    return reject('Unable to initialize pci \"' + id + '\": '+error);\r\n\r\n                }, reject);\r\n\r\n            }).catch(function(error){\r\n                reject('Error loading runtime \"' + id + '\": '+error);\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Programmatically set the response following the json schema described in\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * @param {Object} interaction\r\n     * @param {Object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n        _getPci(interaction).setResponse(response);\r\n    };\r\n\r\n    /**\r\n     * Get the response in the json format described in\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * @param {Object} interaction\r\n     * @returns {Object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        return _getPci(interaction).getResponse();\r\n    };\r\n\r\n    /**\r\n     * Remove the current response set in the interaction\r\n     * The state may not be restored at this point.\r\n     *\r\n     * @param {Object} interaction\r\n     */\r\n    var resetResponse = function(interaction){\r\n        _getPci(interaction).resetResponse();\r\n    };\r\n\r\n    /**\r\n     * Reverse operation performed by render()\r\n     * After this function is executed, only the inital naked markup remains\r\n     * Event listeners are removed and the state and the response are reset\r\n     *\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function(interaction){\r\n        _getPci(interaction).destroy();\r\n    };\r\n\r\n    /**\r\n     * Restore the state of the interaction from the serializedState.\r\n     *\r\n     * @param {Object} interaction\r\n     * @param {Object} serializedState - json format\r\n     */\r\n    var setState = function(interaction, serializedState){\r\n        if(!_isPciModel(interaction, 'IMSPCI')){\r\n            _getPci(interaction).setSerializedState(serializedState);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the current state of the interaction as a string.\r\n     * It enables saving the state for later usage.\r\n     *\r\n     * @param {Object} interaction\r\n     * @returns {Object} json format\r\n     */\r\n    var getState = function(interaction){\r\n        if(_isPciModel(interaction, 'IMSPCI')){\r\n            return _getPci(interaction).getState();\r\n        }else{\r\n            return _getPci(interaction).getSerializedState();\r\n        }\r\n    };\r\n\r\n    return {\r\n        qtiClass : 'customInteraction',\r\n        template : tpl,\r\n        getData : function(customInteraction, data){\r\n\r\n            //remove ns + fix media file path\r\n            var markup = data.markup;\r\n            markup = util.removeMarkupNamespaces(markup);\r\n            markup = PortableElement.fixMarkupMediaSources(markup, this);\r\n            data.markup = markup;\r\n\r\n            return data;\r\n        },\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        getState : getState,\r\n        setState : setState\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\n\r\n/**\r\n * PCI Creator Renderer\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/PortableCustomInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/PortableCustomInteraction',\r\n    'taoQtiItem/portableElementRegistry/ciRegistry',\r\n    'taoQtiItem/qtiCreator/helper/commonRenderer'\r\n], function(_, Renderer, ciRegistry, commonRenderer){\r\n    'use strict';\r\n\r\n    //clone the common renderer\r\n    var CreatorCustomInteraction = _.clone(Renderer);\r\n\r\n    /**\r\n     * Override the render method\r\n     */\r\n    CreatorCustomInteraction.render = function render(interaction, options){\r\n\r\n        var pciCreator = ciRegistry.getCreator(interaction.typeIdentifier).module;\r\n\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n\r\n        //initial rendering:\r\n        Renderer.render.call(commonRenderer.get(), interaction);\r\n\r\n        if(pciCreator){\r\n            pciCreator.getWidget().build(\r\n                interaction,\r\n                Renderer.getContainer(interaction),\r\n                this.getOption('interactionOptionForm'),\r\n                this.getOption('responseOptionForm'),\r\n                options\r\n            );\r\n        }else{\r\n            //in case the pci has been imported with a runtime only (no creator)\r\n            //@todo allow deleting it\r\n        }\r\n\r\n    };\r\n\r\n    return CreatorCustomInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/selectPointInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-graphicInteraction qti-selectPointInteraction clearfix\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"image-editor solid\\\">\\r\\n        <div id='graphic-paper-\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"' class=\\\"main-image-box\\\"></div>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * The Common Render for the Select Point Interaction\r\n *\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/selectPointInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager'\r\n], function($, _, __, Promise, tpl, graphic, pciResponse, containerHelper, instructionMgr){\r\n    'use strict';\r\n\r\n    /**\r\n     * Get the responses from the interaction\r\n     * @param {Object} interaction\r\n     * @returns {Array} of points\r\n     */\r\n    var getRawResponse = function getRawResponse(interaction){\r\n        if(interaction && interaction.paper && _.isArray(interaction.paper.points)){\r\n            return _.map(interaction.paper.points, function(point){\r\n                return [point.x, point.y];\r\n            });\r\n        }\r\n        return [];\r\n    };\r\n\r\n    /**\r\n     * Add a new point to the interaction\r\n     * @param {Object} interaction\r\n     * @param {Object} point - the x/y point\r\n     */\r\n    var addPoint = function addPoint(interaction, point){\r\n        var maxChoices = interaction.attr('maxChoices');\r\n\r\n        var pointChange = function pointChange(){\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n            instructionMgr.validateInstructions(interaction);\r\n        };\r\n\r\n        if(maxChoices > 0 && getRawResponse(interaction).length >= maxChoices){\r\n            instructionMgr.validateInstructions(interaction);\r\n        } else {\r\n\r\n            if(!_.isArray(interaction.paper.points)){\r\n                interaction.paper.points = [];\r\n            }\r\n\r\n            graphic.createTarget(interaction.paper, {\r\n                point : point,\r\n                create : function create(target){\r\n                    if(interaction.isTouch && target && target.getBBox){\r\n                        graphic.createTouchCircle(interaction.paper, target.getBBox());\r\n                    }\r\n\r\n                    interaction.paper.points.push(point);\r\n\r\n                    pointChange();\r\n                },\r\n                remove : function remove(){\r\n\r\n                    _.remove(interaction.paper.points, point);\r\n\r\n                    pointChange();\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Make the image clickable and place targets at the given position.\r\n     * @param {Object} interaction\r\n     */\r\n    var enableSelection = function enableSelection(interaction){\r\n        var $container      = containerHelper.get(interaction);\r\n        var $imageBox       = $container.find('.main-image-box');\r\n        var isResponsive    = $container.hasClass('responsive');\r\n        var image           = interaction.paper.getById('bg-image-' + interaction.serial);\r\n\r\n        interaction.paper.isTouch = false;\r\n\r\n        //used to see if we are in a touch context\r\n        image.touchstart(function(){\r\n            interaction.paper.isTouch = true;\r\n            image.untouchstart();\r\n        });\r\n\r\n        //get the point on click\r\n        image.click(function imageClicked(event){\r\n            addPoint(interaction, graphic.getPoint(event, interaction.paper, $imageBox, isResponsive));\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {Object} interaction\r\n     */\r\n    var render = function render(interaction){\r\n        var self = this;\r\n\r\n        return new Promise(function(resolve){\r\n            var $container = containerHelper.get(interaction);\r\n            var background = interaction.object.attributes;\r\n\r\n            $container\r\n                .off('resized.qti-widget.resolve')\r\n                .one('resized.qti-widget.resolve', resolve);\r\n\r\n            //create the paper\r\n            interaction.paper = graphic.responsivePaper( 'graphic-paper-' + interaction.serial, interaction.serial, {\r\n                width       : background.width,\r\n                height      : background.height,\r\n                img         : self.resolveUrl(background.data),\r\n                imgId       : 'bg-image-' + interaction.serial,\r\n                container   : $container\r\n            });\r\n\r\n            //enable to select the paper to position a target\r\n            enableSelection(interaction);\r\n\r\n            //set up the constraints instructions\r\n            instructionMgr.minMaxChoiceInstructions(interaction, {\r\n                min: interaction.attr('minChoices'),\r\n                max: interaction.attr('maxChoices'),\r\n                choiceCount : false,\r\n                getResponse : getRawResponse,\r\n                onError : function(data){\r\n                    if(data){\r\n                        graphic.highlightError(data.target, 'success');\r\n                    }\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {Object} interaction\r\n     * @param {Object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n        var responseValues;\r\n\r\n        if(response && interaction.paper){\r\n            try{\r\n                responseValues = pciResponse.unserialize(response, interaction);\r\n\r\n                if(interaction.getResponseDeclaration().attr('cardinality') === 'single'){\r\n                    responseValues = [responseValues];\r\n                }\r\n                _(responseValues)\r\n                    .filter(function(point){\r\n                        return _.isArray(point) && point.length === 2;\r\n                    })\r\n                    .forEach(function(point){\r\n                        addPoint(interaction, {\r\n                            x : point[0],\r\n                            y : point[1]\r\n                        });\r\n                    });\r\n            } catch (err) {\r\n                return;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Reset the current responses of the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {Object} interaction\r\n     */\r\n    var resetResponse = function resetResponse(interaction){\r\n        if(interaction && interaction.paper){\r\n            interaction.paper.points = [];\r\n\r\n            interaction.paper.forEach(function(element){\r\n                var point = element.data('point');\r\n                if(typeof point === 'object'){\r\n                    graphic.trigger(element, 'click');\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    /**\r\n     i* Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {Object} interaction\r\n     * @returns {Object} the response\r\n     */\r\n    var getResponse = function(interaction){\r\n        return pciResponse.serialize(getRawResponse(interaction), interaction);\r\n    };\r\n\r\n    /**\r\n     * Clean interaction destroy\r\n     * @param {Object} interaction\r\n     */\r\n    var destroy = function destroy(interaction){\r\n        var $container;\r\n        if(interaction.paper){\r\n            $container = containerHelper.get(interaction);\r\n\r\n            $(window).off('resize.qti-widget.' + interaction.serial);\r\n            $container.off('resize.qti-widget.' + interaction.serial);\r\n\r\n            interaction.paper.clear();\r\n            instructionMgr.removeInstructions(interaction);\r\n\r\n            $('.main-image-box', $container).empty().removeAttr('style');\r\n            $('.image-editor', $container).removeAttr('style');\r\n        }\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Expose the common renderer for the interaction\r\n     * @exports qtiCommonRenderer/renderers/interactions/SelectPointInteraction\r\n     */\r\n    return {\r\n        qtiClass:      'selectPointInteraction',\r\n        template:      tpl,\r\n        render:        render,\r\n        getContainer:  containerHelper.get,\r\n        setResponse:   setResponse,\r\n        getResponse:   getResponse,\r\n        resetResponse: resetResponse,\r\n        destroy:       destroy,\r\n        setState:      setState,\r\n        getState:      getState\r\n    };\r\n});\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Sleep',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep'\r\n], function(stateFactory, SleepState){\r\n\r\n    'use strict';\r\n\r\n    var initSleepState = function initSleepState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        widget.on('metaChange', function(data){\r\n            if(data.key === 'responsive'){\r\n                if(data.value === true){\r\n                    interaction.addClass('responsive');\r\n                } else {\r\n                    interaction.removeClass('responsive');\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    var exitSleepState = function exitSleepState(){\r\n        $('.image-editor.solid, .block-listing.source', this.widget.$container).css('min-width', 0);\r\n    };\r\n \r\n    return stateFactory.extend(SleepState, initSleepState, exitSleepState); \r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/selectPoint', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n\\r\\n    \\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Interaction Background\", options) : helperMissing.call(depth0, \"__\", \"Interaction Background\", options)))\n    + \"</h3>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"data\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the image.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the image.\", options)))\n    + \"</div>\\r\\n        <input type=\\\"text\\\" name=\\\"data\\\" value=\\\"\";\n  if (helper = helpers.data) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.data); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n        <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select image\", options) : helperMissing.call(depth0, \"__\", \"Select image\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"panel media-sizer-panel\\\">\\r\\n        <!-- media sizer goes here -->\\r\\n    </div>\\r\\n    <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n    <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" />\\r\\n\\r\\n\\r\\n    <input name=\\\"type\\\" value=\\\"\";\n  if (helper = helpers.type) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.type); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"hidden\\\" readonly />\\r\\n\\r\\n    <hr>\\r\\n\\r\\n    <h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Allowed choices\", options) : helperMissing.call(depth0, \"__\", \"Allowed choices\", options)))\n    + \"</h3>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The minimum number of choices that the candidate is required to select to form a valid response.\", options) : helperMissing.call(depth0, \"__\", \"The minimum number of choices that the candidate is required to select to form a valid response.\", options)))\n    + \"<br>\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maximum number of choices that the candidate is allowed to select.\", options) : helperMissing.call(depth0, \"__\", \"The maximum number of choices that the candidate is allowed to select.\", options)))\n    + \"\\r\\n        </span>\\r\\n\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <div>\\r\\n            <label for=\\\"minChoices\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Min\", options) : helperMissing.call(depth0, \"__\", \"Min\", options)))\n    + \"</label>\\r\\n        <input name=\\\"minChoices\\\" value=\\\"\";\n  if (helper = helpers.minChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.minChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n        <div>\\r\\n            <label for=\\\"maxChoices\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max\", options) : helperMissing.call(depth0, \"__\", \"Max\", options)))\n    + \"</label>\\r\\n        <input name=\\\"maxChoices\\\" value=\\\"\";\n  if (helper = helpers.maxChoices) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxChoices); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" type=\\\"text\\\" />\\r\\n    </div>\\r\\n    </div>\\r\\n\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Question',[\r\n    'jquery',\r\n    'lodash',\r\n    'util/image',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/imageSelector',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/selectPoint',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/resourceManager',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/bgImage',\r\n    'ui/mediasizer'\r\n], function($, _, imageUtil, stateFactory, Question, imageSelector, formElement, interactionFormElement, formTpl, resourceManager, bgImage){\r\n\r\n    'use strict';\r\n\r\n    /**\r\n     * Question State initialization: set up side bar, editors and shae factory\r\n     */\r\n    var initQuestionState = function initQuestionState(){\r\n    };\r\n\r\n    /**\r\n     * Exit the question state, leave the room cleaned up\r\n     */\r\n    var exitQuestionState = function initQuestionState(){\r\n        var widget      = this.widget;\r\n        var interaction = widget.element;\r\n        var valid       = !!interaction.object.attr('data');\r\n\r\n        widget.isValid('selectPointInteraction', valid);\r\n    };\r\n\r\n    /**\r\n     * The question state for the selectPoint interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Question\r\n     */\r\n    var SelectPointInteractionStateQuestion = stateFactory.extend(Question, initQuestionState, exitQuestionState);\r\n\r\n    /**\r\n     * Initialize the form linked to the interaction\r\n     */\r\n    SelectPointInteractionStateQuestion.prototype.initForm = function(){\r\n        var widget = this.widget;\r\n        var options = widget.options;\r\n        var interaction = widget.element;\r\n        var $form = widget.$form;\r\n\r\n        $form.html(formTpl({\r\n            baseUrl         : options.baseUrl,\r\n            maxChoices      : parseInt(interaction.attr('maxChoices')),\r\n            minChoices      : parseInt(interaction.attr('minChoices')),\r\n            choicesCount    : _.size(interaction.getChoices()),\r\n            data            : interaction.object.attr('data'),\r\n            width           : interaction.object.attr('width'),\r\n            height          : interaction.object.attr('height'),\r\n            type            : interaction.object.attr('type')\r\n        }));\r\n\r\n        imageSelector($form, options);\r\n\r\n        formElement.initWidget($form);\r\n\r\n        bgImage.setupImage(widget);\r\n\r\n        //init data change callbacks\r\n        bgImage.setChangeCallbacks(\r\n            widget,\r\n            formElement,\r\n            formElement.getMinMaxAttributeCallbacks($form, 'minChoices', 'maxChoices')\r\n        );\r\n\r\n        interactionFormElement.syncMaxChoices(widget);\r\n    };\r\n\r\n    return SelectPointInteractionStateQuestion;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Map',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse', \r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicInteractionShapeEditor',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/graphicScorePopup',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/response/graphicScoreMappingForm',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'ui/incrementer',\r\n    'ui/tooltipster'\r\n], function($, _, __, stateFactory, Map, commonRenderer, instructionMgr, graphicHelper, PciResponse, answerStateHelper, shapeEditor, grahicScorePopup, mappingFormTpl, formElement, incrementer, tooltipster){\r\n\r\n    /**\r\n     * Initialize the Map state.\r\n     */\r\n    function initMapState(){\r\n        var widget          = this.widget;\r\n        var interaction     = widget.element;\r\n        var $container      = widget.$original; \r\n        var response        = interaction.getResponseDeclaration();\r\n\r\n        widget._targets = [];\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        //really need to destroy before ? \r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction);\r\n        \r\n        //add a specific instruction\r\n        instructionMgr.appendInstruction(interaction, __('Please create areas that correspond to the response and associate them a score.\\n' + \r\n                                                 'You can also position the target to the exact point as the correct response.'));\r\n        interaction.responseMappingMode = true;\r\n        if(_.isPlainObject(response.mapEntries)){\r\n            response.mapEntries = _.values(response.mapEntries);\r\n        }\r\n\r\n        //here we do not use the common renderer but the creator's widget to get only a basic paper with the choices\r\n        interaction.paper = widget.createPaper(); \r\n       \r\n        //we create the shapes from the response mapping \r\n        setCurrentResponses(widget);\r\n        \r\n        //set up of the shape editor\r\n        widget._editor = createEditor(widget);\r\n     \r\n        listenResponseAttrChange(widget);\r\n  \r\n    }\r\n\r\n    /**\r\n     * Creates an identifier based on an areaMapping entry\r\n     * @private\r\n     * @param {Object} area - the map entry\r\n     * @returns {String} the identifier\r\n     */\r\n    function areaId(area){\r\n        return area.shape + '-' + area.coords.replace(/,*/g, '-');\r\n    }\r\n\r\n    /**\r\n     * Get the index of a area map entry in the entries\r\n     * @private\r\n     * @param {Object} response - the response declaration\r\n     * @param {String} id - the identifier from areaId used to retrieve the index\r\n     * @returns {Number|Boolean} the index or false\r\n     */\r\n    function getAreaIndex(response, id){\r\n        var found = false;\r\n        _.forEach(response.mapEntries, function(area, index){\r\n            if(areaId(area) === id){\r\n                found = index;\r\n                return false;\r\n            }\r\n        });\r\n        return found;\r\n    }\r\n \r\n     \r\n    /**\r\n     * Creates the shapes on the paper from the responses\r\n     * @private\r\n     * @param {Object} widget - the current widget\r\n     */\r\n    function setCurrentResponses(widget){\r\n        var interaction = widget.element;\r\n        var $container  = widget.$original; \r\n        var response    = interaction.getResponseDeclaration();\r\n        var corrects    = _.values(response.getCorrect());\r\n\r\n        //set up for the existing areas\r\n        _.forEach(response.mapEntries, function(area){\r\n            var shape = widget.createResponseArea(area.shape, area.coords);\r\n            setUpScoringArea(widget, area, shape, false); \r\n        });\r\n\r\n        //set up a target if\r\n        if(answerStateHelper.defineCorrect(response) && corrects.length){\r\n             _.forEach(corrects, function(correct){\r\n                var point = correct.split(' ');\r\n                if(point.length >= 2){\r\n                   var target = graphicHelper.createTarget(interaction.paper, {\r\n                        point : {\r\n                            x : point[0],\r\n                            y : point[1]\r\n                        }\r\n                   }); \r\n                   widget._targets.push(target.id);\r\n                }\r\n           });\r\n        }\r\n\r\n        //hide popups by clicking the paper \r\n        interaction.paper.getById('bg-image-' + interaction.serial).click(function(){\r\n            $('.-mapping-editor', $container).hide();\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Creates and initialize the shape editor \r\n     * @private\r\n     * @param {Object} widget - the current widget\r\n     * @return {ShapeEditor} the editor\r\n     */\r\n    function createEditor(widget){\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n\r\n        //instantiate the shape editor, attach it to the widget to retrieve it during the exit phase\r\n        var editor = shapeEditor(widget, {\r\n            currents : response.mapEntries.map(areaId).concat(widget._targets),\r\n            target : true,\r\n            shapeCreated : function(shape, type){\r\n                var point, corrects, area;\r\n                if(type === 'target'){\r\n                    //add a correct response \r\n                    point = shape.data('target');\r\n                    corrects = response.getCorrect() || [];\r\n                    corrects.push(qtiPoint(point));\r\n                    response.setCorrect(corrects);\r\n\r\n                } else {\r\n                    //create an area for the mapping\r\n                    area = {\r\n                        shape  : type === 'path' ? 'poly' : type,\r\n                        coords : graphicHelper.qtiCoords(shape),\r\n                        mappedValue :  response.mappingAttributes.defaultValue || '0'\r\n                    };\r\n                    setUpScoringArea(widget, area, shape, true);\r\n\r\n                    response.mapEntries.push(area);\r\n                }\r\n            },\r\n            shapeRemoved : function(id, data){\r\n                var scoreElt;\r\n                if(/^target/.test(id) && data.target){\r\n                    //remove from the correct response\r\n                    response.setCorrect(\r\n                        _.without(response.getCorrect(), qtiPoint(data.target))\r\n                    );\r\n                } else {\r\n                    //remove the score and the popup\r\n                    scoreElt = interaction.paper.getById('score-' + id);\r\n                    if(scoreElt){\r\n                        scoreElt.remove();\r\n                    }\r\n                    $('#score-popup-' + id).remove(); \r\n                    \r\n                    //remove the area from the mapping\r\n                    _.remove(response.mapEntries, function(area){\r\n                        return id && areaId(area) === id;\r\n                    });\r\n                }\r\n            },\r\n            enterHandling : function(shape){\r\n                if(shape.type === 'set'){\r\n                    shape.forEach(function(setElt){\r\n                        if(setElt.type === 'path'){\r\n                            setElt.attr(graphicHelper._style['target-hover']);\r\n                            return;\r\n                        }\r\n                    });\r\n    \r\n                } else {\r\n                    //move the score back the shape and show the popup\r\n                    shape.toFront();\r\n                    $('#score-popup-' + shape.id).show(); \r\n                }\r\n            },\r\n            quitHandling : function(shape){\r\n                if(shape.type === 'set'){\r\n                    shape.forEach(function(setElt){\r\n                        if(setElt.type === 'path'){\r\n                            setElt.attr(graphicHelper._style['target-success']);\r\n                            return;\r\n                        }\r\n                    });\r\n                } else {\r\n                    //move the score in above the shape and hide the popup\r\n                    var scoreElt = interaction.paper.getById('score-' + shape.id);\r\n                    if(scoreElt){\r\n                        scoreElt.show().toFront();\r\n                    }\r\n                    $('#score-popup-' + shape.id).hide();\r\n                } \r\n            },\r\n            shapeChanging : function(shape){\r\n                //move the score and the popup to create them again once the shape has moved\r\n                var scoreElt = interaction.paper.getById('score-' + shape.id);\r\n                if(scoreElt){\r\n                    scoreElt.remove();\r\n                }\r\n                $('#score-popup-' + shape.id).remove(); \r\n            },\r\n            shapeChange : function(shape){\r\n                //now the shape has moved, so we update the mapping and create again the score and the popup\r\n                var index = getAreaIndex(response, shape.id);\r\n                var mapEntry;\r\n                if(index !== false){\r\n                    mapEntry = response.mapEntries[index];\r\n                    response.mapEntries[index].coords = graphicHelper.qtiCoords(shape);\r\n                    setUpScoringArea(widget, mapEntry, shape, mapEntry.mappedValue === response.mappingAttributes.defaultValue);\r\n                    shape.id = areaId(mapEntry);\r\n                }\r\n            }\r\n        });\r\n\r\n        //Create our brand new editor\r\n        editor.create();\r\n\r\n        return editor;\r\n    }\r\n\r\n    /**\r\n     * Format a point to the qti format\r\n     * @param {Object} point\r\n     * @param {Number} point.x \r\n     * @param {Number} point.y\r\n     * @returns {String} the point as \"x y\"\r\n     */\r\n    function qtiPoint(point){\r\n        return Math.round(point.x) + ' ' + Math.round(point.y);\r\n    }\r\n \r\n    /**\r\n     * Creates the score element and the popup to view/edit the score \r\n     * @private\r\n     * @param {Object} widget - the current widget\r\n     * @param {Object} area   - the response area entry\r\n     * @param {Raphael.Element} shape   - the related shape\r\n     * @param {Boolean} default - if the score uses the default value\r\n     */\r\n    function setUpScoringArea(widget, area, shape, defaults){\r\n        var interaction     = widget.element;\r\n        var $container      = widget.$original; \r\n        var isResponsive    = $container.hasClass('responsive');\r\n        var response        = interaction.getResponseDeclaration();\r\n        var id              = areaId(area);        \r\n        var $imageBox       = $('.main-image-box', $container);\r\n        var $popup          = grahicScorePopup(interaction.paper, shape, $imageBox, isResponsive);\r\n        var score           = area.mappedValue || response.mappingAttributes.defaultValue || '0';\r\n\r\n        var scoreElt    = graphicHelper.createShapeText(interaction.paper, shape, {\r\n                    id          : 'score-' + id,\r\n                    content     : area.mappedValue + '',\r\n                    style       : 'score-text-default',\r\n                    title       : __('Score value'),\r\n                    shapeClick  : true\r\n                });\r\n        scoreElt.data('default', !!defaults);\r\n        shape.id = id; \r\n\r\n        $popup.attr('id', 'score-popup-' + id);\r\n\r\n        //create manually the mapping form (detached)\r\n        var $form = $(mappingFormTpl({\r\n            score     : area.mappedValue,\r\n            scoreMin  : response.getMappingAttribute('lowerBound'),\r\n            scoreMax  : response.getMappingAttribute('upperBound'),\r\n            noCorrect : true\r\n        }));\r\n        \r\n        //set up the form data binding\r\n        formElement.setChangeCallbacks($form, response, {\r\n            score : function(response, value){\r\n                if(value === ''){\r\n                    scoreElt.attr({text : response.mappingAttributes.defaultValue})\r\n                             .data('default', true);\r\n                } else {\r\n                    scoreElt.attr({text : value})\r\n                             .data('default', false);\r\n                }\r\n                area.mappedValue = parseFloat(value);\r\n            }\r\n        });\r\n        $form.appendTo($popup);\r\n    }\r\n\r\n    /**\r\n     * Listen for changes in the response form that affects the creator : defaultValue and defineCorrect. \r\n     * @private\r\n     * @param {Object} widget - the current widget\r\n     */\r\n    function listenResponseAttrChange(widget){\r\n        var interaction = widget.element;\r\n        var $container = widget.$container;        \r\n        var $target = $container.find('[data-type=\"target\"]');\r\n        var $separator = $target.prev('.separator');\r\n\r\n        //update the default scores when the form value change\r\n        widget.on('mappingAttributeChange', function(data){\r\n            if(data.key === 'defaultValue'){\r\n                interaction.paper.forEach(function(element){\r\n                    if(/^score/.test(element.id) && element.data('default') === true){\r\n                        element.attr({text : data.value });\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        //update the targets when the defineCorrect field cahnges\r\n        widget.on('metaChange', function(data){\r\n            if(data.key === 'defineCorrect'){\r\n               if(data.value){\r\n                    $target.show();\r\n                    $separator.show();\r\n                } else {\r\n                    $target.hide();\r\n                    $separator.hide();\r\n    \r\n                    //remove targets\r\n                    _.forEach(widget._targets, function(targetId){\r\n                        var target = interaction.paper.getById(targetId);\r\n                        var layer  = interaction.paper.getById('layer-' + targetId);\r\n                        target.remove();\r\n                        layer.remove();\r\n                    }); \r\n                }\r\n            } \r\n        });\r\n    }\r\n\r\n    /**\r\n     * Exit the map state\r\n     */\r\n    function exitMapState(){\r\n        var widget = this.widget;\r\n        var interaction = widget.element;\r\n\r\n        if(!interaction.paper){\r\n            return;\r\n        }\r\n\r\n        if(widget._editor){\r\n            widget._editor.destroy();\r\n        }\r\n        \r\n        //destroy the common renderer\r\n        commonRenderer.resetResponse(interaction); \r\n        commonRenderer.destroy(interaction); \r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //initialize again the widget's paper\r\n        interaction.paper = this.widget.createPaper();\r\n    }\r\n\r\n    /**\r\n     * The map answer state for the selectPoint interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/states/Map\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Map\r\n     */\r\n    return  stateFactory.create(Map, initMapState, exitMapState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Map'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/Widget',[\r\n    'jquery', 'lodash', 'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/graphicInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/states',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/Graphic',\r\n], function($, _, __, Widget, GraphicWidget, states, graphicHelper){\r\n\r\n    /**\r\n     * The Widget that provides components used by the QTI Creator for the SelectPoint Interaction\r\n     *\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/Widget\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/GraphicInteraction/Widget\r\n     *\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/Widget\r\n     */      \r\n    var SelectPointInteractionWidget = _.extend(Widget.clone(), GraphicWidget, {\r\n\r\n        /**\r\n         * Initialize the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/interactions/Widget#initCreator}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        initCreator : function(options){\r\n            var paper;\r\n            this.baseUrl = options.baseUrl;\r\n            this.choiceForm = options.choiceForm;\r\n            \r\n            this.registerStates(states);\r\n            \r\n            //call parent initCreator\r\n            Widget.initCreator.call(this);\r\n           \r\n            paper = this.createPaper(); \r\n            if(paper){\r\n                this.element.paper = paper;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gracefull destroy the widget\r\n         * @see {taoQtiItem/qtiCreator/widgets/Widget#destroy}\r\n         * @param {Object} options - extra options \r\n         * @param {String} options.baseUrl - the resource base url\r\n         * @param {jQueryElement} options.choiceForm = a reference to the form of the choices\r\n         */\r\n        destroy : function(){\r\n\r\n            var $container = this.$original;\r\n            var $item      = $container.parents('.qti-item');\r\n\r\n            //stop listening the resize\r\n            $item.off('resize.gridEdit.' + this.element.serial);\r\n            $(window).off('resize.qti-widget.' + this.element.serial);\r\n            $container.off('resize.qti-widget.' + this.element.serial);\r\n\r\n            //call parent destroy\r\n            Widget.destroy.call(this);\r\n        },\r\n\r\n        /**\r\n         * Create shapes for the response mapping areas\r\n         * @param {String} shapeType - the QTI shape type \r\n         * @param {String} coords - the QTI shape coords\r\n         * @returns {Raphael.Element} the shape\r\n         */ \r\n        createResponseArea : function(shapeType, coords){\r\n            return graphicHelper.createElement(this.element.paper, shapeType, coords, {\r\n                touchEffect : false\r\n            });\r\n        }\r\n\r\n   });\r\n\r\n    return SelectPointInteractionWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\n/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/SelectPointInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/Widget'\r\n], function(_, SelectPointInteraction, SelectPointInteractionWidget){\r\n    'use strict';\r\n\r\n    /**\r\n     * The CreatorSelectPointInteraction  Renderer\r\n     * @extends taoQtiItem/qtiCommonRenderer/renderers/interactions/SelectPointInteraction\r\n     * @exports taoQtiItem/qtiCreator/renderers/interactions/SelectPointInteraction\r\n     */\r\n    var CreatorSelectPointInteraction = _.clone(SelectPointInteraction);\r\n\r\n    /**\r\n     * Render the interaction for authoring.\r\n     * It delegates the rendering to the widget layer.\r\n     * @param {Object} interaction - the model\r\n     * @param {Object} [options] - extra options\r\n     */\r\n    CreatorSelectPointInteraction.render = function(interaction, options){\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.choiceForm = this.getOption('choiceOptionForm');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        SelectPointInteractionWidget.build(\r\n            interaction,\r\n            SelectPointInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorSelectPointInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/sliderInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-blockInteraction qti-sliderInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"sliderInteraction\\\" >\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"instruction-container\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/sliderInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'nouislider'\r\n], function($, _, __,tpl, containerHelper, instructionMgr, pciResponse){\r\n    'use strict';\r\n\r\n    var _slideTo = function(options){\r\n        options.sliderCurrentValue.find('.qti-slider-cur-value').text(options.value);\r\n        options.sliderValue.val(options.value);\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function(interaction){\r\n\r\n        var attributes = interaction.getAttributes(),\r\n            $container = interaction.getContainer(),\r\n            $el = $('<div />').attr({'id' : attributes.responseIdentifier + '-qti-slider', 'class' : 'qti-slider'}), //slider element\r\n        $sliderLabels = $('<div />').attr({'class' : 'qti-slider-values'}),\r\n        $sliderCurrentValue = $('<div />').attr({'id' : attributes.responseIdentifier + '-qti-slider-cur-value', 'class' : 'qti-slider-cur-value'}), //show the current selected value\r\n        $sliderValue = $('<input />').attr({'type' : 'hidden', 'id' : attributes.responseIdentifier + '-qti-slider-value'}); //the input that always holds the slider value\r\n\r\n        //getting the options\r\n        var orientation = 'horizontal',\r\n            reverse = typeof attributes.reverse !== 'undefined' && attributes.reverse ? true : false, //setting the slider whether to be reverse or not\r\n            min = parseInt(attributes.lowerBound),\r\n            max = parseInt(attributes.upperBound),\r\n            step = typeof attributes.step !== 'undefined' && attributes.step ? parseInt(attributes.step) : 1, //default value as per QTI standard\r\n            steps = (max - min) / step; //number of the steps\r\n\r\n        //add the containers\r\n        $sliderCurrentValue.append('<span class=\"qti-slider-cur-value-text\">'+__('Current value:')+' </span>')\r\n            .append('<span class=\"qti-slider-cur-value\"></span>');\r\n\r\n        $sliderLabels.append('<span class=\"slider-min\">' + (!reverse ? min : max) + '</span>')\r\n            .append('<span class=\"slider-max\">' + (!reverse ? max : min) + '</span>');\r\n\r\n        interaction.getContainer().append($el)\r\n            .append($sliderLabels)\r\n            .append($sliderCurrentValue)\r\n            .append($sliderValue);\r\n\r\n        //setting the orientation of the slider\r\n        if(typeof attributes.orientation !== 'undefined' && $.inArray(attributes.orientation, ['horizontal', 'vertical']) > -1){\r\n            orientation = attributes.orientation;\r\n        }\r\n\r\n        var sliderSize = 0;\r\n\r\n        if(orientation === 'horizontal'){\r\n            $container.addClass('qti-slider-horizontal');\r\n        }else{\r\n            var maxHeight = 300;\r\n            sliderSize = steps * 20;\r\n            if(sliderSize > maxHeight){\r\n                sliderSize = maxHeight;\r\n            }\r\n            $container.addClass('qti-slider-vertical');\r\n            $el.height(sliderSize + 'px');\r\n            $sliderLabels.height(sliderSize + 'px');\r\n        }\r\n\r\n        //set the middle value if the stepLabel attribute is enabled\r\n        if(typeof attributes.stepLabel !== 'undefined' && attributes.stepLabel){\r\n            var middleStep = parseInt(steps / 2),\r\n                leftOffset = (100 / steps) * middleStep,\r\n                middleValue = reverse ? max - (middleStep * step) : min + (middleStep * step);\r\n\r\n            if(orientation === 'horizontal'){\r\n                $sliderLabels.find('.slider-min').after('<span class=\"slider-middle\" style=\"left:' + leftOffset + '%\">' + middleValue + '</span>');\r\n            }else{\r\n                $sliderLabels.find('.slider-min').after('<span class=\"slider-middle\" style=\"top:' + leftOffset + '%\">' + middleValue + '</span>');\r\n            }\r\n\r\n        }\r\n\r\n        //create the slider\r\n        $el.noUiSlider({\r\n            start : reverse ? max : min,\r\n            range: {\r\n                'min': min,\r\n                'max': max\r\n            },\r\n            step : step,\r\n            orientation : orientation\r\n        }).on('slide', function(e){\r\n            var val = parseInt($(this).val());\r\n            if((interaction.attr('reverse'))){\r\n                val = (max + min) - val;\r\n            }\r\n            val = Math.round(val * 1000) / 1000;\r\n            _slideTo({\r\n                'value' : val,\r\n                'sliderValue' : $sliderValue,\r\n                'sliderCurrentValue' : $sliderCurrentValue\r\n            });\r\n\r\n            containerHelper.triggerResponseChangeEvent(interaction);\r\n        });\r\n\r\n        _slideTo({\r\n            'value' : min,\r\n            'sliderValue' : $sliderValue,\r\n            'sliderCurrentValue' : $sliderCurrentValue\r\n        });\r\n    };\r\n\r\n    var resetResponse = function(interaction){\r\n        var attributes = interaction.getAttributes(),\r\n            $el = $('#' + attributes.responseIdentifier + '-qti-slider'),\r\n            $sliderValue = $('#' + attributes.responseIdentifier + '-qti-slider-value'),\r\n            $sliderCurrentValue = $('#' + attributes.responseIdentifier + '-qti-slider-cur-value'),\r\n            min = parseInt(attributes.lowerBound),\r\n            max = parseInt(attributes.upperBound),\r\n            reverse = typeof attributes.reverse !== 'undefined' && attributes.reverse ? true : false,\r\n            startValue = reverse ? max : min;\r\n\r\n        _slideTo({\r\n            'value' : min,\r\n            'sliderValue' : $sliderValue,\r\n            'sliderCurrentValue' : $sliderCurrentValue\r\n        });\r\n\r\n        $el.val(startValue);\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function(interaction, response){\r\n        var attributes = interaction.getAttributes(),\r\n            $sliderValue = $('#' + attributes.responseIdentifier + '-qti-slider-value'),\r\n            $sliderCurrentValue = $('#' + attributes.responseIdentifier + '-qti-slider-cur-value'),\r\n            $el = $('#' + attributes.responseIdentifier + '-qti-slider'),\r\n            min = parseInt(attributes.lowerBound),\r\n            max = parseInt(attributes.upperBound),\r\n            value;\r\n\r\n        value = pciResponse.unserialize(response, interaction)[0];\r\n\r\n        _slideTo({\r\n            'value' : value,\r\n            'sliderValue' : $sliderValue,\r\n            'sliderCurrentValue' : $sliderCurrentValue\r\n        });\r\n\r\n        $el.val(interaction.attr('reverse') ? (max + min) - value : value);\r\n    };\r\n\r\n    var _getRawResponse = function(interaction){\r\n\r\n        var value,\r\n            attributes = interaction.getAttributes(),\r\n            baseType = interaction.getResponseDeclaration().attr('baseType'),\r\n            min = parseInt(attributes.lowerBound),\r\n            $sliderValue = $('#' + attributes.responseIdentifier + '-qti-slider-value');\r\n        \r\n        if(baseType === 'integer'){\r\n            value = parseInt($sliderValue.val());\r\n        }else if(baseType === 'float'){\r\n            value = parseFloat($sliderValue.val());\r\n        }\r\n\r\n        return isNaN(value) ? min : value;\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function(interaction){\r\n        return pciResponse.serialize([_getRawResponse(interaction)], interaction);\r\n    };\r\n\r\n    var destroy = function(interaction) {\r\n        var $container = interaction.getContainer();\r\n\r\n        $container.empty();\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var $container;\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n\r\n    return {\r\n        qtiClass : 'sliderInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/slider', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"lowerBound\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Lower Bound\", options) : helperMissing.call(depth0, \"__\", \"Lower Bound\", options)))\n    + \"</label>\\r\\n    <input name=\\\"lowerBound\\\" value=\\\"\";\n  if (helper = helpers.lowerBound) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.lowerBound); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" type=\\\"text\\\" />\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The lower bound of the slider\", options) : helperMissing.call(depth0, \"__\", \"The lower bound of the slider\", options)))\n    + \"</span>\\r\\n    <label for=\\\"upperBound\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Upper Bound\", options) : helperMissing.call(depth0, \"__\", \"Upper Bound\", options)))\n    + \"</label>\\r\\n    <input name=\\\"upperBound\\\" value=\\\"\";\n  if (helper = helpers.upperBound) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.upperBound); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" type=\\\"text\\\" />\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The upper bound of the slider\", options) : helperMissing.call(depth0, \"__\", \"The upper bound of the slider\", options)))\n    + \"</span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"step\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Step\", options) : helperMissing.call(depth0, \"__\", \"Step\", options)))\n    + \"</label>\\r\\n    <input name=\\\"step\\\" value=\\\"\";\n  if (helper = helpers.step) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.step); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"\";\n  if (helper = helpers.upperBound) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.upperBound); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The number of units corresponding to a step on the slider\", options) : helperMissing.call(depth0, \"__\", \"The number of units corresponding to a step on the slider\", options)))\n    + \"</span>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/states/Question',[\r\n'taoQtiItem/qtiCreator/widgets/states/factory',\r\n'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/slider'\r\n], function(stateFactory, Question, formElement, formTpl){\r\n    var SliderInteractionStateQuestion = stateFactory.extend(Question);\r\n    SliderInteractionStateQuestion.prototype.initForm = function(){\r\n        var _widget = this.widget,\r\n        $form = _widget.$form,\r\n        interaction = _widget.element;\r\n\r\n        $form.html(formTpl({\r\n            // tpl data for the interaction\r\n            lowerBound : parseFloat(interaction.attr('lowerBound')),\r\n            upperBound : parseFloat(interaction.attr('upperBound')),\r\n            orientation : interaction.attr('orientation'),\r\n            reverse : !!interaction.attr('reverse'),\r\n            step : parseInt(interaction.attr('step')),\r\n            stepLabel : !!interaction.attr('stepLabel')\r\n        }));\r\n        \r\n        formElement.initWidget($form);\r\n        //  init data change callbacks\r\n        var callbacks = {};\r\n        \r\n        // -- lowerBound Callback\r\n        callbacks.lowerBound = function(interaction, attrValue, attrName){\r\n            \r\n            interaction.attr('lowerBound', parseFloat(attrValue));\r\n            \r\n            var lowerBound = interaction.attr('lowerBound');\r\n            var upperBound = interaction.attr('upperBound');\r\n            var sliderLength = upperBound-lowerBound; //the lenght of the slider\r\n            var step = interaction.attr('step');\r\n            var reverse = !!interaction.attr('reverse');\r\n\r\n            //if min is greater than max change upperBound to be like lowerBound\r\n            if(lowerBound>upperBound){\r\n                callbacks.upperBound(interaction, lowerBound);\r\n                _widget.$form.find('input[name=\"upperBound\"]').val(lowerBound);\r\n            }\r\n            \r\n            //check if the lendth of the slide is smaller than the step\r\n            if(sliderLength<step && sliderLength>=0){\r\n                callbacks.step(interaction, sliderLength);\r\n                _widget.$form.find('input[name=\"step\"]').val(sliderLength);\r\n            }\r\n            _widget.$container.find((!reverse) ? '.slider-min' : '.slider-max').text(attrValue);\r\n            _widget.$container.find('span.qti-slider-cur-value').text(lowerBound);\r\n            _widget.$container.find('.qti-slider').noUiSlider({ range: { 'min': lowerBound, 'max': upperBound }}, true);\r\n            _widget.$container.find('.qti-slider').val(lowerBound);\r\n        };\r\n        \r\n        // -- upperBound Callback\r\n        callbacks.upperBound = function(interaction, attrValue, attrName){\r\n            \r\n            interaction.attr('upperBound', parseFloat(attrValue));\r\n            \r\n            var lowerBound = interaction.attr('lowerBound');\r\n            var upperBound = interaction.attr('upperBound');\r\n            var sliderLength = upperBound-lowerBound; //the lenght of the slider\r\n            var step = interaction.attr('step');\r\n            var reverse = !!interaction.attr('reverse');\r\n            \r\n            //if max is smaller than min then change lowerBound to be like upperBound\r\n            if(upperBound<lowerBound){\r\n                callbacks.lowerBound(interaction, upperBound);\r\n                _widget.$form.find('input[name=\"lowerBound\"]').val(upperBound);\r\n            }\r\n            \r\n            //check if the lendth of the slide is smaller than the step\r\n            if(sliderLength<step && sliderLength>=0){\r\n                callbacks.step(interaction, sliderLength);\r\n                _widget.$form.find('input[name=\"step\"]').val(sliderLength);\r\n            }\r\n            _widget.$form.find('input[name=\"step\"]').incrementer('options', {max: upperBound});\r\n            _widget.$container.find((!reverse) ? '.slider-max' : '.slider-min').text(attrValue);\r\n            _widget.$container.find('.qti-slider').noUiSlider({ range: { 'min': interaction.attr('lowerBound'), 'max': interaction.attr('upperBound') } }, true);\r\n        };\r\n        \r\n        // -- orientation Callback\r\n        callbacks.orientation = function(interaction, attrValue, attrName){\r\n            interaction.attr('orientation', attrValue);\r\n            \r\n            var orientation = (interaction.attr('orientation')) ? interaction.attr('orientation') : 'horizontal';\r\n            var reverse = interaction.attr('reverse');\r\n            \r\n            _widget.$container.find('.qti-slider').noUiSlider({ 'orientation': interaction.attr('orientation') }, true);\r\n        };\r\n        \r\n        // -- reverse Callback\r\n        callbacks.reverse = function(interaction, attrValue, attrName){\r\n            \r\n            interaction.attr('reverse', !!attrValue);\r\n            \r\n            var reverse = interaction.attr('reverse');\r\n            var lowerBound = parseInt(interaction.attr('lowerBound'));\r\n            var upperBound = parseInt(interaction.attr('upperBound'));\r\n            var $sliderElt = _widget.$container.find('.qti-slider');\r\n            var start = (reverse) ? upperBound : lowerBound;\r\n            $sliderElt.noUiSlider({ start: start }, true);\r\n            \r\n            _widget.$container.find('span.qti-slider-cur-value').text(lowerBound);\r\n            _widget.$container.find('.slider-min').text(!reverse ? lowerBound : upperBound);\r\n            _widget.$container.find('.slider-max').text(!reverse ? upperBound : lowerBound);\r\n        };\r\n        \r\n        // -- step Callback\r\n        callbacks.step = function(interaction, attrValue, attrName){\r\n            \r\n            var lowerBound = interaction.attr('lowerBound');\r\n            var upperBound = interaction.attr('upperBound');\r\n            var currentStep = parseInt(attrValue);\r\n            var sliderLength = upperBound-lowerBound; //the lenght of the slider\r\n            if(sliderLength>=currentStep){\r\n                interaction.attr('step', currentStep);\r\n                _widget.$container.find('.qti-slider').noUiSlider({ 'step': interaction.attr('step') }, true);\r\n                _widget.$form.find('input[name=\"step\"]').incrementer('options', {max: sliderLength});\r\n            }\r\n        };\r\n        \r\n        // -- stepLabel Callback\r\n        callbacks.stepLabel = function(interaction, attrValue, attrName){\r\n            \r\n            interaction.attr('stepLabel', !!attrValue);\r\n            \r\n            _widget.$container.find('span.slider-middle').remove();\r\n            \r\n            if (interaction.attr('stepLabel')) {\r\n                var upperBound = interaction.attr('upperBound');\r\n                var lowerBound = interaction.attr('lowerBound');\r\n                var step = interaction.attr('step');\r\n                var reverse = interaction.attr('reverse');\r\n                    \r\n                var steps = parseInt((upperBound - lowerBound) / step);\r\n                var middleStep = parseInt(steps / 2);\r\n                var leftOffset = (100 / steps) * middleStep;\r\n                var middleValue = (reverse) ? upperBound - middleStep * step : lowerBound + middleStep * step;\r\n                _widget.$container.find('.slider-min').after('<span class=\"slider-middle\" style=\"left:' + leftOffset + '%\">' + middleValue + '</span>');\r\n            }\r\n        };\r\n        \r\n        formElement.setChangeCallbacks($form, interaction, callbacks);\r\n    };\r\n    return SliderInteractionStateQuestion;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/states/Correct',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'lodash',\r\n    'i18n'\r\n], function(stateFactory, Correct, commonRenderer, instructionMgr, _, __){\r\n\r\n    var SliderInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n        \r\n        _createResponseWidget(this.widget);\r\n        \r\n    }, function(){\r\n        \r\n        _destroyResponseWidget(this.widget);\r\n        \r\n    });\r\n    \r\n    var _createResponseWidget = function(widget){\r\n\r\n        var interaction = widget.element;\r\n        var response = interaction.getResponseDeclaration();\r\n        var correctResponse = _.values(response.getCorrect());\r\n\r\n        commonRenderer.setResponse(interaction, _formatResponse(correctResponse));\r\n        \r\n        var $sliderElt = widget.$container.find('.qti-slider');\r\n        $sliderElt.removeAttr('disabled');\r\n\r\n        instructionMgr.appendInstruction(interaction, __('Please define the correct response using the slider.'));\r\n\r\n        widget.$container.on('responseChange.qti-widget', function(e, data){\r\n            response.setCorrect(_unformatResponse(data.response));\r\n        });\r\n    };\r\n    \r\n    var _destroyResponseWidget = function(widget){\r\n        \r\n        var $sliderElt = widget.$container.find('.qti-slider');\r\n        var lowerBound = widget.element.attributes.lowerBound;\r\n        \r\n        $sliderElt.attr('disabled', 'disabled');\r\n        $sliderElt.val(lowerBound);\r\n        widget.$container.find('span.qti-slider-cur-value').text('' + lowerBound);\r\n        \r\n        instructionMgr.removeInstructions(widget.element);\r\n        widget.$container.off('responseChange.qti-widget');\r\n    };\r\n    \r\n    var _formatResponse = function(response){\r\n        return {\"base\" : {\"integer\" : response}};\r\n    };\r\n\r\n    var _unformatResponse = function(formatedResponse){\r\n        return [formatedResponse.base.integer];\r\n    };\r\n    \r\n    return SliderInteractionStateCorrect;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/states/states',[\r\n'taoQtiItem/qtiCreator/widgets/states/factory',\r\n'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n'taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/states/Question',\r\n'taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/states/Correct'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/Widget',[\r\n'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n'taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/states/states'\r\n], function(Widget, states){\r\n    \r\n    var SliderInteractionWidget = Widget.clone();\r\n    \r\n    SliderInteractionWidget.initCreator = function(){\r\n        this.registerStates(states);\r\n        Widget.initCreator.call(this);\r\n        \r\n        // Disable slider until response edition.\r\n        this.$container.find('.qti-slider').attr('disabled', 'disabled');\r\n    };\r\n    \r\n    return SliderInteractionWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/SliderInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/SliderInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/sliderInteraction/Widget'\r\n], function(_, SliderInteraction, SliderInteractionWidget){\r\n    'use strict';\r\n\r\n    var CreatorSliderInteraction = _.clone(SliderInteraction);\r\n\r\n    CreatorSliderInteraction.render = function(interaction, options){\r\n\r\n        SliderInteraction.render(interaction);\r\n\r\n        SliderInteractionWidget.build(\r\n            interaction,\r\n            SliderInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorSliderInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/textEntryInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\n  buffer += \"<input \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-interaction qti-inlineInteraction qti-textEntryInteraction\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"textEntryInteraction\\\" type=\\\"text\\\">\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/TextEntryInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/textEntryInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PciResponse',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/patternMask',\r\n    'util/locale',\r\n    'polyfill/placeholders',\r\n    'ui/tooltip'\r\n], function($, _, __, tpl, containerHelper, instructionMgr, pciResponse, patternMaskHelper, locale){\r\n    'use strict';\r\n\r\n    /**\r\n     * Prepare the feedback tooltip for the text input\r\n     * @param {jQuery} $input\r\n     * @param {String} theme\r\n     * @param {String} message\r\n     * @param {Boolean} [forceCreation=false]\r\n     * @param {Boolean} [hidden=false]\r\n     */\r\n    var createTooltip = function createTooltip($input, theme, message, forceCreation, hidden){\r\n        if(forceCreation || !$input.data('qtip')){\r\n            $input.qtip({\r\n                theme : theme,\r\n                content : {\r\n                    text : message\r\n                },\r\n                show : {\r\n                    event : 'custom'\r\n                },\r\n                hide : {\r\n                    event : 'custom'\r\n                }\r\n            });\r\n        }else{\r\n            $input.qtip('option', 'content.text', message);\r\n            $input.qtip('option', 'theme', 'info');\r\n        }\r\n        if(!hidden){\r\n            $input.qtip('show');\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function render(interaction){\r\n        var attributes = interaction.getAttributes(),\r\n            $input = interaction.getContainer(),\r\n            expectedLength,\r\n            updateConstraintTooltip,\r\n            patternMask = interaction.attr('patternMask'),\r\n            maxChars = parseInt(patternMaskHelper.parsePattern(patternMask,'chars'),10);\r\n\r\n        //setting up the width of the input field\r\n        if(attributes.expectedLength){\r\n            //adding 2 chars to include reasonable padding size\r\n            expectedLength = parseInt(attributes.expectedLength) + 2;\r\n            $input.css('width', expectedLength + 'ch');\r\n            $input.css('min-width', expectedLength + 'ch');\r\n        }\r\n\r\n        //checking if there's a placeholder for the input\r\n        if(attributes.placeholderText){\r\n            $input.attr('placeholder', attributes.placeholderText);\r\n        }\r\n\r\n        if(maxChars){\r\n\r\n            updateConstraintTooltip = function updateConstraintTooltip(){\r\n                var count = $input.val().length;\r\n                var message;\r\n                if(count >= maxChars){\r\n                    $input.addClass('maxed');\r\n                    createTooltip($input, 'warning', __('%d/%d', count, maxChars), true);\r\n                }else{\r\n                    if(count){\r\n                        message = __('%d/%d', count, maxChars);\r\n                    }else{\r\n                        message = __('%d characters allowed', maxChars);\r\n                    }\r\n                    if($input.hasClass('maxed')){\r\n                        $input.removeClass('maxed');\r\n                        createTooltip($input, 'info', message, true);\r\n                    }else{\r\n                        createTooltip($input, 'info', message);\r\n                    }\r\n                }\r\n            };\r\n\r\n            $input\r\n                .attr('maxlength', maxChars)\r\n                .on('focus.commonRenderer keydown.commonRenderer', updateConstraintTooltip)\r\n                .on('keyup.commonRenderer', function(){\r\n                    updateConstraintTooltip();\r\n                    containerHelper.triggerResponseChangeEvent(interaction);\r\n                })\r\n                .on('blur.commonRenderer', function(){\r\n                    $input.qtip('hide');\r\n                });\r\n\r\n        }else if(attributes.patternMask){\r\n\r\n            //set up the tooltip plugin for the input\r\n            createTooltip($input, 'error', __('This is not a valid answer'), true, true);\r\n\r\n            $input.on('keyup.commonRenderer', _.debounce(function(){\r\n                var regex = new RegExp(attributes.patternMask);\r\n                if(regex.test($input.val())){\r\n                    $input.removeClass('invalid').qtip('hide');\r\n                } else {\r\n                    $input.addClass('invalid').qtip('show');//adding the class invalid prevent the invalid response to be submitted\r\n                }\r\n                containerHelper.triggerResponseChangeEvent(interaction);\r\n            }, 600)).on('keydown.commonRenderer', function(){\r\n                //hide the error message while the test taker is inputing an error (let's be indulgent, she is trying to fix her error)\r\n                $input.qtip('hide');\r\n            });\r\n\r\n        }else{\r\n            $input.on('keyup.commonRenderer', function(){\r\n                containerHelper.triggerResponseChangeEvent(interaction);\r\n            });\r\n        }\r\n    };\r\n\r\n    var resetResponse = function resetResponse(interaction){\r\n        interaction.getContainer().val('');\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * Special value: the empty object value {} resets the interaction responses\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function setResponse(interaction, response){\r\n\r\n        var responseValue;\r\n\r\n        try{\r\n            responseValue = pciResponse.unserialize(response, interaction);\r\n        }catch(e){\r\n        }\r\n\r\n        if(responseValue && responseValue.length){\r\n            interaction.getContainer().val(responseValue[0]);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10333\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function getResponse(interaction){\r\n        var ret = {'base' : {}},\r\n        value,\r\n            $input = interaction.getContainer(),\r\n            attributes = interaction.getAttributes(),\r\n            baseType = interaction.getResponseDeclaration().attr('baseType'),\r\n            numericBase = attributes.base || 10;\r\n        \r\n        if($input.hasClass('invalid') || (attributes.placeholderText && $input.val() === attributes.placeholderText)){\r\n            //invalid response or response equals to the placeholder text are considered empty\r\n            value = '';\r\n        }else{\r\n            if (baseType === 'integer') {\r\n                value = locale.parseInt($input.val(), numericBase);\r\n            } else if (baseType === 'float') {\r\n                value = locale.parseFloat($input.val());\r\n            } else if (baseType === 'string') {\r\n                value = $input.val();\r\n            }\r\n        }\r\n\r\n        ret.base[baseType] = isNaN(value) && typeof value === 'number' ? '' : value;\r\n\r\n        return ret;\r\n    };\r\n\r\n    var destroy = function destroy(interaction){\r\n        //remove event\r\n        $(document).off('.commonRenderer');\r\n        containerHelper.get(interaction).off('.commonRenderer');\r\n\r\n        //remove instructions\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState  = function setState(interaction, state){\r\n        if(_.isObject(state)){\r\n            if(state.response){\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction){\r\n        var state =  {};\r\n        var response =  interaction.getResponse();\r\n\r\n        if(response){\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    return {\r\n        qtiClass : 'textEntryInteraction',\r\n        template : tpl,\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        setResponse : setResponse,\r\n        getResponse : getResponse,\r\n        resetResponse : resetResponse,\r\n        destroy : destroy,\r\n        setState : setState,\r\n        getState : getState\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/textEntry', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n        <option value=\\\"\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n        \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\nfunction program4(depth0,data) {\n  \n  \n  return \"style=\\\"display:none\\\"\";\n  }\n\nfunction program6(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.patternMask) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.patternMask); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  return escapeExpression(stack1);\n  }\n\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"value=\\\"\";\n  if (helper = helpers.maxLength) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxLength); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program10(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.expectedLength) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.expectedLength); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  return escapeExpression(stack1);\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"base\\\" class=\\\"spinner\\\">Base</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <input name=\\\"base\\\" value=\\\"\";\n  if (helper = helpers.base) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.base); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"1\\\" data-max=\\\"100\\\" type=\\\"text\\\" />\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If the string interaction is bound to a numeric response variable then the base attribute must be used to set the number base in which to interpret the value entered by the candidate.\", options) : helperMissing.call(depth0, \"__\", \"If the string interaction is bound to a numeric response variable then the base attribute must be used to set the number base in which to interpret the value entered by the candidate.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"placeholderText\\\" class=\\\"spinner\\\">Placeholder Text</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <input name=\\\"placeholderText\\\" value=\\\"\";\n  if (helper = helpers.placeholderText) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.placeholderText); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" />\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"In visual environments, string interactions are typically represented by empty boxes into which the candidate writes or types.  Delivery engines should use the value of this attribute (if provided) instead of their default placeholder text when this is required.\", options) : helperMissing.call(depth0, \"__\", \"In visual environments, string interactions are typically represented by empty boxes into which the candidate writes or types.  Delivery engines should use the value of this attribute (if provided) instead of their default placeholder text when this is required.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<hr>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <h3 class=\\\"full-width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Contraints\", options) : helperMissing.call(depth0, \"__\", \"Contraints\", options)))\n    + \"</h3>\\r\\n    <select name=\\\"constraint\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.constraints), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </select>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel extendedText\\\">\\r\\n    \\r\\n    <div class=\\\"constraint constraint-pattern\\\" \";\n  stack1 = helpers.unless.call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.constraints)),stack1 == null || stack1 === false ? stack1 : stack1.pattern)),stack1 == null || stack1 === false ? stack1 : stack1.selected), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n        <label>\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Pattern\", options) : helperMissing.call(depth0, \"__\", \"Pattern\", options)))\n    + \"\\r\\n        </label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"If given, the pattern mask specifies a regular expression that the candidate's response must match in order to be considered valid\", options) : helperMissing.call(depth0, \"__\", \"If given, the pattern mask specifies a regular expression that the candidate's response must match in order to be considered valid\", options)))\n    + \"</span>\\r\\n        <input type=\\\"text\\\" name=\\\"patternMask\\\" value=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.patternMask), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\"/>\\r\\n    </div>\\r\\n    \\r\\n    <div class=\\\"constraint constraint-maxLength\\\" \";\n  stack1 = helpers.unless.call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.constraints)),stack1 == null || stack1 === false ? stack1 : stack1.maxLength)),stack1 == null || stack1 === false ? stack1 : stack1.selected), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n        <label class=\\\"spinner\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max length\", options) : helperMissing.call(depth0, \"__\", \"Max length\", options)))\n    + \"\\r\\n        </label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"We will use the patternMask to do this, to be compliant with the IMS standard\", options) : helperMissing.call(depth0, \"__\", \"We will use the patternMask to do this, to be compliant with the IMS standard\", options)))\n    + \"</span>\\r\\n        <input type=\\\"text\\\" data-min=\\\"0\\\" data-increment=\\\"1\\\" class=\\\"incrementer\\\" name=\\\"maxLength\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.maxLength), {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n    </div>\\r\\n</div>\\r\\n\\r\\n<hr>\\r\\n\\r\\n<div class=\\\"panel extendedText\\\">\\r\\n    <h3 class=\\\"full-width\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Recommendations\", options) : helperMissing.call(depth0, \"__\", \"Recommendations\", options)))\n    + \"</h3>\\r\\n    <div class=\\\"panel\\\">\\r\\n        <label for=\\\"expectedLength\\\" class=\\\"spinner\\\">Length</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <input name=\\\"expectedLength\\\" value=\\\"\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.expectedLength), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-increment=\\\"1\\\" data-min=\\\"1\\\" data-max=\\\"100\\\" type=\\\"text\\\" />\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Provides a hint to the candidate as to the expected overall length of the desired response measured in number of characters. This is not a validity constraint.\", options) : helperMissing.call(depth0, \"__\", \"Provides a hint to the candidate as to the expected overall length of the desired response measured in number of characters. This is not a validity constraint.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2013-2016 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/Question',[\r\n    'jquery',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/patternMask',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/textEntry'\r\n], function($, __, stateFactory, Question, formElement, patternMaskHelper, formTpl){\r\n    'use strict';\r\n\r\n    var TextEntryInteractionStateQuestion = stateFactory.extend(Question);\r\n\r\n    TextEntryInteractionStateQuestion.prototype.initForm = function(){\r\n        \r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            $inputs,\r\n            interaction = _widget.element,\r\n            patternMask = interaction.attr('patternMask'),\r\n            maxChars = parseInt(patternMaskHelper.parsePattern(patternMask,'chars'), 10);\r\n\r\n        var constraints = {\r\n            none : {label : __(\"None\"), selected : true},\r\n            maxLength : {label : __(\"Max Length\"), selected : false},\r\n            pattern : {label : __(\"Pattern\"), selected : false}\r\n        };\r\n\r\n        if (!isNaN(maxChars) && maxChars > 0) {\r\n            constraints.none.selected = false;\r\n            constraints.maxLength.selected = true;\r\n        }else if( patternMask !== null && patternMask !== undefined && patternMask !== ''){\r\n            constraints.none.selected = false;\r\n            constraints.pattern.selected = true;\r\n        }\r\n\r\n        $form.html(formTpl({\r\n            base : parseInt(interaction.attr('base')),\r\n            placeholderText : interaction.attr('placeholderText'),\r\n            expectedLength : parseInt(interaction.attr('expectedLength')),\r\n            constraints : constraints,\r\n            patternMask : patternMask,\r\n            maxLength : maxChars,\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        $inputs = {\r\n            maxLength : $form.find('[name=\"maxLength\"]'),\r\n            patternMask : $form.find('[name=\"patternMask\"]')\r\n        };\r\n\r\n        formElement.setChangeCallbacks($form, interaction, {\r\n            base: formElement.getAttributeChangeCallback(),\r\n            placeholderText: formElement.getAttributeChangeCallback(),\r\n            expectedLength: function expectedLength(interaction, attrValue) {\r\n                interaction.attr('expectedLength', isNaN(parseInt(attrValue, 10)) ? 0 : attrValue);\r\n            },\r\n            constraint : function constraint(interaction,attrValue){\r\n                $('.constraint', $form).hide('500');\r\n                $('.constraint-' + attrValue, $form).show('1000');\r\n                if (attrValue === \"none\") {\r\n                    //Reset all constraints\r\n                    $('input', $form).val('');\r\n                    interaction.attr('patternMask',null);\r\n                }\r\n            },\r\n            patternMask : function patternMask(interaction, attrValue){\r\n                interaction.attr('patternMask', attrValue);\r\n                //If anything is entered inside the patternMask, reset maxLength\r\n                $inputs.maxLength.val('');\r\n            },\r\n            maxLength : function maxLength(interaction, attrValue){\r\n                var newValue = parseInt(attrValue,10);\r\n                if(! isNaN(newValue)){\r\n                    interaction.attr('patternMask', patternMaskHelper.createMaxCharPattern(newValue));\r\n                }\r\n                $inputs.patternMask.val(interaction.attr('patternMask'));\r\n            }\r\n        });\r\n    };\r\n\r\n    return TextEntryInteractionStateQuestion;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/Correct',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Correct',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'lodash',\r\n    'i18n'\r\n], function($, stateFactory, Correct, instructionMgr, _, __){\r\n\r\n    var TextEntryInteractionStateCorrect = stateFactory.create(Correct, function(){\r\n\r\n        var $container = this.widget.$container,\r\n            response = this.widget.element.getResponseDeclaration(),\r\n            correct = _.values(response.getCorrect()).pop() || '';\r\n\r\n        $container.find('tr[data-edit=correct] input[name=correct]').focus().val(correct);\r\n        $container.on('keyup.correct', 'tr[data-edit=correct] input[name=correct]', function(){\r\n            var value = $(this).val();\r\n            response.setCorrect(value);\r\n        });\r\n        instructionMgr.appendInstruction(this.widget.element, __('Please type the correct response in the box below.'));\r\n\r\n    }, function(){\r\n\r\n        this.widget.$container.off('.correct');\r\n        instructionMgr.removeInstructions(this.widget.element);\r\n\r\n    });\r\n\r\n    return TextEntryInteractionStateCorrect;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/textEntry', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<tr class=\\\"\\\" data-edit=\\\"map\\\">\\r\\n    <td data-text><input type=\\\"text\\\" name=\\\"text\\\" value=\\\"\";\n  if (helper = helpers.text) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.text); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-old-text=\\\"\";\n  if (helper = helpers.text) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.text); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"/></td>\\r\\n    <td class=\\\"mini-tlb\\\" colspan=\\\"2\\\">\\r\\n        <label>\\r\\n            <input name=\\\"correct\\\" type=\\\"radio\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.correct), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\\r\\n            <span class=\\\"icon-radio\\\"></span>\\r\\n        </label>\\r\\n        <input name=\\\"score\\\" class=\\\"score\\\" value=\\\"\";\n  if (helper = helpers.score) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.score); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$numeric\\\" data-validate-option=\\\"$allowEmpty; $event(type=keyup)\\\"/>\\r\\n        <span class=\\\"icon-bin\\\" data-role=\\\"delete-option\\\"></span>\\r\\n    </td>\\r\\n</tr>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/Map',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Map',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/textEntry',\r\n    'lodash'\r\n], function($, stateFactory, Map, formElement, optionTpl, _){\r\n\r\n    var _getRelatedTextKey = function($elt){\r\n        return $elt.closest('tr').find('input[name=text]').val();\r\n    };\r\n\r\n    var TextEntryInteractionStateMap = stateFactory.create(Map, function(){\r\n        \r\n        this.initMapEntries();\r\n        this.initFormCallbacks();\r\n        this.hideCorrectInput();\r\n        \r\n    }, function(){\r\n        \r\n        this.widget.$container.off('.map');\r\n        this.widget.$container.find('tr[data-edit=map]:not([data-add-option])').remove();\r\n    });\r\n    \r\n    TextEntryInteractionStateMap.prototype.hideCorrectInput = function(){\r\n        \r\n        var $correct = this.widget.$container.find('tr[data-edit=correct]');\r\n        \r\n        this.widget.on('metaChange', function(data){\r\n            if(data.key === 'defineCorrect'){\r\n                $correct.hide();\r\n            }\r\n        });\r\n        \r\n        //@todo : fix this!\r\n        $correct.hide();\r\n        _.delay(function(){\r\n            $correct.hide();\r\n        }, 200);\r\n        \r\n    };\r\n    \r\n    TextEntryInteractionStateMap.prototype.initFormCallbacks = function(){\r\n\r\n        var $container = this.widget.$container,\r\n            response = this.widget.element.getResponseDeclaration();\r\n\r\n        formElement.setChangeCallbacks($container, response, {\r\n            text : _.throttle(function(response, value){\r\n\r\n                var $text = $(this),\r\n                    oldText = $text.data('old-text'),\r\n                    $tr = $text.closest('tr'),\r\n                    correct = !!$tr.find('input[name=correct]:checked').length,\r\n                    score = parseInt($tr.find('.score').val());\r\n\r\n                //@todo trigger validate score to check if is a valid score\r\n                if(!isNaN(score)){\r\n                    response.removeMapEntry(oldText, true);\r\n                    response.setMapEntry(value, score);\r\n                    $text.data('old-text', value);\r\n\r\n                    if(correct){\r\n                        response.setCorrect(value);\r\n                    }\r\n                }\r\n\r\n            }, 600),\r\n            correct : function(response){\r\n                var text = _getRelatedTextKey($(this));\r\n                response.setCorrect(text);\r\n            },\r\n            score : function(response, value){\r\n\r\n                var text = _getRelatedTextKey($(this));\r\n                var score = parseFloat(value);\r\n\r\n                if(!isNaN(score)){\r\n                    response.setMapEntry(text, score);\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    TextEntryInteractionStateMap.prototype.initMapEntries = function(){\r\n\r\n        var _this = this,\r\n            response = this.widget.element.getResponseDeclaration(),\r\n            correctValue = _.values(response.getCorrect()).pop(),\r\n            $container = this.widget.$container,\r\n            $addOption = $container.find('tr[data-add-option]');\r\n        \r\n        var appendOption = function(text, score){\r\n            \r\n            var $newOption = $(optionTpl({\r\n                text : text || '',\r\n                score : score || 0,\r\n                correct : (text === correctValue)\r\n            }));\r\n            $newOption.show();\r\n\r\n            $addOption.before($newOption);\r\n            \r\n            preventNullMapEntries();\r\n        };\r\n        \r\n        var preventNullMapEntries = function(){\r\n            var $deleteButtons = $container.find('tbody [data-role=delete-option]');\r\n            if($deleteButtons.length === 1){\r\n                $deleteButtons.css('visibility', 'hidden');\r\n            }else{\r\n                $deleteButtons.css('visibility', 'visible');\r\n            }\r\n        };\r\n        \r\n        if(!_.size(response.mapEntries)){\r\n            response.mapEntries = {'' : 0};\r\n        }\r\n        \r\n        _.forIn(response.mapEntries, function(score, text){\r\n            appendOption(text, score);\r\n        });\r\n\r\n        $container.on('click.map', '[data-role=delete-option]', function(){\r\n\r\n            //init delete:\r\n            var $del = $(this);\r\n            var text = _getRelatedTextKey($del);\r\n            var correct = !!$del.closest('tr').find('input[name=correct]:checked').length;\r\n\r\n            response.removeMapEntry(text, true);\r\n            $del.closest('tr').remove();\r\n            preventNullMapEntries();\r\n            \r\n            if(correct){\r\n                response.resetCorrect();//remove correct\r\n            }\r\n\r\n        }).on('click.map', '.add-option', function(){\r\n\r\n            //init add option button\r\n            appendOption('', 0);\r\n\r\n            _this.initFormCallbacks();\r\n        });\r\n\r\n    };\r\n\r\n    return TextEntryInteractionStateMap;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/Correct',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/Map'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/textEntryInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\n\n  buffer += \"<div class=\\\"widget-box widget-inline widget-textEntryInteraction qti-interaction\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-edit=\\\"active\\\">\\r\\n    <div class=\\\"qti-interaction qti-textEntryInteraction\\\">\\r\\n        <table>\\r\\n            <colgroup>\\r\\n                <col class=\\\"text\\\">\\r\\n                <col class=\\\"icon\\\">\\r\\n                <col class=\\\"icon\\\">\\r\\n            </colgroup>\\r\\n            <tbody>\\r\\n                <tr data-edit=\\\"question\\\">\\r\\n                    <td class=\\\"main-option\\\"></td>\\r\\n                    <td colspan=\\\"2\\\"></td>\\r\\n                </tr>\\r\\n                <tr data-edit=\\\"correct\\\">\\r\\n                    <td data-text>\\r\\n                        <div class=\\\"instruction-container\\\"></div>\\r\\n                        <input type=\\\"text\\\" name=\\\"correct\\\" value=\\\"\";\n  if (helper = helpers.text) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.text); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" /></td>\\r\\n                    <td class=\\\"mini-tlb\\\" colspan=\\\"2\\\">\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr data-add-option data-edit=\\\"map\\\">\\r\\n                    <td>\\r\\n                        <div class=\\\"add-option\\\">\\r\\n                            <span class=\\\"icon-add\\\"></span>\\r\\n                            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Add another option\", options) : helperMissing.call(depth0, \"__\", \"Add another option\", options)))\n    + \"\\r\\n                        </div>\\r\\n                    </td>\\r\\n                    <td colspan=\\\"2\\\"></td>\\r\\n                </tr>\\r\\n                <tr data-edit=\\\"custom\\\">\\r\\n                    <td colspan=\\\"3\\\">\\r\\n                        <!-- Input solely provides visual in response state -->\\r\\n                        <input type=\\\"text\\\" />\\r\\n                    </td>\\r\\n                </tr>\\r\\n                <tr data-edit=\\\"norp\\\">\\r\\n                    <td colspan=\\\"3\\\">\\r\\n                        <!-- Input solely provides visual in response state -->\\r\\n                        <input type=\\\"text\\\" disabled=\\\"disabled\\\"/>\\r\\n                    </td>\\r\\n                </tr>\\r\\n            </tbody>\\r\\n        </table>\\r\\n    </div>\\r\\n\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/Widget',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/inlineInteraction/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/states/states',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/textEntryInteraction'\r\n], function(_, InteractionWidget, states, interactionTpl){\r\n\r\n    var TextEntryInteractionWidget = InteractionWidget.clone();\r\n\r\n    TextEntryInteractionWidget.initCreator = function(){\r\n\r\n        this.registerStates(states);\r\n\r\n        InteractionWidget.initCreator.call(this);\r\n\r\n        //remove toolbar title, because it is too large\r\n        this.$container.find('.tlb-title').remove();\r\n    };\r\n\r\n    TextEntryInteractionWidget.renderInteraction = function(){\r\n\r\n        var interaction = this.element,\r\n            tplData = {\r\n            tag : interaction.qtiClass,\r\n            serial : interaction.serial,\r\n            attributes : interaction.attributes\r\n        };\r\n\r\n        return interactionTpl(tplData);\r\n    };\r\n\r\n    TextEntryInteractionWidget.buildContainer = function(){\r\n        var previous, next;\r\n        //add a space to be able to place the cursor before and after it.\r\n        if(this.$original.length){\r\n            previous = this.$original[0].previousSibling;\r\n            next = this.$original[0].nextSibling;\r\n\r\n            if(!previous || (previous.nodeType === 3 && previous.nodeValue === '') || previous.nodeType !== 3){\r\n                this.$original.before('&nbsp;');\r\n            }\r\n            if(!next || (next.nodeType === 3 && next.nodeValue === '') || next.nodeType !== 3){\r\n                this.$original.after('&nbsp;');\r\n            }\r\n        }\r\n\r\n        //set the itemContainer where the actual widget should be append and be positioned absolutely\r\n        this.$itemContainer = this.$original.parents('.item-editor-item');\r\n\r\n        //prepare html: interaction & choices:\r\n        this.$itemContainer.append(this.renderInteraction());\r\n        \r\n        this.$container = this.$itemContainer.find('.widget-textEntryInteraction[data-serial=' + this.element.getSerial() + ']');\r\n    };\r\n\r\n    return TextEntryInteractionWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/textEntryInteraction.placeholder', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<span class=\\\"widget-box textEntryInteraction-placeholder\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"textEntryInteraction\\\">\\r\\n    <label>&nbsp;</label>\\r\\n</span>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/TextEntryInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/TextEntryInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/textEntryInteraction/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/inlineInteraction/textEntryInteraction.placeholder'\r\n], function($, _, TextEntryInteraction, TextEntryInteractionWidget, tpl){\r\n    'use strict';\r\n\r\n    var CreatorTextEntryInteraction = _.clone(TextEntryInteraction);\r\n\r\n    CreatorTextEntryInteraction.template = tpl;\r\n\r\n    CreatorTextEntryInteraction.render = function(interaction, options){\r\n\r\n        //need to pass choice option form to the interaction widget because it will manage everything\r\n        options = options || {};\r\n\r\n        TextEntryInteractionWidget.build(\r\n            interaction,\r\n            $('.textEntryInteraction-placeholder[data-serial=\"' + interaction.serial + '\"]'),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorTextEntryInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/uploadInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"accept=\\\"\";\n  if (helper = helpers.accept) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.accept); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"qti-interaction qti-blockInteraction qti-uploadInteraction\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n\t\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\t<div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"file-upload fixed-grid-row lft\\\">\\r\\n        <div class=\\\"progressbar\\\"></div>\\r\\n        <span class=\\\"btn-info small col-4\\\"></span>\\r\\n        <span class=\\\"file-name placeholder col-8 truncate\\\"></span>\\r\\n        <input type=\\\"file\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.accept), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n    </div>\\r\\n    <div class=\\\"file-upload-preview lft visible-file-upload-preview runtime-visible-file-upload-preview\\\">\\r\\n        <p class=\\\"nopreview\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"No preview available\", options) : helperMissing.call(depth0, \"__\", \"No preview available\", options)))\n    + \"</p>\\r\\n    </div>\\r\\n    <div class=\\\"file-upload-preview-popup modal\\\">\\r\\n        <div class=\\\"modal-body\\\">\\r\\n        </div>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/uploadMime',[\r\n    'lodash',\r\n    'i18n'\r\n], function (_, __) {\r\n    \"use strict\";\r\n\r\n    var uploadMime = {\r\n        /**\r\n         * @TODO these mime types are not up-to-date, in particular the MS ones\r\n         * refer to http://filext.com/faq/office_mime_types.php\r\n         * @type [{getMimeTypes: getMimeTypes}]\r\n         */\r\n        getMimeTypes : function getMimeTypes() {\r\n            return [\r\n                {\"mime\": \"application/zip\", \"label\": __(\"ZIP archive\"), equivalent:[\"application/x-zip-compressed\"]},\r\n                {\"mime\": \"text/plain\", \"label\": __(\"Plain text\")},\r\n                {\"mime\": \"application/pdf\", \"label\": __(\"PDF file\")},\r\n                {\"mime\": \"image/jpeg\", \"label\": __(\"JPEG image\")},\r\n                {\"mime\": \"image/png\", \"label\": __(\"PNG image\")},\r\n                {\"mime\": \"image/gif\", \"label\": __(\"GIF image\")},\r\n                {\"mime\": \"image/svg+xml\", \"label\": __(\"SVG image\")},\r\n                {\"mime\": \"audio/mpeg\", \"label\": __(\"MPEG audio\"), equivalent:[\"audio/mp3\"]},\r\n                {\"mime\": \"audio/x-ms-wma\", \"label\": __(\"Windows Media audio\")},\r\n                {\"mime\": \"audio/x-wav\", \"label\": __(\"WAV audio\"), equivalent:[\"audio/wav\"]},\r\n                {\"mime\": \"video/mpeg\", \"label\": __(\"MPEG video\")},\r\n                {\"mime\": \"video/mp4\", \"label\": __(\"MP4 video\")},\r\n                {\"mime\": \"video/quicktime\", \"label\": __(\"Quicktime video\")},\r\n                {\"mime\": \"video/x-ms-wmv\", \"label\": __(\"Windows Media video\")},\r\n                {\"mime\": \"video/x-flv\", \"label\": __(\"Flash video\")},\r\n                {\"mime\": \"text/csv\", \"label\": __(\"CSV file\")},\r\n                {\"mime\": \"application/msword\", \"label\": __(\"Microsoft Word\"), equivalent:[\"application/vnd.openxmlformats-officedocument.wordprocessingml.document\"]},\r\n                {\"mime\": \"application/vnd.ms-excel\", \"label\": __(\"Microsoft Excel\"), equivalent:[\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"]},\r\n                {\"mime\": \"application/vnd.ms-powerpoint\", \"label\": __(\"Microsoft Powerpoint\"), equivalent:[\"application/vnd.openxmlformats-officedocument.presentationml.presentation\"]}\r\n            ];\r\n        },\r\n\r\n        /**\r\n         * Set the expected types in the format according to the number of types\r\n         *\r\n         * @param {Object} interaction\r\n         * @param {Array} types\r\n         */\r\n        setExpectedTypes : function setExpectedTypes(interaction, types) {\r\n            var classes = interaction.attr('class') || '';\r\n            classes = classes.replace(/x-tao-upload-type-[-_a-zA-Z+.0-9]*/g, '').trim();\r\n            interaction.attr('class', classes);\r\n            interaction.removeAttr('type');\r\n\r\n            if (!types) {\r\n                return;\r\n            }\r\n\r\n            if (types.length === 1) {\r\n                //if there is only one value set into the qti standard type attribute\r\n                if (types[0] !== 'any/kind') {\r\n                    interaction.attr('type', types[0]);\r\n                }\r\n            } else {\r\n                //if there is more than one value, set into into TAO specific css classes\r\n                //qti 2.1 xsd indeed does not allow comma-separated multi mime type value for the attribute \"type\r\n                interaction.attr('class', _.reduce(types, function (acc, selectedType) {\r\n                    return acc + ' x-tao-upload-type-' + selectedType.replace('/', '_');\r\n                }, classes).trim());\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Return the array of authorized mime types\r\n         * It first get the standard \"type\" attribute value.\r\n         * If not set search the TAO specific type information recorded in the class attributes,\r\n         * qti 2.1 xsd indeed does not allow comma-separated multi mime type value for the attribute \"type\"\r\n         * @param {Object} interaction - standard QTI interaction model object\r\n         * @param {Boolean} [includeEquivalents] - enable including all recognized as equivalent types\r\n         * @returns {Array}\r\n         */\r\n        getExpectedTypes : function getExpectedTypes(interaction, includeEquivalents) {\r\n            var classes = interaction.attr('class') || '';\r\n            var types = [];\r\n            var mimes;\r\n            var equivalents = [];\r\n            if (interaction.attr('type')) {\r\n                types.push(interaction.attr('type'));\r\n            } else {\r\n                classes.replace(/x-tao-upload-type-([-_a-zA-Z+.0-9]*)/g, function ($0, type) {\r\n                    types.push(type.replace('_', '/').trim());\r\n                });\r\n            }\r\n\r\n            // add in equivalent mimetypes to the list of expected types\r\n            if(includeEquivalents === true){\r\n                mimes = uploadMime.getMimeTypes();\r\n                _.forEach(types, function(mime){\r\n                    var mimeData = _.find(mimes, {mime:mime});\r\n                    if(mimeData && _.isArray(mimeData.equivalent)){\r\n                        equivalents = _.union(equivalents, mimeData.equivalent);\r\n                    }\r\n                });\r\n            }\r\n\r\n            return _.union(types, equivalents);\r\n        }\r\n    };\r\n\r\n    return uploadMime;\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/interactions/UploadInteraction',[\r\n    'jquery',\r\n    'lodash',\r\n    'i18n',\r\n    'context',\r\n    'core/mimetype',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/interactions/uploadInteraction',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/instructions/instructionManager',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/uploadMime',\r\n    'ui/progressbar',\r\n    'ui/previewer',\r\n    'ui/modal',\r\n    'ui/waitForMedia'\r\n], function ($, _, __, context, mimetype, tpl, containerHelper, instructionMgr, uploadHelper) {\r\n    'use strict';\r\n\r\n    var _initialInstructions = __('Browse your computer and select the appropriate file.');\r\n\r\n    var _readyInstructions = __('The selected file is ready to be sent.');\r\n\r\n    /**\r\n     * Validate type of selected file\r\n     * @param file\r\n     * @param interaction\r\n     * @returns {boolean}\r\n     */\r\n    var validateFileType = function validateFileType (file, interaction) {\r\n        var expectedTypes = uploadHelper.getExpectedTypes(interaction, true);\r\n        var filetype = mimetype.getMimeType(file);\r\n        if (expectedTypes.length) {\r\n            return (_.indexOf(expectedTypes, filetype) >= 0);\r\n        }\r\n        return true;\r\n    };\r\n\r\n    /**\r\n     * Compute the message to be displayed when an invalid file type has been selected\r\n     *\r\n     * @param {Object} interaction\r\n     * @param {Function} userSelectedType\r\n     * @param {Function} messageWrongType\r\n     * @returns {String}\r\n     */\r\n    var getMessageWrongType = function getMessageWrongType(interaction, userSelectedType, messageWrongType){\r\n        var types = uploadHelper.getExpectedTypes(interaction);\r\n        var expectedTypeLabels = _.map(_.uniq(types), function(type){\r\n            var mime = _.find(uploadHelper.getMimeTypes(), {mime : type});\r\n            if(mime){\r\n                return mime.label;\r\n            }else{\r\n                return type;\r\n            }\r\n        });\r\n\r\n        if(messageWrongType && _.isFunction(messageWrongType)){\r\n            return messageWrongType({\r\n                userSelectedType : userSelectedType,\r\n                types : expectedTypeLabels\r\n            });\r\n        }else{\r\n            return __('Wrong type of file. Expected %s. The selected file has the mimetype \"%s\".', expectedTypeLabels.join(__(' or ')), userSelectedType);\r\n        }\r\n    };\r\n\r\n    var _handleSelectedFiles = function _handleSelectedFiles(interaction, file, messageWrongType) {\r\n\r\n        var reader;\r\n        var $container = containerHelper.get(interaction);\r\n\r\n        // Show information about the processed file to the candidate.\r\n        var filename = file.name;\r\n        var filetype = mimetype.getMimeType(file);\r\n        instructionMgr.removeInstructions(interaction);\r\n        instructionMgr.appendInstruction(interaction, _initialInstructions);\r\n\r\n        if (!validateFileType(file, interaction)) {\r\n            instructionMgr.removeInstructions(interaction);\r\n            instructionMgr.appendInstruction(interaction, getMessageWrongType(interaction, filetype, messageWrongType), function () {\r\n                this.setLevel('error');\r\n                //clear preview\r\n            });\r\n            instructionMgr.validateInstructions(interaction);\r\n            return;\r\n        }\r\n\r\n        $container.find('.file-name').empty()\r\n            .append(filename);\r\n\r\n        // Let's read the file to get its base64 encoded content.\r\n        reader = new FileReader();\r\n\r\n        // Update file processing progress.\r\n\r\n        reader.onload = function (e) {\r\n            var base64Data, commaPosition, base64Raw, $previewArea;\r\n\r\n            instructionMgr.removeInstructions(interaction);\r\n            instructionMgr.appendInstruction(interaction, _readyInstructions, function () {\r\n                this.setLevel('success');\r\n            });\r\n            instructionMgr.validateInstructions(interaction);\r\n\r\n            $container.find('.progressbar').progressbar('value', 100);\r\n\r\n            base64Data = e.target.result;\r\n            commaPosition = base64Data.indexOf(',');\r\n\r\n            // Store the base64 encoded data for later use.\r\n            base64Raw = base64Data.substring(commaPosition + 1);\r\n            interaction.data('_response', {base: {file: {data: base64Raw, mime: filetype, name: filename}}});\r\n\r\n            $previewArea = $container.find('.file-upload-preview');\r\n            $previewArea.previewer({\r\n                url: base64Data,\r\n                name: filename,\r\n                mime: filetype\r\n            });\r\n\r\n            // we wait for the image to be completely loaded\r\n            $previewArea.waitForMedia(function(){\r\n                var $originalImg = $previewArea.find('img'),\r\n                    $largeDisplay = $('.file-upload-preview-popup'),\r\n                    $item = $('.qti-item'),\r\n                    itemWidth = $item.width(),\r\n                    winWidth = $(window).width() - 80,\r\n                    fullHeight = $('body').height(),\r\n                    imgNaturalWidth,\r\n                    isOversized,\r\n                    modalWidth;\r\n\r\n                if(!$originalImg.length) {\r\n                    return;\r\n                }\r\n\r\n                imgNaturalWidth = $originalImg[0].naturalWidth;\r\n                isOversized = imgNaturalWidth > itemWidth;\r\n                modalWidth = Math.min(winWidth, imgNaturalWidth);\r\n\r\n                $previewArea.toggleClass('clickable', isOversized);\r\n\r\n                if(!isOversized) {\r\n                    return;\r\n                }\r\n\r\n                $previewArea.on('click', function(){\r\n                    var $modalBody;\r\n\r\n                    $('.upload-ia-modal-bg').remove();\r\n\r\n                    // remove any previous unnecessary content before inserting the preview image\r\n                    $modalBody = $largeDisplay.find('.modal-body');\r\n                    $modalBody.empty().append($originalImg.clone());\r\n\r\n                    $largeDisplay\r\n                        .on('opened.modal', function(){\r\n\r\n                            // prevents the rest of the page from scrolling when modal is open\r\n                            $('.tao-item-scope.tao-preview-scope').css('overflow', 'hidden');\r\n\r\n                            $largeDisplay.css({\r\n                                width: modalWidth,\r\n                                height: fullHeight,\r\n                                left: (modalWidth - itemWidth -40) / -2\r\n                            });\r\n\r\n                        })\r\n                        .on('closed.modal', function(){\r\n                            // make the page scrollable again\r\n                            $('.tao-item-scope.tao-preview-scope').css('overflow', 'auto');\r\n\r\n                        })\r\n                        .modal({modalOverlayClass: 'modal-bg upload-ia-modal-bg'});\r\n\r\n                });\r\n            });\r\n\r\n        };\r\n\r\n        reader.onloadstart = function onloadstart() {\r\n            instructionMgr.removeInstructions(interaction);\r\n            $container.find('.progressbar').progressbar('value', 0);\r\n        };\r\n\r\n        reader.onprogress = function onprogress(e) {\r\n            var percentProgress = Math.ceil(Math.round(e.loaded) / Math.round(e.total) * 100);\r\n            $container.find('.progressbar').progressbar('value', percentProgress);\r\n        };\r\n\r\n        reader.readAsDataURL(file);\r\n\r\n    };\r\n\r\n    var _resetGui = function _resetGui(interaction) {\r\n        var $container = containerHelper.get(interaction);\r\n        $container.find('.file-name').text(__('No file selected'));\r\n        $container.find('.btn-info').text(__('Browse...'));\r\n    };\r\n\r\n    /**\r\n     * Init rendering, called after template injected into the DOM\r\n     * All options are listed in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     */\r\n    var render = function render(interaction) {\r\n        var changeListener, self = this, $input;\r\n        var $container = containerHelper.get(interaction);\r\n        _resetGui(interaction);\r\n\r\n        instructionMgr.appendInstruction(interaction, _initialInstructions);\r\n\r\n        //init response\r\n        interaction.data('_response', {base: null});\r\n\r\n        changeListener = function (e) {\r\n            var file = e.target.files[0];\r\n\r\n            // Are you really sure something was selected\r\n            // by the user... huh? :)\r\n            if (typeof(file) !== 'undefined') {\r\n                _handleSelectedFiles(interaction, file, self.getCustomMessage('upload', 'wrongType'));\r\n            }\r\n        };\r\n\r\n        $input = $container.find('input');\r\n\r\n        $container.find('.progressbar').progressbar();\r\n\r\n        if (!window.FileReader) {\r\n            throw new Error('FileReader API not supported! Please use a compliant browser!');\r\n        }\r\n        $input.bind('change', changeListener);\r\n\r\n        // IE Specific hack, prevents button to slightly move on click\r\n        $input.bind('mousedown', function (e) {\r\n            e.preventDefault();\r\n            $(this).blur();\r\n            return false;\r\n        });\r\n    };\r\n\r\n    var resetResponse = function resetResponse(interaction) {\r\n        _resetGui(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the response to the rendered interaction.\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @param {object} response\r\n     */\r\n    var setResponse = function setResponse(interaction, response) {\r\n        var filename, $container = containerHelper.get(interaction);\r\n\r\n        if (response.base !== null) {\r\n            filename = (typeof response.base.file.name !== 'undefined') ? response.base.file.name :\r\n                'previously-uploaded-file';\r\n            $container.find('.file-name').empty()\r\n                .text(filename);\r\n        }\r\n\r\n        interaction.data('_response', response);\r\n    };\r\n\r\n    /**\r\n     * Return the response of the rendered interaction\r\n     *\r\n     * The response format follows the IMS PCI recommendation :\r\n     * http://www.imsglobal.org/assessment/pciv1p0cf/imsPCIv1p0cf.html#_Toc353965343\r\n     *\r\n     * Available base types are defined in the QTI v2.1 information model:\r\n     * http://www.imsglobal.org/question/qtiv2p1/imsqti_infov2p1.html#element10321\r\n     *\r\n     * @param {object} interaction\r\n     * @returns {object}\r\n     */\r\n    var getResponse = function getResponse(interaction) {\r\n        return interaction.data('_response');\r\n    };\r\n\r\n    var destroy = function destroy(interaction) {\r\n\r\n        //remove event\r\n        $(document).off('.commonRenderer');\r\n        containerHelper.get(interaction).off('.commonRenderer');\r\n\r\n        //remove instructions\r\n        instructionMgr.removeInstructions(interaction);\r\n\r\n        //remove all references to a cache container\r\n        containerHelper.reset(interaction);\r\n    };\r\n\r\n    /**\r\n     * Set the interaction state. It could be done anytime with any state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @param {Object} state - the interaction state\r\n     */\r\n    var setState = function setState(interaction, state) {\r\n        if (_.isObject(state)) {\r\n            if (state.response) {\r\n                interaction.resetResponse();\r\n                interaction.setResponse(state.response);\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Get the interaction state.\r\n     *\r\n     * @param {Object} interaction - the interaction instance\r\n     * @returns {Object} the interaction current state\r\n     */\r\n    var getState = function getState(interaction) {\r\n        var state = {};\r\n        var response = interaction.getResponse();\r\n\r\n        if (response) {\r\n            state.response = response;\r\n        }\r\n        return state;\r\n    };\r\n\r\n    /**\r\n     * Set additional data to the template (data that are not really part of the model).\r\n     * @param {Object} interaction - the interaction\r\n     * @param {Object} [data] - interaction custom data\r\n     * @returns {Object} custom data\r\n     * This way we could cover a lot more types. How could this be matched with the preview templates\r\n     * in tao/views/js/ui/previewer.js\r\n     */\r\n    var getCustomData = function getCustomData (interaction, data) {\r\n        return _.merge(data || {}, {\r\n            accept : uploadHelper.getExpectedTypes(interaction, true).join(',')\r\n        });\r\n    };\r\n\r\n    return {\r\n        qtiClass: 'uploadInteraction',\r\n        template: tpl,\r\n        render: render,\r\n        getContainer: containerHelper.get,\r\n        setResponse: setResponse,\r\n        getResponse: getResponse,\r\n        resetResponse: resetResponse,\r\n        destroy: destroy,\r\n        setState: setState,\r\n        getState: getState,\r\n        getData: getCustomData,\r\n\r\n        // Exposed private methods for qtiCreator\r\n        resetGui: _resetGui\r\n    };\r\n\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/upload', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    \t\t<option value=\\\"\";\n  if (helper = helpers.mime) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.mime); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n    \t\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\n  buffer += \"<h3>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"MIME-type\", options) : helperMissing.call(depth0, \"__\", \"MIME-type\", options)))\n    + \"</h3>\\r\\n<span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n<div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The MIME-type attribute describes which kind of file may be uploaded.\", options) : helperMissing.call(depth0, \"__\", \"The MIME-type attribute describes which kind of file may be uploaded.\", options)))\n    + \"</div>\\r\\n\\r\\n<div class=\\\"reset-group\\\">\\r\\n    <select name=\\\"type\\\" class=\\\"select2\\\" multiple data-has-search=\\\"false\\\">\\r\\n    \t\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.types), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </select>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/uploadInteraction/states/Question',[\r\n    'lodash',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/uploadMime',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/interactions/upload'\r\n], function(_, __, stateFactory, Question, formElement, uploadHelper, formTpl){\r\n\r\n    'use strict';\r\n    var UploadInteractionStateQuestion = stateFactory.extend(Question);\r\n\r\n    UploadInteractionStateQuestion.prototype.initForm = function() {\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            interaction = _widget.element,\r\n            callbacks = {},\r\n            types = uploadHelper.getMimeTypes(),\r\n            selectedMime = '',\r\n            // Pre-select a value in the types combo box if needed.\r\n            preselected = uploadHelper.getExpectedTypes(interaction);\r\n\r\n        types.unshift({ \"mime\" : \"any/kind\", \"label\" : __(\"-- Any kind of file --\") });\r\n\r\n        if (interaction.attr('type') === '') {\r\n            // Kill the attribute if it is empty.\r\n            delete interaction.attributes.type;\r\n        }\r\n\r\n        for (var i in types) {\r\n            if (_.indexOf(preselected, types[i].mime) >= 0) {\r\n                types[i].selected = true;\r\n                selectedMime = types[i].mime;\r\n            }\r\n        }\r\n        $form.html(formTpl({\r\n            types : types\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n        var $select = $form.find('[name=\"type\"]');\r\n        $select.select2({\r\n            width: '100%',\r\n            formatNoMatches : function(){\r\n                return __('Enter a select MIME-type');\r\n            }\r\n        });\r\n\r\n        // -- type callback.\r\n        callbacks.type = function(interaction, attrValue) {\r\n            uploadHelper.setExpectedTypes(interaction, attrValue);\r\n        };\r\n\r\n        //init data change callbacks\r\n        formElement.setChangeCallbacks($form, interaction, callbacks);\r\n    };\r\n\r\n    return UploadInteractionStateQuestion;\r\n});\r\n\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/uploadInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/blockInteraction/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/uploadInteraction/states/Question'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments, ['map']);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/uploadInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/uploadInteraction/states/states'\r\n], function(Widget, states){\r\n\r\n    var UploadInteractionWidget = Widget.clone();\r\n\r\n    UploadInteractionWidget.initCreator = function(){\r\n        \r\n        this.registerStates(states);\r\n        \r\n        Widget.initCreator.call(this);\r\n    };\r\n\r\n    return UploadInteractionWidget;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/interactions/uploadInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program3(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers['visible-file-upload-preview']) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0['visible-file-upload-preview']); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<div class=\\\"qti-interaction qti-blockInteraction qti-uploadInteraction\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n\t\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\t<div class=\\\"instruction-container\\\"></div>\\r\\n    <div class=\\\"fixed-grid-row file-upload lft\\\">\\r\\n        <span class=\\\"btn-info small col-4\\\"></span>\\r\\n        <span class=\\\"file-name placeholder col-8 truncate\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"file-upload-preview lft \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.isPreviewable), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\r\\n        <p class=\\\"nopreview\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"No preview available\", options) : helperMissing.call(depth0, \"__\", \"No preview available\", options)))\n    + \"</p>\\r\\n    </div>\\r\\n</div>\\r\\n\\r\\n\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/interactions/UploadInteraction',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/interactions/UploadInteraction',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/uploadInteraction/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/interactions/uploadInteraction'\r\n], function(_, UploadInteraction, UploadInteractionWidget, tpl){\r\n    'use strict';\r\n\r\n    UploadInteraction = _.clone(UploadInteraction);\r\n\r\n    UploadInteraction.template = tpl;\r\n    UploadInteraction.render = function(interaction, options){\r\n\r\n        UploadInteraction.resetGui(interaction);\r\n\r\n        UploadInteractionWidget.build(\r\n            interaction,\r\n            UploadInteraction.getContainer(interaction),\r\n            this.getOption('interactionOptionForm'),\r\n            this.getOption('responseOptionForm'),//note : no response required...\r\n            options\r\n        );\r\n    };\r\n\r\n    return UploadInteraction;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/item', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"qti-item tao-scope runtime\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n    <div\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-itemBody \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n    <div id=\\\"modalFeedbacks\\\"></div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n */\r\n\r\n/**\r\n * TODO this code should be merged with the theme loader\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/helpers/itemStylesheetHandler',[\r\n    'jquery',\r\n    'lodash'\r\n], function($, _){\r\n    'use strict';\r\n\r\n    //throttle events because of the loop\r\n    var informLoaded = _.throttle(function(){\r\n        $(document).trigger('customcssloaded.styleeditor');\r\n    }, 10, {leading : false});\r\n\r\n    /**\r\n     * Attach QTI Stylesheets to the document\r\n     *\r\n     * @param {Array} stylesheets - the QTI model stylesheets\r\n     * @fires customcssloaded.styleeditor on document 10ms after stylesheets are loaded\r\n     */\r\n    var attach = function attach(stylesheets) {\r\n        var $head = $('head');\r\n\r\n        //fallback\r\n        if(!$head.length){\r\n            $head = $('body');\r\n        }\r\n\r\n         // relative links with cache buster\r\n        _(stylesheets).forEach(function(stylesheet){\r\n            var $link,\r\n                href;\r\n\r\n            //if the href is something\r\n            if(stylesheet.attr('href')){\r\n                $link = $(stylesheet.render());\r\n\r\n                //get the resolved href once rendererd\r\n                href = $link.attr('href');\r\n\r\n                //we need to set the href after the link is appended to the head (for our dear IE)\r\n                $link.removeAttr('href')\r\n                     .attr('href', href);\r\n\r\n                $link.one('load', informLoaded)\r\n                     .appendTo($head);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Remove QTI Stylesheets from the document\r\n     *\r\n     * @param {Array} stylesheets - the QTI model stylesheets\r\n     */\r\n    var detach = function detach(stylesheets) {\r\n        _(stylesheets).forEach(function(stylesheet){\r\n            if(stylesheet.serial){\r\n                $('link[data-serial=\"' + stylesheet.serial + '\"]').remove();\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * @exports taoQtiItem/qtiCommonRenderer/helpers/itemStylesheetHandler\r\n     */\r\n    return {\r\n        attach: attach,\r\n        detach : detach\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\n/**\r\n * Define the Item Element Renderer\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Item',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/item',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/itemStylesheetHandler'\r\n], function(tpl, containerHelper, itemStylesheetHandler) {\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass: 'assessmentItem',\r\n        template: tpl,\r\n        getContainer: containerHelper.get,\r\n\r\n        /**\r\n         * Rendering initializations for the item\r\n         * @param {Object} item - the item model\r\n         */\r\n        render: function render(item) {\r\n            //target blank for all <a>\r\n            containerHelper.targetBlank(containerHelper.get(item));\r\n\r\n            //add stylesheets\r\n            itemStylesheetHandler.attach(item.stylesheets);\r\n        },\r\n\r\n        /**\r\n         * Unrender\r\n         * @param {Object} item - the item model\r\n         */\r\n        destroy : function destroy(item){\r\n\r\n            //clear the container cache\r\n            containerHelper.clear();\r\n\r\n            //detach stylesheets\r\n            if(item.stylesheets){\r\n                itemStylesheetHandler.detach(item.stylesheets);\r\n            }\r\n        }\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/item', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The principle identifier of the item. This identifier must have a corresponding entry in the item's metadata.\", options) : helperMissing.call(depth0, \"__\", \"The principle identifier of the item. This identifier must have a corresponding entry in the item's metadata.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"identifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. my-item_123456\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n    \\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Title\", options) : helperMissing.call(depth0, \"__\", \"Title\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The item of the qti item. It is currently used as a meta data only. It is required by the QTI standard.\", options) : helperMissing.call(depth0, \"__\", \"The item of the qti item. It is currently used as a meta data only. It is required by the QTI standard.\", options)))\n    + \"</div>\\r\\n\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"title\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. My Item A\\\" \\r\\n           data-validate=\\\"$notEmpty;\\\">\\r\\n    \\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"timeDependent\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.timeDependent), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Time dependent\", options) : helperMissing.call(depth0, \"__\", \"Time dependent\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Define whether the item should be time dependent on delivery.\", options) : helperMissing.call(depth0, \"__\", \"Define whether the item should be time dependent on delivery.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/item/states/Active',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/states/Active',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/item',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement'\r\n], function(stateFactory, Active, formTpl, formElement){\r\n    \r\n    'use strict';\r\n    \r\n    var ItemStateActive = stateFactory.create(Active, function(){\r\n\r\n        this.initForm();\r\n\r\n    }, function(){\r\n\r\n    });\r\n\r\n    ItemStateActive.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            item = _widget.element,\r\n            $form = _widget.$form;\r\n\r\n        //build form:\r\n        $form.html(formTpl({\r\n            serial : item.getSerial(),\r\n            identifier : item.id(),\r\n            title : item.attr('title'),\r\n            timeDependent : !!item.attr('timeDependent')\r\n        }));\r\n        \r\n        //init widget\r\n        formElement.initWidget($form);\r\n\r\n        //init data validation and binding\r\n        formElement.setChangeCallbacks($form, item, {\r\n            identifier : formElement.getAttributeChangeCallback(),\r\n            title : formElement.getAttributeChangeCallback(),\r\n            timeDependent : formElement.getAttributeChangeCallback()\r\n        });\r\n    };\r\n\r\n    return ItemStateActive;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/item/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/item/states/Active'\r\n], function(factory){\r\n    return factory.createBundle(arguments);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/item/Widget',[\r\n    'lodash',\r\n    'i18n',\r\n    'jquery',\r\n    'core/promise',\r\n    'util/url',\r\n    'taoQtiItem/qtiCreator/widgets/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/item/states/states',\r\n    'taoQtiItem/qtiItem/core/Element',\r\n    'taoQtiItem/qtiCreator/helper/creatorRenderer',\r\n    'taoQtiItem/qtiCreator/model/helper/container',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'taoQtiItem/qtiCreator/helper/xmlRenderer',\r\n    'taoQtiItem/qtiCreator/helper/devTools',\r\n    'taoQtiItem/qtiCreator/widgets/static/text/Widget',\r\n    'taoQtiItem/qtiCreator/editor/styleEditor/styleEditor',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/notifications/genericFeedbackPopup',\r\n    'taoQtiItem/qtiCreator/editor/jquery.gridEditor'\r\n], function(\r\n    _,\r\n    __,\r\n    $,\r\n    Promise,\r\n    urlUtil,\r\n    Widget,\r\n    states,\r\n    Element,\r\n    creatorRenderer,\r\n    containerHelper,\r\n    contentHelper,\r\n    xmlRenderer,\r\n    devTools,\r\n    TextWidget,\r\n    styleEditor,\r\n    genericFeedbackPopup\r\n    ){\r\n\r\n    'use strict';\r\n\r\n    var ItemWidget = Widget.clone();\r\n\r\n    ItemWidget.initCreator = function(config){\r\n        var self = this;\r\n        this.registerStates(states);\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        if(!config || !config.uri){\r\n            throw new Error('missing required config parameter uri in item widget initialization');\r\n        }\r\n\r\n        this.saveItemUrl = config.saveItemUrl;\r\n\r\n        this.renderer = config.renderer;\r\n\r\n        this.itemUri = config.uri;\r\n\r\n        //this.initUiComponents();\r\n\r\n        return new Promise(function(resolve){\r\n            self.initTextWidgets(function(){\r\n\r\n                //when the text widgets are ready:\r\n                this.initGridEditor();\r\n\r\n                //active debugger\r\n                this.debug({\r\n                    state : false,\r\n                    xml : false\r\n                });\r\n\r\n                resolve();\r\n            });\r\n        });\r\n    };\r\n\r\n    ItemWidget.buildContainer = function(){\r\n\r\n        this.$container = this.$original;\r\n    };\r\n\r\n    /**\r\n     * Save the item by sending the XML in a POST request to the server\r\n     *TODO saving mechanism should be indenpendant, ie. moved into the itemCreator, in order to configure endpoint, etc.\r\n     *\r\n     * @returns {Promise} that wraps the request\r\n     */\r\n    ItemWidget.save = function(){\r\n        var self = this;\r\n        return new Promise(function(resolve, reject){\r\n            var xml;\r\n\r\n            // transform application errors into object Error in order to make them displayable\r\n            function rejectError(err) {\r\n                if (err.type === 'Error') {\r\n                    err = new Error(__('The item has not been saved!') + (err.message ? '\\n' + err.message : ''));\r\n                }\r\n                reject(err);\r\n            }\r\n\r\n            xml = xmlRenderer.render(self.element);\r\n\r\n            //@todo : remove this hotfix : prevent unsupported custom interaction to be saved\r\n            if(hasUnsupportedInteraction(xml)){\r\n                return reject(new Error(__('The item cannot be saved because it contains an unsupported custom interaction.')));\r\n            }\r\n\r\n            $.ajax({\r\n                url : urlUtil.build(self.saveItemUrl, {uri: self.itemUri}),\r\n                type : 'POST',\r\n                contentType : 'text/xml',\r\n                dataType : 'json',\r\n                data : xml\r\n            })\r\n                .done(function(data) {\r\n                    if (!data || data.success) {\r\n                        resolve(data);\r\n                    } else {\r\n                        rejectError(data);\r\n                    }\r\n                })\r\n                .fail(rejectError);\r\n        });\r\n    };\r\n\r\n    ItemWidget.initUiComponents = function(){\r\n\r\n        var _widget = this,\r\n            element = _widget.element,\r\n            $saveBtn = $('#save-trigger'),\r\n            $previewBtn = $('.preview-trigger');\r\n\r\n        //init save button:\r\n      /*  $saveBtn.on('click', function(e){\r\n\r\n            var $saveButton = $(this);\r\n\r\n            //trigger save event\r\n            $saveButton.trigger('beforesave.qti-creator');\r\n\r\n            if($saveButton.hasClass('disabled')){\r\n                e.preventDefault();\r\n                return;\r\n            }\r\n\r\n            $saveButton.addClass('active');\r\n\r\n            //defer exceution of save function to give beforesave chance to be executed\r\n            _.defer(function(){\r\n\r\n                $.when(styleEditor.save(), _widget.save()).done(function(){\r\n\r\n                    var success = true,\r\n                        feedbackArgs = {\r\n                        message : __('Your item has been saved'),\r\n                        type : 'success'\r\n                    },\r\n                    i = arguments.length;\r\n\r\n                    $saveButton.removeClass('active');\r\n\r\n                    while(i--){\r\n                        if(arguments[i][1].toLowerCase() !== 'success'){\r\n                            feedbackArgs = {\r\n                                message : __('Failed to save item'),\r\n                                type : 'error'\r\n                            };\r\n                            success = false;\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    $saveButton.trigger('aftersave.qti-creator', [success]);\r\n                    _createInfoBox(feedbackArgs);\r\n                });\r\n            });\r\n\r\n        });*/\r\n\r\n        //$previewBtn.on('click', function(){\r\n            //itemEditor.initPreview(_widget);\r\n        //});\r\n\r\n        //listen to invalid states:\r\n        _widget.on('metaChange', function(data){\r\n            if(data.element.getSerial() === element.getSerial() && data.key === 'invalid'){\r\n                var invalid = element.data('invalid');\r\n                if(_.size(invalid)){\r\n                    $saveBtn.addClass('disabled');\r\n                }else{\r\n                    $saveBtn.removeClass('disabled');\r\n                }\r\n            }\r\n        }, true);\r\n\r\n    };\r\n\r\n    ItemWidget.initGridEditor = function(){\r\n\r\n        var _this = this,\r\n            item = this.element,\r\n            $itemBody = this.$container.find('.qti-itemBody'),\r\n            $itemEditorPanel = $('#item-editor-panel');\r\n\r\n        $itemBody.gridEditor();\r\n        $itemBody.gridEditor('resizable');\r\n        $itemBody.gridEditor('addInsertables', $('.tool-list > [data-qti-class]:not(.disabled)'), {\r\n            helper : function(){\r\n                return $(this).find('.icon').clone().addClass('dragging');\r\n            }\r\n        });\r\n\r\n        $itemBody.on('beforedragoverstart.gridEdit', function(){\r\n\r\n            $itemEditorPanel.addClass('dragging');\r\n            $itemBody.removeClass('hoverable').addClass('inserting');\r\n\r\n        }).on('dragoverstop.gridEdit', function(){\r\n\r\n            $itemEditorPanel.removeClass('dragging');\r\n            $itemBody.addClass('hoverable').removeClass('inserting');\r\n\r\n        }).on('dropped.gridEdit.insertable', function(e, qtiClass, $placeholder){\r\n\r\n            //a new qti element has been added: update the model + render\r\n            $placeholder.removeAttr('id');//prevent it from being deleted\r\n\r\n            if(qtiClass === 'rubricBlock'){\r\n                //qti strange exception: a rubricBlock must be the first child of itemBody, nothing else...\r\n                //so in this specific case, consider the whole row as the rubricBlock\r\n                //by the way, in our grid system, rubricBlock can only have a width of col-12\r\n                $placeholder = $placeholder.parent('.col-12').parent('.grid-row');\r\n            }\r\n\r\n            $placeholder.addClass('widget-box');//required for it to be considered as a widget during container serialization\r\n            $placeholder.attr({\r\n                'data-new' : true,\r\n                'data-qti-class' : qtiClass\r\n            });//add data attribute to get the dom ready to be replaced by rendering\r\n\r\n            var $widget = $placeholder.parent().closest('.widget-box, .qti-item');\r\n            var $editable = $placeholder.closest('[data-html-editable], .qti-itemBody');\r\n            var widget = $widget.data('widget');\r\n            var element = widget.element;\r\n            var container = Element.isA(element, '_container') ? element : element.getBody();\r\n\r\n            if(!element || !$editable.length){\r\n                throw new Error('cannot create new element');\r\n            }\r\n\r\n            containerHelper.createElements(container, contentHelper.getContent($editable), function(newElts){\r\n\r\n                creatorRenderer.get().load(function(){\r\n                    var self = this;\r\n\r\n                    _.forEach(newElts, function(elt, serial){\r\n                        var $widget,\r\n                            widget,\r\n                            $colParent = $placeholder.parent();\r\n\r\n\r\n                        elt.setRenderer(self);\r\n\r\n                        if(Element.isA(elt, '_container')){\r\n                            $colParent.empty();//clear the col content, and leave an empty text field\r\n                            $colParent.html(elt.render());\r\n                            widget = _this.initTextWidget(elt, $colParent);\r\n                            $widget = widget.$container;\r\n                        }else{\r\n                            elt.render($placeholder);\r\n\r\n                            //TODO resolve the promise it returns\r\n                            elt.postRender();\r\n                            widget = elt.data('widget');\r\n                            if(Element.isA(elt, 'blockInteraction')){\r\n                                $widget = widget.$container;\r\n                            }else{\r\n                                //leave the container in place\r\n                                $widget = widget.$original;\r\n                            }\r\n                        }\r\n\r\n                        //inform height modification\r\n                        $widget.trigger('contentChange.gridEdit');\r\n                        $widget.trigger('resize.gridEdit');\r\n\r\n                        //active it right away:\r\n                        if(Element.isA(elt, 'interaction')){\r\n                            widget.changeState('question');\r\n                        }else{\r\n                            widget.changeState('active');\r\n                        }\r\n\r\n                    });\r\n                }, this.getUsedClasses());\r\n            });\r\n\r\n        }).on('resizestop.gridEdit', function(){\r\n\r\n            item.body($itemBody.gridEditor('getContent'));\r\n\r\n        });\r\n\r\n    };\r\n\r\n    ItemWidget.initTextWidgets = function(callback){\r\n\r\n        var _this = this,\r\n            item = this.element,\r\n            $originalContainer = this.$container,\r\n            i = 1,\r\n            subContainers = [];\r\n\r\n        callback = callback || _.noop;\r\n\r\n        //temporarily tag col that need to be transformed into\r\n        $originalContainer.find('.qti-itemBody > .grid-row').each(function(){\r\n\r\n            var $row = $(this);\r\n\r\n            if(!$row.hasClass('widget-box')){//not a rubricBlock\r\n                $row.children().each(function(){\r\n\r\n                    var $col = $(this),\r\n                        isTextBlock = false;\r\n\r\n                    $col.contents().each(function(){\r\n                        if(this.nodeType === 3 && this.nodeValue && this.nodeValue.trim()){\r\n                            isTextBlock = true;\r\n                            return false;\r\n                        }\r\n                    });\r\n\r\n                    var $widget = $col.children();\r\n                    if($widget.length > 1 || !$widget.hasClass('widget-blockInteraction')){//not an immediate qti element\r\n                        if($widget.hasClass('colrow')){\r\n                            $widget.each(function(){\r\n                                var $subElement = $(this);\r\n                                var $subWidget = $subElement.children();\r\n                                if($subWidget.length > 1 || !$subWidget.hasClass('widget-blockInteraction')){\r\n                                    $subElement.attr('data-text-block-id', 'text-block-' + i);\r\n                                    i++;\r\n                                }\r\n                            });\r\n                        }else{\r\n                            isTextBlock = true;\r\n                        }\r\n                    }\r\n\r\n                    if(isTextBlock){\r\n                        $col.attr('data-text-block-id', 'text-block-' + i);\r\n                        i++;\r\n                    }\r\n                });\r\n            }\r\n        });\r\n\r\n        //clone the container to create the new container model:\r\n        var $clonedContainer = $originalContainer.clone();\r\n        $clonedContainer.find('.qti-itemBody > .grid-row [data-text-block-id]').each(function(){\r\n\r\n            var $originalTextBlock = $(this),\r\n                textBlockId = $originalTextBlock.data('text-block-id'),\r\n                $subContainer = $originalTextBlock.clone(),\r\n                subContainerElements = contentHelper.serializeElements($subContainer),\r\n                subContainerBody = $subContainer.html();//get serialized body\r\n\r\n            $originalTextBlock.removeAttr('data-text-block-id').html('{{_container:new}}');\r\n\r\n            subContainers.push({\r\n                body : subContainerBody,\r\n                elements : subContainerElements,\r\n                $original : $originalContainer.find('[data-text-block-id=\"' + textBlockId + '\"]').removeAttr('data-text-block-id')\r\n            });\r\n        });\r\n\r\n        //create new container model with the created sub containers\r\n        contentHelper.serializeElements($clonedContainer);\r\n\r\n        var serializedItemBody = $clonedContainer.find('.qti-itemBody').html(),\r\n            itemBody = item.getBody();\r\n\r\n        if(subContainers.length){\r\n\r\n            containerHelper.createElements(itemBody, serializedItemBody, function(newElts){\r\n\r\n                if(_.size(newElts) !== subContainers.length){\r\n\r\n                    throw 'number of sub-containers mismatch';\r\n                }else{\r\n\r\n                    _.each(newElts, function(container){\r\n\r\n                        var containerData = subContainers.shift();//get data in order\r\n                        var containerElements = _detachElements(itemBody, containerData.elements);\r\n\r\n                        container.setElements(containerElements, containerData.body);\r\n\r\n                        _this.initTextWidget(container, containerData.$original);\r\n\r\n                    });\r\n\r\n                    _.defer(function(){\r\n                        callback.call(_this);\r\n                    });\r\n                }\r\n            });\r\n\r\n        }else{\r\n\r\n            callback.call(_this);\r\n        }\r\n\r\n    };\r\n\r\n    var _detachElements = function(container, elements){\r\n\r\n        var containerElements = {};\r\n        _.each(elements, function(elementSerial){\r\n            containerElements[elementSerial] = container.elements[elementSerial];\r\n            delete container.elements[elementSerial];\r\n        });\r\n        return containerElements;\r\n    };\r\n\r\n    ItemWidget.initTextWidget = function(container, $col){\r\n        return TextWidget.build(container, $col, this.renderer.getOption('textOptionForm'), {});\r\n    };\r\n\r\n    /**\r\n     * Enable debugging\r\n     *\r\n     * @param {Boolean} [options.state = false] - log state change in console\r\n     * @param {Boolean} [options.xml = false] - real-time qti xml display under the creator\r\n     */\r\n    ItemWidget.debug = function(options){\r\n\r\n        options = options || {};\r\n\r\n        if(options.state){\r\n            devTools.listenStateChange();\r\n        }\r\n\r\n        if(options.xml){\r\n            var $code = $('<code>', {'class' : 'language-markup'}),\r\n                $pre = $('<pre>', {'class' : 'line-numbers'}).append($code);\r\n\r\n            $('#item-editor-wrapper').append($pre);\r\n            devTools.liveXmlPreview(this.element, $code);\r\n        }\r\n\r\n    };\r\n\r\n    var _createInfoBox = function(data){\r\n        var $messageBox = $(genericFeedbackPopup(data)),\r\n            closeTrigger = $messageBox.find('.close-trigger');\r\n\r\n        $('body').append($messageBox);\r\n\r\n        closeTrigger.on('click', function(){\r\n            $messageBox.fadeOut(function(){\r\n                $(this).remove();\r\n            });\r\n        });\r\n\r\n        setTimeout(function(){\r\n            closeTrigger.trigger('click');\r\n        }, 2000);\r\n\r\n        return $messageBox;\r\n    };\r\n\r\n    function hasUnsupportedInteraction(xml){\r\n        var $qti = $(xml);\r\n        return ($qti.find('div.qti-interaction.qti-customInteraction[data-serial]').length > 0);\r\n    }\r\n\r\n    return ItemWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/item', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" id=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"tao-scope qti-item item-editor-item clearfix\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n    <div id=\\\"modalFeedbacks\\\"></div>\\r\\n    <div\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.id), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" class=\\\"qti-itemBody item-editor-drop-area hoverable\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/Item',[\r\n    'jquery',\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Item',\r\n    'taoQtiItem/qtiCreator/widgets/item/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/item'\r\n], function($, _, CommonRenderer, Widget, tpl){\r\n    'use strict';\r\n\r\n    var CreatorItem = _.clone(CommonRenderer);\r\n\r\n    var _normalizeItemBody = function _normalizeItemBody($itemBody) {\r\n\r\n        $itemBody.children().each(function(){\r\n            var $child = $(this);\r\n            //must be a grid-row for editing:\r\n            if(!$child.hasClass('grid-row') && !$child.hasClass('qti-infoControl')){\r\n                $child.wrap('<div class=\"grid-row\"><div class=\"col-12\"></div></div>');\r\n            }\r\n        });\r\n\r\n        return $itemBody;\r\n    };\r\n\r\n    CreatorItem.template = tpl;\r\n\r\n    CreatorItem.render = function(item, options){\r\n\r\n        var $itemContainer = CommonRenderer.getContainer(item);\r\n\r\n        _normalizeItemBody($itemContainer.find('.qti-itemBody'));\r\n\r\n        options = options || {};\r\n        options.state = 'active';//the item widget never sleeps ! <- this sounds very scary!\r\n        options.renderer = this;\r\n\r\n        return Widget.build(\r\n            item,\r\n            $itemContainer,\r\n            this.getOption('itemOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorItem;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/math', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n<span data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"math\\\">\\r\\n    <math display = \\\"block\\\">\";\n  if (helper = helpers.raw) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.raw); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</math>\\r\\n</span>\\r\\n\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n<span data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"math\\\">\\r\\n    <math>\";\n  if (helper = helpers.raw) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.raw); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</math>\\r\\n</span>   \\r\\n\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.block), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\n\r\n/**\r\n * Math common renderer\r\n *\r\n * @author Sam Sipasseuth <sam@taotesting.com>\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Math',[\r\n    'lodash',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/math',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'mathJax'\r\n], function(_, Promise, tpl, containerHelper, MathJax){\r\n    'use strict';\r\n\r\n    // Do not wait between rendering each individual math element\r\n    // http://docs.mathjax.org/en/latest/api/hub.html\r\n    if(typeof(MathJax) !== 'undefined' && MathJax) {\r\n        MathJax.Hub.processSectionDelay = 0;\r\n    }\r\n\r\n    return {\r\n        qtiClass : 'math',\r\n        template : tpl,\r\n        getContainer : containerHelper.get,\r\n        render : function render (math){\r\n            return new Promise(function(resolve){\r\n                if(typeof(MathJax) !== 'undefined' && MathJax){\r\n                    //MathJax needs to be exported globally to integrate with tools like TTS, it's weird...\r\n                    if(!window.MathJax){\r\n                        window.MathJax = MathJax;\r\n                    }\r\n                    _.defer(function(){ //defer execution fix some rendering issue in chrome\r\n\r\n                        MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, containerHelper.get(math).parent()[0]]);\r\n\r\n                        //@see http://docs.mathjax.org/en/latest/advanced/typeset.html\r\n                        MathJax.Hub.Queue(resolve);\r\n                    });\r\n                }\r\n                else {\r\n                    resolve();\r\n                }\r\n            });\r\n        }\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/math/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/static/states/Sleep'], function(stateFactory, SleepState){\r\n    \r\n    var MathStateSleep = stateFactory.extend(SleepState, function(){}, function(){});\r\n    \r\n    return MathStateSleep;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/math', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\", self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"display\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Display\", options) : helperMissing.call(depth0, \"__\", \"Display\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"How the math expression should be displayed.\", options) : helperMissing.call(depth0, \"__\", \"How the math expression should be displayed.\", options)))\n    + \"</div>\\r\\n\\r\\n    <select name=\\\"display\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n        <option value=\\\"inline\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"inline\", options) : helperMissing.call(depth0, \"__\", \"inline\", options)))\n    + \"</option>\\r\\n        <option value=\\\"block\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"block\", options) : helperMissing.call(depth0, \"__\", \"block\", options)))\n    + \"</option>\\r\\n    </select>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"editMode\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Editing Mode\", options) : helperMissing.call(depth0, \"__\", \"Editing Mode\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"How the math expression should be edited\", options) : helperMissing.call(depth0, \"__\", \"How the math expression should be edited\", options)))\n    + \".</div>\\r\\n\\r\\n    <select name=\\\"editMode\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n        <option value=\\\"latex\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"LaTeX\", options) : helperMissing.call(depth0, \"__\", \"LaTeX\", options)))\n    + \"</option>\\r\\n        <option value=\\\"mathml\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"MathML\", options) : helperMissing.call(depth0, \"__\", \"MathML\", options)))\n    + \"</option>\\r\\n    </select>\\r\\n\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\" data-role=\\\"latex\\\" style=\\\"display:none;\\\">\\r\\n    <label for=\\\"sidebar-latex-field\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Latex\", options) : helperMissing.call(depth0, \"__\", \"Latex\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Edit math expression using LaTex type setting system, e.g. e^{i \\\\pi} = -1\", options) : helperMissing.call(depth0, \"__\", \"Edit math expression using LaTex type setting system, e.g. e^{i \\\\pi} = -1\", options)))\n    + \"</div>\\r\\n\\r\\n    <input id=\\\"sidebar-latex-field\\\" type=\\\"text\\\" name=\\\"latex\\\" value=\\\"\";\n  if (helper = helpers.latex) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.latex); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" placeholder=\\\"e.g. e^{i \\\\pi} = -1\\\"/>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <button class=\\\"btn-info small block popup-btn\\\" data-control=\\\"latex\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Large editor\", options) : helperMissing.call(depth0, \"__\", \"Large editor\", options)))\n    + \"</button>\\r\\n        <button class=\\\"btn-info small block popup-btn\\\" data-control=\\\"latexWysiwyg\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"WYSIWYG editor\", options) : helperMissing.call(depth0, \"__\", \"WYSIWYG editor\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\" data-role=\\\"mathml\\\" style=\\\"display:none;\\\">\\r\\n    <label for=\\\"sidebar-mathml-field\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"MathML\", options) : helperMissing.call(depth0, \"__\", \"MathML\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Edit math expression using MathML\", options) : helperMissing.call(depth0, \"__\", \"Edit math expression using MathML\", options)))\n    + \"</div>\\r\\n\\r\\n    <textarea id=\\\"sidebar-mathml-field\\\" name=\\\"mathml\\\">\";\n  if (helper = helpers.mathml) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.mathml); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</textarea>\\r\\n\\r\\n    <div class=\\\"panel\\\">\\r\\n        <button class=\\\"btn-info small block popup-btn\\\" data-control=\\\"mathml\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Large editor\", options) : helperMissing.call(depth0, \"__\", \"Large editor\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"math-buffer\\\" style=\\\"visibility:hidden;\\\"></div>\\r\\n</div>\\r\\n\\r\\n\";\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\r\\n<div class=\\\"panel\\\">\\r\\n    \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"MathJax is not installed.\", options) : helperMissing.call(depth0, \"__\", \"MathJax is not installed.\", options)))\n    + \"\\r\\n</div>\\r\\n\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.mathjax), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/mathPopup', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<textarea class=\\\"math-popup-input math-popup-input-\";\n  if (helper = helpers.popupMode) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.popupMode); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" name=\\\"\";\n  if (helper = helpers.popupMode) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.popupMode); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"-large\\\" placeholder=\\\"\";\n  if (helper = helpers.placeholder) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.placeholder); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"></textarea>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/math/states/Active',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'taoQtiItem/qtiCreator/helper/windowPopup',\r\n    'taoQtiItem/qtiCreator/editor/MathEditor',\r\n    'taoQtiItem/qtiCreator/editor/mathInput/mathInput',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/math',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/mathPopup',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/inline',\r\n    'ui/dynamicComponent',\r\n    'lodash',\r\n    'i18n',\r\n    'mathJax',\r\n    'ui/tooltip'\r\n], function(\r\n    $,\r\n    stateFactory,\r\n    Active,\r\n    windowPopupFactory,\r\n    MathEditor,\r\n    mathInputFactory,\r\n    formTpl,\r\n    popupFormTpl,\r\n    formElement,\r\n    inlineHelper,\r\n    dynamicComponent,\r\n    _,\r\n    __,\r\n    mathJax\r\n){\r\n    'use strict';\r\n\r\n    var MathActive;\r\n\r\n    var _throttle = 300;\r\n\r\n    MathActive = stateFactory.extend(\r\n        Active,\r\n        function create(){\r\n            this.initForm();\r\n\r\n        },\r\n        function destroy(){\r\n            _.invoke(this.popups, 'destroy');\r\n            this.popups = null;\r\n            this.fields.$mathml.qtip('destroy', true);\r\n            this.fields = null;\r\n            this.widget.$form.empty();\r\n        }\r\n    );\r\n\r\n    MathActive.prototype.initForm = function initForm(){\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            math = _widget.element,\r\n            mathML = math.mathML || '',\r\n            tex = math.getAnnotation('latex') || '',\r\n            display = math.attr('display') || 'inline',\r\n            editMode = 'latex',\r\n            $popupsContainer,\r\n            areaBroker = this.widget.getAreaBroker();\r\n\r\n        if(!tex.trim() && mathML.trim()){\r\n            editMode = 'mathml';\r\n        }\r\n\r\n        $form.html(formTpl({\r\n            mathjax : !!mathJax,\r\n            editMode : editMode,\r\n            latex : tex,\r\n            mathml : mathML\r\n        }));\r\n\r\n        if(mathJax){\r\n            // grab a reference to the DOM elements containing the source of truth for latex/mathml codes\r\n            this.fields = {\r\n                $mathml : $form.find('textarea[name=mathml]'),\r\n                $latex : $form.find('input[name=latex]')\r\n            };\r\n            _attachMathmlWarning(this.fields.$mathml);\r\n\r\n            //init select boxes\r\n            $form.find('select[name=editMode]').val(editMode);\r\n            $form.find('select[name=display]').val(display);\r\n\r\n            this._toggleMode(editMode);\r\n\r\n            // Create and render popups\r\n            $popupsContainer = areaBroker.getContainer();\r\n            this.popups = {\r\n                latexWysiwyg: this.createLatexWysiwygPopup(),\r\n                latex: this.createLargeEditorPopup('latex'),\r\n                mathml: this.createLargeEditorPopup('mathml')\r\n            };\r\n\r\n            _.forOwn(this.popups, function(popup) {\r\n                popup\r\n                    .init()\r\n                    .render($popupsContainer)\r\n                    .center()\r\n                    .hide();\r\n            });\r\n\r\n            //... init standard ui widget\r\n            formElement.initWidget($form);\r\n\r\n            this.initFormChangeListener();\r\n        }\r\n    };\r\n\r\n    MathActive.prototype.initFormChangeListener = function initFormChangeListener(){\r\n        var self = this,\r\n            _widget = this.widget,\r\n            $container = _widget.$container,\r\n            $form = _widget.$form,\r\n            math = _widget.element,\r\n            mathML = math.mathML,\r\n            mathEditor,\r\n            tex = math.getAnnotation('latex'),\r\n            display = math.attr('display') || 'inline';\r\n\r\n        mathEditor = new MathEditor({\r\n            tex : tex,\r\n            mathML : mathML,\r\n            display : display,\r\n            buffer : $form.find('.math-buffer'),\r\n            target : _widget.$original\r\n        });\r\n\r\n        //init data change callbacks\r\n        formElement.setChangeCallbacks($form, math, {\r\n            display : function(m, value){\r\n                if(value === 'block'){\r\n                    m.attr('display', 'block');\r\n                }else{\r\n                    m.removeAttr('display');\r\n                }\r\n                _widget.rebuild({\r\n                    ready : function(widget){\r\n                        widget.changeState('active');\r\n                    }\r\n                });\r\n            },\r\n            editMode : function(m, value){\r\n\r\n                self._toggleMode(value);\r\n            },\r\n            latex : _.throttle(function(m, value){\r\n\r\n                mathEditor.setTex(value).renderFromTex(function(){\r\n\r\n                    //saveTex\r\n                    m.setAnnotation('latex', value);\r\n\r\n                    //update mathML\r\n                    if (self.fields) {\r\n                        self.fields.$mathml.val(mathEditor.mathML);\r\n                    }\r\n                    m.setMathML(mathEditor.mathML);\r\n\r\n                    inlineHelper.togglePlaceholder(_widget);\r\n\r\n                    $container.change();\r\n                });\r\n\r\n            }, _throttle),\r\n            mathml : _.throttle(function(m, value){\r\n                // this callback is bound on the keyup event, which alone is not enough to decide if the content has\r\n                // really changed or not, as the user might have only pressed arrow keys.\r\n                // Thus, we do an extra check here to avoid deleting the latex content for nothing\r\n                var hasChanged = value !== mathEditor.mathML;\r\n\r\n                mathEditor.setMathML(value).renderFromMathML(function(){\r\n\r\n                    //save mathML\r\n                    m.setMathML(mathEditor.mathML);\r\n\r\n                    //clear tex if mathml has changed\r\n                    if (hasChanged) {\r\n                        if (self.fields) {\r\n                            self.fields.$latex.val('');\r\n                        }\r\n                        m.removeAnnotation('latex');\r\n                    }\r\n\r\n                    inlineHelper.togglePlaceholder(_widget);\r\n\r\n                    $container.change();\r\n                });\r\n\r\n            }, _throttle)\r\n        });\r\n\r\n        // popup buttons behavior\r\n        $form.find('.popup-btn').on('click', function(e) {\r\n            var $target = $(e.target),\r\n                targetPopup = $target.data('control');\r\n\r\n            if (self.popups[targetPopup]) {\r\n                self.popups[targetPopup].show();\r\n            }\r\n        });\r\n    };\r\n\r\n    MathActive.prototype.createLatexWysiwygPopup = function createLatexWysiwygPopup() {\r\n        var self = this,\r\n            popupOptions = {\r\n                windowTitle: 'LaTeX (WYSIWYG)',\r\n                width: 640,\r\n                height: 280,\r\n                minWidth: 460,\r\n                maxWidth: 960,\r\n                minHeight: 220,\r\n                maxHeight: 640\r\n            };\r\n\r\n        return windowPopupFactory({}, popupOptions)\r\n            .on('render', function() {\r\n                var $popupContent = this.getBody();\r\n\r\n                this.mathInput = mathInputFactory()\r\n                    .init()\r\n                    .render($popupContent)\r\n                    .on('change', function(latex) {\r\n                        self.fields.$latex.val(latex);\r\n                        self.fields.$latex.trigger('keyup');\r\n                    });\r\n            })\r\n            .on('show', function() {\r\n                var currentLatex = self.fields.$latex.val(),\r\n                    mathInput = this.mathInput;\r\n\r\n                // defering fixes a bug in the scaling of some MQ characters (\\sqrt)\r\n                _.defer(function() {\r\n                    mathInput.setLatex(currentLatex);\r\n                });\r\n                self._disableForm();\r\n            })\r\n            .on('hide', function() {\r\n                self._enableForm();\r\n            });\r\n    };\r\n\r\n    MathActive.prototype.createLargeEditorPopup = function createLargeEditorPopup(popupMode) {\r\n        var self = this,\r\n            popupOptions = {\r\n                windowTitle: (popupMode === 'latex') ? 'LaTeX' : 'MathML',\r\n                width: 640,\r\n                height: 320,\r\n                minWidth: 240,\r\n                maxWidth: 960,\r\n                minHeight: 160,\r\n                maxHeight: 640\r\n            },\r\n            smallField = self.fields['$' + popupMode]; // the corresponding \"small\" field in the widget form\r\n\r\n        return windowPopupFactory({}, popupOptions)\r\n            .on('render', function() {\r\n                var $popupContent = this.getBody();\r\n\r\n                this.$popupField = $(popupFormTpl({\r\n                    popupMode: popupMode,\r\n                    placeholder: smallField.attr('placeholder')\r\n                }));\r\n\r\n                $popupContent.append(this.$popupField);\r\n\r\n                this.$popupField\r\n                    .on('mousedown', function(e) {\r\n                        e.stopPropagation();\r\n                    })\r\n                    .on('keyup', function(e) {\r\n                        smallField.val($(e.target).val());\r\n                        smallField.trigger('keyup');\r\n                    });\r\n            })\r\n            .on('show', function() {\r\n                this.$popupField.val((smallField.val()));\r\n                if (popupMode === 'mathml') {\r\n                    self.fields.$mathml.qtip('hide');\r\n                }\r\n                self._disableForm();\r\n            })\r\n            .on('hide', function() {\r\n                self._enableForm();\r\n            });\r\n    };\r\n\r\n    MathActive.prototype._enableForm = function _enableForm(){\r\n        this.widget.$form.find('button,input,select,textarea').prop('disabled', false);\r\n    };\r\n\r\n    MathActive.prototype._disableForm = function _disableForm(){\r\n        this.widget.$form.find('button,input,select,textarea').prop('disabled', true);\r\n    };\r\n\r\n    MathActive.prototype._toggleMode = function _toggleMode(mode){\r\n        var self = this,\r\n            _widget = this.widget,\r\n            $form = _widget.$form,\r\n            panels = {\r\n                $mathml : $form.children('.panel[data-role=\"mathml\"]'),\r\n                $latex : $form.children('.panel[data-role=\"latex\"]')\r\n            };\r\n\r\n        switch (mode) {\r\n            case 'latex': {\r\n                panels.$latex.show();\r\n                panels.$mathml.hide();\r\n                this.fields.$mathml.qtip('hide');\r\n                break;\r\n            }\r\n            case 'mathml': {\r\n                panels.$latex.hide();\r\n                panels.$mathml.show();\r\n                if(this.fields.$latex.val()){\r\n                    this.fields.$mathml.qtip('show');\r\n                    this.fields.$mathml.on('keyup.mathWarning', function() {\r\n                        self.fields.$mathml.qtip('hide');\r\n                        self.fields.$mathml.off('.mathWarning');\r\n                    });\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    function _attachMathmlWarning($mathField){\r\n        var $tooltipContent = $('<span>', {\r\n            html: __('Currently conversion from MathML to LaTeX is not available. Editing MathML here will have the LaTex code discarded.')\r\n        });\r\n\r\n        if(!$mathField.data('qtip')){\r\n            $mathField.qtip({\r\n                theme : 'error',\r\n                show: {\r\n                    event : 'custom'\r\n                },\r\n                hide: {\r\n                    event : 'custom'\r\n                },\r\n                content: {\r\n                    text: $tooltipContent\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    return MathActive;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/math/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/math/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/math/states/Active'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/math/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/math/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/media',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/inline'\r\n], function(Widget, states, helper, toolbarTpl, inlineHelper) {\r\n\r\n    var MathWidget = Widget.clone();\r\n\r\n    MathWidget.initCreator = function() {\r\n        \r\n        this.registerStates(states);\r\n        \r\n        Widget.initCreator.call(this);\r\n        \r\n        inlineHelper.togglePlaceholder(this);\r\n    };\r\n    \r\n    MathWidget.buildContainer = function(){\r\n        \r\n        if(this.element.attr('display') === 'block'){\r\n            helper.buildBlockContainer(this);\r\n        }else{\r\n            helper.buildInlineContainer(this);\r\n        }\r\n        \r\n        return this;\r\n    };\r\n    \r\n    MathWidget.createToolbar = function() {\r\n        \r\n         helper.createToolbar(this, toolbarTpl);\r\n\r\n        return this;\r\n    };\r\n\r\n    return MathWidget;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/Math',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Math',\r\n    'taoQtiItem/qtiCreator/widgets/static/math/Widget',\r\n    'taoQtiItem/qtiItem/core/Element'\r\n], function(_, Renderer, Widget, Element){\r\n    'use strict';\r\n\r\n    var CreatorMath = _.clone(Renderer);\r\n\r\n    /**\r\n     * This could serve as a basis for a helper if generic support is needed for non-editable element rendering\r\n     * Here, we simply check that the math element is not nested inside a hottext element\r\n     * @param {Element} element\r\n     * @returns {boolean}\r\n     */\r\n    function isEditable(element) {\r\n        var parent = element.parent();\r\n        return ! Element.isA(parent, 'hottext');\r\n    }\r\n\r\n    CreatorMath.render = function(math, options){\r\n\r\n        //initial rendering:\r\n        if (isEditable(math)) {\r\n            Renderer.render(math);\r\n\r\n            Widget.build(\r\n                math,\r\n                Renderer.getContainer(math),\r\n                this.getOption('bodyElementOptionForm'),\r\n                options\r\n            );\r\n        }\r\n\r\n    };\r\n\r\n    return CreatorMath;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/modalFeedback', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"modal \";\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"<h2 class=\\\"qti-title modal-title\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.title)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</h2>\";\n  return buffer;\n  }\n\n  buffer += \"<div id=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" class=\\\"\";\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.inline), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"qti-modalFeedback \";\n  if (helper = helpers.feedbackStyle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.feedbackStyle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.title), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <div class=\\\"modal-body\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA\r\n **/\r\ndefine('taoQtiItem/qtiItem/helper/container',['lodash', 'jquery'], function (_, $){\r\n    'use strict';\r\n    \r\n    /**\r\n     * Prefix used to the variable storage\r\n     * @type String\r\n     */\r\n    var _prefix = 'x-tao-';\r\n    \r\n    /**\r\n     * Check if the element is of a qti container type\r\n     * \r\n     * @private\r\n     * @param {Object} element\r\n     * @returns {Boolean}\r\n     */\r\n    function _checkContainerType(element){\r\n        if(_.isFunction(element.initContainer) && _.isFunction(element.body)){\r\n            return true;\r\n        }else{\r\n            throw 'the element is not of a container type';\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Get the body element of the container\r\n     * \r\n     * @private\r\n     * @param {Object} element\r\n     * @returns {JQuery}\r\n     */\r\n    function _getBodyDom(element){\r\n        if(_checkContainerType(element)){\r\n            return $('<div>').html(element.body()).find('.x-tao-wrapper');\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Add a class to the body element of the qti container\r\n     * \r\n     * @private\r\n     * @param {Object} element\r\n     * @param {String} newClass\r\n     * @param {String} [oldClass]\r\n     */\r\n    function _setBodyDomClass(element, newClass, oldClass){\r\n\r\n        if(_checkContainerType(element) && (oldClass || newClass)){\r\n            var $wrapper = $('<div>').html(element.body());\r\n            //set css class to element\r\n            _setDomClass($wrapper, newClass, oldClass);\r\n            //set to the model\r\n            element.body($wrapper.html());\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Switch class to the wrapped DOM\r\n     * \r\n     * @param {JQuery} $wrapper\r\n     * @param {String} newClass\r\n     * @param {String} oldClass\r\n     * @returns {undefined}\r\n     */\r\n    function _setDomClass($wrapper, newClass, oldClass){\r\n        var $bodyDom = $wrapper.find('.x-tao-wrapper');\r\n        if(!$bodyDom.length){\r\n            //create one\r\n            $wrapper.wrapInner('<div class=\"x-tao-wrapper\">');\r\n            $bodyDom = $wrapper.find('.x-tao-wrapper');\r\n        }\r\n        if(oldClass){\r\n            $bodyDom.removeClass(oldClass);\r\n        }\r\n        if(newClass){\r\n            $bodyDom.addClass(newClass);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Add manually the encoded information to a dom element\r\n     * \r\n     * @param {JQuery} $wrapper - the wrapper of the element that will holds the information\r\n     * @param {String} dataName - the name of the information\r\n     * @param {String} newValue - the new value to be added\r\n     * @param {String} [oldValue] - the old value to be removed\r\n     * @returns {undefined}\r\n     */\r\n    function setEncodedDataToDom($wrapper, dataName, newValue, oldValue){\r\n        _setDomClass($wrapper, _getEncodedDataString(dataName, newValue), _getEncodedDataString(dataName, oldValue));\r\n    }\r\n    \r\n    /**\r\n     * Get the full variable name for the data store\r\n     * \r\n     * @param {String} dataName\r\n     * @param {String} value\r\n     * @returns {String}\r\n     */\r\n    function _getEncodedDataString(dataName, value){\r\n        if(dataName && value){\r\n            return _prefix + dataName + '-' + value;\r\n        }\r\n        return '';\r\n    }\r\n    \r\n    /**\r\n     * Set a data string to the element identified by its dataName\r\n     * \r\n     * @param {Object} element\r\n     * @param {String} dataName\r\n     * @param {String} newValue\r\n     * @returns {undefined}\r\n     */\r\n    function setEncodedData(element, dataName, newValue){\r\n        var oldValue = getEncodedData(element, dataName);\r\n        return _setBodyDomClass(element, _getEncodedDataString(dataName, newValue), _getEncodedDataString(dataName, oldValue));\r\n    }\r\n    \r\n    /**\r\n     * Remove the stored data from the element by its dataName\r\n     * \r\n     * @param {Object} element\r\n     * @param {String} dataName\r\n     * @returns {unresolved}\r\n     */\r\n    function removeEncodedData(element, dataName){\r\n        var oldValue = getEncodedData(element, dataName);\r\n        if(dataName && oldValue){\r\n            _setBodyDomClass(element, '', _getEncodedDataString(dataName, oldValue));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if the stored data exist\r\n     * \r\n     * @param {Object} element\r\n     * @param {String} dataName\r\n     * @param {String} value\r\n     * @returns {Boolean}\r\n     */\r\n    function hasEncodedData(element, dataName, value){\r\n        var $body = _getBodyDom(element);\r\n        if($body && $body.length && dataName && value){\r\n            return $body.hasClass(_getEncodedDataString(dataName, value));\r\n        }\r\n        return false;\r\n    }\r\n    \r\n    /**\r\n     * Get the encoded data identified by its dataName\r\n     * \r\n     * @param {Object} element\r\n     * @param {String} dataName\r\n     * @returns {String}\r\n     */\r\n    function getEncodedData(element, dataName){\r\n        var regex, matches;\r\n        var $body = _getBodyDom(element);\r\n        if(dataName && $body && $body.length && $body.attr('class')){\r\n            regex = new RegExp(_prefix + dataName + '-([a-zA-Z0-9\\-._]*)');\r\n            matches = $body.attr('class').match(regex);\r\n            if(matches){\r\n                return matches[1];\r\n            }\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Provide a set of helper functions to set,retirve and manage string data to a container type qti element.\r\n     */\r\n    return {\r\n        setEncodedData : setEncodedData,\r\n        hasEncodedData : hasEncodedData,\r\n        getEncodedData : getEncodedData,\r\n        removeEncodedData : removeEncodedData,\r\n        setEncodedDataToDom : setEncodedDataToDom\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA (under the project TAO-PRODUCT);\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback',[\r\n    'lodash',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/modalFeedback',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiItem/helper/container',\r\n    'ui/waitForMedia',\r\n    'ui/modal'\r\n], function(_, tpl, containerHelper, coreContainerHelper){\r\n    'use strict';\r\n\r\n    var modalFeedbackRenderer = {\r\n        qtiClass : 'modalFeedback',\r\n        template : tpl,\r\n        getContainer : containerHelper.get,\r\n        minHeight : 200,\r\n        width : 600,\r\n        getData : function(fb, data){\r\n            var feedbackStyle = coreContainerHelper.getEncodedData(fb, 'modalFeedback');\r\n            data.feedbackStyle = feedbackStyle;\r\n            return data;\r\n        },\r\n        render : function(modalFeedback, data){\r\n\r\n            data = data || {};\r\n            \r\n            var $modal = containerHelper.get(modalFeedback);\r\n            \r\n            $modal.waitForMedia(function(){\r\n\r\n                //when we are sure that media is loaded:\r\n                $modal.on('opened.modal', function(){\r\n\r\n                    //set item body height\r\n                    var $itemBody = containerHelper.get(modalFeedback.getRelatedItem()).children('.qti-itemBody');\r\n                    var requiredHeight = $modal.outerHeight() + parseInt($modal.css('top'));\r\n                    if(requiredHeight > $itemBody.height()){\r\n                        $itemBody.height(requiredHeight);\r\n                    }\r\n\r\n                }).on('closed.modal', function(){\r\n                    if(_.isFunction(data.callback)){\r\n                        data.callback.call(this);\r\n                    }\r\n                }).modal({\r\n                    startClosed : false,\r\n                    minHeight : modalFeedbackRenderer.minHeight,\r\n                    width : modalFeedbackRenderer.width\r\n                });\r\n            });\r\n\r\n        }\r\n    };\r\n\r\n    return modalFeedbackRenderer;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/modalFeedback/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/states/Sleep'], function(stateFactory, SleepState){\r\n    \r\n    return stateFactory.create(SleepState, function(){}, function(){});\r\n    \r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/modalFeedback', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n    \t\t<option value=\\\"\";\n  if (helper = helpers.cssClass) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.cssClass); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.selected), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.title) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.title); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</option>\\r\\n    \t\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  \n  return \"selected=\\\"selected\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <label for=\\\"\\\" class=\\\"has-icon\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Identifier\", options) : helperMissing.call(depth0, \"__\", \"Identifier\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The identifier of the modal feedback. This identifier must not be used by any other modal feedback or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options) : helperMissing.call(depth0, \"__\", \"The identifier of the modal feedback. This identifier must not be used by any other modal feedback or item variable. An identifier is a string of characters that must start with a Letter or an underscore (\\\"_\\\") and contain only Letters, underscores, hyphens (\\\"-\\\"), period (\\\".\\\", a.k.a. full-stop), Digits, CombiningChars and Extenders.\", options)))\n    + \"</div>\\r\\n    <input type=\\\"text\\\" \\r\\n           name=\\\"identifier\\\" \\r\\n           value=\\\"\";\n  if (helper = helpers.identifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.identifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" \\r\\n           placeholder=\\\"e.g. modal-feedback_1\\\" \\r\\n           data-validate=\\\"$notEmpty; $qtiIdentifier; $availableIdentifier(serial=\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \");\\\">\\r\\n</div>\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"feedbackStyle\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Feedback Style\", options) : helperMissing.call(depth0, \"__\", \"Feedback Style\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select predefined feedback style from the list.\", options) : helperMissing.call(depth0, \"__\", \"Select predefined feedback style from the list.\", options)))\n    + \"</span>\\r\\n    <select name=\\\"feedbackStyle\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n    \t\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.feedbackStyles), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </select>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/static/modalFeedback/states/Active',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/modalFeedback',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiItem/helper/container',\r\n    'lodash',\r\n    'i18n',\r\n    'jquery',\r\n    'ui/modal'\r\n], function(stateFactory, Active, commonRenderer, formTpl, formElement, containerHelper, _, __, $){\r\n\r\n    /**\r\n     * handle z-indices of sidebar and ckeditor\r\n     */\r\n    var indices = (function(){\r\n\r\n        var selectors = {\r\n            sidebar : '#item-editor-item-widget-bar',\r\n            cke : '.cke',\r\n            ckeBase : '.cke_inner',\r\n            ckeNose : '.cke_nose',\r\n            ckeToolbar : '.cke_toolbar'\r\n        };\r\n\r\n        var raised = false,\r\n            selector,\r\n            elements = {};\r\n\r\n        return {\r\n            raise : function(baseIndex){\r\n\r\n                var $elem, index;\r\n\r\n                baseIndex = parseInt(baseIndex, 10);\r\n\r\n                for(selector in selectors){\r\n\r\n                    $elem = $(selectors[selector]);\r\n\r\n                    index = parseInt($elem.css('z-index'), 10);\r\n                    if(isNaN(index)){\r\n                        index = 100;\r\n                    }\r\n\r\n                    elements[selector] = {\r\n                        element : $elem,\r\n                        index : index\r\n                    };\r\n\r\n                    $elem.css('z-index', elements[selector].index + baseIndex);\r\n                }\r\n            },\r\n            reset : function(){\r\n                if(!raised){\r\n                    return;\r\n                }\r\n                for(selector in elements){\r\n                    elements[selector].element.css('z-index', elements[selector].index);\r\n                }\r\n            }\r\n        };\r\n    }());\r\n\r\n    var _ckeIsReady = function($editable){\r\n\r\n        var dfd = new $.Deferred(),\r\n            iteration = 0;\r\n\r\n        var poll = function(){\r\n\r\n            var editor = $editable.data('editor');\r\n\r\n            if(iteration > 20){\r\n                return;\r\n            }\r\n\r\n            if(editor){\r\n                dfd.resolve();\r\n            }else{\r\n                setTimeout(poll, 200);\r\n            }\r\n\r\n        };\r\n        poll();\r\n\r\n        return dfd.promise();\r\n    };\r\n\r\n    var ModalFeedbackStateActive = stateFactory.extend(Active, function(){\r\n\r\n        var _widget = this.widget,\r\n            $container = this.widget.$container,\r\n            $editable = $container.find('[data-html-editable]');\r\n\r\n        $container.modal({\r\n            startClosed : true,\r\n            width : commonRenderer.width\r\n        });\r\n        $container.modal('open');\r\n        $container.css('height', 'auto');\r\n\r\n        $.when(_ckeIsReady($editable)).then(function(){\r\n            indices.raise($container.css('z-index'));\r\n        });\r\n\r\n        $container.on('closed.modal', function(){\r\n            _widget.changeState('sleep');\r\n        });\r\n\r\n        this.widget.offEvents('otherActive');\r\n\r\n        //show option form\r\n        this.initForm();\r\n        this.widget.$form.show();\r\n\r\n    }, function(){\r\n\r\n        var $container = this.widget.$container;\r\n\r\n        $container.off('opened.modal').off('.active');\r\n        $container.modal('close');\r\n\r\n        // reset ck and sidebar\r\n        indices.reset();\r\n\r\n        //close ck tlb\r\n        $container.find('.tlb-button.active[data-role=cke-launcher]').click();\r\n\r\n        //destroy and hide it\r\n        this.widget.$form.empty().hide();\r\n    });\r\n\r\n    ModalFeedbackStateActive.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget;\r\n        var $container = _widget.$container;\r\n        var feedbackStyles = _prepareFeedbackStyles(_widget);\r\n            \r\n        //build form:\r\n        _widget.$form.html(formTpl({\r\n            serial : _widget.element.getSerial(),\r\n            identifier : _widget.element.id(),\r\n            feedbackStyles : feedbackStyles\r\n        }));\r\n\r\n        formElement.initWidget(_widget.$form);\r\n\r\n        //init data validation and binding\r\n        formElement.setChangeCallbacks(_widget.$form, _widget.element, {\r\n            identifier : function(fb, value){\r\n                fb.id(value);\r\n            },\r\n            feedbackStyle : function(fb, newValue){\r\n                \r\n                var oldValue = containerHelper.getEncodedData(_widget.element, 'modalFeedback');\r\n                containerHelper.setEncodedData(fb, 'modalFeedback', newValue);\r\n                \r\n                //update the feedback rendering\r\n                if(oldValue){\r\n                    $container.removeClass(oldValue);\r\n                }\r\n                $container.addClass(newValue);\r\n                \r\n                //need to set the encoded data immediately to the rendered dom because changed body data will be based on it\r\n                containerHelper.setEncodedDataToDom($container.find('.cke_editable'), 'modalFeedback', newValue, oldValue);\r\n            }\r\n        });\r\n    };\r\n    \r\n    /**\r\n     * Get the feedback styles related data for the template rendering\r\n     * \r\n     * @param {Object} widget - the creator widget\r\n     * @returns {Array}\r\n     */\r\n    function _prepareFeedbackStyles(widget){\r\n        \r\n        var styles = [\r\n            {\r\n                cssClass : '',\r\n                title : __('standard')\r\n            },\r\n            {\r\n                cssClass : 'positive',\r\n                title : __('positive')\r\n            },\r\n            {\r\n                cssClass : 'negative',\r\n                title : __('negative')\r\n            }\r\n        ];\r\n        \r\n        return _(styles)\r\n            .filter(function(style){\r\n                return style.cssClass !== undefined;\r\n            }).map(function(style){\r\n            if(containerHelper.hasEncodedData(widget.element, 'modalFeedback', style.cssClass)){\r\n                style.selected = true;\r\n            }\r\n            return style;\r\n        }).value();\r\n    }\r\n\r\n    return ModalFeedbackStateActive;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/modalFeedback/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/modalFeedback/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/modalFeedback/states/Active'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/modalFeedback/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/modalFeedback/states/states',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/htmlEditorTrigger',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/okButton',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content'\r\n], function($, Widget, states, toolbarTpl, okButtonTpl, formElement, htmlEditor, contentHelper){\r\n\r\n    var ModalFeedbackWidget = Widget.clone();\r\n\r\n    ModalFeedbackWidget.initCreator = function(){\r\n\r\n        Widget.initCreator.call(this);\r\n\r\n        this.registerStates(states);\r\n\r\n        this.buildEditor();\r\n\r\n        this.createOkButton();\r\n    };\r\n\r\n    ModalFeedbackWidget.buildContainer = function(){\r\n\r\n        this.$container = this.$original.addClass('widget-box');\r\n    };\r\n\r\n    ModalFeedbackWidget.createToolbar = function(){\r\n\r\n        this.$container.find('.modal-body').append(toolbarTpl({\r\n            serial : this.serial,\r\n            state : 'active'\r\n        }));\r\n\r\n        return this;\r\n    };\r\n\r\n    ModalFeedbackWidget.buildEditor = function(){\r\n\r\n        var _this = this,\r\n            $editableContainer = _this.$container.find('.modal-body'),\r\n            element = _this.element,\r\n            container = element.getBody();\r\n\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                change : contentHelper.getChangeCallback(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _this\r\n                }\r\n            });\r\n        }\r\n\r\n        formElement.initTitle(this.$original.find('.qti-title'), element);\r\n    };\r\n\r\n    ModalFeedbackWidget.createOkButton = function(){\r\n\r\n        var _this = this;\r\n\r\n        this.$container\r\n            .append($(okButtonTpl())\r\n            .on('click.qti-widget', function(e){\r\n                e.stopPropagation();\r\n                _this.changeState('sleep');\r\n            }));\r\n    };\r\n\r\n    return ModalFeedbackWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/modalFeedback/modal', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"modal \";\n  }\n\n  buffer += \"<div id=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.identifier)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" class=\\\"\";\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.inline), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"qti-modalFeedback \";\n  if (helper = helpers.feedbackStyle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.feedbackStyle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <h2 class=\\\"qti-title modal-title\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.title)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</h2>\\r\\n    <div class=\\\"modal-body\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/ModalFeedback',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/ModalFeedback',\r\n    'taoQtiItem/qtiCreator/widgets/static/modalFeedback/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/modalFeedback/modal'\r\n], function(_, Renderer, Widget, modalTpl){\r\n    'use strict';\r\n\r\n    var ModalFeedback = _.clone(Renderer);\r\n    \r\n    ModalFeedback.template = modalTpl;\r\n    ModalFeedback.render = function(modalFeedback, options){\r\n\r\n        options = options || {};\r\n\r\n        //make content editable\r\n        Widget.build(\r\n            modalFeedback,\r\n            Renderer.getContainer(modalFeedback),\r\n            this.getOption('modalFeedbackOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return ModalFeedback;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/object', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"qti-object-container\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" >\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA\r\n */\r\n\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Object',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/object',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'ui/previewer'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'object',\r\n        template : tpl,\r\n        getContainer : containerHelper.get,\r\n        render : function(obj){\r\n            var $container = containerHelper.get(obj);\r\n            var previewOptions = {\r\n                url : obj.renderer.resolveUrl(obj.attr('data')),\r\n                mime : obj.attr('type')\r\n            };\r\n            if(obj.attr('height')){\r\n                previewOptions.height = obj.attr('height');\r\n            }\r\n            if(obj.attr('width')){\r\n                previewOptions.width = obj.attr('width');\r\n            }\r\n            if(previewOptions.url && previewOptions.mime){\r\n                $container.previewer(previewOptions);\r\n            }\r\n        }\r\n    };\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/object/states/Sleep',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Sleep'\r\n], function(stateFactory, SleepState){\r\n    'use strict';\r\n\r\n    var ObjectStateSleep = stateFactory.create(SleepState, function(){\r\n        \r\n    }, function(){\r\n        \r\n    });\r\n    \r\n    return ObjectStateSleep;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/object', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n    <div>\\r\\n        <label for=\\\"src\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"File\", options) : helperMissing.call(depth0, \"__\", \"File\", options)))\n    + \"</label>\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The file path to the object.\", options) : helperMissing.call(depth0, \"__\", \"The file path to the object.\", options)))\n    + \"</div>\\r\\n        <input type=\\\"text\\\" name=\\\"src\\\" value=\\\"\";\n  if (helper = helpers.src) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.src); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty; $fileExists(baseUrl=\";\n  if (helper = helpers.baseUrl) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseUrl); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \")\\\"/>\\r\\n        <button class=\\\"btn-info small block\\\" data-role=\\\"upload-trigger\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select object\", options) : helperMissing.call(depth0, \"__\", \"Select object\", options)))\n    + \"</button>\\r\\n    </div>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <div>\\r\\n        <label for=\\\"width\\\" class=\\\"spinner\\\">Width</label>\\r\\n        <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" class=\\\"large\\\" data-increment=\\\"10\\\" data-min=\\\"10\\\"\\r\\n               data-max=\\\"1920\\\"/>\\r\\n    </div>\\r\\n    <div>\\r\\n        <label for=\\\"height\\\" class=\\\"spinner\\\">Height</label>\\r\\n        <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" class=\\\"large\\\" data-increment=\\\"10\\\" data-min=\\\"10\\\"\\r\\n               data-max=\\\"1080\\\"/>\\r\\n    </div>\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/object/states/Active',[\r\n    'lodash',\r\n    'jquery',\r\n    'i18n',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/object',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/inline',\r\n    'ui/previewer',\r\n    'ui/resourcemgr',\r\n    'ui/tooltip'\r\n], function(_, $, __, stateFactory, Active, formTpl, formElement, inlineHelper){\r\n    'use strict';\r\n\r\n    var _config = {\r\n        renderingThrottle : 1000,\r\n        fileFilters : 'image/jpeg,image/png,image/gif,image/svg+xml,video/mp4,video/avi,video/ogv,video/mpeg,video/ogg,video/quicktime,video/webm,video/x-ms-wmv,video/x-flv,audio/mp3,audio/vnd.wav,audio/ogg,audio/vorbis,audio/webm,audio/mpeg,application/ogg,audio/aac,application/pdf'\r\n    };\r\n\r\n    var ObjectStateActive = stateFactory.extend(Active, function(){\r\n        this.initForm();\r\n    }, function(){\r\n        this.widget.$form.empty();\r\n    });\r\n\r\n    var refreshRendering = _.throttle(function refreshRendering(widget){\r\n        var obj = widget.element;\r\n        var $container = widget.$original;\r\n        var previewOptions = {\r\n            url : obj.renderer.resolveUrl(obj.attr('data')),\r\n            mime : obj.attr('type')\r\n        };\r\n        if(obj.attr('height')){\r\n            previewOptions.height = obj.attr('height');\r\n        }\r\n        if(obj.attr('width')){\r\n            previewOptions.width = obj.attr('width');\r\n        }\r\n        if(previewOptions.url && previewOptions.mime){\r\n            $container.previewer(previewOptions);\r\n        }\r\n    }, _config.renderingThrottle);\r\n\r\n    ObjectStateActive.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            qtiObject = _widget.element,\r\n            baseUrl = _widget.options.baseUrl;\r\n\r\n        $form.html(formTpl({\r\n            baseUrl : baseUrl || '',\r\n            src : qtiObject.attr('data'),\r\n            alt : qtiObject.attr('alt'),\r\n            height : qtiObject.attr('height'),\r\n            width : qtiObject.attr('width')\r\n        }));\r\n\r\n        //init resource manager\r\n        _initUpload(_widget);\r\n\r\n        //init standard ui widget\r\n        formElement.initWidget($form);\r\n\r\n        //init data change callbacks\r\n        formElement.setChangeCallbacks($form, qtiObject, {\r\n            src : function(object, value){\r\n                qtiObject.attr('data', value);\r\n                inlineHelper.togglePlaceholder(_widget);\r\n                refreshRendering(_widget);\r\n            },\r\n            width : function(object, value){\r\n                var val = parseInt(value, 10);\r\n                if(_.isNaN(val)){\r\n                    qtiObject.removeAttr('width');\r\n                }else{\r\n                    qtiObject.attr('width', val);\r\n                }\r\n                refreshRendering(_widget);\r\n            },\r\n            height : function(object, value){\r\n                var val = parseInt(value, 10);\r\n                if(_.isNaN(val)){\r\n                    qtiObject.removeAttr('height');\r\n                }else{\r\n                    qtiObject.attr('height', val);\r\n                }\r\n                refreshRendering(_widget);\r\n            },\r\n            alt : function(qtiObject, value){\r\n                qtiObject.attr('alt', value);\r\n            },\r\n            align : function(qtiObject, value){\r\n                inlineHelper.positionFloat(_widget, value);\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n    var _initUpload = function(widget){\r\n\r\n        var $form = widget.$form,\r\n            options = widget.options,\r\n            qtiObject = widget.element,\r\n            $uploadTrigger = $form.find('[data-role=\"upload-trigger\"]'),\r\n            $src = $form.find('input[name=src]');\r\n\r\n        var _openResourceMgr = function _openResourceMgr(){\r\n            $uploadTrigger.resourcemgr({\r\n                title : __('Please select a media file from the resource manager. You can add files from your computer with the button \"Add file(s)\".'),\r\n                appendContainer : options.mediaManager.appendContainer,\r\n                mediaSourcesUrl : options.mediaManager.mediaSourcesUrl,\r\n                browseUrl : options.mediaManager.browseUrl,\r\n                uploadUrl : options.mediaManager.uploadUrl,\r\n                deleteUrl : options.mediaManager.deleteUrl,\r\n                downloadUrl : options.mediaManager.downloadUrl,\r\n                fileExistsUrl : options.mediaManager.fileExistsUrl,\r\n                params : {\r\n                    uri : options.uri,\r\n                    lang : options.lang,\r\n                    filters : _config.fileFilters\r\n                },\r\n                pathParam : 'path',\r\n                select : function(e, files){\r\n                    var file, type;\r\n                    if(files && files.length){\r\n                        file = files[0].file;\r\n                        type = files[0].mime;\r\n                        qtiObject.attr('type', type);\r\n                        $src.val(file).trigger('change');\r\n                    }\r\n                },\r\n                open : function(){\r\n                    //hide tooltip if displayed\r\n                    if($src.data('qtip')){\r\n                        $src.blur().qtip('hide');\r\n                    }\r\n                },\r\n                close : function(){\r\n                    //triggers validation :\r\n                    $src.blur();\r\n                }\r\n            });\r\n        };\r\n\r\n        $uploadTrigger.on('click', _openResourceMgr);\r\n\r\n        //if empty, open file manager immediately\r\n        if(!$src.val()){\r\n            _openResourceMgr();\r\n        }\r\n    };\r\n\r\n    return ObjectStateActive;\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/object/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/object/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/object/states/Active'\r\n], function(factory, states){\r\n    'use strict';\r\n\r\n    return factory.createBundle(states, arguments);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/object/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/object/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/media',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/inline',\r\n    'i18n'\r\n], function(Widget, states, helper, toolbarTpl, inlineHelper, __) {\r\n    'use strict';\r\n\r\n    var ObjectWidget = Widget.clone();\r\n\r\n    ObjectWidget.initCreator = function() {\r\n        \r\n        this.registerStates(states);\r\n        \r\n        Widget.initCreator.call(this);\r\n        \r\n        inlineHelper.togglePlaceholder(this);\r\n    };\r\n    \r\n    ObjectWidget.getRequiredOptions = function(){\r\n        return ['baseUrl', 'uri', 'lang', 'mediaManager'];\r\n    };\r\n    \r\n    ObjectWidget.buildContainer = function(){\r\n        \r\n        helper.buildBlockContainer(this);\r\n        \r\n        return this;\r\n    };\r\n    \r\n    ObjectWidget.createToolbar = function() {\r\n        \r\n         helper.createToolbar(this, toolbarTpl);\r\n\r\n        return this;\r\n    };\r\n    \r\n    return ObjectWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/Object',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Object',\r\n    'taoQtiItem/qtiCreator/widgets/static/object/Widget'\r\n], function(_, Renderer, Widget){\r\n    'use strict';\r\n\r\n    var CreatorObject = _.clone(Renderer);\r\n\r\n    CreatorObject.render = function(object, options){\r\n\r\n        //initial rendering:\r\n        Renderer.render(object);\r\n\r\n        options = options || {};\r\n        options.baseUrl = this.getOption('baseUrl');\r\n        options.uri = this.getOption('uri');\r\n        options.lang = this.getOption('lang');\r\n        options.mediaManager = this.getOption('mediaManager');\r\n        options.assetManager = this.getAssetManager();\r\n\r\n        Widget.build(\r\n            object,\r\n            Renderer.getContainer(object),\r\n            this.getOption('bodyElementOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorObject;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/infoControl', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"qti-infoControl\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1['class']), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    \";\n  if (helper = helpers.markup) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.markup); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</div>\";\n  return buffer;\n  });\n});\n\n","define('qtiInfoControlContext',[],function(){\r\n\r\n    //need a global reference to have picHooks shared in two different requirejs context (\"default\" and \"portableCustomInteraction\")\r\n    window._picHooks = window._picHooks || {};\r\n\r\n    /**\r\n     * Global object accessible by all PICs\r\n     *\r\n     * @type Object\r\n     */\r\n    var taoQtiInfoControlContext = {\r\n        /**\r\n         * register a info control (its runtime model) in global registery\r\n         * register a renderer\r\n         *\r\n         * @param {Object} picHook\r\n         * @returns {undefined}\r\n         */\r\n        register : function(picHook){\r\n            //@todo check picHook validity\r\n            window._picHooks[picHook.getTypeIdentifier()] = picHook;\r\n        },\r\n        /**\r\n         * notify when a info control is ready for test taker interaction\r\n         *\r\n         * @param {string} picInstance\r\n         * @fires custominteractionready\r\n         */\r\n        notifyReady : function(picInstance){\r\n            //@todo add pciInstance as event data and notify event to delivery engine\r\n        },\r\n        /**\r\n         * Get a cloned object representing the PIC model\r\n         *\r\n         * @param {string} typeIdentifier\r\n         * @returns {Object} clonedPciModel\r\n         */\r\n        createPciInstance : function(typeIdentifier){\r\n\r\n            if(window._picHooks[typeIdentifier]){\r\n\r\n                var instance = {},\r\n                    proto = window._picHooks[typeIdentifier];\r\n\r\n                for(var name in proto){\r\n                    if(typeof proto[name] === 'function'){\r\n                        //@todo : delegate function call for better performance ?\r\n                        instance[name] = proto[name];\r\n                    }else if(proto[name] !== null && typeof proto[name] === 'object'){\r\n                        //a plain object:\r\n                        instance[name] = proto[name].constructor();\r\n                    }else{\r\n                        //not an object (nor a function) : e.g. 0, 123, '123', null, undefined\r\n                        instance[name] = proto[name];\r\n                    }\r\n                }\r\n\r\n                return instance;\r\n\r\n            }else{\r\n                throw 'no portable info control hook found with the id ' + typeIdentifier;\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    return taoQtiInfoControlContext;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\n\r\n/**\r\n * Portable Info Control Common Renderer\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/PortableInfoControl',[\r\n    'lodash',\r\n    'core/promise',\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/infoControl',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/PortableElement',\r\n    'qtiInfoControlContext',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/portableElementRegistry/icRegistry'\r\n], function(_, Promise, tpl, containerHelper, PortableElement, qtiInfoControlContext, util, icRegistry){\r\n    'use strict';\r\n\r\n    /**\r\n     * Get the PIC instance associated to the infoControl object\r\n     * If none exists, create a new one based on the PIC typeIdentifier\r\n     *\r\n     * @param {Object} infoControl - the js object representing the infoControl\r\n     * @returns {Object} PIC instance\r\n     */\r\n    var _getPic = function(infoControl){\r\n\r\n        var typeIdentifier,\r\n            pic = infoControl.data('pic') || undefined;\r\n\r\n        if(!pic){\r\n\r\n            typeIdentifier = infoControl.typeIdentifier;\r\n            pic = qtiInfoControlContext.createPciInstance(typeIdentifier);\r\n\r\n            if(pic){\r\n\r\n                //binds the PIC instance to TAO infoControl object and vice versa\r\n                infoControl.data('pic', pic);\r\n                pic._taoInfoControl = infoControl;\r\n\r\n            }else{\r\n                throw 'no custom infoControl hook found for the type ' + typeIdentifier;\r\n            }\r\n        }\r\n\r\n        return pic;\r\n    };\r\n\r\n    /**\r\n     * Execute javascript codes to bring the infoControl to life.\r\n     * At this point, the html markup must already be ready in the document.\r\n     *\r\n     * It is done in 5 steps :\r\n     * 1. ensure the context is configured correctly\r\n     * 2. require all required libs\r\n     * 3. create a pic instance based on the infoControl model\r\n     * 4. initialize the rendering\r\n     * 5. restore full state if applicable\r\n     *\r\n     * @param {Object} infoControl\r\n     * @param {Object} [options]\r\n     */\r\n    var render = function(infoControl, options){\r\n        var self = this;\r\n        options = options || {};\r\n        return new Promise(function(resolve, reject){\r\n            var state              = {}; //@todo pass state and response to renderer here:\r\n            var id                 = infoControl.attr('id');\r\n            var typeIdentifier     = infoControl.typeIdentifier;\r\n            var config             = infoControl.properties;\r\n            var $dom               = containerHelper.get(infoControl).children();\r\n            var assetManager       = self.getAssetManager();\r\n\r\n            icRegistry.loadRuntimes().then(function(){\r\n\r\n                var requireEntries = [];\r\n                var runtime = icRegistry.getRuntime(typeIdentifier);\r\n\r\n                if(!runtime || !runtime.hook){\r\n                    return reject('The runtime for the pic cannot be found : ' + typeIdentifier);\r\n                }\r\n\r\n                //load the entrypoint\r\n                requireEntries = [runtime.hook.replace(/\\.js$/, '')];\r\n\r\n                //load stylesheets\r\n                _.each(runtime.stylesheets, function(stylesheet){\r\n                    requireEntries.push('css!'+stylesheet.replace(/\\.css$/, ''));\r\n                });\r\n\r\n                //load the entrypoint\r\n                require(requireEntries, function(){\r\n\r\n                    var pic = _getPic(infoControl);\r\n                    var picAssetManager = {\r\n                        resolve : function resolve(url){\r\n                            var resolved = assetManager.resolveBy('portableElementLocation', url);\r\n                            if(resolved === url){\r\n                                return assetManager.resolveBy('baseUrl', url);\r\n                            }else{\r\n                                return resolved;\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                    if(pic){\r\n                        //call pic initialize() to render the pic\r\n                        pic.initialize(id, $dom[0], config, picAssetManager);\r\n                        //restore context (state + response)\r\n                        pic.setSerializedState(state);\r\n\r\n                        return resolve();\r\n                    }\r\n\r\n                    return reject('Unable to initialize pic : ' + id);\r\n\r\n                }, reject);\r\n\r\n            }).catch(function(error){\r\n                reject('Error loading runtime : ' + id);\r\n            });\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Reverse operation performed by render()\r\n     * After this function is executed, only the inital naked markup remains\r\n     * Event listeners are removed and the state and the response are reset\r\n     *\r\n     * @param {Object} infoControl\r\n     */\r\n    var destroy = function destroy(infoControl){\r\n        _getPic(infoControl).destroy();\r\n    };\r\n\r\n    /**\r\n     * Restore the state of the infoControl from the serializedState.\r\n     *\r\n     * @param {Object} infoControl - the element instance\r\n     * @param {Object} state - the state to set\r\n     */\r\n    var setState = function setState(infoControl, state){\r\n        _getPic(infoControl).setSerializedState(state);\r\n    };\r\n\r\n    /**\r\n     * Get the current state of the infoControl as a string.\r\n     * It enables saving the state for later usage.\r\n     *\r\n     * @param {Object} infoControl - the element instance\r\n     * @returns {Object} the state\r\n     */\r\n    var getState = function getState(infoControl){\r\n        return _getPic(infoControl).getSerializedState();\r\n    };\r\n\r\n    return {\r\n        qtiClass : 'infoControl',\r\n        template : tpl,\r\n        getData : function(infoControl, data){\r\n\r\n            //remove ns + fix media file path\r\n            var markup = data.markup;\r\n            markup = util.removeMarkupNamespaces(markup);\r\n            markup = PortableElement.fixMarkupMediaSources(markup, this);\r\n            data.markup = markup;\r\n            return data;\r\n        },\r\n        render : render,\r\n        getContainer : containerHelper.get,\r\n        destroy : destroy,\r\n        getState : getState,\r\n        setState : setState\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA\r\n *\r\n */\r\n\r\n/**\r\n * Portable Info Control Creator Renderer\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/PortableInfoControl',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/PortableInfoControl',\r\n    'taoQtiItem/portableElementRegistry/icRegistry',\r\n    'taoQtiItem/qtiCreator/helper/commonRenderer'\r\n], function(_, Renderer, icRegistry, commonRenderer){\r\n    'use strict';\r\n\r\n    //clone the common renderer\r\n    var CreatorPortableInfoControl = _.clone(Renderer);\r\n\r\n    /**\r\n     * override the render method\r\n     */\r\n    CreatorPortableInfoControl.render = function render(infoControl, options){\r\n\r\n        var self = this;\r\n\r\n        //initial rendering:\r\n        Renderer.render.call(commonRenderer.get(), infoControl).then(function(){\r\n\r\n            var picCreator = icRegistry.getCreator(infoControl.typeIdentifier).module;\r\n            if(picCreator){\r\n\r\n                //add extra options required to setup the resource manager\r\n                options = options || {};\r\n                options.baseUrl = self.getOption('baseUrl');\r\n                options.uri = self.getOption('uri');\r\n                options.lang = self.getOption('lang');\r\n                options.mediaManager = self.getOption('mediaManager');\r\n                options.assetManager = self.getAssetManager();\r\n\r\n                picCreator.getWidget().build(\r\n                    infoControl,\r\n                    Renderer.getContainer(infoControl),\r\n                    self.getOption('bodyElementOptionForm'),\r\n                    options\r\n                );\r\n            }else{\r\n                //in case the pic has been imported with a runtime only (no creator)\r\n                //@todo allow deleting it\r\n            }\r\n        }).catch(function(err){\r\n            reject('Error initializing the creator : ' + error);\r\n        });\r\n    };\r\n\r\n    return CreatorPortableInfoControl;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/rubricBlock', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n<div class=\\\"grid-row qti-rubricBlock\\\" data-use=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.use)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-qti-class=\\\"rubricBlock\\\">\\r\\n    <div class=\\\"col-12\\\">\\r\\n        <div class=\\\"qti-rubricBlock-body\\\">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</div>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  }\n\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.empty), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/RubricBlock',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/rubricBlock',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'rubricBlock',\r\n        getContainer : containerHelper.get,\r\n        template : tpl,\r\n        getData : function getData(rubric, data){\r\n            if(rubric.isEmpty()){\r\n                data.empty = true;\r\n            }\r\n            return data;\r\n        }\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/static/rubricBlock/states/Sleep',['taoQtiItem/qtiCreator/widgets/states/factory', 'taoQtiItem/qtiCreator/widgets/static/states/Sleep'], function(stateFactory, SleepState){\r\n    \r\n    var RubriBlockStateSleep = stateFactory.extend(SleepState, function(){}, function(){});\r\n    \r\n    return RubriBlockStateSleep;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/forms/static/rubricBlock', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, functionType=\"function\";\n\n\n  buffer += \"<!--currently only visible to the candidate-->\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"view\\\">Visible by</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"A rubric block identifies part of an assessmentItem's itemBody that represents instructions to one or more of the actors that view the item. Although rubric blocks are defined as simpleBlocks they must not contain interactions.\", options) : helperMissing.call(depth0, \"__\", \"A rubric block identifies part of an assessmentItem's itemBody that represents instructions to one or more of the actors that view the item. Although rubric blocks are defined as simpleBlocks they must not contain interactions.\", options)))\n    + \"\\r\\n    </div>\\r\\n    <select name=\\\"view\\\" class=\\\"select2\\\" data-has-search=\\\"false\\\">\\r\\n        <option value=\\\"author\\\">author</option>\\r\\n        <option value=\\\"candidate\\\">candidate</option>\\r\\n        <option value=\\\"proctor\\\">proctor</option>\\r\\n        <option value=\\\"scorer\\\">scorer</option>\\r\\n        <option value=\\\"testConstructor\\\">test constructor</option>\\r\\n        <option value=\\\"tutor\\\">tutor</option>\\r\\n    </select>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label for=\\\"use\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Description\", options) : helperMissing.call(depth0, \"__\", \"Description\", options)))\n    + \"</label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <div class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The purpose for which the rubric is intended to be used. As a reading passage for multiple items, or instructions for a particular section, for example.\", options) : helperMissing.call(depth0, \"__\", \"The purpose for which the rubric is intended to be used. As a reading passage for multiple items, or instructions for a particular section, for example.\", options)))\n    + \"</div>\\r\\n    <input type=\\\"text\\\" name=\\\"use\\\" value=\\\"\";\n  if (helper = helpers.use) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.use); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiCreator/widgets/static/rubricBlock/states/Active',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/forms/static/rubricBlock',\r\n    'taoQtiItem/qtiCreator/widgets/helpers/formElement'\r\n], function(stateFactory, Active, htmlEditor, content, formTpl, formElement){\r\n\r\n    var RubricBlockStateActive = stateFactory.extend(Active, function(){\r\n\r\n        this.buildEditor();\r\n        this.initForm();\r\n\r\n    }, function(){\r\n\r\n        this.destroyEditor();\r\n        this.widget.$form.empty();\r\n    });\r\n\r\n    RubricBlockStateActive.prototype.buildEditor = function(){\r\n\r\n        var widget = this.widget,\r\n            $editableContainer = widget.$container,\r\n            container = widget.element.getBody();\r\n\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                change : content.getChangeCallback(container),\r\n                data : {\r\n                    widget : widget,\r\n                    container : container\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    RubricBlockStateActive.prototype.destroyEditor = function(){\r\n        //search and destroy the editor\r\n        htmlEditor.destroyEditor(this.widget.$container);\r\n    };\r\n\r\n    RubricBlockStateActive.prototype.initForm = function(){\r\n\r\n        var _widget = this.widget,\r\n            $form = _widget.$form,\r\n            interaction = _widget.element;\r\n\r\n        $form.html(formTpl({\r\n            view : interaction.attr('view'),\r\n            use : interaction.attr('use')\r\n        }));\r\n\r\n        formElement.initWidget($form);\r\n\r\n        //init data change callbacks\r\n        formElement.setChangeCallbacks($form, interaction, {\r\n            view : formElement.getAttributeChangeCallback(),\r\n            use : formElement.getAttributeChangeCallback()\r\n        });\r\n\r\n    };\r\n\r\n    return RubricBlockStateActive;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/rubricBlock/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/rubricBlock/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/rubricBlock/states/Active'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/static/rubricBlock/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/rubricBlock/states/states',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/textBlock'\r\n], function($, Widget, states, toolbarTpl) {\r\n\r\n    var RubricBlockWidget = Widget.clone();\r\n\r\n    RubricBlockWidget.buildContainer = function() {\r\n        this.$container = this.$original.addClass('widget-box widget-rubricBlock');\r\n    };\r\n\r\n    RubricBlockWidget.initCreator = function() {\r\n\r\n        this.registerStates(states);\r\n\r\n        Widget.initCreator.call(this);\r\n    };\r\n\r\n    RubricBlockWidget.createToolbar = function() {\r\n\r\n        var $tlb = $(toolbarTpl({\r\n                serial: this.serial,\r\n                state: 'active'\r\n            })),\r\n            _this = this;\r\n\r\n        this.$container.find('.qti-rubricBlock-body').append($tlb);\r\n\r\n        $tlb.find('[data-role=\"delete\"]').on('click.widget-box', function(e){\r\n            e.stopPropagation();//to prevent direct deleting;\r\n            _this.changeState('deleting');\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    return RubricBlockWidget;\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technologies SA (under the project TAO-PRODUCT);\r\n */\r\n\r\ndefine('taoQtiItem/qtiCreator/renderers/RubricBlock',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/RubricBlock',\r\n    'taoQtiItem/qtiCreator/widgets/static/rubricBlock/Widget'\r\n], function(_, Renderer, Widget){\r\n    'use strict';\r\n\r\n    var CreatorRubricBlock = _.clone(Renderer);\r\n\r\n    CreatorRubricBlock.render = function(rubricBlock, options){\r\n\r\n        Widget.build(\r\n            rubricBlock,\r\n            Renderer.getContainer(rubricBlock),\r\n            this.getOption('bodyElementOptionForm'),\r\n            options\r\n        );\r\n    };\r\n\r\n    return CreatorRubricBlock;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCommonRenderer/tpl/table', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"summary=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.summary)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\n  buffer += \"<table\\r\\n    class=\\\"qti-table\\\"\\r\\n    data-qti-class=\\\"table\\\"\\r\\n    data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.summary), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    >\\r\\n    \";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</table>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCommonRenderer/renderers/Table',[\r\n    'tpl!taoQtiItem/qtiCommonRenderer/tpl/table',\r\n    'taoQtiItem/qtiCommonRenderer/helpers/container'\r\n], function(tpl, containerHelper){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'table',\r\n        getContainer : containerHelper.get,\r\n        template : tpl\r\n    };\r\n});\r\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/table/states/Sleep',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Sleep'\r\n], function(stateFactory, SleepState){\r\n    'use strict';\r\n\r\n    var TableStateSleep = stateFactory.extend(SleepState, function init() {}, function exit() {});\r\n\r\n    return TableStateSleep;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/widgets/static/table/components/tableActions', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"table-tlb table-col-tlb\\\">\\r\\n    <div class=\\\"rgt tlb-button\\\" title=\\\"Insert Row\\\" data-role=\\\"insertRow\\\">\\r\\n        <span class=\\\"icon-row\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"rgt tlb-button\\\" title=\\\"Insert Column\\\" data-role=\\\"insertCol\\\">\\r\\n        <span class=\\\"icon-column\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"rgt tlb-button\\\" title=\\\"\";\n  if (helper = helpers.deleteTitle) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.deleteTitle); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-role=\\\"colRowDelete\\\">\\r\\n        <span class=\\\"icon-bin\\\"></span>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/table/components/tableActions',[\r\n    'lodash',\r\n    'jquery',\r\n    'ui/component',\r\n    'ui/component/placeable',\r\n    'tpl!taoQtiItem/qtiCreator/widgets/static/table/components/tableActions'\r\n], function(_, $, componentFactory, makePlaceable, tpl) {\r\n    'use strict';\r\n\r\n    var defaultConfig = {\r\n        'delete': true,\r\n        'insertRow': false,\r\n        'insertCol': false,\r\n        'deleteTitle': 'Delete'\r\n    };\r\n\r\n    var tableActionsApi = {\r\n        hideDelete: function hideDelete() {\r\n            var $component = this.getElement(),\r\n                $delete = $component.find('[data-role=\"colRowDelete\"]');\r\n\r\n            $delete.hide();\r\n        },\r\n\r\n        showDelete: function hideDelete() {\r\n            var $component = this.getElement(),\r\n                $delete = $component.find('[data-role=\"colRowDelete\"]');\r\n\r\n            $delete.show();\r\n        }\r\n    };\r\n\r\n    function triggerEvent(eventName) {\r\n        var self = this;\r\n        return function(event) {\r\n            event.stopPropagation();\r\n            self.trigger(eventName);\r\n        };\r\n    }\r\n\r\n    function mousedown() {\r\n        return function(event) {\r\n            event.stopPropagation();\r\n        };\r\n    }\r\n\r\n    return function tableActionsFactory(config) {\r\n        var tableActionsComponent;\r\n\r\n        config = _.defaults(config || {}, defaultConfig);\r\n\r\n        tableActionsComponent = componentFactory(tableActionsApi, config)\r\n            .setTemplate(tpl)\r\n            .on('render', function() {\r\n                var self = this,\r\n                    $component = this.getElement(),\r\n                    $delete    = $component.find('[data-role=\"colRowDelete\"]'),\r\n                    $insertRow = $component.find('[data-role=\"insertRow\"]'),\r\n                    $insertCol = $component.find('[data-role=\"insertCol\"]');\r\n\r\n                if (this.config.delete) {\r\n                    $delete\r\n                        .on('mousedown', mousedown())\r\n                        .on('click', triggerEvent.call(self, 'delete'))\r\n                        .on('mouseenter', triggerEvent.call(self, 'deleteMouseEnter'))\r\n                        .on('mouseleave', triggerEvent.call(self, 'deleteMouseLeave'));\r\n                } else {\r\n                    $delete.hide();\r\n                }\r\n\r\n                if (this.config.insertRow) {\r\n                    $insertRow.on('mousedown', mousedown())\r\n                        .on('click', triggerEvent.call(self, 'insertRow'))\r\n                        .on('mouseenter', triggerEvent.call(self, 'insertRowMouseEnter'))\r\n                        .on('mouseleave', triggerEvent.call(self, 'insertRowMouseLeave'));\r\n                } else {\r\n                    $insertRow.hide();\r\n                }\r\n\r\n                if (this.config.insertCol) {\r\n                    $insertCol.on('mousedown', mousedown())\r\n                        .on('click', triggerEvent.call(self, 'insertCol'))\r\n                        .on('mouseenter', triggerEvent.call(self, 'insertColMouseEnter'))\r\n                        .on('mouseleave', triggerEvent.call(self, 'insertColMouseLeave'));\r\n                } else {\r\n                    $insertCol.hide();\r\n                }\r\n            });\r\n\r\n        makePlaceable(tableActionsComponent);\r\n\r\n        return tableActionsComponent.init();\r\n    };\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/table/states/Active',[\r\n    'lodash',\r\n    'jquery',\r\n    'i18n',\r\n    'ckeditor',\r\n    'ui/tableModel',\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/Active',\r\n    'taoQtiItem/qtiCreator/widgets/static/table/components/tableActions',\r\n    'taoQtiItem/qtiCreator/editor/ckEditor/htmlEditor',\r\n    'taoQtiItem/qtiCreator/editor/gridEditor/content'\r\n], function(_, $, __, ckEditor, tableModelFactory, stateFactory, Active, tableActionsFactory, htmlEditor, contentHelper){\r\n    'use strict';\r\n\r\n    var tableModel,\r\n        colActions,\r\n        rowActions;\r\n\r\n    var css = {\r\n        deleteColRow: 'hoverDelete',\r\n        insertRowAfter: 'insertRowAfter',\r\n        insertColAfter: 'insertColAfter'\r\n    };\r\n\r\n    var TableStateActive = stateFactory.extend(Active, function create(){\r\n        this.buildEditor();\r\n\r\n    }, function exit(){\r\n        this.destroyEditor();\r\n    });\r\n\r\n    TableStateActive.prototype.buildEditor = function buildEditor(){\r\n        var _widget   = this.widget,\r\n            container = _widget.element.getBody(),\r\n\r\n            $itemPanel          = _widget.getAreaBroker().getItemPanelArea(),\r\n            $editableContainer  = _widget.$container,\r\n            $editable           = $editableContainer.find('[data-html-editable=\"true\"]'),\r\n            $tablePropTrigger   = $editableContainer.find('[data-role=\"cke-table-properties\"]');\r\n\r\n        $editableContainer.attr('data-html-editable-container', true);\r\n\r\n        if(!htmlEditor.hasEditor($editableContainer)){\r\n            htmlEditor.buildEditor($editableContainer, {\r\n                placeholder: '',\r\n                change : contentHelper.getChangeCallback(container),\r\n                data : {\r\n                    container : container,\r\n                    widget : _widget\r\n                },\r\n                blur : function(){\r\n                    _widget.changeState('sleep');\r\n                },\r\n                hideTriggerOnBlur: true\r\n            });\r\n        }\r\n\r\n        $editable\r\n            .on('editorready.tableActive', function(event, editor) {\r\n                tableModel = tableModelFactory($editable);\r\n\r\n                // listener for table properties\r\n                $tablePropTrigger.on('click.tableActive', function openTableProperties(e){\r\n                    e.stopPropagation();\r\n                    editor.execCommand('taoqtitableProperties');\r\n                });\r\n\r\n                // listeners for columns actions\r\n                colActions = tableActionsFactory({\r\n                    insertCol: true,\r\n                    deleteTitle: 'Delete column'\r\n                })\r\n                    .on('delete', function() {\r\n                        editor.execCommand('columnDelete');\r\n                        hideTableActions();\r\n                        updateTable();\r\n                    })\r\n                    .on('deleteMouseEnter', function() {\r\n                        addClassOnCurrentCol(editor, css.deleteColRow);\r\n                    })\r\n                    .on('deleteMouseLeave', function() {\r\n                        clearCellClasses($editable, css.deleteColRow);\r\n                    })\r\n                    .on('insertCol', function() {\r\n                        editor.execCommand('columnInsertAfter');\r\n                        clearCellClasses($editable, css.insertColAfter);    // this is because ck clone the current cells to insert the new ones\r\n                        this.trigger('insertColMouseEnter');                // so we don't want him to clone the \"insert style\"\r\n                        updateTable();\r\n                    })\r\n                    .on('insertColMouseEnter', function() {\r\n                        addClassOnCurrentCol(editor, css.insertColAfter);\r\n                    })\r\n                    .on('insertColMouseLeave', function() {\r\n                        clearCellClasses($editable, css.insertColAfter);\r\n                    })\r\n                    .render($itemPanel)\r\n                    .hide();\r\n\r\n                // listeners for row actions\r\n                rowActions = tableActionsFactory({\r\n                    insertRow: true,\r\n                    deleteTitle: 'Delete row'\r\n                })\r\n                    .on('delete', function() {\r\n                        editor.execCommand('rowDelete');\r\n                        hideTableActions();\r\n                        updateTable();\r\n                    })\r\n                    .on('deleteMouseEnter', function() {\r\n                        addClassOnCurrentRow(editor, css.deleteColRow);\r\n                    })\r\n                    .on('deleteMouseLeave', function() {\r\n                        clearCellClasses($editable, css.deleteColRow);\r\n                    })\r\n                    .on('insertRow', function() {\r\n                        editor.execCommand('rowInsertAfter');\r\n                        clearCellClasses($editable, css.insertRowAfter);    // this is because ck clone the current cells to insert the new ones\r\n                        this.trigger('insertRowMouseEnter');                // so we don't want him to clone the \"insert style\"\r\n                        updateTable();\r\n                    })\r\n                    .on('insertRowMouseEnter', function() {\r\n                        addClassOnCurrentRow(editor, css.insertRowAfter);\r\n                    })\r\n                    .on('insertRowMouseLeave', function() {\r\n                        clearCellClasses($editable, css.insertRowAfter);\r\n                    })\r\n                    .render($itemPanel)\r\n                    .hide();\r\n\r\n                $editableContainer.on('keyup.tableActive mouseup.tableActive', function() {\r\n                    displayTableActions(editor, $editableContainer);\r\n                });\r\n            })\r\n            .on('editordestroyed.tableActive', function() {\r\n                if ($tablePropTrigger.length) {\r\n                    $tablePropTrigger.off('.tableActive');\r\n                }\r\n            });\r\n    };\r\n\r\n    TableStateActive.prototype.destroyEditor = function destroyEditor(){\r\n        var _widget = this.widget,\r\n            $editableContainer = _widget.$container,\r\n            $editable = $editableContainer.find('[data-html-editable=\"true\"]');\r\n\r\n        //search and destroy the editor\r\n        $editableContainer.off('.tableActive');\r\n        $editable.off('.tableActive');\r\n        htmlEditor.destroyEditor($editableContainer);\r\n\r\n        tableModel = null;\r\n\r\n        // destroy the actions toolbars\r\n        if (colActions) {\r\n            colActions.destroy();\r\n            colActions = null;\r\n        }\r\n\r\n        if (rowActions) {\r\n            rowActions.destroy();\r\n            rowActions = null;\r\n        }\r\n    };\r\n\r\n    function addClassOnCurrentRow(editor, className) {\r\n        var currentCellPos = getCurrentCellPos(editor),\r\n            $currentCol;\r\n        if (currentCellPos) {\r\n            $currentCol = tableModel.getRowCells(currentCellPos.y);\r\n            $currentCol.addClass(className);\r\n        }\r\n    }\r\n\r\n    function addClassOnCurrentCol(editor, className) {\r\n        var currentCellPos = getCurrentCellPos(editor),\r\n            $currentCol;\r\n        if (currentCellPos) {\r\n            $currentCol = tableModel.getColCells(currentCellPos.x);\r\n            $currentCol.addClass(className);\r\n        }\r\n    }\r\n\r\n    function clearCellClasses($editable, className) {\r\n        $editable.find('th, td').removeClass(className);\r\n    }\r\n\r\n    function updateTable() {\r\n        tableModel.update();\r\n        if (tableModel.getRowCount() === 1) {\r\n            rowActions.hideDelete();\r\n        } else {\r\n            rowActions.showDelete();\r\n        }\r\n        if (tableModel.getColCount() === 1) {\r\n            colActions.hideDelete();\r\n        } else {\r\n            colActions.showDelete();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * hide components containing row and column actions\r\n     */\r\n    function hideTableActions() {\r\n        colActions.hide();\r\n        rowActions.hide();\r\n    }\r\n\r\n    /**\r\n     * Display row and columns actions at the correct position, depending of where the user has the cursor\r\n     * @param {ckEditor} editor - editor instance to access the current selection\r\n     * @param {jQuery} $tableContainer - the table DOM element, so we can align the toolbars on it\r\n     */\r\n    function displayTableActions(editor, $tableContainer) {\r\n        var selectedCells = getSelection(editor),\r\n            $currentCell;\r\n\r\n        if (selectedCells && selectedCells.length !== 1) {\r\n            // when none or more than one cells are selected, then we do not display the toolbars as the expected behavior is not obvious.\r\n            // for example, it's difficult to define the expected behavior of deleting a column when cells from multiple columns are selected...\r\n            hideTableActions();\r\n\r\n        } else {\r\n            $currentCell = $(selectedCells[0].$);\r\n\r\n            colActions\r\n                .show()\r\n                .hAlignWith($currentCell, 'center')\r\n                .vAlignWith($tableContainer, 'top');\r\n\r\n            rowActions\r\n                .show()\r\n                .hAlignWith($tableContainer, 'left')\r\n                .vAlignWith($currentCell, 'center');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * only works when a single cell is selected\r\n     * @param editor\r\n     */\r\n    function getCurrentCellPos(editor) {\r\n        var selectedCells = getSelection(editor),\r\n            currentCell;\r\n\r\n        if (selectedCells && selectedCells.length === 1) {\r\n            currentCell = selectedCells[0].$;\r\n\r\n            return {\r\n                x: currentCell.cellIndex,\r\n                y: currentCell.parentNode.rowIndex\r\n            };\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the current selected cells in the table\r\n     * @param editor - CkEditor instance\r\n     * @returns {ckEditor.dom.element[]}\r\n     */\r\n    function getSelection(editor) {\r\n        var selection = editor.getSelection(),\r\n            tabletools = window.CKEDITOR.plugins.tabletools;\r\n\r\n        if (selection && tabletools) {\r\n            return tabletools.getSelectedCells(selection);\r\n        }\r\n    }\r\n\r\n    return TableStateActive;\r\n});\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/table/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/table/states/Sleep',\r\n    'taoQtiItem/qtiCreator/widgets/static/table/states/Active'\r\n], function(factory, states){\r\n    'use strict';\r\n\r\n    return factory.createBundle(states, arguments);\r\n});\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/toolbars/table', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<div class=\\\"mini-tlb\\\" data-edit=\\\"\";\n  if (helper = helpers.state) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.state); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-for=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n    <div class=\\\"rgt tlb-button\\\" data-role=\\\"cke-launcher\\\" title=\\\"Formatting options\\\">\\r\\n        <span class=\\\"icon-font\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"rgt tlb-button\\\" title=\\\"Delete\\\" data-role=\\\"delete\\\">\\r\\n        <span class=\\\"icon-bin\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"rgt tlb-button\\\" data-role=\\\"cke-table-properties\\\" title=\\\"Table properties\\\">\\r\\n        <span class=\\\"icon-table\\\"></span>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/table/Widget',[\r\n    'jquery',\r\n    'taoQtiItem/qtiCreator/widgets/static/Widget',\r\n    'taoQtiItem/qtiCreator/widgets/static/table/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/static/helpers/widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/toolbars/table'\r\n], function($, Widget, states, helper, toolbarTpl) {\r\n    'use strict';\r\n\r\n    var TableWidget = Widget.clone();\r\n\r\n    TableWidget.initCreator = function() {\r\n\r\n        this.registerStates(states);\r\n\r\n        Widget.initCreator.call(this);\r\n    };\r\n\r\n    TableWidget.buildContainer = function(){\r\n\r\n        helper.buildBlockContainer(this);\r\n\r\n        return this;\r\n    };\r\n\r\n    TableWidget.createToolbar = function(){\r\n\r\n        var self = this,\r\n            $tlb = $(toolbarTpl({\r\n                serial : this.serial,\r\n                state : 'active'\r\n            }));\r\n\r\n        this.$container.append($tlb);\r\n\r\n        $tlb.find('[data-role=\"delete\"]').on('click.widget-box', function(e){\r\n            e.stopPropagation();//to prevent direct deleting;\r\n            self.changeState('deleting');\r\n        });\r\n\r\n        return this;\r\n    };\r\n\r\n    return TableWidget;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/tpl/table', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"summary=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.summary)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\"\";\n  return buffer;\n  }\n\n  buffer += \"<table\\r\\n    data-qti-class=\\\"table\\\"\\r\\n    class=\\\"qti-table\\\"\\r\\n    data-html-editable=\\\"true\\\"\\r\\n    data-serial=\\\"\";\n  if (helper = helpers.serial) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.serial); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.attributes)),stack1 == null || stack1 === false ? stack1 : stack1.summary), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    >\\r\\n    \";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</table>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n/**\r\n * @author Christophe Noël <christophe@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/renderers/Table',[\r\n    'lodash',\r\n    'taoQtiItem/qtiCommonRenderer/renderers/Table',\r\n    'taoQtiItem/qtiCreator/widgets/static/table/Widget',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/table'\r\n], function(_, Renderer, Widget, tpl){\r\n    'use strict';\r\n\r\n    var CreatorTable = _.clone(Renderer);\r\n\r\n    CreatorTable.template = tpl;\r\n\r\n    CreatorTable.render = function(table, options){\r\n\r\n        Widget.build(\r\n            table,\r\n            Renderer.getContainer(table),\r\n            this.getOption('bodyElementOptionForm'),\r\n            options || {}\r\n        );\r\n    };\r\n\r\n    return CreatorTable;\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiCreator/widgets/helpers/pciMediaManager/propertiesForm', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"checked=\\\"checked\\\"\";\n  }\n\n  buffer += \"<div class=\\\"panel\\\">\\r\\n\\r\\n    <div>\\r\\n        <label>\\r\\n            <input type=\\\"text\\\" name=\\\"uri\\\" placeholder=\\\"Please select media file\\\" value=\\\"\";\n  if (helper = helpers.uri) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.uri); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-validate=\\\"$notEmpty;\\\"/>\\r\\n            <div><button class='selectMediaFile btn-info small block'>\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Select media file\", options) : helperMissing.call(depth0, \"__\", \"Select media file\", options)))\n    + \"</button></div>\\r\\n        </label>\\r\\n    </div>\\r\\n\\r\\n    <div>\\r\\n        <label for=\\\"width\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Width\", options) : helperMissing.call(depth0, \"__\", \"Width\", options)))\n    + \"</label>\\r\\n        <input name=\\\"width\\\" value=\\\"\";\n  if (helper = helpers.width) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.width); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" class=\\\"large\\\" data-increment=\\\"1\\\" data-min=\\\"50\\\" data-max=\\\"1920\\\" />\\r\\n    </div>\\r\\n\\r\\n    <div class=\\\"height-container\\\">\\r\\n        <label for=\\\"height\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Height\", options) : helperMissing.call(depth0, \"__\", \"Height\", options)))\n    + \"</label>\\r\\n        <input name=\\\"height\\\" value=\\\"\";\n  if (helper = helpers.height) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.height); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" type=\\\"text\\\" class=\\\"large\\\" data-increment=\\\"1\\\" data-min=\\\"30\\\" data-max=\\\"1080\\\" />\\r\\n    </div>\\r\\n\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"autostart\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.autostart), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Autostart\", options) : helperMissing.call(depth0, \"__\", \"Autostart\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The autostart attribute determines if the media object should begin as soon as the candidate starts the attempt (checked) or if the media object should be started under the control of the candidate (unchecked).\", options) : helperMissing.call(depth0, \"__\", \"The autostart attribute determines if the media object should begin as soon as the candidate starts the attempt (checked) or if the media object should be started under the control of the candidate (unchecked).\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"loop\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.loop), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Loop\", options) : helperMissing.call(depth0, \"__\", \"Loop\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n       \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The loop attribute is used to set continuous play mode. In continuous play mode, once the media object has started to play it should play continuously (subject to maxPlays).\", options) : helperMissing.call(depth0, \"__\", \"The loop attribute is used to set continuous play mode. In continuous play mode, once the media object has started to play it should play continuously (subject to maxPlays).\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <label>\\r\\n        <input name=\\\"pause\\\" type=\\\"checkbox\\\" \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.pause), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"/>\\r\\n        <span class=\\\"icon-checkbox\\\"></span>\\r\\n        \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Pause\", options) : helperMissing.call(depth0, \"__\", \"Pause\", options)))\n    + \"\\r\\n    </label>\\r\\n    <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content:first\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n    <span class=\\\"tooltip-content\\\">\\r\\n       \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Enable the test taker to pause and restart the playing.\", options) : helperMissing.call(depth0, \"__\", \"Enable the test taker to pause and restart the playing.\", options)))\n    + \"\\r\\n    </span>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <div>\\r\\n        <label for=\\\"maxPlays\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Max plays count\", options) : helperMissing.call(depth0, \"__\", \"Max plays count\", options)))\n    + \"</label>\\r\\n        <input name=\\\"maxPlays\\\" value=\\\"\";\n  if (helper = helpers.maxPlays) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.maxPlays); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"large\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"1000\\\" type=\\\"text\\\" />\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"The maxPlays attribute indicates that the media object can be played at most maxPlays times - it must not be possible for the candidate to play the media object more than maxPlay times. A value of 0 (the default) indicates that there is no limit.\", options) : helperMissing.call(depth0, \"__\", \"The maxPlays attribute indicates that the media object can be played at most maxPlays times - it must not be possible for the candidate to play the media object more than maxPlay times. A value of 0 (the default) indicates that there is no limit.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n</div>\\r\\n\\r\\n<div class=\\\"panel\\\">\\r\\n    <div>\\r\\n        <label for=\\\"replayTimeout\\\" class=\\\"spinner\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Replay timeout\", options) : helperMissing.call(depth0, \"__\", \"Replay timeout\", options)))\n    + \"</label>\\r\\n        <input name=\\\"replayTimeout\\\" value=\\\"\";\n  if (helper = helpers.replayTimeout) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.replayTimeout); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" class=\\\"large\\\" data-increment=\\\"1\\\" data-min=\\\"0\\\" data-max=\\\"1000\\\" type=\\\"text\\\" />\\r\\n        <span class=\\\"icon-help tooltipstered\\\" data-tooltip=\\\"~ .tooltip-content\\\" data-tooltip-theme=\\\"info\\\"></span>\\r\\n        <span class=\\\"tooltip-content\\\">\\r\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"In seconds. Delay during which the replay of the media is allowed. Once reached, the media is disabled and cannot be played anymore.\", options) : helperMissing.call(depth0, \"__\", \"In seconds. Delay during which the replay of the media is allowed. Once reached, the media is disabled and cannot be played anymore.\", options)))\n    + \"\\r\\n        </span>\\r\\n    </div>\\r\\n</div>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\n\r\n/**\r\n * This helper allow to use the resource manager in a PCI creator widget\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/helpers/pciMediaManager/pciMediaManager',[\r\n    'lodash',\r\n    'i18n',\r\n    'jquery',\r\n    'tpl!taoQtiItem/qtiCreator/widgets/helpers/pciMediaManager/propertiesForm'\r\n], function( _, __, $, formTpl){\r\n    'use strict';\r\n\r\n    var pciMediaManager  = function pciMediaManagerFactory(widget) {\r\n        var $form       = widget.$form,\r\n            options     = widget.options,\r\n            interaction = widget.element,\r\n            configChangeCallback;\r\n\r\n        var isAudio            = false,\r\n            defaultVideoHeight = 270,\r\n            defaultAudioHeight = 30,\r\n            $heightContainer;\r\n\r\n        var mediaProps         = interaction.properties.media || {},\r\n            mediaPropsDefaults = {\r\n                autostart:      false,\r\n                loop:           false,\r\n                maxPlays:       2,\r\n                replayTimeout:  5,\r\n                pause:          false,\r\n                uri:            null,\r\n                type:           null,\r\n                height:         defaultVideoHeight,\r\n                width:          480\r\n            };\r\n\r\n        mediaProps = _.defaults(mediaProps, mediaPropsDefaults);\r\n        interaction.properties.media = mediaProps;\r\n\r\n        /**\r\n         * Switch to audio mode:\r\n         * update height and disable the field\r\n         */\r\n        function switchToAudio(){\r\n            isAudio = true;\r\n\r\n            $heightContainer.hide();\r\n            mediaProps.height = defaultAudioHeight;\r\n        }\r\n\r\n        /**\r\n         * Switch to video mode:\r\n         * update height and enable the field\r\n         */\r\n        function switchToVideo(){\r\n            if(isAudio){\r\n                isAudio = false;\r\n                mediaProps.height = defaultVideoHeight;\r\n                $heightContainer.show();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Switch mode based on file type\r\n         */\r\n        function switchMode(){\r\n            if (/audio/.test(mediaProps.type)) {\r\n                switchToAudio();\r\n            } else {\r\n                switchToVideo();\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Set up the file upload component\r\n         */\r\n        function setUpUploader() {\r\n\r\n            var $src = $form.find('input[name=uri]');\r\n            var $uploadTrigger = $form.find('.selectMediaFile');\r\n\r\n            var openResourceMgr = function openResourceMgr(){\r\n                $uploadTrigger.resourcemgr({\r\n                    title : __('Please select a media file (video or audio) from the resource manager. You can add files from your computer with the button \"Add file(s)\".'),\r\n                    appendContainer: options.mediaManager.appendContainer,\r\n                    mediaSourcesUrl: options.mediaManager.mediaSourcesUrl,\r\n                    browseUrl:       options.mediaManager.browseUrl,\r\n                    uploadUrl:       options.mediaManager.uploadUrl,\r\n                    deleteUrl:       options.mediaManager.deleteUrl,\r\n                    downloadUrl:     options.mediaManager.downloadUrl,\r\n                    fileExistsUrl:   options.mediaManager.fileExistsUrl,\r\n                    params : {\r\n                        uri : options.uri,\r\n                        lang : options.lang,\r\n                        filters : 'video/mp4,video/avi,video/ogv,video/mpeg,video/ogg,video/quicktime,video/webm,video/x-ms-wmv,video/x-flv,audio/mp3,audio/vnd.wav,audio/ogg,audio/vorbis,audio/webm,audio/mpeg,application/ogg,audio/aac,audio/wav,audio/flac'\r\n                    },\r\n                    pathParam : 'path',\r\n                    select : function select(e, files){\r\n                        if(files && files.length){\r\n                            // set uri field content and maybe detect and set media type here\r\n                            mediaProps.type = files[0].mime;\r\n                            $form.find('input[name=uri]')\r\n                                .val(files[0].file)\r\n                                .trigger('change');\r\n                        }\r\n                    },\r\n                    open : function open(){\r\n                        //hide tooltip if displayed\r\n                        if($src.data('qtip')){\r\n                            $src.blur().qtip('hide');\r\n                        }\r\n                    },\r\n                    close : function close(){\r\n                        //triggers validation :\r\n                        $src.blur();\r\n                    }\r\n                });\r\n\r\n            };\r\n            $uploadTrigger.on('click', openResourceMgr);\r\n        }\r\n\r\n        configChangeCallback = _.debounce(function confchangeCallback(boundInteraction, value, name) {\r\n            mediaProps[name] = value;\r\n            boundInteraction.triggerPci('configChange', [boundInteraction.getProperties()]);\r\n        }, 500);\r\n\r\n        /**\r\n         * The pciMediaManager helper\r\n         */\r\n        return {\r\n            /**\r\n             * Init the helper\r\n             */\r\n            init: function init() {\r\n                $heightContainer = $('.height-container', $form);\r\n                switchMode();\r\n                setUpUploader();\r\n            },\r\n\r\n            /**\r\n             * Get the Widget form for the media setting\r\n             * @returns {String}\r\n             */\r\n            getForm: function getForm() {\r\n                return formTpl({\r\n                    autostart:      !!mediaProps.autostart,\r\n                    loop:           !!mediaProps.loop,\r\n                    maxPlays:       parseInt(mediaProps.maxPlays, 10),\r\n                    replayTimeout:  parseInt(mediaProps.replayTimeout, 10),\r\n                    pause:          !!mediaProps.pause,\r\n                    uri:            mediaProps.uri,\r\n                    type:           mediaProps.type,\r\n                    width:          mediaProps.width,\r\n                    height:         mediaProps.height\r\n                });\r\n            },\r\n\r\n            /**\r\n             * Get the change callbacks for the form options\r\n             */\r\n            getChangeCallbacks: function getChangeCallbacks() {\r\n                return {\r\n                    autostart:      configChangeCallback,\r\n                    loop:           configChangeCallback,\r\n                    maxPlays:       configChangeCallback,\r\n                    replayTimeout:  configChangeCallback,\r\n                    pause:          configChangeCallback,\r\n                    width:          configChangeCallback,\r\n\r\n                    height: function height(boundInteraction, value, name){\r\n                        if(!isAudio){\r\n                            configChangeCallback(boundInteraction, value, name);\r\n                        }\r\n                    },\r\n\r\n                    uri: function uri(boundInteraction, value){\r\n                        if(mediaProps.uri !== value){\r\n                            mediaProps.uri = value;\r\n\r\n                            value = $.trim(value).toLowerCase();\r\n\r\n                            if (/^http(s)?:\\/\\/(www\\.)?youtu/.test(value)) {\r\n                                mediaProps.type = 'video/youtube';\r\n                                switchToVideo();\r\n                            } else if (/audio/.test(mediaProps.type)) {\r\n                                switchToAudio();\r\n                            } else {\r\n                                switchToVideo();\r\n                            }\r\n\r\n                            if(mediaProps && (!mediaProps.width || parseInt(mediaProps.width, 10) <= 0)){\r\n                                mediaProps.width = widget.$original.innerWidth();\r\n                            }\r\n\r\n                            boundInteraction.triggerPci('configChange', [boundInteraction.getProperties()]);\r\n                        }\r\n                    }\r\n                };\r\n            }\r\n        };\r\n    };\r\n\r\n    return pciMediaManager;\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/customInteraction/states/Question',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Question',\r\n    'jquery',\r\n    'lib/farbtastic/farbtastic'\r\n], function(stateFactory, Question, $){\r\n\r\n    var CustomInteractionStateQuestion = stateFactory.extend(Question);\r\n\r\n    CustomInteractionStateQuestion.prototype.initColorPickers = function(){\r\n\r\n        var $colorTriggers = this.widget.$form.find('.color-trigger:not([data-color-picker=initialized])');\r\n        \r\n        $colorTriggers.each(function(){\r\n\r\n            var $colorTrigger = $(this),\r\n                $input = $colorTrigger.siblings('input'),\r\n                color = $input.val();\r\n\r\n            //set color recorded in the hidden input to the color trigger\r\n            $colorTrigger.css('background-color', color);\r\n        });\r\n\r\n        $colorTriggers.on('click.color-picker', function(){\r\n\r\n            var $colorTrigger = $(this),\r\n                $context = $colorTrigger.closest('.item-editor-color-picker'),\r\n                $container = $context.find('.color-picker-container').show(),\r\n                $colorPicker = $container.find('.color-picker'),\r\n                $colorPickerInput = $container.find('.color-picker-input'),\r\n                $input = $colorTrigger.siblings('input[type=\"hidden\"]'),\r\n                color = $input.val(),\r\n                $itemEditorWidgetBar = $('#item-editor-item-widget-bar');\r\n\r\n            $container.css({\r\n                right : $itemEditorWidgetBar.width() + 2, \r\n                top : $colorTrigger.offset().top - ($container.width() / 2) - $itemEditorWidgetBar.offset().top\r\n            });\r\n\r\n            // Init the color picker\r\n            $colorPicker.farbtastic('.color-picker-input', $context);\r\n\r\n            // Set the color to the currently set on the form init\r\n            $colorPickerInput.val(color).trigger('keyup');\r\n\r\n            // Populate the input with the color on quitting the modal\r\n            $container.find('.closer').off('click').on('click', function(){\r\n                $container.hide();\r\n                $colorPicker.off('.farbtastic');\r\n            });\r\n            \r\n            //listen to color change\r\n            $colorPicker.off('.farbtastic').on('colorchange.farbtastic', function(e, color){\r\n                $colorTrigger.css('background-color', color);\r\n                $input.val(color).trigger('change');\r\n            });\r\n            \r\n        });\r\n        \r\n        $colorTriggers.attr('data-color-picker', 'initialized');\r\n    };\r\n\r\n    CustomInteractionStateQuestion.prototype.destroyColorPickers = function(){\r\n        \r\n        var $colorTriggers = this.widget.$form.find('.color-trigger');\r\n        $colorTriggers.off('.color-picker');\r\n        $colorTriggers.removeAttr('data-color-picker');\r\n    };\r\n\r\n    return CustomInteractionStateQuestion;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/customInteraction/states/Sleep',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Sleep',\r\n    'tpl!taoQtiItem/qtiCreator/tpl/notifications/widgetOverlay'\r\n], function(stateFactory, SleepState, overlayTpl){\r\n\r\n    return stateFactory.extend(SleepState, function(){\r\n\r\n        //add transparent protective layer\r\n        this.widget.$container.append(overlayTpl());\r\n\r\n    }, function(){\r\n\r\n        //remove transparent protective layer\r\n        this.widget.$container.children('.overlay').remove();\r\n    });\r\n});\r\n\n","define('taoQtiItem/qtiCreator/widgets/interactions/customInteraction/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/states',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/customInteraction/states/Question',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/customInteraction/states/Sleep'\r\n], function(factory, states){\r\n    return factory.createBundle(states, arguments);\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/customInteraction/Widget',[\r\n    'taoQtiItem/qtiCreator/widgets/interactions/Widget',\r\n    'taoQtiItem/portableElementRegistry/ciRegistry',\r\n    'lodash'\r\n], function(Widget, ciRegistry, _){\r\n\r\n    var CustomInteractionWidget = Widget.clone();\r\n\r\n    CustomInteractionWidget.initCreator = function(){\r\n\r\n        //note : abstract widget class must not register states\r\n\r\n        Widget.initCreator.call(this);\r\n    };\r\n\r\n    CustomInteractionWidget.createToolbar = function(options){\r\n\r\n        var creator = ciRegistry.getAuthoringData(this.element.typeIdentifier);\r\n        options = _.defaults(options || {}, {title : creator.label});\r\n\r\n        return Widget.createToolbar.call(this, options);\r\n    };\r\n\r\n    return CustomInteractionWidget;\r\n});\n","define('taoQtiItem/qtiCreator/widgets/interactions/gapMatchInteraction/states/Answer',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Answer',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState'\r\n], function(stateFactory, Answer, answerStateHelper){\r\n\r\n    var GapMatchInteractionStateAnswer = stateFactory.extend(Answer, function(){\r\n        \r\n        //forward to one of the available sub state, according to the response processing template\r\n        answerStateHelper.forward(this.widget);\r\n        \r\n    }, function(){\r\n        \r\n    });\r\n    \r\n    return GapMatchInteractionStateAnswer;\r\n});\r\n\n","/**\r\n * @author Bertrand Chevrier <bertrand@taotesting.com>\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Answer',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/states/Answer',\r\n    'taoQtiItem/qtiCreator/widgets/interactions/helpers/answerState'\r\n], function(stateFactory, Answer, answerStateHelper){\r\n\r\n    /**\r\n     * Just forward to the correct/map states\r\n     */\r\n    function initAnswerState(){\r\n        //answerStateHelper.forward(this.widget);\r\n        this.widget.changeState('map');\r\n    }\r\n    \r\n    \r\n    function exitAnswerState(){\r\n        //needed an exit callback even empty\r\n    }\r\n    \r\n    \r\n    /**\r\n     * The answer state for the selectPoint interaction\r\n     * @extends taoQtiItem/qtiCreator/widgets/interactions/states/Answer\r\n     * @exports taoQtiItem/qtiCreator/widgets/interactions/selectPointInteraction/states/Answer\r\n     */\r\n    return stateFactory.extend(Answer, initAnswerState, exitAnswerState);\r\n});\r\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/portableInfoControl/states/states',[\r\n    'taoQtiItem/qtiCreator/widgets/states/factory',\r\n    'taoQtiItem/qtiCreator/widgets/static/states/states'\r\n], function(factory, states){\r\n    'use strict';\r\n    return factory.createBundle(states, arguments, ['answer', 'correct', 'map']);\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiCreator/widgets/static/portableInfoControl/Widget',['taoQtiItem/qtiCreator/widgets/static/Widget'], function(Widget) {\r\n    'use strict';\r\n    \r\n    var InfoControlWidget = Widget.clone();\r\n    \r\n    InfoControlWidget.initCreator = function() {\r\n        \r\n        //note : abstract widget class must not register states\r\n        \r\n        Widget.initCreator.call(this);\r\n    };\r\n\r\n    return InfoControlWidget;\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/element', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, helperMissing=helpers.helperMissing, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1);\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \">\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1);\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.body), {hash:{},inverse:self.program(4, program4, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/AssociableHotspot',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'associableHotspot',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/Gap',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'gap',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/choices/gapImg', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, helperMissing=helpers.helperMissing, self=this, functionType=\"function\";\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\n  buffer += \"<gapImg\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n    \";\n  if (helper = helpers.renderedObject) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.renderedObject); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</gapImg>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/GapImg',['tpl!taoQtiItem/qtiXmlRenderer/tpl/choices/gapImg'], function(tpl){\r\n    return {\r\n        qtiClass : 'gapImg',\r\n        template : tpl,\r\n        getData:function(gapImg, data){\r\n            data.renderedObject = gapImg.object.render(this);\r\n            return data;\r\n        }\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/GapText',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'gapText',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/HotspotChoice',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'hotspotChoice',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/Hottext',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'hottext',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/InlineChoice',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'inlineChoice',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/SimpleAssociableChoice',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'simpleAssociableChoice',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/choices/SimpleChoice',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'simpleChoice',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/container', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, helper, functionType=\"function\";\n\n\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/Container',['tpl!taoQtiItem/qtiXmlRenderer/tpl/container'], function(tpl){\r\n    \r\n    var xhtmlEntities = function(html){\r\n        //@todo : check other names entities\r\n        return html.replace(/&nbsp;/g, '&#160;');\r\n    };\r\n    \r\n    var xhtmlEncode = function(encodedStr){\r\n\r\n        var returnValue = '';\r\n\r\n        if(encodedStr){\r\n            \r\n            //<br...> are replaced by <br... />\r\n            returnValue = encodedStr;\r\n            returnValue = returnValue.replace(/<br([^>]*)?>/ig, '<br />');\r\n            returnValue = returnValue.replace(/<hr([^>]*)?>/ig, '<hr />');\r\n\r\n            //<img...> are replaced by <img... />\r\n            returnValue = returnValue.replace(/(<img([^>]*)?\\s?[^\\/]>)+/ig,\r\n                function($0, $1){\r\n                    return $0.replace('>', ' />');\r\n                });\r\n        }\r\n\r\n        return returnValue;\r\n    };\r\n    \r\n    return {\r\n        qtiClass : '_container',\r\n        template : tpl,\r\n        getData:function(container, data){\r\n            \r\n            data.body = xhtmlEntities(data.body);\r\n            data.body = xhtmlEncode(data.body);\r\n            \r\n            return data;\r\n        }\r\n    };\r\n});\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2013 (original work) Open Assessment Technologies SA\r\n */\r\ndefine('taoQtiItem/qtiXmlRenderer/renderers/feedbacks/ModalFeedback',['lodash', 'tpl!taoQtiItem/qtiXmlRenderer/tpl/element', 'taoQtiItem/qtiItem/helper/container'], function(_, tpl, containerHelper){\r\n    'use strict';\r\n    \r\n    function encodeOutcomeInfo(fb){\r\n        var relatedResponse = fb.data('relatedResponse');\r\n        if(relatedResponse && relatedResponse.attr('identifier')){\r\n            //encode the related outcome into a css class\r\n            containerHelper.setEncodedData(fb, 'relatedOutcome', relatedResponse.attr('identifier'));\r\n        }\r\n    }\r\n    \r\n    return {\r\n        qtiClass : 'modalFeedback',\r\n        template : tpl,\r\n        getData : function getData(fb, data){\r\n            \r\n            encodeOutcomeInfo(fb);\r\n            data.body = fb.getBody().render(this);\r\n            data.attributes.title = _.escape(data.attributes.title);\r\n            return data;\r\n        }\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/Img',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'img',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/include', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, helperMissing=helpers.helperMissing, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\n  buffer += \"<\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1);\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/Include',['tpl!taoQtiItem/qtiXmlRenderer/tpl/include'], function(tpl){\r\n    return {\r\n        qtiClass : 'include',\r\n        template : tpl,\r\n        getData : function(xi, data){\r\n\r\n            var ns = xi.getNamespace();\r\n\r\n            if(ns && ns.name){\r\n                data.tag = ns.name + ':include';\r\n            }\r\n\r\n            return data;\r\n        }\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.object) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.object); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program9(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1);\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.object), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  options={hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.body), {hash:{},inverse:self.noop,fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \">\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/AssociateInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'associateInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/ChoiceInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'choiceInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/EndAttemptInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'endAttemptInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/ExtendedTextInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'extendedTextInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/GapMatchInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'gapMatchInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/GraphicAssociateInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'graphicAssociateInteraction',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/graphicGapMatchInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, functionType=\"function\", self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<graphicGapMatchInteraction\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  if (helper = helpers.object) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.object); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  options={hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}\n  if (helper = helpers.gapImgs) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.gapImgs); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.gapImgs) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  options={hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</graphicGapMatchInteraction>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/GraphicGapMatchInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/graphicGapMatchInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'graphicGapMatchInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/GraphicOrderInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'graphicOrderInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/HotspotInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'hotspotInteraction',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/hottextInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, helperMissing=helpers.helperMissing, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1);\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.body), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \">\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/HottextInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/hottextInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'hottextInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/InlineChoiceInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'inlineChoiceInteraction',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/matchInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1);\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    <simpleMatchSet>\\r\\n        \";\n  options={hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}\n  if (helper = helpers.matchSet1) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.matchSet1); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.matchSet1) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </simpleMatchSet>\\r\\n    <simpleMatchSet>\\r\\n        \";\n  options={hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}\n  if (helper = helpers.matchSet2) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.matchSet2); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.matchSet2) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </simpleMatchSet>\\r\\n</\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \">\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/MatchInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/matchInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'matchInteraction',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/mediaInteraction', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.prompt) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.prompt); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program5(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program7(depth0,data) {\n  \n  var stack1, helper;\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1);\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.prompt), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  if (helper = helpers.object) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.object); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  options={hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}\n  if (helper = helpers.choices) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.choices); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.choices) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.body), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</\";\n  if (helper = helpers.tag) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tag); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \">\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/MediaInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/mediaInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'mediaInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/OrderInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'orderInteraction',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/portableCustomInteraction/main', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n                <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth1 && depth1.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"lib id=\\\"\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\"/>\\r\\n                \";\n  return buffer;\n  }\n\n  buffer += \"<customInteraction \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n    <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"portableCustomInteraction customInteractionTypeIdentifier=\\\"\";\n  if (helper = helpers.typeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.typeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" hook=\\\"\";\n  if (helper = helpers.entryPoint) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.entryPoint); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n\\r\\n        <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"responseSchema href=\\\"http://imsglobal.org/schema/json/v1.0/response.json\\\"/>\\r\\n\\r\\n        <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"resources location=\\\"http://imsglobal.org/pci/1.0.15/sharedLibraries.xml\\\">\\r\\n            <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"libraries>\\r\\n                \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.libraries), {hash:{},inverse:self.noop,fn:self.programWithDepth(1, program1, data, depth0),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n            </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"libraries>\\r\\n        </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"resources>\\r\\n\\r\\n        \";\n  stack1 = (helper = helpers.portableElementProperties || (depth0 && depth0.portableElementProperties),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.properties), ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci), options) : helperMissing.call(depth0, \"portableElementProperties\", (depth0 && depth0.properties), ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci), options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\\r\\n        <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"markup>\\r\\n            \";\n  if (helper = helpers.markup) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.markup); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"markup>\\r\\n\\r\\n    </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pci)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"portableCustomInteraction>\\r\\n</customInteraction>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/portableCustomInteraction/properties', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \" key=\\\"\";\n  if (helper = helpers.key) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.key); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program3(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1;\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.key), {hash:{},inverse:self.program(6, program6, data),fn:self.programWithDepth(4, program4, data, depth1),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\nfunction program4(depth0,data,depth2) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<\"\n    + escapeExpression(((stack1 = (depth2 && depth2.ns)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"entry key=\\\"\";\n  if (helper = helpers.key) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.key); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</\"\n    + escapeExpression(((stack1 = (depth2 && depth2.ns)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"entry>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program6(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            \";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\n  buffer += \"<\";\n  if (helper = helpers.ns) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.ns); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"properties\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.key), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.entries), {hash:{},inverse:self.noop,fn:self.programWithDepth(3, program3, data, depth0),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</\";\n  if (helper = helpers.ns) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.ns); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"properties>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/helper/portableElementTpl',[\r\n    'lodash',\r\n    'handlebars',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/portableCustomInteraction/properties'\r\n], function(_, Handlebars, propertiesTpl){\r\n    \r\n    function renderPortableElementProperties(properties, ns, name){\r\n\r\n        var entries = [];\r\n\r\n        _.forIn(properties, function(value, key){\r\n            if(_.isObject(value)){\r\n                entries.push({\r\n                    value : renderPortableElementProperties(value, ns, key)\r\n                });\r\n            }else{\r\n                entries.push({\r\n                    key : key,\r\n                    value : value\r\n                });\r\n            }\r\n        });\r\n        \r\n        return propertiesTpl({\r\n            entries : entries,\r\n            ns : ns,\r\n            key : name\r\n        });\r\n    }\r\n\r\n    //register the pci properties helper:\r\n    Handlebars.registerHelper('portableElementProperties', function(properties, ns){\r\n        return renderPortableElementProperties(properties, ns, '');\r\n    });\r\n    \r\n});\r\n\r\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/PortableCustomInteraction',[\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/portableCustomInteraction/main',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/qtiXmlRenderer/helper/portableElementTpl'\r\n], function(tpl, util){\r\n\r\n    return {\r\n        qtiClass : 'customInteraction',\r\n        template : tpl,\r\n        getData : function(interaction, data){\r\n            var markupNs = interaction.getMarkupNamespace();\r\n            data.markup = util.addMarkupNamespace(interaction.markup, markupNs ? markupNs.name : '');\r\n            return data;\r\n        }\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/Prompt',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'prompt',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/SelectPointInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'selectPointInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/SliderInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'sliderInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/TextEntryInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'textEntryInteraction',\r\n        template : tpl\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/interactions/UploadInteraction',['tpl!taoQtiItem/qtiXmlRenderer/tpl/interactions/blockInteraction'], function(tpl){\r\n    return {\r\n        qtiClass : 'uploadInteraction',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/item', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, helperMissing=helpers.helperMissing, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  stack1 = helpers['if'].call(depth0, (data == null || data === false ? data : data.key), {hash:{},inverse:self.program(4, program4, data),fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"xmlns:\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"=\\\"\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\";\n  buffer += \"xmlns=\\\"\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program6(depth0,data) {\n  \n  var stack1, helper, options;\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n        \";\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program10(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \" class=\\\"\";\n  if (helper = helpers['class']) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0['class']); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program12(depth0,data) {\n  \n  \n  return \"\\r\\n            <div class=\\\"empty\\\"></div>\\r\\n        \";\n  }\n\nfunction program14(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            \";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  return buffer;\n  }\n\nfunction program16(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  buffer += \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\r\\n<assessmentItem \\r\\n    \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.namespaces), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  if (helper = helpers.xsi) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.xsi); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"schemaLocation=\\\"\";\n  if (helper = helpers.schemaLocations) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.schemaLocations); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  options={hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data}\n  if (helper = helpers.responses) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.responses); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.responses) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  options={hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data}\n  if (helper = helpers.outcomes) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.outcomes); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.outcomes) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  options={hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data}\n  if (helper = helpers.stylesheets) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.stylesheets); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.stylesheets) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \\r\\n    <itemBody\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0['class']), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.empty), {hash:{},inverse:self.program(14, program14, data),fn:self.program(12, program12, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </itemBody>\\r\\n    \\r\\n    \";\n  if (helper = helpers.responseProcessing) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseProcessing); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  options={hash:{},inverse:self.noop,fn:self.program(16, program16, data),data:data}\n  if (helper = helpers.feedbacks) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.feedbacks); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.feedbacks) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(16, program16, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \\r\\n    \";\n  if (helper = helpers.apipAccessibility) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.apipAccessibility); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</assessmentItem>\\r\\n\";\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2015 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\n\r\ndefine('taoQtiItem/qtiXmlRenderer/renderers/Item',['lodash', 'tpl!taoQtiItem/qtiXmlRenderer/tpl/item'], function(_, tpl){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'assessmentItem',\r\n        template : tpl,\r\n        getData : function(item, data){\r\n            \r\n            var self = this;\r\n            var defaultData = {\r\n                'class' : data.attributes.class || '',\r\n                responses : [],\r\n                outcomes : [],\r\n                stylesheets : [],\r\n                feedbacks : [],\r\n                namespaces : item.getNamespaces(),\r\n                schemaLocations : '',\r\n                xsi: 'xsi:',//the standard namespace prefix for xml schema\r\n                empty : item.isEmpty(),\r\n                responseProcessing : item.responseProcessing ? item.responseProcessing.render(self) : '',\r\n                apipAccessibility : item.getApipAccessibility() || ''\r\n            };\r\n            \r\n            _.forIn(item.getSchemaLocations(), function(url, uri){\r\n                defaultData.schemaLocations += uri+' '+url+' ';\r\n            });\r\n            defaultData.schemaLocations = defaultData.schemaLocations.trim();\r\n            \r\n            _.forEach(item.responses, function(response){\r\n                defaultData.responses.push(response.render(self));\r\n            });\r\n            _.forEach(item.outcomes, function(outcome){\r\n                if(!defaultData.responseProcessing && outcome.id() === 'SCORE'){\r\n                    //should not export the SCORE outcome when there is no response processing\r\n                    return;\r\n                }\r\n                defaultData.outcomes.push(outcome.render(self));\r\n            });\r\n            _.forEach(item.stylesheets, function(stylesheet){\r\n                defaultData.stylesheets.push(stylesheet.render(self));\r\n            });\r\n            _.forEach(item.modalFeedbacks, function(feedback){\r\n                defaultData.feedbacks.push(feedback.render(self));\r\n            });\r\n            \r\n            data = _.merge({}, data || {}, defaultData);\r\n            delete data.attributes.class;\r\n            \r\n            data.attributes.title = _.escape(data.attributes.title);\r\n            \r\n            return data;\r\n        }\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/Math',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'math',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/object', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, helperMissing=helpers.helperMissing, self=this, functionType=\"function\";\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<object\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</object>\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"<object\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" />\";\n  return buffer;\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.body), {hash:{},inverse:self.program(4, program4, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014 (original work) Open Assessment Technlogies SA\r\n */\r\ndefine('taoQtiItem/qtiXmlRenderer/renderers/Object',['tpl!taoQtiItem/qtiXmlRenderer/tpl/object'], function(tpl){\r\n    'use strict';\r\n    return {\r\n        qtiClass : 'object',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/outcomeDeclaration', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helperMissing=helpers.helperMissing, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"/>\\r\\n\";\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \">\\r\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.defaultValue)),stack1 == null || stack1 === false ? stack1 : stack1.length), {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</outcomeDeclaration>\";\n  return buffer;\n  }\nfunction program6(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"<defaultValue>\\r\\n        \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.defaultValue), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</defaultValue>\\r\\n    \";\n  return buffer;\n  }\nfunction program7(depth0,data) {\n  \n  var buffer = \"\";\n  buffer += \"<value>\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"</value>\\r\\n        \";\n  return buffer;\n  }\n\n  buffer += \"\\r\\n<outcomeDeclaration\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.empty), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  });\n});\n\n","/*\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2014-2017 (original work) Open Assessment Technologies SA;\r\n *\r\n */\r\ndefine('taoQtiItem/qtiXmlRenderer/renderers/OutcomeDeclaration',['lodash', 'tpl!taoQtiItem/qtiXmlRenderer/tpl/outcomeDeclaration'], function(_, tpl){\r\n    'use strict';\r\n    return {\r\n        qtiClass : 'outcomeDeclaration',\r\n        template : tpl,\r\n        getData:function(outcomeDeclaration, data){\r\n            var defaultData,\r\n                defaultValue = [];\r\n\r\n            if(!_.isUndefined(outcomeDeclaration.defaultValue)){\r\n                if(typeof(outcomeDeclaration.defaultValue) === 'object'){\r\n                    defaultValue = _.values(outcomeDeclaration.defaultValue);\r\n                }else{\r\n                    defaultValue = [outcomeDeclaration.defaultValue];\r\n                }\r\n            }\r\n            defaultData = {\r\n                empty: !_.size(defaultValue),\r\n                defaultValue: defaultValue\r\n            };\r\n\r\n            return _.merge(data || {}, defaultData);\r\n        }\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/portableInfoControl', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n                <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth1 && depth1.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"lib id=\\\"\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\"/>\\r\\n                \";\n  return buffer;\n  }\n\n  buffer += \"<infoControl \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\\r\\n    <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"portableInfoControl infoControlTypeIdentifier=\\\"\";\n  if (helper = helpers.typeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.typeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" hook=\\\"\";\n  if (helper = helpers.entryPoint) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.entryPoint); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n\\r\\n        <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"resources location=\\\"http://imsglobal.org/pci/1.0.15/sharedLibraries.xml\\\">\\r\\n            <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"libraries>\\r\\n                \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.libraries), {hash:{},inverse:self.noop,fn:self.programWithDepth(1, program1, data, depth0),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n            </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"libraries>\\r\\n        </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"resources>\\r\\n\\r\\n        \";\n  stack1 = (helper = helpers.portableElementProperties || (depth0 && depth0.portableElementProperties),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.properties), ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic), options) : helperMissing.call(depth0, \"portableElementProperties\", (depth0 && depth0.properties), ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic), options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\\r\\n        <\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"markup>\\r\\n            \";\n  if (helper = helpers.markup) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.markup); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"markup>\\r\\n\\r\\n    </\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.ns)),stack1 == null || stack1 === false ? stack1 : stack1.pic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"portableInfoControl>\\r\\n</infoControl>\";\n  return buffer;\n  });\n});\n\n","\r\ndefine('taoQtiItem/qtiXmlRenderer/renderers/PortableInfoControl',[\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/portableInfoControl',\r\n    'taoQtiItem/qtiItem/helper/util',\r\n    'taoQtiItem/qtiXmlRenderer/helper/portableElementTpl'\r\n], function(tpl, util){\r\n    'use strict';\r\n\r\n    return {\r\n        qtiClass : 'infoControl',\r\n        template : tpl,\r\n        getData : function(infoControl, data){\r\n            var markupNs = infoControl.getMarkupNamespace();\r\n            data.markup = util.addMarkupNamespace(infoControl.markup, markupNs ? markupNs.name : '');\r\n\r\n            //ensure infoControl have an id, otherwise generate one in order to be able to identify it for the state\r\n            if(!infoControl.attr('id')){\r\n                infoControl.attr('id', util.buildId(infoControl.getRelatedItem(), infoControl.typeIdentifier ));\r\n            }\r\n\r\n            return data;\r\n        }\r\n    };\r\n});\r\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responseDeclaration', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, functionType=\"function\", self=this, escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"/>\";\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \">\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.defaultValue)),stack1 == null || stack1 === false ? stack1 : stack1.length), {hash:{},inverse:self.noop,fn:self.program(4, program4, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.correctResponse)),stack1 == null || stack1 === false ? stack1 : stack1.length), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.isAreaMapping), {hash:{},inverse:self.program(18, program18, data),fn:self.program(12, program12, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </responseDeclaration>\";\n  return buffer;\n  }\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n    <defaultValue>\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.defaultValue), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </defaultValue>\\r\\n    \";\n  return buffer;\n  }\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n        <value><![CDATA[\";\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"]]></value>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n    <correctResponse>\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.correctResponse), {hash:{},inverse:self.noop,fn:self.programWithDepth(8, program8, data, depth0),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    </correctResponse>\\r\\n    \";\n  return buffer;\n  }\nfunction program8(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1;\n  stack1 = helpers['if'].call(depth0, (depth1 && depth1.isRecord), {hash:{},inverse:self.program(5, program5, data),fn:self.program(9, program9, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\nfunction program9(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.value), {hash:{},inverse:self.noop,fn:self.program(10, program10, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        \";\n  return buffer;\n  }\nfunction program10(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n        <value fieldIdentifier=\\\"\";\n  if (helper = helpers.fieldIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.fieldIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" baseType=\\\"\";\n  if (helper = helpers.baseType) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.baseType); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"><![CDATA[\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"]]></value>\\r\\n        \";\n  return buffer;\n  }\n\nfunction program12(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.hasMapEntries), {hash:{},inverse:self.noop,fn:self.program(13, program13, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\nfunction program13(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"<areaMapping\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.mappingAttributes), {hash:{},inverse:self.noop,fn:self.program(14, program14, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.mapEntries), {hash:{},inverse:self.noop,fn:self.program(16, program16, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </areaMapping>\\r\\n        \";\n  return buffer;\n  }\nfunction program14(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \" \"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"=\\\"\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\"\";\n  return buffer;\n  }\n\nfunction program16(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            <areaMapEntry shape=\\\"\";\n  if (helper = helpers.shape) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.shape); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" coords=\\\"\";\n  if (helper = helpers.coords) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.coords); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" mappedValue=\\\"\";\n  if (helper = helpers.mappedValue) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.mappedValue); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\";\n  return buffer;\n  }\n\nfunction program18(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.hasMapEntries), {hash:{},inverse:self.noop,fn:self.program(19, program19, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  return buffer;\n  }\nfunction program19(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"<mapping\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.mappingAttributes), {hash:{},inverse:self.noop,fn:self.program(14, program14, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.mapEntries), {hash:{},inverse:self.noop,fn:self.program(20, program20, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </mapping>\\r\\n        \";\n  return buffer;\n  }\nfunction program20(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            <mapEntry mapKey=\\\"\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" mappedValue=\\\"\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"\\\" caseSensitive=\\\"false\\\"/>\";\n  return buffer;\n  }\n\n  buffer += \"<responseDeclaration \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.empty), {hash:{},inverse:self.program(3, program3, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/ResponseDeclaration',['lodash', 'tpl!taoQtiItem/qtiXmlRenderer/tpl/responseDeclaration'], function(_, tpl){\r\n    return {\r\n        qtiClass : 'responseDeclaration',\r\n        template : tpl,\r\n        getData : function(responseDeclaration, data){\r\n            var defaultData = {\r\n                empty : !_.size(responseDeclaration.mapEntries) && !_.size(responseDeclaration.correctResponse) && !_.size(responseDeclaration.defaultValue),\r\n                correctResponse : _.values(responseDeclaration.correctResponse),\r\n                isAreaMapping : (responseDeclaration.attributes.baseType === \"point\"),\r\n                mappingAttributes : responseDeclaration.mappingAttributes,\r\n                hasMapEntries : _.size(responseDeclaration.mapEntries),\r\n                mapEntries : responseDeclaration.mapEntries,\r\n                defaultValue : responseDeclaration.defaultValue,\r\n                isRecord : responseDeclaration.attributes.cardinality === 'record'\r\n            };\r\n\r\n            return _.merge(defaultData, data || {});\r\n        }\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responseProcessing', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this, blockHelperMissing=helpers.blockHelperMissing;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  if (helper = helpers.xml) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.xml); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"<responseProcessing template=\\\"\";\n  if (helper = helpers.template) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.template); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\"/>\";\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"<responseProcessing>\\r\\n    \";\n  options={hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data}\n  if (helper = helpers.responseRules) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.responseRules); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.responseRules) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n    \";\n  options={hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data}\n  if (helper = helpers.feedbackRules) { stack1 = helper.call(depth0, options); }\n  else { helper = (depth0 && depth0.feedbackRules); stack1 = typeof helper === functionType ? helper.call(depth0, options) : helper; }\n  if (!helpers.feedbackRules) { stack1 = blockHelperMissing.call(depth0, stack1, {hash:{},inverse:self.noop,fn:self.program(6, program6, data),data:data}); }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</responseProcessing>\";\n  return buffer;\n  }\nfunction program6(depth0,data) {\n  \n  var stack1;\n  stack1 = (typeof depth0 === functionType ? depth0.apply(depth0) : depth0);\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  }\n\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.custom), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.template), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.templateDriven), {hash:{},inverse:self.noop,fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/match_correct', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<responseCondition>\\r\\n    <responseIf>\\r\\n        <match>\\r\\n            <variable identifier=\\\"\";\n  if (helper = helpers.responseIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            <correct identifier=\\\"\";\n  if (helper = helpers.responseIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n        </match>\\r\\n        <setOutcomeValue identifier=\\\"\";\n  if (helper = helpers.outcomeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.outcomeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n            <sum>\\r\\n                <variable identifier=\\\"\";\n  if (helper = helpers.outcomeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.outcomeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n                <baseValue baseType=\\\"integer\\\">1</baseValue>\\r\\n            </sum>\\r\\n        </setOutcomeValue>\\r\\n    </responseIf>\\r\\n</responseCondition>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/map_response', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<responseCondition>\\r\\n    <responseIf>\\r\\n        <not>\\r\\n            <isNull>\\r\\n                <variable identifier=\\\"\";\n  if (helper = helpers.responseIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            </isNull>\\r\\n        </not>\\r\\n        <setOutcomeValue identifier=\\\"\";\n  if (helper = helpers.outcomeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.outcomeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n            <sum>\\r\\n                <variable identifier=\\\"\";\n  if (helper = helpers.outcomeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.outcomeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n                <mapResponse identifier=\\\"\";\n  if (helper = helpers.responseIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            </sum>\\r\\n        </setOutcomeValue>\\r\\n    </responseIf>\\r\\n</responseCondition>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/map_response_point', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression;\n\n\n  buffer += \"<responseCondition>\\r\\n    <responseIf>\\r\\n        <not>\\r\\n            <isNull>\\r\\n                <variable identifier=\\\"\";\n  if (helper = helpers.responseIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            </isNull>\\r\\n        </not>\\r\\n        <setOutcomeValue identifier=\\\"\";\n  if (helper = helpers.outcomeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.outcomeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\\r\\n            <sum>\\r\\n                <variable identifier=\\\"\";\n  if (helper = helpers.outcomeIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.outcomeIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n                <mapResponsePoint identifier=\\\"\";\n  if (helper = helpers.responseIdentifier) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.responseIdentifier); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            </sum>\\r\\n        </setOutcomeValue>\\r\\n    </responseIf>\\r\\n</responseCondition>\";\n  return buffer;\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/ResponseProcessing',[\r\n    'lodash',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responseProcessing',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/match_correct',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/map_response',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/map_response_point'\r\n], function(_, tpl, correctTpl, mapTpl, mapPointTpl){\r\n    'use strict';\r\n\r\n    var _renderRpTpl = function _renderRpTpl(rpTpl, data){\r\n\r\n        var ret = '';\r\n\r\n        switch(rpTpl){\r\n            case 'http://www.imsglobal.org/question/qti_v2p1/rptemplates/match_correct':\r\n            case 'MATCH_CORRECT':\r\n                ret = correctTpl(data);\r\n                break;\r\n            case 'http://www.imsglobal.org/question/qti_v2p1/rptemplates/map_response':\r\n            case 'MAP_RESPONSE':\r\n                ret = mapTpl(data);\r\n                break;\r\n            case 'http://www.imsglobal.org/question/qti_v2p1/rptemplates/map_response_point':\r\n            case 'MAP_RESPONSE_POINT':\r\n                ret = mapPointTpl(data);\r\n                break;\r\n            case 'no_response_processing':\r\n            case 'NONE':\r\n                ret = '';\r\n                break;\r\n            default:\r\n                throw new Error('unknown rp template : ' + rpTpl);\r\n        }\r\n\r\n        return ret;\r\n    };\r\n\r\n    var _renderInteractionRp = function _renderInteractionRp(interaction){\r\n        var ret = '',\r\n            response = interaction.getResponseDeclaration();\r\n        if(response.template){\r\n            ret = _renderRpTpl(response.template, {\r\n                responseIdentifier : response.id(),\r\n                outcomeIdentifier : 'SCORE'\r\n            });\r\n        }\r\n        return ret;\r\n    };\r\n    \r\n    var _renderFeedbackRules = function _renderFeedbackRules(renderer, response){\r\n        var ret = [];\r\n        _.forEach(response.getFeedbackRules(), function(rule){\r\n            ret.push(rule.render(renderer));\r\n        });\r\n        return ret;\r\n    };\r\n    \r\n    return {\r\n        qtiClass : 'responseProcessing',\r\n        template : tpl,\r\n        getData : function(responseProcessing, data){\r\n            var defaultData = {},\r\n                self = this,\r\n                interactions, response;\r\n            \r\n            switch(responseProcessing.processingType){\r\n                case 'custom':\r\n                    defaultData.custom = true;\r\n                    defaultData.xml = responseProcessing.xml;\r\n                    break;\r\n                case 'templateDriven':\r\n                    interactions = responseProcessing.getRelatedItem().getInteractions();\r\n                    if(interactions.length === 1){\r\n                        response = interactions[0].getResponseDeclaration();\r\n                        if(_.size(response.getFeedbackRules()) === 0 && response.id() === 'RESPONSE'){\r\n                            if(response.template !== 'no_response_processing'){\r\n                                //the exact condition to serialize the rp as a standard template is met\r\n                                defaultData.template = response.template;\r\n                            }\r\n                            break;\r\n                        }\r\n                    }\r\n\r\n                    defaultData.responseRules = [];\r\n                    _.forEach(interactions, function(interaction){\r\n                        var responseRule = _renderInteractionRp(interaction);\r\n                        if(_.isString(responseRule) && responseRule.trim()){\r\n                            defaultData.responseRules.push(responseRule);\r\n                        }\r\n                    });\r\n                    \r\n                    defaultData.feedbackRules = [];\r\n                    _.forEach(interactions, function(interaction){\r\n                        defaultData.feedbackRules = _.union(defaultData.feedbackRules, _renderFeedbackRules(self, interaction.getResponseDeclaration()));\r\n                    });\r\n\r\n                    if(defaultData.responseRules.length || defaultData.feedbackRules.length){\r\n                        defaultData.templateDriven = true;\r\n                    }\r\n\r\n                    break;\r\n            }\r\n\r\n            return _.merge(data || {}, defaultData);\r\n        }\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, helper, functionType=\"function\";\n\n\n  if (helper = helpers.rule) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.rule); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_condition', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.mapResponsePoint), {hash:{},inverse:self.program(4, program4, data),fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            <mapResponsePoint identifier=\\\"\";\n  if (helper = helpers.response) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.response); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\";\n  return buffer;\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            <mapResponse identifier=\\\"\";\n  if (helper = helpers.response) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.response); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\";\n  return buffer;\n  }\n\nfunction program6(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            <variable identifier=\\\"\";\n  if (helper = helpers.outcome) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.outcome); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\";\n  return buffer;\n  }\n\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n    <responseElse>\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseElse>\";\n  return buffer;\n  }\n\n  buffer += \"<responseCondition>\\r\\n    <responseIf>\\r\\n        <\";\n  if (helper = helpers.condition) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.condition); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \">\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.response), {hash:{},inverse:self.program(6, program6, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n            <baseValue baseType=\\\"float\\\">\";\n  if (helper = helpers.comparedValue) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.comparedValue); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</baseValue>\\r\\n        </\";\n  if (helper = helpers.condition) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.condition); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \">\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.then)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseIf>\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else']), {hash:{},inverse:self.noop,fn:self.program(8, program8, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</responseCondition>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_correct', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n    <responseElse>\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseElse>\";\n  return buffer;\n  }\n\n  buffer += \"<responseCondition>\\r\\n    <responseIf>\\r\\n        <match>\\r\\n            <variable identifier=\\\"\";\n  if (helper = helpers.response) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.response); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            <correct identifier=\\\"\";\n  if (helper = helpers.response) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.response); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n        </match>\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.then)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseIf>\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else']), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</responseCondition>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_incorrect', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n    <responseElse>\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseElse>\";\n  return buffer;\n  }\n\n  buffer += \"<responseCondition>\\r\\n    <responseIf>\\r\\n        <not>\\r\\n            <match>\\r\\n                <variable identifier=\\\"\";\n  if (helper = helpers.response) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.response); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n                <correct identifier=\\\"\";\n  if (helper = helpers.response) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.response); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            </match>\\r\\n        </not>\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.then)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseIf>\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else']), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</responseCondition>\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_choices', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n<responseCondition>\\r\\n    <responseIf>\\r\\n        <match>\\r\\n            <variable identifier=\\\"\";\n  if (helper = helpers.response) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.response); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" />\\r\\n            \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.multiple), {hash:{},inverse:self.program(5, program5, data),fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n        </match>\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.then)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseIf>\";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else']), {hash:{},inverse:self.noop,fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n</responseCondition>\\r\\n\";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n            <multiple>\\r\\n                \";\n  stack1 = helpers.each.call(depth0, (depth0 && depth0.choices), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\r\\n            </multiple>\\r\\n            \";\n  return buffer;\n  }\nfunction program3(depth0,data) {\n  \n  var buffer = \"\";\n  buffer += \"\\r\\n                <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression((typeof depth0 === functionType ? depth0.apply(depth0) : depth0))\n    + \"</baseValue>\\r\\n                \";\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\r\\n            <baseValue baseType=\\\"identifier\\\">\";\n  if (helper = helpers.choice) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.choice); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</baseValue>\\r\\n            \";\n  return buffer;\n  }\n\nfunction program7(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\r\\n    <responseElse>\\r\\n        <setOutcomeValue identifier=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1.outcome)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\r\\n            <baseValue baseType=\\\"identifier\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = (depth0 && depth0.feedback)),stack1 == null || stack1 === false ? stack1 : stack1['else'])),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</baseValue>\\r\\n        </setOutcomeValue>\\r\\n    </responseElse>\";\n  return buffer;\n  }\n\n  stack1 = helpers.unless.call(depth0, (depth0 && depth0.noData), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { return stack1; }\n  else { return ''; }\n  });\n});\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/responses/SimpleFeedbackRule',[\r\n    'lodash',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_condition',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_correct',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_incorrect',\r\n    'tpl!taoQtiItem/qtiXmlRenderer/tpl/responses/rule_choices'\r\n], function(_, tpl, tplCondition, tplCorrect, tplIncorrect, tplChoices){\r\n    return {\r\n        qtiClass : '_simpleFeedbackRule',\r\n        template : tpl,\r\n        getData : function(rule, data){\r\n            \r\n            var template = null, ruleXml = '';\r\n            var _values;\r\n            var tplData = {\r\n                response : rule.comparedOutcome.id(),\r\n                feedback : {\r\n                    'outcome' : rule.feedbackOutcome.id(),\r\n                    'then' : rule.feedbackThen.id(),\r\n                    'else' : rule.feedbackElse ? rule.feedbackElse.id() : ''\r\n                }\r\n            };\r\n\r\n            switch(rule.condition){\r\n                case 'correct':\r\n                    template = tplCorrect;\r\n                    break;\r\n                case 'incorrect':\r\n                    template = tplIncorrect;\r\n                    break;\r\n                case 'lt':\r\n                case 'lte':\r\n                case 'equal':\r\n                case 'gte':\r\n                case 'gt':\r\n                    template = tplCondition;\r\n                    tplData.condition = rule.condition;\r\n                    tplData.comparedValue = rule.comparedValue;\r\n                    break;\r\n                case 'choices':\r\n                    template = tplChoices;\r\n                    tplData.condition = rule.condition;\r\n                    tplData.multiple = rule.comparedOutcome.isCardinality(['multiple', 'ordered']);\r\n                    _values = [];\r\n                    _.each(rule.comparedValue, function(choice){\r\n                        //check if all the selected choices still exist\r\n                        if(choice.parent()){\r\n                            _values.push(choice.id());\r\n                        }\r\n                    });\r\n                    \r\n                    if(tplData.multiple){\r\n                        tplData.choices = _values;\r\n                    }else{\r\n                        if(_values.length){\r\n                            tplData.choice = _.head(_values);\r\n                        }else{\r\n                            tplData.noData = true;\r\n                        }\r\n                    }\r\n                    break;\r\n                default:\r\n                    throw new Error('unknown condition in simple feedback rule rendering : '+rule.condition);\r\n            }\r\n\r\n            if(template){\r\n                ruleXml = template(tplData);\r\n            }\r\n\r\n            return _.merge(data || {}, {rule : ruleXml});\r\n        }\r\n    };\r\n});\r\n\n","define('taoQtiItem/qtiXmlRenderer/renderers/RubricBlock',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element', 'lodash'], function(tpl, _){\r\n    return {\r\n        qtiClass : 'rubricBlock',\r\n        template : tpl,\r\n        getData : function(rubricBlock, data){\r\n            var newData = {\r\n                view : data.attributes.view ? _.values(data.attributes.view).join(' ') : ''\r\n            };\r\n            return _.merge(data || {}, newData);\r\n        }\r\n    };\r\n});\n","define('taoQtiItem/qtiXmlRenderer/renderers/Stylesheet',['tpl!taoQtiItem/qtiXmlRenderer/tpl/element'], function(tpl){\r\n    return {\r\n        qtiClass : 'stylesheet',\r\n        template : tpl\r\n    };\r\n});\n","\ndefine('tpl!taoQtiItem/qtiXmlRenderer/tpl/table', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, helperMissing=helpers.helperMissing, self=this, functionType=\"function\";\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \" \";\n  stack1 = (helper = helpers.join || (depth0 && depth0.join),options={hash:{},data:data},helper ? helper.call(depth0, (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options) : helperMissing.call(depth0, \"join\", (depth0 && depth0.attributes), \"=\", \" \", \"\\\"\", options));\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  return buffer;\n  }\n\n  buffer += \"<table\";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.attributes), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \">\";\n  if (helper = helpers.body) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.body); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</table>\";\n  return buffer;\n  });\n});\n\n","/**\r\n * This program is free software; you can redistribute it and/or\r\n * modify it under the terms of the GNU General Public License\r\n * as published by the Free Software Foundation; under version 2\r\n * of the License (non-upgradable).\r\n *\r\n * This program is distributed in the hope that it will be useful,\r\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n * GNU General Public License for more details.\r\n *\r\n * You should have received a copy of the GNU General Public License\r\n * along with this program; if not, write to the Free Software\r\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n *\r\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA;\r\n */\r\ndefine('taoQtiItem/qtiXmlRenderer/renderers/Table',['tpl!taoQtiItem/qtiXmlRenderer/tpl/table'], function(tpl){\r\n    'use strict';\r\n    return {\r\n        qtiClass : 'table',\r\n        template : tpl\r\n    };\r\n});\n","\n(function(c){var d=document,a='appendChild',i='styleSheet',s=d.createElement('style');s.type='text/css';d.getElementsByTagName('head')[0][a](s);s[i]?s[i].cssText=c:s[a](d.createTextNode(c));})\n('body.preview-mode{height:100vh !important;max-height:100vh;overflow:hidden}body.no-preview-feedback .preview-overlay .preview-container{background:white;overflow:auto}body.no-preview-feedback .preview-overlay .preview-container .preview-item-container,body.no-preview-feedback .preview-overlay .preview-container #preview-container{min-height:calc(100vh - 82px) !important}.preview-overlay{display:none;width:100%;height:100%;z-index:19995;position:absolute;left:0;background:rgba(0,0,0,0.7)}.preview-overlay.preview-desktop{overflow:visible}.preview-overlay.preview-desktop .mobile-only,.preview-overlay.preview-desktop .standard-only{display:none !important}.preview-overlay.preview-mobile{overflow:visible}.preview-overlay.preview-mobile .desktop-only,.preview-overlay.preview-mobile .standard-only{display:none !important}.preview-overlay.preview-standard{overflow:visible}.preview-overlay.preview-standard .desktop-only,.preview-overlay.preview-standard .mobile-only{display:none !important}.preview-overlay .preview-scale-container{position:relative;float:left}.preview-overlay .preview-container{background:white;overflow:auto}.preview-overlay .preview-container .preview-item-container,.preview-overlay .preview-container #preview-container{min-height:calc(100vh - 130px) !important}.preview-overlay .preview-container-outer{display:table;padding:0;width:100%;height:100%}.preview-overlay .preview-utility-bar{background:#f3f1ef;border-bottom:1px solid #8d949e;margin-bottom:20px;z-index:9996;overflow:hidden;padding:10px;position:fixed;top:0;left:0;width:100%}.preview-overlay .preview-utility-bar .preview-heading{min-width:140px}.preview-overlay .preview-utility-bar .device-type-and-orientation{min-width:340px}.preview-overlay .preview-utility-bar-inner{max-width:1024px;width:100%;margin:auto}.preview-overlay .preview-utility-bar-inner h1{font-size:18px;font-size:1.8rem;text-shadow:1px 1px 0px #eee}.preview-overlay .preview-utility-bar-inner .icon-info{top:7px;font-size:15px;font-size:1.5rem}.preview-overlay .preview-utility-bar-inner li{margin-left:10px}.preview-overlay .preview-utility-bar-inner .btn-info{margin-top:1px}.preview-overlay .preview-utility-bar-inner .mobile-device-selector{width:200px}.preview-overlay .preview-utility-bar-inner .preview-type-selector{width:140px}.preview-overlay .preview-utility-bar-inner .preview-theme-selector{width:140px}.preview-overlay .preview-utility-bar-inner .orientation-selector,.preview-overlay .preview-utility-bar-inner .desktop-device-selector{width:130px}.preview-overlay .preview-utility-bar-inner [class*=\\\" col-\\\"],.preview-overlay .preview-utility-bar-inner [class^=\\\"col-\\\"]{margin-bottom:0 !important}.preview-overlay #preview-console{margin:0;padding:0;border:none;z-index:auto;background:#266d9c;position:fixed;bottom:0;left:0;width:100%}.preview-overlay #preview-console .preview-console-closer{position:absolute;right:10px;top:10px;cursor:pointer;color:rgba(255,255,255,0.9);display:none;text-shadow:none}.preview-overlay #preview-console .preview-console-closer:hover{color:white}.preview-overlay #preview-console .preview-console-header{max-width:1024px;width:100%;margin:auto;padding:0}.preview-overlay #preview-console .preview-console-header [class*=\\\" col-\\\"],.preview-overlay #preview-console .preview-console-header [class^=\\\"col-\\\"]{margin-bottom:0 !important}.preview-overlay #preview-console .extra-button-action-bar{overflow:visible}.preview-overlay #preview-console .extra-button-action-bar li{margin:0 5px}.preview-overlay #preview-console .extra-button-action-bar li.btn-info{border-color:rgba(255,255,255,0.3)}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group{border:none !important;overflow:visible;padding:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a{float:left;margin:0 2px;padding:0 15px;border:1px solid rgba(255,255,255,0.3);border-radius:0px;display:inline-block;height:inherit}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:first-of-type{border-top-left-radius:3px;border-bottom-left-radius:3px;margin-left:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:last-of-type{border-top-right-radius:3px;border-bottom-right-radius:3px;margin-right:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a:hover,.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a.active{border-color:rgba(255,255,255,0.8)}.preview-overlay #preview-console .extra-button-action-bar li.btn-info.btn-group a .no-label{padding-right:0}.preview-overlay #preview-console .extra-button-action-bar li.btn-info:hover,.preview-overlay #preview-console .extra-button-action-bar li.btn-info.active{border-color:rgba(255,255,255,0.8)}.preview-overlay #preview-console .extra-button-action-bar.horizontal-action-bar.bottom-action-bar{overflow:visible}.preview-overlay #preview-console .extra-button-action-bar.horizontal-action-bar.bottom-action-bar .action{line-height:1.6}.preview-overlay #preview-console .preview-console-body{display:none}.preview-overlay #preview-console .preview-console-body ul{padding:5px;margin:0;height:300px;overflow:auto;background:#2b2b2b;font-family:Consolas,\\\"Andale Mono WT\\\",\\\"Andale Mono\\\",\\\"Lucida Console\\\",\\\"Lucida Sans Typewriter\\\",\\\"DejaVu Sans Mono\\\",\\\"Bitstream Vera Sans Mono\\\",\\\"Liberation Mono\\\",\\\"Nimbus Mono L\\\",Monaco,\\\"Courier New\\\",Courier,monospace;color:#fff}.preview-overlay #preview-console .preview-console-body ul .log-time{color:#999}.preview-overlay #preview-console .preview-console-body ul .log-type{color:#eee}.preview-overlay #preview-console .preview-console-body ul .log-message{color:#69f}.preview-overlay #preview-console .preview-console-body ul pre{margin:0}.preview-overlay .preview-message-box .feedback-info{margin:10px auto 0px;width:800px}.preview-overlay .preview-message-box a{float:right;padding-right:10px}.preview-overlay .desktop-preview-container{width:1024px;background:#fff url(data:image/gif;base64,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) no-repeat center 150px}.preview-overlay .desktop-preview-frame{position:relative;border:3px #aaa solid;border-radius:5px;background:#5a5a5a;background:linear-gradient(135deg, #5a5a5a 0%, #565656 7%, #444 15%, #141414 30%);box-shadow:5px 5px 10px 0 rgba(0,0,0,0.7)}.preview-overlay .desktop-preview-frame.desktop-preview-landscape{padding:30px 30px}.preview-overlay .desktop-preview-frame.desktop-preview-landscape .desktop-device-toolbar{padding-right:30px}.preview-overlay .desktop-preview-frame.desktop-preview-portrait{padding:30px 30px}.preview-overlay .desktop-preview-frame.desktop-preview-portrait .desktop-device-toolbar{padding-right:30px}.preview-overlay .desktop-preview-item-container{min-height:500px;-webkit-box-shadow:0px 0px 8px #b7b1ac;-moz-box-shadow:0px 0px 8px #b7b1ac;box-shadow:0px 0px 8px #b7b1ac}.preview-overlay .preview-canvas{display:table-cell;text-align:center}.preview-overlay .preview-canvas *{text-align:left}.preview-overlay .preview-outer-frame{position:relative;display:inline-block}.preview-overlay .mobile-preview-container{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box;position:relative}.preview-overlay .mobile-preview-item-container{height:100%}.preview-overlay .mobile-preview-frame{position:relative;border:3px #aaa ridge;border-radius:25px;background:#5a5a5a;background:linear-gradient(135deg, #5a5a5a 0%, #565656 7%, #444 15%, #141414 30%);box-shadow:5px 5px 10px 0 rgba(0,0,0,0.7)}.preview-overlay .mobile-preview-frame.mobile-preview-landscape{padding:40px 40px}.preview-overlay .mobile-preview-frame.mobile-preview-landscape .mobile-device-toolbar{padding-right:40px}.preview-overlay .mobile-preview-frame.mobile-preview-portrait{padding:40px 40px}.preview-overlay .mobile-preview-frame.mobile-preview-portrait .mobile-device-toolbar{padding-right:40px}.preview-overlay .mobile-preview-container{background:white;border-radius:3px;border:2px solid;border-color:#444 #999 #999 #444}.preview-overlay .standard-preview-frame{box-shadow:0px 0px 8px rgba(0,0,0,0.7)}\\r\\n/*# sourceMappingURL=preview.css.map */\\r\\n/*\\r\\n * MathQuill v0.10.1               http://mathquill.com\\r\\n * by Han, Jeanine, and Mary  maintainers@mathquill.com\\r\\n *\\r\\n * This Source Code Form is subject to the terms of the\\r\\n * Mozilla Public License, v. 2.0. If a copy of the MPL\\r\\n * was not distributed with this file, You can obtain\\r\\n * one at http://mozilla.org/MPL/2.0/.\\r\\n */\\r\\n@font-face {\\r\\n  font-family: Symbola;\\r\\n  src: url(font/Symbola.eot);\\r\\n  src: local(\\\"Symbola Regular\\\"), local(\\\"Symbola\\\"), url(font/Symbola.woff2) format(\\\"woff2\\\"), url(font/Symbola.woff) format(\\\"woff\\\"), url(font/Symbola.ttf) format(\\\"truetype\\\"), url(font/Symbola.otf) format(\\\"opentype\\\"), url(font/Symbola.svg#Symbola) format(\\\"svg\\\");\\r\\n}\\r\\n.mq-editable-field {\\r\\n  display: -moz-inline-box;\\r\\n  display: inline-block;\\r\\n}\\r\\n.mq-editable-field .mq-cursor {\\r\\n  border-left: 1px solid black;\\r\\n  margin-left: -1px;\\r\\n  position: relative;\\r\\n  z-index: 1;\\r\\n  padding: 0;\\r\\n  display: -moz-inline-box;\\r\\n  display: inline-block;\\r\\n}\\r\\n.mq-editable-field .mq-cursor.mq-blink {\\r\\n  visibility: hidden;\\r\\n}\\r\\n.mq-editable-field,\\r\\n.mq-math-mode .mq-editable-field {\\r\\n  border: 1px solid gray;\\r\\n}\\r\\n.mq-editable-field.mq-focused,\\r\\n.mq-math-mode .mq-editable-field.mq-focused {\\r\\n  -webkit-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\\r\\n  -moz-box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\\r\\n  box-shadow: #8bd 0 0 1px 2px, inset #6ae 0 0 2px 0;\\r\\n  border-color: #709AC0;\\r\\n  border-radius: 1px;\\r\\n}\\r\\n.mq-math-mode .mq-editable-field {\\r\\n  margin: 1px;\\r\\n}\\r\\n.mq-editable-field .mq-latex-command-input {\\r\\n  color: inherit;\\r\\n  font-family: \\\"Courier New\\\", monospace;\\r\\n  border: 1px solid gray;\\r\\n  padding-right: 1px;\\r\\n  margin-right: 1px;\\r\\n  margin-left: 2px;\\r\\n}\\r\\n.mq-editable-field .mq-latex-command-input.mq-empty {\\r\\n  background: transparent;\\r\\n}\\r\\n.mq-editable-field .mq-latex-command-input.mq-hasCursor {\\r\\n  border-color: ActiveBorder;\\r\\n}\\r\\n.mq-editable-field.mq-empty:after,\\r\\n.mq-editable-field.mq-text-mode:after,\\r\\n.mq-math-mode .mq-empty:after {\\r\\n  visibility: hidden;\\r\\n  content: \\'c\\';\\r\\n}\\r\\n.mq-editable-field .mq-cursor:only-child:after,\\r\\n.mq-editable-field .mq-textarea + .mq-cursor:last-child:after {\\r\\n  visibility: hidden;\\r\\n  content: \\'c\\';\\r\\n}\\r\\n.mq-editable-field .mq-text-mode .mq-cursor:only-child:after {\\r\\n  content: \\'\\';\\r\\n}\\r\\n.mq-editable-field.mq-text-mode {\\r\\n  overflow-x: auto;\\r\\n  overflow-y: hidden;\\r\\n}\\r\\n.mq-root-block,\\r\\n.mq-math-mode .mq-root-block {\\r\\n  display: -moz-inline-box;\\r\\n  display: inline-block;\\r\\n  width: 100%;\\r\\n  padding: 2px;\\r\\n  -webkit-box-sizing: border-box;\\r\\n  -moz-box-sizing: border-box;\\r\\n  box-sizing: border-box;\\r\\n  white-space: nowrap;\\r\\n  overflow: hidden;\\r\\n  vertical-align: middle;\\r\\n}\\r\\n.mq-math-mode {\\r\\n  font-variant: normal;\\r\\n  font-weight: normal;\\r\\n  font-style: normal;\\r\\n  font-size: 115%;\\r\\n  line-height: 1;\\r\\n  display: -moz-inline-box;\\r\\n  display: inline-block;\\r\\n}\\r\\n.mq-math-mode .mq-non-leaf,\\r\\n.mq-math-mode .mq-scaled {\\r\\n  display: -moz-inline-box;\\r\\n  display: inline-block;\\r\\n}\\r\\n.mq-math-mode var,\\r\\n.mq-math-mode .mq-text-mode,\\r\\n.mq-math-mode .mq-nonSymbola {\\r\\n  font-family: \\\"Times New Roman\\\", Symbola, serif;\\r\\n  line-height: .9;\\r\\n}\\r\\n.mq-math-mode * {\\r\\n  font-size: inherit;\\r\\n  line-height: inherit;\\r\\n  margin: 0;\\r\\n  padding: 0;\\r\\n  border-color: black;\\r\\n  -webkit-user-select: none;\\r\\n  -moz-user-select: none;\\r\\n  user-select: none;\\r\\n  box-sizing: border-box;\\r\\n}\\r\\n.mq-math-mode .mq-empty {\\r\\n  background: #ccc;\\r\\n}\\r\\n.mq-math-mode .mq-empty.mq-root-block {\\r\\n  background: transparent;\\r\\n}\\r\\n.mq-math-mode.mq-empty {\\r\\n  background: transparent;\\r\\n}\\r\\n.mq-math-mode .mq-text-mode {\\r\\n  font-size: 87%;\\r\\n}\\r\\n.mq-math-mode .mq-font {\\r\\n  font: 1em \\\"Times New Roman\\\", Symbola, serif;\\r\\n}\\r\\n.mq-math-mode .mq-font * {\\r\\n  font-family: inherit;\\r\\n  font-style: inherit;\\r\\n}\\r\\n.mq-math-mode b,\\r\\n.mq-math-mode b.mq-font {\\r\\n  font-weight: bolder;\\r\\n}\\r\\n.mq-math-mode var,\\r\\n.mq-math-mode i,\\r\\n.mq-math-mode i.mq-font {\\r\\n  font-style: italic;\\r\\n}\\r\\n.mq-math-mode var.mq-f {\\r\\n  margin-right: 0.2em;\\r\\n  margin-left: 0.1em;\\r\\n}\\r\\n.mq-math-mode .mq-roman var.mq-f {\\r\\n  margin: 0;\\r\\n}\\r\\n.mq-math-mode big {\\r\\n  font-size: 125%;\\r\\n}\\r\\n.mq-math-mode .mq-roman {\\r\\n  font-style: normal;\\r\\n}\\r\\n.mq-math-mode .mq-sans-serif {\\r\\n  font-family: sans-serif, Symbola, serif;\\r\\n}\\r\\n.mq-math-mode .mq-monospace {\\r\\n  font-family: monospace, Symbola, serif;\\r\\n}\\r\\n.mq-math-mode .mq-overline {\\r\\n  border-top: 1px solid black;\\r\\n  margin-top: 1px;\\r\\n}\\r\\n.mq-math-mode .mq-underline {\\r\\n  border-bottom: 1px solid black;\\r\\n  margin-bottom: 1px;\\r\\n}\\r\\n.mq-math-mode .mq-binary-operator {\\r\\n  padding: 0 0.2em;\\r\\n  display: -moz-inline-box;\\r\\n  display: inline-block;\\r\\n}\\r\\n.mq-math-mode .mq-supsub {\\r\\n  font-size: 90%;\\r\\n  vertical-align: -0.5em;\\r\\n}\\r\\n.mq-math-mode .mq-supsub.mq-limit {\\r\\n  font-size: 80%;\\r\\n  vertical-align: -0.4em;\\r\\n}\\r\\n.mq-math-mode .mq-supsub.mq-sup-only {\\r\\n  vertical-align: .5em;\\r\\n}\\r\\n.mq-math-mode .mq-supsub.mq-sup-only .mq-sup {\\r\\n  display: inline-block;\\r\\n  vertical-align: text-bottom;\\r\\n}\\r\\n.mq-math-mode .mq-supsub .mq-sup {\\r\\n  display: block;\\r\\n}\\r\\n.mq-math-mode .mq-supsub .mq-sub {\\r\\n  display: block;\\r\\n  float: left;\\r\\n}\\r\\n.mq-math-mode .mq-supsub.mq-limit .mq-sub {\\r\\n  margin-left: -0.25em;\\r\\n}\\r\\n.mq-math-mode .mq-supsub .mq-binary-operator {\\r\\n  padding: 0 .1em;\\r\\n}\\r\\n.mq-math-mode .mq-supsub .mq-fraction {\\r\\n  font-size: 70%;\\r\\n}\\r\\n.mq-math-mode sup.mq-nthroot {\\r\\n  font-size: 80%;\\r\\n  vertical-align: 0.8em;\\r\\n  margin-right: -0.6em;\\r\\n  margin-left: .2em;\\r\\n  min-width: .5em;\\r\\n}\\r\\n.mq-math-mode .mq-paren {\\r\\n  padding: 0 .1em;\\r\\n  vertical-align: top;\\r\\n  -webkit-transform-origin: center .06em;\\r\\n  -moz-transform-origin: center .06em;\\r\\n  -ms-transform-origin: center .06em;\\r\\n  -o-transform-origin: center .06em;\\r\\n  transform-origin: center .06em;\\r\\n}\\r\\n.mq-math-mode .mq-paren.mq-ghost {\\r\\n  color: silver;\\r\\n}\\r\\n.mq-math-mode .mq-paren + span {\\r\\n  margin-top: .1em;\\r\\n  margin-bottom: .1em;\\r\\n}\\r\\n.mq-math-mode .mq-array {\\r\\n  vertical-align: middle;\\r\\n  text-align: center;\\r\\n}\\r\\n.mq-math-mode .mq-array > span {\\r\\n  display: block;\\r\\n}\\r\\n.mq-math-mode .mq-operator-name {\\r\\n  font-family: Symbola, \\\"Times New Roman\\\", serif;\\r\\n  line-height: .9;\\r\\n  font-style: normal;\\r\\n}\\r\\n.mq-math-mode var.mq-operator-name.mq-first {\\r\\n  padding-left: .2em;\\r\\n}\\r\\n.mq-math-mode var.mq-operator-name.mq-last {\\r\\n  padding-right: .2em;\\r\\n}\\r\\n.mq-math-mode .mq-fraction {\\r\\n  font-size: 90%;\\r\\n  text-align: center;\\r\\n  vertical-align: -0.4em;\\r\\n  padding: 0 .2em;\\r\\n}\\r\\n.mq-math-mode .mq-fraction,\\r\\n.mq-math-mode .mq-large-operator,\\r\\n.mq-math-mode x:-moz-any-link {\\r\\n  display: -moz-groupbox;\\r\\n}\\r\\n.mq-math-mode .mq-fraction,\\r\\n.mq-math-mode .mq-large-operator,\\r\\n.mq-math-mode x:-moz-any-link,\\r\\n.mq-math-mode x:default {\\r\\n  display: inline-block;\\r\\n}\\r\\n.mq-math-mode .mq-numerator,\\r\\n.mq-math-mode .mq-denominator {\\r\\n  display: block;\\r\\n}\\r\\n.mq-math-mode .mq-numerator {\\r\\n  padding: 0 0.1em;\\r\\n}\\r\\n.mq-math-mode .mq-denominator {\\r\\n  border-top: 1px solid;\\r\\n  float: right;\\r\\n  width: 100%;\\r\\n  padding: 0.1em;\\r\\n}\\r\\n.mq-math-mode .mq-sqrt-prefix {\\r\\n  padding-top: 0;\\r\\n  position: relative;\\r\\n  top: 0.1em;\\r\\n  vertical-align: top;\\r\\n  -webkit-transform-origin: top;\\r\\n  -moz-transform-origin: top;\\r\\n  -ms-transform-origin: top;\\r\\n  -o-transform-origin: top;\\r\\n  transform-origin: top;\\r\\n}\\r\\n.mq-math-mode .mq-sqrt-stem {\\r\\n  border-top: 1px solid;\\r\\n  margin-top: 1px;\\r\\n  padding-left: .15em;\\r\\n  padding-right: .2em;\\r\\n  margin-right: .1em;\\r\\n  padding-top: 1px;\\r\\n}\\r\\n.mq-math-mode .mq-vector-prefix {\\r\\n  display: block;\\r\\n  text-align: center;\\r\\n  line-height: .25em;\\r\\n  margin-bottom: -0.1em;\\r\\n  font-size: 0.75em;\\r\\n}\\r\\n.mq-math-mode .mq-vector-stem {\\r\\n  display: block;\\r\\n}\\r\\n.mq-math-mode .mq-large-operator {\\r\\n  text-align: center;\\r\\n}\\r\\n.mq-math-mode .mq-large-operator .mq-from,\\r\\n.mq-math-mode .mq-large-operator big,\\r\\n.mq-math-mode .mq-large-operator .mq-to {\\r\\n  display: block;\\r\\n}\\r\\n.mq-math-mode .mq-large-operator .mq-from,\\r\\n.mq-math-mode .mq-large-operator .mq-to {\\r\\n  font-size: 80%;\\r\\n}\\r\\n.mq-math-mode .mq-large-operator .mq-from {\\r\\n  float: right;\\r\\n  /* take out of normal flow to manipulate baseline */\\r\\n  width: 100%;\\r\\n}\\r\\n.mq-math-mode,\\r\\n.mq-math-mode .mq-editable-field {\\r\\n  cursor: text;\\r\\n  font-family: Symbola, \\\"Times New Roman\\\", serif;\\r\\n}\\r\\n.mq-math-mode .mq-overarrow {\\r\\n  border-top: 1px solid black;\\r\\n  margin-top: 1px;\\r\\n  padding-top: 0.2em;\\r\\n}\\r\\n.mq-math-mode .mq-overarrow:before {\\r\\n  display: block;\\r\\n  position: relative;\\r\\n  top: -0.34em;\\r\\n  font-size: 0.5em;\\r\\n  line-height: 0em;\\r\\n  content: \\'\\\\27A4\\';\\r\\n  text-align: right;\\r\\n}\\r\\n.mq-math-mode .mq-overarrow.mq-arrow-left:before {\\r\\n  -moz-transform: scaleX(-1);\\r\\n  -o-transform: scaleX(-1);\\r\\n  -webkit-transform: scaleX(-1);\\r\\n  transform: scaleX(-1);\\r\\n  filter: FlipH;\\r\\n  -ms-filter: \\\"FlipH\\\";\\r\\n}\\r\\n.mq-math-mode .mq-selection,\\r\\n.mq-editable-field .mq-selection,\\r\\n.mq-math-mode .mq-selection .mq-non-leaf,\\r\\n.mq-editable-field .mq-selection .mq-non-leaf,\\r\\n.mq-math-mode .mq-selection .mq-scaled,\\r\\n.mq-editable-field .mq-selection .mq-scaled {\\r\\n  background: #B4D5FE !important;\\r\\n  background: Highlight !important;\\r\\n  color: HighlightText;\\r\\n  border-color: HighlightText;\\r\\n}\\r\\n.mq-math-mode .mq-selection .mq-matrixed,\\r\\n.mq-editable-field .mq-selection .mq-matrixed {\\r\\n  background: #39F !important;\\r\\n}\\r\\n.mq-math-mode .mq-selection .mq-matrixed-container,\\r\\n.mq-editable-field .mq-selection .mq-matrixed-container {\\r\\n  filter: progid:DXImageTransform.Microsoft.Chroma(color=\\'#3399FF\\') !important;\\r\\n}\\r\\n.mq-math-mode .mq-selection.mq-blur,\\r\\n.mq-editable-field .mq-selection.mq-blur,\\r\\n.mq-math-mode .mq-selection.mq-blur .mq-non-leaf,\\r\\n.mq-editable-field .mq-selection.mq-blur .mq-non-leaf,\\r\\n.mq-math-mode .mq-selection.mq-blur .mq-scaled,\\r\\n.mq-editable-field .mq-selection.mq-blur .mq-scaled,\\r\\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed,\\r\\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed {\\r\\n  background: #D4D4D4 !important;\\r\\n  color: black;\\r\\n  border-color: black;\\r\\n}\\r\\n.mq-math-mode .mq-selection.mq-blur .mq-matrixed-container,\\r\\n.mq-editable-field .mq-selection.mq-blur .mq-matrixed-container {\\r\\n  filter: progid:DXImageTransform.Microsoft.Chroma(color=\\'#D4D4D4\\') !important;\\r\\n}\\r\\n.mq-editable-field .mq-textarea,\\r\\n.mq-math-mode .mq-textarea {\\r\\n  position: relative;\\r\\n  -webkit-user-select: text;\\r\\n  -moz-user-select: text;\\r\\n  user-select: text;\\r\\n}\\r\\n.mq-editable-field .mq-textarea *,\\r\\n.mq-math-mode .mq-textarea *,\\r\\n.mq-editable-field .mq-selectable,\\r\\n.mq-math-mode .mq-selectable {\\r\\n  -webkit-user-select: text;\\r\\n  -moz-user-select: text;\\r\\n  user-select: text;\\r\\n  position: absolute;\\r\\n  clip: rect(1em 1em 1em 1em);\\r\\n  -webkit-transform: scale(0);\\r\\n  -moz-transform: scale(0);\\r\\n  -ms-transform: scale(0);\\r\\n  -o-transform: scale(0);\\r\\n  transform: scale(0);\\r\\n  resize: none;\\r\\n  width: 1px;\\r\\n  height: 1px;\\r\\n}\\r\\n.mq-math-mode .mq-matrixed {\\r\\n  background: white;\\r\\n  display: -moz-inline-box;\\r\\n  display: inline-block;\\r\\n}\\r\\n.mq-math-mode .mq-matrixed-container {\\r\\n  filter: progid:DXImageTransform.Microsoft.Chroma(color=\\'white\\');\\r\\n  margin-top: -0.1em;\\r\\n}\\r\\n');\n"]}