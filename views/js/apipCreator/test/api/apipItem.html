<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=EDGE" />
        <title>APIP creator API</title>
        <link rel="stylesheet" type="text/css" href="/tao/views/js/lib/qunit/qunit.css">
        <script type="text/javascript" src="/tao/views/js/lib/require.js"></script>
        <script type="text/javascript" src="/tao/views/js/lib/qunit/qunit.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script  type="text/javascript">
            require(['/tao/ClientConfig/config'], function () {
                require([
                    'taoQtiItem/apipCreator/api/apipItem', 
                    'taoQtiItem/apipCreator/helper/parser'
                ], function (ApipItem, parser) {
                    $.get(
                        '/taoQtiItem/views/js/apipCreator/test/assets/apip_example_exemplar01.xml'
                    ).done(function (xml) {
                        var apipItem = new ApipItem(xml);
                        
                        test("ApipItem.getItemBodyModel()", function () {
                            equal(apipItem.getItemBodyModel().tagName, 'itemBody');
                            //ensure that element was cloned.
                            notEqual(apipItem.getItemBodyModel(), $(xml).find('itemBody')[0]);
                        });
                        
                        test("creator.getQtiElementBySerial()", function () {
                            var qtiChoiceElement = apipItem.getQtiElementBySerial('simpleChoice1'),
                                qtiImgElement = apipItem.getQtiElementBySerial('img1');
                            
                            equal(typeof qtiChoiceElement, 'object');
                            ok(qtiChoiceElement.data.tagName && qtiChoiceElement.data.tagName === 'simpleChoice');
                            equal(qtiChoiceElement.serial, 'simpleChoice1');
                            
                            
                            equal(typeof qtiImgElement, 'object');
                            ok(qtiImgElement.data.tagName && qtiImgElement.data.tagName === 'img');
                            equal(qtiImgElement.serial, 'img1');
                            
                            equal(apipItem.getQtiElementBySerial('wrongSerial'), null);
                        });
                        
                        test("creator.getAccessElementBySerial()", function () {
                            var acccessElement = apipItem.getAccessElementBySerial('accessElement1');
                            equal(typeof acccessElement, 'object');
                            ok(acccessElement.data.localName && acccessElement.data.localName === 'accessElement');
                            equal(acccessElement.serial, 'accessElement1');
                            
                            equal(apipItem.getAccessElementBySerial('wrongSerial'), null);
                        });
                        
                        test("creator.getAccessElementsByInclusionOrder()", function () {
                            var acccessElement = apipItem.getAccessElementsByInclusionOrder('textOnlyDefaultOrder');
                            equal(acccessElement.length, 6);
                            //todo check inclusion order here
                        });
                        
                        test("creator.toXML()", function () {
                            var xmlString = apipItem.toXML(),
                                xml = parser.stringToXml(xmlString);
                                
                            equal($(xml).find('[serial]').length, 0);
                            equal($(xml).find('assessmentItem').length, 1);
                        });
                    });
                });
            });
        </script>
    </head>
    <body>
        <div id="qunit"></div>
        <div id="qunit-fixture"></div>
    </body>
</html>